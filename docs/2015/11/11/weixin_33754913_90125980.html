<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>linux下简单的备份的脚本 2 【转】 « NotBeCN</title>
  <meta name="description" content="             转自：http://blog.chinaunix.net/xmlrpc.php?r=blog/article&amp;uid=26807463&amp;id=4577034    &nbsp;    &nbsp;之前写过&nbsp;linux下简单的备份的脚本&nbsp;， 最开始一直用...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2015/11/11/weixin_33754913_90125980.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">linux下简单的备份的脚本 2 【转】</h1>
    <p class="post-meta">Nov 11, 2015</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p>转自：<a href="http://blog.chinaunix.net/xmlrpc.php?r=blog/article&amp;uid=26807463&amp;id=4577034" rel="nofollow">http://blog.chinaunix.net/xmlrpc.php?r=blog/article&amp;uid=26807463&amp;id=4577034</a></p> 
   <p>&nbsp;</p> 
   <p>&nbsp;之前写过<a href="http://blog.chinaunix.net/uid-26807463-id-3257630.html" rel="nofollow">&nbsp;linux下简单的备份的脚本</a>&nbsp;， 最开始一直用着， 后来觉得有必要改进下它了， 不管是从操作方式上还是工作方式上。有这样的想法是因为一次备份引起的。 我经历过磁盘损坏的痛苦， 花了1500元才勉强将数据拯救回来， 于是导致我对备份要求更加高了， 我期望尽量每周备份， 期望备份的目的地是当前系统的完整镜像，也就是说我能够从备份盘启动，且启动后<br>系统的操作方法以及文件和当前的一模一样，每周我只需要增量备份当前的修改的备份盘，这样就安全了很多。于是就有了下面的备份脚本（我不喜欢造轮子，但是在linux下没有现成的适合我的）<br><br>NOTE： 当前还没有加入自动镜像系统，所以如果想镜像系统，那么可以手动这样操作， 准备一块大于当前系统盘的移动盘，<br>分区，注意分区的结构尽量和系统的一模一样， 然后格式化，文件系统也尽量相同， 然后就可以备份了 备份的时候主要有些<br>目录需要跳过，比如sys dev proc等等，需要跳过的目录可以在backup程序了面设置！<br>这是脚本程序：<br><br></p> 
   <div> 
    <div class="codeheads"> 
     <p>点击(<span>此处)折叠或打开</span></p> 
    </div> 
    <div class="codeText">
     <ol>
      <li>#!/bin/bash</li> 
      <li># This program&nbsp;is&nbsp;free software;&nbsp;you can redistribute it&nbsp;and/or</li> 
      <li># modify it under the terms of the GNU General&nbsp;Public&nbsp;License as</li> 
      <li># published by the Free Software Foundation;&nbsp;either version 2 of</li> 
      <li># the License,&nbsp;or&nbsp;(at your&nbsp;option)&nbsp;any later version.</li> 
      <li>#&nbsp;</li> 
      <li># This program&nbsp;is&nbsp;distributed&nbsp;in&nbsp;the hope that it will be useful,</li> 
      <li># but WITHOUT ANY WARRANTY;&nbsp;without even the implied warranty of</li> 
      <li># MERCHANTABILITY&nbsp;or&nbsp;FITNESS&nbsp;FOR&nbsp;A PARTICULAR PURPOSE.&nbsp;See the</li> 
      <li># GNU General&nbsp;Public&nbsp;License&nbsp;for&nbsp;more details.</li> 
      <li># Author:&nbsp;rongp</li> 
      <li># email:&nbsp;rongpmcu#gmail.com</li> 
      <li>#&nbsp;Date:&nbsp;2014/10/26</li> 
      <li># 备份程序</li> 
      <li># 特点：</li> 
      <li># 主要支持unix类系统下， 支持符号链接</li> 
      <li># 支持增量备份</li> 
      <li># 支持网络备份（由于基于rsync， 很容易加入该功能，但暂时没加入）</li> 
      <li># 文件名支持空格 但是不能出现含有@#@的文件名</li> 
      <li># 支持备份每次的更新，方便用于人工操作失误后的修复</li> 
      <li># 支持添加规则用于剔除某些文件 格式参考rsync的PATTERN部分</li> 
      <li> </li> 
      <li>SHELL=/bin/bash</li> 
      <li>backup_cfg_path=/etc</li> 
      <li>backup_cfg=$backup_cfg_path/backup.cfg</li> 
      <li>db_path=</li> 
      <li>db_pathname=</li> 
      <li>inc_path=</li> 
      <li> </li> 
      <li>XECHO=1</li> 
      <li> </li> 
      <li>_help()&nbsp;</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;-e&nbsp;"$0 [option]\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\tOption:\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\t-h show this help.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\t-i perform the installation, and you should use this option\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\t before using the backup to do something else.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\t-u perform the un-installation.\n"</li> 
      <li>}</li> 
      <li> </li> 
      <li>help()&nbsp;</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;-e&nbsp;"Command action\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\th show this help.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\ta add any file that you want to backup to the database.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\td delete any file that you no longer want from the database.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\tb start backup.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\tbf assume \"yes\" as answer to all prompts and run non-interactively.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\tn perform a trial backup with no changes made.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\tp print the file record.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\tc do some configurations, such as, modifying the path to the\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\t database or to the incremental backup directory.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\ts show the current configuration.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\ti perform the installation, and you should use this option\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\t before using the backup to do something else.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\tu perform the un-installation.\n"\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"\tq quit"</li> 
      <li>}</li> 
      <li> </li> 
      <li>color_echo()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;"$1"&nbsp;in&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;-e&nbsp;"\033[32m"$@"\033[0m"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gn)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;-e&nbsp;-n&nbsp;"\033[32m"$@"\033[0m"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;-e&nbsp;"\033[31m"$@"\033[0m"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;-e&nbsp;"\033[33m"$@"\033[0m"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;-e&nbsp;-n&nbsp;"\033[33m"$@"\033[0m"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shift</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo $@</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;esac</li> 
      <li>}</li> 
      <li> </li> 
      <li>XECHO()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$XECHO"&nbsp;=&nbsp;1&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo $@</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>}</li> 
      <li> </li> 
      <li>check_src_dst()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;test&nbsp;-e&nbsp;"$1"&nbsp;||&nbsp;!&nbsp;test&nbsp;-e&nbsp;"$2";&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"$1"&nbsp;or&nbsp;"$2"&nbsp;does&nbsp;not&nbsp;ignore&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 2</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local src_part1=`df&nbsp;"$1"&nbsp;|&nbsp;cut&nbsp;-d&nbsp;'&nbsp;'&nbsp;-f 1`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local src_part2=`df&nbsp;"$2"&nbsp;|&nbsp;cut&nbsp;-d&nbsp;'&nbsp;'&nbsp;-f 1`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local nsrc_inode=`ls&nbsp;-lid&nbsp;"$1"&nbsp;|&nbsp;cut&nbsp;-d&nbsp;'&nbsp;'&nbsp;-f 1`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local ndst_inode=`ls&nbsp;-lid&nbsp;"$2"&nbsp;|&nbsp;cut&nbsp;-d&nbsp;'&nbsp;'&nbsp;-f 1`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO nsrc_inode:$nsrc_inode ndst_inode:$ndst_inode</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$src_part1"&nbsp;!=&nbsp;"$src_part2"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$nsrc_inode"&nbsp;=&nbsp;"$ndst_inode"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"$src is equivalent to $dst. ignore it!"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 2</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;!&nbsp;-e $db_pathname&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;read&nbsp;-r tsrc tdst tex_src;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;do</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tsrc="${tsrc//@#@/ }"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tdst="${tdst//@#@/ }"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tex_src="${tex_src//@#@/ }"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XECHO tsrc:"$tsrc"&nbsp;tdst:"$tdst"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;osrc_inode=`ls&nbsp;-lid&nbsp;"$tsrc"&nbsp;|&nbsp;cut&nbsp;-d&nbsp;'&nbsp;'&nbsp;-f 1`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;odst_inode=`ls&nbsp;-lid&nbsp;"$tdst"&nbsp;|&nbsp;cut&nbsp;-d&nbsp;'&nbsp;'&nbsp;-f 1`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XECHO osrc_inode:$osrc_inode odst_inode:$odst_inode</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$nsrc_inode"&nbsp;=&nbsp;"$osrc_inode"&nbsp;-a&nbsp;"$ndst_inode"&nbsp;=&nbsp;"$odst_inode"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;${1:((${#1}-1))}&nbsp;=&nbsp;'/'&nbsp;-a ${tsrc:((${#tsrc}-1))}&nbsp;!=&nbsp;'/'&nbsp;]&nbsp;\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;[&nbsp;${1:((${#1}-1))}&nbsp;!=&nbsp;'/'&nbsp;-a ${tsrc:((${#tsrc}-1))}&nbsp;=&nbsp;'/'&nbsp;];&nbsp;then&nbsp;#/home&nbsp;and&nbsp;/home/&nbsp;is&nbsp;very&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;-n&nbsp;"";</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;&lt;&nbsp;$db_pathname</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return 1&nbsp;</li> 
      <li>}</li> 
      <li> </li> 
      <li>extract_src_dst()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO&nbsp;"extract src dst from $1"</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;src="${1%#*}"&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;dst="${1#$src}"&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;dst="${dst#\#}"&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO&nbsp;"src: $src"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO&nbsp;"dst: $dst"</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$src"&nbsp;=&nbsp;""&nbsp;-o&nbsp;"$dst"&nbsp;=&nbsp;""&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;else</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>}</li> 
      <li> </li> 
      <li>fix_path()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local srcpath="$1"</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"${srcpath:0:1}"&nbsp;=&nbsp;'/'&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo $srcpath&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;[&nbsp;"${srcpath:0:2}"&nbsp;=&nbsp;'./'&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo `pwd`/${srcpath:2}</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo `pwd`/$srcpath</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>}</li> 
      <li> </li> 
      <li>insert_new_item()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO add item src:"$1"&nbsp;dst:"$2"&nbsp;exclude:"$3"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;tmp1="${1// /@#@}"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;tmp2="${2// /@#@}"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;tmp3="${3// /@#@}"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"$tmp1"&nbsp;"$tmp2"&nbsp;"$tmp3"&nbsp;&gt;&gt;&nbsp;$db_pathname</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return $?</li> 
      <li>}</li> 
      <li> </li> 
      <li>parse_item()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;extract_src_dst&nbsp;"$1";&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"src:$src or dst:$dst is illegal!"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;src=`fix_path&nbsp;"$src"`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;dst=`fix_path&nbsp;"$dst"`</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO after fixed,&nbsp;src:"$src"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO after fixed,&nbsp;src:"$dst"</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return 0</li> 
      <li>}</li> 
      <li> </li> 
      <li>do_add()&nbsp;</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local item</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"Enter the mode of adding files! Some patterns are available, as follows:"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"eg: /home/#/tmp/ means we want to backup the whole things which "</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"are under home directory to /tmp directory."</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"eg: /home/#/tmp/:/etc/#/tmp/ means we want to backup the whole "</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"things which are under the home directory and the /etc/ directory "</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"to the /tmp directory, you can append any item with ':'."</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"Note: /home and /home/ are quite different, because /home just means "</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"/home itself while /home/ means the whole contents of /home."</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;"Please type in file items: "&nbsp;items</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;items="`echo "$items" | sed "s/'//g"`"</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;flag=0</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;[&nbsp;$flag&nbsp;=&nbsp;0&nbsp;];&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item=${items%%:*}</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;items=${items#$item:}</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ex_src=""</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$items"&nbsp;=&nbsp;"$item"&nbsp;];&nbsp;then&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag=1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;parse_item&nbsp;"$item";&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_src_dst&nbsp;"$src"&nbsp;"$dst"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret=$?</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$ret"&nbsp;=&nbsp;0&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo y&nbsp;"Warning! ""$src#$dst"" is already existed! do not re-submit!"&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;[&nbsp;"$ret"&nbsp;=&nbsp;2&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;"Would you like to add some excluding conditions to $src: (y/n)[n] "&nbsp;yn</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$yn"&nbsp;=&nbsp;y&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"Note: this is an expert mode, and we don't check your pattern"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"is valid or not. Some patterns are available, as follows:"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"eg: if your src directory is /home, and your want to exclude"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"the directory /home/rongp, then you should type in \"rongp\"."&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"eg: if your src directory is /home, and your want to exclude"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"the directory /home/rongp and /home/test, then you should"&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"type in \"rongp:test\", and you can append any item with ':' ."</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;"Please type in paths to the excluding files: "&nbsp;exitem&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ex_src="$exitem"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;insert_new_item&nbsp;"$src"&nbsp;"$dst"&nbsp;"$ex_src";&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;""$src"#"$dst" add successed!"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;""$src"#"$dst" add failed!"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;"skip it? Yy/Nn:[n] "&nbsp;yn</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$yn"&nbsp;=&nbsp;"y"&nbsp;-o&nbsp;"$yn"&nbsp;=&nbsp;"Y"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;done</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return 0</li> 
      <li> </li> 
      <li>}</li> 
      <li> </li> 
      <li>get_choices()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local total_line=`wc&nbsp;-l $db_pathname&nbsp;|&nbsp;cut&nbsp;-d&nbsp;'&nbsp;'&nbsp;-f 1`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;select_tab=</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"Enter the mode of "$1"! some patterns are available, as follows:"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"eg: 1-3 means select no 1 2 3 item"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"eg: 1:3:5 means select no 1 3 5 item"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"you can append any no with ':' or '-', but don't mix use it."</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"no 0 means select all."</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;do_print</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;"Please type in the number: "&nbsp;NO</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"${NO/-/ }"&nbsp;!=&nbsp;"$NO"&nbsp;];&nbsp;then&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_tab=(${NO//-/&nbsp;})</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;${#num_tab[@]}&nbsp;-gt 2&nbsp;]&nbsp;&amp;&amp;&nbsp;\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"Select failed, argument $NO is illegal!"&nbsp;&amp;&amp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num0=${num_tab[0]}</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num1=${num_tab[1]}</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XECHO num0:$num0 num1:$num1</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;-z&nbsp;"${num0//[0-9]/}"&nbsp;-a&nbsp;"$num0"&nbsp;-le&nbsp;"$total_line"&nbsp;-a&nbsp;"$num0"&nbsp;-gt&nbsp;"0"&nbsp;]\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;[&nbsp;-z&nbsp;"${num1//[0-9]/}"&nbsp;-a&nbsp;"$num1"&nbsp;-le&nbsp;"$total_line"&nbsp;-a&nbsp;"$num1"&nbsp;-gt&nbsp;"0"&nbsp;]\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;[&nbsp;"$num0"&nbsp;-lt&nbsp;"$num1"&nbsp;];&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select_tab=(`seq $num0 $num1`)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"Select failed, argument $NO is illegal!"&nbsp;&amp;&amp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;[&nbsp;"${NO/:/ }"&nbsp;!=&nbsp;"$NO"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;num&nbsp;in&nbsp;${NO//:/&nbsp;}</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;-z&nbsp;"${num//[0-9]/}"&nbsp;]&amp;&amp;[&nbsp;"$num"&nbsp;-le&nbsp;"$total_line"&nbsp;]\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;[&nbsp;"$num"&nbsp;-gt&nbsp;"0"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"Select failed, argument $num is illegal!"&nbsp;&amp;&amp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j=0</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;${NO//:/&nbsp;}</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select_tab[j]=$i</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((j++))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$NO"&nbsp;=&nbsp;0&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select_tab=(`seq 1 $total_line`)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;[&nbsp;-z&nbsp;"${NO//[0-9]/}"&nbsp;]&amp;&amp;[&nbsp;"$NO"&nbsp;-le&nbsp;"$total_line"&nbsp;]\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;[&nbsp;"$NO"&nbsp;-gt&nbsp;"0"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select_tab[0]=${NO}</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"Select failed, argument $NO is illegal!"&nbsp;&amp;&amp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return 0</li> 
      <li>}</li> 
      <li> </li> 
      <li>do_del()&nbsp;</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;get_choices&nbsp;"deleting files";&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local total_num=${#select_tab[@]}</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$total_num"&nbsp;=&nbsp;1&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nums=${select_tab[0]}d</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;[&nbsp;"$total_num"&nbsp;=&nbsp;2&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nums=${select_tab[0]},${select_tab[1]}d</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;((i=0;&nbsp;i&lt;$total_num;&nbsp;++i))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nums+="${select_tab[i]}d;"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;sed&nbsp;-i&nbsp;"$nums"&nbsp;$db_pathname&nbsp;&gt;/dev/null&nbsp;2&gt;&amp;1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;"$?"&nbsp;=&nbsp;0&nbsp;]&nbsp;&amp;&amp;&nbsp;echo&nbsp;"$NO delete successed!"&nbsp;||&nbsp;echo&nbsp;"$NO delete failed, delete failed!"</li> 
      <li>}</li> 
      <li> </li> 
      <li>do_print()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;!&nbsp;-s $db_pathname&nbsp;]&nbsp;&amp;&amp;&nbsp;color_echo y&nbsp;"Warning, no record found!"&nbsp;&amp;&amp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;" no source destination action"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;cat&nbsp;-n $db_pathname&nbsp;|&nbsp;sed&nbsp;'s/@#@/&nbsp;/g'</li> 
      <li>}</li> 
      <li> </li> 
      <li>check_in_select_tab()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local i</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;((i=0;&nbsp;i&lt;${#select_tab[@]};&nbsp;++i))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;do</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XECHO $1:select_tab[$i]:${select_tab[i]}</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"${select_tab[i]}"&nbsp;=&nbsp;"$1"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;done</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>}</li> 
      <li> </li> 
      <li>do_backup()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local ex_file=`mktemp`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local fake="${1/fake/-n}"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local yes="${1/yes/y}"</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;!&nbsp;-f&nbsp;"$db_pathname"&nbsp;]&nbsp;&amp;&amp;&nbsp;color_echo r&nbsp;"$db_pathname does not exist!"&nbsp;&amp;&amp;&nbsp;return 1</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;get_choices&nbsp;"backup";&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local i=0</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local k=0</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;read&nbsp;-r src dst ex_src;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;do</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;check_in_select_tab $((i+1));&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XECHO&nbsp;"$i in select table"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src="${src//@#@/ }"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst="${dst//@#@/ }"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XECHO src:$src dst:$dst ex_src:$ex_src ex_file:$ex_file</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src_tab[k]="$src"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst_tab[k]="$dst"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ex_src_tab[k]="$ex_src"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((k++))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((i++))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;done&nbsp;&lt;&nbsp;$db_pathname</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;((j=0;&nbsp;j&lt;$k;&nbsp;++j))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;do</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo src:${src_tab[j]}&nbsp;dst:${dst_tab[j]}&nbsp;ex_src:${ex_src_tab[j]}</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;src="${src_tab[j]}"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dst="${dst_tab[j]}"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ex_src="${ex_src_tab[j]}"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"$ex_src"&nbsp;|&nbsp;awk&nbsp;-F&nbsp;':'&nbsp;'{for&nbsp;(i=1;i&lt;=NF;++i)print $i}'&nbsp;|&nbsp;sed&nbsp;'s/@#@/&nbsp;/g'&nbsp;&gt;&nbsp;$ex_file</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$src"&nbsp;=&nbsp;"/"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpsrc=$(blkid `mount&nbsp;|&nbsp;grep&nbsp;"/ "&nbsp;|&nbsp;cut&nbsp;-d&nbsp;'&nbsp;'&nbsp;-f 1`&nbsp;|&nbsp;awk&nbsp;-F&nbsp;"\"" '{print $2}')</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpsrc="$src"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if [ "$dst" = "/" ]; then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpdst=$(blkid `mount | grep "/&nbsp;" | cut -d ' ' -f 1` | awk -F "\""&nbsp;'{print $2}')</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpdst="$dst"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"We will start backup from "</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"$src"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;to&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"$dst"&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;"with excluding file or directory"&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"${ex_src//@#@/ }"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo gn&nbsp;"continue or not? y/n: "</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$yes"&nbsp;=&nbsp;y&nbsp;];&nbsp;then&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yn=y</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read yn</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$yn"&nbsp;=&nbsp;y&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo Start backup&nbsp;"$src"&nbsp;to&nbsp;"$dst"&nbsp;with excluding file&nbsp;or&nbsp;directory&nbsp;"$ex_src"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flock&nbsp;-x 200</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rsync&nbsp;-avzrtopg $fake&nbsp;--progress&nbsp;--delete&nbsp;--exclude-from=$ex_file&nbsp;\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"$src"&nbsp;"$dst"&nbsp;--backup&nbsp;--backup-dir=$inc_path/$(date&nbsp;+%Y-%m-%d_%H:%M:%S_$(basename ${tmpsrc})_$(basename $tmpdst))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;200&gt;/var/lock/abc</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo Backup $src&nbsp;to&nbsp;$dst with excluding file&nbsp;or&nbsp;directory $ex_src&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo Skip backup $src&nbsp;to&nbsp;$dst with excluding file&nbsp;or&nbsp;directory $</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;done</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;</li> 
      <li>}</li> 
      <li> </li> 
      <li>get_answer()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;local ret</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$4"&nbsp;!=&nbsp;""&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpbackup="$4"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;else</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmpbackup=backup.cfg.bak</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;:</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;do</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;"Type in $1 path of the backup(default is $2, q for exit): "&nbsp;ans_tmp&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$ans_tmp"&nbsp;=&nbsp;q&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret=1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;[&nbsp;"$ans_tmp"&nbsp;!=&nbsp;""&nbsp;];&nbsp;then&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;!&nbsp;-d&nbsp;"$ans_tmp"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"$1: $ans_tmp is invalid!"&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;"Would you like to create it now? y/n [y]: "&nbsp;yn</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$yn"&nbsp;=&nbsp;y&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mkdir&nbsp;-p $ans_tmp</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sed&nbsp;-i&nbsp;"s,$3.*,$3$ans_tmp,g"&nbsp;$tmpbackup</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret=$?</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans_tmp="$2"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret=0&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;done</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return $ret</li> 
      <li>}</li> 
      <li> </li> 
      <li>already_install()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;load_cfg $backup_cfg s;&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XECHO&nbsp;"already install"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 #has install</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>}</li> 
      <li> </li> 
      <li>do_install()</li> 
      <li>{&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g start install</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;already_install;&nbsp;then&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo y&nbsp;"We check that you have already installed, you should"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo yn&nbsp;"uninstall first, would you want to uninstall it first?y/n[n] "</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read yn</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$yn"&nbsp;!=&nbsp;y&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r install&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_uninstall</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;cp&nbsp;-f backup.cfg backup.cfg.bak</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;load_cfg backup.cfg.bak s</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$?"&nbsp;=&nbsp;1&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;get_answer&nbsp;"executable file backup"&nbsp;"$bin_path"&nbsp;"INSTALL_PATH=";then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r install&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;install_path=$ans_tmp</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install path&nbsp;is&nbsp;$install_path</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;get_answer&nbsp;"database"&nbsp;"$db_path"&nbsp;"DB_PATH=";then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r install&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;db_path=$ans_tmp</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g database path&nbsp;is&nbsp;$db_path</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;get_answer&nbsp;"incremental backup"&nbsp;"$inc_path"&nbsp;"INCREMENTAL_BACKUP_PATH=";then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r install&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;inc_path=$ans_tmp</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g incremental backup path&nbsp;is&nbsp;$inc_path</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;who=`whoami`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;cp backup $install_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install backup&nbsp;to&nbsp;$install_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;ret=$?</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;mv backup.cfg.bak $backup_cfg</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install $backup_cfg</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;ret=$((ret+$?))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;mkdir&nbsp;-p $db_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install $db_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;ret=$((ret+$?))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;mkdir&nbsp;-p $inc_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install $inc_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;ret=$((ret+$?))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;ln&nbsp;-s $db_path $inc_path/db</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install $inc_path/db</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;ret=$((ret+$?))</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g install&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;$ret&nbsp;-gt 0&nbsp;];&nbsp;then&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r install&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;-e $bin_path/backup&nbsp;]&nbsp;&amp;&amp;&nbsp;rm_print $bin_path/backup</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;-e $backup_cfg&nbsp;]&nbsp;&amp;&amp;&nbsp;rm_print $backup_cfg</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;-e $inc_path/db&nbsp;]&nbsp;&amp;&amp;&nbsp;rm_print $inc_path/db&nbsp;&amp;&amp;&nbsp;rm_print&nbsp;-rf $inc_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;-e $db_pathname&nbsp;]&nbsp;&amp;&amp;&nbsp;rm_print $db_pathname</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rm_print&nbsp;-d $db_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo y&nbsp;"The installation work is done, and you can remove this package now!"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo y&nbsp;"Note: you should put the executable file \"backup\""</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo y&nbsp;"into \$PATH and you need to get \"root\" privileges to execute it."</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo y&nbsp;"for example, you can execute it like this in ubuntu: sudo backup"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return 0</li> 
      <li>}</li> 
      <li> </li> 
      <li>rm_print()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g remove $@</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;eval rm $@</li> 
      <li>}</li> 
      <li> </li> 
      <li>do_uninstall()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO&nbsp;"Perform the un-installation."</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g perform the un-installation...</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;load_cfg $backup_cfg;&nbsp;then&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo g uninstall&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;-e $bin_path/backup&nbsp;]&nbsp;&amp;&amp;&nbsp;rm_print $bin_path/backup</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;-e $backup_cfg&nbsp;]&nbsp;&amp;&amp;&nbsp;rm_print $backup_cfg</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;-e $inc_path/db&nbsp;]&nbsp;&amp;&amp;&nbsp;rm_print $inc_path/db&nbsp;&amp;&amp;&nbsp;rm_print&nbsp;-rf $inc_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;-e $db_pathname&nbsp;]&nbsp;&amp;&amp;&nbsp;rm_print $db_pathname</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;rm_print&nbsp;-d $db_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g uninstall&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g uninstall&nbsp;</li> 
      <li>}</li> 
      <li> </li> 
      <li>load_cfg()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;!&nbsp;-e&nbsp;"$1"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;"$2"&nbsp;!=&nbsp;"s"&nbsp;]&nbsp;&amp;&amp;&nbsp;color_echo r&nbsp;"Error, we can't find the configure file $1, exit now!"</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;bin_path=`sed&nbsp;-n&nbsp;'s/INSTALL_PATH=\(.*\)/\1/p'&nbsp;$1`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;db_path=`sed&nbsp;-n&nbsp;'s/DB_PATH=\(.*\)/\1/p'&nbsp;$1`</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;db_pathname=$db_path/backup.db</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;inc_path=`sed&nbsp;-n&nbsp;'s/INCREMENTAL_BACKUP_PATH=\(.*\)/\1/p'&nbsp;$1`</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;!&nbsp;-d&nbsp;"$inc_path"&nbsp;];&nbsp;then&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;"$2"&nbsp;!=&nbsp;"s"&nbsp;]&nbsp;&amp;&amp;&nbsp;color_echo r Load configuration file your should</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;"$2"&nbsp;!=&nbsp;"s"&nbsp;]&nbsp;&amp;&amp;&nbsp;color_echo r check the directory $db_pathname&nbsp;is&nbsp;valid&nbsp;or&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 2</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO database path&nbsp;is&nbsp;$db_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO database file path&nbsp;is&nbsp;$db_pathname</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO incremental backup path&nbsp;is&nbsp;$inc_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return 0</li> 
      <li>}</li> 
      <li> </li> 
      <li>show_configure()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g executable backup&nbsp;is&nbsp;in&nbsp;$bin_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g database directory&nbsp;is&nbsp;in&nbsp;$db_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g incremental backup directory&nbsp;is&nbsp;in&nbsp;$inc_path</li> 
      <li>}</li> 
      <li> </li> 
      <li>do_modify_inc_backup_path()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;get_answer&nbsp;"incremental backup"&nbsp;"$inc_path"&nbsp;\</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"INCREMENTAL_BACKUP_PATH="&nbsp;$backup_cfg;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;inc_path=$ans_tmp</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;XECHO incremental backup&nbsp;is&nbsp;$inc_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;return 0</li> 
      <li>}</li> 
      <li> </li> 
      <li>do_configure()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;[1]&nbsp;modify incremental backup path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo g&nbsp;[2]&nbsp;...</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;"Please type in the no which you are expecting to: "&nbsp;no</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$no"&nbsp;=&nbsp;1&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_modify_inc_backup_path</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;else</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo r Unsupported&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>}</li> 
      <li> </li> 
      <li>backup_start()</li> 
      <li>{</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;load_cfg $backup_cfg;&nbsp;then&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li> </li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;:</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;do</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;"Command (h for help): "&nbsp;cmd</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;"$cmd"&nbsp;in</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_add</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_del&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_print</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_configure&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_backup&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bf)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_backup yes&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_backup fake</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;show_configure</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_install</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_uninstall</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;|&nbsp;*)</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;esac</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;done</li> 
      <li>}</li> 
      <li> </li> 
      <li>username=`echo $USER`</li> 
      <li> </li> 
      <li>if&nbsp;[&nbsp;"$username"&nbsp;!=&nbsp;root&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"Error, you need to have \"root\" privileges to execute this program."</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;exit</li> 
      <li>fi</li> 
      <li> </li> 
      <li>if&nbsp;[&nbsp;"$1"&nbsp;=&nbsp;"-i"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;!&nbsp;do_install;&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color_echo y&nbsp;"Sorry, We can't continue any more. Exit now!"&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;exit</li> 
      <li>elif&nbsp;[&nbsp;"$1"&nbsp;=&nbsp;"-u"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;do_uninstall&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;exit</li> 
      <li>elif&nbsp;[&nbsp;"$1"&nbsp;=&nbsp;"-h"&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;_help</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;exit</li> 
      <li>fi</li> 
      <li> </li> 
      <li>if&nbsp;[&nbsp;!&nbsp;-e $backup_cfg&nbsp;];&nbsp;then&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;color_echo r&nbsp;"$backup_cfg does not exist! "</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;-p&nbsp;"You need to install the backup first. perform the installation? y/n?[y]: "&nbsp;yn&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;[&nbsp;"$yn"&nbsp;!=&nbsp;n&nbsp;];&nbsp;then</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;do_install</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;else</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo Sorry,&nbsp;we can\'t continue any more.&nbsp;Exit&nbsp;</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;fi</li> 
      <li>&nbsp;&nbsp;&nbsp;&nbsp;exit</li> 
      <li>fi</li> 
      <li> </li> 
      <li>backup_start</li> 
     </ol>
    </div> 
   </div> 
   <p> <br>这是配置文件<br><br></p> 
   <div> 
    <div class="codeheads"> 
     <p>点击(<span>此处)折叠或打开</span></p> 
    </div> 
    <div class="codeText">
     <ol>
      <li>#############################</li> 
      <li>######</li> 
      <li>#############################</li> 
      <li>AUTHOR=rongp</li> 
      <li>EMAIL=rongpmcu@gmail.com</li> 
      <li>VERSION=1.0</li> 
      <li> </li> 
      <li>INSTALL_PATH=/usr/bin/</li> 
      <li>DB_PATH=/var/lib/backup/</li> 
      <li>INCREMENTAL_BACKUP_PATH=/var/lib/backup/incr_backup</li> 
     </ol>
    </div> 
   </div> 
   <p> <br>git路径：git@bitbucket.org:rongpmcu/backup-script-shell.git</p> 
   <div> 
    <div>
     【作者】
     <a href="http://www.cnblogs.com/sky-heaven/" rel="nofollow">张昺华</a> 
    </div> 
    <div>
     【出处】
     <a href="http://www.cnblogs.com/sky-heaven/" rel="nofollow">http://www.cnblogs.com/sky-heaven/</a> 
    </div> 
    <div>
     【博客园】 
     <a href="http://www.cnblogs.com/sky-heaven/" rel="nofollow">http://www.cnblogs.com/sky-heaven/</a> 
    </div> 
    <div>
     【新浪博客】 
     <a href="http://blog.sina.com.cn/u/2049150530" rel="nofollow">http://blog.sina.com.cn/u/2049150530</a> 
    </div> 
    <div>
     【知乎】 
     <a href="http://www.zhihu.com/people/zhang-bing-hua" rel="nofollow">http://www.zhihu.com/people/zhang-bing-hua</a> 
    </div> 
    <div>
     【我的作品---旋转倒立摆】 
     <a href="http://v.youku.com/v_show/id_XODM5NDAzNjQw.html?spm=a2hzp.8253869.0.0&amp;from=y1.7-2" rel="nofollow">http://v.youku.com/v_show/id_XODM5NDAzNjQw.html?spm=a2hzp.8253869.0.0&amp;from=y1.7-2</a> 
    </div> 
    <div>
     【我的作品---自平衡自动循迹车】 
     <a href="http://v.youku.com/v_show/id_XODM5MzYyNTIw.html?spm=a2hzp.8253869.0.0&amp;from=y1.7-2" rel="nofollow">http://v.youku.com/v_show/id_XODM5MzYyNTIw.html?spm=a2hzp.8253869.0.0&amp;from=y1.7-2</a> 
    </div> 
    <div>
     【新浪微博】 张昺华--sky
    </div> 
    <div>
     【twitter】 @sky2030_
    </div> 
    <div>
     【facebook】 张昺华 zhangbinghua
    </div> 
    <div>
     本文版权归作者和博客园共有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利.
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
