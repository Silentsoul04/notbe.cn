<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>经典SQL（sqlServer） « NotBeCN</title>
  <meta name="description" content="                 一、基础    1、说明：创建数据库CREATE DATABASE database-name&nbsp;2、说明：删除数据库drop database dbname3、说明：备份sql server---&nbsp;创建 备份数据的&nbsp;deviceUSE masterE...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2015/01/23/jiazhipeng12_90117831.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">经典SQL（sqlServer）</h1>
    <p class="post-meta">Jan 23, 2015</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="artical-content-bak main-content editor-side-new"> 
   <div class="con editor-preview-side" id="result">
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,0,0);font-size:24px;"><strong><span style="font-family:'宋体';"><strong><span style="color:rgb(255,0,0);">一、基础</span></strong></span></strong></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,0,0);"><strong><span style="font-family:'宋体';">1</span></strong></span><span style="color:rgb(0,0,0);"><strong><span style="font-family:'宋体';">、说明：创建数据库</span></strong><br></span><span style="font-family:'宋体';"><strong>CREATE DATABASE database-name</strong>&nbsp;</span><span style="color:rgb(0,0,0);"><br><strong><span style="font-family:'宋体';">2</span></strong></span><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：删除数据库</span><br></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">drop database dbname</span></span></strong><span style="color:rgb(0,128,128);"><br></span><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">3</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：备份</span><span style="font-family:'宋体';">sql server<br></span></span><span style="color:rgb(0,128,128);"><span style="font-family:'宋体';">---&nbsp;</span></span><span style="color:rgb(0,128,128);"><span style="font-family:'宋体';">创建 备份数据的</span><span style="font-family:'宋体';">&nbsp;device<br>USE master<br>EXEC sp_addumpdevice 'disk', 'testBack', 'c:\mssql7backup\MyNwind_1.dat'<br>---&nbsp;开始 备份</span><br><span style="font-family:'宋体';">BACKUP DATABASE pubs TO testBack</span></span></strong><span style="color:rgb(0,128,128);"><span style="font-family:'宋体';">&nbsp;<br></span></span><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">4</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：创建新表</span><br></span><span style="font-family:'宋体';"><span style="color:rgb(153,51,0);">create table tabname(col1 type1 [not null] [primary key],col2 type2 [not null],..</span><span style="color:rgb(0,128,128);">)</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">根据已有的表创建新表：&nbsp;</span></span></strong><span style="color:rgb(0,0,0);"><br></span><strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">A</span><span style="color:rgb(0,0,255);">：create table tab_new like tab_old (使用旧表创建新表)</span></span></strong><span style="color:rgb(0,0,255);"><br><strong><span style="font-family:'宋体';">B</span></strong></span><strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">：create table tab_new as select col1,col2… from tab_old definition only</span></span></strong><span style="color:rgb(0,128,128);"><br></span><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">5</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：删除新表</span><br></span><span style="color:rgb(128,0,0);"><span style="font-family:'宋体';">drop table tabname</span></span></strong><span style="color:rgb(0,128,128);"><span style="font-family:'宋体';">&nbsp;<br></span></span><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">6</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：增加一个列</span><br></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">Alter table tabname add column col type</span></span></strong><span style="color:rgb(0,128,128);"><br></span><strong><span style="color:rgb(255,0,0);"><span style="font-family:'宋体';">注</span></span></strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">：</span><span style="text-decoration:underline;"><span style="font-family:'宋体';">列增加后将不能删除。DB2中列加上后数据类型也不能改变，唯一能改变的是增加varchar类型的长度。</span><br></span><span style="font-family:'宋体';"><strong>7、说明：添加主键</strong>：&nbsp;</span></span><span style="font-family:'宋体';"><strong><span style="color:rgb(0,128,128);">Alter table tabname add primary key(col)&nbsp;<br></span></strong><span style="color:rgb(0,0,255);">说明：删除主键</span><span style="color:rgb(0,0,0);">：</span><strong><span style="color:rgb(128,0,0);">&nbsp;Alter table tabname drop primary key(col)&nbsp;</span></strong></span><span style="color:rgb(0,128,128);"><br></span><span style="font-family:'宋体';"><strong><span style="color:rgb(0,0,0);">8</span><span style="color:rgb(0,0,0);">、说明：创建索引</span></strong><span style="color:rgb(0,0,0);">：</span></span><span style="font-family:'宋体';"><strong><span style="color:rgb(0,0,255);">create [unique] index idxname on tabname(col….)&nbsp;<br></span></strong><span style="color:rgb(0,0,255);">删除索引</span><span style="color:rgb(0,0,0);">：</span><strong><span style="color:rgb(0,128,0);">drop index idxname</span></strong></span><span style="color:rgb(0,0,0);"><br></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">注：索引是不可更改的，想更改必须删除重新建。</span></span><span style="color:rgb(0,0,0);"><br><strong><span style="font-family:'宋体';">9</span></strong></span><span style="font-family:'宋体';"><strong><span style="color:rgb(0,0,0);">、说明：创建视图</span></strong><span style="color:rgb(0,0,0);">：</span><span style="color:rgb(0,128,0);">create view viewname as select statement&nbsp;</span></span><span style="color:rgb(0,0,0);"><br></span><span style="font-family:'宋体';"><strong><span style="color:rgb(0,0,0);">删除视图</span></strong><span style="color:rgb(0,0,0);">：</span><span style="color:rgb(0,128,0);">drop view viewname</span></span><span style="color:rgb(0,0,0);"><br><strong><span style="font-family:'宋体';">10</span></strong></span><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：几个简单的基本的sql语句</span><br></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">选择：</span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select * from table1 where&nbsp;</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">范围</span><br></span><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">插入：</span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(153,51,102);">insert into table1(field1,field2) values(value1,value2)<br></span><strong><span style="color:rgb(0,128,0);">删除：</span></strong><span style="color:rgb(0,0,255);">delete from table1 where&nbsp;</span><span style="color:rgb(0,0,255);">范围</span></span><strong><span style="color:rgb(0,128,0);"><br></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">更新</span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">：</span><span style="color:rgb(153,51,102);">update table1 set field1=value1 where&nbsp;</span></span><span style="color:rgb(153,51,102);"><span style="font-family:'宋体';">范围</span><br></span><span style="font-family:'宋体';"><strong><span style="color:rgb(0,128,0);">查找</span></strong><span style="color:rgb(0,128,0);">：</span><span style="color:rgb(0,0,255);">select * from table1 where field1 like ’%value1%’ ---like</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">的语法很精妙，查资料</span><span style="font-family:'宋体';">!<br></span></span><span style="font-family:'宋体';"><strong><span style="color:rgb(0,128,0);">排序</span></strong><span style="color:rgb(0,128,0);">：</span></span><span style="font-family:'宋体';"><span style="color:rgb(153,51,102);">select * from table1 order by field1,field2 [desc]<br></span><strong><span style="color:rgb(0,128,0);">总数</span></strong><span style="color:rgb(0,128,0);">：</span></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select count as totalcount from table1<br></span><strong><span style="color:rgb(0,128,0);">求和</span></strong><span style="color:rgb(0,128,0);">：</span></span><span style="font-family:'宋体';"><span style="color:rgb(153,51,102);">select sum(field1) as sumvalue from table1<br></span><strong><span style="color:rgb(0,128,0);">平均</span></strong><span style="color:rgb(0,128,0);">：</span></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select avg(field1) as avgvalue from table1<br></span><strong><span style="color:rgb(0,128,0);">最大</span></strong><span style="color:rgb(0,128,0);">：</span></span><span style="font-family:'宋体';"><span style="color:rgb(153,51,102);">select max(field1) as maxvalue from table1<br></span><strong><span style="color:rgb(0,128,0);">最小</span></strong><span style="color:rgb(0,128,0);">：</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select min(field1) as minvalue from table1<br></span></span><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">11</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：几个高级查询运算词</span><br><span style="font-family:'宋体';">A</span><span style="font-family:'宋体';">：&nbsp;</span></span><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">UNION&nbsp;</span><span style="color:rgb(0,128,0);">运算符</span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">&nbsp;<br></span><span style="color:rgb(0,0,255);">UNION&nbsp;</span><span style="color:rgb(0,0,255);">运算符通过组合其他两个结果表（例如&nbsp;TABLE1&nbsp;和&nbsp;TABLE2）并消去表中任何重复行而派生出一个结果表。当&nbsp;ALL&nbsp;随&nbsp;UNION&nbsp;一起使用时（即&nbsp;UNION ALL），不消除重复行。两种情况下，派生表的每一行不是来自&nbsp;TABLE1&nbsp;就是来自&nbsp;TABLE2</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">。</span><span style="font-family:'宋体';">&nbsp;<br></span></span><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">B</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">：&nbsp;EXCEPT&nbsp;运算符</span><span style="font-family:'宋体';">&nbsp;<br></span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">EXCEPT</span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(255,153,204);">&nbsp;</span><span style="color:rgb(153,51,102);">运算符通过包括所有在&nbsp;TABLE1&nbsp;中但不在&nbsp;TABLE2&nbsp;中的行并消除所有重复行而派生出一个结果表。当&nbsp;ALL&nbsp;随&nbsp;EXCEPT&nbsp;一起使用时&nbsp;(EXCEPT ALL)，不消除重复行。</span><span style="color:rgb(51,51,153);">&nbsp;</span></span><span style="color:rgb(0,0,0);"><br></span><strong><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">C</span><span style="color:rgb(0,128,0);">：&nbsp;INTERSECT&nbsp;</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">运算符</span><br><span style="font-family:'宋体';">INTERSECT</span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">&nbsp;</span><span style="color:rgb(0,0,255);">运算符通过只包括&nbsp;TABLE1&nbsp;和&nbsp;TABLE2&nbsp;中都有的行并消除所有重复行而派生出一个结果表。当&nbsp;</span><strong><span style="color:rgb(0,0,0);">ALL</span></strong><span style="color:rgb(0,0,0);">&nbsp;</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">随&nbsp;INTERSECT&nbsp;一起使用时&nbsp;(INTERSECT ALL)，不消除重复行。</span><span style="font-family:'宋体';">&nbsp;<br></span></span><span style="font-family:'宋体';"><strong><span style="color:rgb(255,0,0);">注：</span></strong><span style="color:rgb(0,0,255);">使用运算词的几个查询结果行必须是一致的</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">。</span><span style="font-family:'宋体';">&nbsp;<br><strong>12</strong></span><strong><span style="font-family:'宋体';">、说明：使用外连接</span><span style="font-family:'宋体';">&nbsp;<br></span></strong><span style="font-family:'宋体';">A、<strong>left&nbsp;（outer）&nbsp;join</strong>：</span><span style="font-family:'宋体';">&nbsp;<br>左</span></span><span style="color:rgb(153,51,102);"><span style="font-family:'宋体';">外连接（左连接）：结果集几包括连接表的匹配行，也包括左连接表的所有行。</span><span style="font-family:'宋体';">&nbsp;<br>SQL: select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c<br></span></span><strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">B</span><span style="color:rgb(0,0,0);">：right&nbsp;（outer）&nbsp;join:&nbsp;</span></span></strong><span style="color:rgb(0,0,0);"><br></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">右外连接(右连接)：结果集既包括连接表的匹配连接行，也包括右连接表的所有行。</span><span style="font-family:'宋体';">&nbsp;<br></span></span><strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">C</span><span style="color:rgb(0,0,0);">：full/cross&nbsp;（outer）&nbsp;join</span></span></strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">：</span><span style="font-family:'宋体';">&nbsp;<br></span></span><span style="color:rgb(153,51,0);"><span style="font-family:'宋体';">全外连接：不仅包括符号连接表的匹配行，还包括两个连接表中的所有记录。</span></span><span style="color:rgb(0,0,0);"><br><strong><span style="font-family:'宋体';">12</span></strong></span><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、分组</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">:Group by:<br>&nbsp;&nbsp;&nbsp;</span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">一张表，一旦分组 完成后，查询后只能得到组相关的信息。</span><br><span style="font-family:'宋体';">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><strong><span style="color:rgb(128,0,0);"><span style="font-family:'宋体';">组相关的信息：</span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">（统计信息）&nbsp;count,sum,max,min,avg&nbsp;<strong>&nbsp;</strong></span><strong><span style="font-family:'宋体';">分组的标准</span><span style="font-family:'宋体';">)<br>&nbsp;&nbsp;</span></strong></span><strong><span style="font-family:'宋体';">&nbsp;&nbsp;在<span style="color:rgb(255,0,0);">SQLServer</span>中分组时：不能以<span style="color:rgb(0,0,255);">text</span>,<span style="color:rgb(0,0,255);">ntext</span>,<span style="color:rgb(0,0,255);">p_w_picpath</span>类型的字段作为分组依据</span><span style="color:rgb(0,0,255);"><br><span style="font-family:'宋体';">&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">在<span style="color:rgb(0,0,255);">select</span><span style="color:rgb(255,0,0);">统计函数</span><span style="color:rgb(0,0,255);">中的字段，不能和</span><span style="color:rgb(255,0,0);">普通</span><span style="color:rgb(0,0,255);">的字段放在一起；</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">13</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、对数据库进行操作：</span><br><span style="font-family:'宋体';">&nbsp;&nbsp;&nbsp;</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">分离数据库</span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">：</span><strong><span style="color:rgb(0,0,0);">&nbsp;sp_detach_db;</span><span style="color:rgb(0,128,0);">&nbsp;</span><span style="color:rgb(0,128,0);">附加数据库</span></strong></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">：<strong>sp_attach_db&nbsp;</strong>后接表明，附加需要完整的路径名</span><br><strong><span style="font-family:'宋体';">14.</span></strong><strong><span style="font-family:'宋体';">如何修改数据库的名称:</span></strong></span><span style="color:rgb(0,0,255);"><br><span style="font-family:'宋体';">sp_renamedb 'old_name', 'new_name'</span></span><span style="color:rgb(0,0,255);"></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';">&nbsp;</span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;text-align:center;"><strong><span style="font-size:20px;color:rgb(255,0,0);"><span style="font-family:'宋体';">二、提升</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">1</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：复制表(只复制结构,源表名：a&nbsp;新表名：b) (Access可用</span><span style="font-family:'宋体';">)<br></span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">法一：</span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * into b from a where 1&lt;&gt;1</span><span style="color:rgb(0,0,255);">（</span><span style="color:rgb(255,102,0);">仅用于SQlServer</span><span style="color:rgb(0,0,255);">）</span></span><span style="color:rgb(0,128,0);"><br></span><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">法二：</span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select top 0 * into b from a<br></span></span><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">2</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：拷贝表(拷贝数据,源表名：a&nbsp;目标表名：b) (Access可用</span><span style="font-family:'宋体';">)<br></span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">insert into b(a, b, c) select d,e,f from b;</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">3</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：跨数据库之间表的拷贝(具体数据使用绝对路径) (Access可用</span><span style="font-family:'宋体';">)<br></span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">insert into b(a, b, c) select d,e,f from b in ‘</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">具体数据库’ where&nbsp;条件</span><br></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">例子：..from b in '"&amp;Server.MapPath(".")&amp;"\data.mdb" &amp;"' where..</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">4</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：子查询(表名1：a&nbsp;表名2：</span><span style="font-family:'宋体';">b)<br></span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select a,b,c from a where a IN (select d from b )&nbsp;</span><span style="color:rgb(0,0,255);">或者: select a,b,c from a where a IN (1,2,3)</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">5</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：显示文章、提交人和最后回复时间</span><br></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select a.title,a.username,b.adddate from table a,(select max(adddate) adddate from table where table.title=a.title) b</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">6</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：外连接查询(表名1：a&nbsp;表名2：</span><span style="font-family:'宋体';">b)<br></span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">7</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：在线视图查询(表名1：</span><span style="font-family:'宋体';">a )<br></span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select * from (SELECT a,b,c FROM a) T where t.a &gt; 1;</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">8</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：between的用法,between限制查询数据范围时包括了边界值,not between不包括</span><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * from table1 where time between time1 and time2<br>select a,b,c, from table1 where a not between&nbsp;</span><span style="color:rgb(0,0,255);">数值1 and&nbsp;数值2</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">9</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：in&nbsp;的使用方法</span><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * from table1 where a [not] in (‘</span><span style="color:rgb(0,0,255);">值</span></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">1’</span><span style="color:rgb(0,0,255);">,’</span><span style="color:rgb(0,0,255);">值2’,’值4’,’值6’)</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">10</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：两张关联表，删除主表中已经在副表中没有的信息</span><span style="font-family:'宋体';">&nbsp;<br></span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">delete from table1 where not exists ( select * from table2 where table1.field1=table2.field1 )</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">11</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">、说明：四表联查问题：</span><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * from a left inner join b on a.a=b.b right inner join c on a.a=c.c inner join d on a.a=d.d where&nbsp;</span><span style="color:rgb(0,128,0);">.....</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">12</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：日程安排提前五分钟提醒</span><span style="font-family:'宋体';">&nbsp;<br></span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">SQL: select * from&nbsp;</span><span style="color:rgb(0,0,255);">日程安排&nbsp;where datediff('minute',f开始时间,getdate())&gt;5</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong><span style="font-size:16px;color:rgb(0,128,0);"><span style="font-family:'Times New Roman';">13</span></span></strong><strong><span style="font-size:16px;color:rgb(0,128,0);font-family:'宋体';">、说明：一条</span></strong><strong><span style="font-size:16px;color:rgb(0,128,0);"><span style="font-family:'Times New Roman';">sql&nbsp;</span></span></strong><strong><span style="font-size:16px;color:rgb(0,128,0);font-family:'宋体';">语句搞定数据库分页</span></strong><strong><span style="font-size:16px;color:rgb(0,128,0);"><br></span></strong><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">select top 10 b.* from (select top 20&nbsp;</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">主键字段</span><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">,</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">排序字段</span><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">&nbsp;from&nbsp;</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">表名</span><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">&nbsp;order by&nbsp;</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">排序字段</span><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">&nbsp;desc) a,</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">表名</span><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">&nbsp;b where b.</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">主键字段</span><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">&nbsp;= a.</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">主键字段</span><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">order by a.</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">排序字段</span><span style="font-size:16px;color:rgb(0,0,255);"><br></span><strong><span style="font-size:16px;font-family:'宋体';">具体实现：</span></strong><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';"><br></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">关于数据库分页：</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">&nbsp;&nbsp;declare @start int,@end int</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">&nbsp;&nbsp;@sql&nbsp;&nbsp;nvarchar(600)</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">&nbsp;&nbsp;set @sql=</span><span style="font-size:16px;color:rgb(255,0,0);font-family:'宋体';">’select top’</span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">+</span><span style="font-size:16px;color:rgb(255,0,0);font-family:'宋体';">str</span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">(@end-@start+1)+</span><span style="font-size:16px;color:rgb(255,0,0);font-family:'宋体';">’+from T where rid not in(select top’</span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">+</span><span style="font-size:16px;color:rgb(255,0,0);font-family:'宋体';">str</span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">(@str-1)+</span><span style="font-size:16px;color:rgb(255,0,0);font-family:'宋体';">’Rid from T where Rid&gt;-1)’</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">&nbsp;&nbsp;exec sp_executesql @sql</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';"><br></span><strong><span style="font-size:16px;font-family:'宋体';">注意：在</span></strong><strong><span style="font-size:16px;color:rgb(255,0,0);font-family:'宋体';">top</span></strong><strong><span style="font-size:16px;font-family:'宋体';">后不能直接跟一个变量，所以在实际应用中只有这样的进行特殊的处理。</span></strong><strong><span style="font-size:16px;color:rgb(255,0,0);font-family:'宋体';">Rid</span></strong><strong><span style="font-size:16px;font-family:'宋体';">为一个标识列，如果</span></strong><strong><span style="font-size:16px;color:rgb(255,0,0);font-family:'宋体';">top</span></strong><strong><span style="font-size:16px;font-family:'宋体';">后还有具体的字段，这样做是非常有好处的。因为这样可以避免</span></strong><strong><span style="font-size:16px;color:rgb(255,0,0);font-family:'宋体';">&nbsp;top</span></strong><strong><span style="font-size:16px;font-family:'宋体';">的字段如果是逻辑索引的，查询的结果后实际表中的不一致（</span></strong><strong><span style="font-size:16px;color:rgb(0,128,0);font-family:'宋体';">逻辑索引中的数据有可能和数据表中的不一致，而查询时如果处在索引则首先查询索引</span></strong><strong><span style="font-size:16px;font-family:'宋体';">）</span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">14</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：前10条记录</span><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select top 10 * form table1 where&nbsp;</span><span style="color:rgb(0,0,255);">范围</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">15</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：选择在每一组b值相同的数据中对应的a最大的记录的所有信息(类似这样的用法可以用于论坛每月排行榜,每月热销产品分析,按科目成绩排名,等等</span><span style="font-family:'宋体';">.)<br></span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select</span><span style="color:rgb(0,0,0);">&nbsp;a,b,c</span><span style="color:rgb(0,0,255);">&nbsp;from&nbsp;</span><span style="color:rgb(0,0,0);">tablename ta</span><span style="color:rgb(0,0,255);">&nbsp;where a=(select max(a) from tablename tb where tb.b=ta.b)</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">16</span><span style="color:rgb(0,128,0);">、说明：包括所有在&nbsp;</span><span style="color:rgb(0,0,0);">TableA</span><span style="color:rgb(0,128,0);">&nbsp;</span><span style="color:rgb(0,128,0);">中但不在&nbsp;</span><span style="color:rgb(0,0,0);">TableB</span><span style="color:rgb(0,128,0);">和</span><span style="color:rgb(0,0,0);">TableC</span><span style="color:rgb(0,128,0);">&nbsp;</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">中的行并消除所有重复行而派生出一个结果表</span><br></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">(select a from tableA ) except (select a from tableB) except (select a from tableC)</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">17</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：随机取出10条数据</span><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select top 10 * from&nbsp;</span><span style="color:rgb(0,0,0);">tablename</span><span style="color:rgb(0,0,255);">&nbsp;order by&nbsp;<strong>newid()</strong></span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">18</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：随机选择记录</span><br></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select newid()</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">19</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：删除重复记录</span><br><span style="font-family:'宋体';">1),</span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">delete from tablename where id not in (select max(id) from tablename group by col1,col2,...)<br></span><strong><span style="color:rgb(255,0,0);">2)</span></strong><span style="color:rgb(0,0,255);">,select distinct * into temp from&nbsp;</span><span style="color:rgb(255,0,0);">tablename</span></span><span style="color:rgb(0,0,255);"><br><span style="font-family:'宋体';">&nbsp;&nbsp;delete from&nbsp;</span></span><span style="color:rgb(255,0,0);"><span style="font-family:'宋体';">tablename</span></span><span style="color:rgb(0,0,255);"><br><span style="font-family:'宋体';">&nbsp;&nbsp;insert into&nbsp;</span></span><span style="color:rgb(255,0,0);"><span style="font-family:'宋体';">tablename</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">&nbsp;select * from temp<br></span></span><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">评价： 这种操作牵连大量的数据的移动，这种做法不适合大容量但数据操作</span></span><span style="color:rgb(0,0,255);"><br></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">3),</span><span style="color:rgb(0,0,0);">例如：在一个外部表中导入数据，由于某些原因第一次只导入了一部分，但很难判断具体位置，这样只有在下一次全部导入，这样也就产生好多重复的字段，怎样删除重复字段</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">alter table&nbsp;</span></span><span style="font-family:'宋体';"><span style="color:rgb(255,0,0);">tablename<br></span><span style="color:rgb(0,128,0);">--</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">添加一个自增列</span><br></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">add&nbsp;&nbsp;</span><span style="color:rgb(255,0,0);">column_b</span></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">&nbsp;int identity(1,1)<br>&nbsp;delete from&nbsp;</span><span style="color:rgb(255,0,0);">tablename</span></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">&nbsp;where column_b not in(<br>select&nbsp;</span><span style="color:rgb(255,0,0);">max(column_b</span><span style="color:rgb(0,0,255);">)&nbsp;&nbsp;from&nbsp;</span><span style="color:rgb(255,0,0);">tablename</span><span style="color:rgb(0,0,255);">&nbsp;group by</span><span style="color:rgb(255,0,0);">&nbsp;column1,column2,...</span></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">)<br>alter table&nbsp;</span><span style="color:rgb(255,0,0);">tablename</span><span style="color:rgb(0,0,255);">&nbsp;drop column&nbsp;</span><span style="color:rgb(255,0,0);">column_b</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">20</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：列出数据库里所有的表名</span><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select name from sysobjects where type='U' // U</span><span style="color:rgb(0,0,255);">代表用户</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">21</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：列出表里的所有的列名</span><br></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select name from syscolumns where id=object_id('TableName')</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">22</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：列示type、vender、pcs字段，以type字段排列，case可以方便地实现多重选择，类似select&nbsp;中的case。</span><br></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select type,sum(case vender when 'A' then pcs else 0 end),sum(case vender when 'C' then pcs else 0 end),sum(case vender when 'B' then pcs else 0 end) FROM tablename group by type<br></span></span><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">显示结果：</span><br></span><span style="color:rgb(255,102,0);"><span style="font-family:'宋体';">type vender pcs<br></span></span></strong><span style="color:rgb(255,102,0);"><span style="font-family:'宋体';">电脑</span><span style="font-family:'宋体';">&nbsp;A 1<br>电脑</span><span style="font-family:'宋体';">&nbsp;A 1<br>光盘</span><span style="font-family:'宋体';">&nbsp;B 2<br>光盘</span><span style="font-family:'宋体';">&nbsp;A 2<br>手机</span><span style="font-family:'宋体';">&nbsp;B 3<br>手机&nbsp;C 3</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">23</span><span style="color:rgb(0,128,0);">、说明：初始化表table1</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">TRUNCATE TABLE table1</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">24</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：选择从10到15的记录</span><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select top 5 * from (select top 15 * from table order by id asc) table_</span><span style="color:rgb(0,0,255);">别名&nbsp;order by id desc</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;text-align:center;"><strong><span style="font-size:24px;color:rgb(255,0,0);font-family:'华文隶书';">三、技巧</span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">1</span><span style="color:rgb(0,128,0);">、1=1，1=2的使用，在SQL语句组合时用的较多</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">“where 1=1”&nbsp;</span><span style="color:rgb(0,0,255);">是表示选择全部&nbsp;&nbsp;&nbsp; “where 1=2”全部不选，</span></span></strong><br><span style="font-family:'宋体';">如：</span><br><span style="color:rgb(128,0,0);"><span style="font-family:'宋体';">if @strWhere !=''&nbsp;<br>begin<br>set @strSQL = 'select count(*) as Total from [' + @tblName + '] where ' + @strWhere&nbsp;<br>end<br>else&nbsp;<br>begin<br>set @strSQL = 'select count(*) as Total from [' + @tblName + ']'&nbsp;<br>end</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><strong>我们可以直接写成</strong></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">错误！未找到目录项。</span><strong><span style="color:rgb(0,0,255);"><br><span style="font-family:'宋体';">set @strSQL = 'select count(*) as Total from [' + @tblName + '] where 1=1&nbsp;</span></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">安定&nbsp;'+ @strWhere&nbsp;</span><span style="color:rgb(0,128,0);">2</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、收缩数据库</span><br></span></strong><span style="font-family:'宋体';">--</span><span style="font-family:'宋体';">重建索引</span><br><span style="font-family:'宋体';">DBCC REINDEX<br>DBCC INDEXDEFRAG<br>--</span><span style="font-family:'宋体';">收缩数据和日志</span><br><span style="font-family:'宋体';">DBCC SHRINKDB<br>DBCC SHRINKFILE</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">3</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、压缩数据库</span><br></span></strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">dbcc shrinkdatabase(dbname)</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">4</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、转移数据库给新用户以已存在用户权限</span><br></span></strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">exec sp_change_users_login 'update_one','newname','oldname'<br>go</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">5</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、检查备份集</span><br></span></strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">RESTORE VERIFYONLY from disk='E:\dvbbs.bak'</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">6</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、修复数据库</span><br></span></strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">ALTER DATABASE [dvbbs] SET SINGLE_USER<br>GO<br>DBCC CHECKDB('dvbbs',repair_allow_data_loss) WITH TABLOCK<br>GO<br>ALTER DATABASE [dvbbs] SET MULTI_USER<br>GO</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">7</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、日志清除</span><br></span></strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">SET NOCOUNT ON<br>DECLARE @LogicalFileName sysname,<br>&nbsp;@MaxMinutes INT,<br>&nbsp;@NewSize INT</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><br><span style="font-family:'宋体';">USE tablename --&nbsp;</span><span style="font-family:'宋体';">要操作的数据库名</span><br><span style="font-family:'宋体';">SELECT&nbsp;&nbsp;@LogicalFileName = 'tablename_log', --&nbsp;</span><span style="font-family:'宋体';">日志文件名</span><br><span style="font-family:'宋体';">@MaxMinutes = 10, -- Limit on time allowed to wrap log.<br>&nbsp;@NewSize = 1&nbsp;&nbsp;--&nbsp;</span><span style="font-family:'宋体';">你想设定的日志文件的大小(M)</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">Setup / initialize<br>DECLARE @OriginalSize int<br>SELECT @OriginalSize = size&nbsp;<br>&nbsp;FROM sysfiles<br>&nbsp;WHERE name = @LogicalFileName<br>SELECT 'Original Size of ' + db_name() + ' LOG is ' +&nbsp;<br>&nbsp;CONVERT(VARCHAR(30),@OriginalSize) + ' 8K pages or ' +&nbsp;<br>&nbsp;CONVERT(VARCHAR(30),(@OriginalSize*8/1024)) + 'MB'<br>&nbsp;FROM sysfiles<br>&nbsp;WHERE name = @LogicalFileName<br>CREATE TABLE DummyTrans<br>&nbsp;(DummyColumn char (8000) not null)</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><br><span style="font-family:'宋体';">DECLARE @Counter&nbsp;&nbsp;&nbsp; INT,<br>&nbsp;@StartTime DATETIME,<br>&nbsp;@TruncLog&nbsp;&nbsp; VARCHAR(255)<br>SELECT @StartTime = GETDATE(),<br>&nbsp;@TruncLog = 'BACKUP LOG ' + db_name() + ' WITH TRUNCATE_ONLY'</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">DBCC SHRINKFILE (@LogicalFileName, @NewSize)<br>EXEC (@TruncLog)<br>-- Wrap the log if necessary.<br>WHILE @MaxMinutes &gt; DATEDIFF (mi, @StartTime, GETDATE()) -- time has not expired<br>&nbsp;AND @OriginalSize = (SELECT size FROM sysfiles WHERE name = @LogicalFileName)&nbsp;&nbsp;<br>&nbsp;AND (@OriginalSize * 8 /1024) &gt; @NewSize&nbsp;&nbsp;<br>&nbsp;BEGIN -- Outer loop.<br>SELECT @Counter = 0<br>&nbsp;WHILE&nbsp;&nbsp; ((@Counter &lt; @OriginalSize / 16) AND (@Counter &lt; 50000))<br>&nbsp;BEGIN -- update<br>&nbsp;INSERT DummyTrans VALUES ('Fill Log') DELETE DummyTrans<br>&nbsp;SELECT @Counter = @Counter + 1<br>&nbsp;END<br>&nbsp;EXEC (@TruncLog)&nbsp;&nbsp;<br>&nbsp;END<br>SELECT 'Final Size of ' + db_name() + ' LOG is ' +<br>&nbsp;CONVERT(VARCHAR(30),size) + ' 8K pages or ' +&nbsp;<br>&nbsp;CONVERT(VARCHAR(30),(size*8/1024)) + 'MB'<br>&nbsp;FROM sysfiles&nbsp;<br>&nbsp;WHERE name = @LogicalFileName<br>DROP TABLE DummyTrans<br>SET NOCOUNT OFF</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">8</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、说明：更改某个表</span><br></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">exec sp_changeobjectowner 'tablename','dbo'</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">9</span><span style="color:rgb(0,128,0);">、存储更改全部表</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">CREATE PROCEDURE dbo.User_ChangeObjectOwnerBatch<br>@OldOwner as NVARCHAR(128),<br>@NewOwner as NVARCHAR(128)<br>AS</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">DECLARE @Name&nbsp;&nbsp;&nbsp; as NVARCHAR(128)<br>DECLARE @Owner&nbsp;&nbsp; as NVARCHAR(128)<br>DECLARE @OwnerName&nbsp;&nbsp; as NVARCHAR(128)</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">DECLARE curObject CURSOR FOR&nbsp;<br>select 'Name'&nbsp;&nbsp;&nbsp; = name,<br>&nbsp;&nbsp; 'Owner'&nbsp;&nbsp;&nbsp; = user_name(uid)<br>from sysobjects<br>where user_name(uid)=@OldOwner<br>order by name</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">OPEN&nbsp;&nbsp; curObject<br>FETCH NEXT FROM curObject INTO @Name, @Owner<br>WHILE(@@FETCH_STATUS=0)<br>BEGIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>if @Owner=@OldOwner&nbsp;<br>begin<br>&nbsp;&nbsp; set @OwnerName = @OldOwner + '.' + rtrim(@Name)<br>&nbsp;&nbsp; exec sp_changeobjectowner @OwnerName, @NewOwner<br>end<br>-- select @name,@NewOwner,@OldOwner</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">FETCH NEXT FROM curObject INTO @Name, @Owner<br>END</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">close curObject<br>deallocate curObject<br><span style="font-size:12px;">GO</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-size:12px;"><br></span><strong><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">10</span></span><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">、SQL SERVER中直接循环写入数据</span><br></span></strong><span style="font-size:19px;color:rgb(0,0,255);"><span style="font-family:'宋体';">declare @i int<br>set @i=1<br>while @i&lt;30<br>begin<br></span></span><span style="font-size:19px;color:rgb(0,0,255);font-family:'Courier New';">&nbsp;&nbsp;&nbsp;</span><span style="font-size:19px;color:rgb(0,0,255);"><span style="font-family:'宋体';">&nbsp;insert into test (userid) values(@i)<br></span></span><span style="font-size:19px;color:rgb(0,0,255);font-family:'Courier New';">&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';"><span style="font-size:19px;color:rgb(0,0,255);">&nbsp;set @i=@i+1<br>end<br></span><strong><span style="font-size:16px;">案例</span></strong></span><strong><span style="font-size:12px;"><span style="font-family:'宋体';">：</span><br></span></strong><span style="font-family:'宋体';"><strong>有如下表，要求就裱中所有沒有及格的成績，在每次增長0.1的基礎上，使他們剛好及格:</strong></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(128,0,0);">Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;score</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">Zhangshan</span>&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,128);">80</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">Lishi&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,128);">59</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">Wangwu&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,128);">50</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">Songquan</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,128);">69</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><strong><span style="color:rgb(0,0,255);">while((select&nbsp;</span></strong><strong><span style="color:rgb(255,0,0);">min</span></strong><strong><span style="color:rgb(0,0,255);">(score) from tb_table)&lt;</span></strong><strong>60</strong><strong><span style="color:rgb(0,0,255);">)</span></strong></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">begin</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><strong><span style="color:rgb(0,0,255);">update tb_table set score&nbsp;</span></strong><strong>=</strong><strong><span style="color:rgb(0,0,255);">score*</span></strong><strong>1.01</strong></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><strong><span style="color:rgb(0,0,255);">where score</span></strong><strong>&lt;60</strong></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><strong><span style="color:rgb(0,0,255);">if&nbsp;&nbsp;(select&nbsp;</span></strong><strong><span style="color:rgb(255,0,0);">min</span></strong><strong><span style="color:rgb(0,0,255);">(score) from tb_table)</span></strong><strong>&gt;60</strong></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">&nbsp;&nbsp;break</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">&nbsp;else</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">&nbsp;&nbsp;&nbsp;&nbsp;continue</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">end</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;text-align:center;"><strong><span style="font-size:24px;color:rgb(255,0,0);font-family:'华文隶书';">数据开发-经典</span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">1.</span><span style="color:rgb(0,0,0);">按姓氏笔画排序:</span></span></strong><span style="color:rgb(0,0,255);"><br><span style="font-family:'宋体';">Select * From TableName Order By CustomerName Collate Chinese_PRC_Stroke_ci_as //</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">从少到多</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">2.</span><span style="color:rgb(0,0,0);">数据库加密:</span></span></strong><strong><span style="font-size:12px;"><br></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select encrypt('</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">原始密码</span><span style="font-family:'宋体';">')<br>select pwdencrypt('原始密码</span><span style="font-family:'宋体';">')<br>select pwdcompare('原始密码','加密后密码') = 1--相同；否则不相同&nbsp;encrypt('原始密码</span><span style="font-family:'宋体';">')<br>select pwdencrypt('原始密码</span><span style="font-family:'宋体';">')<br>select pwdcompare('原始密码','加密后密码') = 1--相同；否则不相同</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">3.</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">取回表中字段</span><span style="font-family:'宋体';">:<br></span></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">declare @list varchar(1000),<br>@sql nvarchar(1000)&nbsp;<br>select @list=@list+</span><span style="color:rgb(255,0,0);">','</span><span style="color:rgb(0,0,255);">+b.name from sysobjects a,syscolumns b where a.id=b.id and a.name=</span><span style="color:rgb(255,0,0);">'</span></span><span style="color:rgb(255,0,0);"><span style="font-family:'宋体';">表</span><span style="font-family:'宋体';">A'<br></span></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">set @sql=</span><span style="color:rgb(255,0,0);">'select '</span><span style="color:rgb(0,0,255);">+right(@list,len(@list)-1)+</span><span style="color:rgb(255,0,0);">' from&nbsp;</span><span style="color:rgb(255,0,0);">表A</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">'&nbsp;<br>exec (@sql)</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">4.</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">查看硬盘分区</span><span style="font-family:'宋体';">:<br></span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">EXEC master..xp_fixeddrives</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">5.</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">比较A,B表是否相等</span><span style="font-family:'宋体';">:<br></span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">if (select checksum_agg(binary_checksum(*)) from A)<br>&nbsp;&nbsp;&nbsp;&nbsp; =<br>&nbsp;&nbsp;&nbsp; (select checksum_agg(binary_checksum(*)) from B)<br>print '</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">相等</span><span style="font-family:'宋体';">'<br>else<br>print '不相等'</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">6.</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">杀掉所有的事件探察器进程</span><span style="font-family:'宋体';">:<br></span></span></strong><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">DECLARE hcforeach CURSOR GLOBAL FOR SELECT 'kill '+RTRIM(spid) FROM master.dbo.sysprocesses<br>WHERE program_name IN('SQL profiler',N'SQL&nbsp;</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">事件探查器</span><span style="font-family:'宋体';">')<br>EXEC sp_msforeach_worker '?</span></span><span style="font-family:'宋体';"><span style="font-size:12px;color:rgb(0,0,255);">'</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong><span style="font-size:16px;color:rgb(0,0,0);"><span style="font-family:'Times New Roman';">7.</span></span></strong><strong><span style="font-size:16px;font-family:'宋体';">记录搜索</span></strong><strong><span style="font-size:16px;"><span style="font-family:'Times New Roman';">:<br></span></span></strong><strong><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">开头到</span></strong><strong><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">N</span></span></strong><strong><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">条记录</span></strong><strong><span style="font-size:16px;color:rgb(0,0,255);"><br></span></strong><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">Select Top N * From&nbsp;</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">表</span><span style="font-size:16px;color:rgb(0,0,255);"><br></span><span style="font-size:3px;"><span style="font-family:'Times New Roman';"><span style="color:rgb(0,0,255);">-------------------------------<br></span><strong><span style="font-size:16px;color:rgb(0,0,255);">N</span></strong></span><strong><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">到</span></strong><strong><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">M</span></span></strong><strong><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">条记录</span></strong><strong><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">(</span></span></strong><strong><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">要有主索引</span></strong></span><span style="font-family:'Times New Roman';"><strong><span style="font-size:16px;color:rgb(0,0,255);">ID)<br></span></strong><span style="font-size:16px;color:rgb(0,0,255);">Select Top M-N * From&nbsp;</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">表</span><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">&nbsp;Where ID in (Select Top M ID From&nbsp;</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">表</span><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">) Order by ID&nbsp;&nbsp; Desc<br>----------------------------------<br><strong>N</strong></span></span><strong><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">到结尾记录</span></strong><strong><span style="font-size:16px;color:rgb(0,0,255);"><br></span></strong><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">Select Top N * From&nbsp;</span></span><span style="font-size:16px;color:rgb(0,0,255);font-family:'宋体';">表</span><span style="font-size:16px;color:rgb(0,0,255);"><span style="font-family:'Times New Roman';">&nbsp;Order by ID Desc<br></span></span><strong><span style="font-size:16px;color:rgb(0,128,0);font-family:'宋体';">案例</span><span style="color:rgb(0,128,0);"><br></span></strong><strong><span style="font-family:'宋体';">例如1：一张表有一万多条记录，表的第一个字段&nbsp;RecID&nbsp;是自增长字段， 写一个SQL语句， 找出表的第</span></strong><strong><span style="color:rgb(255,0,0);font-family:'宋体';">31</span></strong><strong><span style="font-family:'宋体';">到第</span></strong><strong><span style="color:rgb(255,0,0);font-family:'宋体';">40</span></strong><strong><span style="font-family:'宋体';">个记录。</span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="color:rgb(0,0,255);font-family:'宋体';">&nbsp;select top 10 recid from A where recid not&nbsp;&nbsp;in(select top 30 recid from A)</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="color:rgb(0,0,255);font-family:'宋体';">分析：如果这样写会产生某些问题，如果recid在表中存在逻辑索引。</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="color:rgb(0,0,255);font-family:'宋体';">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';">select top 10 recid from A where</span><span style="font-family:'宋体';">……是从索引中查找，而后面的</span><span style="color:rgb(0,0,255);font-family:'宋体';">select top 30 recid from A</span><span style="font-family:'宋体';">则在数据表中查找，这样由于索引中的顺序有可能和数据表中的不一致，这样就导致查询到的不是本来的欲得到的数据。</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong><span style="font-family:'宋体';">解决方案</span></strong></p>
    <p style="margin-left:72px;clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong><span style="font-family:'宋体';">1，<span style="font-weight:normal;font-size:9px;line-height:normal;font-family:'Times New Roman';">&nbsp;</span></span></strong><strong><span style="font-family:'宋体';">用order by&nbsp;</span></strong><span style="color:rgb(0,0,255);font-family:'宋体';">select top 30 recid from A order by ricid&nbsp;</span><strong><span style="font-family:'宋体';">如果该字段不是自增长，就会出现问题</span></strong></p>
    <p style="margin-left:72px;clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong><span style="color:rgb(0,128,0);"><span style="font-family:'Times New Roman';">2，<span style="font-weight:normal;font-size:9px;line-height:normal;"><span style="font-size:3px;">&nbsp;</span></span></span></span></strong><strong><span style="font-family:'宋体';">在那个子查询中也加条件：</span></strong><span style="font-family:'Times New Roman';">select top 30 recid from A where recid&gt;-1</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong><span style="font-family:'宋体';">例</span><span style="font-family:'Times New Roman';">2</span></strong><strong><span style="font-family:'宋体';">：查询表中的最后以条记录，并不知道这个表共有多少数据</span><span style="font-family:'Times New Roman';">,</span></strong><strong><span style="font-family:'宋体';">以及表结构。</span><br><span style="font-family:'Times New Roman';"><span style="color:rgb(0,0,255);">set&nbsp;</span>@s<span style="color:rgb(0,0,255);">&nbsp;=&nbsp;</span><span style="color:rgb(255,0,0);">'select top 1 * from T&nbsp;&nbsp;&nbsp;where pid not in (select top '</span><span style="color:rgb(0,0,255);">&nbsp;+</span><span style="color:rgb(255,0,255);">&nbsp;str</span><span style="color:rgb(0,0,255);">(</span>@count-1<span style="color:rgb(0,0,255);">) +&nbsp;</span><span style="color:rgb(255,0,0);">' pid&nbsp;&nbsp;from&nbsp;&nbsp;T)'</span></span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:13px;line-height:19px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong><span style="font-family:'Times New Roman';"><span style="color:rgb(0,0,255);">print&nbsp;</span>@s<span style="color:rgb(0,0,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exec&nbsp;&nbsp;</span><span style="color:rgb(255,0,255);">sp_executesql</span><span style="color:rgb(0,0,255);">&nbsp;&nbsp;</span>@s</span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">9</span><span style="color:rgb(0,0,0);">：获取当前数据库中的所有用户表</span></span></strong><span style="color:rgb(0,0,0);"><br></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select Name from sysobjects where xtype='u' and status&gt;=0</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">10</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">：获取某一个表的所有字段</span><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select name from&nbsp;</span><span style="color:rgb(0,128,0);">syscolumns</span><span style="color:rgb(0,0,255);">&nbsp;where id=</span><span style="color:rgb(255,0,0);">object_id</span><span style="color:rgb(0,0,255);">('</span><span style="color:rgb(0,0,255);">表名')</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select name from&nbsp;</span><span style="color:rgb(0,128,0);">syscolumns</span><span style="color:rgb(0,0,255);">&nbsp;where id in (select id from&nbsp;</span><span style="color:rgb(0,128,0);">sysobjects</span><span style="color:rgb(0,0,255);">&nbsp;where type = 'u' and name = '</span><span style="color:rgb(0,0,255);">表名')</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,128,0);"><span style="font-family:'宋体';">两种方式的效果相同</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">11</span><span style="color:rgb(0,0,0);">：查看与某一个表相关的视图、存储过程、函数</span></span></strong><strong><span style="font-size:12px;"><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select a.* from&nbsp;</span><span style="color:rgb(0,128,0);">sysobjects</span><span style="color:rgb(0,0,255);">&nbsp;a,&nbsp;</span><span style="color:rgb(0,128,0);">syscomments</span><span style="color:rgb(0,0,255);">&nbsp;b where a.id = b.id and b.text like '%</span><span style="color:rgb(0,0,255);">表名%'</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">12</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">：查看当前数据库中所有存储过程</span><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select name as&nbsp;</span><span style="color:rgb(0,0,255);">存储过程名称&nbsp;from&nbsp;</span><span style="color:rgb(0,128,0);">sysobjects</span><span style="color:rgb(0,0,255);">&nbsp;where xtype='P'</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">13</span><span style="color:rgb(0,0,0);">：查询用户创建的所有数据库</span></span></strong><span style="font-size:12px;"><br></span><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * from master..</span><span style="color:rgb(0,128,0);">sysdatabases</span><span style="color:rgb(0,0,255);">&nbsp;D where sid not in(select sid from master..</span><span style="color:rgb(0,128,0);">syslogins</span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">&nbsp;where name='sa')<br></span></span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">或者</span><br><span style="font-family:'宋体';">select dbid, name AS DB_NAME from master..s</span></span><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">ysdatabases</span><span style="color:rgb(0,0,255);">&nbsp;where sid &lt;&gt; 0x01</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">14</span></span><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">：查询某一个表的字段和数据类型</span><br></span></strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select column_name,data_type from information_schema.columns<br>where table_name = '</span><span style="color:rgb(0,0,255);">表名'</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="color:rgb(0,0,0);"><span style="font-family:'宋体';">15</span></span></strong><span style="font-family:'宋体';"><strong>：不同服务器数据库之间的数据操作</strong></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><strong><span style="color:rgb(0,128,0);">--</span></strong><strong><span style="color:rgb(0,128,0);">创建链接服务器</span></strong></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">exec sp_addlinkedserver&nbsp;&nbsp;&nbsp;'ITSV ', ' ', 'SQLOLEDB ', '</span><span style="color:rgb(0,0,255);">远程服务器名或ip地址&nbsp;'</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">exec sp_addlinkedsrvlogin&nbsp;&nbsp;'ITSV ', 'false ',null, '</span><span style="color:rgb(0,0,255);">用户名&nbsp;', '密码&nbsp;'</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(255,0,0);">--</span><span style="color:rgb(255,0,0);">查询示例</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * from ITSV.</span><span style="color:rgb(0,0,255);">数据库名.dbo.表名</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(255,0,0);">--</span><span style="color:rgb(255,0,0);">导入示例</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * into&nbsp;</span><span style="color:rgb(0,0,255);">表&nbsp;from ITSV.数据库名.dbo.表名</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><strong><span style="color:rgb(0,128,0);">--</span></strong><strong><span style="color:rgb(0,128,0);">以后不再使用时删除链接服务器</span></strong></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">exec sp_dropserver&nbsp;&nbsp;'ITSV ', 'droplogins '</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><strong><span style="color:rgb(0,128,0);">--</span></strong><strong><span style="color:rgb(0,128,0);">连接远程/局域网数据</span></strong><span style="color:rgb(0,0,255);">(openrowset/openquery/opendatasource)</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">--1</span><span style="color:rgb(0,0,255);">、openrowset</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(255,0,0);">--</span><span style="color:rgb(255,0,0);">查询示例</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * from openrowset( 'SQLOLEDB ', 'sql</span><span style="color:rgb(0,0,255);">服务器名&nbsp;'; '用户名&nbsp;'; '密码&nbsp;',数据库名.dbo.表名)</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(255,0,0);">--</span><span style="color:rgb(255,0,0);">生成本地表</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * into&nbsp;</span><span style="color:rgb(0,0,255);">表&nbsp;from openrowset( 'SQLOLEDB ', 'sql服务器名&nbsp;'; '用户名&nbsp;'; '密码&nbsp;',数据库名.dbo.表名)</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';color:rgb(255,0,0);">--</span><span style="font-family:'宋体';color:rgb(255,0,0);">把本地表导入远程表</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">insert openrowset( 'SQLOLEDB ', 'sql</span><span style="color:rgb(0,0,255);">服务器名&nbsp;'; '用户名&nbsp;'; '密码&nbsp;',数据库名.dbo.表名)</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select *from&nbsp;</span><span style="color:rgb(0,0,255);">本地表</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(255,0,0);">--</span><span style="color:rgb(255,0,0);">更新本地表</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">update b</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">set b.</span><span style="color:rgb(0,0,255);">列A=a.列A</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">&nbsp;from openrowset( 'SQLOLEDB ', 'sql</span><span style="color:rgb(0,0,255);">服务器名&nbsp;'; '用户名&nbsp;'; '密码&nbsp;',数据库名.dbo.表名)as a inner join&nbsp;本地表&nbsp;b</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">on a.column1=b.column1</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">--openquery</span><span style="color:rgb(0,0,255);">用法需要创建一个连接</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">-</span><span style="color:rgb(255,0,0);">-</span><span style="color:rgb(255,0,0);">首先创建一个连接创建链接服务器</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">exec sp_addlinkedserver&nbsp;&nbsp;&nbsp;'ITSV ', ' ', 'SQLOLEDB ', '</span><span style="color:rgb(0,0,255);">远程服务器名或ip地址&nbsp;'</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">--</span><span style="color:rgb(0,0,255);">查询</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">select *</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">FROM openquery(ITSV,&nbsp;&nbsp;'SELECT *&nbsp;&nbsp;FROM&nbsp;</span><span style="color:rgb(0,0,255);">数据库.dbo.表名&nbsp;')</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(255,0,0);">--</span><span style="color:rgb(255,0,0);">把本地表导入远程表</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">insert openquery(ITSV,&nbsp;&nbsp;'SELECT *&nbsp;&nbsp;FROM&nbsp;</span><span style="color:rgb(0,0,255);">数据库.dbo.表名&nbsp;')</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * from&nbsp;</span><span style="color:rgb(0,0,255);">本地表</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(255,0,0);">--</span><span style="color:rgb(255,0,0);">更新本地表</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">update b</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">set b.</span><span style="color:rgb(0,0,255);">列B=a.列B</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">FROM openquery(ITSV,&nbsp;&nbsp;'SELECT * FROM&nbsp;</span><span style="color:rgb(0,0,255);">数据库.dbo.表名&nbsp;') as a&nbsp;</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">inner join&nbsp;</span><span style="color:rgb(0,0,255);">本地表&nbsp;b on a.列A=b.列A</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">--3</span><span style="color:rgb(0,128,0);">、opendatasource/openrowset</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">SELECT&nbsp;&nbsp;&nbsp;*</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">FROM&nbsp;&nbsp;&nbsp;opendatasource( 'SQLOLEDB ',&nbsp;&nbsp;'Data Source=ip/ServerName;User ID=</span><span style="color:rgb(0,0,255);">登陆名;Password=密码&nbsp;' ).test.dbo.roy_ta</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,128,0);">--</span><span style="color:rgb(0,128,0);">把本地表导入远程表</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">insert opendatasource( 'SQLOLEDB ',&nbsp;&nbsp;'Data Source=ip/ServerName;User ID=</span><span style="color:rgb(0,0,255);">登陆名;Password=密码&nbsp;').数据库.dbo.表名</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="color:rgb(0,0,255);">select * from&nbsp;</span><span style="color:rgb(0,0,255);">本地表&nbsp;</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;text-align:center;"><strong><span style="font-weight:normal;font-size:24px;color:rgb(255,0,0);font-family:'宋体';">SQL Server</span></strong><strong><span style="font-weight:normal;font-size:24px;color:rgb(255,0,0);font-family:'宋体';">基本函数</span></strong></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><span style="font-size:12px;">SQL Server</span><span style="font-size:12px;">基本函数</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><strong><span style="font-family:'宋体';"><span style="color:rgb(0,0,0);">1.</span><span style="color:rgb(0,0,0);">字符串函数&nbsp;</span></span></strong><span style="font-family:'宋体';"><span style="font-size:12px;">长度与分析用</span></span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><strong><span style="font-size:19px;color:rgb(255,0,255);">1,datalength</span></strong><span style="color:rgb(255,0,255);">(</span>Char_expr)&nbsp;返回字符串包含字符数,但不包含后面的空格</span><span style="font-size:12px;"><br></span><span style="font-family:'宋体';"><strong><span style="font-size:19px;color:rgb(255,0,255);">2,substring</span></strong>(expression,start,length)&nbsp;取子串，字符串的下标是从“<span style="color:rgb(255,0,0);">1</span>”，start为起始位置，length为字符串长度，实际应用中以<span style="color:rgb(255,0,0);">len(expression)</span>取得其长度</span><span style="font-size:12px;"><br></span><span style="font-family:'宋体';"><strong><span style="font-size:19px;color:rgb(255,0,255);">3,right</span></strong>(char_expr,int_expr)&nbsp;返回字符串右边第int_expr个字符，还用<strong><span style="color:rgb(255,0,255);">left</span></strong></span><span style="font-family:'宋体';">于之相反</span><br><span style="font-family:'宋体';"><strong><span style="font-size:19px;color:rgb(255,0,255);">4,isnull</span>(&nbsp;</strong><span>check</span><strong>_</strong><span>expression&nbsp;</span><strong>,</strong>&nbsp;<span>replacement_value&nbsp;</span><strong>)</strong>如果check_expression為空，則返回replacement_value的值，不為空，就返回check_expression字符操作类</span></p>
    <p style="clear:both;color:rgb(85,85,85);font-size:14px;font-family:Verdana, Arial, Helvetica, sans-serif;line-height:25px;"><span style="font-family:'宋体';"><strong>5,Sp_addtype</strong><span style="font-size:12px;">&nbsp;</span></span><span style="color:rgb(0,0,128);"><span style="font-family:'宋体';">自定義數據類型</span><br></span><span style="font-family:'宋体';"><span style="font-size:12px;color:rgb(0,0,128);">例如：</span><code>EXEC sp_addtype birthday, datetime, 'NULL'</code></span></p>
    <pre style="margin-left:22px;font-family:'Courier New', monospace;font-size:14px;color:rgb(85,85,85);line-height:25px;">6,set&nbsp;nocount&nbsp;{on|off}</pre>
    <pre style="margin-left:22px;font-family:'Courier New', monospace;font-size:14px;color:rgb(85,85,85);line-height:25px;">使返回的结果中不包含有关受&nbsp;Transact-SQL&nbsp;语句影响的行数的信息。如果存储过程中包含的一些语句并不返回许多实际的数据，则该设置由于大量减少了网络流量，因此可显著提高性能。SET&nbsp;NOCOUNT&nbsp;设置是在执行或运行时设置，而不是在分析时设置。</pre>
    <pre style="margin-left:22px;font-family:'Courier New', monospace;font-size:14px;color:rgb(85,85,85);line-height:25px;"><span style="font-family:'宋体';">SET NOCOUNT 为 ON 时，不返回计数（表示受 Transact-SQL 语句影响的行数）。</span><br><span style="font-family:'宋体';">SET NOCOUNT </span><span style="font-family:'宋体';">为 OFF 时，返回计数</span></pre>
    <pre style="margin-left:22px;font-family:'Courier New', monospace;font-size:14px;color:rgb(85,85,85);line-height:25px;text-align:center;">常识</pre>
    <pre style="margin-left:22px;font-family:'Courier New', monospace;font-size:14px;color:rgb(85,85,85);line-height:25px;text-align:center;">&nbsp;<br></pre>
    <pre style="margin-left:22px;font-family:'Courier New', monospace;font-size:14px;color:rgb(85,85,85);line-height:25px;">在SQL查询中：from后最多可以跟多少张表或视图：256</pre>
    <pre style="margin-left:22px;font-family:'Courier New', monospace;font-size:14px;color:rgb(85,85,85);line-height:25px;">在SQL语句中出现&nbsp;Order&nbsp;by,查询时，先排序，后取</pre>
    <pre style="margin-left:22px;font-family:'Courier New', monospace;font-size:14px;color:rgb(85,85,85);line-height:25px;">在SQL中，一个字段的最大容量是8000，而对于nvarchar(4000),由于nvarchar是Unicode码。</pre>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
