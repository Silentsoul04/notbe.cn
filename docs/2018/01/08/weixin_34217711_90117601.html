<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>向Java开发者介绍Scala « NotBeCN</title>
  <meta name="description" content="             Scala结合了面向对象编程与函数编程思想，使用一种能够完全兼容Java、可以运行在Java虚拟机上的、简洁的语法。对于函数编程风格的支持，尤其是对于Lambda表达式的支持，能够有助于减少必须要编写的逻辑无关固定代码，也许让它可以更简单的关注要面对的任务本身，而相对的Java中对Lam...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2018/01/08/weixin_34217711_90117601.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">向Java开发者介绍Scala</h1>
    <p class="post-meta">Jan 8, 2018</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <h2 style="font-size:18px;letter-spacing:-1px;background-image:url(&quot;images/dotsH.gif&quot;);background-position:left bottom;background-repeat:repeat-x;font-weight:normal;line-height:21.6px;color:rgb(51,51,51);font-family:Merriweather, Georgia, '微软雅黑', '黑体', '宋体';">Scala结合了面向对象编程与函数编程思想，使用一种能够完全兼容Java、可以运行在Java虚拟机上的、简洁的语法。对于函数编程风格的支持，尤其是对于Lambda表达式的支持，能够有助于减少必须要编写的逻辑无关固定代码，也许让它可以更简单的关注要面对的任务本身，而相对的Java中对Lamdba表达式的支持要到预定于2012年发布的JavaSE8才会实现。本文就是对于Scala介绍。<br></h2> 
   <div class="entry" style="line-height:1.8;"> 
    <div class="blogpost-body" style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"> 
     <div class="vendor-content-box-float" style="line-height:14px;width:275px;border:2px solid rgb(238,238,238);font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;"> 
      <h3 style="font-size:12px;line-height:normal;font-family:arial;letter-spacing:0px;border-bottom:1px dashed rgb(204,204,204);color:rgb(78,129,187);">相关<span class="vendor" style="color:rgb(135,178,227);">厂商</span>内容</h3> 
      <p style="line-height:1.8;font-family:Merriweather, Georgia, '微软雅黑', '黑体', '宋体';font-size:12px;background-image:url(&quot;http://cdn1.infoq.com/styles/cn/i/icon-rvc.gif&quot;);background-position:0px 0px;background-repeat:no-repeat;"><a href="http://www.infoq.com/cn/vendorcontent/show.action?vcr=1445" rel="nofollow" style="text-decoration:none;color:rgb(51,51,51);border-bottom-width:1px;border-bottom-style:dashed;font-weight:bold;">Flash Builder 4.5高级版试用版免费高速下载</a></p> 
      <p style="line-height:1.8;font-family:Merriweather, Georgia, '微软雅黑', '黑体', '宋体';font-size:12px;background-image:url(&quot;http://cdn1.infoq.com/styles/cn/i/icon-rvc.gif&quot;);background-position:0px 0px;background-repeat:no-repeat;"><a href="http://www.infoq.com/cn/vendorcontent/show.action?vcr=1607" rel="nofollow" style="text-decoration:none;color:rgb(51,51,51);border-bottom-width:1px;border-bottom-style:dashed;font-weight:bold;">QClub（北京站）——《云计算与虚拟化在企业架构中的实施》（10月12日 晚7点）</a></p> 
     </div> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">作为第一步，先安装好最新的Scala发布包<a href="http://typesafe.com/stack" rel="nofollow" style="text-decoration:none;color:rgb(11,89,178);border-bottom-width:1px;border-bottom-style:dashed;">T</a><a href="http://typesafe.com/stack" rel="nofollow" style="text-decoration:none;color:rgb(11,89,178);border-bottom-width:1px;border-bottom-style:dashed;">ypesafe stack</a>，打开命令行窗口，键入“scala”：这会启动REPL（读入-运算 输出 循环）交互式编码环境。然后你就可以写下你的第一行Scala代码：</p> 
     <p style="line-height:1.8;font-family:Merriweather, Georgia, '微软雅黑', '黑体', '宋体';font-size:15px;"><span style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">scala&gt; val columbus : Int = 1492</span><br style="font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;line-height:19px;"><span style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">columbus: Int = 1492</span></p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;"></p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">我们刚刚声明了一个类型为Int的变量，初始值为1492，就像我们在Java里用语句Int columbus = 1492;所做的一样。除了把类型放在变量之后这样一种反向的声明方式之外，Scala在这里所表现出的不同是使用“val”来显性地把变量声明为不可变。如果我们想要修改这个变量:</p> 
     <pre>scala&gt; columbus = 1500
 &lt;console&gt;:8: error: reassignment to val
&nbsp;&nbsp; columbus = 1500
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ^</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">请注意错误消息精确地指出了错误位于行的哪个位置。再尝试声明这个变量，但这一次用“var”，让其可变更。这样编译器拥有足够的智能来推断出1492是一个整数，你也就不需要指定类型了：</p> 
     <pre> scala&gt; var columbus = 1492
 columbus: Int = 1492

scala&gt; columbus = 1500  columbus: Int = 1500</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">接下来，我们来定义一个类：</p> 
     <pre>scala&gt; case class Employee( name:String="guest", age:Int=30, company:String =  "DevCode" )
 defined class Employee </pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">我们定义了一个类，名为Employee，有三个不可变更的字段：name、age和company，各自有自己的缺省值。关键字“case”相当于Java里的switch语句，只不过要更为灵活。它说明该类具有模式匹配的额外机制，以及其他一些特性，包括用来创建实例的工厂方法（不需要使用“new”关键字来构造），同样的也不需要创建缺省的getter方法。与Java中不同的是，变量缺省下的访问控制是public（而不是protected），而Scala为公开变量创建一个getter方法，并命名为变量名。如果你愿意，你也可以把字段定义成可变且/或私有（private）的，只需要在参数之前使用“var”（例如：case class Person(private var name:String)）。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">我们再来用不同方式创建一些实例，看看其他的特性，像是命名参数和缺省参数（从Scala2.8开始引入）：</p> 
     <pre>scala&gt; val guest = Employee()
 guest: Employee = Employee(guest,30,DevCode)

scala&gt; val guestAge = guest.age // （age变量的缺省getter方法）  guestAge: Int = 300
scala&gt; val anna = Employee("Anna")  anna: Employee = Employee(Anna,30,DevCode)
scala&gt; val thomas = Employee("Thomas",41)  thomas: Employee = Employee(Thomas,41,DevCode)
scala&gt; val luke = Employee("Luke", company="LucasArt")  luke: Employee = Employee(Luke,30,LucasArt)
scala&gt; val yoda = luke.copy("Yoda", age=800)  yoda: Employee = Employee(Yoda,800,LucasArt)</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">不过，下面的写法</p> 
     <pre> 
scala&gt; val darth = Employee("Darth", "DevCode")
 &lt;console&gt;:9: error: type mismatch;
 found : java.lang.String("DevCode")
 required: Int
 Error occurred in an application involving default arguments.
&nbsp;&nbsp;&nbsp;&nbsp; val darth = Employee("Darth", "DevCode")
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;^</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">是行不通的（可不是因为Darth不是DevCode的雇员！），这是由于构造函数在这个位置需要age作为参数，因为函数参数没有显性地进行命名。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">现在我们再来看集合，这才是真正让人兴奋的地方。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">有了泛型（Java5以上），Java可以遍历一个——比方说整数型列表，用下面这样的代码：</p> 
     <pre>List&lt;Integer&gt; numbers = new arrayList&lt;Integer&gt;();
    numbers.add(1);
    numbers.add(2);
    numbers.add(3);
    for(Integer n:numbers) {
        System.out.println("Number "+n);
}</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">运行的结果是</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">Number 1<br> Number 2<br> Number 3</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">Scala对于可变集合和不可变集合进行了系统性地区别处理，不过鼓励使用不可变集合，也因此在缺省情况下创建不可变集合。这些集合是通过模拟的方式实现添加、更新和删除操作，在这些操作中，不是修改集合，而是返回新的集合。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">与前面的Java代码等价的Scala代码可能像下面这样：</p> 
     <pre>scala&gt; val numbers = List(1,2,3)
 numbers: List[Int] = List(1, 2, 3)

scala&gt; for (n &lt;- numbers) println("Number "+n)  Number 1  Number 2  Number 3</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">这里的“for”循环语法结构非常接近于Java的命令式编程风格。在Scala（以及Java虚拟机上其他很多语言如：Groovy、JRuby或JPython）里还有另外一种方式来实现上面的逻辑。这种方式使用一种更加偏向函数编程的风格，引入了Lambda表达式（有时也称为闭包——closure）。简单地说，Lambda表达式就是你可以拿来当作参数传递的函数。这些函数使用参数作为输入（在我们的例子中就是“n”整型变量），返回语句作为函数体的最终语句。他们的形式如下</p> 
     <pre>functionName { input =&gt;
    body
}

scala&gt; numbers.foreach { n:Int =&gt; &nbsp;&nbsp;&nbsp;&nbsp;// 按回车键继续下一行 
&nbsp;&nbsp;&nbsp; | println("Number "+n)  
&nbsp;&nbsp;&nbsp; | }  Number 1  Number 2  Number 3</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">上面的例子中，函数体只有一条语句（println……），返回的是单位（Unit，也就是“空结果”），也就是大致相当于Java中的void，不过有一点不同的是——void是不返回任何结果的。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">除了只打印出我们的数值列表以外，应该说我们更想做的是处理和变换这些元素，这时我们需要调用方法来生成结果列表，以便后面接着使用。让我们尝试一些例子：</p> 
     <pre>scala&gt; val reversedList = numbers.reverse
 reversedList: List[Int] = List(3, 2, 1)

scala&gt; val numbersLessThan3 = numbers.filter { n =&gt; n &lt; 3 }  numbersLessThan3: List[Int] = List(1, 2)
scala&gt; val oddNumbers = numbers.filterNot { n =&gt; n % 2 == 0 }  oddNumbers: List[Int] = List(1, 3)
scala&gt; val higherNumbers = numbers.map { n =&gt; n + 10 }  higherNumbers: List[Int] = List(11, 12, 13)</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">最后的这一个变换“map”非常有用，它对列表的每一个元素应用闭包，结果是一个同样大小的、包含了每个变换后元素的列表。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">我们在这里还想介绍最后的一个方法，就是“foldLeft”方法，它把状态从一个元素传播到另一个元素。比如说，要算出一个列表里所有元素的和，你需要累加它们，并在切换元素的时候保存中间的计数：</p> 
     <pre>scala&gt; val sumOfNumbers = numbers.foldLeft(0) { (total,element) =&gt;
&nbsp;&nbsp;&nbsp; | total + element
&nbsp;&nbsp;&nbsp; | }
 sumOfNumbers: Int = 6</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">作为第一个变量传递给foldLeft的值0是初始值（也就是说在把函数用到第一个列表元素的时候total=0）。(total,element)代表了一个Tuple2，在Scala里这是一个二元组（就像要表示三维空间坐标，经常要用到Tuple3(x,y,z)等等）。注意在合计时，Scala的编程接口实际上提供了一个“sum”方法，这样上一条语句就可以写成：</p> 
     <pre>scala&gt; val sumOfNumbers = numbers.sum
 sumOfNumbers: Int = 6</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">还有许多其他的类似的集合变换方法，你可以参照<a href="http://www.scala-lang.org/api/current/index.html#scala.collection.immutable.List" rel="nofollow" style="text-decoration:none;color:rgb(11,89,178);border-bottom-width:1px;border-bottom-style:dashed;">scaladoc API</a>。你也可以把这些方法组合起来（例如：numbers.reverse.filter……），让代码更加简洁，不过这样会影响可读性。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">最后，{ n =&gt; n + 10 }还可以简单地写成(_ + 10)，也就是说如果输入参数只是用于你调用的方法，则不需要声明它；在我们的例子里，“n”被称为匿名变量，因为你可以把它用任何形式来代替，比如说“x”或者“number”，而下划线则表示一处需要用你的列表的每个元素来填补的空白。（与“_”的功能类似，Groovy保留了关键字“it”，而Python则使用的是“self”）。</p> 
     <pre>scala&gt; val higherNumbers = numbers.map(_+10)
 higherNumbers: List[Int] = List(11, 12, 13) </pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">在介绍了对整数的基本处理后，我们可以迈入下一个阶段，看看复杂对象集合的变换，例如使用我们上面所定义的Employee类：</p> 
     <pre>scala&gt; val allEmployees = List(luke,anna,guest,yoda,thomas)
 allEmployees: List[Employee] = List(Employee(Luke,30,LucasArt),  Employee(Anna,30,DevCode), Employee(guest,30,DevCode),  Employee(Yoda,800,LucasArt), Employee(Thomas,41,DevCode))</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">从这个五个元素的列表里，我们可以应用一个条件来过滤出应用匿名方法后返回值为True的雇员，这样就得到了——比方说属于DevCode的雇员：</p> 
     <pre>scala&gt; val devcodeEmployees = allEmployees.filter { _.company == "DevCode" }
 devcodeEmployees: List[Employee] = List(Employee(Anna,30,DevCode),  Employee(guest,30,DevCode), Employee(Thomas,41,DevCode))

scala&gt; val oldEmployees = allEmployees.filter(_.age &gt; 100).map(_.name)  oldEmployees: List[String] = List(Yoda)</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">假设我们手头的allEmployees集合是我们使用SQL查询获得的结果集，查询语句可能类似于“SELECT * FROM employees WHERE company = ‘DevCode’ ”。现在我们可以把List[Employee]变换到以company名称作为键、属于该公司的所有员工的列表作为值的Map类型，这样就可以把雇员按company来排序：</p> 
     <pre> scala&gt; val sortedEmployees = allEmployees.groupBy(_.company)
 sortedEmployees: scala.collection.immutable.Map[String,List[Employee]] = Map(DevCode - &gt; List(Employee(Anna,30,DevCode), Employee(guest,30,DevCode),  Employee(Thomas,41,DevCode)), LucasArt -&gt; List(Employee(Luke,30,LucasArt),  Employee(Yoda,800,LucasArt)))</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">每一个列表已经作为一个值存入了（键——值）哈希表，为了示范如何进一步处理这些列表，可以设想我们需要计算每个公司的雇员平均年龄。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">这具体意味着我们必须要计算每个列表的每个雇员的的“age”字段的和，然后除以该列表中雇员的数量。让我们先计算一下DevCode：</p> 
     <pre>scala&gt; devcodeEmployees
 res4: List[Employee] = List(Employee(Anna,30,DevCode), Employee(guest,30,DevCode),  Employee(Thomas,41,DevCode))

scala&gt; val devcodeAges = devcodeEmployees.map(_.age)  devcodeAges: List[Int] = List(30, 30, 41)
scala&gt; val devcodeAverageAge = devcodeAges.sum / devcodeAges.size  devcodeAverageAge: Int = 33</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">回到我们的Map (key:String -&gt;value:List[Employee])，下面是个更加一般性的例子。我们现在可以归并并计算每个公司的平均年龄，要做的只是写几行代码：</p> 
     <pre> 
scala&gt; val averageAgeByCompany = sortedEmployees.map{ case(key,value)=&gt;
&nbsp;&nbsp;&nbsp; | value(0).copy(name="average",age=(value.map(_.age).sum)/value.size)}
 averageAgeByCompany: scala.collection.immutable.Iterable[Employee] =  List(Employee(average,33,DevCode), Employee(average,415,LucasArt))</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">这里的“case(key,value)”说明了Scala提供的模式匹配机制是多么强大。请参考Scala的文档来获取更多的信息。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">到这里我们的任务就完成了。我们实现的是一个简单的Map-Reduce算法。由于每个公司雇员的归并是完全独立于其他公司，这个算法非常直观地实现了并行计算。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">在后面的附录里给出了此算法的等价的实现，分为Java版本和Scala版本。</p> 
     <h2 style="font-size:1em;letter-spacing:-1px;background-image:none;background-position:left bottom;background-repeat:repeat-x;line-height:normal;font-family:arial;">参考</h2> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;"><a href="http://typesafe.com/stack/download" rel="nofollow" style="text-decoration:none;color:rgb(11,89,178);border-bottom-width:1px;border-bottom-style:dashed;">The typesafe stack.</a></p> 
     <h2 style="font-size:1em;letter-spacing:-1px;background-image:none;background-position:left bottom;background-repeat:repeat-x;line-height:normal;font-family:arial;">附录</h2> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">Map Reduce: Java</p> 
     <pre>public class Employee {

    final String name;
    final Integer age;
    final String company;

    public Employee(String name, Integer age, String company) {
        this.name = name == null ? "guest" : name;
        this.age = age == null ? 30 : age;
        this.company = company == null ? "DevCode" : company;
    }

    public String getName() {
        return name;
    }

    public int getAge() {
        return age;
    }

    public String getCompany() {
        return company;
    }

    @Override
    public String toString() {
        return "Employee [name=" + name + ", age=" + age + ",
               company="
               + company + "]";
    }
}

class Builder {
    String name, company;
    Integer age;

    Builder(String name) {
        this.name = name;

    }

    Employee build() {
        return new Employee(name, age, company);
    }

    Builder age(Integer age) {
        this.age = age;
        return this;
    }

    Builder company(String company) {
        this.company = company;
        return this;
    }
}

import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import com.google.common.base.Function;
import com.google.common.collect.ImmutableListMultimap;
import com.google.common.collect.ImmutableSet;
import com.google.common.collect.Multimaps;

public class MapReduce {

    public static final void main(String[] args) {
        Employee guest = new Builder("Guest").build();
        Employee anna = new Builder("Anna").build();
        Employee thomas = new Builder("Thomas").age(41).build();
        Employee luke = new
            Builder("Luke").company("LucasArt").build();
        Employee yoda = new
            Builder("Yoda").age(800).company("LucasArt").build();

        Collection&lt;Employee&gt; employees = new ArrayList&lt;Employee&gt;();
        employees.add(guest);
        employees.add(anna);
        employees.add(thomas);
        employees.add(luke);
        employees.add(yoda);

        ImmutableListMultimap&lt;String, Employee&gt;
            personsGroupByCompany = Multimaps.index(employees, new Function&lt;Employee,String&gt;() {

                public String apply(Employee person) {
                   return person.getCompany();
                 }

              });

        ImmutableSet&lt;String&gt; companyNamesFromMap =
            personsGroupByCompany.keySet();

        List&lt;Employee&gt; averageAgeByCompany = new
            ArrayList&lt;Employee&gt;();

        for(String company: companyNamesFromMap) {
             List&lt;Employee&gt; employeesForThisCompany =
                personsGroupByCompany.get(company);
             int sum = 0;
             for(Employee employee: employeesForThisCompany) {
                 sum+= employee.getAge();
             }
             averageAgeByCompany.add(new
                Employee("average",sum/employeesForThisCompany.size(),company));
     }
     System.out.println("Result: "+averageAgeByCompany);

    }
}</pre> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">MapReduce.scala:</p> 
     <pre>case class Employee(name: String = "guest", age: Int = 30, company: String = "DevCode")

    object MapReduce {
        def main(args: Array[String]): Unit = {

        val guest = Employee()
        val anna = Employee("Anna")
        val thomas = Employee("Thomas", 41)
        val luke = Employee("Luke", company = "LucasArt")
        val yoda = luke.copy("Yoda", age = 800)

        val allEmployees = List(luke, anna, guest, yoda, thomas)
        val sortedEmployees = allEmployees.groupBy(_.company)
        val averageAgeByCompany = sortedEmployees.map { case (key, value) =&gt;
            value(0).copy(name = "average", age = (value.map(_.age).sum) / value.size)
      }
        println("Result: "+averageAgeByCompany)
    }
}</pre> 
     <h2 style="font-size:1em;letter-spacing:-1px;background-image:none;background-position:left bottom;background-repeat:repeat-x;line-height:normal;font-family:arial;">关于作者</h2> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;"><strong><img align="left" alt="" src="http://www.infoq.com/resource/articles/scala-for-java-devs/en/resources/thomas.jpg" class="quimby_search_image" style="border:0px;">Thomas Alexandre</strong>是DevCode的高级咨询顾问，专注于Java和Scala软件开发。他热爱技术，热衷于分享知识，永远在寻求方法、采用新的开源软件和标准来实现更加有效的编程。在十四年的Java开发经验之外，过去几年他集中精力在新的编程语言和Web框架上，例如Groovy/Grails和Scala/Lift。Thomas从法国里尔大学获得了计算机科学博士学位，在卡耐基梅隆大学度过了两年的博士后研究生涯，研究方向是安全和电子商务。</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;">&nbsp;</p> 
     <p style="line-height:19px;font-family:Lucida, 'Lucida Grande', Tahoma, sans-serif;font-size:13px;"><b>查看英文原文：</b><a href="http://www.infoq.com/articles/scala-for-java-devs" rel="nofollow" style="text-decoration:none;color:rgb(11,89,178);border-bottom-width:1px;border-bottom-style:dashed;">&nbsp;An Introduction to Scala for Java Developers</a></p> 
    </div> 
    <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"> 
     <br> ==============================================================================
    </div> 
    <div> 
     <font color="#333333"><span style="font-size:14px;">本文转自被遗忘的博客园博客，原文链接：http://www.cnblogs.com/rollenholt/articles/2192384.html，如需转载请自行联系原作者</span></font>
     <br>
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
