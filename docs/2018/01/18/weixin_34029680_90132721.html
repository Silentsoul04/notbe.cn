<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>编程实战——电影管理器之利用MediaInfo获取高清视频文件的相关信息 « NotBeCN</title>
  <meta name="description" content="             随着高速（20M）宽带、HTPC、大容量硬盘（3T）的普及，下载高清片并利用大屏幕观看也成为普通的事情。    随着下载影片的增多，管理就有了问题，有时在茫茫文件夹下找寻一个影片也是一件费时费力的事。    于是萌生了自己编写电影管理器的想法，并逐步逐步在实现。利用博客记录编写的过程，也...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2018/01/18/weixin_34029680_90132721.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">编程实战——电影管理器之利用MediaInfo获取高清视频文件的相关信息</h1>
    <p class="post-meta">Jan 18, 2018</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">随着高速（20M）宽带、HTPC、大容量硬盘（3T）的普及，下载高清片并利用大屏幕观看也成为普通的事情。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">随着下载影片的增多，管理就有了问题，有时在茫茫文件夹下找寻一个影片也是一件费时费力的事。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">于是萌生了自己编写电影管理器的想法，并逐步逐步在实现。利用博客记录编写的过程，也是和网友之间的交流。期望在交流的过程中，网友能提出一些中肯的意见，使自己少走些弯路。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">我在拿到一个高清视频文件时。我希望能有办法获知以下的信息</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">文件名：视频文件的文件名，这个比较简单，利用FileInfo类就能获得</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">文件大小：视频文件的大小，这个也比较简单，利用FileInfo类能获得</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">视频分辨率：视频文件的分辨率，例如：宽1980像素，高1040像素。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">视频时长：视频文件的时长，例如：长1小时32分</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">音频数：视频文件中的音频数，有不少的高清视频文件中包含不止一个音频。有的包含英文、中文2个音频；有的包含英文、中文、粤语3个音频</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">音频的语言类型：具体到每个音频的语言。例如：音频1是英文，音频2是中文等</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">以上信息中的后面四个（视频分辨率、视频时长、音频数、音频的语言类型），用视频播放器都能获得。但是如何在自己的程序中获得这些信息呢？</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">我们可以利用MediaInfo来获取这些信息（视频分辨率、视频时长、音频数、音频的语言类型）</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">先看看MediaInfo的介绍，<a href="http://sourceforge.net/projects/mediainfo/?source=navbar" rel="nofollow" style="color:rgb(7,93,179);">MediaInfo官网</a>。在官网上有相关的介绍，并给出了调用的代码（很完备。C++，C#，Visual Basic等都有）</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">高清视频文件的相关信息都保存在文件的头部区域，记录的信息有很多（除却上面的四种外，还包括码率、编码类型等等）。而MediaInfo就是利用读取头部区域的信息来获得相关的信息。官网的更新很快，笔者下载的是2013年7月6日发布的最新版。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">下面就介绍如何利用MediaInfo来获得高清视频文件的相关信息。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>1、下载相应的DLL</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">在<a title="http://sourceforge.net/projects/mediainfo/files/development_snapshots/" href="http://sourceforge.net/projects/mediainfo/files/development_snapshots/" rel="nofollow" style="color:rgb(7,93,179);">http://sourceforge.net/projects/mediainfo/files/development_snapshots/</a>上点击Download MediaInfo_GUI_0.7.64_Windows.exe (4.5 MB)，下载最新的版本。安装后在安装的目录中找到MediaInfo.dll和MediaInfo_i386.dll这两个DLL文件。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>2、新建项目</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">在VS2010中新建项目，把相关的DLL复制到可执行程序的目录（在项目文件夹下的bin\Debug\，或者复制到系统目录中）</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">注：MediaInfo.dll貌似是64位的；MediaInfo_i386.dll貌似是32位的；在后面的调试中，MediaInfo.dll始终会报错，反而MediaInfo_i386.dll改成MediaInfo.dll后复制到目录中调试一遍成功。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>3、把官网中的提供的调用代码添加到项目中来</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">由于DLL仅仅提供了函数。而目前的编码基本上都是面向对象，所以在官网上针对很多的语言都提供了相应的代码，把函数调用包装成类，方便调用者使用。Visual Basic的调用代码在<a title="http://sourceforge.net/p/mediainfo/code/5846/tree/MediaInfoLib/trunk/Project/MSVB2010/" href="http://sourceforge.net/p/mediainfo/code/5846/tree/MediaInfoLib/trunk/Project/MSVB2010/" rel="nofollow" style="color:rgb(7,93,179);">http://sourceforge.net/p/mediainfo/code/5846/tree/MediaInfoLib/trunk/Project/MSVB2010/</a>上，其他语言在相关的网页上也能找到，这里就不赘述了。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>要注意的是，在如上所做时，还得在VS2010中进行设置</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><a href="https://images0.cnblogs.com/blog/93227/201307/29162157-cb3bfa73f8114bb798551e641f084c91.png" rel="nofollow" style="color:rgb(7,93,179);"><img title="image" src="https://images0.cnblogs.com/blog/93227/201307/29162157-c0246c95bdef43d7a6d5c119f6d9bb90.png" alt="image" width="554" height="486" style="border:0px;background-image:none;"></a></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>在打开的项目属性中，点开“调试”，勾上“启用非托管代码调试”，才能正常调试。</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>如果没有勾上，运行时则会出现下面的对话框</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><a href="https://images0.cnblogs.com/blog/93227/201307/29162158-0be0bfdfe130432098a53bb2bb4091d4.png" rel="nofollow" style="color:rgb(7,93,179);"><img title="image" src="https://images0.cnblogs.com/blog/93227/201307/29162158-38891e42eec240a28d4f68d9986366d5.png" alt="image" width="477" height="177" style="border:0px;background-image:none;"></a></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>可能是缺少Lib文件的缘故，不过我没在官网上找到Lib文件的下载</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>另，不需要在项目中对MediaInfo.dll引用。引用会出错，如下所示：</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><a href="https://images0.cnblogs.com/blog/93227/201307/29162158-2b360bfa540c488e90d7f2db155a1177.png" rel="nofollow" style="color:rgb(7,93,179);"><img title="image" src="https://images0.cnblogs.com/blog/93227/201307/29162159-35105060f6c3406e903c8d10013ea23a.png" alt="image" width="484" height="194" style="border:0px;background-image:none;"></a></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">官网上的Visual Basic 2010调用代码如下：</p> 
   <div style="font-family:verdana;font-size:12pt;"> 
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Imports</span>&nbsp;System.Runtime.InteropServices&nbsp;
    <br>
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Enum</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">UInteger</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp; General&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Visual&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Audio&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Text&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Chapters&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Image&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Menu&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Max&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Enum</span>&nbsp;
    <br>
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Enum</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">InfoKind</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">UInteger</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Name&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Text&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Measure&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Options&nbsp;
    <br> &nbsp;&nbsp;&nbsp; NameText&nbsp;
    <br> &nbsp;&nbsp;&nbsp; MeasureText&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Info&nbsp;
    <br> &nbsp;&nbsp;&nbsp; HowTo&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Max&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Enum</span>&nbsp;
    <br>
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Enum</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">InfoOptions</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">UInteger</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp; ShowInInform&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Reserved&nbsp;
    <br> &nbsp;&nbsp;&nbsp; ShowInSupported&nbsp;
    <br> &nbsp;&nbsp;&nbsp; TypeOfValue&nbsp;
    <br> &nbsp;&nbsp;&nbsp; Max&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Enum</span>&nbsp;
    <br>
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">MediaInfo</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Declare</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Unicode</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;MediaInfo_New&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Lib</span>&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"MediaInfo.DLL"</span>&nbsp;()&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Declare</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Unicode</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;MediaInfo_Delete&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Lib</span>&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"MediaInfo.DLL"</span>&nbsp;(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Handle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Declare</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Unicode</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;MediaInfo_Open&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Lib</span>&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"MediaInfo.DLL"</span>&nbsp;(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Handle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;FileName&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Declare</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Unicode</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;MediaInfo_Close&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Lib</span>&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"MediaInfo.DLL"</span>&nbsp;(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Handle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Declare</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Unicode</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;MediaInfo_Inform&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Lib</span>&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"MediaInfo.DLL"</span>&nbsp;(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Handle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Reserved&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Declare</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Unicode</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;MediaInfo_GetI&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Lib</span>&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"MediaInfo.DLL"</span>&nbsp;(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Handle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamKind&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamNumber&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Parameter&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;KindOfInfo&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>&nbsp;&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Declare</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Unicode</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;MediaInfo_Get&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Lib</span>&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"MediaInfo.DLL"</span>&nbsp;(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Handle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamKind&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamNumber&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Parameter&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;KindOfInfo&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;KindOfSearch&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Declare</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Unicode</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;MediaInfo_Option&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Lib</span>&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"MediaInfo.DLL"</span>&nbsp;(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Handle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Option_&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Value&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Declare</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Unicode</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;MediaInfo_State_Get&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Lib</span>&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"MediaInfo.DLL"</span>&nbsp;(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Handle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>&nbsp;&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Declare</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Unicode</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;MediaInfo_Count_Get&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Lib</span>&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"MediaInfo.DLL"</span>&nbsp;(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Handle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamKind&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamNumber&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>&nbsp;&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;Handle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Handle = MediaInfo_New()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Protected</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Overrides</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;Finalize()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MediaInfo_Delete(Handle)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;Open(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;FileName&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;System.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;MediaInfo_Open(Handle, FileName)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;Close()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MediaInfo_Close(Handle)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;Inform()&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Marshal</span>.PtrToStringUni(MediaInfo_Inform(Handle,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(0,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>)))&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;Get_(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamKind&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamNumber&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Parameter&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;KindOfInfo&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">InfoKind</span>&nbsp;=&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">InfoKind</span>.Text)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Marshal</span>.PtrToStringUni(MediaInfo_GetI(Handle,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(StreamKind,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>),&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(StreamNumber,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>),&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(Parameter,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>),&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(KindOfInfo,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>)))&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;Get_(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamKind&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamNumber&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Parameter&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;KindOfInfo&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">InfoKind</span>&nbsp;=&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">InfoKind</span>.Text,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;KindOfSearch&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">InfoKind</span>&nbsp;=&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">InfoKind</span>.Name)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Marshal</span>.PtrToStringUni(MediaInfo_Get(Handle,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(StreamKind,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>),&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(StreamNumber,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>), Parameter,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(KindOfInfo,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>),&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(KindOfSearch,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>)))&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;Option_(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Option__&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Value&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;=&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">""</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Marshal</span>.PtrToStringUni(MediaInfo_Option(Handle, Option__, Value))&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;State_Get()&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CInt</span>(MediaInfo_State_Get(Handle))&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;Count_Get(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamKind&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;StreamNumber&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">UInteger</span>&nbsp;=&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">UInteger</span>.MaxValue)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;StreamNumber =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">UInteger</span>.MaxValue&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CInt</span>(MediaInfo_Count_Get(Handle,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(StreamKind,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>),&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(-1,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>)))&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Else</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CInt</span>(MediaInfo_Count_Get(Handle,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(StreamKind,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">UIntPtr</span>),&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(StreamNumber,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">IntPtr</span>)))&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span> 
   </div> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>4</strong><strong>、再次包装，方便调用</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">由于上面的代码是提供了一个类供调用者使用，因此，我决定再包装一下，使其看起来简单一些（我只需要分辨率、时长、音频数、音频语言这四个信息）。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">我包装的代码如下：</p> 
   <div style="font-family:verdana;font-size:12pt;"> 
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsMediaInfo</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;_M&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">MediaInfo</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _M =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">MediaInfo</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;GetInfo(FileName&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _M.Open(FileName)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _M.Option_(
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Complete"</span>)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_M.Inform&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;Width()&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_M.Get_(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Visual, 0,&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Width"</span>)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;Height()&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_M.Get_(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Visual, 0,&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Height"</span>)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;Duration()&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_M.Get_(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.General, 0,&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Duration/String3"</span>)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;AudioCount()&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Convert</span>.ToInt32(_M.Get_(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.General, 0,&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"AudioCount"</span>))&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;AudioLanguage(Index&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;Index &lt; 0&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">OrElse</span>&nbsp;Index &gt; AudioCount() - 1&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;Index = 0&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_M.Get_(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Audio, Index,&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Language/String"</span>)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;AudioLanguage()&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;I&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>, C&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= AudioCount()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;L(C - 1)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">For</span>&nbsp;I = 0&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">To</span>&nbsp;C - 1&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; L(I) = _M.Get_(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Audio, I,&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Language/String"</span>)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Next</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;L&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span> 
   </div> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">解释一下：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">首先在类的内部定义一个MediaInfo类的实例，具体的功能都是通过该实例来完成。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">在查看信息前，需调用GetInfo(FileName&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)函数，该函数的目的是获得相关的信息，一共三句话</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">_M.Open(FileName)&nbsp;<br> _M.Option_(<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Complete"</span>)&nbsp;<br><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_M.Inform</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">第1句，打开FileName指定的文件；第2句，获取相关信息，并通知类，已经获取完毕（可能在DLL中会有释放资源等操作）；第3句，返回视频文件的相关信息。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">第3句话返回的是所有的信息，长长的一串。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">如果仅仅是想获得某一个信息，则需要调用下面的语句</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">_M.Get_(<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Visual, 0,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Width"</span>)</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">一共三个参数。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">第1个参数，获取信息的类别。一般取<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.General（通用信息）、<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Visual（视频信息）、<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Audio（音频信息）</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">第2个参数，获取信息的流编号。一般取0（第1个流，视频一般就1个流，音频有可能多于1个流），音频的话，取相应的流编号（0开始，到流数减1）</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">第3个参数，获取信息的名字。根据该参数返回对应的信息。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">那么，对应的调用就是</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">视频宽度：_M.Get_(<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Visual, 0,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Width"</span>)</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">视频高度：_M.Get_(<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Visual, 0,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Height"</span>)</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">视频时长：_M.Get_(<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.General, 0,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Duration/String3"</span>)。这个有多种选择，该调用返回 01:34:48.683 这种格式；如果是：_M.Get_(<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.General, 0,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Duration"</span>)，则返回 5688683 ，还需要自己转换。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">音频个数：_M.Get_(<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.General, 0,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"AudioCount"</span>)</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">音频语言：_M.Get_(<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Audio, I,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Language/String"</span>)。也是多种选择，该调用返回 English 这种格式；如果是：_M.Get_(<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Audio, I,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"Language"</span>)，则返回 en 这种格式。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">如果想获取其他的信息，直接给出相应的参数就行了。例如想获得视频的最大码率，给出参数BitRate_Maximum就行了。如下调用</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">_M.Get_(<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StreamKind</span>.Visual, 0,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"BitRate_Maximum"</span>)</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">那么，如何能知道有哪些参数呢？参看</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><a href="http://www.cnblogs.com/royzou/archive/2011/09/06/mediainfo_parameter.html" rel="nofollow" style="color:rgb(7,93,179);">MediaInfo参数大全</a></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><a href="http://www.cnblogs.com/royzou/archive/2011/09/06/csharp_call_mediainfo.html" rel="nofollow" style="color:rgb(7,93,179);">C#使用MediaInfo查看媒体信息</a></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">这两篇文章对参数介绍的很详细，只是文章写得早，提供的DLL版本比较低罢了</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">下面是获取&nbsp;<span style="line-height:1.5;">G:\Despicable.Me.2010.BluRay.1080p.DTS.2Audio.x264-CHD.mkv 这个高清视频文件信息的调用代码：</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,255);">Dim</span>&nbsp;S As&nbsp;<span style="line-height:1.5;color:rgb(0,0,255);">New</span>&nbsp;<span style="line-height:1.5;color:rgb(43,145,175);">clsMediaInfo</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">S.GetInfo("<span style="line-height:1.5;color:rgb(163,21,21);">G:\Despicable.Me.2010.BluRay.1080p.DTS.2Audio.x264-CHD.mkv</span>")</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,255);">Dim</span>&nbsp;S1 As&nbsp;<span style="line-height:1.5;color:rgb(0,0,255);">String</span>&nbsp;= ""&nbsp;<br> S1 &amp;= S.Width &amp; "&nbsp; " &amp; S.Height &amp; vbNewLine&nbsp;<br> S1 &amp;= S.Duration &amp; vbNewLine&nbsp;<br> S1 &amp;= S.AudioCount &amp; vbNewLine&nbsp;<br> S1 &amp;= S.AudioLanguage(0) &amp; "," &amp; S.AudioLanguage(1)</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">RichTextBox1.Text = S1</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">返回的信息如下：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">1920&nbsp; 1040&nbsp;<br> 01:34:48.683&nbsp;<br> 2&nbsp;<br> English,Chinese</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">说明视频分辨率为1920*1040；时长：1小时34分48秒；2个音频；分别是英文和中文；</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">这个代码在做高清视频文件的信息库的时候特别有用。可以根据高清视频文件自动获取相关信息，毋须再手动填充信息。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><br></p> 
   <p style="line-height:1.5;"><font><span style="font-size:15px;">&nbsp; &nbsp; 本文转自万仓一黍博客园博客，原文链接：http://www.cnblogs.com/grenet/p/3222731.html</span></font><span style="font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
