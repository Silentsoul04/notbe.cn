<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>tf.flags与tf.app.flags « NotBeCN</title>
  <meta name="description" content="             在看了众多关于flags与app.flags的文献后，理解程度还是有点迷茫。    &nbsp;    1.Â&nbsp;import&nbsp;tensorflow&nbsp;&nbsp;as&nbsp;tf&nbsp;&nbsp;    2.Â&nbsp;FLAGS=tf.app.f...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2018/01/17/weixin_33896726_90134617.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">tf.flags与tf.app.flags</h1>
    <p class="post-meta">Jan 17, 2018</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p><font><span style="font-size:14px;">在看了众多关于flags与app.flags的文献后，理解程度还是有点迷茫。</span></font></p> 
   <p><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);">&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(255,255,255);"><span style="font-family:'å®ä½';color:rgb(0,102,153);letter-spacing:0pt;font-weight:bold;font-size:12pt;">1.Â&nbsp;</span><b><span style="font-family:'宋体';color:rgb(0,102,153);letter-spacing:0pt;font-size:10.5pt;">import</span></b><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">&nbsp;tensorflow&nbsp;&nbsp;as&nbsp;tf&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(248,248,248);"><span style="font-family:'å®ä½';letter-spacing:0pt;font-size:12pt;">2.Â&nbsp;</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">FLAGS=tf.app.flags.FLAGS&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(255,255,255);"><span style="font-family:'å®ä½';letter-spacing:0pt;font-size:12pt;">3.Â&nbsp;</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">tf.app.flags.DEFINE_float(&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(248,248,248);"><span style="font-family:'å®ä½';letter-spacing:0pt;font-size:12pt;">4.Â&nbsp;</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(0,0,255);letter-spacing:0pt;font-size:10.5pt;">'flag_float'</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">,&nbsp;0.01,&nbsp;</span><span style="font-family:'宋体';color:rgb(0,0,255);letter-spacing:0pt;font-size:10.5pt;">'input&nbsp;a&nbsp;float'</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">)&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(255,255,255);"><span style="font-family:'å®ä½';letter-spacing:0pt;font-size:12pt;">5.Â&nbsp;</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">tf.app.flags.DEFINE_integer(&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(248,248,248);"><span style="font-family:'å®ä½';letter-spacing:0pt;font-size:12pt;">6.Â&nbsp;</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(0,0,255);letter-spacing:0pt;font-size:10.5pt;">'flag_int'</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">,&nbsp;400,&nbsp;</span><span style="font-family:'宋体';color:rgb(0,0,255);letter-spacing:0pt;font-size:10.5pt;">'input&nbsp;a&nbsp;int'</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">)&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(255,255,255);"><span style="font-family:'å®ä½';letter-spacing:0pt;font-size:12pt;">7.Â&nbsp;</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">tf.app.flags.DEFINE_boolean(&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(248,248,248);"><span style="font-family:'å®ä½';letter-spacing:0pt;font-size:12pt;">8.Â&nbsp;</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(0,0,255);letter-spacing:0pt;font-size:10.5pt;">'flag_bool'</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">,&nbsp;True,&nbsp;</span><span style="font-family:'宋体';color:rgb(0,0,255);letter-spacing:0pt;font-size:10.5pt;">'input&nbsp;a&nbsp;bool'</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">)&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(255,255,255);"><span style="font-family:'å®ä½';letter-spacing:0pt;font-size:12pt;">9.Â&nbsp;</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">tf.app.flags.DEFINE_string(&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(248,248,248);"><span style="font-family:'å®ä½';letter-spacing:0pt;font-size:12pt;">10.Â&nbsp;</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(0,0,255);letter-spacing:0pt;font-size:10.5pt;">'flag_string'</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">,&nbsp;</span><span style="font-family:'宋体';color:rgb(0,0,255);letter-spacing:0pt;font-size:10.5pt;">'yes'</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">,&nbsp;</span><span style="font-family:'宋体';color:rgb(0,0,255);letter-spacing:0pt;font-size:10.5pt;">'input&nbsp;a&nbsp;string'</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">)&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(255,255,255);"><span style="font-family:'å®ä½';letter-spacing:0pt;font-size:12pt;">11.Â&nbsp;</span><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(248,248,248);"><span style="font-family:'å®ä½';color:rgb(0,102,153);letter-spacing:0pt;font-weight:bold;font-size:12pt;">12.Â&nbsp;</span><b><span style="font-family:'宋体';color:rgb(0,102,153);letter-spacing:0pt;font-size:10.5pt;">print</span></b><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">(FLAGS.flag_float)&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(255,255,255);"><span style="font-family:'å®ä½';color:rgb(0,102,153);letter-spacing:0pt;font-weight:bold;font-size:12pt;">13.Â&nbsp;</span><b><span style="font-family:'宋体';color:rgb(0,102,153);letter-spacing:0pt;font-size:10.5pt;">print</span></b><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">(FLAGS.flag_int)&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(248,248,248);"><span style="font-family:'å®ä½';color:rgb(0,102,153);letter-spacing:0pt;font-weight:bold;font-size:12pt;">14.Â&nbsp;</span><b><span style="font-family:'宋体';color:rgb(0,102,153);letter-spacing:0pt;font-size:10.5pt;">print</span></b><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">(FLAGS.flag_bool)&nbsp;&nbsp;</span></p> 
   <p style="text-indent:-18pt;border-left-width:2.25pt;border-left-style:solid;border-left-color:rgb(108,226,108);line-height:13.5pt;background:rgb(255,255,255);"><span style="font-family:'å®ä½';color:rgb(0,102,153);letter-spacing:0pt;font-weight:bold;font-size:12pt;">15.Â&nbsp;</span><b><span style="font-family:'宋体';color:rgb(0,102,153);letter-spacing:0pt;font-size:10.5pt;">print</span></b><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;">(FLAGS.flag_string)&nbsp;&nbsp;</span></p> 
   <p><span style="font-size:10.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;">1.在命令行中查看帮助信息，在命令行输入 python test.py -h</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><img src="https://yqfile.alicdn.com/98ec4944807eae1463bfce946cbdfb18e92c1005.png" width="300" alt="98ec4944807eae1463bfce946cbdfb18e92c1005"><br></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;"><font>注意红色框中的信息，这个就是我们用</font>DEFINE_XXX添加命令行参数时的第三个参数</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;">2.直接运行test.py</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;">&nbsp;<img src="https://yqfile.alicdn.com/6118afb579e910ba86b0adaf6756081633575792.png" width="300" alt="6118afb579e910ba86b0adaf6756081633575792"></span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;"><font>因为没有给对应的命令行参数赋值，所以输出的是命令行参数的默认值。</font></span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;">3.带命令行参数的运行test.py文件</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><img src="https://yqfile.alicdn.com/d10a3d33201171df2ae12fe5c3e84f72144bc2a9.png" width="300" alt="d10a3d33201171df2ae12fe5c3e84f72144bc2a9"><br></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;"><font>这里输出了我们赋给命令行参数的值</font></span></p> 
   <p><span style="font-family:'宋体';letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);">&nbsp;</span></p> 
   <p><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);">tf.app.flags.DEFINE_xxx()就是添加命令行的optional argument（可选参数），</span></p> 
   <p><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);"><font>而</font>tf.app.flags.FLAGS可以从对应的命令行参数取出参数。</span></p> 
   <p><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;">DEFINE_string()限定了可选参数输入必须是string，这也就是为什么这个函数定义为DEFINE_string()，同理，DEFINE_int()限定可选参数必须是int，DEFINE_float()限定可选参数必须是float，DEFINE_boolean()限定可选参数必须是bool。</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;"><img src="https://yqfile.alicdn.com/dbb7ca48deec7a90b51b38ab8375d0c480b61e43.png" width="300" alt="dbb7ca48deec7a90b51b38ab8375d0c480b61e43">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;"><font>最关键的一步，这里定义了</font>_FlagValues这个类的一个实例,这样的这样当要访问命令行输入的命令时，就能使用像tf.app.flag.Flags这样的操作。</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;"><img src="https://yqfile.alicdn.com/3a66a6bec13a1fc4a497e5a866dc7eb6c0344eac.png" width="300" alt="3a66a6bec13a1fc4a497e5a866dc7eb6c0344eac">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;"><font>从：使用</font>CNN做英文文本任务实例来看flags用法</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">import</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;tensorflow </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">as</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;tf</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">import</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;numpy </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">as</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;np</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">import</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;os</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">import</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;time</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">import</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;datetime</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">import</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;data_helpers</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">from</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;text_cnn </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">import</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;TextCNN</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">from</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;tensorflow.contrib </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">import</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;learn</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Parameters# ==================================================</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Data loading params# 语料文件路径定义</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_float(</span><span style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">"dev_sample_percentage"</span><span class="15" style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">.1</span><span class="15" style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">"Percentage of the training data to use for validation"</span><span class="15" style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_string(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"positive_data_file"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"./data/rt-polaritydata/rt-polarity.pos"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Data source for the positive data."</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_string(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"negative_data_file"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"./data/rt-polaritydata/rt-polarity.neg"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Data source for the negative data."</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Model Hyperparameters# 定义网络超参数</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_integer(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"embedding_dim"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">128</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Dimensionality of character embedding (default: 128)"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_string(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"filter_sizes"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"3,4,5"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Comma-separated filter sizes (default: '3,4,5')"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_integer(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"num_filters"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">128</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Number of filters per filter size (default: 128)"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_float(</span><span style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">"dropout_keep_prob"</span><span class="15" style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">0.5</span><span class="15" style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">"Dropout keep probability (default: 0.5)"</span><span class="15" style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_float(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"l2_reg_lambda"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">0.0</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"L2 regularization lambda (default: 0.0)"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Training parameters# 训练参数</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_integer(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"batch_size"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">32</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Batch Size (default: 32)"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_integer(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"num_epochs"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">200</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Number of training epochs (default: 200)"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 总训练次数</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_integer(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"evaluate_every"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">100</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Evaluate model on dev set after this many steps (default: 100)"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 每训练100次测试一下</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_integer(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"checkpoint_every"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">100</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Save model after this many steps (default: 100)"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 保存一次模型</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_integer(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"num_checkpoints"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">5</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Number of checkpoints to store (default: 5)"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Misc Parameters</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_boolean(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"allow_soft_placement"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">True</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Allow device soft device placement"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 加上一个布尔类型的参数，要不要自动分配</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">tf.flags.DEFINE_boolean(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"log_device_placement"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">False</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Log placement of ops on devices"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 加上一个布尔类型的参数，要不要打印日志</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 打印一下相关初始参数</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">FLAGS = tf.flags.FLAGS</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">FLAGS._parse_flags()</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"\nParameters:"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">for</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;attr, value </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">in</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;sorted(FLAGS.__flags.items()):</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"{}={}"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">.format(attr.upper(), value))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">""</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Data Preparation# ==================================================</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Load data</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Loading data..."</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">x_text, y = data_helpers.load_data_and_labels(FLAGS.positive_data_file, FLAGS.negative_data_file)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Build vocabulary</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">max_document_length = max([len(x.split(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">" "</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">for</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;x </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">in</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;x_text]) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 计算最长邮件</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">vocab_processor = learn.preprocessing.VocabularyProcessor(max_document_length) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># tensorflow提供的工具，将数据填充为最大长度，默认0填充</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">x = np.array(list(vocab_processor.fit_transform(x_text)))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Randomly shuffle data# 数据洗牌</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">np.random.seed(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">10</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># np.arange生成随机序列</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">shuffle_indices = np.random.permutation(np.arange(len(y)))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">x_shuffled = x[shuffle_indices]</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">y_shuffled = y[shuffle_indices]</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 将数据按训练train和测试dev分块# Split train/test set# TODO: This is very crude, should use cross-validation</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">dev_sample_index = -</span><span style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">1</span><span class="15" style="font-family:'宋体';color:rgb(192,0,0);letter-spacing:0pt;font-size:9.5pt;">&nbsp;* int(FLAGS.dev_sample_percentage * float(len(y)))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">x_train, x_dev = x_shuffled[:dev_sample_index], x_shuffled[dev_sample_index:]</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">y_train, y_dev = y_shuffled[:dev_sample_index], y_shuffled[dev_sample_index:]</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Vocabulary Size: {:d}"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">.format(len(vocab_processor.vocabulary_)))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Train/Dev split: {:d}/{:d}"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">.format(len(y_train), len(y_dev))) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 打印切分的比例</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Training# ==================================================</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">with</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;tf.Graph().as_default():</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;session_conf = tf.ConfigProto(</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allow_soft_placement=FLAGS.allow_soft_placement,</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log_device_placement=FLAGS.log_device_placement)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;sess = tf.Session(config=session_conf)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">with</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;sess.as_default():</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 卷积池化网络导入</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnn = TextCNN(</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sequence_length=x_train.shape[</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">1</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">],</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_classes=y_train.shape[</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">1</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">], </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 分几类</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vocab_size=len(vocab_processor.vocabulary_),</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;embedding_size=FLAGS.embedding_dim,</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filter_sizes=list(map(int, FLAGS.filter_sizes.split(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">","</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">))), </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 上面定义的filter_sizes拿过来，"3,4,5"按","分割</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_filters=FLAGS.num_filters, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 一共有几个filter</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l2_reg_lambda=FLAGS.l2_reg_lambda) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># l2正则化项</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Define Training procedure</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global_step = tf.Variable(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">0</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, name=</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"global_step"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, trainable=</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">False</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;optimizer = tf.train.AdamOptimizer(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">1e-3</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 定义优化器</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grads_and_vars = optimizer.compute_gradients(cnn.loss)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;train_op = optimizer.apply_gradients(grads_and_vars, global_step=global_step)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Keep track of gradient values and sparsity (optional)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grad_summaries = []</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">for</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;g, v </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">in</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;grads_and_vars:</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">if</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;g </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">is</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">not</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">None</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">:</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grad_hist_summary = tf.summary.histogram(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"{}/grad/hist"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">.format(v.name), g)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sparsity_summary = tf.summary.scalar(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"{}/grad/sparsity"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">.format(v.name), tf.nn.zero_fraction(g))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grad_summaries.append(grad_hist_summary)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grad_summaries.append(sparsity_summary)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grad_summaries_merged = tf.summary.merge(grad_summaries)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Output directory for models and summaries</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timestamp = str(int(time.time()))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out_dir = os.path.abspath(os.path.join(os.path.curdir, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"runs"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, timestamp))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Writing to {}\n"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">.format(out_dir))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Summaries for loss and accuracy</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 损失函数和准确率的参数保存</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;loss_summary = tf.summary.scalar(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"loss"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, cnn.loss)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acc_summary = tf.summary.scalar(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"accuracy"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, cnn.accuracy)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Train Summaries</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 训练数据保存</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;train_summary_op = tf.summary.merge([loss_summary, acc_summary, grad_summaries_merged])</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;train_summary_dir = os.path.join(out_dir, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"summaries"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"train"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;train_summary_writer = tf.summary.FileWriter(train_summary_dir, sess.graph)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Dev summaries</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 测试数据保存</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dev_summary_op = tf.summary.merge([loss_summary, acc_summary])</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dev_summary_dir = os.path.join(out_dir, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"summaries"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"dev"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dev_summary_writer = tf.summary.FileWriter(dev_summary_dir, sess.graph)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Checkpoint directory. Tensorflow assumes this directory already exists so we need to create it</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkpoint_dir = os.path.abspath(os.path.join(out_dir, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"checkpoints"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;checkpoint_prefix = os.path.join(checkpoint_dir, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"model"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">if</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">not</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;os.path.exists(checkpoint_dir):</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.makedirs(checkpoint_dir)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saver = tf.train.Saver(tf.global_variables(), max_to_keep=FLAGS.num_checkpoints) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 前面定义好参数num_checkpoints</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Write vocabulary</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vocab_processor.save(os.path.join(out_dir, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"vocab"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Initialize all variables</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sess.run(tf.global_variables_initializer()) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 初始化所有变量</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 定义训练函数</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">def train_step(x_batch, y_batch):</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"""</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A single training step</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;feed_dict = {</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnn.input_x: x_batch,</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnn.input_y: y_batch,</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnn.dropout_keep_prob: FLAGS.dropout_keep_prob </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 参数在前面有定义</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_, step, summaries, loss, accuracy = sess.run(</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[train_op, global_step, train_summary_op, cnn.loss, cnn.accuracy], feed_dict)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time_str = datetime.datetime.now().isoformat() </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 取当前时间，python的函数</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"{}: step {}, loss {:g}, acc {:g}"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">.format(time_str, step, loss, accuracy))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;train_summary_writer.add_summary(summaries, step)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 定义测试函数</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">def dev_step(x_batch, y_batch, writer=None):</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"""</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Evaluates model on a dev set</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;feed_dict = {</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnn.input_x: x_batch,</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnn.input_y: y_batch,</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cnn.dropout_keep_prob: </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">1.0</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 神经元全部保留</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step, summaries, loss, accuracy = sess.run(</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[global_step, dev_summary_op, cnn.loss, cnn.accuracy], feed_dict)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time_str = datetime.datetime.now().isoformat()</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"{}: step {}, loss {:g}, acc {:g}"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">.format(time_str, step, loss, accuracy))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">if</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;writer:</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.add_summary(summaries, step)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Generate batches</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;batches = data_helpers.batch_iter(list(zip(x_train, y_train)), FLAGS.batch_size, FLAGS.num_epochs)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># Training loop. For each batch...</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 训练部分</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">for</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;batch </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">in</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;batches:</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x_batch, y_batch = zip(*batch) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 按batch把数据拿进来</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;train_step(x_batch, y_batch)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current_step = tf.train.global_step(sess, global_step) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 将Session和global_step值传进来</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">if</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;current_step % FLAGS.evaluate_every == </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">0</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">: </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 每FLAGS.evaluate_every次每100执行一次测试</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"\nEvaluation:"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dev_step(x_dev, y_dev, writer=dev_summary_writer)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">""</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">if</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;current_step % FLAGS.checkpoint_every == </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">0</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">: </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 每checkpoint_every次执行一次保存模型</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path = saver.save(sess, </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">'./'</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">, global_step=current_step) </span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;"># 定义模型保存路径</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;border-top:1pt solid rgb(204,204,204);border-right:1pt solid rgb(204,204,204);border-bottom:1pt solid rgb(204,204,204);border-left:1pt solid rgb(204,204,204);line-height:15.75pt;background:rgb(245,245,245);"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">"Saved model checkpoint to {}\n"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9.5pt;">.format(path))</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(63,63,63);letter-spacing:0pt;font-size:12pt;">tf定义了tf.app.flags，用于支持接受命令行传递参数，相当于接受argv。</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span style="font-family:'宋体';color:rgb(0,0,136);letter-spacing:0pt;font-size:9pt;">import</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">&nbsp;tensorflow </span><span style="font-family:'宋体';color:rgb(0,0,136);letter-spacing:0pt;font-size:9pt;">as</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">&nbsp;tf</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span style="font-family:'宋体';color:rgb(136,0,0);letter-spacing:0pt;font-size:9pt;">#第一个是参数名称，第二个参数是默认值，第三个是参数描述</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">tf.app.flags.DEFINE_string(</span><span style="font-family:'宋体';color:rgb(0,136,0);letter-spacing:0pt;font-size:9pt;">'str_name'</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">, </span><span style="font-family:'宋体';color:rgb(0,136,0);letter-spacing:0pt;font-size:9pt;">'def_v_1'</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">,</span><span style="font-family:'宋体';color:rgb(0,136,0);letter-spacing:0pt;font-size:9pt;">"descrip1"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">tf.app.flags.DEFINE_integer(</span><span style="font-family:'宋体';color:rgb(0,136,0);letter-spacing:0pt;font-size:9pt;">'int_name'</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">, </span><span style="font-family:'宋体';color:rgb(0,102,102);letter-spacing:0pt;font-size:9pt;">10</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">,</span><span style="font-family:'宋体';color:rgb(0,136,0);letter-spacing:0pt;font-size:9pt;">"descript2"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">tf.app.flags.DEFINE_boolean(</span><span style="font-family:'宋体';color:rgb(0,136,0);letter-spacing:0pt;font-size:9pt;">'bool_name'</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">, </span><span style="font-family:'宋体';color:rgb(0,0,136);letter-spacing:0pt;font-size:9pt;">False</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">, </span><span style="font-family:'宋体';color:rgb(0,136,0);letter-spacing:0pt;font-size:9pt;">"descript3"</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">FLAGS = tf.app.flags.FLAGS</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span style="font-family:'宋体';color:rgb(136,0,0);letter-spacing:0pt;font-size:9pt;">#必须带参数，否则：'TypeError: main() takes no arguments (1 given)'; &nbsp;&nbsp;main的参数名随意定义，无要求</span><span style="font-family:'宋体';color:rgb(0,0,136);letter-spacing:0pt;font-size:9pt;">def</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">&nbsp;main</span><span style="font-family:'宋体';color:rgb(102,0,102);letter-spacing:0pt;font-size:9pt;">(_)</span><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">:</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">&nbsp;&nbsp;</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">&nbsp;&nbsp;&nbsp;&nbsp;print(FLAGS.str_name)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">&nbsp;&nbsp;&nbsp;&nbsp;print(FLAGS.int_name)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">&nbsp;&nbsp;&nbsp;&nbsp;print(FLAGS.bool_name)</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span style="font-family:'宋体';color:rgb(0,0,136);letter-spacing:0pt;font-size:9pt;">if</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">&nbsp;__name__ == </span><span style="font-family:'宋体';color:rgb(0,136,0);letter-spacing:0pt;font-size:9pt;">'__main__'</span><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">:</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">&nbsp;&nbsp;&nbsp;&nbsp;tf.app.run() &nbsp;</span><span style="font-family:'宋体';color:rgb(136,0,0);letter-spacing:0pt;font-size:9pt;">#执行main函数</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(63,63,63);letter-spacing:0pt;font-size:12pt;"><font>执行：</font></span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">def_v_1</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span style="font-family:'宋体';color:rgb(0,102,102);letter-spacing:0pt;font-size:9pt;">10</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">False</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span style="font-family:'宋体';color:rgb(136,0,0);letter-spacing:0pt;font-size:9pt;"># python tt.py --str_name test_str --int_name 99 --bool_name True</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span class="15" style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">test_str</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span style="font-family:'宋体';color:rgb(0,102,102);letter-spacing:0pt;font-size:9pt;">99</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:12pt;"><span style="font-family:'宋体';color:rgb(51,51,51);letter-spacing:0pt;font-size:9pt;">True</span></p> 
   <p style="margin-left:0pt;text-indent:0pt;line-height:21pt;background:rgb(255,255,255);"><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;">&nbsp;</span></p> 
   <p><span style="font-family:'宋体';color:rgb(69,69,69);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);">&nbsp;</span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
