<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>如何为阿里云论坛建设一个新帖提醒系统 « NotBeCN</title>
  <meta name="description" content="                 系统架构        系统设计思路    IFTTT 为我们提供了方便的 RSS 更新检查功能，可以让我们免于开发，监控站点信息。同时，钉钉提供的机器人功能，可以让我们很方便的实现后续的消息提醒功能。    如何操作？    创建 Applets    首先，你需要到 IFTT...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2018/01/19/weixin_34335458_90122180.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">如何为阿里云论坛建设一个新帖提醒系统</h1>
    <p class="post-meta">Jan 19, 2018</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p></p> 
   <h2>系统架构</h2> 
   <p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fnen6ucjfoj30um0640ss.jpg" alt="" title=""></p> 
   <h2>系统设计思路</h2> 
   <p><a href="https://ifttt.com/discover" rel="nofollow">IFTTT</a> 为我们提供了方便的 RSS 更新检查功能，可以让我们免于开发，监控站点信息。同时，钉钉提供的机器人功能，可以让我们很方便的实现后续的消息提醒功能。</p> 
   <h2>如何操作？</h2> 
   <h3>创建 Applets</h3> 
   <p>首先，你需要到 <a href="https://ifttt.com/discover" rel="nofollow">IFTTT</a> 注册一个账号，</p> 
   <p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fnen9ve1xvj31kw0jygn3.jpg" alt="" title=""></p> 
   <p>注册成功后，点击 <strong>My Applets</strong>，进入到个人脚本页面。</p> 
   <p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fnenb20f3dj31kw0ewdgg.jpg" alt="" title=""></p> 
   <p>点击右侧的 <strong>New Applet</strong>，创建新的脚本。</p> 
   <h3>创建触发器</h3> 
   <p>首先，我们需要点击 <strong>This</strong>，来设置脚本的触发器(<em>Trigger</em>)，</p> 
   <p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fnenbp1x5hj31kw0o7q4i.jpg" alt="" title=""></p> 
   <p>在新的页面中，中部有一个用于快速搜索的输入框，在其中输入关键词 「<strong>Feed</strong>」，然后可以看到下方筛选出的两个服务，选择其中的 「<strong>RSS Feed</strong>」。</p> 
   <p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fnenfa0qxtj31kw0oqgmu.jpg" alt="" title=""></p> 
   <p>点击后，会进入到具体的触发器选择界面。左侧的「<em>New Feed Item</em>」是只要有新的条目（新的帖子）就会触发，右侧的「<em>New Feed Item Matches</em>」则是有新的条目（新的帖子），同时匹配到对应的关键词，才会触发，可以用于某些关键词的特殊监控（比如某些消极词汇）。</p> 
   <p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fnengyth25j31kw0ozgnb.jpg" alt="" title=""></p> 
   <p>我们使用左侧的「<em>New Feed Item</em>」 来设置监控（因为我们是以全站消息为例的，并非监控某个关键词）。</p> 
   <blockquote>
    <p>右侧的触发器和左侧的基本一致，仅仅是多了一个关键词的设置项。</p>
   </blockquote> 
   <p>在新的页面中，输入 产品板块对应的 RSS 的地址</p> 
   <h4>如何找到对应的 RSS 地址？</h4> 
   <p>对于每个产品的团队来说，需要的是自己板块的信息监控，那么，你就无法使用全站的 RSS 监控，这里我们可以使用各个板块自己的监控地址。</p> 
   <p>这里我们以 「<strong>云服务器 ECS</strong>」为例，进入阿里云论坛，找到对应的板块，并点击进去</p> 
   <p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fneohqohxrj312g09omxv.jpg" alt="" title=""></p> 
   <p>在板块顶部的介绍部分的右侧，你可以看到一个「<strong>订阅</strong>」</p> 
   <p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fneoi3rvnpj31kw0c6wfi.jpg" alt="" title=""></p> 
   <p>点击「订阅」，会进入到 RSS 信息页面。</p> 
   <p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fneojb5tjaj30zg06kmxs.jpg" alt="" title=""></p> 
   <p>复制地址栏中的地址，并进行简单的处理（删除其中的 SPM 部分），就可以作为我们监控用的 RSS 地址了。</p> 
   <blockquote> 
    <p><strong>地址处理方法</strong></p> 
    <p>去除请求中的 SPM 参数，如</p> 
    <p><a href="https://bbs.aliyun.com/rss.php?spm=5176.bbsl207.0.0.jPzBUj&amp;fid=207" rel="nofollow">https://bbs.aliyun.com/rss.php?spm=5176.bbsl207.0.0.jPzBUj&amp;fid=207</a></p> 
    <p>经过处理后的地址是</p> 
    <p><a href="https://bbs.aliyun.com/rss.php?fid=207" rel="nofollow">https://bbs.aliyun.com/rss.php?fid=207</a></p> 
    <p>我们去除了其中的 「<strong>spm=5176.bbsl207.0.0.jPzBUj&amp;</strong>」</p> 
    <p>这个参数是用来判别机器人的，不过我们是 RSS 监控，仅仅是读取操作，所以可以删除这个参数。不删除理论上也是可行的。</p> 
   </blockquote> 
   <p>获取到我们的 RSS 地址后，就可以继续设置我们的触发器了。在触发器中填写我们刚刚处理后的 RSS 地址。</p> 
   <p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fnenmia4qvj31gm0uu760.jpg" alt="" title=""></p> 
   <p>填写完成后，点击 <strong>Create Trigger</strong>.</p> 
   <h3>设置机器人</h3> 
   <p>确认后，我们会进入到设置动作的界面，点击 <strong>That</strong>，</p> 
   <p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fnenr0vk0nj319c0gqdg4.jpg" alt="" title="">在新的页面中，参照刚刚的设置，输入关键词「<strong>Web</strong>」，然后选择 <strong>WebHooks</strong> 服务。</p> 
   <p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fnent15ksvj315y0py0tg.jpg" alt="" title=""></p> 
   <p>在选择触发器界面，选择 「<strong>Make a web Request</strong>」。</p> 
   <p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fnenuighvbj31560o43zb.jpg" alt="" title=""></p> 
   <p>会进入新的界面，在这个界面，我们可以设置请求的具体内容，用于向钉钉机器人发送请求。</p> 
   <p>不过，在设置项目之前，我们需要先在「<strong>钉钉群</strong>」内创建机器人。</p> 
   <blockquote>
    <p>不是钉钉群无法加入机器人发送消息，所以你需要至少三个人来拉群。拉完群后，你可以把无关人等踢出去。</p>
   </blockquote> 
   <p>在钉钉群内，点击右上角的「<strong>群设置</strong>」</p> 
   <p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fneny3k68xj30yg03cweg.jpg" alt="" title=""></p> 
   <p>点击群设置中的「<strong>群机器人</strong>」</p> 
   <p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fnenzbfy9hj30jy0ha74n.jpg" alt="" title=""></p> 
   <p>添加一个「<strong>自定义机器人</strong>」</p> 
   <p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fnenzoc2igj31420vkjt7.jpg" alt="" title=""></p> 
   <p>点击「<strong>添加</strong>」</p> 
   <p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fneo0faccvj30re064mx1.jpg" alt="" title=""></p> 
   <p>简单设置一下机器人，点击下一步。</p> 
   <p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fneo1wo0x1j31k60u40tu.jpg" alt="" title=""></p> 
   <p>在新的页面，你会看到一个「<strong>WebHook</strong>」 地址，复制这个地址。稍后我们会用到。</p> 
   <p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fneo2i9j86j31340ugmy0.jpg" alt="" title=""></p> 
   <p>回到 <strong>IFTTT</strong> 的设置页面，继续我们刚刚未完成的设置。</p> 
   <p>将我们复制的 WebHook 地址，粘贴到其中的「<strong>URL</strong>」，下方的 Method 选择 「<strong>POST</strong>」，ContentType 选择 「<strong>application/json</strong>」。</p> 
   <p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fneo47lrxlj30oi12awh7.jpg" alt="" title=""></p> 
   <p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fneo61iemej30qw0kit9x.jpg" alt="" title=""></p> 
   <p>下方的 Body 则设置为</p> 
   <pre><code class="json">{ 
  "msgtype": "link", 
  "link": { "text": " {{EntryTitle}}", 
           "title": " {{EntryTitle}}", 
           "picUrl": " {{EntryImageUrl}}", 
           "messageUrl": " {{EntryUrl}}" 
          } 
}</code></pre> 
   <blockquote> 
    <p>上述代码可以实现如下效果。如果你有自定义的需求，可以根据上方的代码和钉钉机器人的<a href="https://open-doc.dingtalk.com/docs/doc.htm?treeId=257&amp;articleId=105735&amp;docType=1" rel="nofollow">设置文档</a>进行自定义。</p> 
    <p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fneo6v62pvj30p8096wem.jpg" alt="" title=""></p> 
   </blockquote> 
   <p>设置完成后，点击「<strong>Create Action</strong>」来创建对应动作。</p> 
   <p>在弹出的设置页面中，设置好对应的脚本名称，然后<strong>取消下方的 Receive notificati ons when this Applet runs 的选中(不取消而同时你安装了对应的 App ，可能会很吵)。</strong></p> 
   <p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fneo94mx3zj30ss12kwfm.jpg" alt="" title=""></p> 
   <p>最后，点击 Finish ，即可完成设置，后续，当论坛发出新帖后，机器人就会在群里发送通知的提醒。</p> 
   <blockquote>
    <p>由于 RSS 存在缓存和 IFTTT 监控频率的问题，所以消息通知可能不是实时的，不过时间间隔在15分钟以内，基本可以快速响应。</p>
   </blockquote> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
