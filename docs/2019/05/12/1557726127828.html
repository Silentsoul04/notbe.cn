<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>R语言与DataFrame « NotBeCN</title>
  <meta name="description" content="                               文章转自：https://segmentfault.com/a/1190000004621068        什么是DataFrame    引用&nbsp;r-tutor上的定义：         DataFrame 是一个表格或者类似二维数组的结...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2019/05/12/1557726127828.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">R语言与DataFrame</h1>
    <p class="post-meta">May 12, 2019</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <div id="article_content" class="article_content clearfix csdn-tracking-statistics"> 
   <a href="https://edu.csdn.net/topic/python115?utm_source=bw_bt" rel="nofollow" target="_blank"><img src="https://img-bss.csdn.net/1556441596718.png"></a> 
   <div class="htmledit_views" id="content_views"> 
    <h2><a></a>文章转自：https://segmentfault.com/a/1190000004621068</h2>
    <h2><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180319104456760?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3UwMTE1OTY0NTU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></h2>
    <h2><a></a>什么是DataFrame</h2>
    <p>引用&nbsp;<a href="http://ww2.coastal.edu/kingw/statistics/R-tutorials/dataframes.html" rel="nofollow" target="_blank">r-tutor</a>上的定义：</p>
    <blockquote>
     DataFrame 是一个表格或者类似二维数组的结构，它的各行表示一个实例，各列表示一个变量。
    </blockquote>
    <p>没错，DataFrame就是类似于Excel表格和MySQL数据库一样是一个结构化的数据体。而这种结构化的数据体是当代数据流编程中的中流砥柱，几乎所有先进算法的载体都是DataFrame，比如现在我们耳熟能详的逻辑回归算法、贝叶斯算法、支持向量机算法、XGBoost算法等等都建立在这个数据流编程的基础之上，我们可以在R、Python、Scala等函数式编程中找到他们的身影。</p>
    <h2><a></a>R中的DataFrame数据流编程</h2>
    <p>参考前文 [[原]基于RStudio Webinars的统计报告Web化与工程化实践总结](<a href="https://segmentfault.com/a/1190000004506149),%E6%88%91%E4%BB%AC%E5%B0%86%E6%95%B0%E6%8D%AE%E6%B5%81%E7%BC%96%E7%A8%8B%E5%88%86%E4%B8%BA%E6%95%B0%E6%8D%AE%E8%AF%BB%E5%8F%96" rel="nofollow" target="_blank">https://segmentfault.com/a/11...</a>、数据清洗、数据处理、数据可视化以及数据建模五个模块。</p>
    <p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180319104510665?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3UwMTE1OTY0NTU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
    <h3><a></a>数据读取 readr/httr/DBI</h3>
    <h4><a href="https://github.com/hadley/readr" rel="nofollow" target="_blank">readr</a></h4>
    <p><strong>readr</strong>简化了我们读取多种格式表格型数据的方法，包括分割文件<code>withread_delim()</code>,<code>read_csv()</code>、<code>read_tsv()</code>、<code>read_csv2()</code>、固定宽度文件读取的<code>read_fwf()</code>、<code>read_table()</code>以及<code>read_log()</code>来读取Web日志文件。在参数配置方面是和原生的<code>read.xxx()</code>函数族是看齐的。</p>
    <p>readr是利用C++和RCpp编写的，所以执行的速度是相当快的，不过相对于直接用C语言写的<code>data.table::fread()</code>就稍微慢大概1.2-2倍左右。在实际使用中，<code>data.talbe::fread()</code>的读取速度可以比原生的<code>read.csv</code>有3-10倍的提升速度。</p>
    <h4><a href="https://github.com/hadley/httr" rel="nofollow" target="_blank">httr</a></h4>
    <p><strong>httr</strong>是一个高级的网络请求库，类似于Python中的Tornado和Requests,除了提供基本的Restful接口设计功能，比如<code>GET()</code>,&nbsp;<code>HEAD()</code>,&nbsp;<code>PATCH()</code>,&nbsp;<code>PUT()</code>,&nbsp;<code>DELETE()</code>&nbsp;和&nbsp;<code>POST()</code>，还提供了OAuth的调用，比如<code>oauth1.0_token()</code>和<code>oauth2.0_token()</code>。而且<code>httr</code>还提供了诸如session、cookie、SSL、header、proxy、timeoutd等更过高级管理功能。当然你可以用它来做简单的爬虫应用，如果需要更高级的爬虫，我们需要投入<a href="https://github.com/hadley/rvest" rel="nofollow" target="_blank">rvest</a>的怀抱来支持诸如<code>xpath</code>等高级爬虫特性。</p>
    <h4><a href="https://github.com/rstats-db/DBI" rel="nofollow" target="_blank">DBI</a></h4>
    <p>DBI是一个为R与数据库通讯的数据库接口。相当于Java里面的DAO，Python里的Torndb和Tornlite，方便多种关系型数据库的SQL请求。其中最亮眼的是，R中的DataFrame和数据库之前可以以整个数据框插入的形式插入数据而不需要再拼接SQL语句。</p>
    <p>以下是一个官方文档的示例：</p>
    <pre class="hljs vim"><code class="hljs php"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         library(DBI)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"># 创建一个临时内存的 RSQLite 数据库</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-keyword">con</span> &lt;- dbConnect(RSQLite::SQLite(), dbname = 
         <span class="hljs-string"><span class="hljs-string">":memory:"</span></span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         dbListTables(
         <span class="hljs-keyword">con</span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"># 直接插入整个数据框到数据库中</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         dbWriteTable(
         <span class="hljs-keyword">con</span>, 
         <span class="hljs-string"><span class="hljs-string">"mtcars"</span></span>, mtcars)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         dbListTables(
         <span class="hljs-keyword">con</span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         dbListFields(
         <span class="hljs-keyword">con</span>, 
         <span class="hljs-string"><span class="hljs-string">"mtcars"</span></span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         dbReadTable(
         <span class="hljs-keyword">con</span>, 
         <span class="hljs-string"><span class="hljs-string">"mtcars"</span></span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"># 你可以获取所有结果:</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-keyword">res</span> &lt;- dbSendQuery(
         <span class="hljs-keyword">con</span>, 
         <span class="hljs-string"><span class="hljs-string">"SELECT * FROM mtcars WHERE cyl = 4"</span></span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         dbFetch(
         <span class="hljs-keyword">res</span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         dbClearResult(
         <span class="hljs-keyword">res</span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"># 或者一次取一块</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-keyword">res</span> &lt;- dbSendQuery(
         <span class="hljs-keyword">con</span>, 
         <span class="hljs-string"><span class="hljs-string">"SELECT * FROM mtcars WHERE cyl = 4"</span></span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!dbHasCompleted(
         <span class="hljs-keyword">res</span>)){
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
          chunk &lt;- dbFetch(
         <span class="hljs-keyword">res</span>, n = 
         <span class="hljs-number"><span class="hljs-number">5</span></span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
         <span class="hljs-keyword"><span class="hljs-keyword">print</span></span>(nrow(chunk))
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         }
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         dbClearResult(
         <span class="hljs-keyword">res</span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         dbDisconnect(
         <span class="hljs-keyword">con</span>)
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180319104528963?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3UwMTE1OTY0NTU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
    <h3><a></a>数据清洗 tidyr/jsonlite</h3>
    <h4><a href="https://github.com/hadley/tidyr" rel="nofollow" target="_blank">tidyr</a></h4>
    <p><code>tidyr</code>是一个数据清洗的新包，正在取代<code>reshape2</code>、<code>spreadsheets</code>等包。清洁的数据在数据处理的后续流程中十分重要，比如数据变化(dplyr),可视化(ggplot2/ggvis)以及数据建模等。<code>tidyr</code>主要提供了一个类似Excel中数据透视表(pivot table)的功能，提供<code>gather</code>和<code>spread</code>函数将数据在长格式和宽格式之间相互转化，应用在比如稀疏矩阵和稠密矩阵之间的转化。此外，<code>separate</code>和<code>union</code>方法提供了数据分组拆分、合并的功能，应用在nominal数据的转化上。</p>
    <h4><a href="https://github.com/jeroenooms/jsonlite" rel="nofollow" target="_blank">jsonlite</a></h4>
    <p>类似于Python中的json库，参考前文 [[原]数据流编程教程：R语言与非结构化数据共舞](<a href="https://segmentfault.com/a/1190000004592610)" rel="nofollow" target="_blank">https://segmentfault.com/a/11...</a>，我们可以知道jsonlite是一个标准的json转化库，依赖于jsonlite我们可以自由地在JSON和DataFrame之间相互转化。</p>
    <h3><a></a>数据处理 dplyr/rlist/purrr</h3>
    <h4><a href="https://github.com/hadley/dplyr" rel="nofollow" target="_blank">dplyr</a></h4>
    <p>dplyr包是现在数据流编程的核心,同时支持主流的管道操作&nbsp;<code>%&gt;%</code>，主要的数据处理方法包括：</p>
    <ul>
     <li>高级查询操作：</li>
    </ul>
    <p><code>select()</code>: 按列变量选择<br><code>filter()</code>: 按行名称分片<br><code>slice()</code>: 按行索引分片<br><code>mutate()</code>: 在原数据集最后一列追加一些数据集<br><code>summarise()</code>: 每组聚合为一个小数量的汇总统计，通常结合<code>gruop_by()</code>使用<br><code>arrange()</code>: 按行排序</p>
    <p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180319104541296?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3UwMTE1OTY0NTU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
    <ul>
     <li>关联表查询</li>
    </ul>
    <p><code>inner_join(x, y)</code>: 匹配 x + y<br><code>left_join(x, y)</code>: 所有 x + 匹配 y<br><code>semi_join(x, y)</code>: 所有 x 在 y 中匹配的部分<br><code>anti_join(x, y)</code>: 所有 x 在 y 中不匹配的部分</p>
    <ul>
     <li>集合操作</li>
    </ul>
    <p><code>intersect(x, y)</code>: x 和 y 的交集（按行）<br><code>union(x, y)</code>: x 和 y 的并集（按行）<br><code>setdiff(x, y)</code>: x 和 y 的补集 （在x中不在y中）</p>
    <p>更多详细操作可以参考由SupStats翻译的&nbsp;<a href="https://www.rstudio.com/wp-content/uploads/2015/03/data-wrangling-chinese.pdf" rel="nofollow" target="_blank">数据再加工速查表</a>，比Python的老鼠书直观很多。</p>
    <h4><a href="http://renkun.me/rlist/" rel="nofollow" target="_blank">rlist</a></h4>
    <p><a href="https://segmentfault.com/a/1190000004592610" rel="nofollow" target="_blank">参考前文 数据流编程教程：R语言与非结构化数据共舞</a>，我们知道，区别于<code>dplyr</code>包，<code>rlist</code>包是针对非结构化数据处理而生的，也对以<strong>list</strong>为核心的数据结构提供了类似DataFrame的高级查询、管道操作等等方法。</p>
    <h4><a href="https://github.com/hadley/purrr" rel="nofollow" target="_blank">purrr</a></h4>
    <p><code>purrr</code>向Scala这样的具有高级类型系统的函数式编程语言学习，为data frame的操作提供更多的函数式编程方法，比如map、lambda表达式。此外，<code>purrr</code>引入了<strong>静态类型</strong>，来解决原生的<code>apply</code>函数族类型系统不稳定的情况。</p>
    <p>我遇到过一个非常头疼的<code>apply</code>函数的问题：apply内的表达式计算结果不一致。</p>
    <pre class="hljs llvm"><code class="hljs python"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"># 原来表达式是这样的，但是返回的计算结果不对：</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"># </span>
         <span class="hljs-keyword"><span class="hljs-comment">x</span></span>
         <span class="hljs-number"><span class="hljs-comment">1</span></span>
         <span class="hljs-comment">，</span>
         <span class="hljs-keyword"><span class="hljs-comment">x</span></span>
         <span class="hljs-number"><span class="hljs-comment">2</span></span>
         <span class="hljs-comment">,</span>
         <span class="hljs-keyword"><span class="hljs-comment">x</span></span>
         <span class="hljs-number"><span class="hljs-comment">3</span></span>
         <span class="hljs-comment">都是一个含有NA值的一个</span>
         <span class="hljs-number"><span class="hljs-comment">10</span></span>
         <span class="hljs-keyword"><span class="hljs-comment">x</span></span>
         <span class="hljs-number"><span class="hljs-comment">10</span></span>
         <span class="hljs-comment">的矩阵</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         apply(
         <span class="hljs-keyword">x</span>
         <span class="hljs-number">1</span>*
         <span class="hljs-keyword">x</span>
         <span class="hljs-number">2</span>-
         <span class="hljs-keyword">x</span>
         <span class="hljs-number">1</span>*
         <span class="hljs-keyword">x</span>
         <span class="hljs-number">3</span>,
         <span class="hljs-number"><span class="hljs-number">1</span></span>,sum,na.rm=T)
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <p>于是改成分步计算才能得到正确答案。</p>
    <pre class="hljs mipsasm"><code class="hljs vbscript-html"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-built_in"><span class="xml">t1</span></span>
         <span class="xml"> <span class="hljs-tag">&lt;<span class="hljs-name">-</span> <span class="hljs-attr">apply</span>(<span class="hljs-attr">x1</span> * <span class="hljs-attr">x2</span>,</span></span>
         <span class="hljs-number"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span>
         <span class="xml"><span class="hljs-tag">,<span class="hljs-attr">sum</span>,<span class="hljs-attr">na.rm</span>=<span class="hljs-string">T)</span></span></span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-built_in"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">t2</span></span></span></span>
         <span class="xml"><span class="hljs-tag"> &lt;<span class="hljs-attr">-</span> <span class="hljs-attr">apply</span>(<span class="hljs-attr">x1</span> * <span class="hljs-attr">x3</span>,</span></span>
         <span class="hljs-number"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span>
         <span class="xml"><span class="hljs-tag">,<span class="hljs-attr">sum</span>,<span class="hljs-attr">na.rm</span>=<span class="hljs-string">T)</span></span></span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-built_in"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">t3</span></span></span></span>
         <span class="xml"><span class="hljs-tag"> &lt;<span class="hljs-attr">-</span> </span></span>
         <span class="hljs-built_in"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">t1</span></span></span></span>
         <span class="xml"><span class="hljs-tag"> <span class="hljs-attr">-</span> </span></span>
         <span class="hljs-built_in"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">t2</span></span></span></span>
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <p>如果使用<code>purrr</code>包就可以很好的解决这一问题。参考&nbsp;<a href="http://shawnmehan.com/purrr-package-for-r-is-good-for-performance/" rel="nofollow" target="_blank">Wisdom's Quintessence: Purrr package for R is good for performance</a>&nbsp;的例子：</p>
    <pre class="hljs gcode"><code class="hljs perl"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         library
         <span class="hljs-comment">(purrr)</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         mtcars 
         <span class="hljs-meta">%</span>&gt;
         <span class="hljs-meta">%</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
         <span class="hljs-keyword">split</span>
         <span class="hljs-comment">(.$cyl)</span> 
         <span class="hljs-meta">%</span>&gt;
         <span class="hljs-meta">%</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
         <span class="hljs-keyword">map</span>
         <span class="hljs-comment">(~ lm(mpg ~ wt, data = .)</span>) 
         <span class="hljs-meta">%</span>&gt;
         <span class="hljs-meta">%</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
         <span class="hljs-keyword">map</span>
         <span class="hljs-comment">(summary)</span> 
         <span class="hljs-meta">%</span>&gt;
         <span class="hljs-meta">%</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
          map_dbl
         <span class="hljs-comment">(<span class="hljs-string">"r.squared"</span>)</span>
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <p>具体使用可以参考<a href="http://blog.rstudio.org/2016/01/06/purrr-0-2-0/" rel="nofollow" target="_blank">Rstudio Blog:purrr 0.2.0</a>。</p>
    <h3><a></a>数据可视化 ggplot2/ggvis</h3>
    <h4><a href="http://ggplot2.org/" rel="nofollow" target="_blank">ggplot2</a></h4>
    <p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180319104555375?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3UwMTE1OTY0NTU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
    <p>ggplot2 是一个增强的数据可视化R包，帮助我们轻松创建令人惊叹的多层图形。它的设计理念类似于PhotoShop,具体参数包含设计对象、艺术渲染、统计量、尺寸调整、坐标系统、分片显示、位置调整、动画效果等等。</p>
    <p>更多操作可以查看<a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf" rel="nofollow" target="_blank">ggplot2与数据可视化速查表</a>&nbsp;和&nbsp;<a href="http://docs.ggplot2.org/current/index.html" rel="nofollow" target="_blank">官方文档</a></p>
    <p>实战可以参考<a href="https://github.com/harryprince/R-Tutor/raw/master/R%E4%B9%A6/R%20Graphics%20Cookbook%20.pdf" rel="nofollow" target="_blank">R Graphics Cookbook一书</a>。</p>
    <h4><a href="http://ggvis.rstudio.com/" rel="nofollow" target="_blank">ggvis</a></h4>
    <p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180319104606848?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3UwMTE1OTY0NTU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
    <p><code>ggvis</code>是吸收了<a href="http://ggvis.rstudio.com/ggplot2.html" rel="nofollow" target="_blank">ggplot2</a>、<a href="http://ggvis.rstudio.com/vega.html" rel="nofollow" target="_blank">vega以及d3</a>的精华，目标旨在配合shiny打造动态可交互的可视化组件。<code>ggvis</code>最明显的区别就是在作图时直接支持<code>%&gt;%</code>的管道操作，比如：</p>
    <pre class="hljs less"><code class="hljs go"><span class="hljs-selector-tag">diamonds</span>&nbsp;%&gt;%&nbsp;<span class="hljs-selector-tag">ggvis</span>(~carat, ~price, fill=~clarity) %&gt;%&nbsp;<span class="hljs-selector-tag">layer_points</span>(<span class="hljs-attribute">opacity</span>:=<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">2</span></span>)</code>
     <div class="hljs-button {2}"></div></pre>
    <p><a href="http://www.jimhester.com/ggplot2ToGgvis/" rel="nofollow" target="_blank">ggplot2与ggvis的关系</a>类似于<a href="http://www.jimhester.com/plyrToDplyr/" rel="nofollow" target="_blank">plyr与dplyr的关系</a>,都是一种演化过程。</p>
    <h3><a></a>数据建模 broom</h3>
    <h4>broom</h4>
    <p>在机器学习的本质其实就是各种姿势的回归，而在R中的各种回归分析往往不会返回一个整齐的data frame 结果。<a href="http://www.r-bloggers.com/slides-from-my-talk-on-the-broom-package/" rel="nofollow" target="_blank">比如</a>：</p>
    <pre class="hljs lisp"><code class="hljs"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         lmfit &lt;- lm(
         <span class="hljs-name">mpg</span> ~ wt, mtcars)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         lmfit
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <pre class="hljs clean"><code class="hljs python"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment">## </span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment">## Call:</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment">## lm(formula = mpg ~ wt, data = mtcars)</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment">## </span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment">## Coefficients:</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment">## (Intercept) wt </span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment">## </span>
         <span class="hljs-number"><span class="hljs-comment">37.285</span></span>
         <span class="hljs-comment"> </span>
         <span class="hljs-number"><span class="hljs-comment">-5.344</span></span>
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <p>这时候<code>broom</code>包就派上用场了，直接将统计结果转化为data frame格式：</p>
    <pre class="hljs stylus"><code class="hljs delphi"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-function"><span class="hljs-title"><span class="hljs-keyword">library</span></span><span class="hljs-params">(broom)</span></span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-function"><span class="hljs-title">tidy</span><span class="hljs-params">(lmfit)</span></span>
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <pre><code class="language-css hljs"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## <span class="hljs-selector-tag"><span class="hljs-selector-tag">term</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">estimate</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">std</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.error</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">statistic</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">p</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.value</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## 1 (<span class="hljs-selector-tag"><span class="hljs-selector-tag">Intercept</span></span>) 37<span class="hljs-selector-class"><span class="hljs-selector-class">.285126</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.877627</span></span> 19<span class="hljs-selector-class"><span class="hljs-selector-class">.857575</span></span> 8<span class="hljs-selector-class"><span class="hljs-selector-class">.241799e-19</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">wt</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-5</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.344472</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.559101</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-9</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.559044</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.293959e-10</span></span></code>
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <p><code>augment()</code>函数返回data frame格式的s其所有他参数结果</p>
    <pre class="hljs lisp"><code class="hljs">head(<span class="hljs-name">augment</span>(<span class="hljs-name">lmfit</span>))</code>
     <div class="hljs-button {2}"></div></pre>
    <pre><code class="language-css hljs"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## <span class="hljs-selector-class"><span class="hljs-selector-class">.rownames</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mpg</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">wt</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.fitted</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.se</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.fit</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.resid</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.hat</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.sigma</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.cooksd</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.std</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.resid</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Mazda</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">RX4</span></span> 21<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.620</span></span> 23<span class="hljs-selector-class"><span class="hljs-selector-class">.28261</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.6335798</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.2826106</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.04326896</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.067494</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.327407e-02</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.76616765</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Mazda</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">RX4</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Wag</span></span> 21<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.875</span></span> 21<span class="hljs-selector-class"><span class="hljs-selector-class">.91977</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.5714319</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.9197704</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.03519677</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.093068</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.723963e-03</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.30743051</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## 3 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Datsun</span></span> 710 22<span class="hljs-selector-class"><span class="hljs-selector-class">.8</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.320</span></span> 24<span class="hljs-selector-class"><span class="hljs-selector-class">.88595</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.7359177</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0859521</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.05837573</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.072127</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.543937e-02</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.70575249</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Hornet</span></span> 4 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Drive</span></span> 21<span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.215</span></span> 20<span class="hljs-selector-class"><span class="hljs-selector-class">.10265</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.5384424</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.2973499</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.03125017</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.088268</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.020558e-03</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.43275114</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## 5 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Hornet</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Sportabout</span></span> 18<span class="hljs-selector-class"><span class="hljs-selector-class">.7</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.440</span></span> 18<span class="hljs-selector-class"><span class="hljs-selector-class">.90014</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.5526562</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.2001440</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.03292182</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.097722</span></span> 7<span class="hljs-selector-class"><span class="hljs-selector-class">.599578e-05</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.06681879</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## 6 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Valiant</span></span> 18<span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.460</span></span> 18<span class="hljs-selector-class"><span class="hljs-selector-class">.79325</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.5552829</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.6932545</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.03323551</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.095184</span></span> 9<span class="hljs-selector-class"><span class="hljs-selector-class">.210650e-04</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.23148309</span></span></code>
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <p><code>glance()</code>函数，返回data frame格式的部分参数结果</p>
    <pre class="hljs stylus"><code class="hljs"><span class="hljs-function"><span class="hljs-title">glance</span><span class="hljs-params">(lmfit)</span></span></code>
     <div class="hljs-button {2}"></div></pre>
    <pre><code class="language-css hljs"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## <span class="hljs-selector-tag"><span class="hljs-selector-tag">r</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.squared</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">adj</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.r</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.squared</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sigma</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">statistic</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">p</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.value</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">logLik</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## 1 0<span class="hljs-selector-class"><span class="hljs-selector-class">.7528328</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.7445939</span></span> 3<span class="hljs-selector-class"><span class="hljs-selector-class">.045882</span></span> 91<span class="hljs-selector-class"><span class="hljs-selector-class">.37533</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.293959e-10</span></span> 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-80</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.01471</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## <span class="hljs-selector-tag"><span class="hljs-selector-tag">AIC</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">BIC</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">deviance</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">df</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.residual</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>## 1 166<span class="hljs-selector-class"><span class="hljs-selector-class">.0294</span></span> 170<span class="hljs-selector-class"><span class="hljs-selector-class">.4266</span></span> 278<span class="hljs-selector-class"><span class="hljs-selector-class">.3219</span></span> 30</code>
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <h2><a></a>DataFrame优化</h2>
    <h3><a></a>data.table</h3>
    <p>众所周知，data.frame的几个缺点有：</p>
    <ol>
     <li>大数据集打印缓慢</li>
     <li>内部搜索缓慢</li>
     <li>语法复杂</li>
     <li>缺乏内部的聚合操作</li>
    </ol>
    <p>针对这几个问题，data.table应运而生。data.table完美兼容data.frame，这意味着之前对data.frame的操作我们可以完全保留，并且支持更多方便的数据操作方法。</p>
    <p>data.table还参考了NoSQL中流行的Key-Value形式，引入了<code>setkey()</code>函数,为数据框设置关键字索引。</p>
    <p>值得一提的是data.table引入了全新的索引形式，大大简化了data frame的分片形式，提供接近于原生矩阵的操作方式并直接利用C语言构造底层，保证操作的速度。</p>
    <h5>对比操作</h5>
    <p>对比data.table 和 dplyr 的操作：</p>
    <div class="table-box">
     <table>
      <thead>
       <tr>
        <th>操作</th>
        <th>data.table</th>
        <th>dplyr</th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td>按行分片</td>
        <td>DT[1:2,]</td>
        <td>DF[1:2,]</td>
       </tr>
       <tr>
        <td>按列分片</td>
        <td>DT[,1:2,with=False]</td>
        <td>DF[,1:2]</td>
       </tr>
       <tr>
        <td>分组summarise</td>
        <td>DT[, sum(y), by=z]</td>
        <td>DF %&gt;% group_by(z) %&gt;% summarise(sum(y))</td>
       </tr>
       <tr>
        <td>分组mutate</td>
        <td>DT[, y := cumsum(y), by=z]</td>
        <td>ans &lt;- DF %&gt;% group_by(z) %&gt;% mutate(y = cumsum(y))</td>
       </tr>
       <tr>
        <td>筛选后分组汇总</td>
        <td>DT[x &gt; 2, sum(y), by=z]</td>
        <td>DF %&gt;% filter(x&gt;2) %&gt;% group_by(z) %&gt;% summarise(sum(y))</td>
       </tr>
       <tr>
        <td>筛选后分组更新</td>
        <td>DT[x &gt; 2, y := cumsum(y), by=z]</td>
        <td>ans &lt;- DF %&gt;% group_by(z) %&gt;% mutate(y = replace(y, which(x&gt;2), cumsum(y)))</td>
       </tr>
       <tr>
        <td>分组后按条件汇总</td>
        <td>DT[, if(any(x &gt; 5L)){y[1L]-y[2L]}else{y[2L], by=z]}</td>
        <td>DF %&gt;% group_by(z) %&gt;% summarise(if (any(x &gt; 5L)) y[1L]-y[2L] else y[2L])</td>
       </tr>
      </tbody>
     </table>
    </div>
    <h5>apply函数族</h5>
    <div class="table-box">
     <table>
      <thead>
       <tr>
        <th>操作</th>
        <th>data.table</th>
        <th>dplyr</th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td>分组扩展各list</td>
        <td>DT[, (cols) := lapply(.SD, sum), by=z]</td>
        <td>ans &lt;- DF %&gt;% group_by(z) %&gt;% mutate_each(funs(sum))</td>
       </tr>
       <tr>
        <td>分组汇总各list</td>
        <td>DT[, lapply(.SD, sum), by=z]</td>
        <td>DF %&gt;% group_by(z) %&gt;% summarise_each(funs(sum))</td>
       </tr>
       <tr>
        <td>分组汇总各list</td>
        <td>DT[, c(lapply(.SD, sum),lapply(.SD, mean)), by=z]</td>
        <td>DF %&gt;% group_by(z) %&gt;% summarise_each(funs(sum, mean))</td>
       </tr>
       <tr>
        <td>分组汇总各list</td>
        <td>DT[, c(.N, lapply(.SD, sum)), by=z]</td>
        <td>DF %&gt;% group_by(z) %&gt;% summarise_each(funs(n(), mean))</td>
       </tr>
      </tbody>
     </table>
    </div>
    <h5>join 操作</h5>
    <pre class="hljs stylus"><code class="hljs"><span class="hljs-function"><span class="hljs-title">setkey</span><span class="hljs-params">(DT1, x, y)</span></span></code>
     <div class="hljs-button {2}"></div></pre>
    <div class="table-box">
     <table>
      <thead>
       <tr>
        <th>操作</th>
        <th>data.table</th>
        <th>dplyr</th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td>一般join</td>
        <td>DT1[DT2]</td>
        <td>left_join(DT2, DT1)</td>
       </tr>
       <tr>
        <td>择列join</td>
        <td>DT1[DT2, .(z, i.mul)]</td>
        <td>left_join(select(DT2, x,y,mul), select(DT1, x,y,z))</td>
       </tr>
       <tr>
        <td>聚合join</td>
        <td>DT1[DT2, .(sum(z)*i.mul), by=.EACHI]</td>
        <td>DF1 %&gt;% group_by(x, y) %&gt;% summarise(z=sum(z)) %&gt;% inner_join(DF2) %&gt;% mutate(z = z*mul) %&gt;% select(-mul)</td>
       </tr>
       <tr>
        <td>更新join</td>
        <td>DT1[DT2, z := cumsum(z)*i.mul, by=.EACHI]</td>
        <td>join and group by + mutate</td>
       </tr>
       <tr>
        <td>滚动join</td>
        <td>DT1[DT2, roll = -Inf]</td>
        <td>/</td>
       </tr>
       <tr>
        <td>其他变量控制输出</td>
        <td>DT1[DT2, mult = "first"]</td>
        <td>/</td>
       </tr>
      </tbody>
     </table>
    </div>
    <h5>拼接操作</h5>
    <div class="table-box">
     <table>
      <thead>
       <tr>
        <th>操作</th>
        <th>data.table</th>
        <th>dplyr</th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td>分组再分list聚合</td>
        <td>DT[, list(x[1], y[1]), by=z]</td>
        <td>DF %&gt;% group_by(z) %&gt;% summarise(x[1], y[1])</td>
       </tr>
       <tr>
        <td>分组再分list拼接</td>
        <td>DT[, list(x[1:2], y[1]), by=z]</td>
        <td>DF %&gt;% group_by(z) %&gt;% do(data.frame(.$x[1:2], .$y[1]))</td>
       </tr>
       <tr>
        <td>分组取分位数聚合</td>
        <td>DT[, quantile(x, 0.25), by=z]</td>
        <td>DF %&gt;% group_by(z) %&gt;% summarise(quantile(x, 0.25))</td>
       </tr>
       <tr>
        <td>分组取分位数拼接</td>
        <td>DT[, quantile(x, c(0.25, 0.75)), by=z]</td>
        <td>DF %&gt;% group_by(z) %&gt;% do(data.frame(quantile(.$x, c(0.25, 0.75))))</td>
       </tr>
       <tr>
        <td>分组分list聚合拼接</td>
        <td>DT[, as.list(summary(x)), by=z]</td>
        <td>DF %&gt;% group_by(z) %&gt;% do(data.frame(as.list(summary(.$x))))</td>
       </tr>
      </tbody>
     </table>
    </div>
    <p>更多操作详情可查看<a href="https://s3.amazonaws.com/assets.datacamp.com/img/blog/data+table+cheat+sheet.pdf" rel="nofollow" target="_blank">data.table速查表</a>。</p>
    <h2><a></a>DataFrame可视化</h2>
    <h3><a></a><a href="https://rstudio.github.io/DT/" rel="nofollow" target="_blank">DT</a></h3>
    <p><code>DT</code>包是谢溢辉老师的大作，为data frame数据提供了非常好的可视化功能，并且提供了筛选、分页、排序、搜索等数据查询操作。</p>
    <pre class="hljs stylus"><code class="hljs delphi"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-function"><span class="hljs-title"><span class="hljs-keyword">library</span></span><span class="hljs-params">(DT)</span></span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-function"><span class="hljs-title">datatable</span><span class="hljs-params">(iris)</span></span>
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180319104635661?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3UwMTE1OTY0NTU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
    <p>此外，<code>DT</code>包还提供了大量的UI定制的功能,对html、css和js进行深度定制。比如：</p>
    <pre><code class="language-vb hljs vbnet"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>m = matrix(c(</code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code> <span class="hljs-comment"><span class="hljs-comment">'</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;b&gt;</span></span></span><span class="hljs-comment">Bold</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/b&gt;</span></span></span><span class="hljs-comment">', '</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;em&gt;</span></span></span><span class="hljs-comment">Emphasize</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/em&gt;</span></span></span><span class="hljs-comment">', '</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;a href="http://rstudio.com"&gt;</span></span></span><span class="hljs-comment">RStudio</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/a&gt;</span></span></span><span class="hljs-comment">',</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code> <span class="hljs-comment"><span class="hljs-comment">'</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;a href="#" onclick="alert(\'Hello World\');"&gt;</span></span></span><span class="hljs-comment">Hello</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/a&gt;</span></span></span><span class="hljs-comment">'</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>), <span class="hljs-number"><span class="hljs-number">2</span></span>)</code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>colnames(m) = c(<span class="hljs-comment"><span class="hljs-comment">'</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;span style="color:red"&gt;</span></span></span><span class="hljs-comment">Column 1</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/span&gt;</span></span></span><span class="hljs-comment">', '</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;em&gt;</span></span></span><span class="hljs-comment">Column 2</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/em&gt;</span></span></span><span class="hljs-comment">')</span></span></code>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <code>datatable(m) <span class="hljs-meta"><span class="hljs-meta"># 默认 escape = TRUE </span></span></code>
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180319104710746?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3UwMTE1OTY0NTU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
    <pre class="hljs stylus"><code class="hljs vbscript"><span class="hljs-function"><span class="hljs-title">datatable</span><span class="hljs-params">(m, escape = <span class="hljs-literal">FALSE</span>)</span></span></code>
     <div class="hljs-button {2}"></div></pre>
    <p><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20180319104724848?watermark/2/text/Ly9ibG9nLmNzZG4ubmV0L3UwMTE1OTY0NTU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p>
    <pre class="hljs lasso"><code class="hljs php"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         raw_matrix %&gt;%
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         DT
         <span class="hljs-type">::datatable</span>(options = 
         <span class="hljs-built_in"><span class="hljs-keyword">list</span></span>(pageLength = 
         <span class="hljs-number"><span class="hljs-number">30</span></span>, dom = 
         <span class="hljs-string"><span class="hljs-string">'tip'</span></span>)) %&gt;% 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
          DT
         <span class="hljs-type">::formatStyle</span>(columns = c(
         <span class="hljs-string"><span class="hljs-string">"A"</span></span>,
         <span class="hljs-string"><span class="hljs-string">"B"</span></span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
          background = styleColorBar(c(
         <span class="hljs-number"><span class="hljs-number">0</span></span>, 
         <span class="hljs-keyword">max</span>(raw_matrix,na.rm = 
         <span class="hljs-literal"><span class="hljs-keyword">TRUE</span></span>)), 
         <span class="hljs-string"><span class="hljs-string">'steelblue'</span></span>),
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
          backgroundSize = 
         <span class="hljs-string"><span class="hljs-string">'100% 50%'</span></span>,
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
          backgroundRepeat = 
         <span class="hljs-string"><span class="hljs-string">'no-repeat'</span></span>,
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
          backgroundPosition = 
         <span class="hljs-string"><span class="hljs-string">'center'</span></span>) 
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <h2><a></a>分布式DataFrame</h2>
    <h3><a></a><a target="_blank">sparklyr</a></h3>
    <p>sparklyr是 rstudio 公司为链接spark 和dataframe 编写的一套分布式数据处理框架，用一个统一的跨引擎API简化了多数据源的分析操作，进一步将data frame底层的分布式傻瓜化。</p>
    <p>在R中使用sparklyr::spark_apply，我们不需要修改之前任何的代码，并且绕过Hadoop的绝对限制，就可以让data frame格式的数据，自动获得分布式处理的能力！</p>
    <pre class="hljs clean"><code class="hljs php"></code>
     <ol class="hljs-ln">
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"># 创建 spark链接 管理器来运行Spark引擎</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         sc &lt;- sparklyr::spark_connect(master = 
         <span class="hljs-string"><span class="hljs-string">"local"</span></span>,
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         version = 
         <span class="hljs-string"><span class="hljs-string">"2.2.0"</span></span>,
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         method = 
         <span class="hljs-string"><span class="hljs-string">"livy"</span></span>,
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         config = sparklyr::config())
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"># 通过SQL读取spark数据</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         ddf &lt;- DBI::dbGetQuery(sc, 
         <span class="hljs-string"><span class="hljs-string">"select * from mtcars"</span></span>)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"><span class="hljs-comment">/*Basic Stats*/</span></span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"># 返回行/列的值</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         ncol(ddf)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         nrow(ddf)
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line"> 
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         <span class="hljs-comment"># 在 DF 上进行运行标准汇总</span>
        </div>
       </div></li>
      <li>
       <div class="hljs-ln-numbers">
        <div class="hljs-ln-line hljs-ln-n"></div>
       </div>
       <div class="hljs-ln-code">
        <div class="hljs-ln-line">
         summary(ddf)
        </div>
       </div></li>
     </ol>
     <div class="hljs-button {2}"></div></pre>
    <p>更多具体操作可以参考<a target="_blank">官方指南</a></p>
    <h2><a></a>DataFrame在R、Python和Spark三者中的联系</h2>
    <div class="table-box">
     <table>
      <thead>
       <tr>
        <th>操作</th>
        <th>R</th>
        <th>Python</th>
        <th>Spark</th>
       </tr>
      </thead>
      <tbody>
       <tr>
        <td>库</td>
        <td>base</td>
        <td>Pandas</td>
        <td>spark SQL</td>
       </tr>
       <tr>
        <td>读取csv</td>
        <td>read.csv()</td>
        <td>read_csv()</td>
        <td>spark-csv</td>
       </tr>
       <tr>
        <td>计数</td>
        <td>nrow()</td>
        <td>pandasDF.count()</td>
        <td>sparkDF.count()</td>
       </tr>
       <tr>
        <td>分片</td>
        <td>head(data,5)</td>
        <td>pandasDF.head(5)</td>
        <td>sparkDF.show(5)</td>
       </tr>
       <tr>
        <td>推断类型</td>
        <td>自动推断</td>
        <td>自动推断</td>
        <td>默认为string类型</td>
       </tr>
       <tr>
        <td>标准差计算中的NaN处理</td>
        <td>视为NA</td>
        <td>自动排除</td>
        <td>视为NaN</td>
       </tr>
       <tr>
        <td>特征工程</td>
        <td>dplyr::mutate()</td>
        <td>pandasDF['new']</td>
        <td>sparkDF.withColumn()</td>
       </tr>
      </tbody>
     </table>
    </div>
    <h2><a></a>DataFrame 之我见</h2>
    <ol>
     <li>处理数据的第一语言还是 SQL语句，因为SQL是DSL，这样就对使用者没有Python或者R的要求，也方便与DBA的维护。在R中可以使用&nbsp;<code>sqldf</code>&nbsp;通过SQL直接操作DataFrame，在Python中可以使用&nbsp;<code>pysqldf</code>。</li>
     <li>处理数据的第二语言则是&nbsp;<code>tidyverse</code>&nbsp;或者&nbsp;<code>pandas</code>，使用这样的链式调用方法可以提升数据流的处理效率，规避一些原生SQL在不同数据库中执行情况不同或者可读性较差的问题。</li>
     <li>处理数据的第三语言则是&nbsp;<code>data.table</code>&nbsp;或者&nbsp;<code>scala</code>，使用这样高性能的方法可以在关键步骤提升数据处理效率到极致，不过会牺牲一部分维护性。</li>
    </ol>
    <h2><a></a>参考资料</h2>
    <ul>
     <li><a href="https://medium.com/@chris_bour/6-differences-between-pandas-and-spark-dataframes-1380cec394d2#.gogkr1g53" rel="nofollow" target="_blank">Medium：6 Differences Between Pandas And Spark DataFrames</a></li>
     <li><a href="https://www.quora.com/What-are-the-differences-of-DataFrame-between-R-and-Pandas" rel="nofollow" target="_blank">Quora：What are the differences of DataFrame between R and Pandas?</a></li>
     <li><a href="http://www.r-tutor.com/r-introduction/data-frame" rel="nofollow" target="_blank">R Tutorial: Data Frame</a></li>
     <li><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html" rel="nofollow" target="_blank">Python Pandas 官方文档</a></li>
     <li><a href="https://www.zhihu.com/question/30128788" rel="nofollow" target="_blank">知乎：R语言读大数据？</a></li>
     <li><a href="https://www.zhihu.com/question/24779017/answer/68072152" rel="nofollow" target="_blank">知乎的高分问答：如何使用 ggplot2？</a></li>
     <li><a href="http://www.cookbook-r.com/Graphs/" rel="nofollow" target="_blank">R Graphs Cookbook</a></li>
     <li><a href="http://blog.revolutionanalytics.com/2015/06/sparkr-announcement.html" rel="nofollow" target="_blank">SparkR: Distributed data frames with Spark and R</a></li>
     <li><a href="https://vimeo.com/130411487" rel="nofollow" target="_blank">Vimeo:R Data Structures</a></li>
     <li><a href="https://databricks.com/blog/2015/06/09/announcing-sparkr-r-on-spark.html" rel="nofollow" target="_blank">Announcing SparkR: R on Spark</a></li>
     <li><a href="https://amplab-extras.github.io/SparkR-pkg/" rel="nofollow" target="_blank">amplab: SparkR R frontend for Spark</a></li>
     <li><a href="https://www.codementor.io/spark/tutorial/spark-r-data-frame-operations-sql" rel="nofollow" target="_blank">codementor: data frame operations with SparkR</a></li>
     <li><a href="https://spark-summit.org/2014/wp-content/uploads/2014/07/Adatao-Distributed-DataFrame-on-Apache-Spark-Simplifying-Big-Data-For-The-Rest-of-Us-Christopher-Nguyen.pdf" rel="nofollow" target="_blank">Spark Summit: Distributed DataFrame (DDF) Simplifying Big Data For The Rest Of Us</a></li>
     <li><a href="http://spark.apache.org/docs/latest/api/R/index.html" rel="nofollow" target="_blank">SparkR 官方文档</a></li>
     <li><a href="http://blog.fens.me/r-data-table/" rel="nofollow" target="_blank">粉丝日志: 超高性能数据处理包data.table</a></li>
     <li><a href="http://yhat.github.io/ggplot/docs.html" rel="nofollow" target="_blank">yhat ggplot2 doc</a></li>
     <li><a href="http://pdf.th7.cn/down/files/1508/Fast%20Data%20Processing%20with%20Spark,%202nd%20Edition.pdf" rel="nofollow" target="_blank">Fast Data Processing with Spark, 2nd Edition</a></li>
    </ul> 
   </div> 
  </div> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-258a4616f7.css" rel="stylesheet"> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
