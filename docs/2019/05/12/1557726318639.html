<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>task1 « NotBeCN</title>
  <meta name="description" content="                  1.什么是PyTorch，为什么选择PyTroch？ 什么是PyTorch，我们先来回答“PyTorch是什么”，简单的说，PyTorch就是一个深度学习框架，而反过来，深度学习的框架可不仅仅是Pytorch，好了，废话完了。来说说什么是PyTorch吧，网上已经有很多资料对P...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2019/05/12/1557726318639.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">task1</h1>
    <p class="post-meta">May 12, 2019</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <p>1.什么是PyTorch，为什么选择PyTroch？<br> 什么是PyTorch，我们先来回答“PyTorch是什么”，简单的说，PyTorch就是一个深度学习框架，而反过来，深度学习的框架可不仅仅是Pytorch，好了，废话完了。来说说什么是PyTorch吧，网上已经有很多资料对Pytorch进行的详细的描述，自身能力有限，不能够详尽的描述出其定义，我主要通过网上开源的资料进入，结合自己的一些看法，选择性的进行定义的描述，有不对的地方希望大家能够补充。 要了解一个框架就应该八卦一下它，这样才能让人记忆深刻吧。 这个文章里就扒了TensorFlow和PyTorch的区别，举例来说，PyTorch更加容易学习和调试，而且Facebook也将之前开发的Torch和Caffe等框架往上边迁移，而且近期发布的1.1版本还原生支持了Tensorboard。那么我通过添加对逆命题添加两个限定条件来给个不学术的定义，易于学习的发展趋势迅猛的深度学习框架是PyTorch。至于为什么要用PyTorch，主要是因为越来越读论文使用PyTorch实现并开源代码，选择PyTorch，这样我们就能愉快地搬砖了。</p> 
  <p>2.PyTorch的安装<br> Pytroch的安装，官网提供了4种安装方式，目前仅使用过conda和pip安装 。推荐使用conda安装，它会将需要的依赖都一并安装上，同时应该注意安装之前先用conda构建虚拟环境，这样你就有多个python2或者python3,Pyroch0.4.1或者PyTorch1.0的版本了。</p> 
  <p>3.配置Python环境<br> 这里我使用Anaconda配置python环境，这里面集成了很多工具，同时也方便版本管理。首先下载安装包，然后在对应文件夹目录打开命令行工具通过下面的命令进行安装。</p> 
  <p>4.准备Python管理器<br> 上面我已经安装了Anaconda就可以使用里面的conda工具进行虚拟环境以及依赖包的安装。</p> 
  <p>5.通过命令行安装PyTorch<br> 同样接着上边，进入官网，选择机子环境后获取conda安装命令。</p> 
  <p>6.PyTorch基础概念<br> 根据这篇文章的介绍，主要将PyTorch分为三个部分，数据处理、模型和损失及优化器。数据处理，在cv中，PyTorch有很好的vision库，transform很方便的对图像进行翻转旋转以及归一化等操作。模型，nn模块里集成了很多SOTA的模型，简单几行代码就能够使用已经训练过的模型。损失函数以及优化器，对不同的任务会使用不同的损失进行调优，而优化的算法自己也只是照搬的Adam优化，对这一部分了解不是很深入，等后续将文章里的资料详细了解之后再回来填坑。</p> 
  <p>7.通过代码实现流程(实现一个深度学习的代码流程)<br> 自己没有造轮子的技能，就先按照官网的教程实现了一遍Mnist的分类<br> import torch<br> import torchvision<br> import torchvision.transforms as transforms<br> import matplotlib.pyplot as plt<br> import numpy as np<br> import torch.nn as nn<br> import torch.nn.functional as F<br> import torch.optim as optim<br> ​<br> transform = transforms.Compose(<br> [transforms.ToTensor(),<br> transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))])<br> ​<br> trainset = torchvision.datasets.CIFAR10(root=’./data’, train=True,<br> download=True, transform=transform)<br> trainloader = torch.utils.data.DataLoader(trainset, batch_size=4,<br> shuffle=True, num_workers=2)<br> ​<br> testset = torchvision.datasets.CIFAR10(root=’./data’, train=False,<br> download=True, transform=transform)<br> testloader = torch.utils.data.DataLoader(testset, batch_size=4,<br> shuffle=False, num_workers=2)<br> ​<br> classes = (‘plane’, ‘car’, ‘bird’, ‘cat’,<br> ‘deer’, ‘dog’, ‘frog’, ‘horse’, ‘ship’, ‘truck’)<br> ​<br> def imshow(img):<br> img = img / 2 + 0.5 # unnormalize<br> npimg = img.numpy()<br> plt.imshow(np.transpose(npimg, (1, 2, 0)))<br> plt.show()<br> ​<br> ​</p> 
  <h1><a id="get_some_random_training_images_54"></a>get some random training images</h1> 
  <p>dataiter = iter(trainloader)<br> images, labels = dataiter.next()<br> ​</p> 
  <h1><a id="show_images_58"></a>show images</h1> 
  <p>imshow(torchvision.utils.make_grid(images))</p> 
  <h1><a id="print_labels_60"></a>print labels</h1> 
  <p>print(’ ‘.join(’%5s’ % classes[labels[j]] for j in range(4)))<br> ​<br> class Net(nn.Module):<br> def <strong>init</strong>(self):<br> super(Net, self).<strong>init</strong>()<br> self.conv1 = nn.Conv2d(3, 6, 5)<br> self.pool = nn.MaxPool2d(2, 2)<br> self.conv2 = nn.Conv2d(6, 16, 5)<br> self.fc1 = nn.Linear(16 * 5 * 5, 120)<br> self.fc2 = nn.Linear(120, 84)<br> self.fc3 = nn.Linear(84, 10)<br> ​<br> def forward(self, x):<br> x = self.pool(F.relu(self.conv1(x)))<br> x = self.pool(F.relu(self.conv2(x)))<br> x = x.view(-1, 16 * 5 * 5)<br> x = F.relu(self.fc1(x))<br> x = F.relu(self.fc2(x))<br> x = self.fc3(x)<br> return x<br> ​<br> ​<br> net = Net()<br> ​<br> criterion = nn.CrossEntropyLoss()<br> optimizer = optim.SGD(net.parameters(), lr=0.001, momentum=0.9)<br> ​<br> for epoch in range(2): # loop over the dataset multiple times<br> ​<br> running_loss = 0.0<br> for i, data in enumerate(trainloader, 0):<br> # get the inputs<br> inputs, labels = data<br> ​<br> # zero the parameter gradients<br> optimizer.zero_grad()<br> ​<br> # forward + backward + optimize<br> outputs = net(inputs)<br> loss = criterion(outputs, labels)<br> loss.backward()<br> optimizer.step()<br> ​<br> # print statistics<br> running_loss += loss.item()<br> if i % 2000 == 1999: # print every 2000 mini-batches<br> print(’[%d, %5d] loss: %.3f’ %<br> (epoch + 1, i + 1, running_loss / 2000))<br> running_loss = 0.0<br> ​<br> print(‘Finished Training’)<br> ​<br> dataiter = iter(testloader)<br> images, labels = dataiter.next()<br> ​</p> 
  <h1><a id="print_images_116"></a>print images</h1> 
  <p>imshow(torchvision.utils.make_grid(images))<br> print('GroundTruth: ‘, ’ ‘.join(’%5s’ % classes[labels[j]] for j in range(4)))<br> ​<br> outputs = net(images)<br> _, predicted = torch.max(outputs, 1)<br> ​<br> print('Predicted: ‘, ’ ‘.join(’%5s’ % classes[predicted[j]]<br> for j in range(4)))<br> ​<br> correct = 0<br> total = 0<br> with torch.no_grad():<br> for data in testloader:<br> images, labels = data<br> outputs = net(images)<br> _, predicted = torch.max(outputs.data, 1)<br> total += labels.size(0)<br> correct += (predicted == labels).sum().item()<br> ​<br> print(‘Accuracy of the network on the 10000 test images: %d %%’ % (<br> 100 * correct / total))<br> ​<br> class_correct = list(0. for i in range(10))<br> class_total = list(0. for i in range(10))<br> with torch.no_grad():<br> for data in testloader:<br> images, labels = data<br> outputs = net(images)<br> _, predicted = torch.max(outputs, 1)<br> c = (predicted == labels).squeeze()<br> for i in range(4):<br> label = labels[i]<br> class_correct[label] += c[i].item()<br> class_total[label] += 1<br> ​<br> ​<br> for i in range(10):<br> print(‘Accuracy of %5s : %2d %%’ % (<br> classes[i], 100 * class_correct[i] / class_total[i]))</p> 
  <p>CPU 上训练<br> [1, 2000] loss: 2.217<br> [1, 4000] loss: 1.889<br> [1, 6000] loss: 1.667<br> [1, 8000] loss: 1.562<br> [1, 10000] loss: 1.517<br> [1, 12000] loss: 1.472<br> [2, 2000] loss: 1.397<br> [2, 4000] loss: 1.373<br> [2, 6000] loss: 1.326<br> [2, 8000] loss: 1.303<br> [2, 10000] loss: 1.294<br> [2, 12000] loss: 1.273<br> Finished Training<br> ​<br> Accuracy of plane : 59 %<br> Accuracy of car : 77 %<br> Accuracy of bird : 43 %<br> Accuracy of cat : 30 %<br> Accuracy of deer : 51 %<br> Accuracy of dog : 52 %<br> Accuracy of frog : 77 %<br> Accuracy of horse : 59 %<br> Accuracy of ship : 63 %<br> Accuracy of truck : 48 %<br> ​<br> GPU 上训练<br> [1, 2000] loss: 2.194<br> [1, 4000] loss: 1.851<br> [1, 6000] loss: 1.691<br> [1, 8000] loss: 1.581<br> [1, 10000] loss: 1.535<br> [1, 12000] loss: 1.492<br> [2, 2000] loss: 1.397<br> [2, 4000] loss: 1.379<br> [2, 6000] loss: 1.347<br> [2, 8000] loss: 1.314<br> [2, 10000] loss: 1.302<br> [2, 12000] loss: 1.278<br> Finished Training<br> ​<br> Accuracy of plane : 69 %<br> Accuracy of car : 65 %<br> Accuracy of bird : 43 %<br> Accuracy of cat : 18 %<br> Accuracy of deer : 50 %<br> Accuracy of dog : 53 %<br> Accuracy of frog : 55 %<br> Accuracy of horse : 66 %<br> Accuracy of ship : 75 %<br> Accuracy of truck : 63 %</p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-258a4616f7.css" rel="stylesheet"> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
