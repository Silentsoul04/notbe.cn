<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>学成在线 第7天 讲义-课程管理实战 « NotBeCN</title>
  <meta name="description" content="                  1我的课程   1.1需求分析   课程添加完成后可通过我的课程进入课程修改页面，此页面显示我的课程列表，如下图所示，可分页查询。  上边的查询要实现分页、会存在多表关联查询，所以建议使用mybatis实现我的课程查询。   1.2API接口   输入参数： 页码、每页显示个数...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2019/05/12/kai46385076_90127093.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">学成在线 第7天 讲义-课程管理实战</h1>
    <p class="post-meta">May 12, 2019</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <h1><a id="1_0"></a>1我的课程</h1> 
  <h2><a id="11_2"></a>1.1需求分析</h2> 
  <p>课程添加完成后可通过我的课程进入课程修改页面，此页面显示我的课程列表，如下图所示，可分页查询。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512001827149.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 上边的查询要实现分页、会存在多表关联查询，所以建议使用mybatis实现我的课程查询。</p> 
  <h2><a id="12API_8"></a>1.2API接口</h2> 
  <p>输入参数：<br> 页码、每页显示个数、查询条件输出结果类型：<br> QueryResponseResult&lt;自定义类型&gt;</p> 
  <p>在api工程创建course包，创建CourseControllerApi接口。</p> 
  <pre><code>//查询课程列表
@ApiOperation("查询我的课程列表")
public QueryResponseResult&lt;CourseInfo&gt; findCourseList(
int page,
int size,
CourseListRequest courseListRequest
);
</code></pre> 
  <h2><a id="13_27"></a>1.3课程管理服务</h2> 
  <p><strong>1.3.1PageHelper</strong><br> PageHelper是mybatis的通用分页插件，通过mybatis的拦截器实现分页功能，拦截sql查询请求，添加分页语句， 最终实现分页查询功能。<br> 我的课程具有分页功能，本项目使用Pagehelper实现Mybatis分页功能开发，由于本项目使用springboot开发，在<br> springboot上集成pagehelper（<a href="https://github.com/pagehelper/pagehelper-spring-boot%EF%BC%89" rel="nofollow">https://github.com/pagehelper/pagehelper-spring-boot）</a><br> PageHelper的使用方法及原理如下：<br> 在调用dao的service方法中设置分页参数：PageHelper.startPage(page, size)，分页参数会设置在ThreadLocal中<br> PageHelper在mybatis执行sql前进行拦截，从ThreadLocal取出分页参数，修改当前执行的sql语句，添加分页 sql。<br> 最后执行添加了分页sql的sql语句，实现分页查询。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512003102934.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 1）添加依赖</p> 
  <pre><code>
&lt;dependency&gt;
&lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt;
&lt;artifactId&gt;pagehelper‐spring‐boot‐starter&lt;/artifactId&gt;
&lt;version&gt;1.2.4&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
  <p>2）配置pageHelper<br> 在application.yml中配置pageHelper操作的数据库类型：</p> 
  <pre><code>
pagehelper:
		 helper‐dialect: mysql
</code></pre> 
  <p><strong>2.3.2 Dao</strong><br> 1）mapper 接口</p> 
  <pre><code>import com.github.pagehelper.Page;
import com.xuecheng.framework.domain.course.CourseBase; import com.xuecheng.framework.domain.course.ext.CourseInfo;
import com.xuecheng.framework.domain.course.request.CourseListRequest; import org.apache.ibatis.annotations.Mapper;

@Mapper
public interface CourseMapper {
CourseBase findCourseBaseById(String id);
Page&lt;CourseInfo&gt; findCourseListPage(CourseListRequest courseListRequest);
}
</code></pre> 
  <p>2）mapper.xml映射文件</p> 
  <pre><code>&lt;select id="findCourseListPage" resultType="com.xuecheng.framework.domain.course.ext.CourseInfo" parameterType="com.xuecheng.framework.domain.course.request.CourseListRequest"&gt;
SELECT
course_base.*,
(SELECT pic FROM course_pic WHERE courseid = course_base.id) pic FROM
course_base
&lt;/select&gt;
</code></pre> 
  <p>3）测试Dao</p> 
  <pre><code>//测试分页@Test
public void testPageHelper(){ PageHelper.startPage(2, 1);
CourseListRequest courseListRequest = new CourseListRequest();
Page&lt;CourseInfo&gt; courseListPage = courseMapper.findCourseListPage(courseListRequest); List&lt;CourseInfo&gt; result = courseListPage.getResult(); System.out.println(courseListPage);
}
</code></pre> 
  <p>测试前修改日志级别为debug，并跟踪运行日志，发现sql语句中已经包括分页语句。</p> 
  <p><strong>1.3.3Service</strong><br> 定义CourseService.java类，用于课程管理的service定义：</p> 
  <pre><code>//课程列表分页查询
public QueryResponseResult&lt;CourseInfo&gt; findCourseList(int page,int size,CourseListRequest courseListRequest) {
if(courseListRequest == null){
courseListRequest = new CourseListRequest();
}
if(page&lt;=0){
page = 0;
}
if(size&lt;=0){
size = 20;
}
//设置分页参数PageHelper.startPage(page, size);
//分页查询
Page&lt;CourseInfo&gt; courseListPage = courseMapper.findCourseListPage(courseListRequest);
//查询列表
List&lt;CourseInfo&gt; list = courseListPage.getResult();
//总记录数
long total = courseListPage.getTotal();
//查询结果集
QueryResult&lt;CourseInfo&gt; courseIncfoQueryResult = new QueryResult&lt;CourseInfo&gt;(); courseIncfoQueryResult.setList(list);
courseIncfoQueryResult.setTotal(total);
return new QueryResponseResult&lt;CourseInfo&gt;(CommonCode.SUCCESS, courseIncfoQueryResult);
}
</code></pre> 
  <p>1.3.4Controller</p> 
  <pre><code>@RestController @RequestMapping("/course")
public class CourseController implements CourseControllerApi {
@Autowired
CourseService courseService; 
@Override
@GetMapping("/coursebase/list/{page}/{size}")
public QueryResponseResult&lt;CourseInfo&gt; findCourseList( @PathVariable("page") int page, @PathVariable("size") int size, CourseListRequest courseListRequest) {
return courseService.findCourseList(page,size,courseListRequest);
}
</code></pre> 
  <p><strong>1.3.5测试</strong><br> 使用postman或swagger-ui测试课程列表接口。</p> 
  <h2><a id="14_136"></a>1.4前端</h2> 
  <p><strong>1.4.1页面</strong><br> 创建course_list.vue<br> 1）使用element 的card组件<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512003314679.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 页面布局代码如下：</p> 
  <pre><code>
&lt;template&gt;
&lt;section&gt;
&lt;el‐row &gt;
&lt;el‐col :span="8" :offset=2 &gt;
&lt;el‐card :body‐style="{ padding: '10px' }"&gt;
&lt;img src="/static/images/add.jpg" class="image" height="150px"&gt;
&lt;div style="padding: 10px;"&gt;
&lt;span&gt;课程名称&lt;/span&gt;
&lt;div class="bottom clearfix"&gt;
&lt;time class="time"&gt;&lt;/time&gt;
&lt;router‐link class="mui‐tab‐item" :to="{path:'/course/add/base'}"&gt;
&lt;el‐button type="text" class="button" &gt;新增课程&lt;/el‐button&gt;
&lt;/router‐link&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/el‐card&gt;
&lt;/el‐col&gt;
&lt;el‐col :span="8" v‐for="(course, index) in courses" :key="course.id" :offset="index &gt; 0 ?
2 : 2"&gt;
&lt;el‐card :body‐style="{ padding: '10px' }"&gt;
&lt;img :src="course.pic!=null?imgUrl+course.pic:'/static/images/nonepic.jpg'" class="image" height="150px"&gt;
&lt;div style="padding: 10px;"&gt;
&lt;span&gt;{{course.name}}&lt;/span&gt;
&lt;div class="bottom clearfix"&gt;
&lt;time class="time"&gt;&lt;/time&gt;
&lt;el‐button type="text" class="button" @click="handleManage(course.id)"&gt;管理课程
&lt;/el‐button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/el‐card&gt;
&lt;/el‐col&gt;

&lt;!‐‐分页‐‐&gt;
&lt;el‐col :span="24" class="toolbar"&gt;
&lt;el‐pagination background layout="prev, pager, next" @current‐ change="handleCurrentChange" :page‐size="size"
:total="total" :current‐page="page" style="float:right;"&gt;
&lt;/el‐pagination&gt;
&lt;/el‐col&gt;
&lt;/el‐row&gt;
&lt;/section&gt;
&lt;/template&gt;

&lt;script&gt;
import * as courseApi from '../api/course'; import utilApi from '../../../common/utils';
let sysConfig = require('@/../config/sysConfig') export default {
data() { return {
page:1, size:7, total: 0, courses: [],
sels: [],//列表选中列
imgUrl:sysConfig.imgUrl
}
},
methods: {
//分页方法handleCurrentChange(val) {
this.page = val;
},
//获取课程列表getCourse() {

},
handleManage: function (id) { console.log(id)
this.$router.push({ path: '/course/manager/'+id})
}

},

created(){
},
mounted() {
}
}
&lt;/script&gt;
&lt;style scoped&gt;
.el‐col‐8{ width:20%
}
.el‐col‐offset‐2{ margin‐left:2%
}
.time {
font‐size: 13px; color: #999;
}

.bottom { margin‐top: 13px; line‐height: 12px;
}

.button { padding: 0; float: right;
}

.image { width: 100%;
display: block;
}

.clearfix:before,
.clearfix:after { display: table; content: "";
}

.clearfix:after { clear: both
}
&lt;/style&gt;

</code></pre> 
  <p>6）路由</p> 
  <pre><code>import course_list from '@/module/course/page/course_list.vue';
 import Home from '@/module/home/page/home.vue';
export default [

{
path: '/course',
component: Home, name: '课程管理', hidden: false,
iconCls: 'el‐icon‐document', children: [
{ path: '/course/list', name: '我的课程',component: course_list,hidden: false }
]
}
]
</code></pre> 
  <p>1.4.2Api调用<br> 1、定义Api方法</p> 
  <pre><code>//我的课程列表
export const findCourseList = (page,size,params) =&gt; {
//对于查询条件，向服务端传入key/value串。
//使用工具类将json对象转成key/value
let queries = querystring.stringify(params)
return http.requestQuickGet(apiUrl+"/course/coursebase/list/"+page+"/"+size+"?"+queries);
}
</code></pre> 
  <p>2、在页面调用ﬁndCourseList方法：</p> 
  <pre><code>//获取课程列表getCourse() {
courseApi.findCourseList(this.page,this.size,{}).then((res) =&gt; { console.log(res);
if(res.success){
this.total = res.queryResult.total; 
this.courses = res.queryResult.list;
}
});
}
</code></pre> 
  <p>在mounted钩子中调用getCourse方法</p> 
  <pre><code>mounted() {
//查询我的课程
this.getCourse();
}
</code></pre> 
  <p>在分页方法中调用getCourse方法</p> 
  <pre><code>//分页方法handleCurrentChange(val) {
this.page = val; this.getCourse();
},
</code></pre> 
  <p><strong>1.4.3测试</strong><br> 页面效果如下：<br> 注意：由于课程图片服务器没有搭建，这里图片暂时无法显示。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512003512906.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h1><a id="2_304"></a>2新增课程</h1> 
  <h2><a id="21_306"></a>2.1需求分析</h2> 
  <p>用户操作流程如下：<br> 1、用户进入“我的课程”页面，点击“新增课程”，进入新增课程页面<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512004346807.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 2、填写课程信息，选择课程分类、课程等级、学习模式等。<br> 3、信息填写完毕，点击“提交”，课程添加成功或课程添加失败并提示失败原因。</p> 
  <p>需要解决的是在新增页面上输入的信息：<br> 1、课程分类<br> 多级分类，需要方便用户去选择。<br> 2、课程等级、学习模式等这些选项建议是可以配置的。</p> 
  <h2><a id="22_319"></a>2.2课程分类查询</h2> 
  <p><strong>2.2.1介绍</strong><br> 在新增课程界面需要选择课程所属分类， 分类信息是整个项目非常重要的信息，课程即商品，分类信息设置的好坏直接影响用户访问量。<br> 分类信息在哪里应用？<br> 1、首页分类导航<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512004419327.png" alt="在这里插入图片描述"><br> 2、课程的归属地<br> 添加课程时要选择课程的所属分类。</p> 
  <p><strong>2.2.2数据结构</strong><br> 分类表category的结构如下：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512004432507.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <strong>2.2.3分类查询</strong><br> <strong>2.2.3.1数据格式</strong><br> 在添加课程时需要选择课程所属的分类，这里需要定义课程分类查询接口。<br> 接口格式要根据前端需要的数据格式来定义，前端展示课程分类使用elemenet-ui的cascader（级联选择器）组 件。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512004612896.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 数据格式例子如下：</p> 
  <pre><code>[{
value: 'zhinan',
label: '指南', children: [{
value: 'shejiyuanze', label: ' 设 计 原 则 ', children: [{
value: 'yizhi', label: '一致'
}, {
value: 'fankui', label: '反馈'
}, {
value: 'xiaolv', label: '效率'
}, {
value: 'kekong', label: '可控'
}]
}]
}]
</code></pre> 
  <p>2.2.3.2数据模型<br> 1）定义category的模型<br> category模型对数据字段对应，如下：</p> 
  <pre><code>@Data @ToString @Entity
@Table(name="category")
@GenericGenerator(name = "jpa‐assigned", strategy = "assigned") 
public class Category implements Serializable {
private static final long serialVersionUID = ‐906357110051689484L; 
@Id
@GeneratedValue(generator = "jpa‐assigned")
 @Column(length = 32)
private String id;
 private String name; 
 private String label; 
 private String parentid; 
 private String isshow; 
 private Integer orderby;
  private String isleaf;

}
</code></pre> 
  <p>1）定义数据返回格式</p> 
  <pre><code>
@Data @ToString
public class CategoryNode extends Category { List&lt;CategoryNode&gt; children;
}
</code></pre> 
  <p>2.2.3.3Api接口</p> 
  <pre><code>package com.xuecheng.api.web.controller.api.course;

import com.xuecheng.framework.domain.course.ext.CategoryNode; import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.ResponseBody;
@Api(value = "课程分类管理",description = "课程分类管理",tags = {"课程分类管理"})
public interface CategoryControllerApi { @ApiOperation("查询分类")
public CategoryNode findList();

}
</code></pre> 
  <p>2.2.3.4dao<br> 根据数据格式的分析，此查询需要返回树型数据格式，为了开发方便我们使用mybatis实现查询 。</p> 
  <p>1）定义mapper</p> 
  <pre><code>@Mapper
public interface CategoryMapper {
//查询分类
public CategoryNode selectList();
}
</code></pre> 
  <p>2）定义mapper映射文件<br> 采用表的自连接方式输出树型结果集。</p> 
  <pre><code>&lt;?xml version="1.0" encoding="UTF‐8" ?&gt;
&lt;!DOCTYPE mapper PUBLIC "‐//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis‐3‐ mapper.dtd" &gt;
&lt;mapper namespace="com.xuecheng.manage_course.dao.CategoryMapper" &gt;

&lt;resultMap type="com.xuecheng.framework.domain.course.ext.CategoryNode" id="categoryMap" &gt;
&lt;id property="id" column="one_id"/&gt;
&lt;result property="name" column="one_name"/&gt;
&lt;result property="label" column="one_label"/&gt;
&lt;result property="isshow" column="one_isshow"/&gt;
&lt;result property="isleaf" column="one_isleaf"/&gt;
&lt;result property="orderby" column="one_orderby"/&gt;
&lt;result property="parentid" column="one_parentid"/&gt;

&lt;collection property="children" ofType="com.xuecheng.framework.domain.course.ext.CategoryNode"&gt;
&lt;id property="id" column="two_id"/&gt;
&lt;result property="name" column="two_name"/&gt;

&lt;result property="label" column="two_label"/&gt;
&lt;result property="isshow" column="two_isshow"/&gt;
&lt;result property="isleaf" column="two_isleaf"/&gt;
&lt;result property="orderby" column="two_orderby"/&gt;
&lt;result property="parentid" column="two_parentid"/&gt;
&lt;collection property="children" ofType="com.xuecheng.framework.domain.course.ext.CategoryNode"&gt;
&lt;id property="id" column="three_id"/&gt;
&lt;result property="name" column="three_name"/&gt;
&lt;result property="label" column="three_label"/&gt;
&lt;result property="isshow" column="three_isshow"/&gt;
&lt;result property="isleaf" column="three_isleaf"/&gt;
&lt;result property="orderby" column="three_orderby"/&gt;
&lt;result property="parentid" column="three_parentid"/&gt;
&lt;/collection&gt;
&lt;/collection&gt;
&lt;/resultMap&gt;

&lt;select id="selectList" resultMap="categoryMap" &gt; SELECT
a.id one_id, a.name one_name, a.label one_label,
a.isshow one_isshow, a.isleaf one_isleaf, a.orderby one_orderby, a.parentid one_parentid, b.id two_id,
b.name two_name, b.label two_label, b.isshow two_isshow, b.isleaf two_isleaf, b.orderby two_orderby,
b.parentid two_parentid, c.id three_id,
c.name three_name, c.label three_label, c.isshow three_isshow, c.isleaf three_isleaf, c.orderby three_orderby, c.parentid three_parentid

FROM
category a LEFT JOIN category b ON a.id = b.parentid
LEFT JOIN category c ON b.id = c.parentid
WHERE a.parentid = '0'

ORDER BY a.orderby, b.orderby, c.orderby
&lt;/select&gt;
&lt;/mapper&gt;
</code></pre> 
  <p>2.2.3.5Service</p> 
  <pre><code>
@Service
public class CategoryService { 
@Autowired
CategoryMapper categoryMapper;
//查询分类
public CategoryNode findList(){
return categoryMapper.selectList();
}
}
</code></pre> 
  <p>2.2.3.6Controller</p> 
  <pre><code>@RestController @RequestMapping("/category")
public class CategoryController implements CategoryControllerApi { @Autowired
CategoryService categoryService;

@Override @GetMapping("/list")
public CategoryNode list() {
return categoryService.findList();
}
}
</code></pre> 
  <p>2.2.3.7接口测试<br> 接口描述如下：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512004856499.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512004903639.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h2><a id="23_497"></a>2.3数据字典</h2> 
  <p><strong>2.3.1介绍</strong><br> 在新增课程界面需要选择课程等级、课程状态等，这些信息统一采用数据字典管理的方式。<br> 本项目对一些业务的分类配置信息，比如：课程等级、课程状态、用户类型、用户状态等进行统一管理，通过在数 据库创建数据字典表来维护这些分类信息。<br> 数据字典对系统的业务分类进行统一管理，并且也可以解决硬编码问题，比如添加课程时选择课程等级，下拉框中 的课程等级信息如果在页面硬编码将造成不易修改维护的问题，所以从数据字典表中获取，如果要修改名称则在数 据字典修改即可，提高系统的可维护性。</p> 
  <p>2.3.2数据模型<br> 在mongodb中创建数据字典表sys_dictionary<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512004938733.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 一个字典信息如下：</p> 
  <pre><code>{
"_id" : ObjectId("5a7e8d2dd019f15418fa2b71"), "d_name" : "课程等级",
"d_type" : "200", "d_value" : [
{
"sd_name" : "低级",
"sd_id" : "200001",

"sd_status" : "1"
},
{
"sd_name" : "中级",
"sd_id" : "200002",
"sd_status" : "1"
},
{
"sd_name" : "高级",
"sd_id" : "200003",
"sd_status" : "1"
}
]
}
</code></pre> 
  <p>字 段 说 明 如 下 ：<br> d_name：字典名称<br> d_type：字典分类<br> d_value：字典数据<br> sd_name：项目名称<br> sd_id：项目id<br> sd_status：项目状态（1：可用，0不可用）<br> 数据模型类：</p> 
  <pre><code>
@Data
 @ToString
@Document(collection = "sys_dictionary") 
public class SysDictionary {

@Id
private String id;

@Field("d_name") private String dName;

@Field("d_type") private String dType;

@Field("d_value")
private List&lt;SysDictionaryValue&gt; dValue;

}
</code></pre> 
  <p>SysDictionaryValue类型：</p> 
  <pre><code>





@Data @ToString
public class SysDictionaryValue {

@Field("sd_id") private String sdId;

@Field("sd_name") private String sdName;

@Field("sd_status") private String sdStatus;

}
</code></pre> 
  <p>2.3.3字典查询接口<br> 2.3.3.1API接口<br> 为了方便其它子系统使用，在cms模块下创建字典查询接口，根据字典的type查询字典信息，接口定义如下：</p> 
  <pre><code>@Api(value = "数据字典接口",description = "提供数据字典接口的管理、查询功能") 
public interface SysDicthinaryControllerApi {
//数据字典
@ApiOperation(value="数据字典查询接口")
public SysDictionary getByType(String type);
}
</code></pre> 
  <p>2.3.3.2Dao<br> 在cms模块下创建数据库的dao、service等类。</p> 
  <pre><code>@Repository
public interface SysDictionaryDao extends MongoRepository&lt;SysDictionary,String&gt; {
//根据字典分类查询字典信息
SysDictionary findBydType(String dType);
}
</code></pre> 
  <p>2.3.3.3Service</p> 
  <pre><code>@Service
public class SysdictionaryService { 
@Autowired
SysDictionaryDao sysDictionaryDao;
//根据字典分类type查询字典信息
public SysDictionary findDictionaryByType(String type){ return sysDictionaryDao.findBydType(type);
}
}
</code></pre> 
  <p>2.3.3.4Controller</p> 
  <pre><code>
@RestControlle
r @RequestMapping("/sys/dictionary")
public class SysDictionaryController implements SysDictionaryControllerApi {

@Autowired
SysdictionaryService sysdictionaryService;
//根据字典分类id查询字典信息@Override @GetMapping("/get/{type}")
public SysDictionary getByType(@PathVariable("type") String type) {
 return sysdictionaryService.findDictionaryByType(type);
}
}
</code></pre> 
  <p><strong>2.3.3.5测试</strong><br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512005219745.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h2><a id="24_635"></a>2.4新增课程页面完善</h2> 
  <p>本节完成数据字典显示及课程分类显示。<br> <strong>2.4.1新增课程页面</strong><br> 1、页面效果如下：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512005240608.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 2）创建course_add.vue页面<br> 在teach前端工程的course模块下创建course_add.vue页面。</p> 
  <pre><code>&lt;template&gt;
&lt;div&gt;
&lt;el‐form :model="courseForm" label‐width="80px" :rules="courseRules" ref="courseForm"&gt;
&lt;el‐form‐item label="课程名称" prop="name"&gt;
&lt;el‐input v‐model="courseForm.name" auto‐complete="off" &gt;&lt;/el‐input&gt;
&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="适用人群" prop="users"&gt;
&lt;el‐input type="textarea" v‐model="courseForm.users" auto‐complete="off" &gt;&lt;/el‐input&gt;
&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="课程分类" prop="categoryActive"&gt;
&lt;el‐cascader expand‐trigger="hover"
:options="categoryList" v‐model="categoryActive"
:props="props"&gt;
&lt;/el‐cascader&gt;
&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="课程等级" prop="grade"&gt;
&lt;b v‐for="grade in gradeList"&gt;
&lt;el‐radio v‐model="courseForm.grade" :label="grade.sdId" &gt;{{grade.sdName}}&lt;/el‐ radio&gt;&amp;nbsp;&amp;nbsp;
&lt;/b&gt;
&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="学习模式" prop="studymodel"&gt;
&lt;b v‐for="studymodel_v in studymodelList"&gt;
&lt;el‐radio v‐model="courseForm.studymodel" :label="studymodel_v.sdId" &gt;
{{studymodel_v.sdName}}&lt;/el‐radio&gt;&amp;nbsp;&amp;nbsp;
&lt;/b&gt;

&lt;/el‐form‐item&gt;

&lt;el‐form‐item label="课程介绍" prop="description"&gt;
&lt;el‐input type="textarea" v‐model="courseForm.description" &gt;&lt;/el‐input&gt;
&lt;/el‐form‐item&gt;

&lt;/el‐form&gt;
&lt;div slot="footer" class="dialog‐footer"&gt;
&lt;el‐button type="primary" @click.native="save" &gt;提交&lt;/el‐button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import * as courseApi from '../api/course'; import utilApi from '../../../common/utils';
import * as systemApi from '../../../base/api/system'; export default {

data() { return {
studymodelList:[], gradeList:[], props: {
value: 'id', label:'label', children:'children'
},
categoryList: [], categoryActive:[], courseForm: {
id:'',
name: '',
users: '',
grade:'', studymodel:'', mt:'',
st:'', description: ''
},
courseRules: { name: [
{required: true, message: '请输入课程名称', trigger: 'blur'}
],
category: [
{required: true, message: '请选择课程分类', trigger: 'blur'}
],
grade: [
{required: true, message: '请选择课程等级', trigger: 'blur'}
],
studymodel: [
{required: true, message: '请选择学习模式', trigger: 'blur'}
]

}
}
},
methods: { save () {
}
},
created(){

},
mounted(){

}
}
&lt;/script&gt;
&lt;style scoped&gt;



&lt;/style&gt;


</code></pre> 
  <p>2）页面路由</p> 
  <pre><code>
import course_add from '@/module/course/page/course_add.vue';
{ path: '/course/add/base', name: '添加课程',
component: course_add,hidden: true },
</code></pre> 
  <p>3）课程添加链接<br> 在我的课程页面添加“新增课程”链接在course_list.vue 中添加：</p> 
  <pre><code>&lt;router‐link class="mui‐tab‐item" :to="{path:'/course/add/base'}"&gt;
&lt;el‐button type="text" class="button" &gt;新增课程&lt;/el‐button&gt;
&lt;/router‐link&gt;
</code></pre> 
  <p><strong>2.4.2查询数据字典</strong><br> 课程添加页面中课程等级、学习模式需要从数据字典查询字典信息。<br> 1）定义方法<br> 数据字典查询 为公用方法，所以定义在/base/api/system.js中</p> 
  <pre><code>
let sysConfig = require('@/../config/sysConfig')
 let apiUrl = sysConfig.xcApiUrlPre;
/*数据字典 */
export const sys_getDictionary= dType =&gt; {
return http.requestQuickGet(apiUrl+'/sys/dictionary/get/'+dType)
}
</code></pre> 
  <p>2）在页面获取数据字典<br> 在mounted钩子中定义方法如下：</p> 
  <pre><code>//查询数据字典字典systemApi.sys_getDictionary('201').then((res) =&gt; {
this.studymodelList = res.dvalue;
});
systemApi.sys_getDictionary('200').then((res) =&gt; { this.gradeList = res.dvalue;
});
</code></pre> 
  <p>3）效果<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512005424941.png" alt="在这里插入图片描述"></p> 
  <p><strong>2.4.3课程分类</strong><br> 课程添加页面中课程分类采用Cascader组件完成。<br> Cascader级联选择器<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512005446597.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 1）页面</p> 
  <pre><code>&lt;el‐form‐item label="课程分类" prop="categoryActive"&gt;
&lt;el‐cascader expand‐trigger="hover"
:options="categoryList" v‐model="categoryActive"
:props="props"&gt;
&lt;/el‐cascader&gt;
&lt;/el‐form‐item&gt;
</code></pre> 
  <p>2）定义方法<br> 在本模块的course.js中定义</p> 
  <pre><code>/*查询课程分类 */
export const category_findlist= () =&gt; {
return http.requestQuickGet(apiUrl+'/category/list')
}
</code></pre> 
  <p>3）在页面获取课程分类<br> 在mounted钩子中定义</p> 
  <pre><code>//取课程分类courseApi.category_findlist({}).then((res) =&gt; {
this.categoryList = res.children;
});
</code></pre> 
  <p>效果<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512005540110.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 5) 如何获取选择的分类<br> 用户选择课程分类后，所选分类ID绑定到categoryActive（数组）中，选择了一级、二级分类，分别存储在<br> categoryActive数组的第一个、第二个元素中。</p> 
  <h2><a id="25API_814"></a>2.5API接口</h2> 
  <p>创建课程添加提交接口：</p> 
  <pre><code>@Api(value = "课程管理",description = "课程管理",tags = {"课程管理"}) public interface CourseControllerApi {

@ApiOperation("添加课程基础信息")
public AddCourseResult addCourseBase(CourseBase courseBase);
}
</code></pre> 
  <h2><a id="26_826"></a>2.6新增课程服务端</h2> 
  <p><strong>2.6.1Dao</strong></p> 
  <pre><code>
public interface CourseBaseRepository extends JpaRepository&lt;CourseBase, String&gt; {

}
</code></pre> 
  <p>2.6.2Service</p> 
  <pre><code>//添加课程提交@Transactional
public AddCourseResult addCourseBase(CourseBase courseBase) {
//课程状态默认为未发布courseBase.setStatus("202001"); courseBaseRepository.save(courseBase);
return new AddCourseResult(CommonCode.SUCCESS,courseBase.getId());
}
</code></pre> 
  <p>2.6.3Controller</p> 
  <pre><code>@Override @PostMapping("/coursebase/add")
public AddCourseResult addCourseBase(@RequestBody CourseBase courseBase) { return courseService.addCourseBase(courseBase);
}
</code></pre> 
  <h2><a id="27_853"></a>2.7新增课程前端</h2> 
  <p><strong>2.7.1Api方法定义</strong><br> 在前端定义请求服务端添加课程的api的方法，在course模块中定义方法如下</p> 
  <pre><code>/*添加课程基础信息*/
export const addCourseBase = params =&gt; {
return http.requestPost(apiUrl+'/course/coursebase/add',params)
}
</code></pre> 
  <p><strong>2.7.2Api方法调用</strong><br> 在course_add.vue 调用api提交课程信息</p> 
  <pre><code>
methods: {
save () {
this.$refs.courseForm.validate((valid) =&gt; { if (valid) {
this.$confirm('确认提交吗？', '提示', {}).then(() =&gt; {
//当前选择的分类
let mt = this.categoryActive[0]; let st = this.categoryActive[1]; this.courseForm.mt = mt; this.courseForm.st = st;
//请求服务接口
courseApi.addCourseBase(this.courseForm).then((res) =&gt; { if(res.success){
this.$message.success('提交成功');
//跳转到课程图片
//this.$router.push({ path: '/course/add/picture/1/'+this.courseid})
}else{
if(res.message){ this.$message.error(res.message);
}else{
this.$message.error('提交失败');
}
}
});

});
}
});
}
},
</code></pre> 
  <p><strong>2.7.3测试</strong><br> 注意：将course_base表中的company_id改为非必填，待认证功能开发完成再修改为必填 测试流程：<br> 1、进入我的课程，点击“新增课程”打开新增课程页面<br> 2、输入课程信息，点击提交</p> 
  <h1><a id="3_900"></a>3课程信息修改</h1> 
  <h2><a id="31_902"></a>3.1需求分析</h2> 
  <p>课程添加成功进入课程管理页面，通过课程管理页面修改课程的基本信息、编辑课程图片、编辑课程营销信息等。 本小节实现修改课程。</p> 
  <h2><a id="32_906"></a>3.2课程管理页面说明</h2> 
  <p><strong>3.2.1页面结构</strong><br> 课程管理页面的结构如下：<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512005803216.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <strong>3.2.2课程管理导航页面</strong><br> 1、定义course_manage.vue为课程管理导航页面。导航效果使用Element-UI的NavMenu组件实现。</p> 
  <pre><code>&lt;template&gt;
&lt;div&gt;

&lt;el‐menu
:default‐active="activeIndex" class="el‐menu‐demo" mode="horizontal" background‐color="#eee" text‐color="#000" active‐text‐color="#000"&gt;
&lt;router‐link class="mui‐tab‐item" :to="{path:'/course/manage/summary/'+this.courseid}"&gt;
&lt;el‐menu‐item index="1"&gt;课程首页&lt;/el‐menu‐item&gt;
&lt;/router‐link&gt;
&lt;router‐link class="mui‐tab‐item" :to="{path:'/course/manage/baseinfo/'+this.courseid}"&gt;
&lt;el‐menu‐item index="2"&gt;基本信息&lt;/el‐menu‐item&gt;
&lt;/router‐link&gt;
&lt;router‐link class="mui‐tab‐item" :to="{path:'/course/manage/picture/'+this.courseid}"&gt;
&lt;el‐menu‐item index="3"&gt;课程图片&lt;/el‐menu‐item&gt;
&lt;/router‐link&gt;
&lt;router‐link class="mui‐tab‐item" :to="{path:'/course/manage/marketinfo/'+this.courseid}"&gt;
&lt;el‐menu‐item index="4"&gt;课程营销&lt;/el‐menu‐item&gt;
&lt;/router‐link&gt;
&lt;router‐link class="mui‐tab‐item" :to="{path:'/course/manage/plan/'+this.courseid}"&gt;
&lt;el‐menu‐item index="5"&gt;课程计划&lt;/el‐menu‐item&gt;
&lt;/router‐link&gt;
&lt;router‐link class="mui‐tab‐item" :to="{path:'/course/manage/teacher/'+this.courseid}"&gt;
&lt;el‐menu‐item index="6"&gt;教师信息&lt;/el‐menu‐item&gt;
&lt;/router‐link&gt;
&lt;router‐link class="mui‐tab‐item" :to="{path:'/course/manage/pub/'+this.courseid}"&gt;
&lt;el‐menu‐item index="7"&gt;发布课程&lt;/el‐menu‐item&gt;
&lt;/router‐link&gt;
&lt;/el‐menu&gt;
&lt;router‐view class="main"&gt;&lt;/router‐view&gt;
&lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import * as courseApi from '../api/course'; import utilApi from '../../../common/utils'; export default {
data() { return {
activeIndex:'2', courseid:''
}
},
methods: {

},
mounted(){
//课程id
this.courseid = this.$route.params.courseid console.log("courseid=" + this.courseid)
//跳转到页面列表
this.$router.push({ path: '/course/manage/baseinfo/'+this.courseid})

}
}
&lt;/script&gt;
&lt;style scoped&gt;

&lt;/style&gt;

</code></pre> 
  <p>2、创建各各信息管理页面</p> 
  <p>通过管理页面的导航可以进入各各信息管理页面，这里先创建各各信息管理页面，页面内容暂时为空，待开发时再 完善，在本模块的page目录下创建course_manage目录，此目录存放各各信息管理页面，页面明细如下：<br> 课程管理首页：course_summary.vue<br> 基本信息修改页面：course_baseinfo.vue<br> 图片管理页面：course_picture.vue 营销信息页面：course_marketinfo.vue 老师信息页面：course_teacher.vue<br> 课程计划页面：course_plan.vue 课程发布页面：course_pub.vue<br> 3、创建路由</p> 
  <pre><code>import course_manage from '@/module/course/page/course_manage.vue';
import course_summary from '@/module/course/page/course_manage/course_summary.vue'; import course_picture from '@/module/course/page/course_manage/course_picture.vue'; import course_baseinfo from '@/module/course/page/course_manage/course_baseinfo.vue'; import course_marketinfo from '@/module/course/page/course_manage/course_marketinfo.vue'; import course_teacher from '@/module/course/page/course_manage/course_teacher.vue'; import course_plan from '@/module/course/page/course_manage/course_plan.vue';
import course_pub from '@/module/course/page/course_manage/course_pub.vue';

{ path: '/course/manager/:courseid', name: '管理课程',component: course_manage,hidden: true , children: [
{ path: '/course/manage/plan/:courseid', name: '课程计划',component: course_plan,hidden:

false },


{ path: '/course/manage/baseinfo/:courseid', name: '基本信息',component:

course_baseinfo,hidden: false },
{ path: '/course/manage/picture/:courseid', name: '课程图片',component: course_picture,hidden: false },
{ path: '/course/manage/marketinfo/:courseid', name: '营销信息',component:
course_marketinfo,hidden: false },
{ path: '/course/manage/teacher/:courseid', name: '教师信息',component: course_teacher,hidden: false},
{ path: '/course/manage/pub/:courseid', name: '发布课程',component: course_pub,hidden:

false},


{ path: '/course/manage/summary/:courseid', name: '课程首页',component:

course_summary,hidden: false }
]}
</code></pre> 
  <h2><a id="33Api_1006"></a>3.3Api接口</h2> 
  <p>修改课程需要如下接口：<br> 1、根据id查询课程信息<br> 2、修改课程提交接口定义如下：</p> 
  <ol> 
   <li>根据课程ID查询课程信息</li> 
  </ol> 
  <pre><code>@ApiOperation("获取课程基础信息")
public CourseBase getCourseBaseById(String courseId) throws RuntimeException;
</code></pre> 
  <p>2）修改课程信息</p> 
  <pre><code>@ApiOperation("更新课程基础信息")
public ResponseResult updateCourseBase(String id,CourseBase courseBase);
</code></pre> 
  <p>3.4服务端</p> 
  <p>3.4.1Dao<br> 略<br> 3.4.2Service</p> 
  <pre><code>
public CourseBase getCoursebaseById(String courseid) {
Optional&lt;CourseBase&gt; optional = courseBaseRepository.findById(courseId); if(optional.isPresent()){
return optional.get();
}
return null;
}

@Transactional
public ResponseResult updateCoursebase(String id, CourseBase courseBase) { CourseBase one = this.getCoursebaseById(id);
if(one == null){
//抛出异常..
}
//修改课程信息one.setName(courseBase.getName()); one.setMt(courseBase.getMt()); one.setSt(courseBase.getSt()); one.setGrade(courseBase.getGrade()); one.setStudymodel(courseBase.getStudymodel()); one.setUsers(courseBase.getUsers());
one.setDescription(courseBase.getDescription()); CourseBase save = courseBaseRepository.save(one); return new ResponseResult(CommonCode.SUCCESS);
}
</code></pre> 
  <p>3.4.3Controller</p> 
  <pre><code>@Override @GetMapping("/coursebase/get/{courseId}")
public CourseBase getCourseBaseById(@PathVariable("courseId") String courseId) throws RuntimeException {
return courseService.getCoursebaseById(courseId);
}

@Override @PutMapping("/coursebase/update/{id}")
public ResponseResult updateCourseBase(@PathVariable("id") String id, @RequestBody CourseBase courseBase) {
return courseService.updateCoursebase(id,courseBase);
}
</code></pre> 
  <h2><a id="35_1061"></a>3.5前端</h2> 
  <p><strong>3.5.1修改页面</strong><br> 在course模块下的course_manage目录下创建course_baseinfo.vue页面，本页面实现课程修改</p> 
  <pre><code>
&lt;template&gt;
&lt;div&gt;
&lt;el‐form :model="courseForm" label‐width="80px" :rules="courseRules" ref="courseForm"&gt;
&lt;el‐form‐item label="课程名称" prop="name"&gt;
&lt;el‐input v‐model="courseForm.name" auto‐complete="off" &gt;&lt;/el‐input&gt;
&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="适用人群" prop="users"&gt;
&lt;el‐input type="textarea" v‐model="courseForm.users" auto‐complete="off" &gt;&lt;/el‐input&gt;
&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="课程分类" prop="categoryActive"&gt;
&lt;el‐cascader expand‐trigger="hover"
:options="categoryList" v‐model="categoryActive"
:props="props"&gt;
&lt;/el‐cascader&gt;
&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="课程等级" prop="grade"&gt;
&lt;b v‐for="grade in gradeList"&gt;
&lt;el‐radio v‐model="courseForm.grade" :label="grade.sdId" &gt;{{grade.sdName}}&lt;/el‐ radio&gt;&amp;nbsp;&amp;nbsp;
&lt;/b&gt;
&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="学习模式" prop="studymodel"&gt;
&lt;b v‐for="studymodel_v in studymodelList"&gt;
&lt;el‐radio v‐model="courseForm.studymodel" :label="studymodel_v.sdId" &gt;
{{studymodel_v.sdName}}&lt;/el‐radio&gt;&amp;nbsp;&amp;nbsp;
&lt;/b&gt;

&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="课程介绍" prop="description"&gt;
&lt;el‐input type="textarea" v‐model="courseForm.description" &gt;&lt;/el‐input&gt;
&lt;/el‐form‐item&gt;

&lt;/el‐form&gt;
&lt;div slot="footer" class="dialog‐footer"&gt;
&lt;el‐button type="primary" @click.native="save" :loading="editLoading"&gt;提交&lt;/el‐button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
import * as courseApi from '../../api/course'; import utilApi from '../../../../common/utils';
import * as systemApi from '../../../../base/api/system'; export default {

data() { return {
courseid:'', studymodelList:[], gradeList:[], editLoading: false, props: {
value: 'id', label:'label', children:'children'
},
categoryList: [], categoryActive:[], courseForm: {
id:'',
name: '',
users: '',
grade:'', studymodel:'', mt:'',
st:'', description: ''
},
courseRules: { name: [
{required: true, message: '请输入课程名称', trigger: 'blur'}
],
category: [
{required: true, message: '请选择课程分类', trigger: 'blur'}
],
grade: [
{required: true, message: '请选择课程等级', trigger: 'blur'}
],
studymodel: [
{required: true, message: '请选择学习模式', trigger: 'blur'}
]
}
}
},
methods: { save () {

}
},
created(){

},
mounted(){

}
}
&lt;/script&gt;
&lt;style scoped&gt;
&lt;/style&gt;
</code></pre> 
  <p><strong>3.5.2API方法</strong></p> 
  <pre><code>//获取课程基本信息
export const getCoursebaseById = id =&gt; {
return http.requestQuickGet(apiUrl+'/course/coursebase/get/'+id)
}
//更新课程基本信息
export const updateCoursebase= (id,course) =&gt; {
return http.requestPut(apiUrl+'/course/coursebase/update/'+id,course)
}
</code></pre> 
  <p><strong>3.5.4课程信息显示</strong><br> 在mounted钩子方法中查询课程信息及数据字典：</p> 
  <pre><code>
mounted(){
//查询数据字典字典systemApi.sys_getDictionary('201').then((res) =&gt; {
//		console.log(res); this.studymodelList = res.dvalue;
});
systemApi.sys_getDictionary('200').then((res) =&gt; { this.gradeList = res.dvalue;
});
//取课程分类courseApi.category_findlist({}).then((res) =&gt; {
this.categoryList = res.children;
});
//查询课程信息
//课程id
this.courseid = this.$route.params.courseid; courseApi.getCoursebaseById(this.courseid).then((res) =&gt; {
//		console.log(res); this.courseForm = res;
//课程分类显示，需要两级分类
this.categoryActive.push(this.courseForm.mt); this.categoryActive.push(this.courseForm.st);

});
}
</code></pre> 
  <p><strong>3.5.5课程修改提交</strong><br> 编辑课程提交方法：</p> 
  <pre><code>methods: {
save () {
//修改课程this.$refs.courseForm.validate((valid) =&gt; {
if (valid) {
this.$confirm('确认提交吗？', '提示', {}).then(() =&gt; { let mt = this.categoryActive[0];
let st = this.categoryActive[1]; this.courseForm.mt = mt; this.courseForm.st = st;
let id = this.courseForm.id courseApi.updateCoursebase(id,this.courseForm).then((res) =&gt; {
if(res.success){ this.$message({
message: '提交成功',
type: 'success'
});
}else{
if(res.message){ this.$message.error(res.message);
}else{
this.$message.error('提交失败');
}
}
});
});
}
});
}
},
</code></pre> 
  <h1><a id="4_1215"></a>4课程营销</h1> 
  <h2><a id="41_1217"></a>4.1需求分析</h2> 
  <p>课程营销信息包括课程价格、课程有效期等信息。<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512010127453.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2thaTQ2Mzg1MDc2,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <h2><a id="42_1222"></a>4.2数据模型</h2> 
  <p>课程营销信息使用course_market表存储。数据模型如下：</p> 
  <pre><code>
@Data @ToString @Entity
@Table(name="course_market")
@GenericGenerator(name = "jpa‐assigned", strategy = "assigned") 
public class CourseMarket implements Serializable {
private static final long serialVersionUID = ‐916357110051689486L; 
@Id
@GeneratedValue(generator = "jpa‐assigned") @Column(length = 32)
private String id;
private String charge;
 private String valid; 
 private String qq; 
 private Float price; 
 private Float price_old;
@Column(name = "start_time") 
private Date startTime; 
@Column(name = "end_time")
private Date endTime;
}
</code></pre> 
  <h2><a id="43API_1248"></a>4.3API</h2> 
  <ol> 
   <li>查询课程营销信息</li> 
  </ol> 
  <pre><code>@ApiOperation("获取课程营销信息")
public CourseMarket getCourseMarketById(String courseId);
</code></pre> 
  <p>2）更新课程营销信息</p> 
  <pre><code>@ApiOperation("更新课程营销信息")
public ResponseResult updateCourseMarket(String id,CourseMarket courseMarket);
</code></pre> 
  <h2><a id="44_1263"></a>4.4课程管理服务</h2> 
  <p><strong>4.4.1Dao</strong></p> 
  <pre><code>
public interface CourseMarketRepository extends JpaRepository&lt;CourseMarket, String&gt; {
}
</code></pre> 
  <p>4.4.2Service</p> 
  <pre><code>public CourseMarket getCourseMarketById(String courseid) { Optional&lt;CourseMarket&gt; optional = courseMarketRepository.findById(courseId); if(!optional.isPresent()){
return optional.get();
}
return null;
}
</code></pre> 
  <pre><code>@Transactional
public CourseMarket updateCourseMarket(String id, CourseMarket courseMarket) { CourseMarket one = this.getCourseMarketById(id);
if(one!=null){ one.setCharge(courseMarket.getCharge());
one.setStartTime(courseMarket.getStartTime());//课程有效期，开始时间
one.setEndTime(courseMarket.getEndTime());//课程有效期，结束时间
one.setPrice(courseMarket.getPrice()); one.setQq(courseMarket.getQq()); one.setValid(courseMarket.getValid()); courseMarketRepository.save(one);
}else{
//添加课程营销信息
one = new CourseMarket(); BeanUtils.copyProperties(courseMarket, one);
//设置课程id
one.setId(id); courseMarketRepository.save(one);
}
return one;
}
</code></pre> 
  <p>4.4.3Controller</p> 
  <pre><code>
@Override 
@PostMapping("/coursemarket/update/{id}")
public ResponseResult updateCourseMarket(@PathVariable("id") String id, @RequestBody CourseMarket courseMarket) {
CourseMarket courseMarket_u = courseService.updateCourseMarket(id, courseMarket); if(courseMarket_u!=null){
return new ResponseResult(CommonCode.SUCCESS);
}else{
return new ResponseResult(CommonCode.FAIL);
}
}

@Override
</code></pre> 
  <h2><a id="45_1315"></a>4.5前端</h2> 
  <p><strong>4.5.1Api 方法</strong></p> 
  <pre><code>//获取课程营销信息
export const getCourseMarketById = id =&gt; {
return http.requestQuickGet(apiUrl+'/course/coursemarket/get/'+id)
}
// 更新课程营销信息
export const updateCourseMarket =(id,courseMarket) =&gt; {
return http.requestPost(apiUrl+'/course/coursemarket/update/'+id,courseMarket)
}
</code></pre> 
  <p><strong>4.5.2页面</strong><br> 编写 course_marketinfo.vue<br> 1)template</p> 
  <pre><code>&lt;el‐form :model="courseMarketForm" label‐width="110px" :rules="courseMarketFormRules" ref="courseMarketForm"&gt;
&lt;el‐form‐item label="课程价格" prop="charge"&gt;
&lt;b v‐for="charge in chargeList"&gt;
&lt;el‐radio v‐model="courseMarketForm.charge" :label="charge.sdId" &gt;{{charge.sdName}}&lt;/el‐
radio&gt;
&amp;nbsp;&amp;nbsp;
&lt;/b&gt;
&lt;br/&gt;
金额（元）：&lt;el‐input :disabled="this.courseMarketForm.charge == '203002'?false:true" v‐ model="courseMarketForm.price" &gt;&lt;/el‐input&gt;
&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="课程有效期" prop="expires"&gt;
&lt;b v‐for="valid in validList"&gt;
&lt;el‐radio v‐model="courseMarketForm.valid" :label="valid.sdId" &gt;{{valid.sdName}}&lt;/el‐ radio&gt;&amp;nbsp;&amp;nbsp;
&lt;/b&gt;
&lt;br/&gt;
过期时间：&lt;br/&gt;
&lt;el‐date‐picker :disabled="this.courseMarketForm.valid == '204002'?false:true" type="date" placeholder="选择日期" v‐model="courseMarketForm.expires"&gt;&lt;/el‐date‐picker&gt;
&lt;/el‐form‐item&gt;
&lt;el‐form‐item label="服务咨询QQ" prop="qq"&gt;
&lt;el‐input v‐model="courseMarketForm.qq" &gt;&lt;/el‐input&gt;
&lt;/el‐form‐item&gt;

&lt;/el‐form&gt;
&lt;div slot="footer" class="dialog‐footer"&gt;
&lt;el‐button type="primary" @click.native="save" &gt;提交&lt;/el‐button&gt;
&lt;/div&gt;

</code></pre> 
  <p>2)数据对象</p> 
  <pre><code>data() { return {
active: 1, dotype:'',
courseid:'', chargeList:[], validList:[], price_tag:false, expires_tag:false, courseMarketForm: {
id:'',
charge:'',
valid:'',
price:'',
expires: '',
users: '', expiration:[], courseid:this.courseid
},
courseMarketFormRules: { free: [
{required: true, message: '请选择收费规则', trigger: 'blur'}
],
valid: [
{required: true, message: '请选择有效期', trigger: 'blur'}
]
}
}
}
</code></pre> 
  <p>3）保存方法</p> 
  <pre><code>save: function () { this.$refs.courseMarketForm.validate((valid) =&gt; {
if (valid) {
this.$confirm(' 确 认 提 交 吗 ？', ' 提 示 ', {}).then(() =&gt; { courseApi.updateCourseMarket(this.courseid,this.courseMarketForm).then((res) =&gt; {
if(res.success){
this.$message.success('提交失败');
}else{
this.$message.error(res.message);
}
});
});
}
});
}
</code></pre> 
  <p>4）在mounted钩子方法 中查询课程营销信息及数据字典信息</p> 
  <pre><code>
mounted(){
//课程id
this.courseid = this.$route.params.courseid;

this.courseMarketForm.id = this.courseid;
//查询字典systemApi.sys_getDictionary('203').then((res) =&gt; {
this.chargeList = res.dvalue;
});
systemApi.sys_getDictionary('204').then((res) =&gt; { this.validList = res.dvalue;
});

//获取课程营销信息courseApi.getCourseMarketById(this.courseid).then((res) =&gt; {
//console.log(res); if(res &amp;&amp; res.id){
this.courseMarketForm = res;
}
});
}
</code></pre> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-258a4616f7.css" rel="stylesheet"> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
