<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Makefile Â« NotBeCN</title>
  <meta name="description" content="                  æ¦‚è¿°   ä»€ä¹ˆæ˜¯makefileï¼Ÿæˆ–è®¸å¾ˆå¤šWinodwsçš„ç¨‹åºå‘˜éƒ½ä¸çŸ¥é“è¿™ä¸ªä¸œè¥¿ï¼Œå› ä¸ºé‚£äº›Windowsçš„IDEéƒ½ä¸ºä½ åšäº†è¿™ä¸ªå·¥ä½œï¼Œä½†æˆ‘è§‰å¾—è¦ä½œä¸€ä¸ªå¥½çš„å’Œprofessionalçš„ç¨‹åºå‘˜ï¼Œmakefileè¿˜æ˜¯è¦æ‡‚ã€‚è¿™å°±å¥½åƒç°åœ¨æœ‰è¿™ä¹ˆå¤šçš„HTMLçš„ç¼–è¾‘å™¨ï¼Œä½†å¦‚æœä½ æƒ³æˆä¸ºä¸€ä¸ªä¸“ä¸šäºº...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2019/05/12/code527_90138011.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">å…³äº</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">ç¤¾åŒº</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">å°„ä¸ªé¸­å­</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Makefile</h1>
    <p class="post-meta">May 12, 2019</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart ç®­å¤´å›¾æ ‡ å‹¿åˆ  --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <h2><a id="_0"></a>æ¦‚è¿°</h2> 
  <p>ä»€ä¹ˆæ˜¯makefileï¼Ÿæˆ–è®¸å¾ˆå¤šWinodwsçš„ç¨‹åºå‘˜éƒ½ä¸çŸ¥é“è¿™ä¸ªä¸œè¥¿ï¼Œå› ä¸ºé‚£äº›Windowsçš„IDEéƒ½ä¸ºä½ åšäº†è¿™ä¸ªå·¥ä½œï¼Œä½†æˆ‘è§‰å¾—è¦ä½œä¸€ä¸ªå¥½çš„å’Œprofessionalçš„ç¨‹åºå‘˜ï¼Œmakefileè¿˜æ˜¯è¦æ‡‚ã€‚è¿™å°±å¥½åƒç°åœ¨æœ‰è¿™ä¹ˆå¤šçš„HTMLçš„ç¼–è¾‘å™¨ï¼Œä½†å¦‚æœä½ æƒ³æˆä¸ºä¸€ä¸ªä¸“ä¸šäººå£«ï¼Œä½ è¿˜æ˜¯è¦äº†è§£HTMLçš„æ ‡è¯†çš„å«ä¹‰ã€‚ç‰¹åˆ«åœ¨Unixä¸‹çš„è½¯ä»¶ç¼–è¯‘ï¼Œä½ å°±ä¸èƒ½ä¸è‡ªå·±å†™makefileäº†ï¼Œä¼šä¸ä¼šå†™makefileï¼Œä»ä¸€ä¸ªä¾§é¢è¯´æ˜äº†ä¸€ä¸ªäººæ˜¯å¦å…·å¤‡å®Œæˆå¤§å‹å·¥ç¨‹çš„èƒ½åŠ›ã€‚</p> 
  <p>å› ä¸ºï¼Œmakefileå…³ç³»åˆ°äº†æ•´ä¸ªå·¥ç¨‹çš„ç¼–è¯‘è§„åˆ™ã€‚ä¸€ä¸ªå·¥ç¨‹ä¸­çš„æºæ–‡ä»¶ä¸è®¡æ•°ï¼Œå…¶æŒ‰ç±»å‹ã€åŠŸèƒ½ã€æ¨¡å—åˆ†åˆ«æ”¾åœ¨è‹¥å¹²ä¸ªç›®å½•ä¸­ï¼Œmakefileå®šä¹‰äº†ä¸€ç³»åˆ—çš„è§„åˆ™æ¥æŒ‡å®šï¼Œå“ªäº›æ–‡ä»¶éœ€è¦å…ˆç¼–è¯‘ï¼Œå“ªäº›æ–‡ä»¶éœ€è¦åç¼–è¯‘ï¼Œå“ªäº›æ–‡ä»¶éœ€è¦é‡æ–°ç¼–è¯‘ï¼Œç”šè‡³äºè¿›è¡Œæ›´å¤æ‚çš„åŠŸèƒ½æ“ä½œï¼Œå› ä¸ºmakefileå°±åƒä¸€ä¸ªShellè„šæœ¬ä¸€æ ·ï¼Œå…¶ä¸­ä¹Ÿå¯ä»¥æ‰§è¡Œæ“ä½œç³»ç»Ÿçš„å‘½ä»¤ã€‚</p> 
  <p>makefileå¸¦æ¥çš„å¥½å¤„å°±æ˜¯â€”â€”â€œè‡ªåŠ¨åŒ–ç¼–è¯‘â€ï¼Œä¸€æ—¦å†™å¥½ï¼Œåªéœ€è¦ä¸€ä¸ªmakeå‘½ä»¤ï¼Œæ•´ä¸ªå·¥ç¨‹å®Œå…¨è‡ªåŠ¨ç¼–è¯‘ï¼Œæå¤§çš„æé«˜äº†è½¯ä»¶å¼€å‘çš„æ•ˆç‡ã€‚makeæ˜¯ä¸€ä¸ªå‘½ä»¤å·¥å…·ï¼Œæ˜¯ä¸€ä¸ªè§£é‡Šmakefileä¸­æŒ‡ä»¤çš„å‘½ä»¤å·¥å…·ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¤§å¤šæ•°çš„IDEéƒ½æœ‰è¿™ä¸ªå‘½ä»¤ï¼Œæ¯”å¦‚ï¼šDelphiçš„makeï¼ŒVisual C++çš„nmakeï¼ŒLinuxä¸‹GNUçš„makeã€‚å¯è§ï¼Œmakefileéƒ½æˆä¸ºäº†ä¸€ç§åœ¨å·¥ç¨‹æ–¹é¢çš„ç¼–è¯‘æ–¹æ³•ã€‚</p> 
  <p>ç°åœ¨è®²è¿°å¦‚ä½•å†™makefileçš„æ–‡ç« æ¯”è¾ƒå°‘ï¼Œè¿™æ˜¯æˆ‘æƒ³å†™è¿™ç¯‡æ–‡ç« çš„åŸå› ã€‚å½“ç„¶ï¼Œä¸åŒäº§å•†çš„makeå„ä¸ç›¸åŒï¼Œä¹Ÿæœ‰ä¸åŒçš„è¯­æ³•ï¼Œä½†å…¶æœ¬è´¨éƒ½æ˜¯åœ¨â€œæ–‡ä»¶ä¾èµ–æ€§â€ä¸Šåšæ–‡ç« ï¼Œè¿™é‡Œï¼Œæˆ‘ä»…å¯¹GNUçš„makeè¿›è¡Œè®²è¿°ï¼Œæˆ‘çš„ç¯å¢ƒæ˜¯RedHat Linux 8.0ï¼Œmakeçš„ç‰ˆæœ¬æ˜¯3.80ã€‚å¿…ç«Ÿï¼Œè¿™ä¸ªmakeæ˜¯åº”ç”¨æœ€ä¸ºå¹¿æ³›çš„ï¼Œä¹Ÿæ˜¯ç”¨å¾—æœ€å¤šçš„ã€‚è€Œä¸”å…¶è¿˜æ˜¯æœ€éµå¾ªäºIEEE 1003.2-1992 æ ‡å‡†çš„ï¼ˆPOSIX.2ï¼‰ã€‚</p> 
  <p>åœ¨è¿™ç¯‡æ–‡æ¡£ä¸­ï¼Œå°†ä»¥C/C++çš„æºç ä½œä¸ºæˆ‘ä»¬åŸºç¡€ï¼Œæ‰€ä»¥å¿…ç„¶æ¶‰åŠä¸€äº›å…³äºC/C++çš„ç¼–è¯‘çš„çŸ¥è¯†ï¼Œç›¸å…³äºè¿™æ–¹é¢çš„å†…å®¹ï¼Œè¿˜è¯·å„ä½æŸ¥çœ‹ç›¸å…³çš„ç¼–è¯‘å™¨çš„æ–‡æ¡£ã€‚è¿™é‡Œæ‰€é»˜è®¤çš„ç¼–è¯‘å™¨æ˜¯UNIXä¸‹çš„GCCå’ŒCCã€‚</p> 
  <h2><a id="_14"></a>ç¼–è¯‘å’Œé“¾æ¥</h2> 
  <p>åœ¨æ­¤ï¼Œæˆ‘æƒ³å¤šè¯´å…³äºç¨‹åºç¼–è¯‘çš„ä¸€äº›è§„èŒƒå’Œæ–¹æ³•ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ— è®ºæ˜¯Cã€C++ã€è¿˜æ˜¯pasï¼Œé¦–å…ˆè¦æŠŠæºæ–‡ä»¶ç¼–è¯‘æˆä¸­é—´ä»£ç æ–‡ä»¶ï¼Œåœ¨Windowsä¸‹ä¹Ÿå°±æ˜¯ .obj æ–‡ä»¶ï¼ŒUNIXä¸‹æ˜¯ .o æ–‡ä»¶ï¼Œå³ Object Fileï¼Œè¿™ä¸ªåŠ¨ä½œå«åšç¼–è¯‘ï¼ˆcompileï¼‰ã€‚ç„¶åå†æŠŠå¤§é‡çš„Object Fileåˆæˆæ‰§è¡Œæ–‡ä»¶ï¼Œè¿™ä¸ªåŠ¨ä½œå«ä½œé“¾æ¥ï¼ˆlinkï¼‰ã€‚</p> 
  <p>ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨éœ€è¦çš„æ˜¯è¯­æ³•çš„æ­£ç¡®ï¼Œå‡½æ•°ä¸å˜é‡çš„å£°æ˜çš„æ­£ç¡®ã€‚å¯¹äºåè€…ï¼Œé€šå¸¸æ˜¯ä½ éœ€è¦å‘Šè¯‰ç¼–è¯‘å™¨å¤´æ–‡ä»¶çš„æ‰€åœ¨ä½ç½®ï¼ˆå¤´æ–‡ä»¶ä¸­åº”è¯¥åªæ˜¯å£°æ˜ï¼Œè€Œå®šä¹‰åº”è¯¥æ”¾åœ¨C/C++æ–‡ä»¶ä¸­ï¼‰ï¼Œåªè¦æ‰€æœ‰çš„è¯­æ³•æ­£ç¡®ï¼Œç¼–è¯‘å™¨å°±å¯ä»¥ç¼–è¯‘å‡ºä¸­é—´ç›®æ ‡æ–‡ä»¶ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ¯ä¸ªæºæ–‡ä»¶éƒ½åº”è¯¥å¯¹åº”äºä¸€ä¸ªä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆOæ–‡ä»¶æˆ–æ˜¯OBJæ–‡ä»¶ï¼‰ã€‚</p> 
  <p>é“¾æ¥æ—¶ï¼Œä¸»è¦æ˜¯é“¾æ¥å‡½æ•°å’Œå…¨å±€å˜é‡ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›ä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆOæ–‡ä»¶æˆ–æ˜¯OBJæ–‡ä»¶ï¼‰æ¥é“¾æ¥æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚é“¾æ¥å™¨å¹¶ä¸ç®¡å‡½æ•°æ‰€åœ¨çš„æºæ–‡ä»¶ï¼Œåªç®¡å‡½æ•°çš„ä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼ˆObject Fileï¼‰ï¼Œåœ¨å¤§å¤šæ•°æ—¶å€™ï¼Œç”±äºæºæ–‡ä»¶å¤ªå¤šï¼Œç¼–è¯‘ç”Ÿæˆçš„ä¸­é—´ç›®æ ‡æ–‡ä»¶å¤ªå¤šï¼Œè€Œåœ¨é“¾æ¥æ—¶éœ€è¦æ˜æ˜¾åœ°æŒ‡å‡ºä¸­é—´ç›®æ ‡æ–‡ä»¶åï¼Œè¿™å¯¹äºç¼–è¯‘å¾ˆä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ç»™ä¸­é—´ç›®æ ‡æ–‡ä»¶æ‰“ä¸ªåŒ…ï¼Œåœ¨Windowsä¸‹è¿™ç§åŒ…å«â€œåº“æ–‡ä»¶â€ï¼ˆLibrary File)ï¼Œä¹Ÿå°±æ˜¯ .lib æ–‡ä»¶ï¼Œåœ¨UNIXä¸‹ï¼Œæ˜¯Archive Fileï¼Œä¹Ÿå°±æ˜¯ .a æ–‡ä»¶ã€‚</p> 
  <p>æ€»ç»“ä¸€ä¸‹ï¼Œæºæ–‡ä»¶é¦–å…ˆä¼šç”Ÿæˆä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼Œå†ç”±ä¸­é—´ç›®æ ‡æ–‡ä»¶ç”Ÿæˆæ‰§è¡Œæ–‡ä»¶ã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨åªæ£€æµ‹ç¨‹åºè¯­æ³•ï¼Œå’Œå‡½æ•°ã€å˜é‡æ˜¯å¦è¢«å£°æ˜ã€‚å¦‚æœå‡½æ•°æœªè¢«å£°æ˜ï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºä¸€ä¸ªè­¦å‘Šï¼Œä½†å¯ä»¥ç”ŸæˆObject Fileã€‚è€Œåœ¨é“¾æ¥ç¨‹åºæ—¶ï¼Œé“¾æ¥å™¨ä¼šåœ¨æ‰€æœ‰çš„Object Fileä¸­æ‰¾å¯»å‡½æ•°çš„å®ç°ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£åˆ°å°±ä¼šæŠ¥é“¾æ¥é”™è¯¯ç ï¼ˆLinker Errorï¼‰ï¼Œåœ¨VCä¸‹ï¼Œè¿™ç§é”™è¯¯ä¸€èˆ¬æ˜¯ï¼šLink 2001é”™è¯¯ï¼Œæ„æ€è¯´æ˜¯è¯´ï¼Œé“¾æ¥å™¨æœªèƒ½æ‰¾åˆ°å‡½æ•°çš„å®ç°ã€‚ä½ éœ€è¦æŒ‡å®šå‡½æ•°çš„Object File.</p> 
  <h2><a id="1_Makefile__24"></a><strong>1. Makefile ç®€ä»‹</strong></h2> 
  <p>Makefile æ˜¯å’Œ make å‘½ä»¤ä¸€èµ·é…åˆä½¿ç”¨çš„.</p> 
  <p>å¾ˆå¤šå¤§å‹é¡¹ç›®çš„ç¼–è¯‘éƒ½æ˜¯é€šè¿‡ Makefile æ¥ç»„ç»‡çš„, å¦‚æœæ²¡æœ‰ Makefile, é‚£å¾ˆå¤šé¡¹ç›®ä¸­å„ç§åº“å’Œä»£ç ä¹‹é—´çš„ä¾èµ–å…³ç³»ä¸çŸ¥ä¼šå¤šå¤æ‚.</p> 
  <p>Makefileçš„ç»„ç»‡æµç¨‹çš„èƒ½åŠ›å¦‚æ­¤ä¹‹å¼º, ä¸ä»…å¯ä»¥ç”¨æ¥ç¼–è¯‘é¡¹ç›®, è¿˜å¯ä»¥ç”¨æ¥ç»„ç»‡æˆ‘ä»¬å¹³æ—¶çš„ä¸€äº›æ—¥å¸¸æ“ä½œ. è¿™ä¸ªéœ€è¦å¤§å®¶å‘æŒ¥è‡ªå·±çš„æƒ³è±¡åŠ›.</p> 
  <h3><a id="11_Makefile__5______32"></a><strong>1.1 Makefile ä¸»è¦çš„ 5ä¸ªéƒ¨åˆ† (æ˜¾ç¤ºè§„åˆ™, éšæ™¦è§„åˆ™, å˜é‡å®šä¹‰, æ–‡ä»¶æŒ‡ç¤º, æ³¨é‡Š)</strong></h3> 
  <p>MakefileåŸºæœ¬æ ¼å¼å¦‚ä¸‹:</p> 
  <blockquote> 
   <pre><code class="prism language-c">target <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">:</span> prerequisites <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    command
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre> 
  </blockquote> 
  <p>å…¶ä¸­,</p> 
  <ul> 
   <li>target - ç›®æ ‡æ–‡ä»¶, å¯ä»¥æ˜¯ Object File, ä¹Ÿå¯ä»¥æ˜¯å¯æ‰§è¡Œæ–‡ä»¶</li> 
   <li>prerequisites - ç”Ÿæˆ target æ‰€éœ€è¦çš„æ–‡ä»¶æˆ–è€…ç›®æ ‡</li> 
   <li>command - makeéœ€è¦æ‰§è¡Œçš„å‘½ä»¤ (ä»»æ„çš„shellå‘½ä»¤), Makefileä¸­çš„å‘½ä»¤å¿…é¡»ä»¥ [tab] å¼€å¤´</li> 
  </ul> 
  <ol> 
   <li><strong>æ˜¾ç¤ºè§„åˆ™ :: è¯´æ˜å¦‚ä½•ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡æ–‡ä»¶(åŒ…æ‹¬ ç”Ÿæˆçš„æ–‡ä»¶, æ–‡ä»¶çš„ä¾èµ–æ–‡ä»¶, ç”Ÿæˆçš„å‘½ä»¤)</strong></li> 
   <li><strong>éšæ™¦è§„åˆ™ :: makeçš„è‡ªåŠ¨æ¨å¯¼åŠŸèƒ½æ‰€æ‰§è¡Œçš„è§„åˆ™</strong></li> 
   <li><strong>å˜é‡å®šä¹‰ :: Makefileä¸­å®šä¹‰çš„å˜é‡</strong></li> 
   <li><strong>æ–‡ä»¶æŒ‡ç¤º :: Makefileä¸­å¼•ç”¨å…¶ä»–Makefile; æŒ‡å®šMakefileä¸­æœ‰æ•ˆéƒ¨åˆ†; å®šä¹‰ä¸€ä¸ªå¤šè¡Œå‘½ä»¤</strong></li> 
   <li><strong>æ³¨é‡Š :: Makefileåªæœ‰è¡Œæ³¨é‡Š â€œ#â€, å¦‚æœè¦ä½¿ç”¨æˆ–è€…è¾“å‡º"#"å­—ç¬¦, éœ€è¦è¿›è¡Œè½¬ä¹‰, "#"</strong></li> 
  </ol> 
  <h3><a id="12_GNU_make__59"></a><strong>1.2 GNU make çš„å·¥ä½œæ–¹å¼</strong></h3> 
  <ol> 
   <li>è¯»å…¥ä¸»Makefile (ä¸»Makefileä¸­å¯ä»¥å¼•ç”¨å…¶ä»–Makefile)</li> 
   <li>è¯»å…¥è¢«includeçš„å…¶ä»–Makefile</li> 
   <li>åˆå§‹åŒ–æ–‡ä»¶ä¸­çš„å˜é‡</li> 
   <li>æ¨å¯¼éšæ™¦è§„åˆ™, å¹¶åˆ†ææ‰€æœ‰è§„åˆ™</li> 
   <li>ä¸ºæ‰€æœ‰çš„ç›®æ ‡æ–‡ä»¶åˆ›å»ºä¾èµ–å…³ç³»é“¾</li> 
   <li>æ ¹æ®ä¾èµ–å…³ç³», å†³å®šå“ªäº›ç›®æ ‡è¦é‡æ–°ç”Ÿæˆ</li> 
   <li>æ‰§è¡Œç”Ÿæˆå‘½ä»¤</li> 
  </ol> 
  <h2><a id="2_Makefile__71"></a><strong>2. Makefile åˆçº§è¯­æ³•</strong></h2> 
  <h3><a id="21_Makefile__73"></a><strong>2.1 Makefile è§„åˆ™</strong></h3> 
  <h4><a id="211__75"></a><strong>2.1.1 è§„åˆ™è¯­æ³•</strong></h4> 
  <p>è§„åˆ™ä¸»è¦æœ‰2éƒ¨åˆ†: ä¾èµ–å…³ç³» å’Œ ç”Ÿæˆç›®æ ‡çš„æ–¹æ³•.</p> 
  <p>è¯­æ³•æœ‰ä»¥ä¸‹2ç§:</p> 
  <blockquote> 
   <pre><code class="prism language-makefile">target ... : prerequisites ...
    command
    ...
</code></pre> 
  </blockquote> 
  <p>æˆ–è€…</p> 
  <blockquote> 
   <pre><code class="prism language-makefile">target ... : prerequisites ; command
    command
    ...
</code></pre> 
  </blockquote> 
  <p>*<strong>æ³¨*</strong> commandå¤ªé•¿, å¯ä»¥ç”¨ â€œâ€ ä½œä¸ºæ¢è¡Œç¬¦</p> 
  <h4><a id="212__99"></a><strong>2.1.2 è§„åˆ™ä¸­çš„é€šé…ç¬¦</strong></h4> 
  <ul> 
   <li>* :: è¡¨ç¤ºä»»æ„ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦</li> 
   <li>? :: è¡¨ç¤ºä»»æ„ä¸€ä¸ªå­—ç¬¦</li> 
   <li>[â€¦] :: ex. [abcd] è¡¨ç¤ºa,b,c,dä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦, [^abcd]è¡¨ç¤ºé™¤a,b,c,dä»¥å¤–çš„å­—ç¬¦, [0-9]è¡¨ç¤º 0~9ä¸­ä»»æ„ä¸€ä¸ªæ•°å­—</li> 
   <li>~ :: è¡¨ç¤ºç”¨æˆ·çš„homeç›®å½•</li> 
  </ul> 
  <h4><a id="213__108"></a><strong>2.1.3 è·¯å¾„æœç´¢</strong></h4> 
  <p>å½“ä¸€ä¸ªMakefileä¸­æ¶‰åŠåˆ°å¤§é‡æºæ–‡ä»¶æ—¶(è¿™äº›æºæ–‡ä»¶å’ŒMakefileææœ‰å¯èƒ½ä¸åœ¨åŒä¸€ä¸ªç›®å½•ä¸­),</p> 
  <p>è¿™æ—¶, æœ€å¥½å°†æºæ–‡ä»¶çš„è·¯å¾„æ˜ç¡®åœ¨Makefileä¸­, ä¾¿äºç¼–è¯‘æ—¶æŸ¥æ‰¾. Makefileä¸­æœ‰ä¸ªç‰¹æ®Šçš„å˜é‡ <strong>VPATH</strong> å°±æ˜¯å®Œæˆè¿™ä¸ªåŠŸèƒ½çš„.</p> 
  <p>æŒ‡å®šäº† <strong>VPATH</strong> ä¹‹å, å¦‚æœå½“å‰ç›®å½•ä¸­æ²¡æœ‰æ‰¾åˆ°ç›¸åº”æ–‡ä»¶æˆ–ä¾èµ–çš„æ–‡ä»¶, Makefile å›åˆ° <strong>VPATH</strong> æŒ‡å®šçš„è·¯å¾„ä¸­å†å»æŸ¥æ‰¾â€¦</p> 
  <p><strong>VPATH</strong> ä½¿ç”¨æ–¹æ³•:</p> 
  <ul> 
   <li>vpath :: å½“å‰ç›®å½•ä¸­æ‰¾ä¸åˆ°æ–‡ä»¶æ—¶, å°±ä»ä¸­æœç´¢</li> 
   <li>vpath :: ç¬¦åˆæ ¼å¼çš„æ–‡ä»¶, å°±ä»ä¸­æœç´¢</li> 
   <li>vpath :: æ¸…é™¤ç¬¦åˆæ ¼å¼çš„æ–‡ä»¶æœç´¢è·¯å¾„</li> 
   <li>vpath :: æ¸…é™¤æ‰€æœ‰å·²ç»è®¾ç½®å¥½çš„æ–‡ä»¶è·¯å¾„</li> 
  </ul> 
  <blockquote> 
   <pre><code class="prism language-makefile"># ç¤ºä¾‹1 - å½“å‰ç›®å½•ä¸­æ‰¾ä¸åˆ°æ–‡ä»¶æ—¶, æŒ‰é¡ºåºä» srcç›®å½• ../parent-dirç›®å½•ä¸­æŸ¥æ‰¾æ–‡ä»¶
VPATH src:../parent-dir   

# ç¤ºä¾‹2 - .hç»“å°¾çš„æ–‡ä»¶éƒ½ä» ./header ç›®å½•ä¸­æŸ¥æ‰¾
VPATH %.h ./header

# ç¤ºä¾‹3 - æ¸…é™¤ç¤ºä¾‹2ä¸­è®¾ç½®çš„è§„åˆ™
VPATH %.h

# ç¤ºä¾‹4 - æ¸…é™¤æ‰€æœ‰VPATHçš„è®¾ç½®
VPATH
</code></pre> 
  </blockquote> 
  <h3><a id="22_Makefile__139"></a><strong>2.2 Makefile ä¸­çš„å˜é‡</strong></h3> 
  <h4><a id="221____or___141"></a><strong>2.2.1 å˜é‡å®šä¹‰ ( = or := )</strong></h4> 
  <blockquote> 
   <pre><code class="prism language-makefile">OBJS = programA.o programB.o
OBJS-ADD = $(OBJS) programC.o
# æˆ–è€…
OBJS := programA.o programB.o
OBJS-ADD := $(OBJS) programC.o
</code></pre> 
  </blockquote> 
  <p>å…¶ä¸­ = å’Œ := çš„åŒºåˆ«åœ¨äº, := åªèƒ½ä½¿ç”¨å‰é¢å®šä¹‰å¥½çš„å˜é‡, = å¯ä»¥ä½¿ç”¨åé¢å®šä¹‰çš„å˜é‡</p> 
  <p><strong>æµ‹è¯• =</strong></p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefileå†…å®¹
OBJS2 = $(OBJS1) programC.o
OBJS1 = programA.o programB.o

all:
    @echo $(OBJS2)

# bashä¸­æ‰§è¡Œ make, å¯ä»¥çœ‹å‡ºè™½ç„¶ OBJS1 æ˜¯åœ¨ OBJS2 ä¹‹åå®šä¹‰çš„, ä½†åœ¨ OBJS2ä¸­å¯ä»¥æå‰ä½¿ç”¨
$ make
programA.o programB.o programC.o
</code></pre> 
  </blockquote> 
  <p><strong>æµ‹è¯• :=</strong></p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefileå†…å®¹
OBJS2 := $(OBJS1) programC.o
OBJS1 := programA.o programB.o

all:
    @echo $(OBJS2)

# bashä¸­æ‰§è¡Œ make, å¯ä»¥çœ‹å‡º OBJS2 ä¸­çš„ $(OBJS1) ä¸ºç©º
$ make
programC.o
</code></pre> 
  </blockquote> 
  <h4><a id="222__187"></a><strong>2.2.2 å˜é‡æ›¿æ¢</strong></h4> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefileå†…å®¹
SRCS := programA.c programB.c programC.c
OBJS := $(SRCS:%.c=%.o)

all:
    @echo "SRCS: " $(SRCS)
    @echo "OBJS: " $(OBJS)

# bashä¸­è¿è¡Œmake
$ make
SRCS:  programA.c programB.c programC.c
OBJS:  programA.o programB.o programC.o
</code></pre> 
  </blockquote> 
  <h4><a id="223___206"></a><strong>2.2.3 å˜é‡è¿½åŠ å€¼ +=</strong></h4> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefileå†…å®¹
SRCS := programA.c programB.c programC.c
SRCS += programD.c

all:
    @echo "SRCS: " $(SRCS)

# bashä¸­è¿è¡Œmake
$ make
SRCS:  programA.c programB.c programC.c programD.c
</code></pre> 
  </blockquote> 
  <h4><a id="224__override_223"></a><strong>2.2.4 å˜é‡è¦†ç›– override</strong></h4> 
  <p>ä½œç”¨æ˜¯ä½¿ Makefileä¸­å®šä¹‰çš„å˜é‡èƒ½å¤Ÿè¦†ç›– make å‘½ä»¤å‚æ•°ä¸­æŒ‡å®šçš„å˜é‡</p> 
  <p>è¯­æ³•:</p> 
  <ul> 
   <li>override = </li> 
   <li>override := </li> 
   <li>override += </li> 
  </ul> 
  <p>ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­ä½“ä¼š override çš„ä½œç”¨ï¼š</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefileå†…å®¹ (æ²¡æœ‰ç”¨override)
SRCS := programA.c programB.c programC.c

all:
    @echo "SRCS: " $(SRCS)

# bashä¸­è¿è¡Œmake
$ make SRCS=nothing
SRCS:  nothing

#################################################

# Makefileå†…å®¹ (ç”¨override)
override SRCS := programA.c programB.c programC.c

all:
    @echo "SRCS: " $(SRCS)

# bashä¸­è¿è¡Œmake
$ make SRCS=nothing
SRCS:  programA.c programB.c programC.c
</code></pre> 
  </blockquote> 
  <h4><a id="225__263"></a><strong>2.2.5 ç›®æ ‡å˜é‡</strong></h4> 
  <p>ä½œç”¨æ˜¯ä½¿å˜é‡çš„ä½œç”¨åŸŸä»…é™äºè¿™ä¸ªç›®æ ‡(target), è€Œä¸åƒä¹‹å‰ä¾‹å­ä¸­å®šä¹‰çš„å˜é‡, å¯¹æ•´ä¸ªMakefileéƒ½æœ‰æ•ˆ.</p> 
  <p>è¯­æ³•:</p> 
  <ul> 
   <li>&lt;target â€¦&gt; :: </li> 
   <li>&lt;target â€¦&gt; :: override (overrideä½œç”¨å‚è§ å˜é‡è¦†ç›–çš„ä»‹ç»)</li> 
  </ul> 
  <p>ç¤ºä¾‹:</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
SRCS := programA.c programB.c programC.c

target1: TARGET1-SRCS := programD.c
target1:
    @echo "SRCS: " $(SRCS)
    @echo "SRCS: " $(TARGET1-SRCS)

target2:
    @echo "SRCS: " $(SRCS)
    @echo "SRCS: " $(TARGET1-SRCS)

# bashä¸­æ‰§è¡Œmake
$ make target1
SRCS:  programA.c programB.c programC.c
SRCS:  programD.c

$ make target2     &lt;-- target2ä¸­æ˜¾ç¤ºä¸äº† $(TARGET1-SRCS)
SRCS:  programA.c programB.c programC.c
SRCS:
</code></pre> 
  </blockquote> 
  <h3><a id="23_Makefile__299"></a><strong>2.3 Makefile å‘½ä»¤å‰ç¼€</strong></h3> 
  <p>Makefile ä¸­ä¹¦å†™shellå‘½ä»¤æ—¶å¯ä»¥åŠ 2ç§å‰ç¼€ @ å’Œ -, æˆ–è€…ä¸ç”¨å‰ç¼€.</p> 
  <p>3ç§æ ¼å¼çš„shellå‘½ä»¤åŒºåˆ«å¦‚ä¸‹:</p> 
  <ul> 
   <li>ä¸ç”¨å‰ç¼€ :: è¾“å‡ºæ‰§è¡Œçš„å‘½ä»¤ä»¥åŠå‘½ä»¤æ‰§è¡Œçš„ç»“æœ, å‡ºé”™çš„è¯åœæ­¢æ‰§è¡Œ</li> 
   <li>å‰ç¼€ @ :: åªè¾“å‡ºå‘½ä»¤æ‰§è¡Œçš„ç»“æœ, å‡ºé”™çš„è¯åœæ­¢æ‰§è¡Œ</li> 
   <li>å‰ç¼€ - :: å‘½ä»¤æ‰§è¡Œæœ‰é”™çš„è¯, å¿½ç•¥é”™è¯¯, ç»§ç»­æ‰§è¡Œ</li> 
  </ul> 
  <p>ç¤ºä¾‹:</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹ (ä¸ç”¨å‰ç¼€)
all:
    echo "æ²¡æœ‰å‰ç¼€"
    cat this_file_not_exist
    echo "é”™è¯¯ä¹‹åçš„å‘½ä»¤"       &lt;-- è¿™æ¡å‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œ

# bashä¸­æ‰§è¡Œ make
$ make
echo "æ²¡æœ‰å‰ç¼€"             &lt;-- å‘½ä»¤æœ¬èº«æ˜¾ç¤ºå‡ºæ¥
æ²¡æœ‰å‰ç¼€                    &lt;-- å‘½ä»¤æ‰§è¡Œç»“æœæ˜¾ç¤ºå‡ºæ¥
cat this_file_not_exist
cat: this_file_not_exist: No such file or directory
make: *** [all] Error 1

###########################################################

# Makefile å†…å®¹ (å‰ç¼€ @)
all:
    @echo "æ²¡æœ‰å‰ç¼€"
    @cat this_file_not_exist
    @echo "é”™è¯¯ä¹‹åçš„å‘½ä»¤"       &lt;-- è¿™æ¡å‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œ

# bashä¸­æ‰§è¡Œ make
$ make
æ²¡æœ‰å‰ç¼€                         &lt;-- åªæœ‰å‘½ä»¤æ‰§è¡Œçš„ç»“æœ, ä¸æ˜¾ç¤ºå‘½ä»¤æœ¬èº«
cat: this_file_not_exist: No such file or directory
make: *** [all] Error 1

###########################################################

# Makefile å†…å®¹ (å‰ç¼€ -)
all:
    -echo "æ²¡æœ‰å‰ç¼€"
    -cat this_file_not_exist
    -echo "é”™è¯¯ä¹‹åçš„å‘½ä»¤"       &lt;-- è¿™æ¡å‘½ä»¤ä¼šè¢«æ‰§è¡Œ

# bashä¸­æ‰§è¡Œ make
$ make
echo "æ²¡æœ‰å‰ç¼€"             &lt;-- å‘½ä»¤æœ¬èº«æ˜¾ç¤ºå‡ºæ¥
æ²¡æœ‰å‰ç¼€                    &lt;-- å‘½ä»¤æ‰§è¡Œç»“æœæ˜¾ç¤ºå‡ºæ¥
cat this_file_not_exist
cat: this_file_not_exist: No such file or directory
make: [all] Error 1 (ignored)
echo "é”™è¯¯ä¹‹åçš„å‘½ä»¤"       &lt;-- å‡ºé”™ä¹‹åçš„å‘½ä»¤ä¹Ÿä¼šæ˜¾ç¤º
é”™è¯¯ä¹‹åçš„å‘½ä»¤              &lt;-- å‡ºé”™ä¹‹åçš„å‘½ä»¤ä¹Ÿä¼šæ‰§è¡Œ
</code></pre> 
  </blockquote> 
  <h3><a id="24__361"></a><strong>2.4 ä¼ªç›®æ ‡</strong></h3> 
  <p>ä¼ªç›®æ ‡å¹¶ä¸æ˜¯ä¸€ä¸ª"ç›®æ ‡(target)", ä¸åƒçœŸæ­£çš„ç›®æ ‡é‚£æ ·ä¼šç”Ÿæˆä¸€ä¸ªç›®æ ‡æ–‡ä»¶.</p> 
  <p>å…¸å‹çš„ä¼ªç›®æ ‡æ˜¯ Makefile ä¸­ç”¨æ¥æ¸…ç†ç¼–è¯‘è¿‡ç¨‹ä¸­ä¸­é—´æ–‡ä»¶çš„ clean ä¼ªç›®æ ‡, ä¸€èˆ¬æ ¼å¼å¦‚ä¸‹:</p> 
  <blockquote> 
   <pre><code class="prism language-makefile">.PHONY: clean   &lt;-- è¿™å¥æ²¡æœ‰ä¹Ÿè¡Œ, ä½†æ˜¯æœ€å¥½åŠ ä¸Š
clean:
    -rm -f *.o
</code></pre> 
  </blockquote> 
  <h3><a id="25__Makefile_375"></a><strong>2.5 å¼•ç”¨å…¶ä»–çš„ Makefile</strong></h3> 
  <p>è¯­æ³•: include (filename å¯ä»¥åŒ…å«é€šé…ç¬¦å’Œè·¯å¾„)</p> 
  <p>ç¤ºä¾‹:</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo "ä¸» Makefile begin"
    @make other-all
    @echo "ä¸» Makefile end"

include ./other/Makefile

# ./other/Makefile å†…å®¹
other-all:
    @echo "other makefile begin"
    @echo "other makefile end"

# bashä¸­æ‰§è¡Œ make
$ ll
total 20K
-rw-r--r-- 1 wangyubin wangyubin  125 Sep 23 16:13 Makefile
-rw-r--r-- 1 wangyubin wangyubin  11K Sep 23 16:15 makefile.org   &lt;-- è¿™ä¸ªæ–‡ä»¶ä¸ç”¨ç®¡
drwxr-xr-x 2 wangyubin wangyubin 4.0K Sep 23 16:11 other
$ ll other/
total 4.0K
-rw-r--r-- 1 wangyubin wangyubin 71 Sep 23 16:11 Makefile

$ make
ä¸» Makefile begin
make[1]: Entering directory `/path/to/test/makefile'
other makefile begin
other makefile end
make[1]: Leaving directory `/path/to/test/makefile'
ä¸» Makefile end
</code></pre> 
  </blockquote> 
  <h3><a id="26_C_417"></a><strong>2.6 æŸ¥çœ‹Cæ–‡ä»¶çš„ä¾èµ–å…³ç³»</strong></h3> 
  <p>å†™ Makefile çš„æ—¶å€™, éœ€è¦ç¡®å®šæ¯ä¸ªç›®æ ‡çš„ä¾èµ–å…³ç³».</p> 
  <p>GNUæä¾›ä¸€ä¸ªæœºåˆ¶å¯ä»¥æŸ¥çœ‹Cä»£ç æ–‡ä»¶ä¾èµ–é‚£äº›æ–‡ä»¶, è¿™æ ·æˆ‘ä»¬åœ¨å†™ Makefile ç›®æ ‡çš„æ—¶å€™å°±ä¸ç”¨æ‰“å¼€Cæºç æ¥çœ‹å…¶ä¾èµ–é‚£äº›æ–‡ä»¶äº†.</p> 
  <p>æ¯”å¦‚, ä¸‹é¢å‘½ä»¤æ˜¾ç¤ºå†…æ ¸æºç ä¸­ virt/kvm/kvm_main.c ä¸­çš„ä¾èµ–å…³ç³»</p> 
  <blockquote> 
   <pre><code class="prism language-makefile">$ cd virt/kvm/
$ gcc -MM kvm_main.c 
kvm_main.o: kvm_main.c iodev.h coalesced_mmio.h async_pf.h   &lt;-- è¿™å¥å°±å¯ä»¥åŠ åˆ° Makefile ä¸­ä½œä¸ºç¼–è¯‘ kvm_main.o çš„ä¾èµ–å…³ç³»
</code></pre> 
  </blockquote> 
  <h3><a id="27_make__434"></a><strong>2.7 make é€€å‡ºç </strong></h3> 
  <p>Makefileçš„é€€å‡ºç æœ‰ä»¥ä¸‹3ç§ï¼š</p> 
  <ul> 
   <li>0 :: è¡¨ç¤ºæˆåŠŸæ‰§è¡Œ</li> 
   <li>1 :: è¡¨ç¤ºmakeå‘½ä»¤å‡ºç°äº†é”™è¯¯</li> 
   <li>2 :: ä½¿ç”¨äº† â€œ-qâ€ é€‰é¡¹, å¹¶ä¸”makeä½¿å¾—ä¸€äº›ç›®æ ‡ä¸éœ€è¦æ›´æ–°</li> 
  </ul> 
  <h3><a id="28__Makefile__444"></a><strong>2.8 æŒ‡å®š Makefileï¼Œ æŒ‡å®šç‰¹å®šç›®æ ‡</strong></h3> 
  <p>é»˜è®¤æ‰§è¡Œ make å‘½ä»¤æ—¶, GNU makeåœ¨å½“å‰ç›®å½•ä¸‹ä¾æ¬¡æœç´¢ä¸‹é¢3ä¸ªæ–‡ä»¶ â€œGNUmakefileâ€, â€œmakefileâ€, â€œMakefileâ€,</p> 
  <p>æ‰¾åˆ°å¯¹åº”æ–‡ä»¶ä¹‹å, å°±å¼€å§‹æ‰§è¡Œæ­¤æ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªç›®æ ‡(target). å¦‚æœæ‰¾ä¸åˆ°è¿™3ä¸ªæ–‡ä»¶å°±æŠ¥é”™.</p> 
  <p>éé»˜è®¤æƒ…å†µä¸‹, å¯ä»¥åœ¨ make å‘½ä»¤ä¸­æŒ‡å®šç‰¹å®šçš„ Makefile å’Œç‰¹å®šçš„ ç›®æ ‡.</p> 
  <p>ç¤ºä¾‹ï¼š</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefileæ–‡ä»¶åæ”¹ä¸º MyMake, å†…å®¹
target1:
    @echo "target [1]  begin"
    @echo "target [1]  end"

target2:
    @echo "target [2]  begin"
    @echo "target [2]  end"

# bash ä¸­æ‰§è¡Œ make
$ ls
Makefile
$ mv Makefile MyMake
$ ls
MyMake
$ make                     &lt;-- æ‰¾ä¸åˆ°é»˜è®¤çš„ Makefile
make: *** No targets specified and no makefile found.  Stop.
$ make -f MyMake           &lt;-- æŒ‡å®šç‰¹å®šçš„Makefile
target [1]  begin
target [1]  end
$ make -f MyMake target2   &lt;-- æŒ‡å®šç‰¹å®šçš„ç›®æ ‡(target)
target [2]  begin
target [2]  end
</code></pre> 
  </blockquote> 
  <h3><a id="29_make__483"></a><strong>2.9 make å‚æ•°ä»‹ç»</strong></h3> 
  <p>make çš„å‚æ•°æœ‰å¾ˆå¤š, å¯ä»¥é€šè¿‡ make -h å»æŸ¥çœ‹, ä¸‹é¢åªä»‹ç»å‡ ä¸ªæˆ‘è®¤ä¸ºæ¯”è¾ƒæœ‰ç”¨çš„.</p> 
  <blockquote> 
   <table> 
    <thead> 
     <tr> 
      <th><strong>å‚æ•°</strong></th> 
      <th><strong>å«ä¹‰</strong></th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr> 
      <td>â€“debug[=]</td> 
      <td>è¾“å‡ºmakeçš„è°ƒè¯•ä¿¡æ¯, options å¯ä»¥æ˜¯ a, b, v</td> 
     </tr> 
     <tr> 
      <td>-j --jobs</td> 
      <td>åŒæ—¶è¿è¡Œçš„å‘½ä»¤çš„ä¸ªæ•°, ä¹Ÿå°±æ˜¯å¤šçº¿ç¨‹æ‰§è¡Œ Makefile</td> 
     </tr> 
     <tr> 
      <td>-r --no-builtin-rules</td> 
      <td>ç¦æ­¢ä½¿ç”¨ä»»ä½•éšå«è§„åˆ™</td> 
     </tr> 
     <tr> 
      <td>-R --no-builtin-variabes</td> 
      <td>ç¦æ­¢ä½¿ç”¨ä»»ä½•ä½œç”¨äºå˜é‡ä¸Šçš„éšå«è§„åˆ™</td> 
     </tr> 
     <tr> 
      <td>-B --always-make</td> 
      <td>å‡è®¾æ‰€æœ‰ç›®æ ‡éƒ½æœ‰æ›´æ–°, å³å¼ºåˆ¶é‡ç¼–è¯‘</td> 
     </tr> 
    </tbody> 
   </table>
  </blockquote> 
  <h3><a id="210_Makefile__498"></a><strong>2.10 Makefile éšå«è§„åˆ™</strong></h3> 
  <p>è¿™é‡Œåªåˆ—ä¸€ä¸ªå’Œç¼–è¯‘Cç›¸å…³çš„.</p> 
  <p>ç¼–è¯‘Cæ—¶ï¼Œ.o çš„ç›®æ ‡ä¼šè‡ªåŠ¨æ¨å¯¼ä¸º .c</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile ä¸­
main : main.o
    gcc -o main main.o

#ä¼šè‡ªåŠ¨å˜ä¸º:
main : main.o
    gcc -o main main.o

main.o: main.c    &lt;-- main.o è¿™ä¸ªç›®æ ‡æ˜¯éšå«ç”Ÿæˆçš„
    gcc -c main.c
</code></pre> 
  </blockquote> 
  <h3><a id="211_____520"></a><strong>2.11 éšå«è§„åˆ™ä¸­çš„ å‘½ä»¤å˜é‡ å’Œ å‘½ä»¤å‚æ•°å˜é‡</strong></h3> 
  <h4><a id="2111__Makefile_shell_522"></a><strong>2.11.1 å‘½ä»¤å˜é‡, ä¹¦å†™Makefileå¯ä»¥ç›´æ¥å†™ shellæ—¶ç”¨è¿™äº›å˜é‡.</strong></h4> 
  <p>ä¸‹é¢åªåˆ—å‡ºä¸€äº›Cç›¸å…³çš„</p> 
  <blockquote> 
   <table> 
    <thead> 
     <tr> 
      <th><strong>å˜é‡å</strong></th> 
      <th><strong>å«ä¹‰</strong></th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr> 
      <td>RM</td> 
      <td>rm -f</td> 
     </tr> 
     <tr> 
      <td>AR</td> 
      <td>ar</td> 
     </tr> 
     <tr> 
      <td>CC</td> 
      <td>cc</td> 
     </tr> 
     <tr> 
      <td>CXX</td> 
      <td>g++</td> 
     </tr> 
    </tbody> 
   </table>
  </blockquote> 
  <p>ç¤ºä¾‹:</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(RM)
    @echo $(AR)
    @echo $(CC)
    @echo $(CXX)

# bash ä¸­æ‰§è¡Œmake, æ˜¾ç¤ºå„ä¸ªå˜é‡çš„å€¼
$ make
rm -f
ar
cc
g++
</code></pre> 
  </blockquote> 
  <h4><a id="2112__555"></a><strong>2.11.2 å‘½ä»¤å‚æ•°å˜é‡</strong></h4> 
  <table> 
   <thead> 
    <tr> 
     <th><strong>å˜é‡å</strong></th> 
     <th><strong>å«ä¹‰</strong></th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td>ARFLAGS</td> 
     <td>ARå‘½ä»¤çš„å‚æ•°</td> 
    </tr> 
    <tr> 
     <td>CFLAGS</td> 
     <td>Cè¯­è¨€ç¼–è¯‘å™¨çš„å‚æ•°</td> 
    </tr> 
    <tr> 
     <td>CXXFLAGS</td> 
     <td>C++è¯­è¨€ç¼–è¯‘å™¨çš„å‚æ•°</td> 
    </tr> 
   </tbody> 
  </table>
  <p>ç¤ºä¾‹: ä¸‹é¢ä»¥ CFLAGS ä¸ºä¾‹æ¼”ç¤º</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># test.c å†…å®¹
#include &lt;stdio.h&gt;

int main(int argc, char *argv[])
{
    printf ("Hello Makefile\n");
    return 0;
}

# Makefile å†…å®¹
test: test.o
    $(CC) -o test test.o

# bash ä¸­ç”¨ make æ¥æµ‹è¯•
$ ll
total 24K
-rw-r--r-- 1 wangyubin wangyubin  69 Sep 23 17:31 Makefile
-rw-r--r-- 1 wangyubin wangyubin 14K Sep 23 19:51 makefile.org   &lt;-- è¯·å¿½ç•¥è¿™ä¸ªæ–‡ä»¶
-rw-r--r-- 1 wangyubin wangyubin 392 Sep 23 17:31 test.c

$ make
cc    -c -o test.o test.c
cc -o test test.o               &lt;-- è¿™ä¸ªæ˜¯è‡ªåŠ¨æ¨å¯¼çš„

$ rm -f test test.o

$ make CFLAGS=-Wall             &lt;-- å‘½ä»¤ä¸­åŠ çš„ç¼–è¯‘å™¨å‚æ•°è‡ªåŠ¨è¿½åŠ å…¥ä¸‹é¢çš„ç¼–è¯‘ä¸­äº†
cc -Wall   -c -o test.o test.c
cc -o test test.o
</code></pre> 
  </blockquote> 
  <h3><a id="212__602"></a><strong>2.12 è‡ªåŠ¨å˜é‡</strong></h3> 
  <p>Makefile ä¸­å¾ˆå¤šæ—¶å€™é€šè¿‡è‡ªåŠ¨å˜é‡æ¥ç®€åŒ–ä¹¦å†™, å„ä¸ªè‡ªåŠ¨å˜é‡çš„å«ä¹‰å¦‚ä¸‹:</p> 
  <blockquote> 
   <table> 
    <thead> 
     <tr> 
      <th><strong>è‡ªåŠ¨å˜é‡</strong></th> 
      <th><strong>å«ä¹‰</strong></th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr> 
      <td>$@</td> 
      <td>ç›®æ ‡é›†åˆ</td> 
     </tr> 
     <tr> 
      <td>$%</td> 
      <td>å½“ç›®æ ‡æ˜¯å‡½æ•°åº“æ–‡ä»¶æ—¶, è¡¨ç¤ºå…¶ä¸­çš„ç›®æ ‡æ–‡ä»¶å</td> 
     </tr> 
     <tr> 
      <td>$&lt;</td> 
      <td>ç¬¬ä¸€ä¸ªä¾èµ–ç›®æ ‡. å¦‚æœä¾èµ–ç›®æ ‡æ˜¯å¤šä¸ª, é€ä¸ªè¡¨ç¤ºä¾èµ–ç›®æ ‡</td> 
     </tr> 
     <tr> 
      <td>$?</td> 
      <td>æ¯”ç›®æ ‡æ–°çš„ä¾èµ–ç›®æ ‡çš„é›†åˆ</td> 
     </tr> 
     <tr> 
      <td>$^</td> 
      <td>æ‰€æœ‰ä¾èµ–ç›®æ ‡çš„é›†åˆ, ä¼šå»é™¤é‡å¤çš„ä¾èµ–ç›®æ ‡</td> 
     </tr> 
     <tr> 
      <td>$+</td> 
      <td>æ‰€æœ‰ä¾èµ–ç›®æ ‡çš„é›†åˆ, ä¸ä¼šå»é™¤é‡å¤çš„ä¾èµ–ç›®æ ‡</td> 
     </tr> 
     <tr> 
      <td>$*</td> 
      <td>è¿™ä¸ªæ˜¯GNU makeç‰¹æœ‰çš„, å…¶å®ƒçš„makeä¸ä¸€å®šæ”¯æŒ</td> 
     </tr> 
    </tbody> 
   </table>
  </blockquote> 
  <h3><a id="3_Makefile__619"></a><strong>3. Makefile é«˜çº§è¯­æ³•</strong></h3> 
  <h3><a id="31_Makefile_621"></a><strong>3.1 åµŒå¥—Makefile</strong></h3> 
  <p>åœ¨ Makefile åˆçº§è¯­æ³•ä¸­å·²ç»æåˆ°è¿‡å¼•ç”¨å…¶å®ƒ Makefileçš„æ–¹æ³•. è¿™é‡Œæœ‰å¦ä¸€ç§å†™æ³•, å¹¶ä¸”å¯ä»¥å‘å¼•ç”¨çš„å…¶å®ƒ Makefile ä¼ é€’å‚æ•°.</p> 
  <p>ç¤ºä¾‹: (ä¸ä¼ é€’å‚æ•°, åªæ˜¯è°ƒç”¨å­æ–‡ä»¶å¤¹ other ä¸­çš„Makefile)</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo "ä¸» Makefile begin"
    @cd ./other &amp;&amp; make
    @echo "ä¸» Makefile end"


# ./other/Makefile å†…å®¹
other-all:
    @echo "other makefile begin"
    @echo "other makefile end"

# bashä¸­æ‰§è¡Œ make
$ ll
total 28K
-rw-r--r-- 1 wangyubin wangyubin  104 Sep 23 20:43 Makefile
-rw-r--r-- 1 wangyubin wangyubin  17K Sep 23 20:44 makefile.org   &lt;-- è¿™ä¸ªæ–‡ä»¶ä¸ç”¨ç®¡
drwxr-xr-x 2 wangyubin wangyubin 4.0K Sep 23 20:42 other
$ ll other/
total 4.0K
-rw-r--r-- 1 wangyubin wangyubin 71 Sep 23 16:11 Makefile

$ make
ä¸» Makefile begin
make[1]: Entering directory `/path/to/test/makefile/other'
other makefile begin
other makefile end
make[1]: Leaving directory `/path/to/test/makefile/other'
ä¸» Makefile end
</code></pre> 
  </blockquote> 
  <p>ç¤ºä¾‹: (ç”¨exportä¼ é€’å‚æ•°)</p> 
  <blockquote> 
   <pre><code class="prism language-bash"><span class="token comment"># Makefile å†…å®¹</span>
<span class="token function">export</span> VALUE1 :<span class="token operator">=</span> export.c    <span class="token operator">&lt;</span>-- ç”¨äº† export, æ­¤å˜é‡èƒ½å¤Ÿä¼ é€’åˆ° ./other/Makefile ä¸­
VALUE2 :<span class="token operator">=</span> no-export.c        <span class="token operator">&lt;</span>-- æ­¤å˜é‡ä¸èƒ½ä¼ é€’åˆ° ./other/Makefile ä¸­

all:
    @echo <span class="token string">"ä¸» Makefile begin"</span>
    @cd ./other <span class="token operator">&amp;&amp;</span> <span class="token function">make</span>
    @echo <span class="token string">"ä¸» Makefile end"</span>


<span class="token comment"># ./other/Makefile å†…å®¹</span>
other-all:
    @echo <span class="token string">"other makefile begin"</span>
    @echo <span class="token string">"VALUE1: "</span> <span class="token variable"><span class="token variable">$(</span>VALUE1<span class="token variable">)</span></span>
    @echo <span class="token string">"VALUE2: "</span> <span class="token variable"><span class="token variable">$(</span>VALUE2<span class="token variable">)</span></span>
    @echo <span class="token string">"other makefile end"</span>

<span class="token comment"># bashä¸­æ‰§è¡Œ make</span>
$ <span class="token function">make</span>
ä¸» Makefile begin
make<span class="token punctuation">[</span>1<span class="token punctuation">]</span>: Entering directory <span class="token variable"><span class="token variable">`</span>/path/to/test/makefile/other' other makefile begin VALUE1: export.c <span class="token operator">&lt;</span>-- VALUE1 ä¼ é€’æˆåŠŸ VALUE2: <span class="token operator">&lt;</span>-- VALUE2 ä¼ é€’å¤±è´¥ other makefile end make<span class="token punctuation">[</span>1<span class="token punctuation">]</span>: Leaving directory <span class="token variable">`</span></span>/path/to/test/makefile/other'
ä¸» Makefile end
</code></pre> 
  </blockquote> 
  <p>*<strong>è¡¥å……*</strong> export è¯­æ³•æ ¼å¼å¦‚ä¸‹:</p> 
  <ul> 
   <li>export variable = value</li> 
   <li>export variable := value</li> 
   <li>export variable += value</li> 
  </ul> 
  <h3><a id="32__705"></a><strong>3.2 å®šä¹‰å‘½ä»¤åŒ…</strong></h3> 
  <p>å‘½ä»¤åŒ…æœ‰ç‚¹åƒæ˜¯ä¸ªå‡½æ•°, å°†è¿ç»­çš„ç›¸åŒçš„å‘½ä»¤åˆæˆä¸€æ¡, å‡å°‘ Makefile ä¸­çš„ä»£ç é‡, ä¾¿äºä»¥åç»´æŠ¤.</p> 
  <p><strong>è¯­æ³•:</strong></p> 
  <blockquote> 
   <pre><code>define &lt;command-name&gt;
command
...
endef
</code></pre> 
  </blockquote> 
  <p><strong>ç¤ºä¾‹:</strong></p> 
  <blockquote> 
   <pre><code class="prism language-bash"><span class="token comment"># Makefile å†…å®¹</span>
define run-hello-makefile
@echo -n <span class="token string">"Hello"</span>
@echo <span class="token string">" Makefile!"</span>
@echo <span class="token string">"è¿™é‡Œå¯ä»¥æ‰§è¡Œå¤šæ¡ Shell å‘½ä»¤!"</span>
endef

all:
    <span class="token variable"><span class="token variable">$(</span>run-hello-makefile<span class="token variable">)</span></span>


<span class="token comment"># bash ä¸­è¿è¡Œmake</span>
$ <span class="token function">make</span>
Hello Makefile<span class="token operator">!</span>
è¿™é‡Œå¯ä»¥æ‰§è¡Œå¤šæ¡ Shell å‘½ä»¤<span class="token operator">!</span>
</code></pre> 
  </blockquote> 
  <h3><a id="33__744"></a><strong>3.3 æ¡ä»¶åˆ¤æ–­</strong></h3> 
  <p>æ¡ä»¶åˆ¤æ–­çš„å…³é”®å­—ä¸»è¦æœ‰ <strong>ifeq ifneq ifdef ifndef</strong></p> 
  <p><strong>è¯­æ³•:</strong></p> 
  <blockquote> 
   <pre><code class="prism language-bash"><span class="token operator">&lt;</span>conditional-directive<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>text-if-true<span class="token operator">&gt;</span>
endif

<span class="token comment"># æˆ–è€…</span>
<span class="token operator">&lt;</span>conditional-directive<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>text-if-true<span class="token operator">&gt;</span>
<span class="token keyword">else</span>
<span class="token operator">&lt;</span>text-if-false<span class="token operator">&gt;</span>
endif
</code></pre> 
  </blockquote> 
  <p><strong>ç¤ºä¾‹:</strong> ifeqçš„ä¾‹å­, ifneqå’Œifeqçš„ä½¿ç”¨æ–¹æ³•ç±»ä¼¼, å°±æ˜¯å–å</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
ifeq ("aa", "bb")
    @echo "equal"
else
    @echo "not equal"
endif

# bash ä¸­æ‰§è¡Œ make
$ make
not equal
</code></pre> 
  </blockquote> 
  <p><strong>ç¤ºä¾‹:</strong> ifdefçš„ä¾‹å­, ifndefå’Œifdefçš„ä½¿ç”¨æ–¹æ³•ç±»ä¼¼, å°±æ˜¯å–å</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
SRCS := program.c

all:
ifdef SRCS
    @echo $(SRCS)
else
    @echo "no SRCS"
endif

# bash ä¸­æ‰§è¡Œ make
$ make
program.c
</code></pre> 
  </blockquote> 
  <h3><a id="34_Makefile__806"></a><strong>3.4 Makefile ä¸­çš„å‡½æ•°</strong></h3> 
  <p>Makefile ä¸­è‡ªå¸¦äº†ä¸€äº›å‡½æ•°, åˆ©ç”¨è¿™äº›å‡½æ•°å¯ä»¥ç®€åŒ– Makefile çš„ç¼–å†™.</p> 
  <p>å‡½æ•°è°ƒç”¨è¯­æ³•å¦‚ä¸‹:</p> 
  <blockquote> 
   <pre><code class="prism language-makefile">$(&lt;function&gt; &lt;arguments&gt;)
# æˆ–è€…
${&lt;function&gt; &lt;arguments&gt;}
</code></pre> 
  </blockquote> 
  <ul> 
   <li> æ˜¯å‡½æ•°å</li> 
   <li> æ˜¯å‡½æ•°å‚æ•°</li> 
  </ul> 
  <h4><a id="341__824"></a><strong>3.4.1 å­—ç¬¦ä¸²å‡½æ•°</strong></h4> 
  <p><strong>å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°: $(subst ,,
    <text>
     )
    </text></strong></p> 
  <p>åŠŸèƒ½: æŠŠå­—ç¬¦ä¸²
   <text>
     ä¸­çš„ æ›¿æ¢ä¸º 
   </text></p> 
  <p>è¿”å›: æ›¿æ¢è¿‡çš„å­—ç¬¦ä¸²</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(subst t,e,maktfilt)  &lt;-- å°†tæ›¿æ¢ä¸ºe

# bash ä¸­æ‰§è¡Œ make
$ make
makefile
</code></pre> 
  </blockquote> 
  <p><strong>æ¨¡å¼å­—ç¬¦ä¸²æ›¿æ¢å‡½æ•°: $(patsubst ,,
    <text>
     )
    </text></strong></p> 
  <p>åŠŸèƒ½: æŸ¥æ‰¾
   <text>
    ä¸­çš„å•è¯(å•è¯ä»¥"ç©ºæ ¼", â€œtabâ€, "æ¢è¡Œ"æ¥åˆ†å‰²) æ˜¯å¦ç¬¦åˆ , ç¬¦åˆçš„è¯, ç”¨ æ›¿ä»£.
   </text></p> 
  <p>è¿”å›: æ›¿æ¢è¿‡çš„å­—ç¬¦ä¸²</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(patsubst %.c,%.o,programA.c programB.c)

# bash ä¸­æ‰§è¡Œ make
$ make
programA.o programB.o
</code></pre> 
  </blockquote> 
  <p><strong>å»ç©ºæ ¼å‡½æ•°: $(strip )</strong></p> 
  <p>åŠŸèƒ½: å»æ‰ å­—ç¬¦ä¸²ä¸­å¼€å¤´å’Œç»“å°¾çš„ç©ºå­—ç¬¦</p> 
  <p>è¿”å›: è¢«å»æ‰ç©ºæ ¼çš„å­—ç¬¦ä¸²å€¼</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
VAL := "       aa  bb  cc "

all:
    @echo "å»é™¤ç©ºæ ¼å‰: " $(VAL)
    @echo "å»é™¤ç©ºæ ¼å: " $(strip $(VAL))

# bash ä¸­æ‰§è¡Œ make
$ make
å»é™¤ç©ºæ ¼å‰:         aa  bb  cc 
å»é™¤ç©ºæ ¼å:   aa bb cc
</code></pre> 
  </blockquote> 
  <p><strong>æŸ¥æ‰¾å­—ç¬¦ä¸²å‡½æ•°: $(findstring ,)</strong></p> 
  <p>åŠŸèƒ½: åœ¨å­—ç¬¦ä¸² ä¸­æŸ¥æ‰¾ å­—ç¬¦ä¸²</p> 
  <p>è¿”å›: å¦‚æœæ‰¾åˆ°, è¿”å› å­—ç¬¦ä¸², å¦åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
VAL := "       aa  bb  cc "

all:
    @echo $(findstring aa,$(VAL))
    @echo $(findstring ab,$(VAL))

# bash ä¸­æ‰§è¡Œ make
$ make
aa
</code></pre> 
  </blockquote> 
  <p><strong>è¿‡æ»¤å‡½æ•°: $(filter &lt;patternâ€¦&gt;,
    <text>
     )
    </text></strong></p> 
  <p>åŠŸèƒ½: ä»¥ æ¨¡å¼è¿‡æ»¤å­—ç¬¦ä¸² 
   <text>
    , 
    <em>ä¿ç•™</em> ç¬¦åˆæ¨¡å¼ çš„å•è¯, å¯ä»¥æœ‰å¤šä¸ªæ¨¡å¼
   </text></p> 
  <p>è¿”å›: ç¬¦åˆæ¨¡å¼ çš„å­—ç¬¦ä¸²</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(filter %.o %.a,program.c program.o program.a)


# bash ä¸­æ‰§è¡Œ make
$ make
program.o program.a
</code></pre> 
  </blockquote> 
  <p><strong>åè¿‡æ»¤å‡½æ•°: $(filter-out &lt;patternâ€¦&gt;,
    <text>
     )
    </text></strong></p> 
  <p>åŠŸèƒ½: ä»¥ æ¨¡å¼è¿‡æ»¤å­—ç¬¦ä¸² 
   <text>
    , 
    <em>å»é™¤</em> ç¬¦åˆæ¨¡å¼ çš„å•è¯, å¯ä»¥æœ‰å¤šä¸ªæ¨¡å¼
   </text></p> 
  <p>è¿”å›: ä¸ç¬¦åˆæ¨¡å¼ çš„å­—ç¬¦ä¸²</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(filter-out %.o %.a,program.c program.o program.a)

# bash ä¸­æ‰§è¡Œ make
$ make
program.c
</code></pre> 
  </blockquote> 
  <p><strong>æ’åºå‡½æ•°: $(sort )</strong></p> 
  <p>åŠŸèƒ½: ç»™å­—ç¬¦ä¸² ä¸­çš„å•è¯æ’åº (å‡åº)</p> 
  <p>è¿”å›: æ’åºåçš„å­—ç¬¦ä¸²</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(sort bac abc acb cab)

# bash ä¸­æ‰§è¡Œ make
$ make
abc acb bac cab
</code></pre> 
  </blockquote> 
  <p><strong>å–å•è¯å‡½æ•°: $(word ,
    <text>
     )
    </text></strong></p> 
  <p>åŠŸèƒ½: å–å­—ç¬¦ä¸² 
   <text>
     ä¸­çš„ ç¬¬ä¸ªå•è¯ (nä»1å¼€å§‹)
   </text></p> 
  <p>è¿”å›: 
   <text>
     ä¸­çš„ç¬¬ä¸ªå•è¯, å¦‚æœ æ¯” 
    <text>
      ä¸­å•è¯ä¸ªæ•°è¦å¤§, åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²
    </text>
   </text></p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(word 1,aa bb cc dd)
    @echo $(word 5,aa bb cc dd)
    @echo $(word 4,aa bb cc dd)

# bash ä¸­æ‰§è¡Œ make
$ make
aa

dd
</code></pre> 
  </blockquote> 
  <p><strong>å–å•è¯ä¸²å‡½æ•°: $(wordlist <s>,,
     <text>
      )
     </text></s></strong></p> 
  <p>åŠŸèƒ½: ä»å­—ç¬¦ä¸²
   <text>
    ä¸­å–ä»
    <s>å¼€å§‹åˆ°çš„å•è¯ä¸². <s>å’Œæ˜¯ä¸€ä¸ªæ•°å­—.</s></s>
   </text></p> 
  <p>è¿”å›: ä»<s>åˆ°çš„å­—ç¬¦ä¸²</s></p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(wordlist 1,3,aa bb cc dd)
    @echo $(word 5,6,aa bb cc dd)
    @echo $(word 2,5,aa bb cc dd)


# bash ä¸­æ‰§è¡Œ make
$ make
aa bb cc

bb
</code></pre> 
  </blockquote> 
  <p><strong>å•è¯ä¸ªæ•°ç»Ÿè®¡å‡½æ•°: $(words 
    <text>
     )
    </text></strong></p> 
  <p>åŠŸèƒ½: ç»Ÿè®¡å­—ç¬¦ä¸² 
   <text>
     ä¸­å•è¯çš„ä¸ªæ•°
   </text></p> 
  <p>è¿”å›: å•è¯ä¸ªæ•°</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹

all:
    @echo $(words aa bb cc dd)
    @echo $(words aabbccdd)
    @echo $(words )

# bash ä¸­æ‰§è¡Œ make
$ make
4
1
0
</code></pre> 
  </blockquote> 
  <p><strong>é¦–å•è¯å‡½æ•°: $(firstword 
    <text>
     )
    </text></strong></p> 
  <p>åŠŸèƒ½: å–å­—ç¬¦ä¸² 
   <text>
     ä¸­çš„ç¬¬ä¸€ä¸ªå•è¯
   </text></p> 
  <p>è¿”å›: å­—ç¬¦ä¸² 
   <text>
     ä¸­çš„ç¬¬ä¸€ä¸ªå•è¯
   </text></p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(firstword aa bb cc dd)
    @echo $(firstword aabbccdd)
    @echo $(firstword )

# bash ä¸­æ‰§è¡Œ make
$ make
aa
aabbccdd
</code></pre> 
  </blockquote> 
  <h4><a id="342__1064"></a><strong>3.4.2 æ–‡ä»¶åå‡½æ•°</strong></h4> 
  <p><strong>å–ç›®å½•å‡½æ•°: $(dir &lt;namesâ€¦&gt;)</strong></p> 
  <p>åŠŸèƒ½: ä»æ–‡ä»¶ååºåˆ— ä¸­å–å‡ºç›®å½•éƒ¨åˆ†</p> 
  <p>è¿”å›: æ–‡ä»¶ååºåˆ— ä¸­çš„ç›®å½•éƒ¨åˆ†</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(dir /home/a.c ./bb.c ../c.c d.c)


# bash ä¸­æ‰§è¡Œ make
$ make
/home/ ./ ../ ./
</code></pre> 
  </blockquote> 
  <p><strong>å–æ–‡ä»¶å‡½æ•°: $(notdir &lt;namesâ€¦&gt;)</strong></p> 
  <p>åŠŸèƒ½: ä»æ–‡ä»¶ååºåˆ— ä¸­å–å‡ºéç›®å½•éƒ¨åˆ†</p> 
  <p>è¿”å›: æ–‡ä»¶ååºåˆ— ä¸­çš„éç›®å½•éƒ¨åˆ†</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(notdir /home/a.c ./bb.c ../c.c d.c)

# bash ä¸­æ‰§è¡Œ make
$ make
a.c bb.c c.c d.c
</code></pre> 
  </blockquote> 
  <p><strong>å–åç¼€å‡½æ•°: $(suffix &lt;namesâ€¦&gt;)</strong></p> 
  <p>åŠŸèƒ½: ä»æ–‡ä»¶ååºåˆ— ä¸­å–å‡ºå„ä¸ªæ–‡ä»¶åçš„åç¼€</p> 
  <p>è¿”å›: æ–‡ä»¶ååºåˆ— ä¸­å„ä¸ªæ–‡ä»¶åçš„åç¼€, æ²¡æœ‰åç¼€åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(suffix /home/a.c ./b.o ../c.a d)

# bash ä¸­æ‰§è¡Œ make
$ make
.c .o .a
</code></pre> 
  </blockquote> 
  <p><strong>å–å‰ç¼€å‡½æ•°: $(basename &lt;namesâ€¦&gt;)</strong></p> 
  <p>åŠŸèƒ½: ä»æ–‡ä»¶ååºåˆ— ä¸­å–å‡ºå„ä¸ªæ–‡ä»¶åçš„å‰ç¼€</p> 
  <p>è¿”å›: æ–‡ä»¶ååºåˆ— ä¸­å„ä¸ªæ–‡ä»¶åçš„å‰ç¼€, æ²¡æœ‰å‰ç¼€åˆ™è¿”å›ç©ºå­—ç¬¦ä¸²</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(basename /home/a.c ./b.o ../c.a /home/.d .e)


# bash ä¸­æ‰§è¡Œ make
$ make
/home/a ./b ../c /home/
</code></pre> 
  </blockquote> 
  <p><strong>åŠ åç¼€å‡½æ•°: $(addsuffix ,&lt;namesâ€¦&gt;)</strong></p> 
  <p>åŠŸèƒ½: æŠŠåç¼€ åŠ åˆ° ä¸­çš„æ¯ä¸ªå•è¯åé¢</p> 
  <p>è¿”å›: åŠ è¿‡åç¼€çš„æ–‡ä»¶ååºåˆ—</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(addsuffix .c,/home/a b ./c.o ../d.c)


# bash ä¸­æ‰§è¡Œ make
$ make
/home/a.c b.c ./c.o.c ../d.c.c
</code></pre> 
  </blockquote> 
  <p><strong>åŠ å‰ç¼€å‡½æ•°: $(addprefix ,&lt;namesâ€¦&gt;)</strong></p> 
  <p>åŠŸèƒ½: æŠŠå‰ç¼€ åŠ åˆ° ä¸­çš„æ¯ä¸ªå•è¯å‰é¢</p> 
  <p>è¿”å›: åŠ è¿‡å‰ç¼€çš„æ–‡ä»¶ååºåˆ—</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(addprefix test_,/home/a.c b.c ./d.c)

# bash ä¸­æ‰§è¡Œ make
$ make
test_/home/a.c test_b.c test_./d.c
</code></pre> 
  </blockquote> 
  <p><strong>è¿æ¥å‡½æ•°: $(join ,)</strong></p> 
  <p>åŠŸèƒ½: ä¸­å¯¹åº”çš„å•è¯åŠ åˆ° åé¢</p> 
  <p>è¿”å›: è¿æ¥åçš„å­—ç¬¦ä¸²</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    @echo $(join a b c d,1 2 3 4)
    @echo $(join a b c d,1 2 3 4 5)
    @echo $(join a b c d e,1 2 3 4)

# bash ä¸­æ‰§è¡Œ make
$ make
a1 b2 c3 d4
a1 b2 c3 d4 5
a1 b2 c3 d4 e
</code></pre> 
  </blockquote> 
  <h4><a id="343_foreach_1206"></a><strong>3.4.3 foreach</strong></h4> 
  <p><strong>è¯­æ³•:</strong></p> 
  <p>$(foreach <var>,,
    <text>
     )
    </text></var></p> 
  <p><strong>ç¤ºä¾‹:</strong></p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
targets := a b c d
objects := $(foreach i,$(targets),$(i).o)

all:
    @echo $(targets)
    @echo $(objects)

# bash ä¸­æ‰§è¡Œ make
$ make
a b c d
a.o b.o c.o d.o
</code></pre> 
  </blockquote> 
  <h4><a id="344_if_1232"></a><strong>3.4.4 if</strong></h4> 
  <p>è¿™é‡Œçš„ifæ˜¯ä¸ªå‡½æ•°, å’Œå‰é¢çš„æ¡ä»¶åˆ¤æ–­ä¸ä¸€æ ·, å‰é¢çš„æ¡ä»¶åˆ¤æ–­å±äºMakefileçš„å…³é”®å­—</p> 
  <p><strong>è¯­æ³•:</strong></p> 
  <p>$(if ,)</p> 
  <p>$(if ,,)</p> 
  <p><strong>ç¤ºä¾‹:</strong></p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
val := a
objects := $(if $(val),$(val).o,nothing)
no-objects := $(if $(no-val),$(val).o,nothing)

all:
    @echo $(objects)
    @echo $(no-objects)

# bash ä¸­æ‰§è¡Œ make
$ make
a.o
nothing
</code></pre> 
  </blockquote> 
  <h4><a id="345_call___1265"></a><strong>3.4.5 call - åˆ›å»ºæ–°çš„å‚æ•°åŒ–å‡½æ•°</strong></h4> 
  <p><strong>è¯­æ³•:</strong></p> 
  <p>$(call ,,,â€¦)</p> 
  <p><strong>ç¤ºä¾‹:</strong></p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
log = "====debug====" $(1) "====end===="

all:
    @echo $(call log,"æ­£åœ¨ Make")

# bash ä¸­æ‰§è¡Œ make
$ make
====debug==== æ­£åœ¨ Make ====end====
</code></pre> 
  </blockquote> 
  <h4><a id="346_origin___1288"></a><strong>3.4.6 origin - åˆ¤æ–­å˜é‡çš„æ¥æº</strong></h4> 
  <p><strong>è¯­æ³•:</strong></p> 
  <p>$(origin )</p> 
  <p>è¿”å›å€¼æœ‰å¦‚ä¸‹ç±»å‹:</p> 
  <table> 
   <thead> 
    <tr> 
     <th><strong>ç±»å‹</strong></th> 
     <th><strong>å«ä¹‰</strong></th> 
    </tr> 
   </thead> 
   <tbody> 
    <tr> 
     <td>undefined</td> 
     <td> æ²¡æœ‰å®šä¹‰è¿‡</td> 
    </tr> 
    <tr> 
     <td>default</td> 
     <td> æ˜¯ä¸ªé»˜è®¤çš„å®šä¹‰, æ¯”å¦‚ CC å˜é‡</td> 
    </tr> 
    <tr> 
     <td>environment</td> 
     <td> æ˜¯ä¸ªç¯å¢ƒå˜é‡, å¹¶ä¸” makeæ—¶æ²¡æœ‰ä½¿ç”¨ -e å‚æ•°</td> 
    </tr> 
    <tr> 
     <td>file</td> 
     <td> å®šä¹‰åœ¨Makefileä¸­</td> 
    </tr> 
    <tr> 
     <td>command line</td> 
     <td> å®šä¹‰åœ¨å‘½ä»¤è¡Œä¸­</td> 
    </tr> 
    <tr> 
     <td>override</td> 
     <td> è¢« override é‡æ–°å®šä¹‰è¿‡</td> 
    </tr> 
    <tr> 
     <td>automatic</td> 
     <td> æ˜¯è‡ªåŠ¨åŒ–å˜é‡</td> 
    </tr> 
   </tbody> 
  </table>
  <p><strong>ç¤ºä¾‹:</strong></p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
val-in-file := test-file
override val-override := test-override

all:
    @echo $(origin not-define)    # not-define æ²¡æœ‰å®šä¹‰
    @echo $(origin CC)            # CC æ˜¯Makefileé»˜è®¤å®šä¹‰çš„å˜é‡
    @echo $(origin PATH)         # PATH æ˜¯ bash ç¯å¢ƒå˜é‡
    @echo $(origin val-in-file)    # æ­¤Makefileä¸­å®šä¹‰çš„å˜é‡
    @echo $(origin val-in-cmd)    # è¿™ä¸ªå˜é‡ä¼šåŠ åœ¨ make çš„å‚æ•°ä¸­
    @echo $(origin val-override) # æ­¤Makefileä¸­å®šä¹‰çš„overrideå˜é‡
    @echo $(origin @)             # è‡ªåŠ¨å˜é‡, å…·ä½“å‰é¢çš„ä»‹ç»

# bash ä¸­æ‰§è¡Œ make
$ make val-in-cmd=val-cmd
undefined
default
environment
file
command line
override
automatic
</code></pre> 
  </blockquote> 
  <h4><a id="347_shell_1338"></a><strong>3.4.7 shell</strong></h4> 
  <p><strong>è¯­æ³•:</strong></p> 
  <p>$(shell )</p> 
  <p>å®ƒçš„ä½œç”¨å°±æ˜¯æ‰§è¡Œä¸€ä¸ªshellå‘½ä»¤, å¹¶å°†shellå‘½ä»¤çš„ç»“æœä½œä¸ºå‡½æ•°çš„è¿”å›.</p> 
  <p>ä½œç”¨å’Œ <code>&lt;shell command&gt;</code> ä¸€æ ·, <strong>`</strong> æ˜¯åå¼•å·</p> 
  <h4><a id="348_make__1350"></a><strong>3.4.8 make æ§åˆ¶å‡½æ•°</strong></h4> 
  <p><strong>äº§ç”Ÿä¸€ä¸ªè‡´å‘½é”™è¯¯: $(error &lt;text â€¦&gt;)</strong></p> 
  <p>åŠŸèƒ½: è¾“å‡ºé”™è¯¯ä¿¡æ¯, åœæ­¢Makefileçš„è¿è¡Œ</p> 
  <blockquote> 
   <pre><code class="prism language-makefile"># Makefile å†…å®¹
all:
    $(error there is an error!)
    @echo "è¿™é‡Œä¸ä¼šæ‰§è¡Œ!"

# bash ä¸­æ‰§è¡Œ make
$ make
Makefile:2: *** there is an error!.  Stop.
</code></pre> 
  </blockquote> 
  <p><strong>è¾“å‡ºè­¦å‘Š: $(warning &lt;text â€¦&gt;)</strong></p> 
  <p>åŠŸèƒ½: è¾“å‡ºè­¦å‘Šä¿¡æ¯, Makefileç»§ç»­è¿è¡Œ</p> 
  <p>æŒ‰ Ctrl+C å¤åˆ¶ä»£ç </p> 
  <p>æŒ‰ Ctrl+C å¤åˆ¶ä»£ç </p> 
  <h3><a id="35_MakefileGNU_1380"></a><strong>3.5 Makefileä¸­ä¸€äº›GNUçº¦å®šä¿—æˆçš„ä¼ªç›®æ ‡</strong></h3> 
  <p>å¦‚æœæœ‰è¿‡åœ¨Linuxä¸Š, ä»æºç å®‰è£…è½¯ä»¶çš„ç»å†çš„è¯, å°±ä¼šå¯¹ make clean, make install æ¯”è¾ƒç†Ÿæ‚‰.</p> 
  <p>åƒ clean, install è¿™äº›ä¼ªç›®æ ‡, å¹¿ä¸ºäººçŸ¥, ä¸ç”¨è§£é‡Šå°±å¤§å®¶çŸ¥é“æ˜¯ä»€ä¹ˆæ„æ€äº†.</p> 
  <p>ä¸‹é¢åˆ—ä¸¾ä¸€äº›å¸¸ç”¨çš„ä¼ªç›®æ ‡, å¦‚æœåœ¨è‡ªå·±é¡¹ç›®çš„Makefileåˆç†ä½¿ç”¨è¿™äº›ä¼ªç›®æ ‡çš„è¯, å¯ä»¥è®©æˆ‘ä»¬è‡ªå·±çš„Makefileçœ‹èµ·æ¥æ›´ä¸“ä¸š, å‘µå‘µ ğŸ˜ƒ</p> 
  <blockquote> 
   <table> 
    <thead> 
     <tr> 
      <th><strong>ä¼ªç›®æ ‡</strong></th> 
      <th><strong>å«ä¹‰</strong></th> 
     </tr> 
    </thead> 
    <tbody> 
     <tr> 
      <td>all</td> 
      <td>æ‰€æœ‰ç›®æ ‡çš„ç›®æ ‡ï¼Œå…¶åŠŸèƒ½ä¸€èˆ¬æ˜¯ç¼–è¯‘æ‰€æœ‰çš„ç›®æ ‡</td> 
     </tr> 
     <tr> 
      <td>clean</td> 
      <td>åˆ é™¤æ‰€æœ‰è¢«makeåˆ›å»ºçš„æ–‡ä»¶</td> 
     </tr> 
     <tr> 
      <td>install</td> 
      <td>å®‰è£…å·²ç¼–è¯‘å¥½çš„ç¨‹åºï¼Œå…¶å®å°±æ˜¯æŠŠç›®æ ‡å¯æ‰§è¡Œæ–‡ä»¶æ‹·è´åˆ°æŒ‡å®šçš„ç›®å½•ä¸­å»</td> 
     </tr> 
     <tr> 
      <td>print</td> 
      <td>åˆ—å‡ºæ”¹å˜è¿‡çš„æºæ–‡ä»¶</td> 
     </tr> 
     <tr> 
      <td>tar</td> 
      <td>æŠŠæºç¨‹åºæ‰“åŒ…å¤‡ä»½. ä¹Ÿå°±æ˜¯ä¸€ä¸ªtaræ–‡ä»¶</td> 
     </tr> 
     <tr> 
      <td>dist</td> 
      <td>åˆ›å»ºä¸€ä¸ªå‹ç¼©æ–‡ä»¶, ä¸€èˆ¬æ˜¯æŠŠtaræ–‡ä»¶å‹æˆZæ–‡ä»¶. æˆ–æ˜¯gzæ–‡ä»¶</td> 
     </tr> 
     <tr> 
      <td>TAGS</td> 
      <td>æ›´æ–°æ‰€æœ‰çš„ç›®æ ‡, ä»¥å¤‡å®Œæ•´åœ°é‡ç¼–è¯‘ä½¿ç”¨</td> 
     </tr> 
     <tr> 
      <td>check æˆ– test</td> 
      <td>ä¸€èˆ¬ç”¨æ¥æµ‹è¯•makefileçš„æµç¨‹</td> 
     </tr> 
    </tbody> 
   </table>
  </blockquote> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-258a4616f7.css" rel="stylesheet"> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="æŸšå­ç¤¾åŒº">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>æœ€æ–°èµ„è®¯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">é‚®ç®±</a>
    
    <a href="https://uzshare.com" target="_blank">æŸšå­ç¤¾åŒº</a>
    
    <a href="https://uzzz.org" target="_blank">æ‰¾ç»„ç»‡</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">æœ€æ–°</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[åŸåˆ›è½¯ä»¶] [è½¯ä»¶å‘å¸ƒ] å®šæ—¶å¤‡ä»½æ–‡ä»¶å‘é€é‚®ç®±ï¼Œä¸å†æ€•æ•°æ®ä¸¢å¤±äº†</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Getæ™ºèƒ½å†™ä½œæ»¡æœˆè®° â€”â€”äº§å“ç¯‡</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">ã€Šæ·±åº¦æ¢ç´¢C++å¯¹è±¡æ¨¡å‹ã€‹..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql å¤šè¡¨è”æŸ¥ä¹‹è¿æ¥æŸ¥è¯¢</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golangåŸºç¡€(äºŒ)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">ä»Šæ—¥ä»½çš„PTAåˆ·é¢˜</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Androidä¹‹æŠ˜çº¿å›¾</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Androidä¹‹å®ç°é€‰ä¸­æ—¶æ”¹å˜æ ·å¼</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">ç›®å½•</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
