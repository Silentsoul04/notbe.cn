<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>逻辑回归初步 « NotBeCN</title>
  <meta name="description" content="                     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;       ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2019/05/12/qq_45013278_90138116.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">逻辑回归初步</h1>
    <p class="post-meta">May 12, 2019</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-light"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <div class="markdown_views prism-tomorrow-night" id="content_views">
   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
   <!-- flowchart &#31661;&#22836;&#22270;&#26631; &#21247;&#21024; -->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
   <div class="htmledit_views" id="content_views">
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    <p><span><br></span></p>
    <h2><a></a><a target="_blank"></a><span>1、总述</span></h2>
    <p><span>逻辑回归是应用非常广泛的一个分类机器学习算法，它将数据拟合到一个logit函数(或者叫做logistic函数)中，从而能够完成对事件发生的概率进行预测。</span></p>
    <h2><a></a><a target="_blank"></a><span>2、由来</span></h2>
    <p><span>&nbsp;&nbsp;&nbsp;&nbsp;要说逻辑回归，我们得追溯到线性回归，想必大家对线性回归都有一定的了解，即对于多维空间中存在的样本点，我们用特征的线性组合去拟合空间中点的分布和轨迹。如下图所示：</span></p>
    <p><span><img width="450" height="360" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014123301565?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
    <p><span>&nbsp;&nbsp;&nbsp;&nbsp;线性回归能对连续值结果进行预测，而现实生活中常见的另外一类问题是，分类问题。最简单的情况是是与否的二分类问题。比如说医生需要判断病人是否生病，银行要判断一个人的信用程度是否达到可以给他发信用卡的程度，邮件收件箱要自动对邮件分类为正常邮件和垃圾邮件等等。<br></span></p>
   </div>
   <p>如果你觉得这篇文章看起来稍微还有些吃力，或者想要系统地学习人工智能，那么推荐你去看床长人工智能教程。非常棒的大神之作，教程不仅通俗易懂，而且很风趣幽默。点击<a href="http://www.captainbed.net/csdn" rel="nofollow" target="_blank">这里</a>可以查看教程。</p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;当然，我们最直接的想法是，既然能够用线性回归预测出连续值结果，那根据结果设定一个阈值是不是就可以解决这个问题了呢？事实是，对于很标准的情况，确实可以的，这里我们套用Andrew Ng老师的课件中的例子，下图中X为数据点肿瘤的大小，Y为观测结果是否是恶性肿瘤。通过构建线性回归模型，如hθ(x)所示，构建线性回归模型后，我们设定一个阈值0.5，预测hθ(x)≥0.5的这些点为恶性肿瘤，而hθ(x)&lt;0.5为良性肿瘤。</span></p>
   <p><span><img width="380" height="150" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014123518573?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;但很多实际的情况下，我们需要学习的分类数据并没有这么精准，比如说上述例子中突然有一个不按套路出牌的数据点出现，如下图所示：<br></span></p>
   <p><span><img width="363" height="175" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014123606004?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;你看，现在你再设定0.5，这个判定阈值就失效了，而现实生活的分类问题的数据，会比例子中这个更为复杂，而这个时候我们借助于线性回归+阈值的方式，已经很难完成一个鲁棒性很好的分类器了。</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;在这样的场景下，逻辑回归就诞生了。它的核心思想是，如果线性回归的结果输出是一个连续值，而值的范围是无法限定的，那我们有没有办法把这个结果值映射为可以帮助我们判断的结果呢。而如果输出结果是 (0,1) 的一个概率值，这个问题就很清楚了。我们在数学上找了一圈，还真就找着这样一个简单的函数了，就是很神奇的sigmoid函数(如下)：</span></p>
   <p><img width="150" height="65" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014123727818?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"></p>
   <p></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;如果把sigmoid函数图像画出来，是如下的样子：</span></p>
   <p><span><img width="400" height="260" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014124034991?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>Sigmoid Logistic Function</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;从函数图上可以看出，函数y=g(z)在z=0的时候取值为1/2，而随着z逐渐变小，函数值趋于0，z逐渐变大的同时函数值逐渐趋于1，而这正是一个概率的范围。</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;所以我们定义线性回归的预测函数为Y=W<sup>T</sup>X，那么逻辑回归的输出Y=&nbsp;g(W<sup>T</sup>X)，其中y=g(z)函数正是上述sigmoid函数(或者简单叫做S形函数)。<br></span></p>
   <p><span><br></span></p>
   <h2><a></a><a target="_blank"></a><span>3、判定边界</span></h2>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;我们现在再来看看，为什么逻辑回归能够解决分类问题。这里引入一个概念，叫做判定边界，可以理解为是用以对不同类别的数据分割的边界，边界的两旁应该是不同类别的数据。<br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;从二维直角坐标系中，举几个例子，大概是如下这个样子：<br></span></p>
   <p><img width="460" height="350" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014124124641?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;有时候是这个样子：<br></span></p>
   <p><span><img width="469" height="370" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014124156527?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;甚至可能是这个样子：<br></span></p>
   <p><span><img width="460" height="360" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014124241795?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;上述三幅图中的红绿样本点为不同类别的样本，而我们划出的线，不管是直线、圆或者是曲线，都能比较好地将图中的两类样本分割开来。这就是我们的判定边界，下面我们来看看，逻辑回归是如何根据样本点获得这些判定边界的。<br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;我们依旧借用Andrew Ng教授的课程中部分例子来讲述这个问题。<br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;回到sigmoid函数，我们发现： &nbsp;</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当<span id="MathJax-Element-18-Frame"><span id="MathJax-Span-242"><span id="MathJax-Span-243"><span id="MathJax-Span-244">g</span><span id="MathJax-Span-245">(</span><span id="MathJax-Span-246">z</span><span id="MathJax-Span-247">)</span><span id="MathJax-Span-248">≥</span><span id="MathJax-Span-249">0.5</span></span></span></span>时,&nbsp;<span id="MathJax-Element-19-Frame"><span id="MathJax-Span-250"><span id="MathJax-Span-251"><span id="MathJax-Span-252">z</span><span id="MathJax-Span-253">≥</span><span id="MathJax-Span-254">0</span></span></span></span>;</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;对于<span id="MathJax-Element-20-Frame"><span id="MathJax-Span-255"><span id="MathJax-Span-256"><span id="MathJax-Span-257"><span id="MathJax-Span-258">h</span></span></span><span id="MathJax-Span-259">θ</span></span></span><span id="MathJax-Span-260">(</span><span id="MathJax-Span-261">x</span><span id="MathJax-Span-262">)</span><span id="MathJax-Span-263">=</span><span id="MathJax-Span-264">g</span><span id="MathJax-Span-265">(</span><span id="MathJax-Span-266"><span id="MathJax-Span-267"></span></span><span><span>θ</span></span><sup>T</sup><span>X</span><span id="MathJax-Span-269"></span><span id="MathJax-Span-270">)</span><span id="MathJax-Span-271">≥</span><span id="MathJax-Span-272">0.5</span>, 则<span id="MathJax-Element-21-Frame"><span id="MathJax-Span-273"><span id="MathJax-Span-274"><span id="MathJax-Span-275"><span id="MathJax-Span-276"></span></span></span></span></span><span><span>θ</span></span><sup>T</sup><span>X</span><span id="MathJax-Span-278"></span><span id="MathJax-Span-279">≥</span><span id="MathJax-Span-280">0</span>, 此时意味着预估y=1;</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;反之，当预测y = 0时，<span id="MathJax-Element-22-Frame"><span id="MathJax-Span-281"><span id="MathJax-Span-282"><span id="MathJax-Span-283"><span id="MathJax-Span-284"></span></span></span></span></span><span><span>θ</span></span><sup>T</sup><span>X</span><span id="MathJax-Span-286"></span><span id="MathJax-Span-287">&lt;</span><span id="MathJax-Span-288">0</span>;</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;所以我们认为<span><span>θ</span></span><sup>T</sup>X =0是一个决策边界，当它大于0或小于0时，逻辑回归模型分别预测不同的分类结果。</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;先看第一个例子<span id="MathJax-Span-296"><span id="MathJax-Span-297"><span id="MathJax-Span-298">h</span></span></span><span id="MathJax-Span-299">θ</span><span id="MathJax-Span-300">(</span><span id="MathJax-Span-301">x</span><span id="MathJax-Span-302">)</span><span id="MathJax-Span-303">=</span><span id="MathJax-Span-304">g</span><span id="MathJax-Span-305">(</span></span><span>θ</span><sub>0</sub><span>+θ</span><sub>1</sub><span>X</span><sub>1</sub><span>+θ</span><sub>2</sub><span>X</span><sub>2</sub><span id="MathJax-Span-323">)</span><span>，其中</span><span id="MathJax-Element-25-Frame"><span id="MathJax-Span-324"><span id="MathJax-Span-325"><span id="MathJax-Span-326"><span id="MathJax-Span-327"></span></span></span></span></span><span>θ</span><sub>0 ,</sub><span>θ</span><sub>1 ,</sub><span>θ</span><sub>2</sub><span>分别取-3, 1, 1。则当</span><span>−3+X<sub>1</sub>+X<sub>2</sub></span><span id="MathJax-Span-349">≥</span><span id="MathJax-Span-350">0</span><span>时, y = 1; 则</span><span id="MathJax-Span-353"><span id="MathJax-Span-354"></span></span><span>X</span><sub>1</sub><span>+X</span><sub>2</sub><span id="MathJax-Span-359"></span><span id="MathJax-Span-363">=</span><span id="MathJax-Span-364">3</span><span>是一个决策边界，图形表示如下，刚好把图上的两类点区分开来：</span></p>
   <p><img alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014124638710?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;例1只是一个线性的决策边界，当<span id="MathJax-Element-28-Frame"><span id="MathJax-Span-365"><span id="MathJax-Span-366"><span id="MathJax-Span-367"><span id="MathJax-Span-368">h</span></span></span><span id="MathJax-Span-369">θ</span></span></span><span id="MathJax-Span-370">(</span><span id="MathJax-Span-371">x</span><span id="MathJax-Span-372">)</span>更复杂的时候，我们可以得到非线性的决策边界，例如：</span></p>
   <p><img width="225" height="93" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014124838937?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;这时当</span><span>x</span><sub>1</sub><sup>2</sup><span>+x</span><sub>2</sub><sup>2</sup><span>≥1</span><span>时，我们判定y=1，这时的决策边界是一个圆形，如下图所示：</span></p>
   <p><img alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014124912098?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;所以我们发现，理论上说，只要我们的<span><span><span><span><span>h</span></span></span><span>θ</span></span></span><span>(</span><span>x</span><span>)</span>设计足够合理，准确的说是<span>g</span><span>(</span><span><span>θ</span></span><span id="MathJax-Span-268">T</span><span>x</span><span>)中<span><span>θ</span></span></span><span>T</span><span>x</span>足够复杂，我们能在不同的情形下，拟合出不同的判定边界，从而把不同的样本点分隔开来。</span></p>
   <h2><a></a><a target="_blank"></a><span>4、代价函数与梯度下降</span></h2>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;我们通过对判定边界的说明，知道会有合适的参数θ使得<span><span>θ</span></span><span>T</span><span>x=0成为很好的分类判定边界，那么问题就来了，我们如何判定我们的参数θ是否合适，有多合适呢？更进一步，我们有没有办法去求得这样的合适参数θ呢？</span></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;这就是我们要提到的代价函数与梯度下降了。<br></span></p>
   <p></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;所谓的代价函数Cost Function，其实是一种衡量我们在这组参数下预估的结果和实际结果差距的函数，比如说线性回归的代价函数定义为:</span></p>
   <p><img width="242" height="71" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014125116151?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></p>
   <p><span>当然我们可以和线性回归类比得到一个代价函数，实际就是上述公式中<span id="MathJax-Span-577"><span id="MathJax-Span-578">h</span></span><span id="MathJax-Span-579">θ</span><span id="MathJax-Span-580">(</span><span id="MathJax-Span-581">x</span><span id="MathJax-Span-582">)取为逻辑回归中的<span>g</span><span>(</span><span><span>θ</span></span></span><span>T</span><span>x</span><span>)</span>，但是这会引发代价函数为“非凸”函数的问题，简单一点说就是这个函数有很多个局部最低点，如下图所示：</span></p>
   <p><span><img alt="非凸函数-我爱公开课-52opencourse.com" src="http://52opencourse.com/?qa=blob&amp;qa_blobid=607435295049781725"></span></p>
   <p><span>而我们希望我们的代价函数是一个如下图所示，碗状结构的凸函数，这样我们算法求解到局部最低点，就一定是全局最小值点。</span></p>
   <p><span><img alt="凸函数-我爱公开课-52opencouse.com" src="http://52opencourse.com/?qa=blob&amp;qa_blobid=847516551720124317"></span></p>
   <p><span>&nbsp; &nbsp; &nbsp; 因此，上述的Cost Function对于逻辑回归是不可行的，我们需要其他形式的Cost Function来保证逻辑回归的成本函数是凸函数。</span></p>
   <p><span>&nbsp; &nbsp; &nbsp; 我们跳过大量的数学推导，直接出结论了，我们找到了一个适合逻辑回归的代价函数:</span></p>
   <p><img width="420" height="77" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014130511356?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></p>
   <p><span>&nbsp; &nbsp; &nbsp; Andrew Ng老师解释了一下这个代价函数的合理性，我们首先看当y=1的情况：</span></p>
   <p><span><img width="260" height="250" alt="对数似然损失函数解释1-我爱公开课-52opencouse.com" src="http://52opencourse.com/?qa=blob&amp;qa_blobid=7499905772199633281"></span></p>
   <p><span>&nbsp; &nbsp; &nbsp; &nbsp;如果我们的类别y = 1, 而判定的<span id="MathJax-Element-43-Frame"><span id="MathJax-Span-712"><span id="MathJax-Span-713"><span id="MathJax-Span-714"><span id="MathJax-Span-715">h</span></span></span><span id="MathJax-Span-716">θ</span></span></span><span id="MathJax-Span-717">(</span><span id="MathJax-Span-718">x</span><span id="MathJax-Span-719">)</span><span id="MathJax-Span-720">=</span><span id="MathJax-Span-721">1</span>，则Cost = 0，此时预测的值和真实的值完全相等，代价本该为0；而如果判断<span id="MathJax-Span-724"><span id="MathJax-Span-725">h</span></span><span id="MathJax-Span-726">θ</span><span id="MathJax-Span-727">(</span><span id="MathJax-Span-728">x</span><span id="MathJax-Span-729">)</span><span id="MathJax-Span-730">→</span><span id="MathJax-Span-731">0</span>，代价-&gt;∞，这很好地惩罚了最后的结果。</span></p>
   <p><span>&nbsp; &nbsp; &nbsp; &nbsp;而对于y=0的情况，如下图所示，也同样合理：</span></p>
   <p><span><img width="260" height="250" alt="对数似然损失函数解释2-我爱公开课-52opencourse.com" src="http://52opencourse.com/?qa=blob&amp;qa_blobid=16991899942735763470"></span></p>
   <p><span>&nbsp; &nbsp; &nbsp; &nbsp;下面我们说说梯度下降，梯度下降算法是调整参数θ使得代价函数J(θ)取得最小值的最基本方法之一。从直观上理解，就是我们在碗状结构的凸函数上取一个初始值，然后挪动这个值一步步靠近最低点的过程，如下图所示：</span></p>
   <p><span><img width="350" height="350" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014125344499?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
   <p><span><br></span></p>
   <p><span>&nbsp; &nbsp; &nbsp; 我们先简化一下逻辑回归的代价函数：</span></p>
   <p><span><img width="500" height="100" alt="逻辑回归代价函数简化公式-我爱公开课-52opencourse.com" src="http://52opencourse.com/?qa=blob&amp;qa_blobid=4662816715826976375"></span></p>
   <p><span>&nbsp; &nbsp; &nbsp; &nbsp;从数学上理解，我们为了找到最小值点，就应该朝着下降速度最快的方向(导函数/偏导方向)迈进，每次迈进一小步，再看看此时的下降最快方向是哪，再朝着这个方向迈进，直至最低点。</span></p>
   <p><span>&nbsp; &nbsp; &nbsp; &nbsp;用迭代公式表示出来的最小化<span id="MathJax-Element-52-Frame"><span id="MathJax-Span-794"><span id="MathJax-Span-795"><span id="MathJax-Span-796">J</span></span><span id="MathJax-Span-797">(</span><span id="MathJax-Span-798">θ</span></span><span id="MathJax-Span-799">)</span></span>的梯度下降算法如下：</span></p>
   <p><span><img width="414" height="163" alt="逻辑回归梯度下降算法-我爱公开课-52opencourse.com" src="http://52opencourse.com/?qa=blob&amp;qa_blobid=5185913255970284499"></span></p>
   <p><span><img width="421" height="147" alt="梯度下降算法-我爱公开课-52opencourse.com" src="http://52opencourse.com/?qa=blob&amp;qa_blobid=14303327028035669672"></span></p>
   <h2><a></a><a target="_blank"></a><span>5、代码与实现</span><br></h2>
   <p><span>&nbsp; &nbsp; 我们来一起看两个具体数据上做逻辑回归分类的例子，其中一份数据为线性判定边界，另一份为非线性。</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;示例1。</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;第一份数据为data1.txt，部分内容如下：<br></span></p>
   <p><span><img width="200" height="260" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014125459234?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;我们先来看看数据在空间的分布，代码如下。</span></p>
   <p><span></span></p>
   <pre class="prettyprint"><code class="language-python hljs has-numbering"></code>
    <ol class="hljs-ln">
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-keyword">from</span> numpy 
        <span class="hljs-keyword">import</span> loadtxt, where
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-keyword">from</span> pylab 
        <span class="hljs-keyword">import</span> scatter, show, legend, xlabel, ylabel
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line"> 
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-comment">#load the dataset</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        data = loadtxt(
        <span class="hljs-string">'/home/HanXiaoyang/data/data1.txt'</span>, delimiter=
        <span class="hljs-string">','</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line"> 
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        X = data[:, 
        <span class="hljs-number">0</span>:
        <span class="hljs-number">2</span>]
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        y = data[:, 
        <span class="hljs-number">2</span>]
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line"> 
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        pos = where(y == 
        <span class="hljs-number">1</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        neg = where(y == 
        <span class="hljs-number">0</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        scatter(X[pos, 
        <span class="hljs-number">0</span>], X[pos, 
        <span class="hljs-number">1</span>], marker=
        <span class="hljs-string">'o'</span>, c=
        <span class="hljs-string">'b'</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        scatter(X[neg, 
        <span class="hljs-number">0</span>], X[neg, 
        <span class="hljs-number">1</span>], marker=
        <span class="hljs-string">'x'</span>, c=
        <span class="hljs-string">'r'</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        xlabel(
        <span class="hljs-string">'Feature1/Exam 1 score'</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        ylabel(
        <span class="hljs-string">'Feature2/Exam 2 score'</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        legend([
        <span class="hljs-string">'Fail'</span>, 
        <span class="hljs-string">'Pass'</span>])
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        show()
       </div>
      </div></li>
    </ol>
    <div class="hljs-button signin"></div>
    <ul class="pre-numbering">
     <li>1</li>
    </ul></pre>
   <br>
   <br>
   <p></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;得到的结果如下：</span></p>
   <p><span><img width="450" height="350" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014125551129?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;下面我们写好计算sigmoid函数、代价函数、和梯度下降的程序：</span></p>
   <p><span></span></p>
   <pre class="prettyprint"><code class="language-python hljs has-numbering"></code>
    <ol class="hljs-ln">
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sigmoid</span><span class="hljs-params">(X)</span>:</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-string">'''Compute sigmoid function '''</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;den =
        <span class="hljs-number">1.0</span>+ e **(
        <span class="hljs-number">-1.0</span>* X)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;gz =
        <span class="hljs-number">1.0</span>/ den
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">return</span> gz
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compute_cost</span><span class="hljs-params">(theta,X,y)</span>:</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-string">'''computes cost given predicted and actual values'''</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;m = X.shape[
        <span class="hljs-number">0</span>]
        <span class="hljs-comment">#number of training examples</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;theta = reshape(theta,(len(theta),
        <span class="hljs-number">1</span>))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;J =(
        <span class="hljs-number">1.</span>/m)*(-transpose(y).dot(log(sigmoid(X.dot(theta))))- transpose(
        <span class="hljs-number">1</span>-y).dot(log(
        <span class="hljs-number">1</span>-sigmoid(X.dot(theta)))))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;grad = transpose((
        <span class="hljs-number">1.</span>/m)*transpose(sigmoid(X.dot(theta))- y).dot(X))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-comment">#optimize.fmin expects a single value, so cannot return grad</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">return</span> J[
        <span class="hljs-number">0</span>][
        <span class="hljs-number">0</span>]
        <span class="hljs-comment">#,grad</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compute_grad</span><span class="hljs-params">(theta, X, y)</span>:</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-string">'''compute gradient'''</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;theta.shape =(
        <span class="hljs-number">1</span>,
        <span class="hljs-number">3</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;grad = zeros(
        <span class="hljs-number">3</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;h = sigmoid(X.dot(theta.T))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;delta = h - y
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;l = grad.size
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">for</span> i 
        <span class="hljs-keyword">in</span> range(l):
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp;sumdelta = delta.T.dot(X[:, i])
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp;grad[i]=(
        <span class="hljs-number">1.0</span>/ m)* sumdelta *
        <span class="hljs-number">-1</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;theta.shape =(
        <span class="hljs-number">3</span>,)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">return</span> &nbsp;grad
       </div>
      </div></li>
    </ol>
    <div class="hljs-button signin"></div>
    <ul class="pre-numbering">
     <li>1</li>
    </ul></pre>
   <br>
   <br>
   <p></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;我们用梯度下降算法得到的结果判定边界是如下的样子：<br></span></p>
   <p><span><img width="450" height="346" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014125624067?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;最后我们使用我们的判定边界对training data做一个预测，然后比对一下准确率：</span></p>
   <p><span></span></p>
   <pre class="prettyprint"><code class="language-python hljs has-numbering"></code>
    <ol class="hljs-ln">
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">predict</span><span class="hljs-params">(theta, X)</span>:</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-string">'''Predict label using learned logistic regression parameters'''</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;m, n = X.shape
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;p = zeros(shape=(m,
        <span class="hljs-number">1</span>))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;h = sigmoid(X.dot(theta.T))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">for</span> it 
        <span class="hljs-keyword">in</span> range(
        <span class="hljs-number">0</span>, h.shape[
        <span class="hljs-number">0</span>]):
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp;
        <span class="hljs-keyword">if</span> h[it]&gt;
        <span class="hljs-number">0.5</span>:
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p[it,
        <span class="hljs-number">0</span>]=
        <span class="hljs-number">1</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp;
        <span class="hljs-keyword">else</span>:
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p[it,
        <span class="hljs-number">0</span>]=
        <span class="hljs-number">0</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">return</span> p
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-comment">#Compute accuracy on our training set</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        p = predict(array(theta), it)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-keyword">print</span>
        <span class="hljs-string">'Train Accuracy: %f'</span>%((y[where(p == y)].size / float(y.size))*
        <span class="hljs-number">100.0</span>)
       </div>
      </div></li>
    </ol>
    <div class="hljs-button signin"></div>
    <ul class="pre-numbering">
     <li>1</li>
    </ul></pre>
   <p></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;计算出来的结果是89.2%</span></p>
   <p><span><br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;示例2.</span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;第二份数据为data2.txt，部分内容如下：</span></p>
   <p><span><img width="145" height="340" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014125654926?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;我们同样把数据的分布画出来，如下：<br></span></p>
   <p><span><img width="450" height="315" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014125725759?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;我们发现在这个例子中，我们没有办法再用一条直线把两类样本点近似分开了，所以我们打算试试多项式的判定边界，那么我们先要对给定的两个feature做一个多项式特征的映射。比如说，我们做了如下的一个映射：<br></span></p>
   <p><span><img width="270" height="240" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014125802837?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>&nbsp;&nbsp;&nbsp;&nbsp;代码如下：</span></p>
   <p><span></span></p>
   <pre class="prettyprint"><code class="language-python hljs has-numbering"></code>
    <ol class="hljs-ln">
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">map_feature</span><span class="hljs-params">(x1, x2)</span>:</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-string"><span class="hljs-string">'''</span></span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-string"> &nbsp; &nbsp;Maps the two input features to polonomial features.</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-string"> &nbsp; &nbsp;Returns a new feature array with more features of</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-string"> &nbsp; &nbsp;X1, X2, X1 ** 2, X2 ** 2, X1*X2, X1*X2 ** 2, etc...</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-string"> &nbsp; &nbsp;'''</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;x1.shape =(x1.size,
        <span class="hljs-number">1</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;x2.shape =(x2.size,
        <span class="hljs-number">1</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;degree =
        <span class="hljs-number">6</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;mapped_fea = ones(shape=(x1[:,
        <span class="hljs-number">0</span>].size,
        <span class="hljs-number">1</span>))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;m, n = mapped_fea.shape
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">for</span> i 
        <span class="hljs-keyword">in</span> range(
        <span class="hljs-number">1</span>, degree +
        <span class="hljs-number">1</span>):
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp;
        <span class="hljs-keyword">for</span> j 
        <span class="hljs-keyword">in</span> range(i +
        <span class="hljs-number">1</span>):
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;r =(x1 **(i - j))*(x2 ** j)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mapped_fea = append(
        <span>mapped_fea</span>
        <span>, r, axis=<span class="hljs-number">1</span>)</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">return</span> mapped_fea
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        mapped_fea = map_feature(X[:,
        <span class="hljs-number">0</span>], X[:,
        <span class="hljs-number">1</span>])
       </div>
      </div></li>
    </ol>
    <div class="hljs-button signin"></div>
    <ul class="pre-numbering">
     <li>1</li>
    </ul></pre>
   <p></p>
   <p><span>&nbsp; &nbsp; &nbsp; 接着做梯度下降：</span></p>
   <p><span></span></p>
   <pre class="prettyprint"><code class="language-python hljs has-numbering"></code>
    <ol class="hljs-ln">
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">cost_function_reg</span><span class="hljs-params">(theta, X, y, l)</span>:</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-string"><span class="hljs-string">'''Compute the cost and partial derivatives as grads</span></span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-string"> &nbsp; &nbsp;'''</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;h = sigmoid(X.dot(theta))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;thetaR = theta[
        <span class="hljs-number">1</span>:,
        <span class="hljs-number">0</span>]
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;J =(
        <span class="hljs-number">1.0</span>/ m)*((-y.T.dot(log(h)))-((
        <span class="hljs-number">1</span>- y.T).dot(log(
        <span class="hljs-number">1.0</span>- h)))) \
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;+(l /(
        <span class="hljs-number">2.0</span>* m))*(thetaR.T.dot(thetaR))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;delta = h - y
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;sum_delta = delta.T.dot(X[:,
        <span class="hljs-number">1</span>])
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;grad1 =(
        <span class="hljs-number">1.0</span>/ m)* sumdelta
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;XR = X[:,
        <span class="hljs-number">1</span>:X.shape[
        <span class="hljs-number">1</span>]]
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;sum_delta = delta.T.dot(XR)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;grad =(
        <span class="hljs-number">1.0</span>/ m)*(sum_delta + l * thetaR)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;out = zeros(shape=(grad.shape[
        <span class="hljs-number">0</span>], grad.shape[
        <span class="hljs-number">1</span>]+
        <span class="hljs-number">1</span>))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;out[:,
        <span class="hljs-number">0</span>]= grad1
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;out[:,
        <span class="hljs-number">1</span>:]= grad
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">return</span> J.flatten(), out.T.flatten()
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        m, n = X.shape
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        y.shape =(m,
        <span class="hljs-number">1</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        it = map_feature(X[:,
        <span class="hljs-number">0</span>], X[:,
        <span class="hljs-number">1</span>])
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-comment">#Initialize theta parameters</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        initial_theta = zeros(shape=(it.shape[
        <span class="hljs-number">1</span>],
        <span class="hljs-number">1</span>))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-comment">#Use regularization and set parameter lambda to 1</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        l =
        <span class="hljs-number">1</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-comment"># Compute and display initial cost and gradient for regularized logistic</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-comment"># regression</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        cost, grad = cost_function_reg(initial_theta, it, y, l)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decorated_cost</span><span class="hljs-params">(theta)</span>:</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">return</span> cost_function_reg(theta, it, y, l)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-keyword">print</span> fmin_bfgs(decorated_cost, initial_theta, maxfun=
        <span class="hljs-number">500</span>)
       </div>
      </div></li>
    </ol>
    <div class="hljs-button signin"></div>
    <ul class="pre-numbering">
     <li>1</li>
    </ul></pre>
   <p></p>
   <p><span>&nbsp; &nbsp; &nbsp; 接着在数据点上画出判定边界：</span></p>
   <p><span></span></p>
   <pre class="prettyprint"><code class="language-python hljs has-numbering"></code>
    <ol class="hljs-ln">
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-comment">#Plot Boundary</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        u = linspace(
        <span class="hljs-number">-1</span>,
        <span class="hljs-number">1.5</span>,
        <span class="hljs-number">50</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        v = linspace(
        <span class="hljs-number">-1</span>,
        <span class="hljs-number">1.5</span>,
        <span class="hljs-number">50</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        z = zeros(shape=(len(u), len(v)))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-keyword">for</span> i 
        <span class="hljs-keyword">in</span> range(len(u)):
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">for</span> j 
        <span class="hljs-keyword">in</span> range(len(v)):
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp;z[i, j]=(map_feature(array(u[i]), array(v[j])).dot(array(theta)))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        z = z.T
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        contour(u, v, z)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        title(
        <span class="hljs-string">'lambda = %f'</span>% l)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        xlabel(
        <span class="hljs-string">'Microchip Test 1'</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        ylabel(
        <span class="hljs-string">'Microchip Test 2'</span>)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        legend([
        <span class="hljs-string">'y = 1'</span>,
        <span class="hljs-string">'y = 0'</span>,
        <span class="hljs-string">'Decision boundary'</span>])
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        show()
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">predict</span><span class="hljs-params">(theta, X)</span>:</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-string"><span class="hljs-string">'''Predict whether the label</span></span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-string"> &nbsp; &nbsp;is 0 or 1 using learned logistic</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-string"> &nbsp; &nbsp;regression parameters '''</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;m, n = X.shape
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;p = zeros(shape=(m,
        <span class="hljs-number">1</span>))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;h = sigmoid(X.dot(theta.T))
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">for</span> it 
        <span class="hljs-keyword">in</span> range(
        <span class="hljs-number">0</span>, h.shape[
        <span class="hljs-number">0</span>]):
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp;
        <span class="hljs-keyword">if</span> h[it]&gt;
        <span class="hljs-number">0.5</span>:
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p[it,
        <span class="hljs-number">0</span>]=
        <span class="hljs-number">1</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp;
        <span class="hljs-keyword">else</span>:
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;p[it,
        <span class="hljs-number">0</span>]=
        <span class="hljs-number">0</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
         &nbsp; &nbsp;
        <span class="hljs-keyword">return</span> p
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-comment">#% Compute accuracy on our training set</span>
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        p = predict(array(theta), it)
       </div>
      </div></li>
     <li>
      <div class="hljs-ln-numbers">
       <div class="hljs-ln-line hljs-ln-n"></div>
      </div>
      <div class="hljs-ln-code">
       <div class="hljs-ln-line">
        <span class="hljs-keyword">print</span>
        <span class="hljs-string">'Train Accuracy: %f'</span>%((y[where(p == y)].size / float(y.size))*
        <span class="hljs-number">100.0</span>)
       </div>
      </div></li>
    </ol>
    <div class="hljs-button signin"></div>
    <ul class="pre-numbering">
     <li>1</li>
    </ul></pre>
   <p></p>
   <p><span>&nbsp; &nbsp; &nbsp; &nbsp;得到的结果如下图所示：</span></p>
   <p><span><img width="450" height="360" alt="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20151014125838349?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center"><br></span></p>
   <p><span>&nbsp; &nbsp; &nbsp; &nbsp;我们发现我们得到的这条曲线确实将两类点区分开来了。</span></p>
   <h2><a></a><a target="_blank"></a><span>6、总结</span></h2>
   <p><span>&nbsp; &nbsp; &nbsp; &nbsp;最后我们总结一下逻辑回归。它始于输出结果为有实际意义的连续值的线性回归，但是线性回归对于分类的问题没有办法准确而又具备鲁棒性地分割，因此我们设计出了逻辑回归这样一个算法，它的输出结果表征了某个样本属于某类别的概率。</span></p>
   <p><span>&nbsp; &nbsp; &nbsp; &nbsp;逻辑回归的成功之处在于，将原本输出结果范围可以非常大的<span>θ</span><sup>T</sup>X&nbsp;通过sigmoid函数映射到(0,1)，从而完成概率的估测。</span></p>
   <p><span><span>&nbsp; &nbsp; &nbsp; &nbsp; 而直观地在二维空间理解逻辑回归，是sigmoid函数的特性，使得判定的阈值能够映射为平面的一条判定边界，当然随着特征的复杂化，判定边界可能是多种多样的样貌，但是它能够较好地把两类样本点分隔开，解决分类问题。</span><br></span></p>
   <p><span><span>&nbsp; &nbsp; &nbsp; &nbsp;求解逻辑回归参数的传统方法是梯度下降，构造为凸函数的代价函数后，每次沿着偏导方向(下降速度最快方向)迈进一小部分，直至N次迭代后到达最低点。</span></span></p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
  </div> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-258a4616f7.css" rel="stylesheet"> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
