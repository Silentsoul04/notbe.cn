<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>《StarGAN: Unified Generative Adversarial Networks for Multi-Domain Image-to-Image Translation》探析 « NotBeCN</title>
  <meta name="description" content="                   论文地址：https://arxiv.org/abs/1711.09020v3   论文GitHub：https://github.com/yunjey/StarGAN   ​ https://github.com/taki0112/StarGAN-Tensorflow   ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2019/05/11/Forlogen_90116816.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">《StarGAN: Unified Generative Adversarial Networks for Multi-Domain Image-to-Image Translation》探析</h1>
    <p class="post-meta">May 11, 2019</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">  
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div id="content_views" class="markdown_views prism-github-gist"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <p>论文地址：<a href="https://arxiv.org/abs/1711.09020v3" rel="nofollow">https://arxiv.org/abs/1711.09020v3</a></p> 
  <p>论文GitHub：<a href="https://github.com/yunjey/StarGAN" rel="nofollow">https://github.com/yunjey/StarGAN</a></p> 
  <p>​ <a href="https://github.com/taki0112/StarGAN-Tensorflow" rel="nofollow">https://github.com/taki0112/StarGAN-Tensorflow</a></p> 
  <p>收录：CVPR 2018<br> <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190511232551118.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZvcmxvZ2Vu,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
  <p>昨天在看《CollaGAN: Collaborative GAN for Missing Image Data Imputation》（发表于CVPR 2019）这篇文章所提到的模型结构时，顿生疑惑，这不仅就是StarGAN吗？有什么区别吗？我为什么这么说呢，首先来直观的看一下它们两个的模型架构：</p>
  <center>
   <br> 
   <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190511232606720.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZvcmxvZ2Vu,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
   <br> ​ 
   <strong>StarGAN</strong>
  </center>
  <p></p> 
  <p>CollaGAN如下所示</p>
  <center>
   <br> 
   <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190511232618128.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZvcmxvZ2Vu,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
   <br> ​ 
   <strong>CollaGAN</strong>
  </center>
  <p></p> 
  <p>是不是特别的相似呢 !..持续懵逼中…但是既然都是顶会论文，必然会有不同，所以我又重新研读了一下StarGAN的论文，希望可以明白两者的不同之处。</p> 
  <hr> 
  <h2><a id="StarGAN_24"></a>StarGAN</h2> 
  <p>首先我们看一下StarGAN是怎样的一个GANs：它解决的是关于多域（Domain）之间图像的转换问题，但是我们知道，在此之前已经有例如CycleGAN、DiscoGAN、pix2pix、UNIT、CoupleGAN等诸多GAN的变体，使用它们我们就可以完成域之间图像的转换，即Image-to-Image的工作。相比而言，StarGAN的意义在哪里呢？仔细比较就可以明白，此前的模型主要完成的都是两个域之间的转换工作，如果想要完成多个域之间的转换，就有点麻烦了。假设我们有<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         K
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">K</span></span></span></span></span>个域图像的数据集，如果想要实现任意两个域之间的转换，就需要训练<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
         <mo>
          (
         </mo>
         <mi>
          K
         </mi>
         <mo>
          −
         </mo>
         <mn>
          1
         </mn>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         K(K-1)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>个生成器（Generator，G）, 如下所示，当我们有4个域时，就要训练12个生成器</p>
  <center>
   <br> 
   <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/2019051123263860.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZvcmxvZ2Vu,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
  </center>
  <p></p> 
  <p>虽然这样做理论上可以达成目的，但是由于GAN本身训练的难度就很高，要想完成<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
         <mo>
          (
         </mo>
         <mi>
          K
         </mi>
         <mo>
          −
         </mo>
         <mn>
          1
         </mn>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         K(K-1)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>生成器的训练，工作量是难以忍受的。而StarGAN的提出就是为了解决这个问题，它可以完成多个域之间图像的转换，但是只需训练一个生成器，而不是<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          K
         </mi>
         <mo>
          (
         </mo>
         <mi>
          K
         </mi>
         <mo>
          −
         </mo>
         <mn>
          1
         </mn>
         <mo>
          )
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         K(K-1)
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="mopen">(</span><span class="mord mathit" style="margin-right: 0.07153em;">K</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>个，如下所示</p>
  <center>
   <br> 
   <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190511232649370.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZvcmxvZ2Vu,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
  </center>
  <p></p> 
  <p>下面就来看一下StarGAN是如何巧妙的解决上述的难题的！我们从目标函数的设置和模型架构两个方面结合着看一下，最后简单的看一下实验结果。</p> 
  <h3><a id="_34"></a>目标函数</h3> 
  <p>StarGAN中主要包含三个损失项：<strong>Adversarial Loss、Domain Classification Loss、Reconstruction Loss</strong>，下面依次来看一下是如何设置的。</p> 
  <p>首先，作为GAN的一个新的变体，自然无法脱离其中最重要的<strong>对抗</strong>的思想，所以第一个损失项就是<strong>Adversarial Loss</strong>。StarGAN的生成器接收输入图像（input image）<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span> 和域标签（domain label）<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          c
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         c
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">c</span></span></span></span></span> 两项，输入转换后的图像（output image）<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span>，即<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          G
         </mi>
         <mo>
          (
         </mo>
         <mi>
          x
         </mi>
         <mo separator="true">
          ,
         </mo>
         <mi>
          c
         </mi>
         <mo>
          )
         </mo>
         <mo>
          →
         </mo>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         G(x,c) \rightarrow y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathit">G</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span>。对于判别器（Discriminator，D）来说，它需要判别输入到D的图像是来自源图像域还是目标图像域，即<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          D
         </mi>
         <mo>
          :
         </mo>
         <mi>
          x
         </mi>
         <mo>
          →
         </mo>
         <mrow>
          <mo fence="true">
           {
          </mo>
          <msub>
           <mi>
            D
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             r
            </mi>
            <mi>
             c
            </mi>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo separator="true">
           ,
          </mo>
          <msub>
           <mi>
            D
           </mi>
           <mrow>
            <mi>
             c
            </mi>
            <mi>
             l
            </mi>
            <mi>
             s
            </mi>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo fence="true">
           }
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex">
         D : x \rightarrow\left\{D_{s r c}(x), D_{c l s}(x)\right\}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;">}</span></span></span></span></span></span> ，因此完整的Adversarial Loss为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi mathvariant="script">
            L
           </mi>
           <mrow>
            <mi>
             a
            </mi>
            <mi>
             d
            </mi>
            <mi>
             v
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi mathvariant="double-struck">
            E
           </mi>
           <mi>
            x
           </mi>
          </msub>
          <mo>
           [
          </mo>
          <mi>
           log
          </mi>
          <mo>
           ⁡
          </mo>
          <msub>
           <mi>
            D
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             r
            </mi>
            <mi>
             c
            </mi>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo>
           )
          </mo>
          <mo>
           ]
          </mo>
          <mo>
           +
          </mo>
          <msub>
           <mi mathvariant="double-struck">
            E
           </mi>
           <mrow>
            <mi>
             x
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             c
            </mi>
           </mrow>
          </msub>
          <mo>
           [
          </mo>
          <mi>
           log
          </mi>
          <mo>
           ⁡
          </mo>
          <mo>
           (
          </mo>
          <mn>
           1
          </mn>
          <mo>
           −
          </mo>
          <msub>
           <mi>
            D
           </mi>
           <mrow>
            <mi>
             s
            </mi>
            <mi>
             r
            </mi>
            <mi>
             c
            </mi>
           </mrow>
          </msub>
          <mo>
           (
          </mo>
          <mi>
           G
          </mi>
          <mo>
           (
          </mo>
          <mi>
           x
          </mi>
          <mo separator="true">
           ,
          </mo>
          <mi>
           c
          </mi>
          <mo>
           )
          </mo>
          <mo>
           )
          </mo>
         </mrow>
         <annotation encoding="application/x-tex">
           \mathcal{L}_{a d v} = \mathbb{E}_{x}[\log D_{s r c}(x)]+ \mathbb{E}_{x, c}[\log(1-D_{s r c}(G(x, c)) 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">d</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">G</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span><br> 但是为了提高StarGAN训练过程的稳定性，这里最后使用的是Improved-WGAN中的对抗损失项：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 a
                </mi>
                <mi>
                 d
                </mi>
                <mi>
                 v
                </mi>
               </mrow>
              </msub>
              <mo>
               =
              </mo>
             </mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <msub>
               <mi mathvariant="double-struck">
                E
               </mi>
               <mi>
                x
               </mi>
              </msub>
              <mrow>
               <mo fence="true">
                [
               </mo>
               <msub>
                <mi>
                 D
                </mi>
                <mrow>
                 <mi>
                  s
                 </mi>
                 <mi>
                  r
                 </mi>
                 <mi>
                  c
                 </mi>
                </mrow>
               </msub>
               <mo>
                (
               </mo>
               <mi>
                x
               </mi>
               <mo>
                )
               </mo>
               <mo fence="true">
                ]
               </mo>
              </mrow>
              <mo>
               −
              </mo>
              <msub>
               <mi mathvariant="double-struck">
                E
               </mi>
               <mrow>
                <mi>
                 x
                </mi>
                <mo separator="true">
                 ,
                </mo>
                <mi>
                 c
                </mi>
               </mrow>
              </msub>
              <mrow>
               <mo fence="true">
                [
               </mo>
               <msub>
                <mi>
                 D
                </mi>
                <mrow>
                 <mi>
                  s
                 </mi>
                 <mi>
                  r
                 </mi>
                 <mi>
                  c
                 </mi>
                </mrow>
               </msub>
               <mo>
                (
               </mo>
               <mi>
                G
               </mi>
               <mo>
                (
               </mo>
               <mi>
                x
               </mi>
               <mo separator="true">
                ,
               </mo>
               <mi>
                c
               </mi>
               <mo>
                )
               </mo>
               <mo>
                )
               </mo>
               <mo fence="true">
                ]
               </mo>
              </mrow>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow></mrow>
            </mstyle>
           </mtd>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="true">
             <mrow>
              <mrow></mrow>
              <mo>
               −
              </mo>
              <msub>
               <mi>
                λ
               </mi>
               <mrow>
                <mi>
                 g
                </mi>
                <mi>
                 p
                </mi>
               </mrow>
              </msub>
              <msub>
               <mi mathvariant="double-struck">
                E
               </mi>
               <mover accent="true">
                <mi>
                 x
                </mi>
                <mo>
                 ^
                </mo>
               </mover>
              </msub>
              <mrow>
               <mo fence="true">
                [
               </mo>
               <msup>
                <mrow>
                 <mo fence="true">
                  (
                 </mo>
                 <msub>
                  <mrow>
                   <mo fence="true">
                    ∥
                   </mo>
                   <msub>
                    <mi mathvariant="normal">
                     ∇
                    </mi>
                    <mover accent="true">
                     <mi>
                      x
                     </mi>
                     <mo>
                      ^
                     </mo>
                    </mover>
                   </msub>
                   <msub>
                    <mi>
                     D
                    </mi>
                    <mrow>
                     <mi>
                      s
                     </mi>
                     <mi>
                      r
                     </mi>
                     <mi>
                      c
                     </mi>
                    </mrow>
                   </msub>
                   <mo>
                    (
                   </mo>
                   <mover accent="true">
                    <mi>
                     x
                    </mi>
                    <mo>
                     ^
                    </mo>
                   </mover>
                   <mo>
                    )
                   </mo>
                   <mo fence="true">
                    ∥
                   </mo>
                  </mrow>
                  <mn>
                   2
                  </mn>
                 </msub>
                 <mo>
                  −
                 </mo>
                 <mn>
                  1
                 </mn>
                 <mo fence="true">
                  )
                 </mo>
                </mrow>
                <mn>
                 2
                </mn>
               </msup>
               <mo fence="true">
                ]
               </mo>
              </mrow>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
           \begin{aligned} \mathcal{L}_{a d v}=&amp;amp; \mathbb{E}_{x}\left[D_{s r c}(x)\right]-\mathbb{E}_{x, c}\left[D_{s r c}(G(x, c))\right] \\ &amp;amp;-\lambda_{g p} \mathbb{E}_{\hat{x}}\left[\left(\left\|\nabla_{\hat{x}} D_{s r c}(\hat{x})\right\|_{2}-1\right)^{2}\right] \end{aligned} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.60002em; vertical-align: -1.55001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05001em;"><span class="" style="top: -4.36001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">d</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span><span class="" style="top: -2.55001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55001em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05001em;"><span class="" style="top: -4.36001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">[</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;">]</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">[</span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">G</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;">]</span></span></span></span><span class="" style="top: -2.55001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.03588em;">g</span><span class="mord mathit mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class="mord mtight"><span class="mord mathit mtight">x</span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class="accent-body" style="left: -0.22222em;"><span class="mtight">^</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">[</span></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">∥</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class="mord mtight"><span class="mord mathit mtight">x</span></span></span><span class="" style="top: -2.7em;"><span class="pstrut" style="height: 2.7em;"></span><span class="accent-body" style="left: -0.22222em;"><span class="mtight">^</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">x</span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.22222em;">^</span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;">∥</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151408em;"><span class="" style="top: -2.4003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2997em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.954008em;"><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">]</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55001em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span><br> 第二个就是<strong>Domain Classification Loss</strong>，我们希望经过G生成的样本<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          y
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         y
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.03588em;">y</span></span></span></span></span> 属于目标域<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          c
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         c
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">c</span></span></span></span></span>，所以作者在D之前又引入了一个辅助的分类器，然后使用Domain Classification Loss来优化G和D。它分为两项：关于真实样本（目标域中的样本）的域分类损失用来优化D；关于假样本（生成样本）的域分类损失用来优化G。即：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msubsup>
           <mi mathvariant="script">
            L
           </mi>
           <mrow>
            <mi>
             c
            </mi>
            <mi>
             l
            </mi>
            <mi>
             s
            </mi>
           </mrow>
           <mi>
            r
           </mi>
          </msubsup>
          <mo>
           =
          </mo>
          <msub>
           <mi mathvariant="double-struck">
            E
           </mi>
           <mrow>
            <mi>
             x
            </mi>
            <mo separator="true">
             ,
            </mo>
            <msup>
             <mi>
              c
             </mi>
             <mo mathvariant="normal">
              ′
             </mo>
            </msup>
           </mrow>
          </msub>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <mo>
            −
           </mo>
           <mi>
            log
           </mi>
           <mo>
            ⁡
           </mo>
           <msub>
            <mi>
             D
            </mi>
            <mrow>
             <mi>
              c
             </mi>
             <mi>
              l
             </mi>
             <mi>
              s
             </mi>
            </mrow>
           </msub>
           <mrow>
            <mo fence="true">
             (
            </mo>
            <msup>
             <mi>
              c
             </mi>
             <mo mathvariant="normal">
              ′
             </mo>
            </msup>
            <mi mathvariant="normal">
             ∣
            </mi>
            <mi>
             x
            </mi>
            <mo fence="true">
             )
            </mo>
           </mrow>
           <mo fence="true">
            ]
           </mo>
          </mrow>
          <mspace linebreak="newline"></mspace>
          <msubsup>
           <mi mathvariant="script">
            L
           </mi>
           <mrow>
            <mi>
             c
            </mi>
            <mi>
             l
            </mi>
            <mi>
             s
            </mi>
           </mrow>
           <mi>
            f
           </mi>
          </msubsup>
          <mo>
           =
          </mo>
          <msub>
           <mi mathvariant="double-struck">
            E
           </mi>
           <mrow>
            <mi>
             x
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             c
            </mi>
           </mrow>
          </msub>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <mo>
            −
           </mo>
           <mi>
            log
           </mi>
           <mo>
            ⁡
           </mo>
           <msub>
            <mi>
             D
            </mi>
            <mrow>
             <mi>
              c
             </mi>
             <mi>
              l
             </mi>
             <mi>
              s
             </mi>
            </mrow>
           </msub>
           <mo>
            (
           </mo>
           <mi>
            c
           </mi>
           <mi mathvariant="normal">
            ∣
           </mi>
           <mi>
            G
           </mi>
           <mo>
            (
           </mo>
           <mi>
            x
           </mi>
           <mo separator="true">
            ,
           </mo>
           <mi>
            c
           </mi>
           <mo>
            )
           </mo>
           <mo>
            )
           </mo>
           <mo fence="true">
            ]
           </mo>
          </mrow>
         </mrow>
         <annotation encoding="application/x-tex">
           \mathcal{L}_{c l s}^{r}=\mathbb{E}_{x, c^{\prime}}\left[-\log D_{c l s}\left(c^{\prime} | x\right)\right] \\ \mathcal{L}_{c l s}^{f}=\mathbb{E}_{x, c}\left[-\log D_{c l s}(c | G(x, c))\right] 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.961392em; vertical-align: -0.247em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -2.453em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathit mtight">s</span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.247em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.088em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.32798em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">[</span><span class="mord">−</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathit">x</span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mclose delimcenter" style="top: 0em;">]</span></span><span class="mspace" style="margin-right: 0.166667em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 1.26832em; vertical-align: -0.301308em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.967016em;"><span class="" style="top: -2.39869em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathit mtight">s</span></span></span></span><span class="" style="top: -3.18091em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">[</span><span class="mord">−</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop">lo<span style="margin-right: 0.01389em;">g</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: -0.02778em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit">c</span><span class="mord">∣</span><span class="mord mathit">G</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;">]</span></span></span></span></span></span></span><br> 其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          r
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         r
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit" style="margin-right: 0.02778em;">r</span></span></span></span></span>表示real，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          f
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         f
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathit" style="margin-right: 0.10764em;">f</span></span></span></span></span>表示fake，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msup>
          <mi>
           c
          </mi>
          <mo mathvariant="normal">
           ′
          </mo>
         </msup>
        </mrow>
        <annotation encoding="application/x-tex">
         c&amp;#x27;
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span>代表的是原始域的域标签，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          c
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         c
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">c</span></span></span></span></span>代表目标域的域标签。对于输入图像<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          x
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         x
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span>来说，D希望正确的判别它为原始域的概率越大越好，所以需要最小化第一项；而对于生成样本来说，希望它越接近目标域越好，相当于希望D将其判别为目标域的概率越大越小，所以同样的需要最小化第二项。</p> 
  <p>经过前面的两个损失项的设置，我们可以使得生成结果越来越真实，同时属于目标域的概率越大，但是为了更好的保留原始输入图像中的内容信息，这里类似于auto-encoder，引入了<strong>Reconstruction Loss</strong>，希望重建后的图像越接近输入越好，即<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <msub>
           <mi mathvariant="script">
            L
           </mi>
           <mrow>
            <mi>
             r
            </mi>
            <mi>
             e
            </mi>
            <mi>
             c
            </mi>
           </mrow>
          </msub>
          <mo>
           =
          </mo>
          <msub>
           <mi mathvariant="double-struck">
            E
           </mi>
           <mrow>
            <mi>
             x
            </mi>
            <mo separator="true">
             ,
            </mo>
            <mi>
             c
            </mi>
            <mo separator="true">
             ,
            </mo>
            <msup>
             <mi>
              c
             </mi>
             <mo mathvariant="normal">
              ′
             </mo>
            </msup>
           </mrow>
          </msub>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <msub>
            <mrow>
             <mo fence="true">
              ∥
             </mo>
             <mi>
              x
             </mi>
             <mo>
              −
             </mo>
             <mi>
              G
             </mi>
             <mrow>
              <mo fence="true">
               (
              </mo>
              <mi>
               G
              </mi>
              <mo>
               (
              </mo>
              <mi>
               x
              </mi>
              <mo separator="true">
               ,
              </mo>
              <mi>
               c
              </mi>
              <mo>
               )
              </mo>
              <mo separator="true">
               ,
              </mo>
              <msup>
               <mi>
                c
               </mi>
               <mo mathvariant="normal">
                ′
               </mo>
              </msup>
              <mo fence="true">
               )
              </mo>
             </mrow>
             <mo fence="true">
              ∥
             </mo>
            </mrow>
            <mn>
             1
            </mn>
           </msub>
           <mo fence="true">
            ]
           </mo>
          </mrow>
         </mrow>
         <annotation encoding="application/x-tex">
           \mathcal{L}_{r e c}=\mathbb{E}_{x, c, c^{\prime}}\left[\left\|x-G\left(G(x, c), c^{\prime}\right)\right\|_{1}\right] 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.10159em; vertical-align: -0.2997em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.32798em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">c</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.682829em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">[</span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;">∥</span><span class="mord mathit">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathit">G</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathit">G</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">c</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mclose delimcenter" style="top: 0em;">∥</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151408em;"><span class="" style="top: -2.4003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2997em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">]</span></span></span></span></span></span></span><br> 因此，完整的损失函数为：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mtable>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <mrow>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mi>
                D
               </mi>
              </msub>
              <mo>
               =
              </mo>
              <mo>
               −
              </mo>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 a
                </mi>
                <mi>
                 d
                </mi>
                <mi>
                 v
                </mi>
               </mrow>
              </msub>
              <mo>
               +
              </mo>
              <msub>
               <mi>
                λ
               </mi>
               <mrow>
                <mi>
                 c
                </mi>
                <mi>
                 l
                </mi>
                <mi>
                 s
                </mi>
               </mrow>
              </msub>
              <msubsup>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 c
                </mi>
                <mi>
                 l
                </mi>
                <mi>
                 s
                </mi>
               </mrow>
               <mi>
                r
               </mi>
              </msubsup>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
          <mtr>
           <mtd>
            <mstyle scriptlevel="0" displaystyle="false">
             <mrow>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mi>
                G
               </mi>
              </msub>
              <mo>
               =
              </mo>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 a
                </mi>
                <mi>
                 d
                </mi>
                <mi>
                 v
                </mi>
               </mrow>
              </msub>
              <mo>
               +
              </mo>
              <msub>
               <mi>
                λ
               </mi>
               <mrow>
                <mi>
                 c
                </mi>
                <mi>
                 l
                </mi>
                <mi>
                 s
                </mi>
               </mrow>
              </msub>
              <msubsup>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 c
                </mi>
                <mi>
                 l
                </mi>
                <mi>
                 s
                </mi>
               </mrow>
               <mi>
                f
               </mi>
              </msubsup>
              <mo>
               +
              </mo>
              <msub>
               <mi>
                λ
               </mi>
               <mrow>
                <mi>
                 r
                </mi>
                <mi>
                 e
                </mi>
                <mi>
                 c
                </mi>
               </mrow>
              </msub>
              <msub>
               <mi mathvariant="script">
                L
               </mi>
               <mrow>
                <mi>
                 r
                </mi>
                <mi>
                 e
                </mi>
                <mi>
                 c
                </mi>
               </mrow>
              </msub>
             </mrow>
            </mstyle>
           </mtd>
          </mtr>
         </mtable>
         <annotation encoding="application/x-tex">
           \begin{array}{c}{\mathcal{L}_{D}=-\mathcal{L}_{a d v}+\lambda_{c l s} \mathcal{L}_{c l s}^{r}} \\ {\mathcal{L}_{G}=\mathcal{L}_{a d v}+\lambda_{c l s} \mathcal{L}_{c l s}^{f}+\lambda_{r e c} \mathcal{L}_{r e c}}\end{array} 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 2.52702em; vertical-align: -1.01351em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.51351em;"><span class="" style="top: -3.67351em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">D</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">−</span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">d</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathit mtight">s</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.34649em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">d</span><span class="mord mathit mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.967016em;"><span class="" style="top: -2.39869em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathit mtight">s</span></span></span></span><span class="" style="top: -3.18091em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.10764em;">f</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.301308em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.01351em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span><br> 其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           λ
          </mi>
          <mrow>
           <mi>
            c
           </mi>
           <mi>
            l
           </mi>
           <mi>
            s
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda_{cls}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>和<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           λ
          </mi>
          <mrow>
           <mi>
            r
           </mi>
           <mi>
            e
           </mi>
           <mi>
            c
           </mi>
          </mrow>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         \lambda_{rec}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>为两个超参数，文中的实验取值为1和10。</p> 
  <p>这样通过控制输入到G中的目标域标签<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          c
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         c
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">c</span></span></span></span></span>，就可以使用一个生成器来实现任意两个域之间的图像转换。</p> 
  <p>另一个StarGAN的优点就是，它可以同时操作多个不同类型的数据集所拥有的类标签，但是如何在过程中保证只让G知道某个域的信息呢？假设我们要联合训练CelebA和RaFD两个数据集，前者包含的有例如发色、性别等属性信息，后者包含的是开心、愤怒等面部表情，那么如何将CelebA中的图像训练得到RaFD中包含的面部表情信息的图像呢？一种最直接的方法是使用one-hot向量，假设原先域的属性信息使用5维的one-hot向量表示，那么现在将其变长到例如8维不就行了吗？但是CelebA中的图像也有面部表情，RaFD中的图像也有发色、性别等信息，这样的方式就使得D不知道你想要完成的是哪两个域的转换，我们希望模型关注的是某一部分信息。因此，作者引入了<strong>Mask Vector</strong>来解决这个问题，如下所示：<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml">
       <math>
        <semantics>
         <mrow>
          <mover accent="true">
           <mi>
            c
           </mi>
           <mo>
            ~
           </mo>
          </mover>
          <mo>
           =
          </mo>
          <mrow>
           <mo fence="true">
            [
           </mo>
           <msub>
            <mi>
             c
            </mi>
            <mn>
             1
            </mn>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mo>
            …
           </mo>
           <mo separator="true">
            ,
           </mo>
           <msub>
            <mi>
             c
            </mi>
            <mi>
             n
            </mi>
           </msub>
           <mo separator="true">
            ,
           </mo>
           <mi>
            m
           </mi>
           <mo fence="true">
            ]
           </mo>
          </mrow>
         </mrow>
         <annotation encoding="application/x-tex">
           \tilde{c}=\left[c_{1}, \ldots, c_{n}, m\right] 
         </annotation>
        </semantics>
       </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66786em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.66786em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathit">c</span></span></span><span class="" style="top: -3.35em;"><span class="pstrut" style="height: 3em;"></span><span class="accent-body" style="left: -0.19444em;">~</span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">[</span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathit">m</span><span class="mclose delimcenter" style="top: 0em;">]</span></span></span></span></span></span></span><br> 它也是一个n维的one-hot向量，其中<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          n
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         n
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">n</span></span></span></span></span>表示的是数据集的数目，<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <msub>
          <mi>
           c
          </mi>
          <mi>
           i
          </mi>
         </msub>
        </mrow>
        <annotation encoding="application/x-tex">
         c_{i}
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>表示第<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          i
         </mi>
        </mrow>
        <annotation encoding="application/x-tex">
         i
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathit">i</span></span></span></span></span> 个域的标签信息，如果它是二进制属性就可以表示位二进制向量，如果是类别属性，其中表示该类的为1，其余的<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mi>
          n
         </mi>
         <mo>
          −
         </mo>
         <mn>
          1
         </mn>
        </mrow>
        <annotation encoding="application/x-tex">
         n-1
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord mathit">n</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>个指定为0。</p> 
  <p>下面通过一个实例看一下以上的设计是如何结合在一起的</p>
  <center>
   <br> 
   <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190511232707826.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZvcmxvZ2Vu,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
  </center>
  <p></p> 
  <p>如上所示，当希望模型关注的是CelebA中的信息时，Mask vector设置为<span class="katex--inline"><span class="katex"><span class="katex-mathml">
      <math>
       <semantics>
        <mrow>
         <mo>
          [
         </mo>
         <mn>
          1
         </mn>
         <mo separator="true">
          ,
         </mo>
         <mn>
          0
         </mn>
         <mo>
          ]
         </mo>
        </mrow>
        <annotation encoding="application/x-tex">
         [1,0]
        </annotation>
       </semantics>
      </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span></span>（紫色部分），同时关于CelebA的标签信息不全是零，其中值为1 的表示选择的属性，而RaFD的标签信息全部为零；同理当希望模型关注的是RaFD中的信息时，设置相反。</p> 
  <hr> 
  <h3><a id="_78"></a>实验</h3> 
  <p>最后看一下实验的结果，更多的结果可见原论文和官方GitHub。</p>
  <center>
   <br> 
   <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190511232719398.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZvcmxvZ2Vu,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
  </center>
  <p></p> 
  <p>可以看到，StarGAN可以完成多个域的图像转换，而且生成结果的质量也很高。</p> 
  <p>而当完成one-to-one域之间的转换工作时，效果也要优于之前的模型</p>
  <center>
   <br> 
   <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190511232732467.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZvcmxvZ2Vu,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
  </center>
  <p></p> 
  <p>同时作者也通过实验证明了联合训练的结果要更好</p>
  <center>
   <br> 
   <img src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190511232744329.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZvcmxvZ2Vu,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
  </center>
  <p></p> 
  <hr> 
  <h2><a id="END_93"></a>END</h2> 
  <p>夜已深，关于CollaGAN的内容以及和StarGAN的对比明天再写喽~~</p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-258a4616f7.css" rel="stylesheet"> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
