<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>camera基本知识 « NotBeCN</title>
  <meta name="description" content="                  转载于https://blog.csdn.net/wang714818/article/details/78088424               一 Camera模组&nbsp;&nbsp; &nbsp;    &nbsp; &nbsp; &nbsp; 大家都知道，手机背面...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2019/05/11/flaoter_90116481.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">camera基本知识</h1>
    <p class="post-meta">May 11, 2019</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div id="content_views" class="markdown_views prism-atom-one-dark"> 
  <!-- flowchart 箭头图标 勿删 --> 
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
   <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
  </svg> 
  <p>转载于https://blog.csdn.net/wang714818/article/details/78088424</p> 
  <div id="article_content" class="article_content clearfix csdn-tracking-statistics"> 
   <div class="htmledit_views" id="content_views"> 
   </div>
  </div>
  <h1><a></a><span><span><span><span><span>一 Camera模组</span></span></span></span><span><span><span><span>&nbsp;</span></span></span></span>&nbsp; &nbsp;</span></h1> 
  <p> <span><span>&nbsp; &nbsp; &nbsp; 大家都知道，手机背面的那个小小的孔，就叫摄像头。这个小孔幽幽的泛着光泽，深邃又迷人，如同一个含苞待放的小萝莉一样，这个小萝莉还是个傲娇娘，像零之使魔的614一样惹人怜爱，而且在小萝莉身体里面，不对，是在小孔的里面，还有层膜…..哦，这是镀膜。 看了上面一段大家别惊慌，我不是猥琐的宅男，我也有女朋友的……她叫姐崎宁宁……囧! 回到正题来吧。虽然Camera的构成大家都知道很简单，就是镜头+感光芯片而已。不过大家也都知道光学成像是一门非常深奥且尖端的科学，这其中消费者可以拿来讨论的话题非常之多。我们现在就来谈谈摄像头，从camera的构成开始</span></span></p> 
  <p> <span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021100107325?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></p> 
  <p> <span><span><span><span><span><span>&nbsp;<span>&nbsp;&nbsp;</span></span><span><span>Camera最概念性的结构框图，就是镜头+图像传感器+DSP。如果图像传感器类型是CCD，那么在图像传感器采光后还需要一个A/D转换的过程。 下面具体介绍。</span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span>Camera结构一 图像传感器(Sensor)&nbsp;</span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span>&nbsp;一 感光二极管阵列</span></span></span><span>&nbsp;</span><span><span><span>图像传感器(image sensor)，这个大家都耳熟能详了，目前买个相机或手机，一般都会标注sensor的参数，人们也都知道了，sensor是相机中最重要的器件之一，没错，是之一，不是唯一。</span></span></span><span>&nbsp;</span><span><span>Sensor的作用通俗点讲就等效于胶片相机的底片。两者的作用都是保存曝光时间内的光线数据，这些原始数据就含有基色/亮度等成像的全部要素。</span></span><span>&nbsp;</span><span><span>区别在于胶片要在暗房里面慢慢用光显影液和定影液冲洗出影像，而sensor要经过数字信号处理和数据转换才能成为通用的影像格式。</span></span><span>&nbsp;</span><span><span>大家也知道，Sensor的类型，按照工作原理可分为两类CCD和CMOS。</span></span><span>&nbsp;</span><span><span><span>CCD: 电荷耦合元件</span></span></span><span>&nbsp;</span><span><span><span>CMOS: 互补型金属氧化物半导体</span></span></span><span>&nbsp;</span><span><span>这两个名字非常拗口，咱们略过，来说说他们的工作原理吧。</span></span><span>&nbsp;</span><span><span>其实我觉得，我们能记住这些专业名词的，还是要记住。如果连名字都记不住，就去研究原理的话，总觉得好像有什么奇怪的怨念混进来了。这就好比你看上个姑娘，追的死去活来，终于追到手了，然后海誓山盟，各种美好，结果到领证登记时，登记员问你：未婚妻名字？你才拍脑袋：我艹我老婆叫什么来着…? 对！就是这种感觉。</span></span><span>&nbsp;</span><span><span>首先要说明，图像sensor既然要保存光线，首先要做的就是能感应光线，即不同的光线照射到材料上，可以输出不同的信号电平。 CCD和CMOS就是对应两种感光二级管的类型。以此带入后，大家都将这两种感光二极管所构成的sensor，简称为CCD和CMOS。</span></span><span>&nbsp;</span><span><span>下面是CCD和CMOS的感光二极管排列，看图也能看出来，因为感光二极管的构造不同，所以CCD和CMOS的感光阵列结构也不同。</span><span>CCD的阵列，是在一根总线后加A/D转换</span><span>，而</span><span>CMOS在每个感光二极管旁都加入了A/D转换</span><span>（红色的二极管标注）。</span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021100205349?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span>&nbsp;</span><span>大家把视线焦点聚集在阵列图的总线上，</span></span><span><span><span>CMOS结构的阵列有水平和竖直两条传输总线</span></span><span>，而</span><span><span>CCD只有水平或者竖直一条传输总线</span></span><span>。</span></span></span><span><span>&nbsp;</span><span><span>那么大家就有疑问了，</span><span><span>CMOS有两条总线，可以以坐标方式直接读取总线的电平来保存每个像素的电平值</span></span><span>，而CCD只有一条总线，怎么输出数据呢？</span></span><span>&nbsp;</span><span><span>很简单，大学学过数电吧，</span><span><span>CCD传出数据就是在时钟信号同步下，一步一步的移位读出对应二极管的电平值</span></span><span>。</span></span><span>&nbsp;</span><span><span>这也就带出CCD和CMOS采集信息的不同点了。</span><span><span>CMOS是主动式输出采集的数据信息，CCD是在同步电路控制下被动式的输出采集的数据</span></span><span>。</span></span><span>&nbsp;</span><span><span>至此，CCD和CMOS的大多数特性就可以解释了。</span></span><span>&nbsp;</span><span><span>第一， CCD保存图像速度慢，不适合快速连拍。 你瞧，CCD传感器需在同步时钟的控制下以行为单位一位一位的输出信息，速度当然慢，不慢不舒服斯基。</span></span><span>&nbsp;</span><span><span>第二， CMOS保存图像速度快，适合快速连拍。你瞧，CMOS阵列有坐标嘛，传感器采集光信号的同时就可以取出电信号，还能同时处理各单元的图像信息，速度当然比CCD快，不快不舒服斯基。</span></span><span>&nbsp;</span><span><span>第三， CCD耗电大。本来CCD感光二极管工作就需要多个源极，所需要施加源极的电平很高(见图)，加上CCD的阵列要在同步信号控制下一位一位的实施转移后读取，所以需要时钟控制电源和三组电源供电，耗电当然大了。不大不舒服斯基。</span></span><span>&nbsp;</span><span><span>第四， CMOS耗电小。CMOS传感器经光电转换后直接产生电流或电压信号，信号读取十分简单，而且感光二极管所需的电压，直接由晶体放大输出，所以需要施加在源极的电平很小（见图）。不小不舒服斯基。</span></span><span><span>另外，大家还记得上面的摄像头结构框图吗？为什么CCD传感器后面会有个A/D转换电路，而CMOS却没有？现在知道原因了吧？OK，再来说下一个话题。</span></span></span><br> </p> 
  <p> <span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021100720031?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></p> 
  <p> <span><span><span>&nbsp;<span><span>CMOS之于CCD的弱点和优势。</span></span><span>&nbsp;</span><span><span>在几年前，大家普遍存在一种说法，就是CCD画质比CMOS好。时至今日，这个说法越来越站不住脚了，当然是CMOS传感技术在高速发展的结果。</span></span><span>&nbsp;</span><span><span>说CMOS画质弱于CCD，其实也就是采集的数据完整性不同罢了。</span></span><span>&nbsp;</span></span></span></span></p> 
  <p> <span><span><span><span><span>&nbsp; 1. CMOS是主动式输出数据，阵列上每个点都要经过两条传输总线，路程长，虽然经过了放大，但传输时的噪声引入多。</span></span><span>&nbsp;</span></span></span></span></p> 
  <p> <span><span><span><span><span>&nbsp; 2. CMOS阵列的每个二极管旁边都有A/D，光电传感元件与电路之间距离很近，相互之间的光电磁干扰较为严重，放大的同时可能带入的噪声也大。</span></span><span>&nbsp;</span></span></span></span></p> 
  <p> <span><span><span><span><span>&nbsp; 3. 如上一点，CMOS因为二极管旁带有A/D电路，所以同样尺寸的sensor，CMOS的二极管能受到的光线面积就小（其他的面积留给A/D电路），所以一部分光线被浪费了，受光弱于CCD的感光二极管，所以带入的一点小噪声就会被放大。</span></span><span>&nbsp;</span></span></span></span></p> 
  <p> <span><span><span><span><span>&nbsp; 4. CCD传感器制作技术起步较早，技术比较成熟，采用PN结和二氧化硅隔离层隔离噪声。</span></span><span>&nbsp;</span><span><span>不过，近年来，CMOS技术发展是一日千里，在中小尺寸传感器上，CMOS和CCD的画质区别已经很小了。CMOS可以通过改善微透镜，在硅表面上掺入杂质等来减小噪声信号。（什么是微透镜？下面慢慢介绍）</span></span><span>&nbsp;</span><span><span>这时候，大家又有疑问了，为什么CMOS在发展，而CCD却没有技术更新了呢？</span></span><span>&nbsp;</span><span><span>这个我只能说，CCD成本高又耗电，结构设计又复杂，谁TM闲着没事去钻研它啊。而且CCD技术起步很早，发展的已经很成熟了，可改善的余地真的不算大。</span></span><span>&nbsp;</span><span><span><span>感慨一下，说起CCD和CMOS的发展，就好像猎人和海贼王一样。</span></span></span><span>&nbsp;</span><span><span><span>猎人就是CCD啊，神作啊，可惜它是被富奸这个2B给画出来的。于是可怜的猎人Fans等了八年，还没等到主角再次登场…</span></span></span><span>&nbsp;</span></span></span></span></p> 
  <p> <span><span><span><span><span><span>&nbsp;二 微透镜和滤光层</span></span></span><span>&nbsp;</span><span><span>再来，就是微透镜了。</span></span><span>&nbsp;</span><span><span>微透镜是什么？是镜头吗？错！给你打个叉。</span></span><span>&nbsp;</span><span><span>微透镜不是镜头，微透镜是CCD/CMOS传感器表面的一层小透镜阵列。</span></span><span>&nbsp;</span><span><span>光线不是经由镜头，然后直接照射到CCD/CMOS的感光二极管阵列上的。在光线射到感光阵列前，还要经过传感器表层的微透镜和滤光层。</span></span><span>&nbsp;</span><span><span>在感光二极管之上，有很多微型的透镜。这些透镜按照二极管的阵列排列，也就是每个感光二极管的上面都有附着一个微型透镜，即一个透镜对应一个像素来排列。</span></span><span>&nbsp;</span><span><span>下图为CCD传感器的纵向结构图。</span></span></span></span></span></p> 
  <p> <span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021101440117?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></p> 
  <p> <span><span><span><span><span>&nbsp;</span><span><span><span>为什么这种结构？聪明的读者已经猜到了。猜到的同学请举手，叔叔要奖励你一个轻轻的吻，不伸出舌头的那种哦~~~</span></span><span>&nbsp;</span><span><span>微透镜的作用：初中物理老师都会告诉你，凸透镜用来聚集透射光线的。微透镜当然是用来聚集光线的。 在阵列中，感光二极管的感光面有限，对应一格像素内的大部分面积是无效受光区域，所以要把阵列中每格二极管前的光线集中起来，射到二极管的受光面上。</span></span><span>&nbsp;</span><span><span>滤光层的作用：注意了，不是孙燕姿的绿光，是滤光。滤光就是把色彩滤掉。保证每个二极管感受到的光是单色的。为什么要滤成单色光？把你生锈的脑袋转动起来。前面说了感光二极管只能输出不同的电平，也就是只能表示光的强度而已，没办法表示颜色信息。也就是黄色光和红色光，只要对应的亮度相同，二极管都会输出一样的电平信息。</span></span><span></span><span><span>所以，聪明的开发者就在二极管阵列前面，加个滤光层，指定这个二极管感受一种颜色的光强，光线中其他的颜色就去掉。这样每个二极管的输出信号就对应为一种颜色的强度了。</span></span><span>&nbsp;</span><span><span>这种做法的缺点是每个像素点得不到真正的信息，只能通过相邻像素的其他颜色强度，来猜测自己这一格内的其他颜色强度，再把颜色组合起来，算出真正的颜色。这就是所谓的马赛克结构。</span></span><span>&nbsp;</span><span><span>目前市面上手机和相机传感器总数的99%是马赛克结构，也就是有先天缺点的。&nbsp;</span></span><span><span>最常见的马赛克结构就是RGB三个基色相错排列，如下图。相机将每个像素格的基色信息综合起来，猜出每个像素的实际颜色和强度。</span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021101720410?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></p> 
  <p> <span><span><span>&nbsp;</span><span><span><span>现在还有一种sensor，可以完美解决马赛克的这种先天缺点。就是适马开发的FOVEON X3传感器，其实就是每个格子的感光电路，可以感受RGB三种基色的信息，缺点是在感光阵列上要加三层滤光层，光线强度会有损失。</span></span><span>&nbsp;</span><span><span>适马X3传感器也是被誉为最接近胶片原理的传感器，成像效果比常用的CCD/CMOS确实好很多。这个好理解嘛，因为每格像素记录的都是全部的基色，不用靠相邻像素去猜了嘛。</span></span><span>&nbsp;</span><span><span>不过很可惜，这种传感器目前只用在适马自己的单反和专业DC上，而且卖的很贵。另外同样的尺寸下，X3传感器比较难以提高总像素数。</span></span></span></span></span></p> 
  <p> <span><span><span><span><span>&nbsp;<img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021101855528?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></span></span></span></span></span></p> 
  <p> <span><span><span><span><span>&nbsp;<span><span><span>三 传感器尺寸和画质的关系</span></span></span><span>&nbsp;</span><span><span>传感器尺寸大小对于画质的影响，其实跟之前一样，就是采集的光线数据的正确性和完整性的不同。</span></span><span></span><span><span>在像素相同的情况下：</span></span><span>&nbsp;</span><span><span>1. 传感器面积越大，感光阵列的面积就越大，相邻感光电路的距离就越大，加电时产生的电磁干扰就越小。</span></span><span>&nbsp;</span><span><span>2. 传感器面积越大，感光阵列的面积就越大，对应单个像素的透镜就能做的越大，聚集到的光线就越多，感光二极管受光后产生的输出电平就越高。假设噪声大小不变，那么更大的有用输出电平，带来更高的信噪比，转换后的信息处理时正确率就越高。</span></span><span>&nbsp;</span><span><span>3. 为什么在光线非常好的时候，传感器尺寸大小间的差异会缩小？ 因为即使传感器尺寸小，但是光线强度足够，每个感光二极管都能受到足够的光线，产生的信噪比就大，噪点也就缩小了。</span></span><span>&nbsp;</span><span><span>这就是为什么画幅大的单反和单电，比画幅小的手机和卡片DC成像好的本质原因，当然也有镜头素质等其他原因。下图是各种画幅的大小对比。</span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021102542288?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span>&nbsp;<span><span>(小知识：32×24mm之所以被称为全画幅，是因为这个尺寸和135胶片的尺寸很接近)</span></span><span>&nbsp;</span><span><span><span>好了，关于传感器就说到这儿。这里是个浅显的原理讨论，深入的半导体材料特性，驱动电路设计等不是我们关心的了。</span>&nbsp;<span>另外，关于CCD和CMOS的优劣，被人争论的太多太频繁了。无忌有个帖子讨论的比较深入，感兴趣的话可以搜索一下。&nbsp;</span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span>Camera结构二 数字信号处理(DSP)</span></span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 一 图像信号处理的目的</span></span>&nbsp;<span>你像我一样，假期宅在家里，肚子饿了想吃碗泡面，然后打开冰箱拿出泡面，这个泡面就是原始数据，是不能吃的。你要打开桶，撕开调味袋和酱袋，倒进桶中，再倒热水冲泡数分钟，然后才能吃。这个过程就叫对数据进行处理。 这时候有人大叫：我吃泡面都是直接吃干面饼的。对于这种喜欢吐槽的魂淡，我是不会理会的……</span>&nbsp;关于图像信号的处理，我们先从需求上去探讨。 前文说过了，传感器一般为马赛克结构，阵列输出的信号，在每个像素上都只是单色的，需要用相邻像素的色彩去猜测本像素的其他色彩。 这个由传感器直接输出的，每个像素只有单色信息的数据，叫做Raw RGB数据。 而DSP的目的，就是把Raw RGB数据，去通过计算和后期加工，变成真正的RGB或YUV格式的数据。 简而言之，<span>DSP的主要工作，就是把Raw RGB格式转换成RGB格式或者是YUV格式</span>。</span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021131944367?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span>&nbsp;</span><span><span><span><span><span><span><span><span><span><span><span><span>介绍一下各种颜色的数据格式吧。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;1. RGB数据: 通用数据格式，因为理论上任何颜色都可以用红绿蓝三种基本颜色混合而成，所以RGB格式的一个数据位由RGB(红绿蓝)三种颜色的比特位组来表示。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;RGB格式有RGB565，RGB24，ARGB32等几种标准。 大家都知道，数据传输中，一个字节是8个比特&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; RGB565：</span>共16比特，占两个字节。&nbsp;</span></span></span></span></span></span></span></span></span></span></span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span>其中5个比特表示R，6个比特表示G，剩下来5个比特表示B，所以一共可以表示的颜色数为2^16 = 65536色，&nbsp;</span></span></span></span></span></span></span></span></span></span></span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span>其中红色R和蓝色B可表示为32种不同值，而绿色G可以表示为64种不同；&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; RGB24：</span>共24比特，占三个字节。&nbsp;</span></span></span></span></span></span></span></span></span></span></span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span>其中RGB三种颜色各种8个比特位，&nbsp;</span></span></span></span></span></span></span></span></span></span></span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span>所以一共可以表示的颜色数为2^24 = 1677万色，每种颜色可表示成256种不同值；&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; ARGB32：</span>共32比特，占四个字节。&nbsp;</span></span></span></span></span></span></span></span></span></span></span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span>其中RGB三种颜色各占8比特，剩下来8比特表示Alpha通道值，&nbsp;</span></span></span></span></span></span></span></span></span></span></span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span>所以一共可以表示的颜色数为2^24 = 1677万色，每种颜色可表示成256种不同值。&nbsp;</span></span></span></span></span></span></span></span></span></span></span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span>但是因为加了Alpha值，所以每种颜色还可以另外显示为256种不同的透明度；&nbsp;<span>好，说到这里，大家知道了屏幕参数中6万5千色，26万色，1670万色是怎么来的了吧？</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 另外RGB颜色在寄存器中的比特位顺序是BGR，所以写驱动时，定义的话是这么定义的：&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; typedef struct tagRGBTRIPLE {&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; BYTE rgbtBlue;&nbsp;<span>// 蓝色分量</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; BYTE rgbtGreen;&nbsp;<span>// 绿色分量</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span></span></span></span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; BYTE rgbtRed;&nbsp;<span>// 红色分量</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; } RGBTRIPLE;&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 2. YUV数据: 说白了就是色差分量。大家的电视机上都有色差端口吧？色差端口传输的数据格式就是YUV422。 YUV中，Y表示亮度信号，U和V表示色差信号。以前的黑白电视，是只有Y信号而没有UV信号，所以只能表示灰度而不能表示色彩。 YUV数据和标准RGB数据互相转换公式：&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; Y = 0.299R + 0.587G + 0.114B</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; U = 0.147R - 0.289G + 0.436B</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; V = 0.615R - 0.515G - 0.100B</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; R = Y + 1.14V</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; G = Y - 0.39U - 0.58V</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; B = Y + 2.03U</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 3. Raw-RGB数据：前文所说，马赛克结构的CCD/CMOS，其感受光线后输出的原始数据只有灰度数据，因为滤光层关系每个灰度数据只表示一种颜色的强度，所以Raw-RGB数据就是传感器输出的原始图像数据，其中的颜色信息是不完整的，不通过计算插值出其他颜色信息的话，是还原不出完整图像的。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;了解了图像处理的目的之后，我们来看看DSP的简单框图。下面一步步的来拆分。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021132556584?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;1.图像传感器部分：前面已经说过了，没记住的把鼠标往上面滚动，慢慢看。ASP/AFE就是感光阵列的辅助电路，控制信号抽样，感光时间长短（也就是曝光）等功能，跟模拟信号的处理相关。A/D部分前文也有说明，所以这部分带过。 最后一点最重要：图像传感器输出的就是Raw RGB原始数据。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;2.DSP部分：基本上信号处理模块中，90%的功能由ISP完成。ISP是什么？Image Signal Processing，图像信号处理。 故名思忆就是处理图像的。ISP将由Sensor输出的原始信号处理成通用的成像数据，这些处理过的成像数据可以直接被AP处理器或者基带芯片来使用，至于这些通用的图像格式数据，是再处理还是显示还是保存，这就看应用需求了。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;二 Pre-ISP</span></span>&nbsp;<span>大家辛辛苦苦工作了一年了，准备带着家人去普吉岛度个假。难得出国嘛，总觉得不带个好点儿的相机会有遗憾。于是赶早儿带着女儿去摄影城买相机去了。 到了摄影城门口有人发传单，起手接过一张，佳能小马四，双Digic高速数字图像处理引擎，倍儿牛逼。 没走两步又有人塞了张传单，索尼A77，双Bionz图像处理引擎，忒专业了。 于是您女儿就好奇了，拽着您的衣角问起来了，把拔把拔，这个图像处理引擎，四什么东东啊？好吃吗？ 回答不出来吗？不能在自己可爱的女儿面前丢脸啊。大丈夫萌大乃！ 客官儿，给您沏一壶茶，您坐着，一边品茶一边听我慢慢的道来。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;目前市面上的相机厂商都有自己的图像处理引擎，其实就是一块封装了ISP以及其他功能的芯片。这块芯片的主要作用，其实就是处理原始图像数据(Raw-RGB)。 首先啊，咱们说说这Pre-ISP，哎？您问我什么是Pre-ISP？ 嘿，敢情客官您眼力好啊，问我那算是问对人儿了。&nbsp;</span><span>Pre-ISP部分称之为前端影像处理，是把原始图像数据处理为通用图像数据的最关键的一个部分，没有之一。各家的图像处理引擎中，最核心的也就是这个Pre-ISP的部分，对应着不同的图像数据的转换和处理方式。</span>&nbsp;其实说白了Pre-ISP就是一个调整图像的过程(PS的过程)。这个和你在电脑上用Photoshop或者光影魔术手去给你的图像拉曲线，调色调等是一样的过程。 只不过ISP是直接处理Raw-RGB数据的，这个原始数据虽然是不完整的RGB颜色数据，但是没有失真和画质损耗，处理Raw-RGB数据，所带来的画质损失是最小的。 而经过Pre-ISP处理过的数据，即RGB或者YUV数据，虽然有了完整的颜色信息，但是画质已经有了一定的损耗。如果再把这个RGB或YUV数据编码压缩成JPG格式，画面细节的损耗就更大了。 而我们一般是直接使用出片的JPG文件去更进一步的处理，在手机上或者导出到电脑上进一步修改，这就是第三次对画质进行了损坏。 图像数据在各个处理流程中的画质损耗见下图。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021133051133?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;所以，现在很多相机都具备直接输出原始的Raw-RGB数据的能力，也就是所谓的RAW片。直接用专用的工具打开这个RAW片，在电脑上进行加工，以减少处理中画质的损耗。这个过程其实就是摒弃了相机内置的ISP过程，而直接自己处理原始格式。嗯，高手都这么做，高手都是鄙视直出JPG的“伪”射影师的，我就在无忌上被鄙视过……千万别招惹那些摄影高手，他们会用他们丰富的经验在精神上推倒你，而且绝对不肯准备杜蕾丝的。 关于RAW片为什么处理起来对画质损失最小，我再引用其他人的一段文字吧：&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 1. RAW文件没有白平衡设置，可以任意的调整色温和白平衡来进行创造性的制作，而不会造成图像质量损失。</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 2. 可以转化成16位的图像，也就是有65536个灰度层次可以被调整，这对于JPG文件来说是一个很大的优势。当需要对阴影区或高光区进行细致调整的时候，这一点非常重要。</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;OK，再来说说Pre-ISP的重要性。&nbsp;<span>Pre-ISP是对原始图像格式的第一次处理，这是非常重要的一次处理，可以说是直接修改和优化了图像的内容，也就是直接决定了这个相机或手机的出片能力。</span>&nbsp;<span>而Pre-ISP之后的处理，比如转换为TIFF或者JPG等，都不会对图像的内容进行修改，只是在转换过程中会产生一点画质的损失。</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;Pre-ISP所做的工作没有一个固定的流程，因为每个厂商都有各自不同的处理流程和风格，所以带入进相机，体现出来的就是各家都有显著不同的成像风格， 佳能“媚”，尼康“锐”，宾得“惹人醉”等说法，说的就是这个，当然，不同的成像风格和所使用的镜头也有很大的关系。</span>&nbsp;不过不管是什么Pre-ISP，一定有<span>色彩插值</span>的过程。也就是把Raw-RGB中缺失的颜色通过一定的算法给算出来的过程。 如果你是直接输出Raw片，那么在电脑上用软件打开Raw片时，软件已经做了色彩插值的计算处理了。（否则怎么能看到图像呢..） 我这里给出一个一般的ISP都有的前端处理动作：&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 1. Black Level Calibration（暗电流校正） 这个过程一般集成在sensor中，但是严格来说也属于ISP的一部分。 感光二极管，在没有光线照射时，释放电流应该为0吧？很可惜这只是理想状态。这些无受光情况下释放的电流值称之为Black Level暗电流，是噪音，需要去校正后保存进寄存器里面，作为补正系数。以后在光照情况下，才能将二极管的输出电流相应的进行加减补正。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 2. Lens shading（镜头黑点校正） 小通光口径镜头比较严重的毛病，成像圈的外围进光量不足，所以图像四周有暗角。 所以要预先提高亮度把这个问题处理掉。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 3. Black Point Compensation（黑点补偿） 通过扫描每个像素及其四周像素的颜色和灰度数据，侦测出纯黑的点，进行插值计算出合理的颜色及其灰度值覆盖它。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 4. 平滑锐化 平滑+锐化，皮肤要平滑白皙，眼神要锐利凶狠化，这就是傲娇娘的基本属性。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 5. 色彩插值 这个就是前面所说的，基于马赛克sensor的ISP一定会有的步骤，把原始图像数据中每个像素缺失的颜色给计算出来，算法很复杂哦，以后再说吧。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 6. Gamma校正：<span>就是对图像的</span><a target="_blank" href="http://baike.baidu.com/view/4569667.htm" rel="nofollow">伽马曲线</a><span>进行编辑,以对图像进行非线性色调编辑的方法,检出图像信号中的深色部分和浅色部分，并使两者比例增大，从而提高</span><a target="_blank" href="http://baike.baidu.com/subview/3429512/3429512.htm" rel="nofollow">图像对比度</a><span>效果</span>。http://www.docin.com/p-69816832.html</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 7. AE自动曝光补偿：<span>通俗一点讲，就是为了画面的明暗度和细节、层次更加丰富，适当地加、减曝光量</span>。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 8. AWB自动白平衡补偿：就是无论环境光线如何，仍然把"白"定义为"白"的一种功能，这样可以保证色彩还原的准确性。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 9. Color Matrix：<span>对图像进行颜色方面的处理，通过使用颜色矩阵（ColorMatrix）来实现。从而可以达到很多特效如黑白老照片、泛黄旧照片等等</span><span>，</span><span>http://developer.</span><a target="_blank" href="http://lib.csdn.net/base/android" rel="nofollow" class="replace_word" title="Android知识库">Android</a><span>.com/reference/android/graphics/ColorMatrix.html</span>。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 10. 饱和度/对比度/亮度调节 不知道的看Photoshop帮助文件去。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 下图是一个CCD摄像头模块中，关于ISP的框图。可以看到Pre-ISP的流程为： 坏点侦测(黑点白点)-&gt;基色白平衡转换-&gt;Gamma值补偿-&gt;<span>色彩插值</span>-&gt;色彩修正-&gt;色域转换-&gt;将RGB444转换为YUV422格式输出。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021135215535?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;至于其他ISP的处理流程，可以参见各个camera模组的datasheet。&nbsp;<span>总之，Pre-ISP就是机器内部，对于Raw-RGB原始格式的一个PS过程。你这么理解就对了。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;<span>三 Post-ISP</span></span></span><span>&nbsp;在ISP的框架中，Pre-ISP已经对原始图像数据进行过处理了，那Post-ISP是干嘛的呢？ Post-ISP，即后端影像处理，其实就是做做后勤工作的，并不是上前线直接作战的。Post-ISP对于图像的直接影响并不多，它主要负责数据压缩及后端接口界面等，还包括数据传输和控制等工作。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021135325065?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;<span>如上图，红色框内的控制模块就可以视为Post-ISP。 Post-ISP的作用繁杂，主要还是体现在控制上。 控制什么？当然是控制拍照时相关的电路工作状态啊。</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;基本的控制项目：&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 1. 自动曝光控制(光圈+快门控制)</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 2. 自动白平衡控制</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 3. 闪烁控制（对应工频干扰）</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 4. 闪光灯控制，连拍控制，视频摄录控制</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 5. 自动聚焦控制</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 6. 变焦控制</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 7. 等等等等</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;我们来挑选大家比较关心的说说。</span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;</span><span><span>Post-ISP控制项目之一</span></span><span>&nbsp;曝光控制(光圈+快门控制)</span><span>&nbsp;传感器中，感光二极管加电工作的时间，就是曝光时间，也就是所谓的快门时间。 当传感器如果不加电，即使有光照射到表面，也感光二极管也不会工作。 Sensor的曝光方式有几种，</span><span>全帧曝光</span><span>和</span><span>逐行曝光</span><span>等。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 全帧曝光：Sensor通电后，所有的感光二极管是同时开始工作的，你只要控制Sensor加电时间的长短，就能控制曝光时间了</span><span>。CCD传感器因为原理的关系，只能全帧曝光。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;</span><span>逐行曝光：Sensor通电后，感光二极管是一行一行开始工作的，你必须控制是哪一行曝光，然后计算总的曝光时间。</span><span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;下面贴一段控制逐行曝光的驱动代码，以说明快门控制的过程。（camera模组是美光的）&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;函数解释：&nbsp;</span><span>PVOID IIC_Write16bit(WORD addr, DWORD value)</span><span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[函数功能] 写寄存器&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[参数] addr:寄存器地址；&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value:要写入到寄存器对应地址的值&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[函数返回] NULL&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DWORD IIC_Read16bit(WORD addr)</span><span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[函数功能] 读寄存器&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[参数] addr:要读出的寄存器地址&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[函数返回] 从对应寄存器地址读出的值&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PWOID WaitTime_ms(DWORD waittime)</span><span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[函数功能] 字面意思，等待&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[参数] waittime:等待时间，单位毫秒&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[函数返回] NULL&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;寄存器地址解释：&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0x09:&nbsp;</span><span>存储曝光时间值&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xf0:&nbsp;</span><span>存储预置动作值&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xc8:&nbsp;</span><span>存储快门状态值&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;IIC_Write16bit(0xf0, 0x0000);&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;dataTemp = IIC_Read16bit(0x09); //读取曝光时间值&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;gCurbrightness1 = dataTemp; //快门时间存入变量，后续做处理&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;WaitTime_ms(10);&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;IIC_Write16bit(0x09, dataTemp*2/7); //写入新曝光时间值为原来的2/7&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;IIC_Write16bit(0xf0, 0x0001); //将所有要新写入的寄存器地址预置为1&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;IIC_Write16bit(0xc6, 0x2225);&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;dataTemp = IIC_Read16bit(0xc8); //读取快门状态&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;gCurbrightness2 = dataTemp; //快门状态存入变量，后续做判断处理&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;WaitTime_ms(10);&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;IIC_Write16bit(0xf0, 0x0000); //将所有要新写入的寄存器地址预置为1&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;IIC_Write16bit(0x65, 0xB000); // CLOCK_ENABLING&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;IIC_Write16bit(0x65, 0xE000); // CLOCK_ENABLING&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;WaitTime_ms(600); // Wait 1 frame time&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;以上就是驱动控制快门状态的简单案例。实际中比较复杂一点的camera模组，是不会这样去直接控制快门时间长短的。Post-ISP已经内置了测光模式和光圈控制的过程，需要调试的就是一组辅助系数而已。</span><span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;一个camera的驱动中，快门调试往往是最繁琐的，需要大工作量的去调试代码。快门控制关系到最CCD/CMOS最基本的保存光线数据的正确性，即原始图像数据的素质。如果连最基本的感光都做不到正确，还谈什么图像处理呢？原始图像数据就是一堆没法还原的垃圾了，谁也不能把它变成黄金啊。 另外的，像测光控制，因为手机的camera没有独立的测光元件和被测光路，所以都是直接用CMOS/CCD来测光的，然后再Post-ISP中调整快门+光圈+ISO的组合。用CMOS/CCD来测光，优点是可以自由选择测光点，不需要额外的测光系统，成本低，缺点是测光速度较慢，复杂光线下测光不准确等。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;</span><span>Post-ISP控制项目之二 对焦控制</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font face="微软雅黑, Arial, HELVETICA"><span><span><span><span><span><span><span><span><span>&nbsp;&nbsp;</span><span><span><span><span><span><span><span><span><span><span><span><span>大家都知道，如果摄像头素质高一点的话，一般都会带有AF功能。AF=Auto Focus，自动对焦功能。 而Post-ISP可以控制VCM(音圈对焦马达)模块的状态，即实现了对焦点的控制。 关于自动对焦，这又是一门非常精深的学问了，发展了几十年，衍生出了数百种对焦的技术。目前相机厂家的对焦方式还不尽相同。我不太了解这么精深的学问，那么，我们就来说浅显一点的吧。 目前常见自动对焦的类型分为</span><span>相位检测自动对焦</span><span>和</span><span>反差式自动对焦</span><span>两种原理，另外富士等公司也开发出大规模应用的新对焦技术了。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font face="微软雅黑, Arial, HELVETICA"><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;相位检测自动对焦：</span><span>&nbsp;多单反和高端DC采用。相位检测对焦，要在相机内部另外加一个线性传感器(只用来对焦)和分离镜头。当开始对焦时，光线首先被反光板反射到分离镜头上，这时候主CCD/CMOS是不工作的，而线性传感器是工作的。分离镜头会把光线分为两束，这两速光线经分离镜头后会重新投射到线性传感器上，如果焦点是对准的，那两束光线会聚集到线性传感器表平面，则线性传感器的感光二极管受到的光强最强。以此来做对焦的检测和预测。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;相位检测自动对焦的优点是快速，焦点准确。缺点是焦点需要经电路设计实现，不可触摸对焦，而且实现复杂，暗光线下难以合焦（拉风箱）。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021141137501?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;贴一段无忌的原话，来描述相位检测自动对焦的过程：&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 调焦准确时见图中(a)，我们用AB来表示作为基准的一对CCD元件之间的距离。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 当调焦不准时，有两种可能性。一种是镜头焦点在被摄体之前，见图中 (b)。此时受光的两只CCD元件之间的距离短于AB；另一种情况是镜头焦点在被摄体之后，见图中(c)，此时受光的两只CCD元件之间的距离长于AB， 根据受光的一对CCD元件之间的距离，就能鉴别出焦点是否准确。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; 两只CCD元件所产生的电信号经过转换电路和模拟/数字转换电路，再送入照相机内的 CPU(中央处理单元)，CPU按照厂家所设定的程序及根据这对CCD元件的距离与AB的差值，可计算出散焦量(即实际焦点与准确焦点之差)以及散焦方向。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font face="微软雅黑, Arial, HELVETICA"><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;<span>反差式自动对焦</span>：</span>多手机和卡片DC采用。就是传感器通电开始工作，不断的把画面通过DSP转换后传给Post-ISP，Post-ISP就开始对不断的进行画面分析和比较了，控制对焦镜片来回移动，当检测到最佳的反差时停止移动镜片。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font face="微软雅黑, Arial, HELVETICA"><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;<span>优点是结构简单，焦点自由选择，可改善余地大；缺点是对焦镜片需要来回移动（拉风箱），速度慢，费电，焦点不准确。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font face="微软雅黑, Arial, HELVETICA"><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021141221949?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span>&nbsp;</span><span>于是，我们知道了，相位检测自动对焦和反差自动对焦的优缺点。 手机和卡片DC，受限于体积大小和结构需要简化等因素，所以不会采用相位检测对焦。虽然这样的自动对焦准确性会降低，但也带来了体积简化成本降低的好处，而且因为手机的摄像头一般不会有长焦端，所以对焦点精度的要求并不需要那么高。 而且对焦技术还在不停的发展，未来如果出现了兼顾体积和精度的对焦技术，说不定很快就会产业化，我们拭目以待吧。</span>&nbsp;<span>关于Post-ISP其他的功能，对于并没有对图像进行直接处理，而多和电路设计，ID设计有关，这里就略过不提了。</span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span>Camera结构三 光学镜头(Lens)</span></span></span></span></span><span><span><span><span>&nbsp;</span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span>&nbsp; &nbsp;&nbsp;</span><span>说到重点来了，可惜这个重点咱们要简短的说，因为我对于光学，实在是苦手一名。 相对于传感器和DSP的飞速发展，光学技术的发展已经相当成熟。 一家以消费电子为研发主体的企业，想要转型为专业相机研发企业，是非常困难的，如果不通过收购或者技术购买，想要开发出自己的光学系统，无疑可能性非常的小。 这也就是光学技术的壁垒过高，长期的技术和经验累积，对于光学公司来说是非常重要的。 你看，那些玩摄影的发烧友人，一般都会投入几倍甚至十倍与机身的金钱，去升级自己的镜头群。而数万块天朝币的镜头比比皆是，甚至是一些玩家的标配头，挂机头。足以见光学素质，对于成像的重要性。 光学特性对于一个相机或者手机来说，完全体现于镜头的光学素质。 而相比传感器来说，光学特性对于画质，完全是覆盖级别的关系。成像所需的方方面面点点滴滴，光学特性的好坏对其都会有直接影响。 然而因为过于博大和精深，我们这里不可能从透镜成像开始说起，也不可能一一介绍弥散圆，像差，锐利判定等概念，当然后面涉及的信号与系统，什么Nyquist采样定理就更无从谈起了。 当然，关于镜头的镜片数目和结构，以及镜片研磨，材料选用，透光率等，也就不说了，因为展开来说，对于消费者的认知也没多大帮助。 咱们就从功能粗浅的说说，然后再粗浅的说说的镜头对画质影响，反正咱就是个粗浅的大老爷们儿。</span></span></span></span></span><br> </span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;</span><span><span><span><span><span>一 功能性</span></span></span></span></span><span><span><span><span><span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;镜头的规格最大程度的影响拍照的功能，以下说明可以去各大摄影论坛找教学贴来科普一下。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;1. 焦段覆盖</span></span></span></span><span><span><span><span>&nbsp;焦段覆盖直接影响你的疲劳程度，也就是得走多少路。定焦么就是所谓 的变焦基本靠走。 拍风景少不了广角，拍野生动物少不了长焦。 否则风光摄影师可能会因为走远一点而跌入悬崖，而动物摄影师可能会因为走近一点被狮子吃了。 以上结论：焦段影响性命……&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;2. 焦点</span></span></span></span><span><span><span><span>&nbsp;焦点直接影响视野角度，景深和透视感。 广角端入射角度大，光线强度高，景深大，透视感强。 长焦端入射角度小，光线强度低，景深小，透视感弱。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;3. 放大倍率，物距，最近对焦距离</span></span></span></span><span><span><span><span>&nbsp;简而言之影响微距效果。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;4. 光圈</span></span></span></span><span><span><span><span>&nbsp;光圈直接影响曝光和景深，也就是影响快门时间和透视感。 有大光圈你可以提高快门时间，减少手抖动带来的画面模糊，或者高ISO带来的画面噪点。&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;5. 特殊功能的实现</span></span></span></span><span><span><span><span>&nbsp;比如鱼眼镜头，移轴镜头，柔焦镜头等，实现特殊的画面效果。 这些特殊效果也可以用后期处理来实现，不过处理带来的画质损失以及不自然感就看你自己选择了。能用前端的光学性能达到的效果，就尽量不要用后期处理。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;<span><span><span><span><span>二 MTF与画质</span></span></span></span></span><span><span><span><span>&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp; &nbsp;说到这里，我来问问大家，画质的评判标准是什么？ 画面细节？画面纯净度？色彩还原？ 呵呵，其实，这些都可以用解像力来概括，或者被解像力间接的影响到。 解像力简单的说就是量度、计算影像从清晰-&gt;模糊之间的转换点(通俗点称之为分辨率)。每一个镜头都有其分辨能力的极限，比如一个光学分辨率为500万像素的镜头，你在它的成像圈内放一个1000万像素的CMOS传感器，那你是白瞎了这块CMOS了。 简而言之嘛，镜头画质大部分和分辨率和反差有关。</span></span></span></span><span><span><span><span>而MTF曲线，就是衡量一款镜头的分辨率和反差的曲线</span></span></span></span><span><span><span><span>。 下面我们就来说说MTF(Modulation Transfer Function)，中文名称为调制传递函数。&nbsp;</span></span></span></span><span><span><span><span>首先快速介绍一些概念：</span></span></span></span><span><span><span><span>&nbsp;</span></span></span></span><span><span><span><span>正弦光栅：</span></span></span></span><span><span><span><span>亮度按正弦变化的周期图形叫做“正弦光栅”；</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021142001450?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;&nbsp;<span><span><span><span>空间频率：</span></span></span></span><span><span><span><span>单位长度(每毫米)的亮度按照正弦变化的图形的周期数，单位是线对/毫米(lines/mm)；&nbsp;</span></span></span></span><span><span><span><span>最大亮度：</span></span></span></span><span><span><span><span>设为Imax&nbsp;</span></span></span></span><span><span><span><span>最小亮度：</span></span></span></span><span><span><span><span>设为Imin&nbsp;</span></span></span></span><span><span><span><span>调制度：</span></span></span></span><span><span><span><span>M=(Imax－Imin)/(Imax＋Imin)&nbsp;</span></span></span></span><span><span><span><span>MTF值：</span></span></span></span><span><span><span><span>设正弦光栅原本的调制度为M，而正弦光栅透过镜头后，到达成像平面的图像的调制度为M’，则MTF值= M’/M 所以，MTF的值越接近1，镜头成像素质越好（光线通过镜头后解像力完全不变）；&nbsp;</span></span></span></span><span><span><span><span>S曲线和M曲线：</span></span></span></span><span><span><span><span>镜头是光中心轴的中心圆形对称结构，像场中心各个方向的MTF值是相同的。但是镜头有散性，在偏离中心的位置，沿切线方向的线条与沿径向方向的线条的MTF值是不同的！S曲线：平行于直径的线条产生的MTF曲线称为弧矢曲线，标为S (sagittal)；M曲线：而将平行于切线的线条产生的MTF曲线称为子午曲线，标为M(meridional)。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20161021142113281?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
  <p> <span><span><span><span><span><span><span><span><span><span><font size="4"><font><font><font><font><font><font><font><font><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span><span>&nbsp;&nbsp;<span><span><span><span>空间频率很低时，MTF值趋于一个接近于1，即镜头对大尺寸色块的反差。随着空间频率增高，MTF值逐渐下降，直到趋于0。</span></span></span></span><span><span><span><span></span></span></span></span><span><span><span><span>肉眼分辨的反差极限是MTF = 0.03。</span></span></span></span><span><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></font></font></font></font></font></font></font></font></font></span></span></span></span></span></span></span></span></span></span></p> 
 </div> 
 <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-258a4616f7.css" rel="stylesheet"> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
