<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Wireshark1.12.3的使用（抓包、过滤器）及遇到的问题解决 « NotBeCN</title>
  <meta name="description" content="         &nbsp;   the capture session could not be initiated on interface"\Device\NPF_(78032B7E-4968-42D3-9F37-287EA86C0AAA)" (failed to set hardware filter ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2019/05/11/Game_jqd_90116312.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Wireshark1.12.3的使用（抓包、过滤器）及遇到的问题解决</h1>
    <p class="post-meta">May 11, 2019</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">the capture session could not be initiated on interface"\Device\NPF_(78032B7E-4968-42D3-9F37-287EA86C0AAA)" (failed to set hardware filter to promiscuous mode).</p> 
  <p style="margin-left:0cm;">please check to make sure you have sufficient permissions and that you have the proper interface or pipe specified</p> 
  <p style="margin-left:0cm;">解决方法：</p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">打开菜单项“Capture”下的子菜单“Capture Options”选项；</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">找到设置面板中有一项“Capture all in promiscuous mode”选项；</span><br><span style="color:#333333;">“Capture all in promiscuous mode”选项默认是选中状态，修改该状态为未选中状态；</span></p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">/////////////////////////////////////////////使用////////////////////////////////////</p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="208" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190511224543740.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dhbWVfanFk,size_16,color_FFFFFF,t_70" width="375"></p> 
  <p style="margin-left:0cm;"><img alt="" class="has" height="277" src="https://uzshare.com/_p?https://img-blog.csdnimg.cn/20190511224543765.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0dhbWVfanFk,size_16,color_FFFFFF,t_70" width="535"></p> 
  <p style="margin-left:0cm;">1）ip.addr==192.168.5.6，只显示192.168.5.6这个地址相关数据包</p> 
  <p style="margin-left:0cm;">2）frame.len&lt;=128，只查看长度小于128字节的数据包</p> 
  <p style="margin-left:0cm;">3）http，只显示http数据包</p> 
  <p style="margin-left:0cm;">4）ip.addr==192.168.5.6 &amp;&amp;&nbsp;tcp.port==15566，只显示与192.168.5.6有关且与tcp端口15566有关的数据包</p> 
  <p style="margin-left:0cm;">ip.src&nbsp;eq&nbsp;192.168.1.107&nbsp;or&nbsp;ip.dst&nbsp;eq&nbsp;192.168.1.107</p> 
  <p style="margin-left:0cm;">或者ip.addr&nbsp;eq&nbsp;192.168.1.107&nbsp;//&nbsp;都能显示来源IP和目标IP</p> 
  <p style="margin-left:0cm;">tcp.port&nbsp;eq&nbsp;80&nbsp;//&nbsp;不管端口是来源的还是目标的都显示</p> 
  <p style="margin-left:0cm;">tcp.port&nbsp;==&nbsp;80</p> 
  <p style="margin-left:0cm;">tcp.port&nbsp;eq&nbsp;2722</p> 
  <p style="margin-left:0cm;">tcp.port&nbsp;eq&nbsp;80&nbsp;or&nbsp;udp.port&nbsp;eq&nbsp;80</p> 
  <p style="margin-left:0cm;">tcp.dstport&nbsp;==&nbsp;80&nbsp;//&nbsp;只显tcp协议的目标端口80</p> 
  <p style="margin-left:0cm;">tcp.srcport&nbsp;==&nbsp;80&nbsp;//&nbsp;只显tcp协议的来源端口80</p> 
  <p style="margin-left:0cm;">udp.port&nbsp;eq&nbsp;15000</p> 
  <p style="margin-left:0cm;">过滤端口范围</p> 
  <p style="margin-left:0cm;">tcp.port&nbsp;&gt;=&nbsp;1&nbsp;and&nbsp;tcp.port&nbsp;&lt;=&nbsp;80</p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">tcp udp arp icmp http smtp ftp dns msnms ip ssl oicq bootp</span><span style="color:#333333;">等等排除arp如!arp&nbsp;not&nbsp;arp</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">太以网头过滤</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">eth.dst&nbsp;==&nbsp;A0:00:00:04:C5:84&nbsp;//&nbsp;</span><span style="color:#333333;">过滤目标mac</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">eth.src&nbsp;eq&nbsp;A0:00:00:04:C5:84&nbsp;//&nbsp;</span><span style="color:#333333;">过滤来源mac</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">eth.dst==A0:00:00:04:C5:84</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">eth.dst==A0-00-00-04-C5-84</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">eth.addr&nbsp;eq&nbsp;A0:00:00:04:C5:84&nbsp;//&nbsp;</span><span style="color:#333333;">过滤来源MAC和目标MAC都等于A0:00:00:04:C5:84的less&nbsp;than&nbsp;小于&nbsp;&lt;&nbsp;lt&nbsp;小于等于&nbsp;le等于&nbsp;eq大于&nbsp;gt大于等于&nbsp;ge不等&nbsp;ne</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">udp.length&nbsp;==&nbsp;26&nbsp;</span><span style="color:#333333;">这个长度是指udp本身固定长度8加上udp下面那块数据包之和</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">tcp.len&nbsp;&gt;=&nbsp;7&nbsp;&nbsp;&nbsp;</span><span style="color:#333333;">指的是ip数据包(tcp下面那块数据),不包括tcp本身</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">ip.len&nbsp;==&nbsp;94&nbsp;</span><span style="color:#333333;">除了以太网头固定长度14,其它都算是ip.len,即从ip本身到最后</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">frame.len&nbsp;==&nbsp;119&nbsp;</span><span style="color:#333333;">整个数据包长度,从eth开始到最后</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">eth&nbsp;—&gt;&nbsp;ip&nbsp;or&nbsp;arp&nbsp;—&gt;&nbsp;tcp&nbsp;or&nbsp;udp&nbsp;—&gt;&nbsp;data</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http.request.method&nbsp;==&nbsp;“GET”</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http.request.method&nbsp;==&nbsp;“POST”</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http.request.uri&nbsp;==&nbsp;“/img/logo-edu.gif”</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http&nbsp;contains&nbsp;“GET”</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http&nbsp;contains&nbsp;“HTTP/1.”</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">//&nbsp;GET</span><span style="color:#333333;">包</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http.request.method&nbsp;==&nbsp;“GET”&nbsp;&amp;&amp;&nbsp;http&nbsp;contains&nbsp;“Host:&nbsp;“</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http.request.method&nbsp;==&nbsp;“GET”&nbsp;&amp;&amp;&nbsp;http&nbsp;contains&nbsp;“User-Agent:&nbsp;“</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">//&nbsp;POST</span><span style="color:#333333;">包</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http.request.method&nbsp;==&nbsp;“POST”&nbsp;&amp;&amp;&nbsp;http&nbsp;contains&nbsp;“Host:&nbsp;“</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http.request.method&nbsp;==&nbsp;“POST”&nbsp;&amp;&amp;&nbsp;http&nbsp;contains&nbsp;“User-Agent:&nbsp;“</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">//&nbsp;</span><span style="color:#333333;">响应包</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http&nbsp;contains&nbsp;“HTTP/1.1&nbsp;200&nbsp;OK”&nbsp;&amp;&amp;&nbsp;http&nbsp;contains&nbsp;“Content-Type:&nbsp;“</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">http&nbsp;contains&nbsp;“HTTP/1.0&nbsp;200&nbsp;OK”&nbsp;&amp;&amp;&nbsp;http&nbsp;contains&nbsp;“Content-Type:&nbsp;“</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">一定包含如下</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">Content-Type:</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">tcp.flags&nbsp;</span><span style="color:#333333;">显示包含TCP标志的封包。</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">tcp.flags.syn&nbsp;==&nbsp;0x02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:#333333;">显示包含TCP&nbsp;SYN标志的封包。</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">tcp.window_size&nbsp;==&nbsp;0&nbsp;&amp;&amp;&nbsp;tcp.flags.reset&nbsp;!=&nbsp;1</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">tcp[20]</span><span style="color:#333333;">表示从</span><span style="color:#333333;">20</span><span style="color:#333333;">开始，取</span><span style="color:#333333;">1</span><span style="color:#333333;">个字符</span></p> 
  <p style="margin-left:0cm;"><span style="color:#333333;">tcp[20:]</span><span style="color:#333333;">表示从20开始，取1个字符以上</span></p> 
  <p style="margin-left:0cm;">tcp[20:8]表示从20开始，取8个字符</p> 
  <p style="margin-left:0cm;">tcp[offset,n]</p> 
  <p style="margin-left:0cm;">udp[8:3]==81:60:03&nbsp;//&nbsp;偏移8个bytes,再取3个数，是否与==后面的数据相等？</p> 
  <p style="margin-left:0cm;">udp[8:1]==32&nbsp;&nbsp;&nbsp;如果我猜的没有错的话，应该是udp[offset:截取个数]=nValue</p> 
  <p style="margin-left:0cm;">eth.addr[0:3]==00:06:5B</p> 
  <p style="margin-left:0cm;">例子:</p> 
  <p style="margin-left:0cm;">判断upd下面那块数据包前三个是否等于0x20&nbsp;0x21&nbsp;0x22</p> 
  <p style="margin-left:0cm;">我们都知道udp固定长度为8</p> 
  <p style="margin-left:0cm;">udp[8:3]==20:21:22</p> 
  <p style="margin-left:0cm;">判断tcp那块数据包前三个是否等于0x20&nbsp;0x21&nbsp;0x22</p> 
  <p style="margin-left:0cm;">tcp一般情况下，长度为20,但也有不是20的时候</p> 
  <p style="margin-left:0cm;">tcp[8:3]==20:21:22</p> 
  <p style="margin-left:0cm;">如果想得到最准确的，应该先知道tcp长度</p> 
  <p style="margin-left:0cm;">matches(匹配)和contains(包含某字符串)语法</p> 
  <p style="margin-left:0cm;">ip.src==192.168.1.107&nbsp;and&nbsp;udp[8:5]&nbsp;matches&nbsp;“\\x02\\x12\\x21\\x00\\x22″ &nbsp; &nbsp; &nbsp; &nbsp;------???--------</p> 
  <p style="margin-left:0cm;">ip.src==192.168.1.107&nbsp;and&nbsp;udp&nbsp;contains&nbsp;02:12:21:00:22</p> 
  <p style="margin-left:0cm;">ip.src==192.168.1.107&nbsp;and&nbsp;tcp&nbsp;contains&nbsp;“GET”</p> 
  <p style="margin-left:0cm;">udp&nbsp;contains&nbsp;7c:7c:7d:7d&nbsp;匹配payload中含有0x7c7c7d7d的UDP数据包，不一定是从第一字节匹配。</p> 
  <p style="margin-left:0cm;">得到本地qq登陆数据包(判断条件是第一个包==0x02,第四和第五个包等于0x00x22,最后一个包等于0x03)</p> 
  <p style="margin-left:0cm;">0x02&nbsp;xx&nbsp;xx&nbsp;0x00&nbsp;0x22&nbsp;…&nbsp;0x03</p> 
  <p style="margin-left:0cm;">如何拼写过虑条件？？？</p> 
  <p style="margin-left:0cm;">&nbsp; &nbsp;&nbsp;</p> 
  <p style="margin-left:0cm;">udp[11:2]==00:00&nbsp;表示命令编号为00:00</p> 
  <p style="margin-left:0cm;">udp[11:2]==00:80&nbsp;表示命令编号为00:80</p> 
  <p style="margin-left:0cm;">当命令编号为00:80时，QQ号码为00:00:00:00</p> 
  <p style="margin-left:0cm;">得到msn登陆成功账号(判断条件是”USR&nbsp;7&nbsp;OK&nbsp;“,即前三个等于USR，再通过两个0x20，就到OK,OK后面是一个字符0x20,后面就是mail了)</p> 
  <p style="margin-left:0cm;">USR&nbsp;xx&nbsp;OK&nbsp;mail@hotmail.com</p> 
  <p style="margin-left:0cm;">正确</p> 
  <p style="margin-left:0cm;">msnms&nbsp;and&nbsp;tcp&nbsp;and&nbsp;ip.addr==192.168.1.107&nbsp;and&nbsp;tcp[20:]&nbsp;matches&nbsp;“^USR\\x20[\\x30-\\x39]+\\x20OK\\x20[\\x00-\\xff]+”</p> 
  <p style="margin-left:0cm;">注意：DHCP协议的检索规则不是dhcp/DHCP， 而是bootp</p> 
  <p style="margin-left:0cm;">以寻找伪造DHCP服务器为例，介绍Wireshark的用法。在显示过滤器中加入过滤规则，</p> 
  <p style="margin-left:0cm;">显示所有非来自DHCP服务器并且bootp.type==0x02（Offer/Ack/NAK）的信息：</p> 
  <p style="margin-left:0cm;">bootp.type==0x02&nbsp;and&nbsp;not&nbsp;ip.src==192.168.1.1</p> 
  <p style="margin-left:0cm;">常用捕获过滤器：</p> 
  <p style="margin-left:0cm;">tcp[13]&amp;32==32 (设置了URG位的TCP数据包)</p> 
  <p style="margin-left:0cm;">tcp[13]&amp;16==16 (设置了ACK位的TCP数据包)</p> 
  <p style="margin-left:0cm;">tcp[13]&amp;8==8 (设置了PSH位的TCP数据包)</p> 
  <p style="margin-left:0cm;">tcp[13]&amp;4==4 (设置了RST位的TCP数据包)</p> 
  <p style="margin-left:0cm;">tcp[13]&amp;2==2 (设置了SYN位的TCP数据包)</p> 
  <p style="margin-left:0cm;">tcp[13]&amp;1==1 (设置了FIN位的TCP数据包)</p> 
  <p style="margin-left:0cm;">tcp[13]==18 (TCP SYN-ACK 数据包)</p> 
  <p style="margin-left:0cm;">ether host 00:00:00:00:00:00 (流入或流出MAC地址的流量,替换为你的mac)</p> 
  <p style="margin-left:0cm;">!ether host 00:00:00:00:00:00 (不流入或流出MAC地址的流量,替换为你的mac)</p> 
  <p style="margin-left:0cm;">broadcast (仅广播流量)</p> 
  <p style="margin-left:0cm;">icmp (ICMP流量)</p> 
  <p style="margin-left:0cm;">icmp[0:2]==0x0301 (ICMP目标不可达、主机不可达)</p> 
  <p style="margin-left:0cm;">ip (仅IPv4流量)</p> 
  <p style="margin-left:0cm;">ip6 (仅IPv6流量)</p> 
  <p style="margin-left:0cm;">udp (仅UDP流量)</p> 
  <p style="margin-left:0cm;">常用显示过滤器：</p> 
  <p style="margin-left:0cm;">！tcp.port==3389 (排除RDP流量)</p> 
  <p style="margin-left:0cm;">tcp.flags.syn==1 (具有SYN标志位的TCP数据包)</p> 
  <p style="margin-left:0cm;">tcp.flags.rst==1 (具有RST标志位的TCP数据包)</p> 
  <p style="margin-left:0cm;">!arp (排除ARP流量)</p> 
  <p style="margin-left:0cm;">http (所有HTTP流量)</p> 
  <p style="margin-left:0cm;">tcp.port==23||tcp.port ==21 (FTP或telnet)</p> 
  <p style="margin-left:0cm;">smtp||pop||imap (smtp、pop或imap)</p> 
  <p style="margin-left:0cm;">混杂模式：开启混杂模式的网卡可以捕获所有流过该网卡的帧，不开启则只能捕获广播帧以及发给该网卡的帧。需要配合交换机端口镜像才能实现。</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">抓包过滤器：</p> 
  <p style="margin-left:0cm;">1、ethernet过滤器，第二层的过滤器，根据mac地址来进行过滤</p> 
  <p style="margin-left:0cm;">例：</p> 
  <p style="margin-left:0cm;">ether host XX：抓取源和目的为指定的mac的以太网帧</p> 
  <p style="margin-left:0cm;">ether dst XX：抓取目的为指定mac的以太网帧</p> 
  <p style="margin-left:0cm;">ether src XX：抓取源为指定mac的以太网帧</p> 
  <p style="margin-left:0cm;">ether broadcast:抓取所有以太网广播流量</p> 
  <p style="margin-left:0cm;">ether multicast:抓取多播流量</p> 
  <p style="margin-left:0cm;">ether proto &lt;protocol&gt;:抓取指定协议的以太网流量，比如以太网类型为0x0800,ether proto 0800。以太网类型指的是以太网帧帧头的ether-type字段，表示上层的协议类型。0x0800为ipv4、0x86dd为ipv6、0x0806为arp。</p> 
  <p style="margin-left:0cm;">vlan &lt;vlan_id&gt;:抓取指定的vlan流量，也可以用and连接抓取多个vlan的流量，如：vlan &lt;vlan_id&gt; and vlan &lt;vlan_id&gt; and vlan &lt;vlan_id&gt;</p> 
  <p style="margin-left:0cm;">要起反作用可以用!或者not，如：</p> 
  <p style="margin-left:0cm;">! ether broadcast</p> 
  <p style="margin-left:0cm;">not ether broadcast</p> 
  <p style="margin-left:0cm;">2、主机和网络过滤器，第三层过滤器</p> 
  <p style="margin-left:0cm;">ip或ipv6:抓取ipv4或ipv6流量</p> 
  <p style="margin-left:0cm;">host &lt;host&gt;:抓取源或目的为指定主机名（网址）或ip的流量</p> 
  <p style="margin-left:0cm;">dst host &lt;host&gt;:抓取目的为指定主机名（网址）或ip的流量</p> 
  <p style="margin-left:0cm;">src host &lt;host&gt;:抓取源为指定主机名（网址）或ip的流量</p> 
  <p style="margin-left:0cm;">gateway &lt;host&gt;：抓取穿越网关的流量，host必须是主机名。</p> 
  <p style="margin-left:0cm;">net &lt;net&gt;:抓取源或目的为指定网络号的流量，如：net 192.168.1或net 192.168.1.0</p> 
  <p style="margin-left:0cm;">dst net &lt;net&gt;:抓取目的为指定网络号的流量</p> 
  <p style="margin-left:0cm;">src net &lt;net&gt;:抓取源为指定网络号的流量</p> 
  <p style="margin-left:0cm;">net &lt;net&gt; mask &lt;netmask&gt;:抓取源或目的由net和mask共同指明的ipv4网络号的流量，ipv6流量无效。如：net 192.168.1.0 mask 255.255.255.0</p> 
  <p style="margin-left:0cm;">dst net &lt;net&gt; mask &lt;netmask&gt;:抓取目的由net和mask共同指明的ipv4网络号的流量，ipv6流量无效。</p> 
  <p style="margin-left:0cm;">src net &lt;net&gt; mask &lt;netmask&gt;:抓取源由net和mask共同指明的ipv4网络号的流量，ipv6流量无效。</p> 
  <p style="margin-left:0cm;">net &lt;net&gt;/&lt;len&gt;:抓取源或目的为指定网络和长度的流量,如：net 192.168.1.0/24</p> 
  <p style="margin-left:0cm;">dst net &lt;net&gt;/&lt;len&gt;:抓取目的为指定网络和长度的流量</p> 
  <p style="margin-left:0cm;">src net &lt;net&gt;/&lt;len&gt;:抓取源为指定网络和长度的流量</p> 
  <p style="margin-left:0cm;">broadcast：抓取ip广播包，通常如：ip broadcast</p> 
  <p style="margin-left:0cm;">multicast: 抓取ip多播包</p> 
  <p style="margin-left:0cm;">ip proto &lt;protocol code&gt;:抓取ip包头协议类型字段值等于特定值的数据包。如：tcp为6，udp为17，icmp为1</p> 
  <p style="margin-left:0cm;">ip6 proto &lt;protocol&gt;: 抓取ipv6包头中下一个包头字段值等于特定值的ipv6数据包。无法用该原词根据ipv6扩展包头链中的相关字段值执行过滤。</p> 
  <p style="margin-left:0cm;">icmp [icmptype]==&lt;identifier&gt;:抓取特定类型[icmptype]的icmp数据包，&lt;identifier&gt;表示的是icmp头部中的类型字段值，如，0（icmp echo reply数据包）或8（icmp echo request数据包）等。如：icmp[icmptype]==icmp-echo 或 icmp[icmptype]==8</p> 
  <p style="margin-left:0cm;">ip[2:2]==&lt;number&gt;:抓取指定长度的ip数据包（number表示ip包头中的ip包总长度字段值）</p> 
  <p style="margin-left:0cm;">ip[8]==&lt;number&gt;:抓取具有指定ttl的ip数据包（number表示ip包头中的ttl字段值）</p> 
  <p style="margin-left:0cm;">ip[9]==&lt;number&gt;:抓取指定协议类型的ip数据包（number表示ip包头中的协议类型字段值）</p> 
  <p style="margin-left:0cm;">ip[12:4]==ip[16:4]：表示数据包源和目的ip相同</p> 
  <p style="margin-left:0cm;">注:中括号内的数字表示相关协议头部的内容，第一个数字指从协议头部的第几个字节开始关注，第二个数字表示所要关注的字节数。</p> 
  <p style="margin-left:0cm;">3、tcp和udp及端口过滤，第四层</p> 
  <p style="margin-left:0cm;">port &lt;port&gt;：匹配port指明的端口号,如：port 80或port http</p> 
  <p style="margin-left:0cm;">dst port &lt;port&gt;:目的端口号为指定的端口号</p> 
  <p style="margin-left:0cm;">src port &lt;port&gt;:源端口号为指定的端口号</p> 
  <p style="margin-left:0cm;">tcp portrange &lt;p1&gt;-&lt;p2&gt;或udp portrange &lt;p1&gt;-&lt;p2&gt;：用来抓取端口范围介于p1和p2之间的tcp或udp数据包</p> 
  <p style="margin-left:0cm;">tcp src portrange &lt;p1&gt;-&lt;p2&gt;或udp dst portrange &lt;p1&gt;-&lt;p2&gt;</p> 
  <p style="margin-left:0cm;">tcp [tcpflags] &amp; (tcp-syn|tcp-fin)!=0：抓取tcp连接中用来发起连接（syn标记位置1）或终止连接（FIN标记位置1）的数据包</p> 
  <p style="margin-left:0cm;">tcp [tcpflags] &amp;(tcp-rst)!=0：抓取所有RST标记位置1的TCP数据包，RST标记位用来立刻拆除连接，PSH用来表示将数据提交给末端进程处理。</p> 
  <p style="margin-left:0cm;">less &lt;length&gt;：抓取不长于指定长度的数据包，写法等价于：len &lt;= &lt;length&gt;</p> 
  <p style="margin-left:0cm;">greater &lt;length&gt;：抓取不短于标识符指定的长度的数据包，写法等价于：len &gt;= &lt;length&gt;</p> 
  <p style="margin-left:0cm;">tcp portrange 2000-2500:抓取端口在这个范围内的tcp数据包</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x00=0：抓取所有标记位都未置1的tcp流量（在怀疑遭遇空扫描攻击时使用）</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x01=1：抓取FIN位置1，但ACK位置0的TCP流量</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x03=3：抓取SYN和FIN位同时置1的TCP流量</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x05=5：抓取RST和FIN位同时置1的TCP流量</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x06=6：抓取SYN和RST位同时置1的TCP流量</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x08=8：抓取PSH位置1，但ACK位置0的TCP流量</p> 
  <p style="margin-left:0cm;">//13指代TCP头部中的标记字段，‘=’号后面数字表示tcp标记位的置位情况。0表示标记位都没置1，1表示FIN位置1，但ACK位置0，1+2表示SYN和FIN位同时置1，1+4表示RST和FIN同时置1，2+4表示SYN和RST同时置1，8表示PSH位置1，但ACK置0.</p> 
  <p style="margin-left:0cm;">4、复合过滤器</p> 
  <p style="margin-left:0cm;">!或not</p> 
  <p style="margin-left:0cm;">&amp;&amp;或and</p> 
  <p style="margin-left:0cm;">||或or</p> 
  <p style="margin-left:0cm;">例子：</p> 
  <p style="margin-left:0cm;">not braodcast and not multicast 只抓单播</p> 
  <p style="margin-left:0cm;">host www.youtube.com and port 80 抓取往来于youtube站点的http流量</p> 
  <p style="margin-left:0cm;">tcp port 23 and host 192.180.1.1</p> 
  <p style="margin-left:0cm;">tcp port 23 and not src host 192.168.1.1</p> 
  <p style="margin-left:0cm;">5、配置字节偏移和净载匹配型过滤器，更加灵活</p> 
  <p style="margin-left:0cm;">格式： proto [offset:bytes]，协议可以是ip、udp、tcp</p> 
  <p style="margin-left:0cm;">协议 [从协议头部开始所偏移的字节数：抓包过滤器所要检查的字节数]</p> 
  <p style="margin-left:0cm;">tcp[2:2]&gt;50 and tcp[2:2]&lt;100 //抓取目的端口范围为50~100的tcp数据包</p> 
  <p style="margin-left:0cm;">tcp[14:2]&lt;8192 //抓窗口大小字段值低于8192的tcp数据包</p> 
  <p style="margin-left:0cm;">wireshark有字节偏移和净载匹配抓包过滤器生成工具：https://www.wireshark.org/tools/string-cf.html</p> 
  <p style="margin-left:0cm;">也可以看这篇文章http://www.packetlevel.ch/html/txt/byte_offsets.txt</p> 
  <p style="margin-left:0cm;">Intro</p> 
  <p style="margin-left:0cm;">This document is meant to serve as a quick reference for points</p> 
  <p style="margin-left:0cm;">of interest in IP, TCP, UDP and ICMP headers. I cobbled the</p> 
  <p style="margin-left:0cm;">information from a variety of sources, all listed at the bottom</p> 
  <p style="margin-left:0cm;">of this page. This information will (hopefully) be useful to</p> 
  <p style="margin-left:0cm;">people building filters for network tools that use BPF, such</p> 
  <p style="margin-left:0cm;">as tcpdump or snort. I was moved to collect all of this stuff</p> 
  <p style="margin-left:0cm;">in one place after completing "Intrusion Detection In-Depth"</p> 
  <p style="margin-left:0cm;">at a recent SANS conference. Yes, I'm aware that some of these</p> 
  <p style="margin-left:0cm;">offsets are covered by tcpdump macros. So what? Use the byte</p> 
  <p style="margin-left:0cm;">offsets instead and let them ph33r your m@d sk1lz. Corrections,</p> 
  <p style="margin-left:0cm;">additions and so on are welcome. Send them to:</p> 
  <p style="margin-left:0cm;">jquinby (at) node.to</p> 
  <p style="margin-left:0cm;">Cheers,</p> 
  <p style="margin-left:0cm;">JQ</p> 
  <p style="margin-left:0cm;">IP byte offsets</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">ip[0] &amp; 0x0f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - protocol version</p> 
  <p style="margin-left:0cm;">ip[0] &amp; 0xf0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - protocol options</p> 
  <p style="margin-left:0cm;">ip[0] &amp; 0xff00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - internet header length</p> 
  <p style="margin-left:0cm;">ip[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - TOS</p> 
  <p style="margin-left:0cm;">ip[2:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Total length</p> 
  <p style="margin-left:0cm;">ip[4:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - IP identification</p> 
  <p style="margin-left:0cm;">ip[6] &amp; 0xa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - IP flags</p> 
  <p style="margin-left:0cm;">ip[6:2] &amp; 0x1fff &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - fragment offset area</p> 
  <p style="margin-left:0cm;">ip[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - TTL</p> 
  <p style="margin-left:0cm;">ip[9]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - protocol field</p> 
  <p style="margin-left:0cm;">ip[10:2]&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - header checksum</p> 
  <p style="margin-left:0cm;">ip[12:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - src IP address</p> 
  <p style="margin-left:0cm;">ip[16:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - dst IP address</p> 
  <p style="margin-left:0cm;">ip[20:3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - options</p> 
  <p style="margin-left:0cm;">ip[24]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - padding</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Src IP = Dest IP (land attack)</p> 
  <p style="margin-left:0cm;">(ip[12:4] = ip[16:4])</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">IP versions !=4</p> 
  <p style="margin-left:0cm;">(ip[0] &amp; 0xf0 != 0x40)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">IP with options set:</p> 
  <p style="margin-left:0cm;">(ip[0:1] &amp; 0x0f &gt; 5)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Broadcasts to x.x.x.255:</p> 
  <p style="margin-left:0cm;">(ip[19] = 0xff)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Broadcasts to x.x.x.0</p> 
  <p style="margin-left:0cm;">(ip[19] = 0x00)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">TCP byte offsets, including anomalous TCP flag settings.</p> 
  <p style="margin-left:0cm;">=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">tcp[0:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - src port</p> 
  <p style="margin-left:0cm;">tcp[2:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - dst port</p> 
  <p style="margin-left:0cm;">tcp[4:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - seq number</p> 
  <p style="margin-left:0cm;">tcp[8:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - ack number</p> 
  <p style="margin-left:0cm;">tcp[12] &amp; 0x00ff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - data offset</p> 
  <p style="margin-left:0cm;">tcp[12] &amp; 0xff00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - reserved</p> 
  <p style="margin-left:0cm;">tcp[13]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - tcp flags</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x3f = 0&nbsp;&nbsp;&nbsp; - no flags set (null packet)</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x11 = 1&nbsp;&nbsp; - FIN set and ACK not set</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x03 = 3&nbsp;&nbsp; - SYN set and FIN set</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x05 = 5&nbsp;&nbsp; - RST set and FIN set</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x06 = 6&nbsp;&nbsp; - SYN set and RST set</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x18 = 8&nbsp;&nbsp; - PSH set and ACK not set</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0x30 = 0x20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - URG set and ACK not set</p> 
  <p style="margin-left:0cm;">tcp[13] &amp; 0xc0 != 0&nbsp; - &gt;= one of the reserved bits of tcp[13] is set</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">tcp[14:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - window</p> 
  <p style="margin-left:0cm;">tcp[16:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - checksum</p> 
  <p style="margin-left:0cm;">tcp[18:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - urgent pointer</p> 
  <p style="margin-left:0cm;">tcp[20:3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - options</p> 
  <p style="margin-left:0cm;">tcp[23]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - padding</p> 
  <p style="margin-left:0cm;">tcp[24]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - data</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">UDP byte offsets, header only</p> 
  <p style="margin-left:0cm;">=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">udp[0:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - src port</p> 
  <p style="margin-left:0cm;">udp[2:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - dst port</p> 
  <p style="margin-left:0cm;">udp[4:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - length</p> 
  <p style="margin-left:0cm;">udp[6:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - checksum</p> 
  <p style="margin-left:0cm;">udp[8:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - first 4 octets of data</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Crafted packets with impossible UDP lengths:</p> 
  <p style="margin-left:0cm;">udp[4:2] &lt; 0) or (udp[4:2] &gt; 1500</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">ICMP</p> 
  <p style="margin-left:0cm;">=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">icmp[0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - type</p> 
  <p style="margin-left:0cm;">icmp[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - code</p> 
  <p style="margin-left:0cm;">icmp[3:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - checksum</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Destination Unreachable:</p> 
  <p style="margin-left:0cm;">icmp[0] = 0x3 (3)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">icmp[4:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - unused (per RFC]</p> 
  <p style="margin-left:0cm;">icmp[8:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - internet header + 64 bits original data</p> 
  <p style="margin-left:0cm;">icmp[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 0 = net unreachable;</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 1 = host unreachable;</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 2 = protocol unreachable;</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 3 = port unreachable;</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 4 = fragmentation needed and DF set;</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 5 = source route failed.</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Time Exceeded:</p> 
  <p style="margin-left:0cm;">icmp[0] = 0xB (11)&nbsp;&nbsp;&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">icmp[4:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - unused (per RFC]</p> 
  <p style="margin-left:0cm;">icmp[8:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - internet header + 64 bits original data</p> 
  <p style="margin-left:0cm;">icmp[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 0 = TTL exceeded intransit</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 1 = fragment reassembly time exceeded</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Parameter Problem:</p> 
  <p style="margin-left:0cm;">icmp[0] = 0xC (12)&nbsp;&nbsp;&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">icmp[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 0 = pointer indicates error</p> 
  <p style="margin-left:0cm;">icmp[4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - pointer</p> 
  <p style="margin-left:0cm;">icmp[5:3]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - unused, per RFC</p> 
  <p style="margin-left:0cm;">icmp[8:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - internet header + 64 bits original data</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Source Quench:</p> 
  <p style="margin-left:0cm;">icmp[0] = 0x4 (4)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">icmp[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 0 = may be received by gateway or host</p> 
  <p style="margin-left:0cm;">icmp[4:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - unused, per RFC</p> 
  <p style="margin-left:0cm;">icmp[8:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - internet header + 64 bits original data</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Redirect Message:</p> 
  <p style="margin-left:0cm;">icmp[0] = 0x5 (5)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">icmp[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 0 = redirect for network</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 1 = redirect for host</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 2 = redirect for TOS &amp; network</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 3 = redirect for TOS &amp; host</p> 
  <p style="margin-left:0cm;">icmp[4:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - gateway internet address</p> 
  <p style="margin-left:0cm;">icmp[8:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - internet header + 64 bits original data</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Echo/Echo Reply:</p> 
  <p style="margin-left:0cm;">icmp[0]&nbsp;&nbsp;&nbsp;&nbsp; = 0x0 (0) (echo reply)</p> 
  <p style="margin-left:0cm;">icmp[0]&nbsp;&nbsp;&nbsp;&nbsp; = 0x8 (8) (echo request)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">icmp[4:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - identifier</p> 
  <p style="margin-left:0cm;">icmp[6:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - sequence number</p> 
  <p style="margin-left:0cm;">icmp[8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - data begins</p> 
  <p style="margin-left:0cm;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p> 
  <p style="margin-left:0cm;">Timestamp/Timestamp Reply:</p> 
  <p style="margin-left:0cm;">icmp[0] = 0xD (13) (timestamp request)</p> 
  <p style="margin-left:0cm;">icmp[0] = 0xE (14) (timestamp reply)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">icmp[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 0</p> 
  <p style="margin-left:0cm;">icmp[4:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - identifier</p> 
  <p style="margin-left:0cm;">icmp[6:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - sequence number</p> 
  <p style="margin-left:0cm;">icmp[8:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - originate timestamp</p> 
  <p style="margin-left:0cm;">icmp[12:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - receive timestamp</p> 
  <p style="margin-left:0cm;">icmp[16:4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - transmit timestamp</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Information Request/Reply:</p> 
  <p style="margin-left:0cm;">icmp[0] = 0xF (15) (info request)</p> 
  <p style="margin-left:0cm;">icmp[0] = 0x10&nbsp; (16) (info reply)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">icmp[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - 0</p> 
  <p style="margin-left:0cm;">icmp[4:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - identifier</p> 
  <p style="margin-left:0cm;">icmp[6:2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - sequence number</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Address Mask Request/Reply:</p> 
  <p style="margin-left:0cm;">icmp[0] = 0x11 (11) (address mask request)</p> 
  <p style="margin-left:0cm;">icmp[0] = 0x12 (12) (address mask reply)</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">Sources:</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
  <p style="margin-left:0cm;">RFC768, "User Datagram Protocol Specification"</p> 
  <p style="margin-left:0cm;">RFC791, "Internet Protocol Specification"</p> 
  <p style="margin-left:0cm;">RFC792, "Internet Control Message Protocol Specification"</p> 
  <p style="margin-left:0cm;">RFC793, "Transmission Control Protocol"</p> 
  <p style="margin-left:0cm;">filter files from SHADOW-1.8 source distribution</p> 
  <p style="margin-left:0cm;">man pages for tcpdump</p> 
  <p style="margin-left:0cm;">"TCP/IP and tcpdump Pocket Reference Guide", SANS</p> 
  <p style="margin-left:0cm;">&nbsp;</p> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
