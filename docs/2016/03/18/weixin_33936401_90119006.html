<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Windows c++应用程序通用日志组件（组件及测试程序下载） « NotBeCN</title>
  <meta name="description" content="             引言    　　众所周知，在调试、跟踪和执行应用程序的过程中，程序的日志能为这些工作提供大量有价值的运行信息。因此，程序的日志对应用程序的运行、维护至关重要。    　　在如何记录程序日志方面，通常有三种选择：    　　1、采用Log4CXX等公共开源日志组件：这类日志组件的特点是跨平...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2016/03/18/weixin_33936401_90119006.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Windows c++应用程序通用日志组件（组件及测试程序下载）</h1>
    <p class="post-meta">Mar 18, 2016</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><strong><span style="line-height:1.5;font-size:14pt;">引言</span></strong></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　众所周知，在调试、跟踪和执行应用程序的过程中，程序的日志能为这些工作提供大量有价值的运行信息。因此，程序的日志对应用程序的运行、维护至关重要。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　在如何记录程序日志方面，通常有三种选择：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　1、采用Log4CXX等公共开源日志组件：这类日志组件的特点是跨平台且功能比较强大，例如可以把日志发往另一台服务器或记录到数据库中等； 另外，可配置性较高，可以通过配置文件或程序代码对日志进行很多个性化设置。但从另外一个角度看，由于这些优点往往也导致了在使用方面的缺点。首先，对于 一般应用程序来说，它们并不需要太多的功能，通常只需要把日志记录到文件或反馈到应用程序，功能太多反正让用户使用起来觉得繁琐还得背负很多从来都用不到 的代码。其次，这类日志组件通常是跨平台的，并不只是针对 Windows 或 VC 的应用程序，因此使用起来总会觉得有点别扭，例如他们的字符都是用 char 类型的，对于一个 Unicode 程序来说每次写日志都要做字符转换是很不爽的事情，本座在多年前曾经使用过 Log4Cpp ，程序执行时总是报告日志组件有内存泄露，虽然有可能是误报，但是使用起来总觉得很不舒服。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　2、自己写几个简单的类或函数记录日志：这种方法的确很简单，通常都不用一两百行的代码。但这种方法通常缺乏规范性和通用性，其他程序需要记录 类似的但有点差异的日志时，通常的作法是：Copy-Paste-Modify；另外，这类方法很可能也没有考虑性能或并发方面的问题，通常是直接在工作 线程中写日志，对于那些性能要求较高的应用程序是绝对不允许的。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　3、干脆不记录任何日志：的确，现在很多程序由于各种原因并没有记录任何日志。但本座以为，如果一个程序是有用的，具备一定功能，并且需要连续运行较长一段时间，那么记录日志是必须的；否则，得认真考虑该程序是否有存在的必要了。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <hr style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><strong><span style="line-height:1.5;font-size:14pt;">设计</span></strong></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　综上所述，编写一个通用的日志组件应该着重考虑三个方面：功能、可用性和性能。下面，本座详细说明在设计日志组件时对这些方面问题的考虑：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　<span style="line-height:1.5;color:rgb(0,0,128);">　1、功能：本日志组件的目的是满足大多数应用程序记录日志的需求 —— 把日志输出到文件或发送到应用程序中，并不提供一些复杂但不常用的功能。本日志组件的功能包括：</span></p> 
   <ul style="list-style:none;font-size:12px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"><strong>把日志信息输出到指定文件</strong></li> 
    <li style="list-style-type:disc;"><strong>每日生成一个日志文件</strong></li> 
    <li style="list-style-type:disc;"><strong>对于 GUI 程序，可以把日志信息发送到指定窗口</strong></li> 
    <li style="list-style-type:disc;"><strong>对于Console应用程序，可以把日志信息发往标准输出 (std::cout)</strong></li> 
    <li style="list-style-type:disc;"><strong>支持 MBCS / UNICODE，Console / GUI 程序</strong></li> 
    <li style="list-style-type:disc;"><strong>支持动态加载和静态加载日志组件 DLL</strong></li> 
    <li style="list-style-type:disc;"><strong>支持 DEBUG/TRACE/INFO/WARN/ERROR/FATAL 等多个日志级别</strong></li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　<span style="line-height:1.5;color:rgb(0,0,128);">　2、可用性：本日志组件着重考虑了可用性，尽量让使用者用起来觉得简便、舒心：</span></p> 
   <ul style="list-style:none;font-size:12px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"><strong>简单纯净：不依赖任何程序库或框架</strong></li> 
    <li style="list-style-type:disc;"><strong>使用接口简单，不需复杂的配置或设置工作</strong></li> 
    <li style="list-style-type:disc;"><strong>提供 CStaticLogger 和 CDynamicLogger 包装类用于静态或动态加载以及操作日志组件，用户无需关注加载细节</strong></li> 
    <li style="list-style-type:disc;"><strong>程序如果要记录多个日志文件只需为每个日志文件创建相应的 CStaticLogger&nbsp;或 CDynamicLogger 对象</strong></li> 
    <li style="list-style-type:disc;"><strong>只需调用&nbsp;Log()/Debug()/Trace()/Info()/Warn()/Error()/Fatal() 等方法记录日志</strong></li> 
    <li style="list-style-type:disc;"><strong>日志记录方法支持可变参数</strong></li> 
    <li style="list-style-type:disc;"><strong>日志输出格式：&lt;时间&gt; &lt;线程ID&gt; &lt;日志级别&gt; &lt;日志内容&gt;</strong></li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><span style="line-height:1.5;color:rgb(0,0,128);">　　3、性能：性能是组件是否值得使用的硬指标，本组件从设计到编码的过程都尽量考虑到性能优化：</span></p> 
   <ul style="list-style:none;font-size:12px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"><strong>支持多线程同时发送写日志请求</strong></li> 
    <li style="list-style-type:disc;"><strong>使用单独线程在后台写日志，不影响工作线程的正常执行</strong></li> 
    <li style="list-style-type:disc;"><strong>采用批处理方式批量记录日志</strong></li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;text-align:center;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><img src="https://pic002.cnblogs.com/images/2012/373909/2012062809435894.jpg" alt="" style="border:0px;margin-left:auto;"></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><img src="https://pic002.cnblogs.com/images/2012/373909/2012062809441226.jpg" alt="" style="border:0px;margin-left:auto;"></p> 
   <hr style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><span style="line-height:1.5;font-size:14pt;"><strong>接口</strong></span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　<strong>　1、ILogger：日志组件对象接口</strong></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:0px;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">  1</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">*****************************************************************************
</span><span style="color:rgb(0,128,128);line-height:1.5;">  2</span> <span style="color:rgb(0,128,0);line-height:1.5;">Module:  Logger.h
</span><span style="color:rgb(0,128,128);line-height:1.5;">  3</span> <span style="color:rgb(0,128,0);line-height:1.5;">Notices: Copyright (c) 2012 Bruce Liang - </span><span style="color:rgb(0,128,0);text-decoration:underline;line-height:1.5;">http://www.cnblogs.com/ldcsaa/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">  4</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">  5</span> <span style="color:rgb(0,128,0);line-height:1.5;">Purpose: 记录程序日志。
</span><span style="color:rgb(0,128,128);line-height:1.5;">  6</span> <span style="color:rgb(0,128,0);line-height:1.5;">        1. 把日志信息输出到指定文件
</span><span style="color:rgb(0,128,128);line-height:1.5;">  7</span> <span style="color:rgb(0,128,0);line-height:1.5;">        2. 对于 GUI 程序，可以把日志信息发送到指定窗口
</span><span style="color:rgb(0,128,128);line-height:1.5;">  8</span> <span style="color:rgb(0,128,0);line-height:1.5;">        3. 对于Console应用程序，可以把日志信息发往标准输出 (std::cout)
</span><span style="color:rgb(0,128,128);line-height:1.5;">  9</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 10</span> <span style="color:rgb(0,128,0);line-height:1.5;">Desc:
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 11</span> <span style="color:rgb(0,128,0);line-height:1.5;">        1、功能：
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 12</span> <span style="color:rgb(0,128,0);line-height:1.5;">        --------------------------------------------------------------------------------------
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 13</span> <span style="color:rgb(0,128,0);line-height:1.5;">        a) 把日志信息输出到指定文件
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 14</span> <span style="color:rgb(0,128,0);line-height:1.5;">        b) 每日生成一个日志文件
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 15</span> <span style="color:rgb(0,128,0);line-height:1.5;">        c) 对于 GUI 程序，可以把日志信息发送到指定窗口
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 16</span> <span style="color:rgb(0,128,0);line-height:1.5;">        d) 对于Console应用程序，可以把日志信息发往标准输出 (std::cout)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 17</span> <span style="color:rgb(0,128,0);line-height:1.5;">        e) 支持 MBCS / UNICODE，Console / GUI 程序
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 18</span> <span style="color:rgb(0,128,0);line-height:1.5;">        f) 支持动态加载和静态加载日志组件 DLL
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 19</span> <span style="color:rgb(0,128,0);line-height:1.5;">        g) 支持 DEBUG/TRACE/INFO/WARN/ERROR/FATAL 等多个日志级别
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 20</span>         
<span style="color:rgb(0,128,128);line-height:1.5;"> 21</span> <span style="color:rgb(0,128,0);line-height:1.5;">        2、可用性：
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 22</span> <span style="color:rgb(0,128,0);line-height:1.5;">        --------------------------------------------------------------------------------------
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 23</span> <span style="color:rgb(0,128,0);line-height:1.5;">        a) 简单纯净：不依赖任何程序库或框架
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 24</span> <span style="color:rgb(0,128,0);line-height:1.5;">        b) 使用接口简单，不需复杂的配置或设置工作
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 25</span> <span style="color:rgb(0,128,0);line-height:1.5;">        c) 提供 CStaticLogger 和 CDynamicLogger 包装类用于静态或动态加载以及操作日志组件，用户无需关注加载细节
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 26</span> <span style="color:rgb(0,128,0);line-height:1.5;">        d) 程序如果要记录多个日志文件只需为每个日志文件创建相应的 CStaticLogger 或 CDynamicLogger 对象
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 27</span> <span style="color:rgb(0,128,0);line-height:1.5;">        e) 只需调用 Log()/Debug()/Trace()/Info()/Warn()/Error()/Fatal() 等方法记录日志
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 28</span> <span style="color:rgb(0,128,0);line-height:1.5;">        f) 日志记录方法支持可变参数
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 29</span> <span style="color:rgb(0,128,0);line-height:1.5;">        g) 日志输出格式：&lt;时间&gt; &lt;线程ID&gt; &lt;日志级别&gt; &lt;日志内容&gt;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 30</span>         
<span style="color:rgb(0,128,128);line-height:1.5;"> 31</span> <span style="color:rgb(0,128,0);line-height:1.5;">        3、性能：
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 32</span> <span style="color:rgb(0,128,0);line-height:1.5;">        --------------------------------------------------------------------------------------
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 33</span> <span style="color:rgb(0,128,0);line-height:1.5;">        a) 支持多线程同时发送写日志请求
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 34</span> <span style="color:rgb(0,128,0);line-height:1.5;">        b) 使用单独线程在后台写日志，不影响工作线程的正常执行
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 35</span> <span style="color:rgb(0,128,0);line-height:1.5;">        c) 采用批处理方式批量记录日志
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 36</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 37</span> <span style="color:rgb(0,128,0);line-height:1.5;">Usage:
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 38</span> <span style="color:rgb(0,128,0);line-height:1.5;">        方法一：（静态加载 Logger DLL）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 39</span> <span style="color:rgb(0,128,0);line-height:1.5;">        --------------------------------------------------------------------------------------
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 40</span> <span style="color:rgb(0,128,0);line-height:1.5;">        0. 应用程序包含 StaticLogger.h 头文件
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 41</span> <span style="color:rgb(0,128,0);line-height:1.5;">        1. 创建 CStaticLogger 对象（通常为全局对象）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 42</span> <span style="color:rgb(0,128,0);line-height:1.5;">        2. 调用 CStaticLogger-&gt;Init(...) 初始化日志组件
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 43</span> <span style="color:rgb(0,128,0);line-height:1.5;">        3. 使用 CStaticLogger-&gt;Log()/Debug()/Trace()/Info()/Warn()/Error()/Fatal() 等方法写日志
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 44</span> <span style="color:rgb(0,128,0);line-height:1.5;">        4. 调用 CStaticLogger-&gt;UnInit(...) 清理日志组件（CStaticLogger 对象析构时也会自动清理日志组件）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 45</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 46</span> <span style="color:rgb(0,128,0);line-height:1.5;">        方法二：（动态加载 Logger DLL）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 47</span> <span style="color:rgb(0,128,0);line-height:1.5;">        --------------------------------------------------------------------------------------
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 48</span> <span style="color:rgb(0,128,0);line-height:1.5;">        0. 应用程序包含 DynamicLogger.h 头文件
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 49</span> <span style="color:rgb(0,128,0);line-height:1.5;">        1. 创建 CDynamicLogger 对象（通常为全局对象）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 50</span> <span style="color:rgb(0,128,0);line-height:1.5;">        2. 调用 CDynamicLogger-&gt;Init(...) 初始化日志组件
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 51</span> <span style="color:rgb(0,128,0);line-height:1.5;">        3. 使用 CDynamicLogger-&gt;Log()/Debug()/Trace()/Info()/Warn()/Error()/Fatal() 等方法写日志
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 52</span> <span style="color:rgb(0,128,0);line-height:1.5;">        4. 调用 CDynamicLogger-&gt;UnInit(...) 清理日志组件（CDynamicLogger 对象析构时也会自动清理日志组件）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 53</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 54</span> <span style="color:rgb(0,128,0);line-height:1.5;">        方法三：（直接用导出函数加载 Logger DLL）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 55</span> <span style="color:rgb(0,128,0);line-height:1.5;">        --------------------------------------------------------------------------------------
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 56</span> <span style="color:rgb(0,128,0);line-height:1.5;">        0. 应用程序包含 Logger.h 头文件
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 57</span> <span style="color:rgb(0,128,0);line-height:1.5;">        1. 手工调用 ILoger_Create() 和 ILoger_Create() 导出函数创建和销毁 ILogger 对象 
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 58</span> <span style="color:rgb(0,128,0);line-height:1.5;">        （注：如果是动态加载，需手工调用 ::LoadLibrary()/::FreeLibrary() 系列 API 函数加载和卸载 Logger DLL）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 59</span>         
<span style="color:rgb(0,128,128);line-height:1.5;"> 60</span> <span style="color:rgb(0,128,0);line-height:1.5;">        [
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 61</span> <span style="color:rgb(0,128,0);line-height:1.5;">            ***** 对于希望通过窗口接收日志信息的 GUI 程序 *****
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 62</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 63</span> <span style="color:rgb(0,128,0);line-height:1.5;">            A. 日志组件初始化成功后调用 SetGUIWindow(HWND) 设置收日志的窗口
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 64</span> <span style="color:rgb(0,128,0);line-height:1.5;">            B. 窗口须响应处理 LOG_MESSAGE 消息
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 65</span> <span style="color:rgb(0,128,0);line-height:1.5;">            C. 处理完 LOG_MESSAGE 消息后，调用 ILogger::FreeLogMsg() 销毁接收到的 TLogMsg 
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 66</span> <span style="color:rgb(0,128,0);line-height:1.5;">        ]
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 67</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 68</span> <span style="color:rgb(0,128,0);line-height:1.5;">Environment:
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 69</span> <span style="color:rgb(0,128,0);line-height:1.5;">        1. Windows 2000 or later (_WIN32_WINNT &gt;= 0x0500)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 70</span> <span style="color:rgb(0,128,0);line-height:1.5;">        2. VC++ 2010 or later
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 71</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 72</span> <span style="color:rgb(0,128,0);line-height:1.5;">Release:
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 73</span> <span style="color:rgb(0,128,0);line-height:1.5;">        1. Logger_C.dll     - Console/MBCS/Release
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 74</span> <span style="color:rgb(0,128,0);line-height:1.5;">        2. Logger_CD.dll    - Console/MBCS/Debug
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 75</span> <span style="color:rgb(0,128,0);line-height:1.5;">        3. Logger_CU.dll    - Console/Unicode/Release
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 76</span> <span style="color:rgb(0,128,0);line-height:1.5;">        4. Logger_CUD.dll   - Console/Unicode/Debug
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 77</span> <span style="color:rgb(0,128,0);line-height:1.5;">        5. Logger.dll       - GUI/MBCS/Release
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 78</span> <span style="color:rgb(0,128,0);line-height:1.5;">        6. Logger_D.dll     - GUI/MBCS/Debug
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 79</span> <span style="color:rgb(0,128,0);line-height:1.5;">        7. Logger_U.dll     - GUI/Unicode/Release
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 80</span> <span style="color:rgb(0,128,0);line-height:1.5;">        8. Logger_UD.dll    - GUI/Unicode/Debug
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 81</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 82</span> <span style="color:rgb(0,128,0);line-height:1.5;">Examples:
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 83</span> <span style="color:rgb(0,128,0);line-height:1.5;">        1. TestGUILogger        - GUI 版测试程序       （静态加载）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 84</span> <span style="color:rgb(0,128,0);line-height:1.5;">        2. TestDynamicLogger    - GUI 版测试程序       （动态加载）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 85</span> <span style="color:rgb(0,128,0);line-height:1.5;">        3. TestConsoleLogger    - Console 版测试程序  （静态加载）
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 86</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 87</span> <span style="color:rgb(0,128,0);line-height:1.5;">*****************************************************************************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 88</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 89</span> <span style="color:rgb(0,0,255);line-height:1.5;">#pragma</span> once
<span style="color:rgb(0,128,128);line-height:1.5;"> 90</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 91</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">************************************************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 92</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">********* imports / exports Logger.dll *********</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 93</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 94</span> <span style="line-height:1.5;">#ifdef LOGGER_EXPORTS
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 95</span>     <span style="color:rgb(0,0,255);line-height:1.5;">#define</span> LOGGER_API __declspec(dllexport)
<span style="color:rgb(0,128,128);line-height:1.5;"> 96</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">#define TRY_INLINE    inline</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 97</span> <span style="color:rgb(0,0,255);line-height:1.5;">#else</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 98</span>     <span style="color:rgb(0,0,255);line-height:1.5;">#define</span> LOGGER_API __declspec(dllimport)
<span style="color:rgb(0,128,128);line-height:1.5;"> 99</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">#define TRY_INLINE</span>
<span style="color:rgb(0,128,128);line-height:1.5;">100</span> <span style="color:rgb(0,0,255);line-height:1.5;">#endif</span>
<span style="color:rgb(0,128,128);line-height:1.5;">101</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">102</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">************************************************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">103</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">***************** 日志组件接口 ******************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">104</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">105</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> LOGGER_API ILogger
</span><span style="color:rgb(0,128,128);line-height:1.5;">106</span> <span style="line-height:1.5;">{
</span><span style="color:rgb(0,128,128);line-height:1.5;">107</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">108</span>     <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">**** 日志级别 ****</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">109</span>     <span style="color:rgb(0,0,255);line-height:1.5;">enum</span><span style="line-height:1.5;"> LogLevel
</span><span style="color:rgb(0,128,128);line-height:1.5;">110</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;">111</span>         LL_NONE     = <span style="color:rgb(128,0,128);line-height:1.5;">0XFF</span><span style="line-height:1.5;">,
</span><span style="color:rgb(0,128,128);line-height:1.5;">112</span>         LL_DEBUG    = <span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">,
</span><span style="color:rgb(0,128,128);line-height:1.5;">113</span>         LL_TRACE    = <span style="color:rgb(128,0,128);line-height:1.5;">2</span><span style="line-height:1.5;">,
</span><span style="color:rgb(0,128,128);line-height:1.5;">114</span>         LL_INFO     = <span style="color:rgb(128,0,128);line-height:1.5;">3</span><span style="line-height:1.5;">,
</span><span style="color:rgb(0,128,128);line-height:1.5;">115</span>         LL_WARN     = <span style="color:rgb(128,0,128);line-height:1.5;">4</span><span style="line-height:1.5;">,
</span><span style="color:rgb(0,128,128);line-height:1.5;">116</span>         LL_ERROR    = <span style="color:rgb(128,0,128);line-height:1.5;">5</span><span style="line-height:1.5;">,
</span><span style="color:rgb(0,128,128);line-height:1.5;">117</span>         LL_FATAL    = <span style="color:rgb(128,0,128);line-height:1.5;">6</span>
<span style="color:rgb(0,128,128);line-height:1.5;">118</span> <span style="line-height:1.5;">    };
</span><span style="color:rgb(0,128,128);line-height:1.5;">119</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">120</span>     <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">**** 操作错误码 ****</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">121</span>     <span style="color:rgb(0,0,255);line-height:1.5;">enum</span><span style="line-height:1.5;"> ErrorCode
</span><span style="color:rgb(0,128,128);line-height:1.5;">122</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;">123</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 无错误</span>
<span style="color:rgb(0,128,128);line-height:1.5;">124</span>         EC_OK    =<span style="line-height:1.5;"> NO_ERROR,
</span><span style="color:rgb(0,128,128);line-height:1.5;">125</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 文件操作相关的错误</span>
<span style="color:rgb(0,128,128);line-height:1.5;">126</span> <span style="line-height:1.5;">        EC_FILE_GENERIC,
</span><span style="color:rgb(0,128,128);line-height:1.5;">127</span> <span style="line-height:1.5;">        EC_FILE_FILENOTFOUND,
</span><span style="color:rgb(0,128,128);line-height:1.5;">128</span> <span style="line-height:1.5;">        EC_FILE_BADPATH,
</span><span style="color:rgb(0,128,128);line-height:1.5;">129</span> <span style="line-height:1.5;">        EC_FILE_TOMANYOPERFILES,
</span><span style="color:rgb(0,128,128);line-height:1.5;">130</span> <span style="line-height:1.5;">        EC_FILE_ACCESSDENIED,
</span><span style="color:rgb(0,128,128);line-height:1.5;">131</span> <span style="line-height:1.5;">        EC_FILE_INVALIDFILE,
</span><span style="color:rgb(0,128,128);line-height:1.5;">132</span> <span style="line-height:1.5;">        EC_FILE_REMOVECURRENTDIR,
</span><span style="color:rgb(0,128,128);line-height:1.5;">133</span> <span style="line-height:1.5;">        EC_FILE_DIRECTORYFULL,
</span><span style="color:rgb(0,128,128);line-height:1.5;">134</span> <span style="line-height:1.5;">        EC_FILE_BADSEEK,
</span><span style="color:rgb(0,128,128);line-height:1.5;">135</span> <span style="line-height:1.5;">        EC_FILE_HARDIO,
</span><span style="color:rgb(0,128,128);line-height:1.5;">136</span> <span style="line-height:1.5;">        EC_FILE_SHARINGVIOLATION,
</span><span style="color:rgb(0,128,128);line-height:1.5;">137</span> <span style="line-height:1.5;">        EC_FILE_LOCKVIOLATION,
</span><span style="color:rgb(0,128,128);line-height:1.5;">138</span> <span style="line-height:1.5;">        EC_FILE_DISKFULL,
</span><span style="color:rgb(0,128,128);line-height:1.5;">139</span> <span style="line-height:1.5;">        EC_FILE_ENDOFFILE,
</span><span style="color:rgb(0,128,128);line-height:1.5;">140</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 其他错误</span>
<span style="color:rgb(0,128,128);line-height:1.5;">141</span> <span style="line-height:1.5;">        EC_INVALID_STATE,
</span><span style="color:rgb(0,128,128);line-height:1.5;">142</span> <span style="line-height:1.5;">        EC_INIT_LOGLEVEL,
</span><span style="color:rgb(0,128,128);line-height:1.5;">143</span> <span style="line-height:1.5;">        EC_INIT_PRINTFLAG,
</span><span style="color:rgb(0,128,128);line-height:1.5;">144</span> <span style="line-height:1.5;">        EC_INIT_CREATE_LOG_THREAD_FAIL
</span><span style="color:rgb(0,128,128);line-height:1.5;">145</span> <span style="line-height:1.5;">    };
</span><span style="color:rgb(0,128,128);line-height:1.5;">146</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">147</span>     <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">*****************************************
</span><span style="color:rgb(0,128,128);line-height:1.5;">148</span> <span style="color:rgb(0,128,0);line-height:1.5;">                    日志信息结构
</span><span style="color:rgb(0,128,128);line-height:1.5;">149</span> <span style="color:rgb(0,128,0);line-height:1.5;">    ******************************************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">150</span>     <span style="color:rgb(0,0,255);line-height:1.5;">struct</span><span style="line-height:1.5;"> TLogMsg
</span><span style="color:rgb(0,128,128);line-height:1.5;">151</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;">152</span>         DWORD       m_dwSize;       <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 结构大小 - 跟据消息长度动态变化</span>
<span style="color:rgb(0,128,128);line-height:1.5;">153</span>         LogLevel    m_logLevel;     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 日志级别</span>
<span style="color:rgb(0,128,128);line-height:1.5;">154</span>         UINT        m_uiThreadID;   <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 线程ID</span>
<span style="color:rgb(0,128,128);line-height:1.5;">155</span>         SYSTEMTIME  m_stMsgTime;    <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 记录时间</span>
<span style="color:rgb(0,128,128);line-height:1.5;">156</span>         TCHAR       m_psMsg[<span style="color:rgb(128,0,128);line-height:1.5;">1</span>];     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 消息内容</span>
<span style="color:rgb(0,128,128);line-height:1.5;">157</span> <span style="line-height:1.5;">    };
</span><span style="color:rgb(0,128,128);line-height:1.5;">158</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">159</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">160</span>     ILogger(<span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">161</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> ~ILogger(<span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">162</span> <span style="color:rgb(0,0,255);line-height:1.5;">private</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">163</span>     ILogger(<span style="color:rgb(0,0,255);line-height:1.5;">const</span> ILogger&amp;<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">164</span>     ILogger&amp; <span style="color:rgb(0,0,255);line-height:1.5;">operator</span> = (<span style="color:rgb(0,0,255);line-height:1.5;">const</span> ILogger&amp;<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">165</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">166</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">167</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 日志组件初始化方法</span>
<span style="color:rgb(0,128,128);line-height:1.5;">168</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span><span style="line-height:1.5;"> BOOL Init(
</span><span style="color:rgb(0,128,128);line-height:1.5;">169</span>                         LPCTSTR logFile  = NULL                  <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 日志文件. 默认: {AppPath}/logs/{AppName}-YYYYMMDD.log</span>
<span style="color:rgb(0,128,128);line-height:1.5;">170</span>                       , LogLevel ll      = DEFAULT_LOG_LEVEL     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 日志级别. 默认: [Debug -&gt; LL_DEBUG] / [Release -&gt; LL_INFO]</span>
<span style="color:rgb(0,128,128);line-height:1.5;">171</span>                       , <span style="color:rgb(0,0,255);line-height:1.5;">int</span> printFlag    = DEFAULT_PRINT_FLAG    <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 输出掩码. 是否输出到文件和(或)屏幕. 默认: 只输出到文件</span>
<span style="color:rgb(0,128,128);line-height:1.5;">172</span>                      )       = <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">173</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 日志组件清理方法</span>
<span style="color:rgb(0,128,128);line-height:1.5;">174</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> BOOL UnInit()    = <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">175</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">176</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">177</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 写日志方法：传入日志内容字符串（对于不需要格式化的日志文本，用本方法效率最高）</span>
<span style="color:rgb(0,128,128);line-height:1.5;">178</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span> Log_0  (LogLevel ll, LPCTSTR msg) = <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">179</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Debug_0(LPCTSTR msg);
</span><span style="color:rgb(0,128,128);line-height:1.5;">180</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Trace_0(LPCTSTR msg);
</span><span style="color:rgb(0,128,128);line-height:1.5;">181</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Info_0 (LPCTSTR msg);
</span><span style="color:rgb(0,128,128);line-height:1.5;">182</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Warn_0 (LPCTSTR msg);
</span><span style="color:rgb(0,128,128);line-height:1.5;">183</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Error_0(LPCTSTR msg);
</span><span style="color:rgb(0,128,128);line-height:1.5;">184</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Fatal_0(LPCTSTR msg);
</span><span style="color:rgb(0,128,128);line-height:1.5;">185</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">186</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 写日志方法：传入格式化字符串和参数栈指针（通常只在组件内部使用）</span>
<span style="color:rgb(0,128,128);line-height:1.5;">187</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> LogV   (LogLevel ll, LPCTSTR format, va_list arg_ptr);
</span><span style="color:rgb(0,128,128);line-height:1.5;">188</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">189</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 写日志方法：传入格式化字符串和可变参数（非常灵活简便）</span>
<span style="color:rgb(0,128,128);line-height:1.5;">190</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Log     (LogLevel ll, LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">191</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Debug   (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">192</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Trace   (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">193</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Info    (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">194</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Warn    (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">195</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Error   (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">196</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Fatal   (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">197</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">198</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 写日志方法：传入格式化字符串和可变参数（与上一组方法类似，但在进行任何操作前会检查日志级别）</span>
<span style="color:rgb(0,128,128);line-height:1.5;">199</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> TryLog     (LogLevel ll, LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">200</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> TryDebug   (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">201</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> TryTrace   (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">202</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> TryInfo    (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">203</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> TryWarn    (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">204</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> TryError   (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">205</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> TryFatal   (LPCTSTR format, ...);
</span><span style="color:rgb(0,128,128);line-height:1.5;">206</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">207</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 通用辅助方法</span>
<span style="color:rgb(0,128,128);line-height:1.5;">208</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> BOOL HasInited           ()        <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    = <span style="color:rgb(128,0,128);line-height:1.5;">0</span>;        <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 是否已经初始化                            </span>
<span style="color:rgb(0,128,128);line-height:1.5;">209</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> BOOL IsPrint2File        ()        <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    = <span style="color:rgb(128,0,128);line-height:1.5;">0</span>;        <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 是否把日志输出到文件    </span>
<span style="color:rgb(0,128,128);line-height:1.5;">210</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> BOOL IsPrint2Screen      ()        <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    = <span style="color:rgb(128,0,128);line-height:1.5;">0</span>;        <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 是否把日志输出到屏幕窗口    </span>
<span style="color:rgb(0,128,128);line-height:1.5;">211</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">int</span>    GetPrintFlag      ()        <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    = <span style="color:rgb(128,0,128);line-height:1.5;">0</span>;        <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 打印标志                    </span>
<span style="color:rgb(0,128,128);line-height:1.5;">212</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> LogLevel    GetLogLevel  ()        <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    = <span style="color:rgb(128,0,128);line-height:1.5;">0</span>;        <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 日志级别        </span>
<span style="color:rgb(0,128,128);line-height:1.5;">213</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> LPCTSTR        GetLogFile()        <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    = <span style="color:rgb(128,0,128);line-height:1.5;">0</span>;        <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 日志文件</span>
<span style="color:rgb(0,128,128);line-height:1.5;">214</span>     <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> ErrorCode    GetLastError()        <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    = <span style="color:rgb(128,0,128);line-height:1.5;">0</span>;        <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 当前操作错误码</span>
<span style="color:rgb(0,128,128);line-height:1.5;">215</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">216</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">***************************** GUI *****************************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">217</span> <span style="line-height:1.5;">#ifdef _WINDOWS
</span><span style="color:rgb(0,128,128);line-height:1.5;">218</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">219</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 设置接收日志信息的窗口, hWndGUI == NULL 则取消接收</span>
<span style="color:rgb(0,128,128);line-height:1.5;">220</span>         <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span> SetGUIWindow(HWND hWndGUI)    = <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">221</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取接收日志信息的窗口</span>
<span style="color:rgb(0,128,128);line-height:1.5;">222</span>         <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> HWND GetGUIWindow()                = <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">223</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">224</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 销毁在发送 LOG_MESSAGE 消息时动态创建的 TLogMsg 对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;">225</span>         <span style="color:rgb(0,0,255);line-height:1.5;">virtual</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span> FreeLogMsg(<span style="color:rgb(0,0,255);line-height:1.5;">const</span> TLogMsg*<span style="line-height:1.5;"> pLogMsg);
</span><span style="color:rgb(0,128,128);line-height:1.5;">226</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">227</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 虚拟窗口句柄标掩码：用于向 GUI 窗口发送 LOG_MESSAGE 消息时作为发送源标识</span>
<span style="color:rgb(0,128,128);line-height:1.5;">228</span>         <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">const</span> <span style="color:rgb(0,0,255);line-height:1.5;">int</span> LOGGER_FAKE_WINDOW_BASE = <span style="color:rgb(128,0,128);line-height:1.5;">0X80001111</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">229</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 自定义日志消息：通过本消息向 GUI 窗口发送日志
</span><span style="color:rgb(0,128,128);line-height:1.5;">230</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 其中：WPARAM -&gt; ILogger 对象指针，LPARAM -&gt; TLogMsg 结构体指针</span>
<span style="color:rgb(0,128,128);line-height:1.5;">231</span>         <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">const</span> <span style="color:rgb(0,0,255);line-height:1.5;">int</span> LOG_MESSAGE = WM_USER | (<span style="color:rgb(128,0,128);line-height:1.5;">0x7FFF</span> &amp;<span style="line-height:1.5;"> LOGGER_FAKE_WINDOW_BASE);
</span><span style="color:rgb(0,128,128);line-height:1.5;">232</span> <span style="color:rgb(0,0,255);line-height:1.5;">#endif</span>
<span style="color:rgb(0,128,128);line-height:1.5;">233</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">234</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">235</span>     <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">const</span> <span style="color:rgb(0,0,255);line-height:1.5;">int</span> PRINT_FLAG_FILE            = <span style="color:rgb(128,0,128);line-height:1.5;">0x00000001</span>;            <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 打印到文件</span>
<span style="color:rgb(0,128,128);line-height:1.5;">236</span>     <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">const</span> <span style="color:rgb(0,0,255);line-height:1.5;">int</span> PRINT_FLAG_SCREEN          = <span style="color:rgb(128,0,128);line-height:1.5;">0x00000002</span>;            <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 打印到屏幕</span>
<span style="color:rgb(0,128,128);line-height:1.5;">237</span>     <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">const</span> <span style="color:rgb(0,0,255);line-height:1.5;">int</span> DEFAULT_PRINT_FLAG         = PRINT_FLAG_FILE;        <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 默认日志掩码</span>
<span style="color:rgb(0,128,128);line-height:1.5;">238</span>     <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">const</span> LogLevel DEFAULT_LOG_LEVEL     = 
<span style="color:rgb(0,128,128);line-height:1.5;">239</span> <span style="line-height:1.5;">#ifdef _DEBUG
</span><span style="color:rgb(0,128,128);line-height:1.5;">240</span> <span style="line-height:1.5;">                LL_DEBUG
</span><span style="color:rgb(0,128,128);line-height:1.5;">241</span> <span style="color:rgb(0,0,255);line-height:1.5;">#else</span>
<span style="color:rgb(0,128,128);line-height:1.5;">242</span> <span style="line-height:1.5;">                LL_INFO
</span><span style="color:rgb(0,128,128);line-height:1.5;">243</span> <span style="color:rgb(0,0,255);line-height:1.5;">#endif</span>
<span style="color:rgb(0,128,128);line-height:1.5;">244</span> <span style="line-height:1.5;">                ;
</span><span style="color:rgb(0,128,128);line-height:1.5;">245</span> <span style="line-height:1.5;">};
</span><span style="color:rgb(0,128,128);line-height:1.5;">246</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">247</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">************************************************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">248</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">************* Logger DLL 导出函数 **************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">249</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">250</span> <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 创建 ILogger 对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;">251</span> EXTERN_C LOGGER_API ILogger*<span style="line-height:1.5;"> ILogger_Create();
</span><span style="color:rgb(0,128,128);line-height:1.5;">252</span> <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 销毁 ILogger 对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;">253</span> EXTERN_C LOGGER_API <span style="color:rgb(0,0,255);line-height:1.5;">void</span> ILogger_Destroy(ILogger*<span style="line-height:1.5;"> p);
</span><span style="color:rgb(0,128,128);line-height:1.5;">254</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">255</span> <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取各日志级别的文字描述</span>
<span style="color:rgb(0,128,128);line-height:1.5;">256</span> <span style="line-height:1.5;">EXTERN_C LOGGER_API LPCTSTR    ILogger_GetLogLevelDesc (ILogger::LogLevel ll);
</span><span style="color:rgb(0,128,128);line-height:1.5;">257</span> <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取各操作错误码的文字描述</span>
<span style="color:rgb(0,128,128);line-height:1.5;">258</span> EXTERN_C LOGGER_API LPCTSTR    ILogger_GetErrorDesc    (ILogger::ErrorCode ec);</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:0px;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;　　代码中的注释基本已经能够说明日志组件的使用方法，这里只做一些简单的概括：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　<strong>版本：</strong>日志组件以 DLL 的形式提供，已编译成 Debug/Release、MBCS/Unicode、GUI/Console 8个版本</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　<strong>测试：</strong>三个测试程序 TestGUILogger、TestDynamicLogger 和 TestConsoleLogger 用于测试所有版本。其中 TestDynamicLogger 采用动态加载方式加载 Logger DLL</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　<strong>使用方法：</strong></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　<span style="line-height:1.5;color:rgb(153,51,0);">　　　0. 应用程序包含 Logger.h 头文件</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　1.&nbsp;调用 ILogger_Create() 导出函数创建 ILogger 对象</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　2. 调用 ILogger-&gt;Init(...) 初始化日志组件</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　3. 使用 ILogger-&gt;Log()/Debug()/Trace()/Info()/Warn()/Error()/Fatal() 等方法写日志</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　4. 调用 ILogger-&gt;UnInit(...) 清理日志组件</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　5. 调用 ILogger_Destroy() 导出函数销毁 ILogger 对象</span><br> &nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><strong>　<strong>　</strong>2、CStaticLogger：ILogger 包装器（智能指针）—— 用于静态加载 Logger DLL</strong>&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:0px;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">#pragma</span> once
<span style="color:rgb(0,128,128);line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span> #include <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Logger.h</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 5</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">************************************************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 6</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">******** </span><span style="color:rgb(0,128,0);text-decoration:underline;line-height:1.5;">http://www.cnblogs.com/ldcsaa/</span><span style="color:rgb(0,128,0);line-height:1.5;"> ********</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 7</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">********* ILogger 包装器（智能指针） **********</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 8</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">********** 用于静态加载 Logger DLL ***********</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 9</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">10</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> LOGGER_API CStaticLogger
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span> <span style="line-height:1.5;">{
</span><span style="color:rgb(0,128,128);line-height:1.5;">12</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">13</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 构造函数：如果 bCreate 为 TRUE，则在构建 CStaticLogger 实例的同时创建 ILogger 对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;">14</span>     CStaticLogger(BOOL bCreate =<span style="line-height:1.5;"> TRUE);
</span><span style="color:rgb(0,128,128);line-height:1.5;">15</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 析构函数</span>
<span style="color:rgb(0,128,128);line-height:1.5;">16</span>     ~<span style="line-height:1.5;">CStaticLogger();
</span><span style="color:rgb(0,128,128);line-height:1.5;">17</span> <span style="color:rgb(0,0,255);line-height:1.5;">private</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">18</span>     CStaticLogger(<span style="color:rgb(0,0,255);line-height:1.5;">const</span> CStaticLogger&amp;<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">19</span>     CStaticLogger&amp; <span style="color:rgb(0,0,255);line-height:1.5;">operator</span> = (<span style="color:rgb(0,0,255);line-height:1.5;">const</span> CStaticLogger&amp;<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">20</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">21</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">22</span>     inline <span style="color:rgb(0,0,255);line-height:1.5;">void</span> Reset           (ILogger* pLogger);     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 重设其封装的 ILogger 指针</span>
<span style="color:rgb(0,128,128);line-height:1.5;">23</span>     inline BOOL IsValid         ()    <span style="color:rgb(0,0,255);line-height:1.5;">const</span>;            <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 判断其封装的 ILogger 指针是否非空</span>
<span style="color:rgb(0,128,128);line-height:1.5;">24</span>     inline ILogger* Get         ()    <span style="color:rgb(0,0,255);line-height:1.5;">const</span>;            <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取 ILogger 指针</span>
<span style="color:rgb(0,128,128);line-height:1.5;">25</span>     inline ILogger&amp; <span style="color:rgb(0,0,255);line-height:1.5;">operator</span> *  ()    <span style="color:rgb(0,0,255);line-height:1.5;">const</span>;            <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取 ILogger 引用</span>
<span style="color:rgb(0,128,128);line-height:1.5;">26</span>     inline ILogger* <span style="color:rgb(0,0,255);line-height:1.5;">operator</span> -&gt; ()    <span style="color:rgb(0,0,255);line-height:1.5;">const</span>;            <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取 ILogger 指针</span>
<span style="color:rgb(0,128,128);line-height:1.5;">27</span>     inline <span style="color:rgb(0,0,255);line-height:1.5;">operator</span> ILogger*    ()    <span style="color:rgb(0,0,255);line-height:1.5;">const</span>;            <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 转换为 ILogger 指针</span>
<span style="color:rgb(0,128,128);line-height:1.5;">28</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">29</span> <span style="color:rgb(0,0,255);line-height:1.5;">private</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">30</span>     ILogger*<span style="line-height:1.5;"> m_pLogger;
</span><span style="color:rgb(0,128,128);line-height:1.5;">31</span> };</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:0px;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　CStaticLogger 为简化日志组件使用而设计，用于静态加载 Logger DLL 的场合。使用方法：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><span style="line-height:1.5;color:rgb(153,51,0);">　　　　0. 应用程序包含 StaticLogger.h 头文件</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　1. 创建 CStaticLogger 对象（通常为全局对象）</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　2. 调用 CStaticLogger-&gt;Init(...) 初始化日志组件</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　3. 使用 CStaticLogger-&gt;Log()/Debug()/Trace()/Info()/Warn()/Error()/Fatal() 等方法写日志</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　4. 调用 CStaticLogger-&gt;UnInit(...) 清理日志组件（CStaticLogger 对象析构时也会自动清理日志组件）</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><strong>　<strong>　</strong>3、CDynamicLogger：ILogger 包装器（智能指针）—— 用于动态加载 Logger DLL</strong>&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:0px;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">  1</span> <span style="color:rgb(0,0,255);line-height:1.5;">#pragma</span> once
<span style="color:rgb(0,128,128);line-height:1.5;">  2</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">  3</span> #include <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Logger.h</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>
<span style="color:rgb(0,128,128);line-height:1.5;">  4</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">  5</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">************************************************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">  6</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">******** </span><span style="color:rgb(0,128,0);text-decoration:underline;line-height:1.5;">http://www.cnblogs.com/ldcsaa/</span><span style="color:rgb(0,128,0);line-height:1.5;"> ********</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">  7</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">************* Logger DLL 默认文件名 **************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;">  8</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">  9</span> <span style="line-height:1.5;">#ifdef _DEBUG
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 10</span> <span style="line-height:1.5;">    #ifdef _UNICODE
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 11</span> <span style="line-height:1.5;">        #ifdef _WINDOWS
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 12</span>             <span style="color:rgb(0,0,255);line-height:1.5;">#define</span> DEF_LOGGER_DLL_FILE_PATH    _T("Logger_UD.dll")
<span style="color:rgb(0,128,128);line-height:1.5;"> 13</span>         <span style="color:rgb(0,0,255);line-height:1.5;">#else</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 14</span>             <span style="color:rgb(0,0,255);line-height:1.5;">#define</span> DEF_LOGGER_DLL_FILE_PATH    _T("Logger_CUD.dll")
<span style="color:rgb(0,128,128);line-height:1.5;"> 15</span>         <span style="color:rgb(0,0,255);line-height:1.5;">#endif</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 16</span>     <span style="color:rgb(0,0,255);line-height:1.5;">#else</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 17</span> <span style="line-height:1.5;">        #ifdef _WINDOWS
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 18</span>             <span style="color:rgb(0,0,255);line-height:1.5;">#define</span> DEF_LOGGER_DLL_FILE_PATH    _T("Logger_D.dll")
<span style="color:rgb(0,128,128);line-height:1.5;"> 19</span>         <span style="color:rgb(0,0,255);line-height:1.5;">#else</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 20</span>             <span style="color:rgb(0,0,255);line-height:1.5;">#define</span> DEF_LOGGER_DLL_FILE_PATH    _T("Logger_CD.dll")
<span style="color:rgb(0,128,128);line-height:1.5;"> 21</span>         <span style="color:rgb(0,0,255);line-height:1.5;">#endif</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 22</span>     <span style="color:rgb(0,0,255);line-height:1.5;">#endif</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 23</span> <span style="color:rgb(0,0,255);line-height:1.5;">#else</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 24</span> <span style="line-height:1.5;">    #ifdef _UNICODE
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 25</span> <span style="line-height:1.5;">        #ifdef _WINDOWS
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 26</span>         <span style="color:rgb(0,0,255);line-height:1.5;">#define</span> DEF_LOGGER_DLL_FILE_PATH        _T("Logger_U.dll")
<span style="color:rgb(0,128,128);line-height:1.5;"> 27</span>         <span style="color:rgb(0,0,255);line-height:1.5;">#else</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 28</span>             <span style="color:rgb(0,0,255);line-height:1.5;">#define</span> DEF_LOGGER_DLL_FILE_PATH    _T("Logger_CU.dll")
<span style="color:rgb(0,128,128);line-height:1.5;"> 29</span>         <span style="color:rgb(0,0,255);line-height:1.5;">#endif</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 30</span>     <span style="color:rgb(0,0,255);line-height:1.5;">#else</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 31</span> <span style="line-height:1.5;">        #ifdef _WINDOWS
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 32</span>             <span style="color:rgb(0,0,255);line-height:1.5;">#define</span> DEF_LOGGER_DLL_FILE_PATH    _T("Logger.dll")
<span style="color:rgb(0,128,128);line-height:1.5;"> 33</span>         <span style="color:rgb(0,0,255);line-height:1.5;">#else</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 34</span>             <span style="color:rgb(0,0,255);line-height:1.5;">#define</span> DEF_LOGGER_DLL_FILE_PATH    _T("Logger_C.dll")
<span style="color:rgb(0,128,128);line-height:1.5;"> 35</span>         <span style="color:rgb(0,0,255);line-height:1.5;">#endif</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 36</span>     <span style="color:rgb(0,0,255);line-height:1.5;">#endif</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 37</span> <span style="color:rgb(0,0,255);line-height:1.5;">#endif</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 38</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 39</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">************************************************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 40</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">************** Logger DLL 导出函数 **************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 41</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 42</span> <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 创建 ILogger 对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 43</span> typedef ILogger*            (*<span style="line-height:1.5;">FN_ILogger_Create)            ();
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 44</span> <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 销毁 ILogger 对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 45</span> typedef <span style="color:rgb(0,0,255);line-height:1.5;">void</span>                (*FN_ILogger_Destroy)           (ILogger*<span style="line-height:1.5;"> p);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 46</span> <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取各日志级别的文字描述</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 47</span> typedef LPCTSTR             (*<span style="line-height:1.5;">FN_ILogger_GetLogLevelDesc)   (ILogger::LogLevel ll);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 48</span> <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取各操作错误码的文字描述</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 49</span> typedef LPCTSTR             (*<span style="line-height:1.5;">FN_ILogger_GetErrorDesc)      (ILogger::ErrorCode ec);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 50</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 51</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">***********************************************</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 52</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">********* ILogger 包装器（智能指针） **********</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 53</span> <span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">*********** 用于动态加载 Logger DLL ***********</span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 54</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 55</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> CDynamicLogger
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 56</span> <span style="line-height:1.5;">{
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 57</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 58</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 构造函数：如果 bLoad 为 TRUE，则在构建 CDynamicLogger 示例的同时创建 ILogger 对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 59</span>     CDynamicLogger(BOOL bLoad = TRUE, LPCTSTR lpszFilePath =<span style="line-height:1.5;"> DEF_LOGGER_DLL_FILE_PATH)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 60</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 61</span> <span style="line-height:1.5;">        Reset();
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 62</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 63</span>         <span style="color:rgb(0,0,255);line-height:1.5;">if</span><span style="line-height:1.5;">(bLoad)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 64</span> <span style="line-height:1.5;">            Load(lpszFilePath);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 65</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 66</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 67</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 析构函数</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 68</span>     ~<span style="line-height:1.5;">CDynamicLogger()
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 69</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 70</span> <span style="line-height:1.5;">        Free();
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 71</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 72</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 73</span> <span style="color:rgb(0,0,255);line-height:1.5;">private</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 74</span>     CDynamicLogger(<span style="color:rgb(0,0,255);line-height:1.5;">const</span> CDynamicLogger&amp;<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 75</span>     CDynamicLogger&amp; <span style="color:rgb(0,0,255);line-height:1.5;">operator</span> = (<span style="color:rgb(0,0,255);line-height:1.5;">const</span> CDynamicLogger&amp;<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 76</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 77</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 78</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 创建 ILogger 对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 79</span>     ILogger*<span style="line-height:1.5;"> ILogger_Create()
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 80</span>         {<span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> m_fnILoggerCreate();}
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 81</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 销毁 ILogger 对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 82</span>     <span style="color:rgb(0,0,255);line-height:1.5;">void</span> ILogger_Destroy(ILogger*<span style="line-height:1.5;"> p)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 83</span> <span style="line-height:1.5;">        {m_fnILoggerDestroy(p);}
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 84</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取各日志级别的文字描述</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 85</span> <span style="line-height:1.5;">    LPCTSTR    ILogger_GetLogLevelDesc(ILogger::LogLevel ll)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 86</span>         {<span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> m_fnILoggerGetLogLevelDesc(ll);}
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 87</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取各操作错误码的文字描述</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 88</span> <span style="line-height:1.5;">    LPCTSTR    ILogger_GetErrorDesc(ILogger::ErrorCode ec)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 89</span>         {<span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> m_fnILoggerGetErrorDesc(ec);}
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 90</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 91</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 加载 Logger DLL</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 92</span>     BOOL Load(LPCTSTR lpszFilePath =<span style="line-height:1.5;"> DEF_LOGGER_DLL_FILE_PATH)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 93</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 94</span>         <span style="color:rgb(0,0,255);line-height:1.5;">if</span><span style="line-height:1.5;">(IsValid())
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 95</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> FALSE;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 96</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 97</span>         BOOL isOK =<span style="line-height:1.5;"> FALSE;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 98</span>         m_hLogger =<span style="line-height:1.5;"> ::LoadLibrary(lpszFilePath);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 99</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">100</span>         <span style="color:rgb(0,0,255);line-height:1.5;">if</span><span style="line-height:1.5;">(m_hLogger)
</span><span style="color:rgb(0,128,128);line-height:1.5;">101</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">102</span>             m_fnILoggerCreate            = (FN_ILogger_Create)            ::GetProcAddress(m_hLogger, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">ILogger_Create</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">103</span>             m_fnILoggerDestroy           = (FN_ILogger_Destroy)           ::GetProcAddress(m_hLogger, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">ILogger_Destroy</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">104</span>             m_fnILoggerGetLogLevelDesc   = (FN_ILogger_GetLogLevelDesc)   ::GetProcAddress(m_hLogger, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">ILogger_GetLogLevelDesc</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">105</span>             m_fnILoggerGetErrorDesc      = (FN_ILogger_GetErrorDesc)      ::GetProcAddress(m_hLogger, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">ILogger_GetErrorDesc</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">106</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">107</span>             <span style="color:rgb(0,0,255);line-height:1.5;">if</span>(m_fnILoggerCreate &amp;&amp;<span style="line-height:1.5;"> m_fnILoggerDestroy)
</span><span style="color:rgb(0,128,128);line-height:1.5;">108</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">109</span>                 m_pLogger   =<span style="line-height:1.5;"> ILogger_Create();
</span><span style="color:rgb(0,128,128);line-height:1.5;">110</span>                 isOK        =<span style="line-height:1.5;"> <span style="line-height:1.5;">(m_pLogger != NULL);</span>
</span><span style="color:rgb(0,128,128);line-height:1.5;">111</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">112</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">113</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">114</span>         <span style="color:rgb(0,0,255);line-height:1.5;">if</span>(!<span style="line-height:1.5;">isOK)
</span><span style="color:rgb(0,128,128);line-height:1.5;">115</span> <span style="line-height:1.5;">            Free();
</span><span style="color:rgb(0,128,128);line-height:1.5;">116</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">117</span>         <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> isOK;
</span><span style="color:rgb(0,128,128);line-height:1.5;">118</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">119</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">120</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 卸载 Logger DLL</span>
<span style="color:rgb(0,128,128);line-height:1.5;">121</span> <span style="line-height:1.5;">    BOOL Free()
</span><span style="color:rgb(0,128,128);line-height:1.5;">122</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;">123</span>         <span style="color:rgb(0,0,255);line-height:1.5;">if</span>(!<span style="line-height:1.5;">IsValid())
</span><span style="color:rgb(0,128,128);line-height:1.5;">124</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> TRUE;
</span><span style="color:rgb(0,128,128);line-height:1.5;">125</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">126</span>         BOOL isOK =<span style="line-height:1.5;"> TRUE;
</span><span style="color:rgb(0,128,128);line-height:1.5;">127</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">128</span>         <span style="color:rgb(0,0,255);line-height:1.5;">if</span><span style="line-height:1.5;">(m_pLogger)    ILogger_Destroy(m_pLogger);
</span><span style="color:rgb(0,128,128);line-height:1.5;">129</span>         <span style="color:rgb(0,0,255);line-height:1.5;">if</span>(m_hLogger)    isOK =<span style="line-height:1.5;"> ::FreeLibrary(m_hLogger);
</span><span style="color:rgb(0,128,128);line-height:1.5;">130</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">131</span> <span style="line-height:1.5;">        Reset();
</span><span style="color:rgb(0,128,128);line-height:1.5;">132</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">133</span>         <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> isOK;
</span><span style="color:rgb(0,128,128);line-height:1.5;">134</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">135</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">136</span>     BOOL IsValid            ()    <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    {<span style="color:rgb(0,0,255);line-height:1.5;">return</span> m_pLogger != NULL;}  <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 判断其封装的 ILogger 指针是否非空</span>
<span style="color:rgb(0,128,128);line-height:1.5;">137</span>     ILogger* Get            ()    <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    {<span style="color:rgb(0,0,255);line-height:1.5;">return</span> m_pLogger;}          <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取 ILogger 指针</span>
<span style="color:rgb(0,128,128);line-height:1.5;">138</span>     ILogger&amp; <span style="color:rgb(0,0,255);line-height:1.5;">operator</span> *     ()    <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    {<span style="color:rgb(0,0,255);line-height:1.5;">return</span> *m_pLogger;}         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取 ILogger 引用</span>
<span style="color:rgb(0,128,128);line-height:1.5;">139</span>     ILogger* <span style="color:rgb(0,0,255);line-height:1.5;">operator</span> -&gt;    ()    <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    {<span style="color:rgb(0,0,255);line-height:1.5;">return</span> m_pLogger;}          <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 获取 ILogger 指针</span>
<span style="color:rgb(0,128,128);line-height:1.5;">140</span>     <span style="color:rgb(0,0,255);line-height:1.5;">operator</span> ILogger*       ()    <span style="color:rgb(0,0,255);line-height:1.5;">const</span>    {<span style="color:rgb(0,0,255);line-height:1.5;">return</span> m_pLogger;}          <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 转换为 ILogger 指针</span>
<span style="color:rgb(0,128,128);line-height:1.5;">141</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">142</span> <span style="color:rgb(0,0,255);line-height:1.5;">private</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">143</span>     <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> Reset()
</span><span style="color:rgb(0,128,128);line-height:1.5;">144</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;">145</span>         m_hLogger                    =<span style="line-height:1.5;"> NULL;
</span><span style="color:rgb(0,128,128);line-height:1.5;">146</span>         m_pLogger                    =<span style="line-height:1.5;"> NULL;
</span><span style="color:rgb(0,128,128);line-height:1.5;">147</span>         m_fnILoggerCreate            =<span style="line-height:1.5;"> NULL;
</span><span style="color:rgb(0,128,128);line-height:1.5;">148</span>         m_fnILoggerDestroy           =<span style="line-height:1.5;"> NULL;
</span><span style="color:rgb(0,128,128);line-height:1.5;">149</span>         m_fnILoggerGetLogLevelDesc   =<span style="line-height:1.5;"> NULL;
</span><span style="color:rgb(0,128,128);line-height:1.5;">150</span>         m_fnILoggerGetErrorDesc      =<span style="line-height:1.5;"> NULL;
</span><span style="color:rgb(0,128,128);line-height:1.5;">151</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">152</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">153</span> <span style="color:rgb(0,0,255);line-height:1.5;">private</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">154</span> <span style="line-height:1.5;">    HMODULE         m_hLogger;
</span><span style="color:rgb(0,128,128);line-height:1.5;">155</span>     ILogger*<span style="line-height:1.5;">        m_pLogger;
</span><span style="color:rgb(0,128,128);line-height:1.5;">156</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">157</span> <span style="line-height:1.5;">    FN_ILogger_Create            m_fnILoggerCreate;
</span><span style="color:rgb(0,128,128);line-height:1.5;">158</span> <span style="line-height:1.5;">    FN_ILogger_Destroy           m_fnILoggerDestroy;
</span><span style="color:rgb(0,128,128);line-height:1.5;">159</span> <span style="line-height:1.5;">    FN_ILogger_GetLogLevelDesc   m_fnILoggerGetLogLevelDesc;
</span><span style="color:rgb(0,128,128);line-height:1.5;">160</span> <span style="line-height:1.5;">    FN_ILogger_GetErrorDesc      m_fnILoggerGetErrorDesc;
</span><span style="color:rgb(0,128,128);line-height:1.5;">161</span> };</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:0px;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　　CDynamicLogger 为简化日志组件使用而设计，用于动态加载 Logger DLL 的场合。使用方法：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">　<span style="line-height:1.5;color:rgb(153,51,0);">　　　0. 应用程序包含 DynamicLogger.h 头文件</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　1. 创建 CDynamicLogger 对象（通常为全局对象）</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　2. 调用 CDynamicLogger-&gt;Init(...) 初始化日志组件</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　3. 使用 CDynamicLogger-&gt;Log()/Debug()/Trace()/Info()/Warn()/Error()/Fatal() 等方法写日志</span><br><span style="line-height:1.5;color:rgb(153,51,0);">　　　　4. 调用 CDynamicLogger-&gt;UnInit(...) 清理日志组件（CDynamicLogger 对象析构时也会自动清理日志组件）&nbsp;</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;　　（<a title="Logger" href="http://ldcsaa.googlecode.com/files/VC_Logger.zip" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">有需要的朋友请轻踩这里，你懂的^_*</a>）</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">转自：<a href="http://www.cnblogs.com/ldcsaa/archive/2012/06/28/2560619.html%C3%82" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">http://www.cnblogs.com/ldcsaa/archive/2012/06/28/2560619.html&nbsp;</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><br></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><br></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><br></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><br></p> 
   <p style="line-height:1.5;"><font color="#4b4b4b"><span style="font-size:13px;">本文转自夏雪冬日博客园博客，原文链接：http://www.cnblogs.com/heyonggang/archive/2012/12/25/2831803.html，如需转载请自行联系原作者</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
