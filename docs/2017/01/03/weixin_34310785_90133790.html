<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Hawk: 无编程抓取淘女郎的所有高清照片 « NotBeCN</title>
  <meta name="description" content="                  1.这是什么鬼？     哦？美女？ 最近看了这一篇文章：http://cuiqingcai.com/1001.html     大概说的是用Python和Pyspider（这货好像是我的一位师兄写的，吓尿），抓取淘宝淘女郎的所有美女照片。只是里面还要敲一堆代码，还要用其他动态...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/01/03/weixin_34310785_90133790.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Hawk: 无编程抓取淘女郎的所有高清照片</h1>
    <p class="post-meta">Jan 3, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body cnblogs-markdown"> 
    <h2>1.这是什么鬼？</h2> 
    <p>哦？美女？<br> 最近看了这一篇文章：<a class="uri" href="http://cuiqingcai.com/1001.html" rel="nofollow">http://cuiqingcai.com/1001.html</a></p> 
    <p>大概说的是用Python和Pyspider（这货好像是我的一位师兄写的，吓尿），抓取淘宝淘女郎的所有美女照片。只是里面还要敲一堆代码，还要用其他动态js运行框架，看着好不烦人啊。</p> 
    <p>Hawk是沙漠君开发的一款爬虫和清洗工具，目前已经在Github开源：<br><code>https://github.com/ferventdesert/Hawk</code></p> 
    <p>最近沙漠君很开心啊，开发的Hawk在GitHub上上百个star，还有歪果仁来帮忙做英文国际化，哈哈哈。</p> 
    <p>那既然如此，我也用Hawk练练手，基本无需编程，直接无视动态js调用，下载高清图片。造福各位园友。</p> 
    <p>这简直就是用Hawk做坏事，顺便炫技啊~~</p> 
    <h2>2.先让兄弟们饱饱眼福？</h2> 
    <p>先看看抓取的效果，我才不直接放高清图呢！<br><img alt="image_1aj6540v01l2r16t41sn31o681jpf5v.png-435.4kB" src="http://static.zybuluo.com/buptzym/5j0nly3ifv1phixcralvfscn/image_1aj6540v01l2r16t41sn31o681jpf5v.png"><br> 恩，先去下载软件吧，在百度云盘（这货最近经常脑抽），如果你之前下过软件，一定要更新Hawk开头的dll和exe文件，其他不需要。因为勤劳的沙漠君又更新代码了...<br><code>http://pan.baidu.com/s/1c8zBiQ 密码：4iy0</code><br> 注意三个后缀名为config和xml的配置文件一定要下载回来，之后双击Hawk.exe.<br> 我已经把工程文件共享出来了。地址在：<br><code>https://github.com/ferventdesert/Hawk-Projects/tree/master/淘女郎</code></p> 
    <p>在Hawk菜单-&gt;文件-&gt;加载工程，把project.xml加载进来。会是下面的样子：<br><img alt="image_1aj60o43kdusbibtco90c1pc29.png-18kB" src="http://static.zybuluo.com/buptzym/bh3bdg8c7cx3j0c1ohdbwk74/image_1aj60o43kdusbibtco90c1pc29.png"><br> 然后，双击“主流程”（点这三个字所在的位置）</p> 
    <p>之后任务就会被加载进来，在右下角显示所有的任务和数据表：<br><img alt="image_1aj627e2913bck1r1gi216jd195l9.png-20.2kB" src="http://static.zybuluo.com/buptzym/x0ygt8awuupvklzxxkmmns6m/image_1aj627e2913bck1r1gi216jd195l9.png"></p> 
    <p>接下来，在<strong>算法视图</strong>上，双击<strong>主流程</strong>，就可以看到这个任务的窗口和属性配置框了：<br><img alt="image_1aj629ekg175h1lc21er5nh3e4om.png-84.6kB" src="http://static.zybuluo.com/buptzym/ev50albbx6jj2pi02j720cm3/image_1aj629ekg175h1lc21er5nh3e4om.png"><br> 哈哈，不仅有详细的名字，地址，甚至还有身高体重等详细信息，各位慢慢看。</p> 
    <p>说好的保存图片呢？别急别急，这只是在模拟运行模式，保存图片这种有副作用的任务是不会执行的。</p> 
    <p>那我的图片保存在哪里了？注意看到刚才的project.xml文件同目录下，还有<code>主流程.py</code>，这是一个用于配置流程的py脚本。我把一部分内容贴在下面：</p> 
    <pre><code class="hljs python">
<span class="hljs-comment">#########下面是正式配置文件</span>
<span class="hljs-comment">#是否要抓取图片？</span>
get(主流程.etls,<span class="hljs-number">-1</span>).Enabled=<span class="hljs-keyword">True</span>;

<span class="hljs-comment">#照片保存路径</span>
path=<span class="hljs-string">'D:\淘女郎'</span>

<span class="hljs-comment">#将相册表保存起来吗？</span>
get(相册.etls,<span class="hljs-number">-1</span>).Enabled=<span class="hljs-keyword">True</span>;

<span class="hljs-comment">#保存大图吗？False则只保存小图</span>
find(相册.etls,<span class="hljs-keyword">lambda</span> x:x.Name==<span class="hljs-string">'大图'</span>).Enabled=<span class="hljs-keyword">True</span>

<span class="hljs-comment">#每个女郎最多抓取多少张照片</span>
照片数量控制.Take=<span class="hljs-number">1000</span>

find(相册.etls,<span class="hljs-keyword">lambda</span> x:x.Name==<span class="hljs-string">'图片位置'</span>).NewValue=path;
</code></pre> 
    <p>我应该不用解释了吧？对文件进行修改，注意编码格式是UTF-8，然后在<strong>模块管理</strong>卷展栏的<strong>主流程</strong>位置点右键，执行任务脚本：<br><img alt="image_1aj62jeam47ska11d4p1j451dq313.png-14.2kB" src="http://static.zybuluo.com/buptzym/gxrit89plvct08wh5h3kvsru/image_1aj62jeam47ska11d4p1j451dq313.png"><br> 它就会对当前的任务进行修改，如果下面的日志文件显示：<br><img alt="image_1aj62k9dv1r1e15mu3mcj9a1a0t1g.png-3.7kB" src="http://static.zybuluo.com/buptzym/5gckjjnlu065mhglnspf726p/image_1aj62k9dv1r1e15mu3mcj9a1a0t1g.png"><br> 那么脚本没有语法错误，已经成功提交。</p> 
    <p>之后，激动人心的时刻到了，在属性对话框点击执行：<br><img alt="image_1aj62nhqn1agd94gh591g5dapp1t.png-10.8kB" src="http://static.zybuluo.com/buptzym/40qp52kkhbi3kmaetaxngrwk/image_1aj62nhqn1agd94gh591g5dapp1t.png"><br> 然后，20个并行抓取任务线程就已经开始了：<br><img alt="image_1aj62olin1q82bafkgc1n0cch72a.png-20.9kB" src="http://static.zybuluo.com/buptzym/egxjdnoic6qjtl0t74sqve53/image_1aj62olin1q82bafkgc1n0cch72a.png"><br> 系统会自动维持线程列表中的线程数量，只有旧任务工作完毕后，才会添加新的线程进来。<br> 下面的三个表，分别是淘女郎信息表，相册信息表，和照片信息表。采集完毕后，你可以点右键，导出到excel,csv..<br><img alt="image_1aj62r4721j2g1tch1a7g1g8t5ng2n.png-7.5kB" src="http://static.zybuluo.com/buptzym/ge57v1dr946sh9chgq7g2f51/image_1aj62r4721j2g1tch1a7g1g8t5ng2n.png"><br> 至于图片嘛，看看你设置的那个文件夹吧：<br><img alt="image_1aj62t6171lmh1jpc13jf1hlg1r9t34.png-45.9kB" src="http://static.zybuluo.com/buptzym/0i020plarh9lh0i96caxk30h/image_1aj62t6171lmh1jpc13jf1hlg1r9t34.png"></p> 
    <p>Enjoy!</p> 
    <h2>3.代码是怎么写的？</h2> 
    <p>Hawk本身是开源的，本质上是个编译和解释器。生成的xml就是代码和控制逻辑。很多个模块构成处理链条，你可以控制链条上的模块数量，就能观察数据是如何被采集和处理的。<br> 整个程序包含两个流程：</p> 
    <ul>
     <li>主流程：负责从页面生成淘女郎的详细信息列表</li> 
     <li>相册：负责从淘女郎的id和姓名，获取其对应的照片。</li> 
    </ul>
    <h3>主流程：获取女孩信息</h3> 
    <p>先看主流程，我们把调试数量改为1，勾选<strong>显示调试详情</strong>，点击<strong>下一步</strong>:<br><img alt="image_1aj6359r1uc61t0teih1fj4vbg3h.png-15.6kB" src="http://static.zybuluo.com/buptzym/g66yncw7ml127napml8eo9u5/image_1aj6359r1uc61t0teih1fj4vbg3h.png"></p> 
    <p>会有下面的信息显示出来，绿色代表该模块输入的列，蓝色代表输出的列。在调试模块属性中显示的是当前模块的基本信息和配置。</p> 
    <p><img alt="image_1aj63ol1t122ihj974v1mdg1tvc4b.png-41.4kB" src="http://static.zybuluo.com/buptzym/ckr31xudxqgksmbuwcck13hr/image_1aj63ol1t122ihj974v1mdg1tvc4b.png"></p> 
    <p>基本的逻辑就是，生成从1到4700页的区间数，然后将它们分别转换成url:<br><a class="uri" href="https://mm.taobao.com/json/request_top_list.htm?page" rel="nofollow">https://mm.taobao.com/json/request_top_list.htm?page</a>={0}<br> 然后通过从爬虫采集，获取女孩的列表，再根据用户的id，组合出详情页，并把详情页的信息附加到当前表。将表的内容写入到“淘女郎”表，再针对每个女孩的id，去获取她的相册信息。</p> 
    <h3>相册：获取单个女孩的照片</h3> 
    <p>如果你直接双击相册模块，肯定是出现下面的情况，什么数据都没有：<br><img alt="image_1aj643ha01hpn5cd1r51kak1r0v4o.png-12.4kB" src="http://static.zybuluo.com/buptzym/m8aenockjz8y4hrq2rk8ts8w/image_1aj643ha01hpn5cd1r51kak1r0v4o.png"><br> 为什么呢？因为没有提供数据源。在主流程中，相册模块会读取主流程的id和名字两个列的内容，作为输入参数。但独立运行时，需要两个<strong>从文本生成</strong>来提供任务参数。</p> 
    <p>因此，我们勾选那两个<strong>从文本生成</strong>的单选框，表示启用之：<br> 再点刷新，是不是就都有了？<br><img alt="image_1aj647fqh1p7kur6a6h1ke01sh755.png-76.5kB" src="http://static.zybuluo.com/buptzym/c502pix2ebiaeoee87r4z530/image_1aj647fqh1p7kur6a6h1ke01sh755.png"></p> 
    <p>你也可以单步调试，看看这个模块是怎么获得的。基本流程如下：</p> 
    <ol>
     <li>通过女孩的id，组合出相册的url，比如下面：<br><code>mm.taobao.com/self/album/open_album_list.htm?_charset=utf-8&amp;user_id%20=687471686</code> </li> 
     <li>通过一个网页采集器，名称为<strong>相册列表</strong>获取相册</li> 
     <li>再通过相册ID，获取相册的URL。相册的URL需要构造请求，获得的是Json。</li> 
     <li>把Json的头部Jsonp和末尾的括号去掉，形成正确格式的json</li> 
     <li>送入文本到Json转换模块，得到的是字典</li> 
     <li>使用Python转换器，提取里面的picList，再转换为文档列表。这就是照片列表</li> 
     <li>将路径和相册id，组合成实际要保存的图片的位置</li> 
     <li>加入<strong>保存超链接文件</strong>，会把指定url的文件保存到指定位置</li> 
    </ol>
    <p>欣赏完相册是怎么执行的之后，在切换回主流程之前，记得把那两个<strong>从文本生成</strong>关掉。否则会影响主流程的调用。<br> 有两种方法，一种是在主流程任务那里，执行任务脚本，系统会自动操作。<br> 也可以直接在相册的属性对话框中，点击<strong>编辑集合</strong>，把最上面两个的启用去掉：<br><img alt="image_1aj64ovh3d9t17nost2re5rn45i.png-67.7kB" src="http://static.zybuluo.com/buptzym/oye0d9xm2f6ruvzsiwlkewhv/image_1aj64ovh3d9t17nost2re5rn45i.png"></p> 
    <p>值得一提的是，模块上都有<strong>标签</strong>属性，你可以给某一组的模块打上固定的标签，在外部的python代码中通过标签搜索这些模块，进行批量处理。具体可以参考刚才的那个py文件。</p> 
    <h2>3.下一篇文章的内容？</h2> 
    <p>限于篇幅，本文没有详细地讲解如何模拟动态请求，如何探测请求的内容，这些都会在下一篇文章介绍。<br> Hawk系列文章：<br><a href="http://www.cnblogs.com/buptzym/p/5454190.html" rel="nofollow">Hawk-数据抓取工具：简明教程</a><br><a href="http://www.cnblogs.com/buptzym/p/5500979.html" rel="nofollow">Hawk： 20分钟无编程抓取大众点评17万数据</a><br><a href="http://www.cnblogs.com/buptzym/p/5320552.html" rel="nofollow">etlpy: 并行爬虫和数据清洗工具</a><br> 有任何问题，欢迎随时交流。</p> 
   </div> 
   <div> 
    <div> 
     <p style="border-top:#e0e0e0 1px dashed;border-right:#e0e0e0 1px dashed;border-bottom:#e0e0e0 1px dashed;border-left:#e0e0e0 1px dashed;background:#e5f1f4 url(&quot;https://images.cnblogs.com/cnblogs_com/lloydsheng/239039/o_copyright.gif&quot;) no-repeat 1% 50%;font-family:'微软雅黑';font-size:11px;"><br> 作者：<a href="http://www.cnblogs.com/buptzym/" rel="nofollow">热情的沙漠</a> <br> 出处：<a href="http://www.cnblogs.com/buptzym/" rel="nofollow">http://www.cnblogs.com/buptzym/</a> <br> 本文版权归作者和博客园共有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利。 <br></p> 
    </div> 
   </div> 
   <div class="clear"></div> 
   <div> 
    <div>
     分类: 
     <a href="http://www.cnblogs.com/buptzym/category/809619.html" rel="nofollow">开源项目</a> 
    </div> 
    <div>
     <br>
    </div> 
    <div>
     本文转自FerventDesert博客园博客，原文链接：http://www.cnblogs.com/buptzym/p/5511781.html，如需转载请自行联系原作者
     <br>
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
