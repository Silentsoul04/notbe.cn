<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>kvm虚拟化管理平台WebVirtMgr部署-完整记录(1) « NotBeCN</title>
  <meta name="description" content="                  公司机房有一台2U的服务器（64G内存，32核），由于近期新增业务比较多，测试机也要新增，服务器资源十分有限。所以打算在这台2U服务器上部署kvm虚拟化，虚出多台VM出来，以应对新的测试需求。 当KVM宿主机越来越多，需要对宿主机的状态进行调控，决定采用WebVirtMgr作为...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/09/06/weixin_33938733_90134560.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">kvm虚拟化管理平台WebVirtMgr部署-完整记录(1)</h1>
    <p class="post-meta">Sep 6, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;line-height:19.5px;"> 
    <p style="line-height:1.5;">公司机房有一台2U的服务器（64G内存，32核），由于近期新增业务比较多，测试机也要新增，服务器资源十分有限。所以打算在这台2U服务器上部署kvm虚拟化，虚出多台VM出来，以应对新的测试需求。<br> 当KVM宿主机越来越多，需要对宿主机的状态进行调控，决定采用WebVirtMgr作为kvm虚拟化的web管理工具，图形化的WEB，让人能更方便的查看kvm 宿主机的情况和操作<br> WebVirtMgr是近两年来发展较快，比较活跃，非常清新的一个KVM管理平台，提供对宿主机和虚机的统一管理，它有别于kvm自带的图形管理工具（virtual machine manager），让kvm管理变得更为可视化，对中小型kvm应用场景带来了更多方便。<br> WebVirtMgr采用几乎纯Python开发，其前端是基于Python的Django，后端是基于Libvirt的Python接口，将日常kvm的管理操作变的更加的可视化。</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);">WebVirtMgr特点</span><br> 操作简单，易于使用<br> 通过libvirt的API接口对kvm进行管理<br> 提供对虚拟机生命周期管理<br> WebVirtMgr 功能</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);">宿主机管理支持以下功能</span><br> CPU利用率<br> 内存利用率<br> 网络资源池管理<br> 存储资源池管理<br> 虚拟机镜像<br> 虚拟机克隆<br> 快照管理<br> 日志管理<br> 虚机迁移</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);">虚拟机管理支持以下功能</span><br> CPU利用率<br> 内存利用率<br> 光盘管理<br> 关/开/暂停虚拟机<br> 安装虚拟机<br> VNC console连接<br> 创建快照</p> 
    <p style="line-height:1.5;">下面对部署过程进行记录，希望能帮助到有用到的朋友们。<br> 这里我将webvirtmgr服务器和kvm服务器放在同一台机器上部署的，即单机部署<br> 系统：Centos 6.8<br> 内存:64G<br> CPU:32核<br> ip：192.168.1.17（内网），111.101.186.163（外网）</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(128,0,128);"><strong>一、首先要安装KVM虚拟化环境，参考下面的一篇博客进行安装：</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);"><a href="http://www.cnblogs.com/kevingrace/p/5737487.html" rel="nofollow" style="color:rgb(7,93,179);"><span style="line-height:1.5;color:rgb(0,0,255);">kvm虚拟化管理平台WebVirtMgr部署-虚拟化环境安装-完整记录(0)</span></a></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(128,0,128);"><strong>二、Kvm的管理工具webvirtmgr安装和使用</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">1）安装支持的软件源</span><br> [root@openstack ops]#yum -y install&nbsp;<a href="http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm" rel="nofollow" style="color:rgb(7,93,179);">http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm</a></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">2）安装相关软件</span><br><span style="line-height:1.5;">---------------------------------------------------------------------------------------------------------------------</span><br> 如果报错说没有下面安装的某些软件，则下载<a href="http://pan.baidu.com/s/1bX3vkE" rel="nofollow" style="color:rgb(7,93,179);">http://pan.baidu.com/s/1bX3vkE</a>&nbsp;（密码：6ucs）&nbsp;<br> 将下载的yum.tar.gz解压后的文件替换到/etc/yum.repos.d目录下，然后执行yum clean all &amp;&amp; yum makecache<br><span style="line-height:1.5;">---------------------------------------------------------------------------------------------------------------------</span><br> [root@openstack ops]#yum -y install git python-pip libvirt-python libxml2-python python-websockify supervisor nginx&nbsp; &nbsp; &nbsp; &nbsp;<span style="line-height:1.5;color:rgb(255,0,0);">（若是centos7系统，需要先执行"yum -y install epel-release"）</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">3）从git-hub中下载相关的webvirtmgr代码</span><br> [root@openstack ops]# cd /usr/local/src/<br> [root@openstack src]# git clone git://github.com/retspen/webvirtmgr.git &nbsp; &nbsp;（下载地址：<a href="https://pan.baidu.com/s/1pLS3kCj%20" rel="nofollow" style="color:rgb(7,93,179);">https://pan.baidu.com/s/1pLS3kCj&nbsp;</a>&nbsp; &nbsp; &nbsp;获取密码：<span style="line-height:1.5;color:rgb(0,0,255);">8efm</span>）</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">4）安装webvirtmgr</span><br> [root@openstack src]# cd webvirtmgr/<br> [root@openstack webvirtmgr]# pip install -r requirements.txt</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">5）安装数据库</span><br> [root@openstack webvirtmgr]# yum install python-sqlite2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //默认情况下，centos系统一般会自带sqlite软件（执行sqlite3&nbsp;命令，不报错就说明已经安装了）</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">6）对django进行环境配置</span><br> [root@openstack webvirtmgr]#pwd<br> /usr/local/src/webvirtmgr<br> [root@openstack webvirtmgr]#<span style="line-height:1.5;color:rgb(255,0,255);">./manage.py syncdb</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//默认是python执行，如下报错，换用其他版本的python<br><span style="line-height:1.5;color:rgb(255,0,0);"><strong>-------------------------------------------------- ----------------------------&nbsp;</strong></span><br><span style="line-height:1.5;color:rgb(0,0,255);"><strong>注意此处用默认的python执行上面命令，一般会报错，如下：</strong></span><br><span style="line-height:1.5;">ImportError: No module named django.core.management</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);"><strong>这个一般是由于python版本引起的，因为系统自带有好几个版本的python</strong></span><br> [root@openstack webvirtmgr]# python &nbsp; &nbsp; &nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">//按Tab键自查找</span><br><span style="line-height:1.5;">python python2.6&nbsp;</span><br><span style="line-height:1.5;">python2</span>&nbsp;python2.6-config python-config<br> [root@openstack webvirtmgr]# python -V<br> Python 2.6.6</p> 
    <p style="line-height:1.5;"><strong>由此可看出，系统默认的Python版本是2.6.6</strong><br><strong>说明上面命令默认是python2.6执行的</strong></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);">既然使用python2.6执行上面的命令报错，那就换用其他版本python2执行</span><span style="line-height:1.5;color:rgb(255,0,0);">（如果当前是python3.3.0，那么就将下面的/usr/bin/python2换成/usr/bin/python2.6）</span><br> [root@openstack webvirtmgr]#&nbsp;<strong><span style="line-height:1.5;color:rgb(255,0,255);">/usr/bin/python2 manage.py syncdb</span></strong>&nbsp;&nbsp; &nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;//最终发现使用python2执行这个命令就不报错了&nbsp;</span><br> ............<br> ............&nbsp;<br> You just installed Django's auth system, which means you don't have any superusers defined.<br> Would you like to create one now? (yes/no):&nbsp;<span style="line-height:1.5;color:rgb(255,0,0);"><strong>yes</strong></span><br> Username (leave blank to use 'root'):&nbsp;<span style="line-height:1.5;color:rgb(255,0,0);"><strong>admin</strong></span><br> Email address: wangshibo@163.com<br> Password:*********<br> Password (again):*********<br><span style="line-height:1.5;color:rgb(255,0,0);"><strong>---------------------&nbsp;---------------------&nbsp;---------------------&nbsp;---------------------&nbsp;</strong></span><br> [root@openstack webvirtmgr]#/usr/bin/python2 manage.py collectstatic &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">//生成配置文件（同样使用python2版本执行，不要使用默认的python执行）</span><br> WARNING:root:No local_settings file found.</p> 
    <p style="line-height:1.5;">You have requested to collect static files at the destination<br> location as specified in your settings.</p> 
    <p style="line-height:1.5;">This will overwrite existing files!<br> Are you sure you want to do this?</p> 
    <p style="line-height:1.5;">Type 'yes' to continue, or 'no' to cancel:&nbsp;<span style="line-height:1.5;color:rgb(255,0,0);"><strong>yes</strong>&nbsp;</span><br> ..........<br> ..........</p> 
    <p style="line-height:1.5;">[root@openstack webvirtmgr]#/usr/bin/python2 manage.py createsuperuser &nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">//添加管理员账号（同样使用python2版本执行，不要使用默认的python执行）</span><br> WARNING:root:No local_settings file found.<br> Username:<span style="line-height:1.5;color:rgb(255,0,0);"><strong>&nbsp;ops &nbsp;</strong>&nbsp;</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">//这个是管理员账号，用上面的admin和这个管理员账号都可以登陆webvirtmgr的web界面管理平台</span><br> Email address: wangshibo@163.com<br> Password:&nbsp;<br> Password (again):&nbsp;<br> Superuser created successfully.</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">7）拷贝web到 相关目录</span><br> [root@openstack ops]# mkdir -pv /var/www<br> [root@openstack ops]# cp -Rv /usr/local/src/webvirtmgr /var/www/webvirtmgr<br><br><span style="line-height:1.5;color:rgb(153,51,0);">8）设置ssh</span><br> [root@openstack ops]# ssh-keygen -t rsa &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //产生公私钥<br> [root@openstack ops]# ssh-copy-id 192.168.1.17 &nbsp; &nbsp; &nbsp; &nbsp;//由于这里webvirtmgr和kvm服务部署在同一台机器，所以这里本地信任。如果kvm部署在其他机器，那么这个是它的ip<br> [root@openstack ops]# ssh 192.168.1.17 -L localhost:8000:localhost:8000 -L localhost:6080:localhost:60</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">9）编辑nginx配置文件</span><br> 提前确保/etc/nginx/nginx.conf文件里开启了“include /etc/nginx/conf.d/*.conf;”</p> 
    <p style="line-height:1.5;">[root@openstack ops]#vim /etc/nginx/conf.d/webvirtmgr.conf &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //添加下面内容到文件中<br> server {<br> listen 80 default_server;<br><br> server_name $hostname;<br> #access_log /var/log/nginx/webvirtmgr_access_log;<br><br> location /static/ {<br> root /var/www/webvirtmgr/webvirtmgr; # or /srv instead of /var<br> expires max;<br> }<br><br> location / {<br> proxy_pass http://127.0.0.1:8000;<br> proxy_set_header X-Real-IP $remote_addr;<br> proxy_set_header X-Forwarded-for $proxy_add_x_forwarded_for;<br> proxy_set_header Host $host:$server_port;<br> proxy_set_header X-Forwarded-Proto $remote_addr;<br> proxy_connect_timeout 600;<br> proxy_read_timeout 600;<br> proxy_send_timeout 600;<br> client_max_body_size 1024M; # Set higher depending on your needs<br> }<br> }<br><br> [root@openstack ops]# mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.bak<br></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">10）启动nginx</span><br> [root@openstack ops]#/ etc/init.d/nginx restart</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">11）修改防火墙规则</span><br> [root@ops ~]# vim /etc/sysconfig/selinux&nbsp;<br> ......<br> SELINUX=disabled</p> 
    <p style="line-height:1.5;">[root@ops ~]# setenforce 0<br> setenforce: SELinux is disabled<br> [root@ops ~]# getenforce&nbsp;<br> Disabled</p> 
    <p style="line-height:1.5;">[root@openstack ops]#/usr/sbin/setsebool httpd_can_network_connect true</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">12）设置 supervisor</span><span style="line-height:1.5;color:rgb(0,0,255);">&nbsp;(如果iptables防火墙开启的话，就必须要开通80、8000、6080端口访问)</span><br> [root@openstack ops]# chown -R nginx:nginx /var/www/webvirtmgr</p> 
    <p style="line-height:1.5;">[root@openstack ops]# vim /etc/supervisord.conf &nbsp; &nbsp; //在文件末尾添加,注意将默认的python改为python2，因为上面只有用这个版本执行才不报错！<br> [program:webvirtmgr]<br> command=<span style="line-height:1.5;">/usr/bin/python2 /var/www/webvirtmgr/manage.py run_gunicorn -c /var/www/webvirtmgr/conf/gunicorn.conf.py &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">//启动8000端口</span></span><br> directory=/var/www/webvirtmgr<br> autostart=true<br> autorestart=true<br> logfile=/var/log/supervisor/webvirtmgr.log<br> log_stderr=true<br> user=nginx</p> 
    <p style="line-height:1.5;">[program:webvirtmgr-console]<br> command=<span style="line-height:1.5;">/usr/bin/python2 /var/www/webvirtmgr/console/webvirtmgr-console &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">//启动6080端口（这是控制台vnc端口）</span></span><br> directory=/var/www/webvirtmgr<br> autostart=true<br> autorestart=true<br> stdout_logfile=/var/log/supervisor/webvirtmgr-console.log<br> redirect_stderr=true<br> user=nginx<br> [root@openstack ops]#vim /var/www/webvirtmgr/conf/gunicorn.conf.py &nbsp; &nbsp;//确保下面bind绑定的是本机的8000端口，这个在nginx配置中定义了，被代理的端口<br> bind = '127.0.0.1:8000'<br><span style="line-height:1.5;color:rgb(153,51,0);">13）设置开机启动</span><br> [root@openstack ops]#chkconfig supervisord on<br> [root@openstack ops]#vim /etc/rc.local<br> /usr/sbin/setsebool httpd_can_network_connect true<br></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">14）启动进程</span><br> [root@openstack ops]#/etc/init.d/supervisord restart<br><span style="line-height:1.5;color:rgb(153,51,0);">15）查看进程</span><br> [root@openstack ops]#netstat -lnpt &nbsp; &nbsp;//即可以看到6080和8000已经启动<br> [root@openstack ops]# lsof -i:6080<br> COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME<br> python2 53476 nginx 3u IPv4 364124 0t0 TCP *:6080 (LISTEN)<br> [root@openstack ops]#lsof -i:8000</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;">------------------------------------------------------------------------------</span><br><span style="line-height:1.5;">一般来说，只要上面的supervisord服务启动了，8000和6080端口就起来了。</span><br><span style="line-height:1.5;">因为在/etc/supervisord.conf文件里配置了这两个端口的启动设置</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;">如果supervisord服务启动了，8000和6080端口还是没起来！</span><br><span style="line-height:1.5;">那么就需要手动启动/etc/supervisord.conf文件里配置的这两个端口的启动命令，即：</span><br><span style="line-height:1.5;">[root@openstack ops]# /usr/bin/python2 /var/www/webvirtmgr/manage.py run_gunicorn -c /var/www/webvirtmgr/conf/gunicorn.conf.py &nbsp; &nbsp; &nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">//这个命令会一直在操作</span></span><br><span style="line-height:1.5;">[root@openstack ops]# /usr/bin/python2 /var/www/webvirtmgr/console/webvirtmgr-console &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">//</span><span style="line-height:1.5;color:rgb(0,128,0);">这个命令会一直在操作</span></span><br><span style="line-height:1.5;">[root@openstack ops]# /etc/init.d/supervisord restart</span><br><span style="line-height:1.5;">[root@openstack ops]# lsof -i:8000</span><br><span style="line-height:1.5;">[root@openstack ops]# lsof -i:6080</span><br><span style="line-height:1.5;">------------------------------------------------------------------------------</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(153,51,0);">16）web访问</span><br> http://111.101.186.163/login/</p> 
    <p style="line-height:1.5;">这里用超级管理员登陆，只有超级管理员登陆后才能看到“基础构架”窗口</p> 
    <p style="line-height:1.5;">普通用户登陆后，只能看到“WebVirtMgr”一个窗口</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201608/907596-20160809145309324-1078540486.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201608/907596-20160804174919809-1021420214.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">选择“SSH链接“，设置Label，IP，用户</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;"><strong>注意：Label与IP要相同</strong></span></p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201608/907596-20160804175844325-1214891797.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201608/907596-20160804180324215-903394495.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">打开后，有报错！看来在上面使用ssh连接的配置环节有误所致！</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201608/907596-20160804180432684-1315824976.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;font-size:18px;color:rgb(255,0,0);"><strong>解决措施：</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);">1)在webvirtmgr服务器（服务端）上（这里kvm和WebVirtMgr部署在同一台机器上）创建nginx用户家目录（默认nginx服务安装时是没有nginx家目录的），生成nginx的公私钥</span><br> [root@openstack ops]# cd /home/<br> [root@openstack home]# mkdir nginx<br> [root@openstack home]# chown nginx.nginx nginx/<br> [root@openstack home]# chmod 700 nginx/ -R<br> [root@openstack home]# su - nginx -s /bin/bash<br> -bash-4.1$ ssh-keygen &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">#期间输入yes后直接回车，回车</span><br> -bash-4.1$ touch ~/.ssh/config &amp;&amp; echo -e "StrictHostKeyChecking=no\nUserKnownHostsFile=/dev/null" &gt;&gt; ~/.ssh/config<br> -bash-4.1$ chmod 0600 ~/.ssh/config</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);">2)在kvm（客服端）服务器上（这里kvm和WebVirtMgr部署在同一台机器上）配置用户，这里默认采用root用户</span><br><span style="line-height:1.5;">---------------------------------------------------------------------------------------------------------------------</span><br><span style="line-height:1.5;">如果采用其他用户，比如webvirtmgr，操作如下:</span><br><span style="line-height:1.5;">[root@openstack ops]#useradd webvirtmgr</span><br><span style="line-height:1.5;">[root@openstack ops]#echo "123456" | passwd --stdin webvirtmgr</span><br><span style="line-height:1.5;">[root@openstack ops]#groupadd libvirt</span><br><span style="line-height:1.5;">[root@openstack ops]#usermod -G libvirt -a webvirtmgr</span><br><span style="line-height:1.5;">---------------------------------------------------------------------------------------------------------------------</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);">3)在webvirtmgr服务器（服务端）上（这里kvm和WebVirtMgr部署在同一台机器上），将nginx用户的ssh-key上传到kvm服务器上（这里kvm和WebVirtMgr部署在同一台机器上）</span><br> [root@openstack ops]# su - nginx -s /bin/bash<br> -bash-4.1$ ssh-copy-id root@192.168.1.17<br> Warning: Permanently added '192.168.1.17' (RSA) to the list of known hosts.<br> root@192.168.1.17's password: #输入192.168.1.17即本机的root账号<br> Now try logging into the machine, with "ssh 'root@192.168.1.17'", and check in:</p> 
    <p style="line-height:1.5;">.ssh/authorized_keys</p> 
    <p style="line-height:1.5;">to make sure we haven't added extra keys that you weren't expecting.<br><span style="line-height:1.5;">---------------------------------------------------------------------------------------------------------------------</span><br><span style="line-height:1.5;">这里采用的是root用户，如果采用其他用户，比如上面假设的webvirtmgr用户，操作如下:</span><br><span style="line-height:1.5;">[root@openstack ops]#su - nginx -s /bin/bash</span><br><span style="line-height:1.5;">-bash-4.1$ssh-copy-id webvirtmgr@192.168.0.23</span><br><span style="line-height:1.5;">---------------------------------------------------------------------------------------------------------------------</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);">4）在kvm（客服端）服务器上（这里kvm和WebVirtMgr部署在同一台机器上）配置 libvirt ssh授权</span><br> [root@openstack ops]# vim /etc/polkit-1/localauthority/50-local.d/50-libvirt-remote-access.pkla<br> [Remote libvirt SSH access]<br> Identity=unix-user:root #注意这里采用的是root用户<br> Action=org.libvirt.unix.manage<br> ResultAny=yes<br> ResultInactive=yes<br> ResultActive=yes</p> 
    <p style="line-height:1.5;">[root@openstack ops]# chown -R root.root /etc/polkit-1/localauthority/50-local.d/50-libvirt-remote-access.pkla<br><span style="line-height:1.5;">-------------------------------------------------------------------------------------------------------------------------------</span><br><span style="line-height:1.5;">这里采用的是root用户，如果采用其他用户，比如上面假设的webvirtmgr用户，操作如下:</span><br><span style="line-height:1.5;">[root@openstack ops]#vim /etc/polkit-1/localauthority/50-local.d/50-libvirt-remote-access.pkla</span><br><span style="line-height:1.5;">[Remote libvirt SSH access]</span><br><span style="line-height:1.5;">Identity=unix-user:webvirtmgr #这里就设定webvirtmgr用户&nbsp;</span><br><span style="line-height:1.5;">Action=org.libvirt.unix.manage</span><br><span style="line-height:1.5;">ResultAny=yes</span><br><span style="line-height:1.5;">ResultInactive=yes</span><br><span style="line-height:1.5;">ResultActive=yes</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;">[root@openstack ops]#chown -R webvirtmgr.webvirtmgr /etc/polkit-1/localauthority/50-local.d/50-libvirt-remote-access.pkla</span><br><span style="line-height:1.5;">--------------------------------------------------------------------------------------------------------------------------------</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);">5）重启 libvirtd 服务</span><br> /etc/init.d/libvirtd restart</p> 
    <p style="line-height:1.5;">这样上面报错的问题就迎仍而解了！</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,0,255);"><strong>然后重新ssh方式连接就ok了，就不会有上面那个报错了~</strong></span></p> 
    <p style="line-height:1.5;">但是，又出现了其他报错（如下）！尼玛～～ &nbsp;接续排查！</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201608/907596-20160804185204090-606057697.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);"><strong>解决措施：</strong></span></p> 
    <p style="line-height:1.5;">&nbsp;在WebVirtMgr服务器本地使用ssh方式连接，在终端命令行里：</p> 
    <p style="line-height:1.5;">[root@openstack .ssh]#&nbsp;<span style="line-height:1.5;color:rgb(128,0,128);"><strong>virsh -c qemu+ssh://103.10.86.17/system list</strong></span><br> The authenticity of host '103.10.86.17 (103.10.86.17)' can't be established.<br> RSA key fingerprint is 3d:c1:2e:70:e9:e5:1d:84:40:a2:63:82:af:e5:cc:cd.<br> Are you sure you want to continue connecting (yes/no)? yes<br> error:&nbsp;<strong>End of file while reading data: Warning: Permanently added '103.10.86.17' (RSA) to the list of known hosts.: Input/output error</strong><br> error: failed to connect to the hypervisor</p> 
    <p style="line-height:1.5;">看日志 tail /var/log/secure | grep sshd 发现是我这里主动发出断开的.有可能检测到libvirtd有些问题导致的。<br> 当时使用virt-manage可以查询到远程的信息.估计是sshd出现的问题把.</p> 
    <p style="line-height:1.5;">折腾一会，暂时没找到解决方案</p> 
    <p style="line-height:1.5;">决定先选用通过tcp协议进行迁移的（但是这种方式没有用ssh连接方式安全——）<br> 等后面有时间了，再想办法解决上面ssh方式连接的错误吧</p> 
    <p style="line-height:1.5;"><br> 使用tcp进行对远程libvirtd进行连接访问的配置如下：</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);">1）修改文件/etc/sysconfig/libvirtd，用来启用tcp的端口</span><br> [root@openstack ops]# cat /etc/sysconfig/libvirtd<br> ........<br> LLIBVIRTD_CONFIG=/etc/libvirt/libvirtd.conf<br> LIBVIRTD_ARGS="--listen"</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);">2)修改文件/etc/libvirt/libvirtd.conf</span><br> [root@openstack ops]#vim /etc/libvirt/libvirtd.conf<br> listen_tls = 0<br> listen_tcp = 1<br> tcp_port = "16509"<br> listen_addr = "0.0.0.0"<br> auth_tcp = "none"</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);">3)运行 libvirtd</span><br> [root@openstack ops]#service libvirtd restart</p> 
    <p style="line-height:1.5;">如果没起效果(我的就没有生效，那么使用命令行.如果生效了，执行下面命令就会报错<br> [root@openstack ops]#libvirtd --daemon --listen --config /etc/libvirt/libvirtd.conf</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);">4)查看运行进程</span><br> [root@openstack ops]# ps aux | grep libvirtd<br> root 16563 1.5 0.1 925880 7056 ? Sl 16:01 0:28 libvirtd -d -l --config /etc/libvirt/libvirtd.conf</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);">5)查看端口</span><br> [root@openstack ops]# lsof -i:16509</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);">6）在source host连接dest host远程libvirtd查看信息（也可以用公网ip）</span><br> [root@openstack ops]# virsh -c qemu+tcp://192.168.1.17/system<br> Welcome to virsh, the virtualization interactive terminal.</p> 
    <p style="line-height:1.5;">Type: 'help' for help with commands<br> 'quit' to quit</p> 
    <p style="line-height:1.5;">virsh #</p> 
    <p style="line-height:1.5;">成功使用tcp去访问libvirtd。</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201608/907596-20160804193549356-1921246975.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201608/907596-20160804193652762-323879950.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201608/907596-20160804191331715-1910805899.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);font-size:18px;">注意：</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);">在使用tcp方式连接后，会出现连接终端的情况！</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;">[root@openstack .ssh]# virsh -c qemu+tcp://192.168.1.17/system</span><br><span style="line-height:1.5;">error:<strong><span style="line-height:1.5;color:rgb(255,0,0);">&nbsp;Cannot recv data: Connection reset by peer</span></strong></span><br><span style="line-height:1.5;">error: failed to connect to the hypervisor</span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,0,255);"><strong>连接断开，重新连接便可。</strong></span></p> 
    <p style="line-height:1.5;">[root@openstack ops]# ps aux | grep libvirtd<br> root 59619 0.6 0.0 1008128 22048 ? Sl 19:17 0:06 libvirtd --daemon --config /etc/libvirt/libvirtd.conf --listen<br> root 61081 0.0 0.0 103316 1004 pts/2 S+ 19:33 0:00 grep --color libvirtd<br> [root@openstack ops]# kill -9 59619<br> [root@openstack ops]# ps aux | grep libvirtd<br> root 61083 0.0 0.0 103312 904 pts/2 S+ 19:33 0:00 grep --color libvirtd<br> [root@openstack ops]# libvirtd --daemon --listen --config /etc/libvirt/libvirtd.conf<br> [root@openstack ops]# ps aux | grep libvirtd<br> root 61086 13.5 0.0 418240 6576 ? Sl 19:33 0:00 libvirtd --daemon --listen --config /etc/libvirt/libvirtd.conf<br> root 61176 0.0 0.0 103312 908 pts/2 S+ 19:33 0:00 grep --color libvirtd<br> [root@openstack ops]# virsh -c qemu+tcp://192.168.1.17/system<br> Welcome to virsh, the virtualization interactive terminal.</p> 
    <p style="line-height:1.5;">Type: 'help' for help with commands<br> 'quit' to quit</p> 
    <p style="line-height:1.5;">virsh #</p> 
    <p style="line-height:1.5;">后续发现，webvirtmgr连上后，过一会儿就会断开！</p> 
    <p style="line-height:1.5;">针对这个情况，可以可以写个定时脚本，如下：</p> 
    <p style="line-height:1.5;">[root@openstack ops]# cat /usr/local/src/libvirtd.sh</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;">#!/bin/bash</span><br><span style="line-height:1.5;">ps -ef | grep "libvirtd --daemon --listen"|grep -v grep|awk -F" " '{print $2}'|xargs kill -9</span><br><span style="line-height:1.5;">/usr/sbin/libvirtd --daemon --listen --config /etc/libvirt/libvirtd.conf</span></p> 
    <p style="line-height:1.5;">[root@openstack ops]# crontab -l<br> * * * * * /bin/bash -x /usr/local/src/libvirtd.sh &gt; /dev/null 2&gt;&amp;1<br> * * * * * sleep 10;/bin/bash -x /usr/local/src/libvirtd.sh &gt; /dev/null 2&gt;&amp;1<br> * * * * * sleep 20;/bin/bash -x /usr/local/src/libvirtd.sh &gt; /dev/null 2&gt;&amp;1<br> * * * * * sleep 30;/bin/bash -x /usr/local/src/libvirtd.sh &gt; /dev/null 2&gt;&amp;1<br> * * * * * sleep 40;/bin/bash -x /usr/local/src/libvirtd.sh &gt; /dev/null 2&gt;&amp;1<br> * * * * * sleep 50;/bin/bash -x /usr/local/src/libvirtd.sh &gt; /dev/null 2&gt;&amp;1</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,0,0);"><strong>*********************************************************************************</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;font-size:18px;color:rgb(0,0,255);"><strong>一般如上配置后，webvirtmgr里的控制台是可以正常连接虚拟机的。</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;font-size:18px;color:rgb(0,0,255);"><strong>但如果webvirtmgr里通过控制台页面(vnc)连接虚拟机失败，可以按照下面的操作方法尝试解决：</strong></span></p> 
    <p style="line-height:1.5;">kvm原来的安装方式是客户端需要安装vncviewer，才能看到安装页面，而<span style="line-height:1.5;">webvirtmgr使用了novnc</span>，页面通过websocket进行通信。</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;">1）首先需要安装novnc</span><br> [root@openstack ops]#<span style="line-height:1.5;color:rgb(153,51,0);"><strong>&nbsp;yum install -y novnc</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;">2）防火墙打开vnc的6080端口</span><br> [root@openstack ops]#&nbsp;<span style="line-height:1.5;color:rgb(153,51,0);"><strong>vim /etc/sysconfig/iptables</strong></span><br> .......<br><span style="line-height:1.5;color:rgb(153,51,0);">-A INPUT -p tcp -m state --state NEW -m tcp --dport 6080 -j ACCEPT</span><br> .......<br><br> [root@openstack ops]#&nbsp;<strong><span style="line-height:1.5;color:rgb(153,51,0);">/etc/init.d/iptables restart</span></strong></p> 
    <p style="line-height:1.5;">3）由上面可知，webvirtmgr进程通过supervisor管理。这里需要重启supervisor进程<br> [root@openstack ops]#&nbsp;<strong><span style="line-height:1.5;color:rgb(153,51,0);">/etc/init.d/supervisord restart</span></strong></p> 
    <p style="line-height:1.5;">这样，再次打开Webvirtmgr的控制台，发现就能连上虚拟机了！</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;">******************</span><br><span style="line-height:1.5;">可以在webvirtmgr服务器上通过命令行尝试下连接：</span><br> [root@openstack ops]#&nbsp;<strong><span style="line-height:1.5;color:rgb(255,0,255);">novnc_server --help</span></strong><br> Usage: novnc_server [--listen PORT] [--vnc VNC_HOST:PORT] [--cert CERT]</p> 
    <p style="line-height:1.5;">Starts the WebSockets proxy and a mini-webserver and&nbsp;<br> provides a cut-and-paste URL to go to.</p> 
    <p style="line-height:1.5;">--listen PORT Port for proxy/webserver to listen on<br> Default: 6080<br> --vnc VNC_HOST:PORT VNC server host:port proxy target<br> Default: localhost:5900<br> --cert CERT Path to combined cert/key file<br> Default: self.pem<br> --web WEB Path to web files (e.g. vnc.html)<br> Default: ./</p> 
    <p style="line-height:1.5;">[root@openstack ops]#&nbsp;<strong><span style="line-height:1.5;color:rgb(255,0,255);">novnc_server --listen 192.168.1.17:6086 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">#端口在6080后的都可以用</span></span></strong><br> Warning: could not find self.pem<br> Starting webserver and WebSockets proxy on port 192.168.1.17:6086<br> WARNING: no 'numpy' module, HyBi protocol will be slower<br> WebSocket server settings:<br> - Listen on 192.168.1.17:6086<br> - Flash security policy server<br> - Web server. Web root: /usr/share/novnc<br> - No SSL/TLS support (no cert file)<br> - proxying from 192.168.1.17:6086 to localhost:5900</p> 
    <p style="line-height:1.5;"><br> Navigate to this URL:</p> 
    <p style="line-height:1.5;">http://kvm-server:192.168.1.17:6086/vnc.html?host=kvm-server&amp;port=192.168.1.17:6086</p> 
    <p style="line-height:1.5;">Press Ctrl-C to exit</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,0,0);"><strong>*********************************************************************************</strong></span></p> 
    <div class="cnblogs_Highlighter sh-gutter"> 
     <div> 
      <div class="syntaxhighlighter bash" style="font-size:1em;"> 
       <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;line-height:1.1em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;background:none;">
        <tbody style="border:0px;line-height:1.1em;vertical-align:baseline;background:none;">
         <tr style="border:0px;line-height:1.1em;vertical-align:baseline;background:none;">
          <td class="gutter" style="border:1px solid #C0C0C0;border-collapse:collapse;line-height:1.1em;vertical-align:baseline;width:35px;color:rgb(175,175,175);background:none;"> 
           <div class="line number1 index0 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            1
           </div> 
           <div class="line number2 index1 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            2
           </div> 
           <div class="line number3 index2 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            3
           </div> 
           <div class="line number4 index3 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            4
           </div> 
           <div class="line number5 index4 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            5
           </div> 
           <div class="line number6 index5 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            6
           </div> 
           <div class="line number7 index6 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            7
           </div> 
           <div class="line number8 index7 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            8
           </div> 
           <div class="line number9 index8 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            9
           </div> 
           <div class="line number10 index9 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            10
           </div> 
           <div class="line number11 index10 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            11
           </div> 
           <div class="line number12 index11 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            12
           </div> 
           <div class="line number13 index12 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            13
           </div> 
           <div class="line number14 index13 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            14
           </div> 
           <div class="line number15 index14 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            15
           </div> 
           <div class="line number16 index15 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            16
           </div> 
           <div class="line number17 index16 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            17
           </div> 
           <div class="line number18 index17 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            18
           </div> 
           <div class="line number19 index18 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            19
           </div> 
           <div class="line number20 index19 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            20
           </div> 
           <div class="line number21 index20 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            21
           </div> 
           <div class="line number22 index21 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            22
           </div> 
           <div class="line number23 index22 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            23
           </div> 
           <div class="line number24 index23 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            24
           </div> 
           <div class="line number25 index24 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            25
           </div> 
           <div class="line number26 index25 alt1" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background-image:none;">
            26
           </div> 
           <div class="line number27 index26 alt2" style="border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;background:rgb(244,244,244) none;">
            27
           </div> </td> 
          <td class="code" style="border:1px solid #C0C0C0;border-collapse:collapse;line-height:1.1em;vertical-align:baseline;background:none;"> 
           <div style="border:0px;line-height:1.1em;vertical-align:baseline;background:none;"> 
            <div class="line number1 index0 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash plain" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;background:none;">上面是在centos6下的操作记录。下面简单介绍下在centos7版本下的操作：</code>
            </div> 
            <div class="line number2 index1 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             &nbsp;
            </div> 
            <div class="line number3 index2 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash plain" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;background:none;">1）yum源的配置及安装所需软件包</code>
            </div> 
            <div class="line number4 index3 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># yum -y install http://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</code>
            </div> 
            <div class="line number5 index4 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># yum -y install Git Python-pip libvirt-python libxml2-python python-websockify supervisor nginx</code>
            </div> 
            <div class="line number6 index5 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># yum -y install gcc python-devel</code>
            </div> 
            <div class="line number7 index6 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># pip install numpy&nbsp;&nbsp;&nbsp;</code>
            </div> 
            <div class="line number8 index7 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             &nbsp;
            </div> 
            <div class="line number9 index8 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash plain" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;background:none;">2）下载webvirtmgr.git软件</code>
            </div> 
            <div class="line number10 index9 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># cd /usr/local/src/</code>
            </div> 
            <div class="line number11 index10 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># git clone git://github.com/retspen/webvirtmgr.git&nbsp;</code>
            </div> 
            <div class="line number12 index11 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># git clone https://github.com/retspen/webvirtmgr.git&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>
            </div> 
            <div class="line number13 index12 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             &nbsp;
            </div> 
            <div class="line number14 index13 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             <code class="bash plain" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;background:none;">3）数据库安装</code>
            </div> 
            <div class="line number15 index14 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># cd /usr/local/src/</code>
            </div> 
            <div class="line number16 index15 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># wget http://www.sqlite.org/sqlite-3.5.6.tar.gz</code>
            </div> 
            <div class="line number17 index16 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># cd sqlite-3.5.6/</code>
            </div> 
            <div class="line number18 index17 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># ./configure --disable-tcl&nbsp;</code>
            </div> 
            <div class="line number19 index18 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># # make</code>
            </div> 
            <div class="line number20 index19 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;"> 
             <code class="bash functions" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(255,20,147);background:none;">make</code>&nbsp;
             <code class="bash functions" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(255,20,147);background:none;">install</code> 
            </div> 
            <div class="line number21 index20 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             &nbsp;
            </div> 
            <div class="line number22 index21 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             <code class="bash plain" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;background:none;">4）webvirtmgr安装</code>
            </div> 
            <div class="line number23 index22 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># cd /usr/local/src/webvirtmgr</code>
            </div> 
            <div class="line number24 index23 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             <code class="bash comments" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,130,0);background:none;"># pip install -r requirements.txt</code>
            </div> 
            <div class="line number25 index24 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash plain" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;background:none;">............</code>
            </div> 
            <div class="line number26 index25 alt1" style="border:0px;line-height:1.8em;vertical-align:baseline;background-image:none;">
             &nbsp;
            </div> 
            <div class="line number27 index26 alt2" style="border:0px;line-height:1.8em;vertical-align:baseline;background:rgb(244,244,244) none;">
             <code class="bash plain" style="border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;background:none;">后面跟在centos6版本系统下的安装操作步骤一样。</code>
            </div> 
           </div> </td> 
         </tr>
        </tbody>
       </table>
      </div> 
     </div> 
    </div> 
   </div> 
   <div style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;line-height:19.5px;">
    ***************当你发现自己的才华撑不起野心时，就请安静下来学习吧***************
   </div> 
   <div class="clear" style="clear:both;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;line-height:19.5px;"></div> 
   <div> 
    <div> 
     <font><span style="font-size:13px;line-height:19.5px;">本文转自散尽浮华博客园博客，原文链接：http://www.cnblogs.com/kevingrace/p/5737724.html</span></font>
     <span style="font-size:13px;line-height:19.5px;font-family:Verdana, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
