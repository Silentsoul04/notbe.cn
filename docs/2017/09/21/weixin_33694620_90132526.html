<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Windows Forms中通过自定义组件实现统一的数据验证（一） « NotBeCN</title>
  <meta name="description" content="             摘要    一直对WinForm中没有像WebForm中那样的验证控件耿耿于怀，这几天准备开发一套类似的控件。在网上找到大牛Michael Weinhardt的一个系列文章，写得非常棒，所以基本上按他的思路下来的。&nbsp; 在获取用户输入及后续的处理过程中，数据校验是关键的一步。本文...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/09/21/weixin_33694620_90132526.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Windows Forms中通过自定义组件实现统一的数据验证（一）</h1>
    <p class="post-meta">Sep 21, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>摘要</strong><strong></strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">一直对WinForm中没有像WebForm中那样的验证控件耿耿于怀，这几天准备开发一套类似的控件。在网上找到大牛Michael Weinhardt的一个系列文章，写得非常棒，所以基本上按他的思路下来的。&nbsp;<br><br> 在获取用户输入及后续的处理过程中，数据校验是关键的一步。本文将对Windows Forms中的校验机制进行探讨，分析如何通过开发自定义验证组件来提供更为高效的验证体验（类似于ASP.NET中的验证控件）。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>Windows Forms&nbsp;</strong><strong>验证机制介绍</strong><strong></strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">简单地说，<strong>验证</strong>是对数据进行处理前确保其完整和正确的过程。验证可以实现在数据层和业务规则层，而应当在表现层进行前端的”保护”。开发人员通常在UI中为用户提供友好的、可交互的验证体验，而要避免在N层应用程序中进行不必要的网络间往返验证。验证包含数据类型、范围或业务规则等类型，看下面这个简单的例子：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&lt;!--[if !vml]--&gt;<img height="212" alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/CustomValidator/AddEmployeeFormDiagram.JPG" width="360" style="border:0px;"><br> &lt;!--[endif]--&gt;</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">这个窗体中需要进行下列验证：<br></p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Name，Date of Birth和Phone Number为必填项</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Date of Birth必须为正确的日期值</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Phone Number必须为正确的格式</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">新添加的雇员必须年满18岁（杜绝童工）</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">要完成这些验证需要一个合适的机制，Windows Forms已经提供了一种，内置在每个控件中。要使控件支持验证，须将它的<strong>CausesValidation</strong>&nbsp;属性设置为true，这也是所有控件的默认值。如果控件的<strong>CausesValidation</strong>&nbsp;属性设置为true，那么在它将焦点转移到另一个控件（并且它的CausesValidation也为true）时会触发<strong>Validating</strong>&nbsp;事件。因此，我们可以处理控件的Validating事件，在这里实现验证逻辑，像下面这样：&nbsp;<br><br></p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border-width:1px;border-style:solid;font-size:13px;"> 
    <span style="color:rgb(0,0,255);">private</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">void</span>
    <span style="color:rgb(0,0,0);">&nbsp;txtName_Validating(</span>
    <span style="color:rgb(0,0,255);">object</span>
    <span style="color:rgb(0,0,0);">&nbsp;sender,&nbsp;CancelEventArgs&nbsp;e)<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">&nbsp;(txtName.Text.Trim().Length&nbsp;</span>
    <span style="color:rgb(0,0,0);">==</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">0</span>
    <span style="color:rgb(0,0,0);">)<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Cancel&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">true</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">return</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> }<br></span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>Validating</strong>&nbsp;事件提供了<strong>CancelEventArgs</strong>&nbsp;类型的参数，它的<strong>Cancel</strong>属性使我们可以指定控件的值是否有效。如果Cancel为true（即是无效的），焦点仍然停留在无效的控件中；如果Cancel值为false（即通过了验证），则会触发Validated事件，焦点也会转移到新的控件。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">现在，责任落到了我们开发人员这边，要以可视化的方式通知用户数据是否有效，也许你想到的是状态栏，这种方式存在两个问题：<br></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">状态栏只能每次显式一条错误信息，即使窗体包含多个无效的控件输入；</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">状态栏离输入控件”很远”，很难确切指明哪个控件出现了错误。</li> 
   </ul>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;font-style:italic;">据传闻，微软曾做过这么一个可用性研究：人们坐在椅子上运行一个程序，状态栏给出一个通知信息叫他们往椅子底下看，这样就可以得到50美元奖金。但在测试期间，竟没有任何人能拿走这50美元！</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">此时，<strong>ErrorProvider</strong>组件是更好的选择：<br><br><img height="216" alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/CustomValidator/AddEmployeeError0Diagram.JPG" width="428" style="border:0px;"><br></p> 
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">ErrorProvider</strong>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">组件的用法非常简单，此处不再赘述，Validating事件的代码如下：</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border-width:1px;border-style:solid;font-size:13px;"> 
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">&nbsp;(txtName.Text.Trim().Length&nbsp;</span>
    <span style="color:rgb(0,0,0);">==</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">0</span>
    <span style="color:rgb(0,0,0);">)<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;errorProvider1.SetError(txtName,&nbsp;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">Name&nbsp;is&nbsp;required.</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">);<br> &nbsp;&nbsp;&nbsp;&nbsp;e.Cancel&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">true</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">return</span>
    <span style="color:rgb(0,0,0);">;<br> }<br><br> errorProvider1.SetError(txtName,&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">.Empty);<br></span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>CausesValidation</strong>、<strong>Validating</strong>和<strong>ErrorProvider</strong>提供了控件级验证的基础机制，我们可以用它们对控件逐一进行验证。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>窗体级验证</strong><strong></strong></p> 
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">Validating</strong>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">和</span>
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">ErrorProvider</strong>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">这对组合是一个不错的解决方案，可以在用户输入数据的时候进行验证。不幸的是，这种方法可能会使得我们无法进行窗体级的验证，而这在用户点击OK按钮提交数据时显然是必要的，因为用户在点击OK按钮前，有些控件可能未曾获得过焦点，它们的控件级验证代码也就不起作用了。先看看窗体级验证的代码：&nbsp;</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border-width:1px;border-style:solid;font-size:13px;"> 
    <span style="color:rgb(0,0,255);">foreach</span>
    <span style="color:rgb(0,0,0);">&nbsp;(Control&nbsp;ctrl&nbsp;</span>
    <span style="color:rgb(0,0,255);">in</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">this</span>
    <span style="color:rgb(0,0,0);">.Controls)<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;ctrl.Focus();<br><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">&nbsp;(</span>
    <span style="color:rgb(0,0,0);">!</span>
    <span style="color:rgb(0,0,0);">Validate())<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">this</span>
    <span style="color:rgb(0,0,0);">.DialogResult&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;DialogResult.None;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">return</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> }<br></span> 
   </div> 
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">但Cancel按钮就不需要实现窗体级的验证了，它的工作往往是简单地将窗体关闭。但是现在，如果当前拥有焦点的控件数据是无效的，Cancel按钮将不能点击，因为Cancel按钮的CausesValidation属性默认为true，焦点会一直停留在无效的控件上。我们只要将Cancel按钮的CausesValidation属性设置为false就好了。&nbsp;</span> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><span style="line-height:1.8;font-weight:bold;">注意</span>：这里的窗体应当是模式窗体，否则即使CausesValidation属性设置为false，也不能点击。</p> 
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">至此，使用数十行代码，我们的AddEmployee窗体就可以支持基本的验证了。&nbsp;</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>编程式验证</strong><strong>&nbsp;vs.&nbsp;</strong><strong>声明式验证</strong><strong></strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">从生产力的角度来看，上面的解决方案有一个根本的问题：如果一个程序包含多个窗体，而每个窗体又包含多个控件，那么将需要大量的用于验证的代码。这些代码增大了UI的复杂性，使得程序难以维护，显式是应当避免的。一种方法是将那些通用的验证逻辑抽象为可重用的类型。有了这样的类型，还仅仅是第一步，它仍需要编写代码。{TODO}我们需要这样的解决方案：它具有Windows Forms UI的特点，因此Windows Forms组件或控件是我们不错的选择。以这种方式封装后，开发人员的工作就变成从工具箱上拖一个组件或控件放到窗体上，通过诸如属性浏览器（Property Browser）这样的设计期特性来配置它，然后让Windows Forms设计器帮我们将这些配置转换为代码，这些代码会出现在InitializeComponent方法中。这样原来的<em>编程式</em>（programmatic）体验变成了<em>声明式</em>（declarative）体验，而后者往往意味着高效。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>添加设计期支持</strong><strong></strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">第一步是添加设计期的支持，如果我们的实现不需要UI支持，可以从三种设计期组件继承：<strong>System.ComponentModel.Component</strong>，&nbsp;<strong>System.Windows.Forms.Control</strong>和&nbsp;<strong>System.Windows.Forms.UserControl. Component</strong>，否则可以继承<strong>Control</strong>或<strong>UserControl</strong>。<strong>Control</strong>和<strong>UserControl</strong>的不同之处在于其呈现的方式，前者需要编写代码来呈现它，而后者则通过其它控件或组件来呈现它。我们在前面使用的验证代码没有绘制任何内容，而是借助于ErrorProvider来提示用户。因此，<strong>Component</strong>是我们最合适的选择。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>Imitation Is the Sincerest Form of Flattery</strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">下一步是要确定我们需要哪些种类的验证组件，可以参考一下ASP.NET中验证控件的实现机制。这样能保持一定的一致性，而且也不需要”重新发明轮子”了。这样那些ASP.NET的开发人员也更容易上手。ASP.NET现在提供了如下的验证控件：</p> 
   <table class="MsoTableGrid" border="1" style="border:1px solid #C0C0C0;border-collapse:collapse;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;margin-left:5.4pt;">
    <tbody>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">验证控件</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:206.35pt;"> <p style="line-height:1.8;">描述</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">RequiredFieldValidator</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:206.35pt;"> <p style="line-height:1.8;">计算输入控件的值以确保用户输入值。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">RegularExpressionValidator</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:206.35pt;"> <p style="line-height:1.8;">计算输入控件的值，以确定该值是否与某个正则表达式所定义的模式相匹配。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">CompareValidator</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:206.35pt;"> <p style="line-height:1.8;">将由用户输入到输入控件的值与输入到其他输入控件的值或常数值进行比较。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">RangeValidator</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:206.35pt;"> <p style="line-height:1.8;">检查输入控件的值是否在指定的值范围内。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">CustomValidator</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:206.35pt;"> <p style="line-height:1.8;">对输入控件执行用户定义的验证。</p> </td> 
     </tr>
    </tbody>
   </table>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">同时我们还要考虑可扩展性，开发人员在必要的时候可以较为容易地开发自定义的验证组件。最后，这个实现应当利用Windows Forms中已有的验证机制（前面提及的部分）。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>引入</strong><strong>RequiredFieldValidator</strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">有了上面的设计思路，现在要来点真的了。让我们从最简单的验证情形开始：RequiredFieldValidator。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">建立一个Component类，名称为RequiredFieldValidator，其接口应当与ASP.NET中的对应类相同：</p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border-width:1px;border-style:solid;font-size:13px;"> 
    <span style="color:rgb(0,0,255);">public</span>
    <span style="color:rgb(0,0,0);">&nbsp;partial&nbsp;</span>
    <span style="color:rgb(0,0,255);">class</span>
    <span style="color:rgb(0,0,0);">&nbsp;RequiredFieldValidator&nbsp;:&nbsp;Component<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;ControlToValidate&nbsp;{&nbsp;</span>
    <span style="color:rgb(0,0,255);">get</span>
    <span style="color:rgb(0,0,0);">;&nbsp;</span>
    <span style="color:rgb(0,0,255);">set</span>
    <span style="color:rgb(0,0,0);">;}<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;ErrorMessage&nbsp;{&nbsp;</span>
    <span style="color:rgb(0,0,255);">get</span>
    <span style="color:rgb(0,0,0);">;&nbsp;</span>
    <span style="color:rgb(0,0,255);">set</span>
    <span style="color:rgb(0,0,0);">;}<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;InitialValue&nbsp;{&nbsp;</span>
    <span style="color:rgb(0,0,255);">get</span>
    <span style="color:rgb(0,0,0);">;&nbsp;</span>
    <span style="color:rgb(0,0,255);">set</span>
    <span style="color:rgb(0,0,0);">;}<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">bool</span>
    <span style="color:rgb(0,0,0);">&nbsp;IsValid&nbsp;{&nbsp;</span>
    <span style="color:rgb(0,0,255);">get</span>
    <span style="color:rgb(0,0,0);">;&nbsp;</span>
    <span style="color:rgb(0,0,255);">set</span>
    <span style="color:rgb(0,0,0);">;}<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">void</span>
    <span style="color:rgb(0,0,0);">&nbsp;Validate();<br> }<br></span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">下面是每个成员的含义：</p> 
   <table class="MsoTableGrid" border="1" style="border:1px solid #C0C0C0;border-collapse:collapse;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;margin-left:5.4pt;">
    <tbody>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">成员</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:197.35pt;"> <p style="line-height:1.8;">描述</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">ControlToValidate</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:197.35pt;"> <p style="line-height:1.8;">指定要验证的控件</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">ErrorMessage</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:197.35pt;"> <p style="line-height:1.8;">控件未通过验证时显式的信息。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">InitialValue</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:197.35pt;"> <p style="line-height:1.8;">某些情况下，控件的默认值用作提示，如”请选择种类”，这时必填项意味着必须与默认值不同。此时用InitialValue。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">IsValid</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:197.35pt;"> <p style="line-height:1.8;">在调用Validate方法后报告控件的数据是否有效，默认为true。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:207.65pt;"> <p style="line-height:1.8;">Validate</p> </td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;width:197.35pt;"> <p style="line-height:1.8;">验证指定控件的值，并设置IsValid。</p> </td> 
     </tr>
    </tbody>
   </table>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">在ASP.NET中，ControlToValidate是字符串类型的，这种间接的做法在基于请求、无状态的Web应用程序中是必要的。但在Windows Forms中我们则不必这么做，我们可以直接引用控件。同时，我们要在内部使用ErrorProvider组件，所以为其添加一个Icon属性：&nbsp;</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border-width:1px;border-style:solid;font-size:13px;"> 
    <span style="color:rgb(0,0,255);">public</span>
    <span style="color:rgb(0,0,0);">&nbsp;partial&nbsp;</span>
    <span style="color:rgb(0,0,255);">class</span>
    <span style="color:rgb(0,0,0);">&nbsp;RequiredFieldValidator&nbsp;:&nbsp;Component<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;…<br> &nbsp;&nbsp;&nbsp;&nbsp;Control&nbsp;ControlToValidate&nbsp;{&nbsp;</span>
    <span style="color:rgb(0,0,255);">get</span>
    <span style="color:rgb(0,0,0);">;&nbsp;</span>
    <span style="color:rgb(0,0,255);">set</span>
    <span style="color:rgb(0,0,0);">;}<br> &nbsp;&nbsp;&nbsp;&nbsp;Icon&nbsp;Icon&nbsp;{&nbsp;</span>
    <span style="color:rgb(0,0,255);">get</span>
    <span style="color:rgb(0,0,0);">;&nbsp;</span>
    <span style="color:rgb(0,0,255);">set</span>
    <span style="color:rgb(0,0,0);">;}<br> &nbsp;&nbsp;&nbsp;&nbsp;…<br> }<br></span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">好，来看看具体的实现代码：</p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border-width:1px;border-style:solid;font-size:13px;"> 
    <img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" style="border:0px;" alt="None.gif">
    <span style="color:rgb(0,0,255);">public</span>
    <span style="color:rgb(0,0,0);">&nbsp;partial&nbsp;</span>
    <span style="color:rgb(0,0,255);">class</span>
    <span style="color:rgb(0,0,0);">&nbsp;RequiredFieldValidator&nbsp;:&nbsp;Component<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" style="border:0px;" alt="ExpandedBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span><span style="color:rgb(0,0,0);">{<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" align="top" style="border:0px;" alt="ContractedSubBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="border-width:1px;border-style:solid;">Private&nbsp;Fields</span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" align="top" style="border:0px;" alt="ContractedSubBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="border-width:1px;border-style:solid;">Constructors</span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ContractedSubBlock.gif" align="top" style="border:0px;" alt="ContractedSubBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="border-width:1px;border-style:solid;">Public&nbsp;Properties</span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);">public</span><span style="color:rgb(0,0,0);">&nbsp;</span><span style="color:rgb(0,0,255);">void</span><span style="color:rgb(0,0,0);">&nbsp;Validate()<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span><span style="color:rgb(0,0,0);">{<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);">if</span><span style="color:rgb(0,0,0);">&nbsp;(controlToValidate&nbsp;</span><span style="color:rgb(0,0,0);">==</span><span style="color:rgb(0,0,0);">&nbsp;</span><span style="color:rgb(0,0,255);">null</span><span style="color:rgb(0,0,0);">)<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span><span style="color:rgb(0,0,0);">{<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isValid&nbsp;</span><span style="color:rgb(0,0,0);">=</span><span style="color:rgb(0,0,0);">&nbsp;</span><span style="color:rgb(0,0,255);">true</span><span style="color:rgb(0,0,0);">;<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);">return</span><span style="color:rgb(0,0,0);">;<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" style="border:0px;" alt="ExpandedSubBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);">string</span><span style="color:rgb(0,0,0);">&nbsp;controlValue&nbsp;</span><span style="color:rgb(0,0,0);">=</span><span style="color:rgb(0,0,0);">&nbsp;controlToValidate.Text.Trim();<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);">string</span><span style="color:rgb(0,0,0);">&nbsp;_initValue;<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);">if</span><span style="color:rgb(0,0,0);">&nbsp;(initialValue&nbsp;</span><span style="color:rgb(0,0,0);">==</span><span style="color:rgb(0,0,0);">&nbsp;</span><span style="color:rgb(0,0,255);">null</span><span style="color:rgb(0,0,0);">)<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span><span style="color:rgb(0,0,0);">{<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_initValue&nbsp;</span><span style="color:rgb(0,0,0);">=</span><span style="color:rgb(0,0,0);">&nbsp;</span><span style="color:rgb(0,0,255);">string</span><span style="color:rgb(0,0,0);">.Empty;<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" style="border:0px;" alt="ExpandedSubBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);">else</span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span><span style="color:rgb(0,0,0);">{<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_initValue&nbsp;</span><span style="color:rgb(0,0,0);">=</span><span style="color:rgb(0,0,0);">&nbsp;initialValue.Trim();<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" style="border:0px;" alt="ExpandedSubBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isValid&nbsp;</span><span style="color:rgb(0,0,0);">=</span><span style="color:rgb(0,0,0);">&nbsp;(controlValue&nbsp;</span><span style="color:rgb(0,0,0);">!=</span><span style="color:rgb(0,0,0);">&nbsp;_initValue);<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);">if</span><span style="color:rgb(0,0,0);">&nbsp;(isValid)<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span><span style="color:rgb(0,0,0);">{<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errorProvider.SetError(controlToValidate,&nbsp;</span><span style="color:rgb(0,0,255);">string</span><span style="color:rgb(0,0,0);">.Empty);<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" style="border:0px;" alt="ExpandedSubBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);">else</span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span><span style="color:rgb(0,0,0);">{<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errorProvider.SetError(controlToValidate,&nbsp;errorMessage);<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" style="border:0px;" alt="ExpandedSubBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" style="border:0px;" alt="ExpandedSubBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);">private</span><span style="color:rgb(0,0,0);">&nbsp;</span><span style="color:rgb(0,0,255);">void</span><span style="color:rgb(0,0,0);">&nbsp;controlToValidate_Validating(</span><span style="color:rgb(0,0,255);">object</span><span style="color:rgb(0,0,0);">&nbsp;sender,&nbsp;CancelEventArgs&nbsp;e)<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span><span style="color:rgb(0,0,0);">{<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/InBlock.gif" align="top" style="border:0px;" alt="InBlock.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Validate();<br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" style="border:0px;" alt="ExpandedSubBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></span><span style="color:rgb(0,0,0);"><br><img src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top" style="border:0px;" alt="ExpandedBlockEnd.gif">&nbsp;&nbsp;&nbsp;&nbsp;}</span></span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">这种实现的关键在于如何挂接ControlValidate控件的Validating事件，这种做法与前面的控件级验证相一致，还有一个额外的好处，这里的<strong>ControlToValidate_Validating</strong>方法中，没有设置<strong>CancelEventArgs</strong>参数的<strong>Cancel</strong>属性，这样就不会把用户困在一个控件中。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">组件的验证功能已经实现了，同时还为其添加了设计期支持。最终实现还提供了其它一些设计期特性：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">&lt;!--[if !supportLists]--&gt;指定了在属性浏览器中设置ControlToValidate时可以选择的控件种类；</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">在属性浏览器中隐藏了IsValid属性，因为它是运行时的属性。</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">编译，然后将组件添加到工具箱。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">让我们回到前面的AddEmployee窗体，现在不再需要处理Validating事件了，只要拖3个组件到窗体，然后为它们设置属性。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&lt;!--[if !vml]--&gt;<img height="188" alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/CustomValidator/AddEmployeeError1Diagram.JPG" width="352" style="border:0px;"><br> &lt;!--[endif]--&gt;</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">其中Phone Number域的验证组件的InitialValue为”Your number here.”。怎么样，是不是很high？</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>BaseValidator</strong><strong>：分而治之</strong><strong></strong></p> 
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">实现了RequiredFieldValidator后，其它类型的验证组件应当比较容易实现了。先别急，可没你想的那么简单。RequiredFieldValidator类把</span>
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">特定</strong>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">的”必填”逻辑和其它对每个验证组件都适用的</span>
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">通用</strong>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">逻辑耦合在一起了。这种情况下，应当把RequiredFieldValidator分解为两个类型：BaseValidator和减肥后的RequiredFieldValidator。&nbsp;</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border-width:1px;border-style:solid;font-size:13px;"> 
    <span style="color:rgb(0,0,255);">abstract</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">class</span>
    <span style="color:rgb(0,0,0);">&nbsp;BaseValidator&nbsp;:&nbsp;Component&nbsp;<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;<img src="https://www.cnblogs.com/Images/dot.gif" style="border:0px;" alt="dot.gif"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">void</span>
    <span style="color:rgb(0,0,0);">&nbsp;Validate()&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="https://www.cnblogs.com/Images/dot.gif" style="border:0px;" alt="dot.gif"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_isValid&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;EvaluateIsValid();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="https://www.cnblogs.com/Images/dot.gif" style="border:0px;" alt="dot.gif"><br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">protected</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">abstract</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">bool</span>
    <span style="color:rgb(0,0,0);">&nbsp;EvaluateIsValid();<br> }<br></span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">这样定义的效果是，BaseValidator必须通过继承后才能使用，而EvaluateIsValid则必须实现。Validate方法通过EvaluateIsValid方法来设置IsValid。这种技术也应用在了ASP.NET的验证控件上。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">BaseValidator实现后，需要对RequiredFieldValidator进行重构：</p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border-width:1px;border-style:solid;font-size:13px;"> 
    <span style="color:rgb(0,0,0);">[ToolboxBitmap(</span>
    <span style="color:rgb(0,0,255);">typeof</span>
    <span style="color:rgb(0,0,0);">(RequiredFieldValidator),&nbsp;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">RequiredFieldValidator.ico</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">)]<br></span>
    <span style="color:rgb(0,0,255);">class</span>
    <span style="color:rgb(0,0,0);">&nbsp;RequiredFieldValidator&nbsp;:&nbsp;BaseValidator&nbsp;<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;InitialValue&nbsp;&nbsp;{<img src="https://www.cnblogs.com/Images/dot.gif" style="border:0px;" alt="dot.gif">}<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">protected</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">override</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">bool</span>
    <span style="color:rgb(0,0,0);">&nbsp;EvaluateIsValid()&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;controlValue&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;ControlToValidate.Text.Trim();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;initialValue;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">(&nbsp;_initialValue&nbsp;</span>
    <span style="color:rgb(0,0,0);">==</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">null</span>
    <span style="color:rgb(0,0,0);">&nbsp;)&nbsp;initialValue&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">""</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">else</span>
    <span style="color:rgb(0,0,0);">&nbsp;initialValue&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;_initialValue.Trim();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">return</span>
    <span style="color:rgb(0,0,0);">&nbsp;(controlValue&nbsp;</span>
    <span style="color:rgb(0,0,0);">!=</span>
    <span style="color:rgb(0,0,0);">&nbsp;initialValue);<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> }</span> 
   </div> 
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 更进一步，实现其它验证组件</strong>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;</span> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">通过使用基类和派生类将通用逻辑和特定逻辑分离后，我们可以把注意力集中在特定的验证逻辑，这在RequiredFieldValidator中效果不错。下面会看到，对于其它类型的验证组件同样很好，它们是：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">&lt;!--[if !supportLists]--&gt;RegularExpressionValidator<br></li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">CustomValidator<br></li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">CompareValidator<br></li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">RangeValidator</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">现在把它们一一实现。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>RegularExpressionValidator</strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">正则表达式是一种强大的文本模式匹配技术。如果文本域需要一定的模式，正则表达式无疑是很好的选择。</p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border-width:1px;border-style:solid;font-size:13px;"> 
    <span style="color:rgb(0,0,255);">using</span>
    <span style="color:rgb(0,0,0);">&nbsp;System.Text.RegularExpressions;<br><img src="https://www.cnblogs.com/Images/dot.gif" style="border:0px;" alt="dot.gif"><br> [ToolboxBitmap(</span>
    <span style="color:rgb(0,0,255);">typeof</span>
    <span style="color:rgb(0,0,0);">(RegularExpressionValidator),&nbsp;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">RegularExpressionValidator.ico</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">)]<br></span>
    <span style="color:rgb(0,0,255);">class</span>
    <span style="color:rgb(0,0,0);">&nbsp;RegularExpressionValidator&nbsp;:&nbsp;BaseValidator&nbsp;<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;<img src="https://www.cnblogs.com/Images/dot.gif" style="border:0px;" alt="dot.gif"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;ValidationExpression&nbsp;{<img src="https://www.cnblogs.com/Images/dot.gif" style="border:0px;" alt="dot.gif">}<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">protected</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">override</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">bool</span>
    <span style="color:rgb(0,0,0);">&nbsp;EvaluateIsValid()&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,128,0);">//</span>
    <span style="color:rgb(0,128,0);">&nbsp;Don't&nbsp;validate&nbsp;if&nbsp;empty</span>
    <span style="color:rgb(0,128,0);"><br></span>
    <span style="color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">(&nbsp;ControlToValidate.Text.Trim()&nbsp;</span>
    <span style="color:rgb(0,0,0);">==</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">""</span>
    <span style="color:rgb(0,0,0);">&nbsp;)&nbsp;</span>
    <span style="color:rgb(0,0,255);">return</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">true</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,128,0);">//</span>
    <span style="color:rgb(0,128,0);">&nbsp;Successful&nbsp;if&nbsp;match&nbsp;matches&nbsp;the&nbsp;entire&nbsp;text&nbsp;of&nbsp;ControlToValidate</span>
    <span style="color:rgb(0,128,0);"><br></span>
    <span style="color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;field&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;ControlToValidate.Text.Trim();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">return</span>
    <span style="color:rgb(0,0,0);">&nbsp;Regex.IsMatch(field,&nbsp;_validationExpression.Trim());&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> }</span> 
   </div> 
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">在设计时，开发人员可以通过属性浏览器提供用于验证的正则表达式。</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>CustomValidator</strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">人生在世，不如意者十有八九。我们定义的验证组件不可能解决所有问题，尤其是面对复杂的业务规则的时候。这时只能编写自定义代码，<strong>CustomValidator</strong>&nbsp;允许我们编写这些自定义代码，同时仍能与其它的验证组件保持一致，这在窗体级的统一验证过程中很重要。<strong>CustomValidator</strong>&nbsp;提供了Validating事件和ValidatingCancelEventArgs：</p> 
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">处理CustomValidator的Validating事件时，只需在属性浏览器中双击：</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <img height="217" alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/CustomValidator/CustomValidatorPropertyBrowser.JPG" width="371" style="border:0px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">然后，只需添加合适的验证逻辑，以确保新增的雇员不小于18岁：<br><br></p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border-width:1px;border-style:solid;font-size:13px;"> 
    <span style="color:rgb(0,0,255);">private</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">void</span>
    <span style="color:rgb(0,0,0);">&nbsp;customValidator1_Validating(</span>
    <span style="color:rgb(0,0,255);">object</span>
    <span style="color:rgb(0,0,0);">&nbsp;sender, CustomValidator.ValidatingCancelEventArgs&nbsp;e)<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;DateTime&nbsp;birth;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">bool</span>
    <span style="color:rgb(0,0,0);">&nbsp;isDate&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;DateTime.TryParse(txtBirth.Text,&nbsp;</span>
    <span style="color:rgb(0,0,255);">out</span>
    <span style="color:rgb(0,0,0);">&nbsp;birth);<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">&nbsp;(isDate)<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DateTime&nbsp;legal&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;DateTime.Now.AddYears(</span>
    <span style="color:rgb(0,0,0);">-</span>
    <span style="color:rgb(0,0,0);">18</span>
    <span style="color:rgb(0,0,0);">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Valid&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;(birth&nbsp;</span>
    <span style="color:rgb(0,0,0);">&lt;=</span>
    <span style="color:rgb(0,0,0);">&nbsp;legal);<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">else</span>
    <span style="color:rgb(0,0,0);"><br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Valid&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">false</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> }</span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;</p> 
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">如果小于18岁，就会提示用户：</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <img height="181" alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/CustomValidator/LessThan18.JPG" width="340" style="border:0px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;</span> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>BaseCompareValidator</strong></p> 
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">到目前为止，我们的组件只能处理单个文本域的值。但在某些情况下，验证过程可能涉及多个文本域或值，比如确保文本域的值在两个值之间（RangeValidator）；或比较两个文本域的值是否相等（CompareValidator）。不管哪种情况，我们都需要考虑类型检查、转换和比较等过程。这个功能应当封装在一个新的类型中：</span>
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">BaseCompareValidator</strong>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">，而RangeValidator和CompareValidator则继承自它。&nbsp;</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>ValidationDataType</strong>是一个自定义枚举类型，在何种数据类型下进行比较验证。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>RangeValidator</strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">如果需要确保控件的输入值在指定的范围内，<strong>RangeValidator</strong>&nbsp;可以满足需要。它需要开发人员指定最大值和最小值，还有输入值的数据类型。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&lt;!--[if !vml]--&gt;<img height="293" alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/CustomValidator/RangeValidatorError.JPG" width="468" style="border:0px;"><br> &lt;!--[endif]--&gt;</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>CompareValidator</strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">最后来看看CompareValidator，它用来进行控件的等值测试，可以与另一个控件的值或者指定的值进行比较。<strong>Operator</strong>属性指定了比较操作的类型，ControlToCompare和 ValueToCompare则指定了要比较的控件和指定值。如果<strong>Operator</strong>属性为DataTypeCheck，则还可以判断控件的值是否为指定类型。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&lt;!--[if !vml]--&gt;<img height="295" alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/CustomValidator/CompareValidatorError.JPG" width="487" style="border:0px;"><br> &lt;!--[endif]--&gt;</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>完整的自定义验证组件结构</strong><strong></strong></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong><img height="333" alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/CustomValidator/CustomValidatorInfrastructure.jpg" width="470" style="border:0px;"><br><br><br> 我们身在何处</strong><strong></strong></p> 
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">首先我们对Windows Forms中的校验机制进行了探讨，然后将这些验证逻辑封装到了几个支持设计时操作的组件，通过开发自定义验证组件来提供更为高效的验证体验（类似于ASP.NET中的验证控件）。但目前还仅限于控件级的验证。下一篇文章中将讨论如何进行窗体级的验证，届时</span>
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">ValidationSummary</strong>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">组件也会闪亮登场。</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">示例代码下载：</span>
   <a title="Sample codes" href="http://files.cnblogs.com/anderslly/CustomValidatorsSample.rar" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">CustomValidatorSample.rar</a>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">参考：</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">1.&nbsp;</span>
   <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnforms/html/winforms03162004.asp" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">Extending Windows Forms with a Custom Validation Component Library</a>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">. By Michael Weinhardt</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <p><span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">2. Windows Forms Programming in C#. By Chris Sells</span></p> 
   <p><span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br></span></p> 
   <p><font color="#333333"><span><span style="font-size:14px;">本文转自一个程序员的自省博客园博客，原文链接：http://www.cnblogs.com/anderslly/archive/2007/04/18/customvalidatorpart1.html，如需转载请自行联系原作者。</span></span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
