<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>iOS：ASIHttpRequest虽不更新，但仍值得详细了解 « NotBeCN</title>
  <meta name="description" content="                  一、使用ASIHTTPRequest可以很方便的进行一下操作：同步/异步方式下载数据,定义下载队列，让队列中的任务按指定的并发数来下载（队列下载必须是异步的),提交表单，文件上传,处理cookie,设置代理,上下载进度条,重定向处理,请求与响应的GZIP,验证与授权。     ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/09/12/weixin_33720078_90133701.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">iOS：ASIHttpRequest虽不更新，但仍值得详细了解</h1>
    <p class="post-meta">Sep 12, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:25.2px;"> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;color:rgb(0,0,255);">一、使用ASIHTTPRequest可以很方便的进行一下操作：同步/异步方式下载数据,定义下载队列，让队列中的任务按指定的并发数来下载（队列下载必须是异步的),提交表单，文件上传,处理cookie,设置代理,上下载进度条,重定向处理,请求与响应的GZIP,验证与授权。</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">使用ASIHTTPRequest可以很方便的进行一下操作：</span></p> 
    <ul>
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">同步/异步方式下载数据</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">定义下载队列，让队列中的任务按指定的并发数来下载（队列下载必须是异步的)</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">提交表单，文件上传</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">处理cookie</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">设置代理</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">上下载进度条</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">重定向处理</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">请求与响应的GZIP</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">验证与授权</span></li> 
    </ul>
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">等等，只要跟HTTP有关，只有你想不到的，没有她做不到的~</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">配置方法：</span></p> 
    <ul>
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIHTTPRequestConfig.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIHTTPRequestDelegate.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIProgressDelegate.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASICacheDelegate.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIHTTPRequest.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIHTTPRequest.m</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIDataCompressor.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIDataCompressor.m</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIDataDecompressor.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIDataDecompressor.m</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIFormDataRequest.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIInputStream.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIInputStream.m</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIFormDataRequest.m</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASINetworkQueue.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASINetworkQueue.m</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIDownloadCache.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIDownloadCache.m</span></li> 
    </ul>
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">iPhone 工程还需要:</span></p> 
    <ul>
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIAuthenticationDialog.h</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIAuthenticationDialog.m</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">Reachability.h (在External/Reachability 目录下)</span></li> 
     <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">Reachability.m (在 External/Reachability 目录下)</span></li> 
    </ul>
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">库引用：</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">CFNetwork.framework</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">SystemConfiguration.framework</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">MobileCoreServices.framework</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">CoreGraphics.framework</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">和libz.dylib</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">另外，还需要libxml2.dylib(libxml2还需要设置连接选项-lxml2 和头文件搜索路径/usr/include/libxml2)</span></p> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;color:rgb(0,0,255);">二、ASIHttpRequest创建和执行request</span></p> 
    <div class="msg"> 
     <div class="fav">
      <span style="line-height:1.8;font-family:'楷体';font-size:18px;">iOS开发中ASIHttpRequest如何创建和执行request，其中包括同步请求，异步请求，使用Block，使用队列，取消异步请求等等内容。</span>
     </div> 
     <div class="fav"> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">创建NSOperationQueue，这个Cocoa架构的执行任务（NSOperation）的任务队列。我们通过ASIHTTPRequest.h的源码可以看到，此类本身就是一个NSOperation的子类。也就是说它可以直接被放到任务队列中并被执行。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><strong>同步请求</strong></span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">同步请求会在当前线程中执行，使用error属性来检查结束状态（要下载大文件，则需要设定downloadDestinationPath来保存文件到本地）：</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">- (IBAction)grabURL:(<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">id</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)sender { NSURL </span>*url = [NSURL URLWithString:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">http://www.kenjiao.com</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; ASIHTTPRequest </span>*request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIHTTPRequest requestWithURL:url]; [request startSynchronous]; NSError </span>*error =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request error]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">if</span> (!<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">error) { NSString </span>*response =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request responseString]; } } </span></span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">同步请求会阻塞主线程的执行，这导致用户界面不响应用户操作，任何动画都会停止渲染。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><strong>异步请求</strong></span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">下面是最简单的异步请求方法，这个request会在全局的NSOperationQueue中执行，若要进行更复杂的操作，我们需要自己创建NSOperationQueue或者ASINetworkQueue，后面会讲到。</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">- (IBAction)grabURLInBackground:(<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">id</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)sender { NSURL </span>*url = [NSURL URLWithString:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">http://www.kenjiao.com</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; ASIHTTPRequest </span>*request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIHTTPRequest requestWithURL:url]; [request setDelegate:self]; [request startAsynchronous]; } </span>- (<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">void</span>)requestFinished:(ASIHTTPRequest *<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)request { </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);"> Use when fetching text data </span>
       NSString *responseString =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request responseString]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);"> Use when fetching binary data </span>
       NSData *responseData =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request responseData]; } </span>- (<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">void</span>)requestFailed:(ASIHTTPRequest *<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)request { NSError </span>*error =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request error]; } </span></span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><strong>使用block</strong></span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">在平台支持情况下，ASIHTTPRequest1.8以上支持block。</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">- (IBAction)grabURLInBackground:(<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">id</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)sender { NSURL </span>*url = [NSURL URLWithString:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">http://www.kenjiao.com</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; __block ASIHTTPRequest </span>*request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIHTTPRequest requestWithURL:url]; [request setCompletionBlock:</span>^<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">{ </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);"> Use when fetching text data </span>
          NSString *responseString =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request responseString]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);"> Use when fetching binary data </span>
          NSData *responseData =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request responseData]; }]; [request setFailedBlock:</span>^<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">{ NSError </span>*error =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request error]; }]; [request startAsynchronous]; } </span></span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">注意，声明request时要使用__block修饰符，这是为了告诉block不要retain request，以免出现retain循环，因为request是会retain block的。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><strong>使用队列</strong></span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">创建NSOperationQueue或者ASINetworkQueue队列，我们还可以设定最大并发连接数：maxConcurrentOperationCount</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">- (IBAction)grabURLInTheBackground:(<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">id</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)sender { </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">if</span> (!<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">[self queue]) { [self setQueue:[[[NSOperationQueue alloc] init] autorelease]]; [self queue].maxConcurrentOperationCount </span>= <span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,128);">4</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">; } NSURL </span>*url = [NSURL URLWithString:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">http://www.kenjiao.com</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; ASIHTTPRequest </span>*request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIHTTPRequest requestWithURL:url]; [request setDelegate:self]; [request setDidFinishSelector:@selector(requestDone:)]; [request setDidFailSelector:@selector(requestWentWrong:)]; [[self queue] addOperation:request]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">queue is an NSOperationQueue </span>
<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">} </span>- (<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">void</span>)requestDone:(ASIHTTPRequest *<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)request { NSString </span>*response =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request responseString]; } </span>- (<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">void</span>)requestWentWrong:(ASIHTTPRequest *<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)request { NSError </span>*error =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request error]; } </span></span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">如果不设定selector，那么系统会使用默认的<strong>requestFinished:&nbsp;</strong>和&nbsp;<strong>requestFailed:</strong>方法</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">如果需要对队列里面的每个request进行区分，那么可以设定request的userInfo属性，它是个NSDictionary，或者更简单的方法是设定每个request的tag属性，这两个属性都不会被发送到服务器。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">不要使用request的URL来区分每个request，因为URL可能会改变（例如重定向），如果需要使用request的URL，使用[request originalURL]，这个将永远返回第一个url。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><strong>对于ASINetworkQueue</strong></span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASINetworkQueue是NSOperationQueue的子类，提供更高级的特性（ASINetworkQueue的代理函数）：</span></p> 
      <ul>
       <li style="list-style:disc;"> <span style="line-height:1.8;font-family:'楷体';font-size:18px;">requestDidStartSelector</span><br><span style="line-height:1.8;font-family:'楷体';font-size:18px;">当一个request开始执行时，这个代理函数会被调用。</span> </li> 
       <li style="list-style:disc;"> <span style="line-height:1.8;font-family:'楷体';font-size:18px;">requestDidReceiveResponseHeadersSelector</span><br><span style="line-height:1.8;font-family:'楷体';font-size:18px;">当队列中的request收到服务器返回的头信息时，这个代理函数会被调用。对于下载很大的文件，这个通常比整个request的完成要早。</span> </li> 
       <li style="list-style:disc;"> <span style="line-height:1.8;font-family:'楷体';font-size:18px;">requestDidFinishSelector</span><br><span style="line-height:1.8;font-family:'楷体';font-size:18px;">当每个request完成时，这个代理函数会被调用。</span> </li> 
       <li style="list-style:disc;"> <span style="line-height:1.8;font-family:'楷体';font-size:18px;">requestDidFailSelector</span><br><span style="line-height:1.8;font-family:'楷体';font-size:18px;">当每个request失败时，这个代理函数会被调用。</span> </li> 
       <li style="list-style:disc;"> <span style="line-height:1.8;font-family:'楷体';font-size:18px;">queueDidFinishSelector</span><br><span style="line-height:1.8;font-family:'楷体';font-size:18px;">当队列完成（无论request失败还是成功）时，这个代理函数会被调用。</span> </li> 
      </ul>
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASINetworkQueues与NSOperationQueues稍有不同，加入队列的request不会立即开始执行。如果队列打开了进度开关，那么队列开始时，会先对所有GET型request进行一次HEAD请求，获得总下载大小，然后真正的request才被执行。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">向一个已经开始进行的ASINetworkQueue 加入request会怎样？</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">如果你使用ASINetworkQueue来跟踪若干request的进度，只有当新的request开始执行时，总进度才会进行自适应调整（向后移动）。ASINetworkQueue不会为队列开始后才加入的request进行HEAD请求，所以如果你一次向一个正在执行的队列加入很多request，那么总进度不会立即被更新。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">如果队列已经开始了，不需要再次调用[queue go]。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">当ASINetworkQueue中的一个request失败时，默认情况下，ASINetworkQueue会取消所有其他的request。要禁用这个特性，设置&nbsp;[queue setShouldCancelAllRequestsOnFailure:NO]。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASINetworkQueues只可以执行ASIHTTPRequest操作，二不可以用于通用操作。试图加入一个不是ASIHTTPRequest的NSOperation将会导致抛出错误。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><strong>取消异步请求</strong></span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">取消一个异步请求（无论request是由[request startAsynchronous]开始的还是从你创建的队列中开始的），使用[request cancel]即可。注意同步请求不可以被取消。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">注意，如果你取消了一个request，那么这个request将会被视为请求失败，并且request的代理或者队列的代理的失败代理函数将被调用。如果你不想让代理函数被调用，那么将delegate设置为nil，或者使用clearDelegatesAndCancel方法来取消request。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">clearDelegatesAndCancel&nbsp;将会首先清除所有的代理和block。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">当使用ASINetworkQueue时，如果取消了队列中的一个request，那么队列中其他所有request都会被取消，可以设置shouldCancelAllRequestsOnFailure的值为NO来避免这个现象。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><strong>安全地控制delegate防止request完成之前代理被释放</strong></span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">request并不retain它们的代理，所以有可能你已经释放了代理，而之后request完成了，这将会引起崩溃。大多数情况下，如果你的代理即将被释放，你一定也希望取消所有request，因为你已经不再关心它们的返回情况了。如此做：</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;"><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);"> 代理类的dealloc函数 </span>
- (<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">void</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)dealloc { [request clearDelegatesAndCancel]; [request release]; ... [super dealloc]; } </span></span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;color:rgb(0,0,255);">三、ASIHttpRequest发送数据</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIHttpRequest发送数据的内容，其中包括设定request头，使用ASIFormDataRequest POST表单，PUT请求、自定义POST请求等等内容。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><strong>设定request头</strong></span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">ASIHTTPRequest *request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIHTTPRequest requestWithURL:url]; [request addRequestHeader:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Referer</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> value:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">http://www.kenjiao.com/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span>]; </span></pre>
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><strong>使用ASIFormDataRequest POST表单</strong></span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">通常数据是以’application/x-www-form-urlencoded’格式发送的，如果上传了二进制数据或者文件，那么格式将自动变为‘multipart/form-data’ 。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">文件中的数据是需要时才从磁盘加载，所以只要web server能处理，那么上传大文件是没有问题的。</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">ASIFormDataRequest *request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIFormDataRequest requestWithURL:url]; [request setPostValue:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Ben</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> forKey:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">first_name</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; [request setPostValue:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Copsey</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> forKey:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">last_name</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; [request setFile:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">/Users/ben/Desktop/ben.jpg</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> forKey:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">photo</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span>]; </span></pre>
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">数据的mime头是自动判定的，但是如果你想自定义mime头，那么这样：</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">ASIFormDataRequest *request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIFormDataRequest requestWithURL:url]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);"> Upload a file on disk </span>
[request setFile:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">/Users/ben/Desktop/ben.jpg</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> withFileName:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">myphoto.jpg</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> andContentType:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">image/jpeg</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> forKey:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">photo</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);"> Upload an NSData instance </span>
[request setData:imageData withFileName:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">myphoto.jpg</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> andContentType:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">image/jpeg</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> forKey:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">photo</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span>];</span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">你可以使用addPostValue方法来发送相同name的多个数据（梦维：服务端会以数组方式呈现）：</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">ASIFormDataRequest *request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIFormDataRequest requestWithURL:url]; [request addPostValue:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Ben</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> forKey:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">names</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; [request addPostValue:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">George</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> forKey:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">names</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; [request addFile:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">/Users/ben/Desktop/ben.jpg</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> forKey:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">photos</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; [request addData:imageData withFileName:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">george.jpg</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> andContentType:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">image/jpeg</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> forKey:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">photos</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span>]; </span></pre>
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><strong>PUT请求、自定义POST请求</strong></span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">如果你想发送PUT请求，或者你想自定义POST请求，使用appendPostData: 或者 appendPostDataFromFile:</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">ASIHTTPRequest *request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIHTTPRequest requestWithURL:url]; [request appendPostData:[</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">This is my data</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> dataUsingEncoding:NSUTF8StringEncoding]]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);"> Default becomes POST when you use appendPostData: / appendPostDataFromFile: / setPostBody: </span>
[request setRequestMethod:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">PUT</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span>]; </span></pre>
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;color:rgb(0,0,255);">四、ASIHTTPRequest进度追踪</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIHTTPRequest进度追踪的内容，其中包括追踪单个request的下载进度,追踪一系列request的下载进度,追踪单个request的上传进度,追踪一系列request的上传进度,精确进度条vs简单进度条,自定义进度追踪等等内容。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">每个ASIHTTPRequest有两个delegate用来追踪进度：</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">downloadProgressDelegate (下载) 和 uploadProgressDelegate (上载)。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">进度delegate可以是NSProgressIndicators (Mac OS X) 或者 UIProgressViews (iPhone).ASIHTTPRequest会自适应这两个class的行为。你也可以使用自定义class作为进度delegate，只要它响应setProgress:函数。</span></p> 
      <ul>
       <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">如果你执行单个request，那么你需要为该request设定upload/download进度delegate</span></li> 
       <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">如果你在进行多个请求，并且你想要追踪整个队列中的进度，你必须使用ASINetworkQueue并设置队列的进度delegate</span></li> 
       <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">如果上述两者你想同时拥有，恭喜你，0.97版以后的ASIHTTPRequest，这个可以有 ^ ^</span></li> 
      </ul>
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">IMPORTANT:如果你向一个要求身份验证的网站上传数据，那么每次授权失败，上传进度条就会被重置为上一次的进度值。因此，当与需要授权的web服务器交互时，建议仅当useSessionPersistence为YES时才使用上传进度条，并且确保你在追踪大量数据的上传进度之前，先使用另外的request来进行授权。&nbsp;</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">追踪小于128KB的数据上传进度目前无法做到，而对于大于128kb的数据，进度delegate不会收到第一个128kb数据块的进度信息。这是因为CFNetwork库API的限制。我们曾向apple提交过bug报告（bug id 6596016），希望apple能修改CFNetwork库以便实现上述功能。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">2009-6-21：Apple的哥们儿们真棒！iPhone 3.0 SDK里，buffer大小已经被减小到32KB了，我们的上传进度条可以更精确了。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><a name="i0" style="color:rgb(0,0,0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51,51,51);"></a></span></p> 
      <h2 style="color:rgb(0,0,0);line-height:1.5;font-size:21px;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">追踪单个request的下载进度</span></h2> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">这个例子中，&nbsp;myProgressIndicator是个 NSProgressIndicator.</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">ASIHTTPRequest *request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIHTTPRequest requestWithURL:url]; [request setDownloadProgressDelegate:myProgressIndicator]; [request startSynchronous]; NSLog(</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Max: %f, Value: %f</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span>, [myProgressIndicator maxValue],[myProgressIndicator doubleValue]); </span></pre>
      </div> 
      <h2 style="color:rgb(0,0,0);line-height:1.5;font-size:21px;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">追踪一系列request的下载进度</span></h2> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">在这个例子中, myProgressIndicator 是个 UIProgressView, myQueue是个 ASINetworkQueue.</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">- (<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">void</span>)fetchThisURLFiveTimes:(NSURL *<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)url { [myQueue cancelAllOperations]; [myQueue setDownloadProgressDelegate:myProgressIndicator]; [myQueue setDelegate:self]; [myQueue setRequestDidFinishSelector:@selector(queueComplete:)]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">int</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> i; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">for</span> (i=<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,128);">0</span>; i&lt;<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,128);">5</span>; i++<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">) { ASIHTTPRequest </span>*request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIHTTPRequest requestWithURL:url]; [myQueue addOperation:request]; } [myQueue go]; } </span>- (<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">void</span>)queueComplete:(ASINetworkQueue *<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)queue { NSLog(</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Value: %f</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">, [myProgressIndicator progress]); } </span></span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">这个例子中，我们已经为ASINetworkQueues调用过[myQueue go]了。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><a name="i2" style="color:rgb(0,0,0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51,51,51);"></a></span></p> 
      <h2 style="color:rgb(0,0,0);line-height:1.5;font-size:21px;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">追踪单个request的上传进度</span></h2> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">在这个例子中, myProgressIndicator 是个 UIProgressView。</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">ASIFormDataRequest *request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIFormDataRequest requestWithURL:url]; [request setPostValue:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Ben</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> forKey:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">first_name</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; [request setPostValue:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Copsey</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> forKey:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">last_name</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; [request setUploadProgressDelegate:myProgressIndicator]; [request startSynchronous]; NSLog(</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Value: %f</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span>,[myProgressIndicator progress]); </span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <h2 style="color:rgb(0,0,0);line-height:1.5;font-size:21px;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">追踪一系列request的上传进度</span></h2> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">这个例子中, myProgressIndicator是个 NSProgressIndicator, myQueue是个ASINetworkQueue.</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">- (<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">void</span>)uploadSomethingFiveTimes:(NSURL *<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)url { [myQueue cancelAllOperations]; [myQueue setUploadProgressDelegate:myProgressIndicator]; [myQueue setDelegate:self]; [myQueue setRequestDidFinishSelector:@selector(queueComplete:)]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">int</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> i; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">for</span> (i=<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,128);">0</span>; i&lt;<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,128);">5</span>; i++<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">) { ASIHTTPRequest </span>*request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIFormDataRequest requestWithURL:url]; [request setPostBody:[</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Some data</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> dataUsingEncoding:NSUTF8StringEncoding]]; [myQueue addOperation:request]; } [myQueue go]; } </span>- (<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">void</span>)queueComplete:(ASINetworkQueue *<span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)queue { NSLog(</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Max: %f, Value: %f</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">, [myProgressIndicator maxValue],[myProgressIndicator doubleValue]); } </span></span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <h2 style="color:rgb(0,0,0);line-height:1.5;font-size:21px;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">精确进度条vs简单进度条</span></h2> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIHTTPRequest提供两种进度条显示，简单进度条和精确进度条，使用ASIHTTPRequests 和ASINetworkQueues的showAccurateProgress 来控制。为一个request设置showAccurateProgress只会对该request有效。如果你为一个队列设置showAccurateProgress，那么会影响队列里所有的request。</span></p> 
      <h3 style="color:rgb(0,0,0);font-size:16px;line-height:1.5;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">简单进度条</span></h3> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">当使用简单进度条时，进度条只会在一个request完成时才更新。对于单个request，这意味着你只有两个进度状态：0%和100%。对于一个有5个request的队列来说，有五个状态：0%，25%，50%，75%，100%，每个request完成时，进度条增长一次。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">简单进度条（showAccurateProgress = NO）是ASINetworkQueue的默认值，适用于大量小数据请求。</span></p> 
      <h3 style="color:rgb(0,0,0);font-size:16px;line-height:1.5;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">精确进度条</span></h3> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">当使用精确进度条时，每当字节被上传或下载时，进度条都会更新。它适用于上传/下载大块数据的请求，并且会更好的显示已经发送/接收的数据量。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">使用精确进度条追踪上传会轻微降低界面效率，因为进度delegate（一般是UIProgressViews 或NSProgressIndicators）会更频繁地重绘。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">使用精确进度条追踪下载会更影响界面效率，因为队列会先为每个GET型request进行HEAD请求，以便统计总下载量。强烈推荐对下载大文件的队列使用精确进度条，但是要避免对大量小数据请求使用精确进度条。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">精确进度条（showAccurateProgress = YES）是以同步方式执行的ASIHTTPRequest的默认值。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;"><a name="i5" style="color:rgb(0,0,0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51,51,51);"></a></span></p> 
      <h2 style="color:rgb(0,0,0);line-height:1.5;font-size:21px;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">自定义进度追踪</span></h2> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIProgressDelegate 协议定义了所有能更新一个request进度的方法。多数情况下，设置你的uploadProgressDelegate或者 downloadProgressDelegate为NSProgressIndicator或者UIProgressView会很好。但是，如果你想进行更复杂的追踪，你的进度delegate实现下列函数要比&nbsp;setProgress: (iOS) 或者 setDoubleValue: / setMaxValue: (Mac)好：</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">这些函数允许你在实际量的数据被上传或下载时更新进度，而非简单方法的0到1之间的数字。</span></p> 
      <h3 style="color:rgb(0,0,0);font-size:16px;line-height:1.5;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">downloadProgressDelegates方法</span></h3> 
      <ul>
       <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">request:didReceiveBytes:&nbsp;每次request下载了更多数据时，这个函数会被调用（注意，这个函数与一般的代理实现的&nbsp;request:didReceiveData:函数不同）。</span></li> 
       <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">request:incrementDownloadSizeBy:&nbsp;当下载的大小发生改变时，这个函数会被调用，传入的参数是你需要增加的大小。这通常发生在request收到响应头并且找到下载大小时。</span></li> 
      </ul>
      <h3 style="color:rgb(0,0,0);font-size:16px;line-height:1.5;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">uploadProgressDelegates方法</span></h3> 
      <ul>
       <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">request:didSendBytes:&nbsp;每次request可以发送更多数据时，这个函数会被调用。注意：当一个request需要消除上传进度时（通常是该request发送了一段数据，但是因为授权失败或者其他什么原因导致这段数据需要重发）这个函数会被传入一个小于零的数字。</span></li>
      </ul>
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;color:rgb(0,0,255);">五、ASIHTTPRequest断点续传(下载)</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIHTTPRequest断点续传(下载)的内容，其中包括ASIHTTPRequest可以恢复中断的下载，设置一个临时下载路径，断点续传的工作原理等等内容。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">从0.94版本开始，ASIHTTPRequest可以恢复中断的下载。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">这个特性只对下载数据到文件中有效，你必须为一下情况的request设置allowResumeForFileDownloads&nbsp;为YES：</span></p> 
      <ul>
       <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">任何你希望将来可以断点续传的下载（否则，ASIHTTPRequest会在取消或者释放内存时将临时文件删除）</span></li> 
       <li style="list-style:disc;"><span style="line-height:1.8;font-family:'楷体';font-size:18px;">任何你要进行断点续传的下载</span></li> 
      </ul>
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">另外，你必须自己设置一个临时下载路径（setTemporaryFileDownloadPath），这个路径是未完成的数据的路径。新的数据将会被添加到这个文件，当下载完成时，这个文件将被移动到downloadDestinationPath&nbsp;。</span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;">- (IBAction)resumeInterruptedDownload:(<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,0,255);">id</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">)sender { NSURL </span>*url =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [NSURL URLWithString: </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">http://www.dreamingwish.com/wp-content/uploads/2011/10/asihttprequest-auth.png</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; ASIHTTPRequest </span>*request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIHTTPRequest requestWithURL:url]; NSString </span>*downloadPath = <span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">/Users/ben/Desktop/asi.png</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">当request完成时，整个文件会被移动到这里 </span>
<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request setDownloadDestinationPath:downloadPath]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">这个文件已经被下载了一部分 </span>
  [request setTemporaryFileDownloadPath:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">/Users/ben/Desktop/asi.png.download</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; [request setAllowResumeForFileDownloads:YES]; [request startSynchronous]; </span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">整个文件将会在这里 </span>
  NSString *theContent =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [NSString stringWithContentsOfFile:downloadPath]; } </span></span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">断点续传的工作原理是读取temporaryFileDownloadPath的文件的大小，并使用Range: bytes=x&nbsp;HTTP头来请求剩余的文件内容。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;">ASIHTTPRequest并不检测是否存在Accept-Ranges头（因为额外的HEAD头请求会消耗额外的资源），所以只有确定服务器支持断点续传下载时，再使用这个特性。</span></p> 
      <p><span style="line-height:1.8;font-family:'楷体';font-size:18px;color:rgb(0,0,255);">六、<strong>ASIHttpRequest</strong><strong>请求</strong><strong>HTTPS</strong></span></p> 
      <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="font-family:'楷体';font-size:18px;line-height:1.8;"><span style="line-height:1.8;font-family:'Courier New';font-size:12px;"><span style="line-height:1.8;color:rgb(0,128,0);">//一种方法</span> ASIHTTPRequest </span>*request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIHTTPRequestrequestWithURL:[NSURLURLWithString:bodyString]]; [request setDelegate:self]; request.timeOutSeconds </span>= <span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,128);">20</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">; [request setRequestMethod:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">POST</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; [request addRequestHeader:</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Content-Type</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span>value:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">application/xml;charset=UTF-8;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">]; [request setValidatesSecureCertificate:NO];</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">请求https的时候，就要设置这个属性</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [request startAsynchronous]; ￼ &nbsp; &nbsp;&nbsp; &nbsp; ￼ <span style="line-height:1.8;color:rgb(0,128,0);">//二种方法</span> ASIFormDataRequest </span>*request =<span style="line-height:1.8;font-family:'Courier New';font-size:12px;"> [ASIFormDataRequest requestWithURL:[NSURL URLWithString:bodyString]]; [request setDelegate:self]; request.timeOutSeconds </span>= <span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,128);">20</span><span style="line-height:1.8;font-family:'Courier New';font-size:12px;">; [request setValidatesSecureCertificate:NO];</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(0,128,0);">请求https的时候，就要设置这个属性</span>
 [request setRequestMethod:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">POST</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span>]; [request addRequestHeader:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">Content-Type</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span> value:<span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">application/xml;charset=UTF-8</span><span style="font-family:'Courier New';font-size:12px;line-height:1.8;color:rgb(128,0,0);">"</span>]; request.defaultResponseEncoding = NSUTF8StringEncoding;</span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <p>&nbsp;</p> 
      <p><strong><span style="line-height:1.8;font-family:'楷体';font-size:18px;">参考原址：<a href="http://mobile.51cto.com/iphone-405168.htm" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51,51,51);">http://mobile.51cto.com/iphone-405168.htm</a></span></strong></p> 
     </div> 
    </div> 
   </div> 
   <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:25.2px;">
    程序猿神奇的手，每时每刻，这双手都在改变着世界的交互方式！
   </div> 
   <div class="clear" style="clear:both;color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:25.2px;"></div> 
   <div> 
    <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:25.2px;">
     分类:&nbsp;
     <a href="http://www.cnblogs.com/XYQ-208910/category/742527.html" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:rgb(51,51,51);">iOS高级</a> 
    </div> 
    <div> 
     <font color="#333333"><span style="font-size:14px;line-height:25.2px;">本文转自当天真遇到现实博客园博客，原文链接：http://www.cnblogs.com/XYQ-208910/p/5652576.html</span></font>
     <span style="font-size:14px;line-height:25.2px;color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
