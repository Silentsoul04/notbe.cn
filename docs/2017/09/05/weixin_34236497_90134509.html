<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>使用 EPUB 制作数字图书 基于 XML 的开放式 eBook 格式 « NotBeCN</title>
  <meta name="description" content="             /////////////////////////////////////////////////////////////////////////////////////////////Page1    简介：&nbsp; 是否需要分发文档、创建电子图书或者把喜欢的博客文章存档？EPUB...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/09/05/weixin_34236497_90134509.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">使用 EPUB 制作数字图书 基于 XML 的开放式 eBook 格式</h1>
    <p class="post-meta">Sep 5, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>/////////////////////////////////////////////////////////////////////////////////////////////Page1</strong><br></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>简介：</strong>&nbsp; 是否需要分发文档、创建电子图书或者把喜欢的博客文章存档？EPUB 是一种开放式的数字图书规范，以常用的技术如 XML、CSS 和 XHTML 为基础，EPUB 文件可在便携式的 e-ink 设备、移动电话和桌面计算机上阅读。本教程详细阐述了 EPUB 格式，首先用 Java™ 技术示范了 EPUB 验证，然后详细说明如何使用 DocBook 和 Python 自动创建 EPUB。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>开始之前</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">本教程讲述如何创建 EPUB 格式的电子图书。EPUB 是一种基于 XML 的、对开发者友好的格式，正逐渐成为数字图书的事实标准。但 EPUB 不仅可用于图书，还包括：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;">对文档打包以便离线阅读或者分发</li> 
    <li style="list-style-type:disc;">打包博客文章或者其他 Web 内容</li> 
    <li style="list-style-type:disc;">使用常见的开放源代码工具创建、搜索和整理</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="N10171" style="color:rgb(29,88,209);"></a>关于本教程</p> 
   <div class="ibm-container ibm-alt-header dw-container-sidebar" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <h2 style="font-size:21px;line-height:1.5;">常用的缩写词</h2> 
    <div class="ibm-container-body"> 
     <ul style="margin-left:30px;">
      <li style="list-style-type:disc;">API：应用程序编程接口（application programming interface）</li> 
      <li style="list-style-type:disc;">CSS：级联样式表（Cascading stylesheet）</li> 
      <li style="list-style-type:disc;">DOM：文档对象模型（Document Object Model）</li> 
      <li style="list-style-type:disc;">DTD：文档类型定义（Document type definition）</li> 
      <li style="list-style-type:disc;">GUI：图形用户界面（Graphical user interface）</li> 
      <li style="list-style-type:disc;">HTML：超文本标记语言（Hypertext Markup Language）</li> 
      <li style="list-style-type:disc;">SAX：XML 简易 API（Simple API For XML）</li> 
      <li style="list-style-type:disc;">W3C：万维网联盟（World Wide Web Consortium）</li> 
      <li style="list-style-type:disc;">XHTML：可扩展的 HTML（Extensible HTML）</li> 
      <li style="list-style-type:disc;">XML：可扩展标记语言</li> 
     </ul>
    </div> 
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">本教程首先手工创建一个 EPUB 图书，帮助您了解其构成和需要的文件。然后说明如何捆绑完成的数字图书，按照规范进行验证以及在不同的阅读系统上测试。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">然后讨论如何从 DocBook XML 生成 EPUB — 最常用的技术文档标准之一 — 以及如何使用 Python 实现从 DocBook 到 EPUB 的自动创建。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="objectives" style="color:rgb(29,88,209);"></a>目标</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">通过本教程可以学习如下内容：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;">了解 EPUB 是什么，谁支持它，谁采用它</li> 
    <li style="list-style-type:disc;">了解 EPUB 包的结构，包括需要的文件及其模式</li> 
    <li style="list-style-type:disc;">如何从头创建一个内容简单而有效的 EPUB 文件</li> 
    <li style="list-style-type:disc;">使用开放源代码工具从 DocBook 生成 EPUB 文件，DocBook 是一种常见的技术文档和图书模式</li> 
    <li style="list-style-type:disc;">使用 Python 和 DocBook 自动转换成 EPUB</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="prereqs" style="color:rgb(29,88,209);"></a>先决条件</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">本教程对操作系统没有特殊要求，但是应该熟悉创建文件和目录的机制。建议使用 XML 编辑器或者集成开发环境（IDE）。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">对于本教程后半部分的 EPUB 创建自动化内容，需要读者了解基本的 XML 处理技巧 — XSLT、 DOM 或者基于 SAX 的解析 — 并熟悉使用 XML 原生 API 构造 XML 文档。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">阅读本教程不需要熟悉 EPUB 文件格式。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="sysreqs" style="color:rgb(29,88,209);"></a>系统需求</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">尝试本教程中的例子，需要一个 Java 解释器（1.5 或更高版本）和 Python 解释器（2.4 或更高版本）以及相应的 XML 库。不过，有经验的 XML 开发人员很容易将这些例子修改为适合任何编程语言和 XML 库。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;/////////////////////////////////////////////////////////////////////////////////////////////Page2</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">关于 EPUB 格式</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">了解 EPUB 的背景，EPUB 最适合做什么，以及 EPUB 和便携式文档格式（PDF）的区别。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="whatis" style="color:rgb(29,88,209);"></a>什么是 EPUB？</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">EPUB 是可逆的数字图书和出版物 XML 格式，数字出版业商业和标准协会 International Digital Publishing Forum (IDPF) 制定的标准。IDPF 于 2007 年 10 月正式采用 EPUB，随后被主流出版商迅速采用。可以使用各种开放源代码或者商业软件在所有主流操作系统、Sony PRS 之类的 e-ink 设备或者 Apple iPhone 之类的小型设备上阅读 EPUB 格式。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="whois" style="color:rgb(29,88,209);"></a>谁在使用 EPUB？只能用于图书吗？</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">虽然最早采用 EPUB 的是传统的印刷品出版商，但是这并不妨碍它在电子图书中的应用。利用免费的软件工具，可以将网页捆绑成 EPUB，转化成文本文件或者将原有的 DocBook XML 文档转化成结构良好的、有效的 EPUB（后一点将在&nbsp;<a href="http://www.cnblogs.com/linlf03/admin/section5.html" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">从 DocBook 到 EPUB</a>&nbsp;一节讨论）。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="howis" style="color:rgb(29,88,209);"></a>EPUB 与 PDF 有什么不同？</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">PDF 仍然是世界上应用最广泛的电子文档格式。从图书出版商的角度来看，PDF 的优点包括：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;">PDF 文件允许对页面布局进行像素级的控制，包括复杂的打印格式，如多栏格式和奇偶页相间的格式。</li> 
    <li style="list-style-type:disc;">有多种不同的 GUI 文档工具可生成 PDF，如 Microsoft® Office Word 和 Adobe® InDesign®。</li> 
    <li style="list-style-type:disc;">PDF 阅读器非常普及，现在大多数计算机上都有安装。</li> 
    <li style="list-style-type:disc;">PDF 可以嵌入特殊的字体，精确控制最终的输出结果。</li> 
   </ul>
   <div class="ibm-container ibm-alt-header dw-container-sidebar" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <a name="schemas" style="color:rgb(29,88,209);"></a> 
    <h2 style="font-size:21px;line-height:1.5;">三合一的标准</h2> 
    <div class="ibm-container-body"> 
     <p>EPUB 包括三个单独的 IDPF 规范，虽然实际上将其统称为&nbsp;<em>EPUB</em>&nbsp;更保险：</p> 
     <ul style="margin-left:30px;">
      <li style="list-style-type:disc;"> <strong>Open eBook Publication Structure Container Format (OCF)</strong>：定义了 EPUB 档案的目录树结构和文件结构（ZIP）。</li> 
      <li style="list-style-type:disc;"> <strong>Open Publication Structure (OPS)</strong>：定义了电子图书的公共词汇表，特别是可作为图书内容的格式（比如 XHTML 和 CSS）。</li> 
      <li style="list-style-type:disc;"> <strong>Open Packaging Format (OPF)</strong>：描述了 EPUB 必须的和可选的元数据、阅读顺序和目录。</li> 
     </ul>
     <p>此外，对于档案中的特定类型的内容，EPUB 还重用了其他一些标准，如 XHTML 1.0 和 Digital Accessible Information SYstem (DAISY)。</p> 
    </div> 
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">从软件开发人员的角度来看，PDF 还远远不够理想：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;">这不是一种简单易学的标准，因此编写自己的 PDF 生成代码非常困难。</li> 
    <li style="list-style-type:disc;">虽然 PDF 现在是一种 International Organization for Standardization（ISO）标准（ISO 32000-1:2008），但过去一直受一家公司的控制：Adobe Systems。</li> 
    <li style="list-style-type:disc;">尽管多数编程语言都提供了 PDF 库，但很多是商业产品或者嵌入到 GUI 应用程序中，外部进程不容易控制。并非所有的免费库都得到积极的维护。</li> 
    <li style="list-style-type:disc;">PDF 原生文本可以通过程序提取出来并进行搜索，但很少可以对 PDF 进行标记以便简单可靠地转化成 Web 友好的格式。</li> 
    <li style="list-style-type:disc;">PDF 文档不容易<em>流动</em>，就是说很难适应小屏幕或者对布局进行明显的改变。</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="friendly" style="color:rgb(29,88,209);"></a>为何说 EPUB 对开发人员是友好的</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">EPUB 解决了 PDF 和开发人员友好性有关的所有瑕疵。一个 EPUB 就是一个简单 ZIP 格式文件（使用&nbsp;<em>.epub</em>&nbsp;扩展名），其中包括按照预先定义的方式排列的文件。如何制作 ZIP 文档有一些技巧，稍后将在&nbsp;<a href="http://www.cnblogs.com/linlf03/admin/section4.html#epub-zip" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">将 EPUB 文件捆绑为 ZIP 文档</a>&nbsp;一节介绍。除此以外，EPUB 非常简单：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;">EPUB 中的所有内容基本上都是 XML。EPUB 文件可使用标准 XML 工具创建，不需要任何专门或者私有的软件。</li> 
    <li style="list-style-type:disc;">EPUB 内容（eBook 的具体内容）基本上都是 XHTML 1.1（另一种格式是 DTBook，为视力受限者编码书籍的一种标准。关于 DTBook 的更多信息请参阅&nbsp;<a href="http://www.cnblogs.com/linlf03/admin/resources.html" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">参考资料</a>，本教程中不涉及这部分）。</li> 
    <li style="list-style-type:disc;">大多数 EPUB XML 模式都来自现成的、可免费获得的、已发布的规范。</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">最关键的在于&nbsp;<strong>EPUB 元数据是 XML</strong>，<strong>EPUB 内容是 XHTML</strong>。如果您的文档构建系统产生的结果用于 Web 和/或基于 XML，那么也可用于生成 EPUB。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;/////////////////////////////////////////////////////////////////////////////////////////////Page3</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">创建第一个 EPUB</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">最小的 EPUB 包至少要包含几个文件。规范对于 EPUB 包中这些文件的格式、内容和位置要求可能很严格。这一节讨论使用 EPUB 标准<em>必须</em>&nbsp;了解的基础知识。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="anatomyofepub" style="color:rgb(29,88,209);"></a>解剖 EPUB 包</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">小型 EPUB 文件的基本结构遵循&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list1" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 1</a>&nbsp;所示的样式。准备好分发之前，整个目录结构被压缩到一个 ZIP 格式文件中，几点特殊要求将在&nbsp;<a href="http://www.cnblogs.com/linlf03/admin/section4.html#epub-zip" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">用 ZIP 打包 EPUB 文件</a>&nbsp;一节讨论。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list1" style="color:rgb(29,88,209);"></a><strong>清单 1. 简单 EPUB 档案的目录和文件结构</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;width:678px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
mimetype
META-INF/
   container.xml
OEBPS/
  content.opf
  title.html
  content.html
  stylesheet.css
  toc.ncx
  images/
     cover.png
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>提示：</strong>可 下载 符合该结构的一个电子图书，但建议按照本教程的说明自己创建一个。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">编写 EPUB 图书之前首先创建 EPUB 项目的目录。打开文本编辑器或者 Eclipse 之类的 IDE。建议采用支持 XML 的编辑器 — 具体而言就是能够根据&nbsp;<a href="http://www.cnblogs.com/linlf03/admin/resources.html" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">参考资料</a>&nbsp;给出的 Relax NG 模式进行验证。</p> 
   <div class="ibm-alternate-rule" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <hr>
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="mimetype" style="color:rgb(29,88,209);"></a>mimetype 文件</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">这个文件非常简单，必须命名为&nbsp;<em>mimetype</em>，文件内容如下：</p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">application/epub+zip
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">要注意，mimetype 文件不能包含新行或者回车。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">此外，mimetype 文件必须作为 ZIP 档案中的第一个文件，而且自身不能压缩。<a href="http://www.cnblogs.com/linlf03/admin/section4.html#epub-zip" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">用 ZIP 打包 EPUB 文件</a>&nbsp;一节将介绍如何使用一般的 ZIP 参数将其包含进来。现在创建该文件并保存，并确保它在 EPUB 项目的根目录中。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="container.xml" style="color:rgb(29,88,209);"></a>META-INF/container.xml</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">EPUB 根目录下必须包含 META-INF 目录，而且其中要有一个文件&nbsp;<em>container.xml</em>。EPUB 阅读系统首先查看该文件，它指向数字图书元数据的位置。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">创建目录&nbsp;<em>META-INF</em>。在其中创建一个新文件&nbsp;<em>container.xml</em>。container 文件非常小，但是对结构要求很严格。将&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list2" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 2</a>&nbsp;中的代码粘贴到 META-INF/container.xml 中。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list2" style="color:rgb(29,88,209);"></a><strong>清单 2. container.xml 文件</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
&lt;?xml version="1.0"?&gt;
&lt;container version="1.0" xmlns="urn:oasis:names:tc:opendocument:xmlns:container"&gt;
  &lt;rootfiles&gt;
    &lt;rootfile full-path="<strong>OEBPS/content.opf</strong>"
     media-type="application/oebps-package+xml" /&gt;
  &lt;/rootfiles&gt;
&lt;/container&gt;
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><code>full-path</code>（粗体）的值仅仅是该文件的一部分，不同的文件可能相差甚大。目录路径必须相对于 EPUB 文件根目录本身，而不是 META-INF 目录。</p> 
   <div class="ibm-container ibm-alt-header dw-container-sidebar" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <a name="meta-inf" style="color:rgb(29,88,209);"></a> 
    <h2 style="font-size:21px;line-height:1.5;">关于 META-INF</h2> 
    <div class="ibm-container-body"> 
     <p>META-INF 目录还可以包含其他几个文件。这些文件使 EPUB 支持数字签名、加密和数字版权管理（DRM）。本教程不讨论这些主题。更多信息请参阅 OCF 规范。</p> 
    </div> 
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">mimetype 和 container 是 EPUB 档案中仅有的两个需要严格限制位置的文件。建议（尽管不是必须的）将其他文件保存到 EPUB 的子目录下（按照惯例，通常被称为&nbsp;<em>OEBPS</em>，即&nbsp;<em>Open eBook Publication Structure</em>，但不是必须的）。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">接下来在 EPUB 项目中创建目录&nbsp;<em>OEBPS</em>。本教程下一节将介绍 OEBPS 中的文件 — 数字图书的核心：元数据和页面。</p> 
   <div class="ibm-alternate-rule" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <hr>
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="opf" style="color:rgb(29,88,209);"></a>打开 Packaging Format 元数据文件</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">尽管该文件名没有特殊要求，但通常被称为&nbsp;<em>content.opf</em>。它指定了图书中<em>所有</em>&nbsp;内容的位置，如文本和图像等其他媒体。它还给出了另一个元数据文件，内容的 Navigation Center eXtended (NCX) 表。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">该 OPF 文件是 EPUB 规范中最复杂的元数据。创建 OEBPS/content.opf 并粘贴&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list3" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 3</a>&nbsp;所示的内容。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list3" style="color:rgb(29,88,209);"></a><strong>清单 3. 包含示例元数据的 OPF content 文件</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;package xmlns="http://www.idpf.org/2007/opf" 
            xmlns:dc="http://purl.org/dc/elements/1.1/" 
            unique-identifier="<strong>bookid</strong>" version="2.0"&gt;
  &lt;metadata&gt;
    &lt;dc:title&gt;Hello World: My First EPUB&lt;/dc:title&gt;
    &lt;dc:creator&gt;My Name&lt;/dc:creator&gt;
    &lt;dc:identifier id="<strong>bookid</strong>"&gt;urn:uuid:12345&lt;/dc:identifier&gt;
    &lt;meta name="cover" content="cover-image" /&gt;
  &lt;/metadata&gt;
  &lt;manifest&gt;
    &lt;item id="ncx" href="toc.ncx" media-type="text/xml"/&gt;
    &lt;item id="cover" href="title.html" media-type="application/xhtml+xml"/&gt;
    &lt;item id="content" href="content.html" media-type="application/xhtml+xml"/&gt;
    &lt;item id="cover-image" href="images/cover.png" media-type="image/png"/&gt;
    &lt;item id="css" href="stylesheet.css" media-type="text/css"/&gt;
  &lt;/manifest&gt;
  &lt;spine toc="ncx"&gt;
    &lt;itemref idref="cover" linear="no"/&gt;
    &lt;itemref idref="content"/&gt;
  &lt;/spine&gt;
  &lt;guide&gt;
    &lt;reference href="cover.html" type="cover" title="Cover"/&gt;
  &lt;/guide&gt;
&lt;/package&gt;
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="opf-ns" style="color:rgb(29,88,209);"></a><strong>OPF 模式与名称空间</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">OPF 文档本身必须使用名称空间&nbsp;<em>http://www.idpf.org/2007/opf</em>，元数据则使用 Dublin Core Metadata Initiative (DCMI) 名称空间&nbsp;<em>http://purl.org/dc/elements/1.1/</em>。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">最好现在将 OPF 和 DCMI 模式添加到 XML 编辑器中。EPUB 用到的所有模式都可以 下载。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="opf-metadata" style="color:rgb(29,88,209);"></a><strong>元数据</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">Dublin Core 定义了一组常用的元数据，可用于描述各种不同的数字资料，它不是 EPUB 规范的一部分。所有这些术语都可以出现在 OPF 元数据部分。编写要分发的 EPUB 时，这里可以放很多内容，目前来说&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list4" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 4</a>&nbsp;的内容就足够了。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list4" style="color:rgb(29,88,209);"></a><strong>清单 4. OPF 元数据摘要</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
...
&lt;metadata&gt;
  &lt;dc:title&gt;<strong>Hello World: My First EPUB</strong>&lt;/dc:title&gt;
  &lt;dc:creator&gt;My Name&lt;/dc:creator&gt;
  &lt;dc:identifier id="bookid"&gt;<strong>urn:uuid:12345&lt;</strong>/dc:identifier&gt;
  &lt;meta name="cover" content="cover-image" /&gt;
&lt;/metadata&gt;
...</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">有两个术语是必须的，即&nbsp;<em>title</em>&nbsp;和&nbsp;<em>identifier</em>。按照 EPUB 规范，标识符<em>必须</em>&nbsp;是惟一的，但是这个惟一的值要靠数字图书的创建者来定义。对于图书出版商来说，这个字段一般包含 ISBN 或者 Library of Congress 编号。对于其他 EPUB 创建者，可以考虑使用 URL 或者很大的随机生成的惟一用户 ID（UUID）。要注意，属性&nbsp;<code>unique-identifier</code>&nbsp;的值必须和&nbsp;<code>dc:identifier</code>&nbsp;元素的 ID 属性匹配。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">其他和内容相关的可以考虑添加的元数据包括：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;">语言（如&nbsp;<code>dc:language</code>）。</li> 
    <li style="list-style-type:disc;">出版日期（如&nbsp;<code>dc:date</code>）。</li> 
    <li style="list-style-type:disc;">出版商（如&nbsp;<code>dc:publisher</code>）。（可以是公司或个人的名称）。</li> 
    <li style="list-style-type:disc;">版权信息（如&nbsp;<code>dc:rights</code>）。（如果采用 Creative Commons 许可证，可以将许可证的 URL 放在这里）。</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">关于 DCMI 的更多信息请参阅&nbsp;<a href="http://www.cnblogs.com/linlf03/admin/resources.html" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">参考资料</a>。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">EPUB 规范没有要求包含&nbsp;<code>name</code>&nbsp;属性值为&nbsp;<code>cover</code>&nbsp;的&nbsp;<code>meta</code>&nbsp;元素，但为了增加封面和图像的可移植性，建议这样做。一些 EPUB 呈现程序喜欢使用图像文件作为封面，另一些则愿意使用包含内联封面图像的 XHTML 文件。该例子显示了这两种情况。<code>meta</code>&nbsp;元素的&nbsp;<code>content</code>&nbsp;属性的值应该是图书封面图像在 manifest 中的 ID 号，manifest 是 OPF 文件的一部分。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="opf-manifest" style="color:rgb(29,88,209);"></a><strong>Manifest</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">OPF manifest 列出了 EPUB 内容（不包括元数据）中的所有资源。就是说，通常是组成电子图书文本的一组 XHTML 文件再加上一些相关的媒体如图像。EPUB 鼓励使用 CSS 设定图书内容的样式，因此 manifest 中也包含 CSS。<strong>进入数字图书的所有文件都必须在 manifest 中列出。</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list5" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 5</a>&nbsp;显示了 manifest 的一部分。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list5" style="color:rgb(29,88,209);"></a><strong>清单 5. OPF manifest 的一部分</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
...
&lt;manifest&gt;
  &lt;item id="ncx" href="toc.ncx" media-type="text/xml"/&gt;
  &lt;item id="cover" href="title.html" media-type="application/xhtml+xml"/&gt;
  &lt;item id="content" href="content.html" media-type="application/xhtml+xml"/&gt;
  &lt;item id="cover-image" href="images/cover.png" media-type="image/png"/&gt;
  &lt;item id="css" href="stylesheet.css" media-type="text/css"/&gt;
&lt;/manifest&gt;
...
</pre></td>
     </tr>
    </tbody>
   </table>
   <div class="ibm-container ibm-alt-header dw-container-sidebar" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <a name="complex-metadata" style="color:rgb(29,88,209);"></a> 
    <h2 style="font-size:21px;line-height:1.5;">高级 OPF manifest</h2> 
    <div class="ibm-container-body"> 
     <p>更高级的 manifest 文件可能包含多个 XHTML 文件以及图像和 CSS。可 下载 一个完整的包含各种常见类型的 EPUB 例子。</p> 
    </div> 
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">第一项&nbsp;<code>toc.ncx</code>（参见 下一节）是必须的。所有的项都有相应的&nbsp;<code>media-type</code>&nbsp;值，XHTML 内容的媒体类型为&nbsp;<code>application/xhtml+xml</code>。媒体类型必须正确，<em>不能</em>&nbsp;是&nbsp;<code>text/html</code>&nbsp;或者其他类型。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">EPUB 支持四种<em>核心</em>&nbsp;图像文件类型：Joint Photographic Experts Group (JPEG)、Portable Network Graphics (PNG)、Graphics Interchange Format (GIF) 和 Scalable Vector Graphics (SVG)。如果能够提供对核心类型的后退转换（fall-back），也可包含不支持的文件类型。关于后退转换内容的更多信息请参阅 OPF 规范。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><code>href</code>&nbsp;属性的值应该是一个相对于<em>该 OPF 文件</em>&nbsp;的统一资源标识符（URI）。（很容易和 container.xml 中对 OPF 文件的引用混淆，其中的引用是相对于 EPUB 的整体引用）。这里的 OPF 文件位于和内容相同的 OEBPS 目录中，因此不需要路径信息。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="opf-spine" style="color:rgb(29,88,209);"></a><strong>Spine</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">manifest 告诉 EPUB 阅读器哪些文件属于档案，spine 则指定这些文件出现的顺序或 — 按照 EPUB 的说法 — 数字图书的<em>线性阅读顺序</em>。可以将 OPF spine 看作是书中 “页面” 的顺序。按照文档顺序从上到下依次读取 spine。<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list6" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 6</a>&nbsp;显示了 OPF 文件的一个片段。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list6" style="color:rgb(29,88,209);"></a><strong>清单 6. OPF spine 的一部分</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
...
&lt;spine toc="ncx"&gt;
  &lt;itemref idref="cover" linear="no"/&gt;
  &lt;itemref idref="content"/&gt;
&lt;/spine&gt;
...
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">每个&nbsp;<code>itemref</code>&nbsp;元素都需要有一个&nbsp;<code>idref</code>&nbsp;属性，并且和 manifest 中的某个 ID 匹配。<code>toc</code>&nbsp;属性也是必需的。它引用 manifest 中表示内容 NCX 表文件名的 ID。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">spine 中的&nbsp;<code>linear</code>&nbsp;属性表明该项是作为线性阅读顺序中的一项，还是和先后次序无关。建议将封面定义为&nbsp;<code>linear=no</code>。符合 EPUB 规范的阅读系统将首先打开 spine 中<em>没有</em>&nbsp;设置为&nbsp;<code>linear=no</code>&nbsp;中的第一项。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="opf-guide" style="color:rgb(29,88,209);"></a><strong>Guide</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">OPF 内容文件的最后一部分是 guide。这一节是可选的，但最好保留。<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list7" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 7</a>&nbsp;显示了 guide 文件的部分内容。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list7" style="color:rgb(29,88,209);"></a><strong>清单 7. OPF guide 的一部分</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
...
&lt;guide&gt;
  &lt;reference href="cover.html" type="cover" title="Cover"/&gt;
&lt;/guide&gt;
...
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">guide 可以为 EPUB 阅读系统提供语义信息。manifest 定义了 EPUB 中的物理资源，spine 提供了这些资源的顺序信息，guide 负责解释这些部分的含义。下面是可以出现在 OPF guide 中的部分值：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;"> <strong><code>cover</code>：</strong>图书封面</li> 
    <li style="list-style-type:disc;"> <strong><code>title-page</code>：</strong>包含作者和出版商信息的页面</li> 
    <li style="list-style-type:disc;"> <strong><code>toc</code>：</strong>目录</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">完整的列表请参阅 OPF 2.0 规范（参见&nbsp;<a href="http://www.cnblogs.com/linlf03/admin/resources.html" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">参考资料</a>）。</p> 
   <div class="ibm-alternate-rule" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <hr>
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="ncx" style="color:rgb(29,88,209);"></a>内容的 NCX 表</p> 
   <div class="ibm-container ibm-alt-header dw-container-sidebar" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <a name="ncx-borreowed" style="color:rgb(29,88,209);"></a> 
    <h2 style="font-size:21px;line-height:1.5;">NCX 和 OPF 元数据的交叉</h2> 
    <div class="ibm-container-body"> 
     <p>由于 NCX 源自其他标准，使用 NCX 编码的信息和 OPF 内容之间存在重复。如果通过程序生成 EPUB，这算不上什么问题，因为同样的代码可输出到两个文件中。两个位置的信息要一致，不同的 EPUB 读者可能使用不同位置的值。</p> 
    </div> 
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">尽管 OCF 文件是作为 EPUB 本身的一部分定义的，但最后一个主要的元数据文件参照了不同的数字图书标准。DAISY 是一个专门为不能使用传统书籍的读者设计数据格式的组织，通常是因为视力受损或者不便于使用印刷的书籍。EPUB 借用了 DAISY 的 NCX DTD。NCX 定义了数字图书的目录表。复杂的图书中，目录表通常采用层次结构，包括嵌套的内容、章和节。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">使用 XML 编辑器创建 OEBPS/toc.ncx 并粘贴&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list8" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 8</a>&nbsp;所示的代码。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list8" style="color:rgb(29,88,209);"></a><strong>清单 8. 简单的 NCX 文件</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;!DOCTYPE ncx PUBLIC "-//NISO//DTD ncx 2005-1//EN" 
                 "http://www.daisy.org/z3986/2005/ncx-2005-1.dtd"&gt;
&lt;ncx xmlns="http://www.daisy.org/z3986/2005/ncx/" version="2005-1"&gt;
  &lt;head&gt;
    &lt;meta name="dtb:uid" content="urn:uuid:12345"/&gt;
    &lt;meta name="dtb:depth" content="1"/&gt;
    &lt;meta name="dtb:totalPageCount" content="0"/&gt;
    &lt;meta name="dtb:maxPageNumber" content="0"/&gt;
  &lt;/head&gt;
  &lt;docTitle&gt;
    &lt;text&gt;Hello World: My First EPUB&lt;/text&gt;
  &lt;/docTitle&gt;
  &lt;navMap&gt;
    &lt;navPoint id="navpoint-1" playOrder="1"&gt;
      &lt;navLabel&gt;
        &lt;text&gt;Book cover&lt;/text&gt;
      &lt;/navLabel&gt;
      &lt;content src="title.html"/&gt;
    &lt;/navPoint&gt;
    &lt;navPoint id="navpoint-2" playOrder="2"&gt;
      &lt;navLabel&gt;
        &lt;text&gt;Contents&lt;/text&gt;
      &lt;/navLabel&gt;
      &lt;content src="content.html"/&gt;
    &lt;/navPoint&gt;
  &lt;/navMap&gt;
&lt;/ncx&gt;
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="ncx-metadata" style="color:rgb(29,88,209);"></a><strong>NCX 元数据</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">DTD 要求 NCX&nbsp;<code>&lt;head&gt;</code>&nbsp;标记中包含四个&nbsp;<code>meta</code>&nbsp;元素：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;"> <strong><code>uid</code>：</strong>&nbsp;数字图书的惟一 ID。该元素应该和 OPF 文件中的&nbsp;<code>dc:identifier</code>对应。</li> 
    <li style="list-style-type:disc;"> <strong><code>depth</code>：</strong>反映目录表中层次的深度。该例只有一层，因此是&nbsp;<strong>1</strong>。</li> 
    <li style="list-style-type:disc;"> <strong><code>totalPageCount</code></strong>&nbsp;和&nbsp;<strong><code>maxPageNumber</code>：</strong>仅用于纸质图书，保留&nbsp;<strong>0</strong>&nbsp;即可。</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><code>docTitle/text</code>&nbsp;的内容是图书的标题，和 OPF 中的&nbsp;<code>dc:title</code>&nbsp;匹配。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="ncx-navmap" style="color:rgb(29,88,209);"></a><strong>NCX navMap</strong></p> 
   <div class="ibm-container ibm-alt-header dw-container-sidebar" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <a name="ncx-differences" style="color:rgb(29,88,209);"></a> 
    <h2 style="font-size:21px;line-height:1.5;">NCX 和 OPF spine 有什么不同？</h2> 
    <div class="ibm-container-body"> 
     <p>两者很容易混淆，因为两个文件都描述了文档的顺序和内容。要说明两者的区别，最简单的办法就是拿印刷书来打比方：OPF spine 描述了书中的各个章节是如何实际连接起来的，比方说翻过第一章的最后一页就看到第二章的第一页。NCX 在图书的一开始描述了目录。目录肯定会包含书中主要的章节，但是还可能包含没有单独分页的小节。</p> 
     <p>一条法则是 NCX 包含的&nbsp;<code>navPoint</code>&nbsp;元素通常比 OPF spine 中的&nbsp;<code>itemref</code>&nbsp;元素多。实际上，spine 中的所有项都会出现在 NCX 中，但 NCX 可能更详细。</p> 
    </div> 
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><code>navMap</code>&nbsp;是 NCX 文件中最重要的部分，定义了图书的目录。<code>navMap</code>&nbsp;包含一个或多个&nbsp;<code>navPoint</code>&nbsp;元素。每个&nbsp;<code>navPoint</code>&nbsp;都要包含下列元素：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;"> <code>playOrder</code>&nbsp;属性，说明文档的阅读顺序。和 OPF spine 中&nbsp;<code>itemref</code>元素的顺序相同。</li> 
    <li style="list-style-type:disc;"> <code>navLabel/text</code>元素，给出该章节的标题。通常是章的标题或者数字，如 “第一章”，或者 — 像这个例子一样 — “封面”。</li> 
    <li style="list-style-type:disc;"> <code>content</code>&nbsp;元素，它的&nbsp;<code>src</code>&nbsp;属性指向包含这些内容的物理资源。就是 OPF manifest 中声明的文件（也可使用片段标识符引用 XHTML 内容中的锚元素 — 比如&nbsp;<code>content.html#footnote1</code>）。</li> 
    <li style="list-style-type:disc;">还可以有一个或多个&nbsp;<code>navPoint</code>&nbsp;元素。NCX 使用嵌套的导航点表示层次结构的文档。</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">该文档的结构非常简单：只有两页，不存在嵌套关系。就是说有两个&nbsp;<code>navPoint</code>&nbsp;元素，它们的&nbsp;<code>playOrder</code>&nbsp;值按升序排列，从&nbsp;<strong>1</strong>&nbsp;开始。在 NCX 中可以命名这些章节，以便读者跳到电子图书不同的部分。</p> 
   <div class="ibm-alternate-rule" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <hr>
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="finalcontent" style="color:rgb(29,88,209);"></a>添加最后的内容</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">现在知道了 EPUB 需要的所有元数据，可以加入真正的图书内容了。可以使用 下载 的内容，也可以自己写，只要文件名和元数据匹配即可。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">然后创建下列文件和文件夹：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;"> <strong>title.html：</strong>图书的标题页。创建该文件并在其中包含引用封面图片的&nbsp;<code>img</code>&nbsp;元素，<code>src</code>&nbsp;的属性值为&nbsp;<code>images/cover.png</code>。</li> 
    <li style="list-style-type:disc;"> <strong>images：</strong>在 OEBPS 下创建该文件夹，然后复制给定的示例图片（或者创建自己的图片）并命名为&nbsp;<em>cover.png</em>。</li> 
    <li style="list-style-type:disc;"> <strong>content.html：</strong>图书的实际文字内容。</li> 
    <li style="list-style-type:disc;"> <strong>stylesheet.css：</strong>将该文件放在和 XHTML 文件相同的 OEBPS 目录中。该文件可以包含任意 CSS 声明，比如设置字体或者文字颜色。<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list10" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 10</a>&nbsp;给出了一个 CSS 文件的例子。</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="HTMLCSS" style="color:rgb(29,88,209);"></a><strong>EPUB 图书中的 XHTML 和 CSS</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list9" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 9</a>&nbsp;包含了一个有效的 EPUB 内容页。将其作为标题页（title.html），用一个类似的页面作为主要内容页（content.html）。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list9" style="color:rgb(29,88,209);"></a><strong>清单 9. 示例 title 页面（title.html）</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
  &lt;head&gt;
    &lt;title&gt;Hello World: My First EPUB&lt;/title&gt;
    &lt;link type="text/css" rel="stylesheet" href="stylesheet.css" /&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Hello World: My First EPUB&lt;/h1&gt;
    &lt;div&gt;&lt;img src="images/cover.png" alt="Title page"/&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">EPUB 的 XHTML 需要符合几条要求，和一般的 Web 开发不同：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;"> <strong>内容必须是有效的 XHTML 1.1</strong>：XHTML 1.0 Strict 和 XHTML 1.1 的主要区别是去掉了&nbsp;<code>name</code>属性（使用 ID 引用锚元素）。</li> 
    <li style="list-style-type:disc;"> <strong><code>img</code>&nbsp;元素只能引用电子图书的本地图片</strong>：该元素不能引用 Web 上的图片。</li> 
    <li style="list-style-type:disc;"> <strong>避免使用&nbsp;<code>script</code></strong>：EPUB 阅读器不一定支持 JavaScript 代码。</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">EPUB 支持 CSS 的方式有一些细微的差别，但是不会影响样式表的一般用法（详情参阅 OPS 规范）。<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list10" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 10</a>&nbsp;中的简单 CSS 文件可以设置基本的字体，并把标题设为红色。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list10" style="color:rgb(29,88,209);"></a><strong>清单 10. 电子图书的示例样式表（stylesheet.css）</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
body {
  font-family: sans-serif;     
}
h1,h2,h3,h4 {
  font-family: serif;     
  color: red;
}</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">有趣的是，EPUB 非常支持 CSS 2&nbsp;<code>@font-face</code>&nbsp;规则，允许内嵌字体。如果创建技术文档，这点可能无关紧要，但是如果用多种语言或针对特定领域编写 EPUB，能够指定具体的字体数据就很有必要了。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">现在已经准备好了创建 EPUB 图书所需的所有内容。下一节将按照 OCF 规范将图书装订起来，并看看如何进行验证。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;/////////////////////////////////////////////////////////////////////////////////////////////Page4</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">打包和检查 EPUB</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">现在，应当可以对 EPUB 包进行打包。这个包可以是您自己创建的一本新书，也可使用从本文 下载 部分获得的原始文件。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="epub-zip" style="color:rgb(29,88,209);"></a>用 ZIP 打包 EPUB 文件</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">EPUB 规范的 OEBPS Container Format 讨论了 EPUB 和 ZIP，最重要的几点是：</p> 
   <ul style="margin-left:30px;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <li style="list-style-type:disc;">档案中的第一个文件<strong>必须</strong>是 mimetype 文件（参见本教程 Mimetype一节）。mimetype 文件不能被压缩。这样非 ZIP 工具就能从 EPUB 包的第 30 个字节开始读取原始字节，从而发现 mimetype。</li> 
    <li style="list-style-type:disc;">ZIP 档案不能加密。EPUB 支持加密，但不是在 ZIP 文件这一层上。</li> 
   </ul>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">在类 UNIX® 操作系统上，使用 ZIP 2.3 可通过两个命令来创建 EPUB ZIP 文件，如&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list11" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 11</a>&nbsp;所示（这些命令假设当前工作目录为 EPUB 项目。）</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list11" style="color:rgb(29,88,209);"></a><strong>清单 11. 将 EPUB 打包成有效的 epub+zip 文件</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;width:678px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
$ zip -0Xq  my-book.epub mimetype
$ zip -Xr9Dq my-book.epub *
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">第一个命令创建了一个新的 ZIP 档案，并添加了没有进行压缩的 mimetype 文件。第二个命令添加其他内容。选项&nbsp;<code>-X</code>&nbsp;和&nbsp;<code>-D</code>&nbsp;最大限度地减少 .zip 文件中无关紧要的信息；<code>-r</code>&nbsp;递归地包含 META-INF 和 OEBPS 目录的内容。</p> 
   <div class="ibm-alternate-rule" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <hr>
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="epub-validate" style="color:rgb(29,88,209);"></a>EPUB 验证</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">虽然 EPUB 标准并不很难，但其 XML 文件必须符合特定的模式。如果使用模式感知的 XML 编辑器生成元数据和 XHTML，就能事半功倍。对 EpubCheck 包进行最后检查（参见&nbsp;<a href="http://www.cnblogs.com/linlf03/admin/resources.html" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">参考资料</a>）。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">Adobe 负责维护 EpubCheck 包，它是采用 Berkeley Software Distribution (BSD) 许可证的开源项目。它是一个可以作为独立工具、Web 应用程序运行的 Java 程序，或者可以将它集成到在 Java Runtime Environment (JRE) 1.5 或更高版本下运行的应用程序中。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">在命令行中运行非常简单。<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list12" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 12</a>&nbsp;给出了一个例子。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list12" style="color:rgb(29,88,209);"></a><strong>清单 12. 运行 EpubCheck 工具程序</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
$ java -jar /path/to/epubcheck.jar my-book.epub
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">如果没有创建辅助文件或者元数据文件出错，可能会看到&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list13" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 13</a>&nbsp;所示的错误消息。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list13" style="color:rgb(29,88,209);"></a><strong>清单 13. EpubCheck 错误</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
my-book.epub: image file OEBPS/images/cover.png is missing
my-book.epub: resource OEBPS/stylesheet.css is missing
my-book.epub/OEBPS/title.html(7): 'OEBPS/images/cover.png': 
     referenced resource missing in the package

Check finished with warnings or errors!
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">这时候可能需要设置 CLASSPATH 使它指向 EpubCheck 的安装位置，因为确实需要导入几个外部库。如果得到这样的消息则需要设置 CLASSPATH：</p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">org.xml.sax.SAXParseException: no implementation available for schema language 
   with namespace URI "http://www.ascc.net/xml/schematron"
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">如果验证成功，就会看到 “No errors or warnings detected（没有检测到错误或警告）”。祝贺您完成了第一个 EPUB！</p> 
   <div class="ibm-alternate-rule" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <hr>
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="epub-view" style="color:rgb(29,88,209);"></a>查看 EPUB</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">测试不仅仅是验证，还要保证书的外观看起来不错。样式表能正确工作吗？章节的逻辑顺序是否正确？书中是否包含了所有需要的内容？</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">有多重 EPUB 阅读器可供选择。<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#fig1" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">图 1</a>&nbsp;显示了 Adobe Digital Editions (ADE) 的屏幕截图，这是最常用的 EPUB 阅读器。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="fig1" style="color:rgb(29,88,209);"></a><strong>图 1. ADE 中显示的 EPUB</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><img src="https://pic002.cnblogs.com/images/2011/158914/2011121515390111.jpg" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">字体颜色和图像都显示出来了，不错。ADE 未能用 sans-serif 字体正确地显示标题，不过这可能是 CSS 的问题。这时候最好换一个阅读器试试。<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#fig2" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">图 2</a>&nbsp;是用我自己编写的、开放源代码的、基于 Web 的 EPUB 阅读器 Bookworm 显示的同一本书。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="fig2" style="color:rgb(29,88,209);"></a><strong>图 2. 在 Bookworm 中显示 EPUB</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><img src="https://pic002.cnblogs.com/images/2011/158914/2011121515391977.jpg" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">这里的问题在于 ADE 不支持这种特殊声明。如果数字图书的格式非常重要，那么就必须了解不同阅读软件的特点。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">前面我们费了很大力气手工创建了一个简单的 EPUB，现在看看如何将一种常见的 XML 文档 DocBook 转换成 EPUB。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">/////////////////////////////////////////////////////////////////////////////////////////////Page5</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">从 DocBook 到 EPUB</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">DocBook 是需要维护大型技术文档的开发人员常用的选择。与传统字处理程序生成的文件不同，可以使用基于文本的版本控制系统管理 DocBook 输出。由于 DocBook 是 XML，很容易将其转换成不同输出格式。2008 年夏天出现了正式的 DocBook XSL 项目，将 EPUB 作为一种输出格式。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="docbook" style="color:rgb(29,88,209);"></a>使用 XSLT 运行 DocBook-to-EPUB 管道</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">从一个简单 DocBook 文档开始，如&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list14" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 14</a>&nbsp;所示。该文档的类型为&nbsp;<code>book</code>，包括前言、两个章节以及标题页面中内联显示的图像。图像和 DocBook 源文件的目录相同。可以自己创建该文件和标题页，也可 下载 本文提供的例子。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list14" style="color:rgb(29,88,209);"></a><strong>清单 14. 简单的 DocBook 图书</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;width:678px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
&lt;?xml version="1.0" encoding="utf-8"?`&gt;  
&lt;book&gt;
  &lt;bookinfo&gt;
    &lt;title&gt;My EPUB book&lt;/title&gt;
    &lt;author&gt;&lt;firstname&gt;Liza&lt;/firstname&gt;
            &lt;surname&gt;Daly&lt;/surname&gt;&lt;/author&gt;
    &lt;volumenum&gt;1234&lt;/volumenum&gt;
  &lt;/bookinfo&gt;
  &lt;preface id="preface"&gt;  
    &lt;title&gt;Title page&lt;/title&gt;
    &lt;figure id="cover-image"&gt;
      &lt;title&gt;Our EPUB cover image icon&lt;/title&gt;
      &lt;graphic fileref="cover.png"/&gt;
    &lt;/figure&gt;
  &lt;/preface&gt;
  &lt;chapter id="chapter1"&gt; 
    &lt;title&gt;This is a pretty simple DocBook example&lt;/title&gt;
    &lt;para&gt;
      Not much to see here. 
    &lt;/para&gt;
  &lt;/chapter&gt;
  &lt;chapter id="end-notes"&gt; 
    &lt;title&gt;End notes&lt;/title&gt;
    &lt;para&gt;
      This space intentionally left blank.
    &lt;/para&gt;
  &lt;/chapter&gt;
&lt;/book&gt;
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">然后从 参考资料 下载最新版本的 DocBook XSL 样式表，并安装 xsltproc 或 Saxon 之类的 XSLT 处理程序。本文使用 xsltproc，大多数类 UNIX 系统上都能找到。转换 DocBook 文件，只需要用 DocBook XSL 中包含的 EPUB 模块运行该文件即可，如&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list15" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 15</a>&nbsp;所示。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list15" style="color:rgb(29,88,209);"></a><strong>清单 15. 将 DocBook 转化成 EPUB</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
$ xsltproc /path/to/docbook-xsl-1.74.0/epub/docbook.xsl docbook.xml
Writing OEBPS/bk01-toc.html for book
Writing OEBPS/pr01.html for preface(preface)
Writing OEBPS/ch01.html for chapter(chapter1)
Writing OEBPS/ch02.html for chapter(end-notes)
Writing OEBPS/index.html for book
Writing OEBPS/toc.ncx
Writing OEBPS/content.opf
Writing META-INF/container.xml
</pre></td>
     </tr>
    </tbody>
   </table>
   <div class="ibm-container ibm-alt-header dw-container-sidebar" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <a name="docbook-xsl-message" style="color:rgb(29,88,209);"></a> 
    <h2 style="font-size:21px;line-height:1.5;">定制 DocBook XSL</h2> 
    <div class="ibm-container-body"> 
     <p>DocBook-to-EPUB 转换管道仍然比较新，可能需要定制 XSLT 以得到需要的结果。</p> 
    </div> 
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">然后添加 mimetype 文件并建立 epub+zip 档案。<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list16" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 16</a>&nbsp;显示了这三个命令和通过 EpubCheck 验证程序的结果。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list16" style="color:rgb(29,88,209);"></a><strong>清单 16. 从 DocBook 创建 EPUB 档案</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;width:484px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
$ echo "application/epub+zip" &gt; mimetype
$ zip -0Xq  my-book.epub mimetype
$ zip -Xr9D my-book.epub *
$ java -jar epubcheck.jar my-book.epub 
No errors or warnings detected
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">太简单了！<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#fig3" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">图 3</a>&nbsp;显示了 ADE 中的结果。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="fig3" style="color:rgb(29,88,209);"></a><strong>图 3. ADE 显示了从 DocBook 转化得到的 EPUB</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><img src="https://pic002.cnblogs.com/images/2011/158914/2011121515393790.jpg" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <div class="ibm-alternate-rule" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"> 
    <hr>
   </div> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="ade-docbook" style="color:rgb(29,88,209);"></a>利用 Python 和 lxml 实现 DocBook-to-EPUB 转换自动化</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">DocBook XSL 大大降低了生成 EPUB 的复杂性，但是在 XSLT 之外还有几个步骤要执行。最后一节给出的 Python 示例程序能够生成有效的 EPUB 包。本教程显示了不同的方法，可 下载 完整的 docbook2epub.py 程序。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">可使用不同的 Python XSLT 库，我喜欢 lxml。它不但提供了 XSLT 1.0 必要的功能，而且解析效率高，完全支持 XPath 1.0，提供了专门处理 HTML 的扩展。如果喜欢不同的库或者使用 Python 以外的编程语言，修改这些例子也很简单。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="xslt-docbook" style="color:rgb(29,88,209);"></a><strong>用 lxml 调用 DocBook XSL</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">使用 lxml 调用 XSLT 的最有效办法是事先解析 XSLT，然后创建反复使用的转换器。这样很方便，因为我的 DocBook-to-EPUB 需要转换多个 DocBook 文件。如&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list17" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 17</a>&nbsp;所示。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list17" style="color:rgb(29,88,209);"></a><strong>清单 17. 使用 lxml 运行 DocBook XSL</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
import os.path
from lxml import etree

def convert_docbook(docbook_file):
    docbook_xsl = os.path.abspath('docbook-xsl/epub/docbook.xsl')
    # Give the XSLT processor the ability to create new directories
    xslt_ac = etree.XSLTAccessControl(read_file=True, 
                                      write_file=True, 
                                      create_dir=True, 
                                      read_network=True, 
                                      write_network=False)
    transform = etree.XSLT(etree.parse(docbook_xsl), access_control=xslt_ac)
    transform(etree.parse(docbook_file))
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">DocBook XSL 中的 EPUB 模块创建输出文件本身，因此转换过程什么也不返回。相反，DocBook 在当前工作目录中创建了两个文件夹（META-INF 和 OEBPS），包含转换的结果。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="xslt-docbook-resources" style="color:rgb(29,88,209);"></a><strong>将图片和其他资源复制到档案中</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">DocBook XSL 不会对文档中使用的任何图片执行操作，仅仅创建元数据文件和要呈现的 XHTML。由于 EPUB 规范要求 content.opf manifest 列出所有资源，可以预料到 manifest 将寻找原始 DocBook 文件引用的任何图片。<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list18" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 18</a>&nbsp;显示了这种技术，其中假定&nbsp;<code>path</code>&nbsp;变量包含 DocBook XSLT 生成的、当前所处理的 EPUB 的路径。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list18" style="color:rgb(29,88,209);"></a><strong>清单 18. 解析 OPF 内容文件以寻找缺失的资源</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
import os.path, shutil
from lxml import etree

def find_resources(path='/path/to/our/epub/directory'):
    opf = etree.parse(os.path.join(path, 'OEBPS', 'content.opf'))

    # All the opf:item elements are resources
    for item in opf.xpath('//opf:item', 
                          namespaces= { 'opf': 'http://www.idpf.org/2007/opf' }):

        # If the resource was not already created by DocBook XSL itself, 
        # copy it into the OEBPS folder
        href = item.attrib['href']
        referenced_file = os.path.join(path, 'OEBPS', href):
        if not os.path.exists(referenced_file):
            shutil.copy(href, os.path.join(path, 'OEBPS'))
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="xslt-docbook-mimetype" style="color:rgb(29,88,209);"></a><strong>自动创建 mimetype</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">DocBook XSL 不会创建 mimetype 文件，不过&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list19" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 19</a>&nbsp;中所示的代码可以完成这项任务。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list19" style="color:rgb(29,88,209);"></a><strong>清单 19. 创建 mimetype 文件</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
def create_mimetype(path='/path/to/our/epub/directory'):
    f = '%s/%s' % (path, 'mimetype')
    f = open(f, 'w')
    # Be careful not to add a newline here
    f.write('application/epub+zip')
    f.close()
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="xslt-docbook-zip" style="color:rgb(29,88,209);"></a><strong>用 Python 创建 EPUB 包</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">现在只需要将文件打包成有效的 EPUB ZIP 包。需要分两步：将未经压缩的 mimetype 文件作为第一个文件加进去，然后添加其他目录。如&nbsp;<a href="http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html#list20" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">清单 20</a>&nbsp;所示。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><a name="list20" style="color:rgb(29,88,209);"></a><strong>清单 20. 使用 Python zipfile 模块创建 EPUB 包</strong></p> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">					
import zipfile, os

def create_archive(path='/path/to/our/epub/directory'):
    '''Create the ZIP archive.  The mimetype must be the first file in the archive 
    and it must not be compressed.'''

    epub_name = '%s.epub' % os.path.basename(path)

    # The EPUB must contain the META-INF and mimetype files at the root, so 
    # we'll create the archive in the working directory first and move it later
    os.chdir(path)    

    # Open a new zipfile for writing
    epub = zipfile.ZipFile(epub_name, 'w')

    # Add the mimetype file first and set it to be uncompressed
    epub.write(MIMETYPE, compress_type=zipfile.ZIP_STORED)
    
    # For the remaining paths in the EPUB, add all of their files
    # using normal ZIP compression
    for p in os.listdir('.'):
        for f in os.listdir(p):
            epub.write(os.path.join(p, f)), compress_type=zipfile.ZIP_DEFLATED)
    epub.close()
</pre></td>
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">好了！<strong>切记要进行验证。</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>/////////////////////////////////////////////////////////////////////////////////////////////Page6</strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">结束语</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">上一节 中的 Python 脚本仅仅是充分实现 EPUB 转换自动化的第一步。为了简化起见，没有涉及一些常见的情况，比如任意嵌套的路径、样式表或者内嵌字体。Ruby 爱好者可以看看 DocBook XSL 分发包中所含的&nbsp;<code>dbtoepub</code>，方法与此类似。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">因为 EPUB 还是一种比较年轻的格式，很多有效的转换方法还等待人们去创造。所幸的是，多数结构化标记，如 reStructuredText 或 Markdown 都已经存在生成 HTML 或者 XHTML 的渠道了；稍加修改来生成 EPUB 应该非常容易，尤其是有了本文所示的 DocBook-to-EPUB Python 或 Ruby 脚本这些例子以后。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">因为 EPUB 基本上就是 ZIP 和 XHTML，与其使用 .zip 文件，没有理由不使用 EPUB 来分发文档。拥有 EPUB 阅读器的读者可从传统元数据和自动目录表收益，没有阅读器的读者也可将其作为一般 ZIP 文件并在浏览器中查看 XHTML 内容。考虑将 EPUB 生成的代码添加到各类文档系统中，如 Javadoc 或 Perldoc。EPUB 是为具有图书长度的文档设计的，因此非常适合越来越多的在线或者渐进式编程图书。</p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;涉及下载请参考<strong style="color:rgb(29,88,209);text-decoration:none;"><a href="http://www.ibm.com/developerworks/cn/xml/tutorials/x-epubtut/index.html" rel="nofollow" style="color:rgb(29,88,209);text-decoration:none;">原文地址</a></strong></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><br></p> 
   <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><br></p> 
   <p><font><span style="font-size:12px;">本文转自Work Hard Work Smart博客园博客，原文链接：http://www.cnblogs.com/linlf03/archive/2011/12/15/2285953.html，如需转载请自行联系原作者</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
