<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ASPJpeg和ASPUpload组件的一些属性和方法 « NotBeCN</title>
  <meta name="description" content="                  自己整理出来的ASPJpeg和ASPUpload组件的一些属性和方法                 aspUpload                 Set Upload = Server.CreateObject("Persits.Upload")       创建对象 ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/05/28/weixin_34018169_90130127.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">ASPJpeg和ASPUpload组件的一些属性和方法</h1>
    <p class="post-meta">May 28, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"> 
    <h4 style="font-size:14px;color:rgb(51,51,51);">自己整理出来的ASPJpeg和ASPUpload组件的一些属性和方法</h4> 
    <div class="bvMsg"> 
     <div>
      aspUpload
     </div> 
     <div>
      Set Upload = Server.CreateObject("Persits.Upload")
      <br> 创建对象
     </div> 
     <div>
      方法：
      <br> save "path"
      <br> 保存到指定路径
      <br> 如果不指定路径则保存在内存中
     </div> 
     <div>
      saveas "path"
      <br> 把内存中的文件保存到指定位置
     </div> 
     <div>
      Upload.CreateDirectory Path, True
      <br> 建立文件夹
     </div> 
     <div>
      Upload.OpenFile(SavePath)
      <br> 打开指定路径文件进行操作
     </div> 
     <div>
      Upload.DeleteFile FilePath
      <br> 删除指定文件
      <br> －－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
      <br> 属性：
      <br> Set File = Upload.Files("FILE1")
      <br> 创建文件对象
     </div> 
     <div>
      files
      <br> 获取表单文件控件元素，可以用for each 遍历
      <br> For Each File in Upload.Files
      <br> &nbsp;Response.Write File.Name &amp; "= " &amp; File.Path &amp; " (" &amp; File.Size &amp;" bytes)&lt;BR&gt;"
      <br> Next
     </div> 
     <div>
      file.Filename&nbsp;获取上传文件名
      <br> File.Ext&nbsp;获取文件扩展名
      <br> file.path&nbsp;获取上传保存路径
      <br> file.size&nbsp;获取上传文件大小
      <br> File.Delete&nbsp;删除已经上传的文件
      <br> File.Copy&nbsp;复制一个文件到指定路径
      <br> File.ImageType&nbsp;指定上传上文件类型默认为GIF, JPEG, BMP, PNG 未知UNKNOWN
      <br> File.ImageWidth&nbsp;获取上传图片宽
      <br> File.ImageHeight获取上传图片高
     </div> 
     <div>
      Upload.Form&nbsp;获取表单所有元素
     </div> 
     <div>
      File.MD5Hash&nbsp;使用MD5加密编码，唯一值可做
      <br> File.Binary&nbsp;将转换过的二进制文件写入数据库
     </div> 
     <div>
      Upload.CodePage = 65001&nbsp; 支持UTF-8支持中文
      <br> SetMaxSize 字节, True
      <br> 最大能上传总字节，同时上传多个时计为总和
     </div> 
     <div>
      Count = Upload.Save "path"
      <br> 获取上传的文件个数
     </div> 
     <div>
      &nbsp;
     </div> 
     <div>
      &nbsp;
     </div> 
     <div>
      一、图片缩略
     </div> 
     <div>
      &lt;%&nbsp;
      <br> Set Jpeg = Server.CreateObject("Persits.Jpeg") 调用组件&nbsp;
      <br> Path = Server.MapPath("images") &amp; "\clock.jpg" 待处理图片路径&nbsp;
      <br> Jpeg.Open Path 打开图片&nbsp;
      <br> 高与宽为原图片的1/2&nbsp;
      <br> Jpeg.Width = Jpeg.OriginalWidth / 2&nbsp;
      <br> Jpeg.Height = Jpeg.OriginalHeight / 2&nbsp;
      <br> 保存图片&nbsp;
      <br> Jpeg.Save Server.MapPath("images") &amp; "\clock_small.jpg"&nbsp;
      <br> %&gt;&nbsp;
      <br> &lt;IMG SRC="images/clock_small.jpg"&gt; 查看处理的图片
     </div> 
     <div>
      &nbsp;
     </div> 
     <div>
      二、图片水印
     </div> 
     <div>
      &lt;%&nbsp;
      <br> Set Jpeg = Server.CreateObject("Persits.Jpeg")&nbsp;
      <br> Jpeg.Open Server.MapPath("images/dodge_viper.jpg")&nbsp;
      <br> 开始写文字&nbsp;
      <br> Jpeg.Canvas.Font.Color = &amp;000000' red 颜色&nbsp;
      <br> Jpeg.Canvas.Font.Family = "Courier New" 字体&nbsp;
      <br> Jpeg.Canvas.Font.Bold = True 是否加粗&nbsp;
      <br> Jpeg.Canvas.Print 10, 10, "Copyright (c) XYZ, Inc."&nbsp;
      <br> 打印坐标x 打印坐标y 需要打印的字符&nbsp;
      <br> 以下是对图片进行边框处理&nbsp;
      <br> Jpeg.Canvas.Pen.Color = &amp;H000000' black 颜色&nbsp;
      <br> Jpeg.Canvas.Pen.Width = 2 画笔宽度&nbsp;
      <br> Jpeg.Canvas.Brush.Solid = False 是否加粗处理&nbsp;
      <br> Jpeg.Canvas.Bar 1, 1, Jpeg.Width, Jpeg.Height&nbsp;
      <br> 起始X坐标 起始Y坐标 输入长度 输入高度&nbsp;
      <br> Jpeg.Save Server.MapPath("images/dodge_viper_framed.jpg") 保存&nbsp;
      <br> %&gt;
     </div> 
     <div>
      &nbsp;
     </div> 
     <div>
      三、安全码
     </div> 
     <div>
      安全玛的道理和加水印差不多，很多朋友问我要具体的代码技术，在这里我就写出来和大家分享，一般人我还不告诉他。呵呵。&nbsp;
      <br> &lt;%&nbsp;
      <br> 生成安全码的函数&nbsp;
      <a href="http://www.knowsky.com/" rel="nofollow" style="color:rgb(7,93,179);">www.knowsky.com</a>
      <br> function make_randomize(max_len,w_n) max_len 生成长度，w_n：0 可能包含字母，1：只为数字&nbsp;
      <br> randomize&nbsp;
      <br> for intcounter=1 to max_len&nbsp;
      <br> whatnext=int((1-0+1)*rnd+w_n)&nbsp;
      <br> if whatnext=0 then&nbsp;
      <br> upper=122&nbsp;
      <br> lower=97&nbsp;
      <br> else&nbsp;
      <br> upper=57&nbsp;
      <br> lower=48&nbsp;
      <br> end if&nbsp;
      <br> strnewpass=strnewpass &amp; chr(int((upper-lower+1)*rnd)+lower)&nbsp;
      <br> next&nbsp;
      <br> make_randomize=strnewpass&nbsp;
      <br> end function&nbsp;
      <br> %&gt;
     </div> 
     <div>
      生成安全码的图片。当然你要预先准备一张背景图哦
     </div> 
     <div>
      &lt;%random_num=make_randomize(4,1) 生成4位数字的安全码&nbsp;
      <br> session("random_num")=random_num 为什么调用session，没有session的安全码是完全没有意义的。呵呵
     </div> 
     <div>
      Set Jpeg = Server.CreateObject("Persits.Jpeg") 调用组件&nbsp;
      <br> Jpeg.Open Server.MapPath("infos/random_pic/random_index.gif") 打开准备的图片&nbsp;
      <br> Jpeg.Canvas.Font.Color = &amp;H006699&nbsp;
      <br> Jpeg.Canvas.Font.Family = "Arial Black"&nbsp;
      <br> Jpeg.Canvas.Font.Bold = false&nbsp;
      <br> Jpeg.Canvas.PrintText 0, -2, random_num&nbsp;
      <br> jpeg.save Server.MapPath("infos/random_pic/random_index.bmp") 保存&nbsp;
      <br> %&gt; &lt;img src="infos/random_pic/random_index.bmp" border="0" align="absmiddle"&gt;&nbsp;
      <br> 自己做做看。呵呵。
     </div> 
     <div>
      &nbsp;
     </div> 
     <div> 
      <br> 四、图片切割
     </div> 
     <div>
      一直以来，对aspjpeg不了解的人以为是无法用它来进行切割的。&nbsp;
      <br> 其实有这样的一个方法的&nbsp;
      <br> crop x1,y1,x2,y2&nbsp;
      <br> 切割长方型左上角x坐标，y坐标 右下角x坐标 y坐标&nbsp;
      <br> 下面我就做一个演示哈&nbsp;
      <br> Set Jpeg = Server.CreateObject("Persits.Jpeg")&nbsp;
      <br> jpeg.open server.MapPath("/pic/1.gif")&nbsp;
      <br> jpeg.width=70&nbsp;
      <br> Jpeg.Height = Jpeg.OriginalHeight*70 / jpeg.Originawidth&nbsp;
      <br> jpeg.crop 0,0,70,52 开始切割其实是把超过52象素的下部分去掉&nbsp;
      <br> jpeg.save server.MapPath("/temp_pic/small_1.gif") 保存&nbsp;
      <br> 怎么样，很简单吧
     </div> 
     <div>
      &nbsp;
     </div> 
     <div>
      五、图片合并
     </div> 
     <div>
      我们这里是要把logo图片加到dodge_viper.jpg图片上去&nbsp;
      <br> 其实，图片合并的方法也可以用来动态打水印哦&nbsp;
      <br> Set Photo = Server.CreateObject("Persits.Jpeg")&nbsp;
      <br> PhotoPath = Server.MapPath("images") &amp; "\dodge_viper.jpg"&nbsp;
      <br> Photo.Open PhotoPath&nbsp;
      <br> Set Logo = Server.CreateObject("Persits.Jpeg")&nbsp;
      <br> LogoPath = Server.MapPath("images") &amp; "\clock.jpg"&nbsp;
      <br> Logo.Open LogoPath
     </div> 
     <div>
      Logo.Width = 70&nbsp;
      <br> Logo.Height = Logo.Width * Logo.OriginalHeight / Logo.OriginalWidth
     </div> 
     <div>
      Photo.DrawImage 0, 0, Logo
     </div> 
     <div>
      Photo.SendBinary 这里用了sendBinary的输出方法。当然，你也可以先保存更改后的dodge_viper.jpg，再输入也可以。我个人不大喜欢用sendBinary方法，在网速慢的时候容易出错。在速度方面也不怎样。呵呵。
     </div> 
     <div>
      &nbsp;
     </div> 
     <div>
      六、数据库支持
     </div> 
     <div>
      这里不多说了。其实就是Binary方法，大家知道图片存进数据库只能存为二进制的文件的。所以代码就懒的写了。
     </div> 
     <div>
      &nbsp;
     </div> 
     <div>
      七、更多方法介绍
     </div> 
     <div>
      Canvas.Line(Left, Top, Right, Bottom)&nbsp;
      <br> 画一条直线&nbsp;
      <br> Canvas.Ellipse(Left, Top, Right, Bottom)&nbsp;
      <br> 画出一个椭圆&nbsp;
      <br> Canvas.Circle(X, Y, Radius)&nbsp;
      <br> 画出一个圆&nbsp;
      <br> Canvas.Bar(Left, Top, Right, Bottom)&nbsp;
      <br> 画出一个长方形，上面有代码介绍了&nbsp;
      <br> Canvas.Font.ShadowColor&nbsp;
      <br> 文字阴影颜色&nbsp;
      <br> Canvas.Font.ShadowXOffset As Long&nbsp;
      <br> 阴影X坐标设定&nbsp;
      <br> Canvas.Font.ShadowYOffset As Long&nbsp;
      <br> Y坐标设定&nbsp;
      <br> Canvas.Font.BkMode As String&nbsp;
      <br> 文字背景
     </div> 
     <div>
      上次做过图片水印，效果很差，没办法把图片弄成背景透明的，用背景透明gif会自动填充成白色。用去掉某种颜色的功能，图片颜色总是不纯，出来的效果斑斑点点。今天灵机一动，把这两个结合起来，用背景透明的gif，并且抽取水印底色，果然成功了！
     </div> 
     <div>
      &nbsp;&nbsp;&nbsp; ogvbox.Canvas.Pen.Color&nbsp; = &amp;H000000&nbsp;&nbsp;
      <a>\\\'//</a>&nbsp;边框的颜色
      <br> &nbsp;&nbsp;&nbsp; ogvbox.Canvas.Pen.Width&nbsp; = 1&nbsp;&nbsp;&nbsp;&nbsp;
      <a>\\\'//</a>&nbsp;边框的粗细
      <br> &nbsp;&nbsp;&nbsp; ogvbox.Canvas.Brush.Solid = False&nbsp;&nbsp;&nbsp;
      <a>\\\'//</a>&nbsp;图片边框内是否填充颜色
      <br> &nbsp;&nbsp;&nbsp; ogvbox.DrawImage ogvbox.Width-210, ogvbox.Height-74, Logobox&nbsp; ,0.3,&amp;HFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;
      <a>\\\'//</a>&nbsp;加入图片的位置坐标（添加水印图片），我用图片大小减去水印大小，把水印加在右下角。参数顺序为：水平坐标，垂直坐标，水印图片地址，水银透明度，抽取颜色（&amp;H表示16进制）
      <br> &nbsp;&nbsp;&nbsp; ogvbox.Canvas.Bar 0, 0, ogvbox.Width, ogvbox.Height&nbsp;
      <a>\\\'//</a>&nbsp;图片边框线的位置坐标和大小
      <br> &nbsp;&nbsp;&nbsp; ogvbox.Save Server.MapPath(imagename)&nbsp;&nbsp;
      <a>\\\'//</a>&nbsp;生成文件
     </div> 
     <div> 
      <br> \'//------Pollener.com AspJpeg组件的预览和水印生成------开始------
      <br> \'创建预览图片:call CreateView(原始文件的路径,预览文件名及路径)
      <br> Sub CreateView(imagename,tempFilename)
      <br> \'定义变量。
      <br> Dim PreviewImageFolderName
      <br> Dim ogvbox,objFont
      <br> Dim Logobox,LogoPath
      <br> LogoPath = Server.MapPath("images") &amp; "
      <a>\\shuiyin.gif</a>"&nbsp; \'//加入图片所在路径及文件名(我的是论坛
      <a>\\images\\shuiyin.gif</a>)。
     </div> 
     <div>
      Select Case upload_ViewType
      <br> Case 0
      <br> \'---------------------CreatePreviewImage---------------
      <br> set ogvbox = Server.CreateObject("CreatePreviewImage.cGvbox")
      <br> ogvbox.SetSavePreviewImagePath=Server.MapPath(tempFilename)&nbsp;&nbsp; \'预览图存放路径。
      <br> ogvbox.SetPreviewImageSize =SetPreviewImageSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \'预览图宽度。
      <br> ogvbox.SetImageFile = trim(Server.MapPath(imagename))&nbsp;&nbsp;&nbsp; \'imagename原始文件的物理路径。
      <br> \'创建预览图的文件。
      <br> If ogvbox.DoImageProcess=false Then
      <br> Response.write "生成预览图错误:"&amp; ogvbox.GetErrString
      <br> End If
      <br> Case 1
      <br> \'---------------------AspJpegV1.2---------------
      <br> Set Logobox = Server.CreateObject("Persits.Jpeg")
      <br> \'//建议不要图片和文字水印同时使用，本代码为使用图片水印。
      <br> Logobox.Open LogoPath&nbsp; \'//读取添加的图片。
     </div> 
     <div>
      \'//重新设置图片的大小。
      <br> Logobox.Width = 186&nbsp; \'//用做水印的图片的宽度值（像素）。
      <br> Logobox.Height = 52&nbsp; \'//用做水印的图片的高度值（像素）。
      <br> \'//添加水印。
      <br> Set ogvbox = Server.CreateObject("Persits.Jpeg")
      <br> \'//读取要处理的原文件。
      <br> ogvbox.Open Trim(Server.MapPath(imagename))
      <br> If ogvbox.OriginalWidth&lt;Cint(ImageWidth) or ogvbox.Originalheight&lt;Cint(ImageHeight) Then
      <br> &nbsp; F_Viewname=""
      <br> &nbsp; Set ogvbox = Nothing
      <br> &nbsp; Exit Sub
      <br> Else
      <br> IF ImageMode&lt;&gt;"" and FileExt&lt;&gt;"gif" Then&nbsp; \'//如果将这行改为IF ImageMode&lt;&gt;"" Then则可给上传的GIF图片也加上水印，但是那些动画的GIF在加了水印以后就只剩第一桢了，根据你的需求酌情处理吧。
     </div> 
     <div>
      \'//关于修改字体及文字颜色的。
      <br> \'//ogvbox.Canvas.Font.Color = &amp;H0000FF&nbsp; \'//水印文字的颜色，&amp;H后面输入色彩值。
      <br> \'//ogvbox.Canvas.Font.Size = 18&nbsp; \'//水印文字的大小。
      <br> \'//ogvbox.Canvas.Font.Family = "Arial"&nbsp; \'//水印文字的字体名称。
      <br> \'//ogvbox.Canvas.Font.ShadowColor = &amp;H000000&nbsp; \'//水印文字的阴影色彩。
      <br> \'//ogvbox.Canvas.Font.ShadowXoffset = 1&nbsp; \'//水印文字阴影向右偏移的像素值，输入负值则向左偏移。
      <br> \'//ogvbox.Canvas.Font.ShadowYoffset = 1&nbsp; \'//水印文字阴影向下偏移的像素值，输入负值则向右偏移。
      <br> \'//ogvbox.Canvas.Font.Quality = 3&nbsp; \'//水印文字的清晰度，从0～4，变换不是很大，建议用2或3。
      <br> \'//ogvbox.Canvas.Font.Bold = True&nbsp; \'//水印文字是否为粗体，True=粗体 False=正常。
     </div> 
     <div>
      \'ogvbox.Canvas.Print 10, 10, ImageMode&nbsp; \'//水印文字的起始坐标（像素）。
      <br> ogvbox.Canvas.Pen.Color&nbsp; = &amp;H000000&nbsp; \'//增加水印后图片的边框色彩。
      <br> ogvbox.Canvas.Pen.Width&nbsp; = 1&nbsp;&nbsp; \'//增加水印后图片的边框宽度。
      <br> ogvbox.Canvas.Brush.Solid = False&nbsp; \'//边框内是否填充颜色，你可以试试看值为True时的效果^o^
      <br> ogvbox.DrawImage ogvbox.width-186, ogvbox.height-52, Logobox, 0.5&nbsp; \'//水印图片的起始坐标，我这里ogvbox.width-186, ogvbox.height-52,表示图片在右下角，因为我的图片宽是186，高是52，所以这样写，你可以根据自己的图片进行调整。0.5是透明度，我这里是半透明，1表示不透明，你也可以试试看0.7或者0.8的效果。
      <br> ogvbox.Canvas.Bar 0, 0, ogvbox.Width, ogvbox.Height&nbsp; \'//水印可用的范围。我这里表示左上角至右下角，即整张图片的任意为止都可加水印。
      <br> ogvbox.Save Server.MapPath(imagename)&nbsp; \'//根据以上参数生成增加水印后的图片文件。
      <br> &nbsp;&nbsp; End If
      <br> &nbsp;&nbsp; ogvbox.Width = ImageWidth
      <br> &nbsp;&nbsp; ogvbox.height = ImageHeight
      <br> &nbsp;&nbsp; \'ogvbox.height = ogvbox.Originalheight*ImageWidth\\ogvbox.OriginalWidth
      <br> &nbsp;&nbsp; ogvbox.Sharpen 1, 120
      <br> &nbsp;&nbsp; ogvbox.Save Server.MapPath(tempFilename)&nbsp; \'//生成增加水印后的图片的预览图片。
      <br> &nbsp; End If
      <br> &nbsp; Set Logobox=Nothing
     </div> 
     <div>
      &nbsp;
     </div> 
     <div>
      &lt;%
      <br> \'函数功能：远程图片自动保存到本地服务器，并利用aspjpeg为图片加上水印
      <br> \'（注意：请先在目录下创建images目录，用来保存临时图片）
      <br> \'程序落伍者:我是星星
      <br> \'加入落伍第二份原创程序,HOHO,今天一定要落伍类,5.6日注册,5.7日落伍,庆祝一下!
      <br> \'本程序需要在服务器上安装"aspjpeg组件"否则无法正常使用
      <br> \'也可以只取\'\'\'\'\'22222222\'\'\'\'\'\'\'以上的部分,这部分可以保存图片,第二部分是进行水印增加
      <br> \'使用方法,请保存为saveimg.asp
      <br> \'saveimg.asp?url=UploadFile/2005-6/2005615155335734.gif&nbsp; 即可以取下图片啦,HOHO. 其他需要加的功能,大家自己扩展好啦
      <br> \'如何获取其他后缀名的文件呢? 当然也可以啦
      <br> \'(jpg|gif|png|bmp)改成(mp3)明白吧? 就是取mp3后缀的文件名.以此类推. 嘻嘻
      <br> \'俺要落伍. 发了二份原创,一份是惊云下载系统偷天空时防止出现连接来自天空软件站的程序,有需要的在落伍里面搜索我的贴子
      <br> \'不要忘了使用时在目录下建images的保存目录哦
     </div> 
     <div>
      Server.ScriptTimeOut=99999
     </div> 
     <div>
      const savepath="images" \'图片保存路径
      <br> url=request("url")
     </div> 
     <div>
      &nbsp;
     </div> 
     <div>
      function myreplace(str)
      <br> newstr=str
      <br> set objregEx = new RegExp
      <br> objregEx.IgnoreCase = true
      <br> objregEx.Global = true
      <br> objregEx.Pattern = "
      <a href="/?)%5C%5C.(jpg%7Cgif%7Cpng%7Cbmp" rel="nofollow" style="color:rgb(7,93,179);">http://(.+?)\\.(jpg|gif|png|bmp</a>)" \'定义文件后缀
      <br> set matches = objregEx.execute(str)
      <br> for each match in matches
      <br> newstr=replace(newstr,match.value,saveimg(match.value))
      <br> next
      <br> myreplace=newstr
      <br> end function
     </div> 
     <div>
      function saveimg(url)
      <br> temp=split(url,".")
      <br> \'以下是用时间与随机数重命名文件名
      <br> randomize
      <br> ranNum=int(90000*rnd)+10000
      <br> filename=year(now)&amp;month(now)&amp;day(now)&amp;hour(now)&amp;minute(now)&amp;second(now)&amp;ranNum&amp;"."&amp;temp(ubound(temp))
      <br> \'文件名重命名结束
      <br> set xmlhttp=server.createobject("Microsoft.XMLHTTP")
      <br> xmlhttp.open "get",url,false
      <br> xmlhttp.send
      <br> img=xmlhttp.ResponseBody
      <br> set xmlhttp=nothing
      <br> set objAdostream=server.createobject("ADODB.Stream")
      <br> objAdostream.Open()
      <br> objAdostream.type=1
      <br> objAdostream.Write(img)
      <br> objAdostream.SaveToFile(server.mappath(savepath&amp;filename))
      <br> objAdostream.SetEOS
      <br> set objAdostream=nothing
      <br> \'\'\'\'\'\'\'222222222\'\'\'\'\'\'\'\'\'\'\'
      <br> saveimg=savepath&amp;filename \'获取保存路径
      <br> Dim Jpeg
      <br> Set Jpeg = Server.CreateObject("Persits.Jpeg")
      <br> Jpeg.Open Server.MapPath(saveimg) \'打开保存图片的路径
     </div> 
     <div>
      \' 添加文字水印
      <br> Jpeg.Canvas.Font.Color = &amp;HFF0000\' 红色
      <br> Jpeg.Canvas.Font.Family = "宋体"
      <br> Jpeg.Canvas.Font.Bold = True&nbsp;&nbsp;
      <br> Jpeg.Canvas.Print Jpeg.OriginalWidth-200,Jpeg.OriginalHeight-50, "
      <a href="http://www.sina.com/" rel="nofollow" style="color:rgb(7,93,179);">www.sina.com</a>"&nbsp; \'水印离左边的距离,离顶端的距离,这个是放在右下脚了
      <br> \'保存文件
      <br> Jpeg.Save Server.MapPath(saveimg) \'保存添加水印后的图片
     </div> 
     <div>
      \' 注销对象
      <br> Set Jpeg = Nothing
      <br> end function
      <br> %&gt;
     </div> 
     <div> 
      <br> Set objImg = Server.CreateObject("Persits.Jpeg")
      <br> objImg.Interpolation = 2
      <br>
      <a>\\\'</a>影像加强 0-2
      <br> objImg.open xFilePath
      <br> response.write "&lt;:::原始值:::&gt;
      <br> AspJpeg版本=" &amp; objImg.Version &amp; "
      <br> 宽=" &amp; objImg.OriginalWidth &amp; "像素
      <br> " &amp; "高=" &amp; objImg.OriginalHeight &amp; "像素
      <br> "
      <br> response.write "品质=" &amp; objImg.Quality &amp; " (0-100)
      <br> " &amp; "路径=" &amp; objImg.Version &amp; "
      <br> "
     </div> 
     <div> 
      <a>\\\'objImg.Width</a>&nbsp;= objImg.OriginalWidth / 2
      <br>
      <a>\\\'</a>变更图片宽度(范例为50%)
      <br>
      <a>\\\'objImg.Height</a>&nbsp;= objImg.OriginalHeight / 2
      <br>
      <a>\\\'</a>变更图片高度(范例为50%)
      <br>
      <a>\\\'objImg.Sharpen</a>&nbsp;2, 250
      <br>
      <a>\\\'</a>锐利处理
      <br>
      <a>\\\'objImg.Crop</a>&nbsp;0,0,150,150
      <br>
      <a>\\\'</a>切割处理
      <br>
      <a>\\\'objImg.FlipH</a>
      <br>
      <a>\\\'</a>左右翻转
      <br>
      <a>\\\'objImg.FlipV</a>
      <br>
      <a>\\\'</a>上下翻转
      <br>
      <a>\\\'objImg.RotateL</a>
      <br>
      <a>\\\'</a>向左旋转90度
      <br>
      <a>\\\'objImg.RotateR</a>
      <br>
      <a>\\\'</a>向右旋转90度
     </div> 
     <div> 
      <a>\\\'</a>&nbsp;将图片秀上文字:------------------------
      <br> objImg.Canvas.Font.Color = &amp;HFF0000
      <br>
      <a>\\\'</a>颜色
      <br> objImg.Canvas.Font.Family = "细明体"
      <br>
      <a>\\\'</a>字型
      <br> objImg.Canvas.Font.Bold = True
      <br>
      <a>\\\'</a>是否使用粗体
      <br> objImg.Canvas.Font.BkMode = False
      <br>
      <a>\\\'</a>是否使用字体背景色
      <br> objImg.Canvas.Font.BkColor = &amp;H000000
      <br>
      <a>\\\'</a>字体背景色
      <br> objImg.Canvas.Font.Italic = False
      <br>
      <a>\\\'</a>是否使用斜体字
      <br> objImg.Canvas.Font.Rotation = 0
      <br>
      <a>\\\'</a>字体旋转角度
      <br> objImg.Canvas.Font.ShadowColor = &amp;H000000
      <br>
      <a>\\\'</a>字影颜色
      <br> objImg.Canvas.Font.ShadowXOffset = 50
      <br>
      <a>\\\'</a>字影X坐标
      <br> objImg.Canvas.Font.ShadowYOffset = 150
      <br>
      <a>\\\'</a>字影Y坐标
      <br> objImg.Canvas.Font.Size = 14
      <br>
      <a>\\\'</a>字体大小
      <br> objImg.Canvas.Font.Underlined = True
      <br>
      <a>\\\'</a>是否加底限
      <br> objImg.Canvas.Circle 100,100,10
      <br>
      <a>\\\'</a>画圆圈
      <br> objImg.Canvas.Pen.Color = &amp;H009900
      <br>
      <a>\\\'</a>画圆的圆内填满颜色
      <br> objImg.Canvas.Pen.Width = 1
      <br>
      <a>\\\'</a>画圆的圆周粗细值
      <br> objImg.Canvas.Ellipse 0,0,150,150
      <br>
      <a>\\\'</a>画椭圆
      <br> objImg.Canvas.Line 0,0,150,150
      <br>
      <a>\\\'</a>画线
      <br>
      <a>\\\'objImg.Canvas.Arc</a>&nbsp;= 100,50,0,200
      <br>
      <a>\\\'</a>---不清楚这个用法--
     </div> 
     <div>
      objImg.Canvas.Print 100, 100, "I am Odysseus" ,136
      <br>
      <a>\\\'</a>位置及文字---------------------------------
     </div> 
     <div> 
      <br>
      <a>\\\'</a>&nbsp;编辑图片外框:----------------------------
      <br> objImg.Canvas.Pen.Color = &amp;H000000
      <br>
      <a>\\\'</a>图片外框颜色
      <br> objImg.Canvas.Pen.Width = 1
      <br>
      <a>\\\'</a>图片外框宽度(像素)
      <br> objImg.Canvas.Brush.Solid = False
      <br>
      <a>\\\'</a>是否使用区域内填满
      <br> objImg.Canvas.Brush.Color = &amp;HFF0000
      <br>
      <a>\\\'</a>区域内填满颜色
      <br> objImg.Canvas.Bar 5, 5, objImg.Width, objImg.Height
      <br>
      <a>\\\'</a>框线产生位置------------------------------
     </div> 
     <div>
      objImg.save xFileCopyToPath
      <br> response.write "&lt;:::变化后:::&gt;
      <br> 宽=" &amp; objImg.Width &amp; "像素
      <br> " &amp; "高=" &amp; objImg.Height &amp; "像素
      <br> "
     </div> 
     <div>
      Set objImg = Nothing
     </div> 
    </div> 
   </div> 
   <div class="clear" style="clear:both;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"></div> 
   <div> 
    <div style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">
     分类:&nbsp;
     <a href="http://www.cnblogs.com/happyday56/category/93642.html" rel="nofollow" style="color:rgb(7,93,179);">Javascript</a> 
    </div> 
    <div style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">
     <br>
    </div> 
    <div> 
     <font><span style="font-size:13px;">本文转自快乐就好博客园博客，原文链接：http://www.cnblogs.com/happyday56/archive/2007/11/24/971311.html，如需转载请自行联系原作者</span></font>
     <br>
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
