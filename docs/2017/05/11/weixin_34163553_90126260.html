<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>TCP编程函数和步骤 « NotBeCN</title>
  <meta name="description" content="             TCP编程的服务器端一般步骤是    1、&nbsp;创建一个socket，用函数socket()；    2、&nbsp;设置socket属性，用函数setsockopt();&nbsp;*&nbsp;可选    3、&nbsp;绑定IP地址、端口等信息到socket上，用函数bind...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/05/11/weixin_34163553_90126260.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">TCP编程函数和步骤</h1>
    <p class="post-meta">May 11, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">TCP编程的<strong>服务器端</strong>一般步骤是</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">1、&nbsp;创建一个socket，用函数socket()；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">2、&nbsp;设置socket属性，用函数setsockopt();&nbsp;*&nbsp;可选</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">3、&nbsp;绑定IP地址、端口等信息到socket上，用函数bind();</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">4、&nbsp;开启监听，用函数listen()；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">5、&nbsp;接收客户端上来的连接，用函数accept()；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">6、&nbsp;收发数据，用函数send()和recv()，者read()和write();</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">7、&nbsp;关闭网络连接；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">8、&nbsp;关闭监听；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">TCP编程的<strong>客户端</strong>一般步骤是：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">1、&nbsp;创建一个socket，用函数socket()；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">2、&nbsp;设置socket属性，用函数setsockopt();*&nbsp;可选</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">3、&nbsp;绑定IP地址、端口等信息到socket上，用函数bind();*&nbsp;可选</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">4、&nbsp;设置要连接的对方的IP地址和端口等属性；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">5、&nbsp;连接服务器，用函数connect()；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">6、&nbsp;收发数据，用函数send()和recv()，或者read()和write();</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">7、&nbsp;关闭网络连接；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">UDP编程的服务器端一般步骤是：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">1、&nbsp;创建一个socket，用函数socket()；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">2、&nbsp;设置socket属性，用函数setsockopt();*&nbsp;可选</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">3、&nbsp;绑定IP地址、端口等信息到socket上，用函数bind()</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">4、&nbsp;循环接收数据，用函数recvfrom();</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">5、&nbsp;关闭网络连接；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">UDP编程的<strong>客户端</strong>一般步骤是：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">1、&nbsp;创建一个socket，用函数socket()；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">2、&nbsp;设置socket属性，用函数setsockopt();*&nbsp;可选</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">3、&nbsp;绑定IP地址、端口等信息到socket上，用函数bind();*&nbsp;可选</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">4、&nbsp;设置对方的IP地址和端口等属性;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">5、&nbsp;发送数据，用函数sendto();</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">6、&nbsp;关闭网络连接；</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">常用的网络命令：<br> netstat<br> 命令<span style="line-height:1.5;font-family:'Times New Roman';">netstat</span><span style="line-height:1.5;font-family:'宋体';">是用来显示网络的连接</span><span style="line-height:1.5;font-family:'Times New Roman';">,</span><span style="line-height:1.5;font-family:'宋体';">路由表和接口统计等网络的信息</span><span style="line-height:1.5;font-family:'Times New Roman';">.netstat</span><span style="line-height:1.5;font-family:'宋体';">有许多的选项我们常用的选项是&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">-an&nbsp;</span><span style="line-height:1.5;font-family:'宋体';">用来显示详细的网络状态</span><span style="line-height:1.5;font-family:'Times New Roman';">.</span><span style="line-height:1.5;font-family:'宋体';">至于其它的选项我们可以使用帮助</span>&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">telnet<br> telnet<span style="line-height:1.5;font-family:'宋体';">是一个用来远程控制的程序</span><span style="line-height:1.5;font-family:'Times New Roman';">,</span><span style="line-height:1.5;font-family:'宋体';">但是我们完全可以用这个程序来调试我们的服务端程序的</span><span style="line-height:1.5;font-family:'Times New Roman';">.&nbsp;</span><span style="line-height:1.5;font-family:'宋体';">比如我们的服务器程序在监听</span><span style="line-height:1.5;font-family:'Times New Roman';">8888</span><span style="line-height:1.5;font-family:'宋体';">端口</span><span style="line-height:1.5;font-family:'Times New Roman';">,</span><span style="line-height:1.5;font-family:'宋体';">我们可以用</span><span style="line-height:1.5;font-family:'Times New Roman';">telnet&nbsp;localhost&nbsp;8888</span><span style="line-height:1.5;font-family:'宋体';">来查看服务端的状况</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">数据结构<br> 1<span style="line-height:1.5;font-family:'宋体';">、</span>地址结构<br> struct&nbsp;sockaddr_in&nbsp;{&nbsp;<br> short&nbsp;int&nbsp;sin_family;&nbsp;/*&nbsp;<span style="line-height:1.5;font-family:'宋体';">地址族&nbsp;一般为</span><span style="line-height:1.5;font-family:'Times New Roman';">AF-INET&nbsp;*/&nbsp;</span><br> unsigned&nbsp;short&nbsp;int&nbsp;sin_port;&nbsp;/*&nbsp;<span style="line-height:1.5;font-family:'宋体';">端口号&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">*/&nbsp;</span><br> struct&nbsp;in_addr&nbsp;sin_addr;&nbsp;/*&nbsp;IP<span style="line-height:1.5;font-family:'宋体';">地址&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">*/&nbsp;</span><br> unsigned&nbsp;char&nbsp;sin_zero[8];&nbsp;/*&nbsp;<span style="line-height:1.5;font-family:'宋体';">填充</span><span style="line-height:1.5;font-family:'Times New Roman';">0&nbsp;</span><span style="line-height:1.5;font-family:'宋体';">以保持与</span><span style="line-height:1.5;font-family:'Times New Roman';">struct&nbsp;sockaddr</span><span style="line-height:1.5;font-family:'宋体';">同样大小&nbsp;使用</span><span style="line-height:1.5;font-family:'Times New Roman';">memset()</span><span style="line-height:1.5;font-family:'宋体';">或</span><span style="line-height:1.5;font-family:'Times New Roman';">bzero()</span><span style="line-height:1.5;font-family:'宋体';">来填充</span><span style="line-height:1.5;font-family:'Times New Roman';">*/&nbsp;</span><br> };&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">struct&nbsp;sockaddr&nbsp;{&nbsp;<br><span style="line-height:1.5;font-family:'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;short&nbsp;sa_family;&nbsp;/*&nbsp;</span><span style="line-height:1.5;font-family:'宋体';">地址族，&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">AF_xxx&nbsp;*/&nbsp;</span><br><span style="line-height:1.5;font-family:'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;sa_data[14];&nbsp;/*&nbsp;14&nbsp;</span><span style="line-height:1.5;font-family:'宋体';">字节的协议地址&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">*/</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><br> 2<span style="line-height:1.5;font-family:'宋体';">、</span><span style="line-height:1.5;font-family:'Times New Roman';">DNS</span><span style="line-height:1.5;font-family:'宋体';">结构</span><br> struct&nbsp;hostent&nbsp;{&nbsp;<br> char&nbsp;*h_name;&nbsp;/*&nbsp;<span style="line-height:1.5;font-family:'宋体';">主机的官方域名&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">*/&nbsp;</span><br> char&nbsp;**h_aliases;&nbsp;/*&nbsp;<span style="line-height:1.5;font-family:'宋体';">一个以</span><span style="line-height:1.5;font-family:'Times New Roman';">NULL</span><span style="line-height:1.5;font-family:'宋体';">结尾的主机别名数组&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">*/&nbsp;</span><br> int&nbsp;h_addrtype;&nbsp;/*&nbsp;<span style="line-height:1.5;font-family:'宋体';">返回的地址类型，在</span><span style="line-height:1.5;font-family:'Times New Roman';">Internet</span><span style="line-height:1.5;font-family:'宋体';">环境下为</span><span style="line-height:1.5;font-family:'Times New Roman';">AF-INET&nbsp;*/&nbsp;</span><br> int&nbsp;h_length;&nbsp;/*<span style="line-height:1.5;font-family:'宋体';">地址的字节长度&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">*/&nbsp;</span><br> char&nbsp;**h_addr_list;&nbsp;/*&nbsp;<span style="line-height:1.5;font-family:'宋体';">一个以</span><span style="line-height:1.5;font-family:'Times New Roman';">0</span><span style="line-height:1.5;font-family:'宋体';">结尾的数组，包含该主机的所有地址</span><span style="line-height:1.5;font-family:'Times New Roman';">*/&nbsp;</span><br> };</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">操作函数</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">1、&nbsp;socket:</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">创建<span style="line-height:1.5;font-family:'Times New Roman';">socket&nbsp;</span><span style="line-height:1.5;font-family:'宋体';">描述符</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">int&nbsp;socket(int&nbsp;domain,&nbsp;int&nbsp;type,&nbsp;int&nbsp;protocol);&nbsp;<br> domain<span style="line-height:1.5;font-family:'宋体';">＝</span><span style="line-height:1.5;font-family:'Times New Roman';">AF_INET</span><span style="line-height:1.5;font-family:'宋体';">，</span><span style="line-height:1.5;font-family:'Times New Roman';">socket</span><span style="line-height:1.5;font-family:'宋体';">的类型，</span><span style="line-height:1.5;font-family:'Times New Roman';">type</span><span style="line-height:1.5;font-family:'宋体';">＝</span><span style="line-height:1.5;font-family:'Times New Roman';">SOCK_STREAM&nbsp;</span><span style="line-height:1.5;font-family:'宋体';">或</span><span style="line-height:1.5;font-family:'Times New Roman';">SOCK_DGRAM</span><span style="line-height:1.5;font-family:'宋体';">，分别表示</span><span style="line-height:1.5;font-family:'Times New Roman';">TCP</span><span style="line-height:1.5;font-family:'宋体';">连接和</span><span style="line-height:1.5;font-family:'Times New Roman';">UDP</span><span style="line-height:1.5;font-family:'宋体';">连接；</span><span style="line-height:1.5;font-family:'Times New Roman';">protocol</span><span style="line-height:1.5;font-family:'宋体';">＝</span><span style="line-height:1.5;font-family:'Times New Roman';">0</span><span style="line-height:1.5;font-family:'宋体';">。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">返回一个整型<span style="line-height:1.5;font-family:'Times New Roman';">socket</span><span style="line-height:1.5;font-family:'宋体';">描述符。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;<br> 2.bind:<span style="line-height:1.5;font-family:'宋体';">　</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">将<span style="line-height:1.5;font-family:'Times New Roman';">socket</span><span style="line-height:1.5;font-family:'宋体';">描述符与你本机上的一个端口相关联（仅用于服务器）</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">int&nbsp;bind(int&nbsp;sockfd,struct&nbsp;sockaddr&nbsp;*my_addr,&nbsp;int&nbsp;addrlen);</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">Sockfd<span style="line-height:1.5;font-family:'宋体';">是一个</span><span style="line-height:1.5;font-family:'Times New Roman';">socket</span><span style="line-height:1.5;font-family:'宋体';">描述符</span><br> my_addr<span style="line-height:1.5;font-family:'宋体';">是一个指向包含有本机</span><span style="line-height:1.5;font-family:'Times New Roman';">IP</span><span style="line-height:1.5;font-family:'宋体';">地址及端口号等信息的</span><span style="line-height:1.5;font-family:'Times New Roman';">sockaddr</span><span style="line-height:1.5;font-family:'宋体';">类型的指针</span><span style="line-height:1.5;font-family:'Times New Roman';">;</span><br> addrlen<span style="line-height:1.5;font-family:'宋体';">＝</span><span style="line-height:1.5;font-family:'Times New Roman';">sizeof(struct&nbsp;sockaddr)</span><span style="line-height:1.5;font-family:'宋体';">。&nbsp;</span><br> 返回：成功＝<span style="line-height:1.5;font-family:'Times New Roman';">0</span><span style="line-height:1.5;font-family:'宋体';">；失败＝</span><span style="line-height:1.5;font-family:'Times New Roman';">-1</span><span style="line-height:1.5;font-family:'宋体';">，</span><span style="line-height:1.5;font-family:'Times New Roman';">errno</span><span style="line-height:1.5;font-family:'宋体';">＝错误号。</span><br> 可以用下面的赋值自动获得本机<span style="line-height:1.5;font-family:'Times New Roman';">IP</span><span style="line-height:1.5;font-family:'宋体';">地址和随机获取一个没有被占用的端口号：&nbsp;</span><br> my_addr.sin_port&nbsp;=&nbsp;0;&nbsp;/*&nbsp;<span style="line-height:1.5;font-family:'宋体';">系统随机选择一个未被使用的端口号&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">*/&nbsp;</span><br> my_addr.sin_addr.s_addr&nbsp;=&nbsp;INADDR_ANY;&nbsp;/*&nbsp;<span style="line-height:1.5;font-family:'宋体';">填入本机</span><span style="line-height:1.5;font-family:'Times New Roman';">IP</span><span style="line-height:1.5;font-family:'宋体';">地址&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">*/</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">3.Connect<span style="line-height:1.5;font-family:'宋体';">：&nbsp;</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">与远端服务器建立一个<span style="line-height:1.5;font-family:'Times New Roman';">TCP</span><span style="line-height:1.5;font-family:'宋体';">连接&nbsp;（用于客户端）</span><br> int&nbsp;connect(int&nbsp;sockfd,&nbsp;struct&nbsp;sockaddr&nbsp;*serv_addr,&nbsp;int&nbsp;addrlen);&nbsp;<br> Sockfd<span style="line-height:1.5;font-family:'宋体';">是目的服务器的</span><span style="line-height:1.5;font-family:'Times New Roman';">sockt</span><span style="line-height:1.5;font-family:'宋体';">描述符</span><br> serv_addr<span style="line-height:1.5;font-family:'宋体';">是包含目的机</span><span style="line-height:1.5;font-family:'Times New Roman';">IP</span><span style="line-height:1.5;font-family:'宋体';">地址和端口号的指针。</span><br> 返回：成功＝<span style="line-height:1.5;font-family:'Times New Roman';">0</span><span style="line-height:1.5;font-family:'宋体';">；失败＝</span><span style="line-height:1.5;font-family:'Times New Roman';">-1</span><span style="line-height:1.5;font-family:'宋体';">，</span><span style="line-height:1.5;font-family:'Times New Roman';">errno</span><span style="line-height:1.5;font-family:'宋体';">＝错误号。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">4<span style="line-height:1.5;font-family:'宋体';">、</span><span style="line-height:1.5;font-family:'Times New Roman';">Listen</span><span style="line-height:1.5;font-family:'宋体';">：&nbsp;</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">监听是否有服务请求&nbsp;，用于<span style="line-height:1.5;font-family:'Times New Roman';">bind()</span><span style="line-height:1.5;font-family:'宋体';">后</span><br> int&nbsp;listen(int&nbsp;sockfd<span style="line-height:1.5;font-family:'宋体';">，&nbsp;</span><span style="line-height:1.5;font-family:'Times New Roman';">int&nbsp;backlog);&nbsp;</span><br> Sockfd<span style="line-height:1.5;font-family:'宋体';">是</span><span style="line-height:1.5;font-family:'Times New Roman';">Socket</span><span style="line-height:1.5;font-family:'宋体';">系统调用返回的</span><span style="line-height:1.5;font-family:'Times New Roman';">socket&nbsp;</span><span style="line-height:1.5;font-family:'宋体';">描述符；</span><br> backlog<span style="line-height:1.5;font-family:'宋体';">指定在请求队列中允许的最大请求数，缺省值为</span><span style="line-height:1.5;font-family:'Times New Roman';">20</span><span style="line-height:1.5;font-family:'宋体';">。</span><br> 返回：成功＝<span style="line-height:1.5;font-family:'Times New Roman';">0</span><span style="line-height:1.5;font-family:'宋体';">；失败＝</span><span style="line-height:1.5;font-family:'Times New Roman';">-1</span><span style="line-height:1.5;font-family:'宋体';">，</span><span style="line-height:1.5;font-family:'Times New Roman';">errno</span><span style="line-height:1.5;font-family:'宋体';">＝错误号。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">5.accept<span style="line-height:1.5;font-family:'宋体';">：</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">接受来自客户的请求<br> int&nbsp;accept(int&nbsp;sockfd,&nbsp;void&nbsp;*addr,&nbsp;int&nbsp;*addrlen);&nbsp;<br> sockfd<span style="line-height:1.5;font-family:'宋体';">是被监听的</span><span style="line-height:1.5;font-family:'Times New Roman';">socket</span><span style="line-height:1.5;font-family:'宋体';">描述符，</span><br> addr&nbsp;<span style="line-height:1.5;font-family:'宋体';">是指向</span><span style="line-height:1.5;font-family:'Times New Roman';">sockaddr_in</span><span style="line-height:1.5;font-family:'宋体';">变量的指针，存放客户主机的信息&nbsp;；</span><br> addrten&nbsp;<span style="line-height:1.5;font-family:'宋体';">指向值为</span><span style="line-height:1.5;font-family:'Times New Roman';">sizeof(struct&nbsp;sockaddr_in)</span><span style="line-height:1.5;font-family:'宋体';">的整型指针变量。</span><br> 返回：成功返回一个新的<span style="line-height:1.5;font-family:'Times New Roman';">socket</span><span style="line-height:1.5;font-family:'宋体';">描述符，来供这个新连接来使用。&nbsp;错误发生时返回一个</span><span style="line-height:1.5;font-family:'Times New Roman';">-1</span><span style="line-height:1.5;font-family:'宋体';">并且设置相应的</span><span style="line-height:1.5;font-family:'Times New Roman';">errno</span><span style="line-height:1.5;font-family:'宋体';">值。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">6.Send<span style="line-height:1.5;font-family:'宋体';">：&nbsp;</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">在连接<span style="line-height:1.5;font-family:'Times New Roman';">(TCP)</span><span style="line-height:1.5;font-family:'宋体';">的</span>socket方式下发送信息<br> int&nbsp;send(int&nbsp;sockfd,&nbsp;const&nbsp;void&nbsp;*msg,&nbsp;int&nbsp;len,&nbsp;int&nbsp;flags);&nbsp;<br> Sockfd<span style="line-height:1.5;font-family:'宋体';">是用来传输数据的</span><span style="line-height:1.5;font-family:'Times New Roman';">socket</span><span style="line-height:1.5;font-family:'宋体';">描述符</span><br> msg<span style="line-height:1.5;font-family:'宋体';">是一个指向要发送数据的指针。&nbsp;</span><br> Len<span style="line-height:1.5;font-family:'宋体';">是以字节为单位的数据的长度。</span><br> flags<span style="line-height:1.5;font-family:'宋体';">一般情况下置为</span><span style="line-height:1.5;font-family:'Times New Roman';">0</span><span style="line-height:1.5;font-family:'宋体';">。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">7.recv<span style="line-height:1.5;font-family:'宋体';">：</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;在连接<span style="line-height:1.5;font-family:'Times New Roman';">(TCP)</span><span style="line-height:1.5;font-family:'宋体';">的</span>socket方式下接收数据</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">int&nbsp;recv(int&nbsp;sockfd,void&nbsp;*buf,int&nbsp;len,unsigned&nbsp;int&nbsp;flags);&nbsp;<br> Sockfd<span style="line-height:1.5;font-family:'宋体';">是接受数据的</span><span style="line-height:1.5;font-family:'Times New Roman';">socket</span><span style="line-height:1.5;font-family:'宋体';">描述符；</span><br> buf&nbsp;<span style="line-height:1.5;font-family:'宋体';">是存放接收数据的缓冲区；</span><br> len<span style="line-height:1.5;font-family:'宋体';">是缓冲的长度。</span><br> Flags<span style="line-height:1.5;font-family:'宋体';">也被置为</span><span style="line-height:1.5;font-family:'Times New Roman';">0</span><span style="line-height:1.5;font-family:'宋体';">。</span><br> 返回：实际上接收的字节数，如果连接中止，返回<span style="line-height:1.5;font-family:'Times New Roman';">0,</span><span style="line-height:1.5;font-family:'宋体';">。</span>出现错误时，返回<span style="line-height:1.5;font-family:'Times New Roman';">-1</span><span style="line-height:1.5;font-family:'宋体';">并置相应的</span><span style="line-height:1.5;font-family:'Times New Roman';">errno</span><span style="line-height:1.5;font-family:'宋体';">值。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">8.sendto:&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">在在无连接<span style="line-height:1.5;font-family:'Times New Roman';">(UDP)</span><span style="line-height:1.5;font-family:'宋体';">的</span><span style="line-height:1.5;font-family:'Times New Roman';">socket</span>方式下发送数据&nbsp;<br> int&nbsp;sendto(int&nbsp;sockfd,&nbsp;const&nbsp;void&nbsp;*msg,int&nbsp;len,unsigned&nbsp;int&nbsp;flags,const&nbsp;struct&nbsp;sockaddr&nbsp;*to,&nbsp;int&nbsp;tolen);&nbsp;<br> to<span style="line-height:1.5;font-family:'宋体';">表示目地机的</span><span style="line-height:1.5;font-family:'Times New Roman';">IP</span><span style="line-height:1.5;font-family:'宋体';">地址和端口号信息</span><br> tolen=sizeof&nbsp;(struct&nbsp;sockaddr)<span style="line-height:1.5;font-family:'宋体';">。</span><br> 返回：实际发送的数据字节长度或在出现发送错误时返回<span style="line-height:1.5;font-family:'Times New Roman';">-1</span><span style="line-height:1.5;font-family:'宋体';">。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">9.Recvfrom()</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">在无连接<span style="line-height:1.5;font-family:'Times New Roman';">(UDP)</span><span style="line-height:1.5;font-family:'宋体';">的</span><span style="line-height:1.5;font-family:'Times New Roman';">socket</span><span style="line-height:1.5;font-family:'宋体';">方式下</span>接收数据<br> int&nbsp;recvfrom(int&nbsp;sockfd,void&nbsp;*buf,int&nbsp;len,unsigned&nbsp;int&nbsp;flags,struct&nbsp;sockaddr&nbsp;*from,int&nbsp;*fromlen);&nbsp;<br> from&nbsp;<span style="line-height:1.5;font-family:'宋体';">保存源机的</span><span style="line-height:1.5;font-family:'Times New Roman';">IP</span><span style="line-height:1.5;font-family:'宋体';">地址及端口号。</span><br> fromlen<span style="line-height:1.5;font-family:'宋体';">＝</span><span style="line-height:1.5;font-family:'Times New Roman';">sizeof(struct&nbsp;sockaddr)</span><span style="line-height:1.5;font-family:'宋体';">。</span><br> 返回：实际存入<span style="line-height:1.5;font-family:'Times New Roman';">from</span><span style="line-height:1.5;font-family:'宋体';">中的数据字节数。当出现错误时返回</span><span style="line-height:1.5;font-family:'Times New Roman';">-1</span><span style="line-height:1.5;font-family:'宋体';">，并置相应的</span><span style="line-height:1.5;font-family:'Times New Roman';">errno</span><span style="line-height:1.5;font-family:'宋体';">。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">10.close()</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">释放<span style="line-height:1.5;font-family:'Times New Roman';">socket</span><span style="line-height:1.5;font-family:'宋体';">，停止任何数据操作</span><br> close(sockfd);</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">11.shutdown<span style="line-height:1.5;font-family:'宋体';">：</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">单向关闭连接<br> int&nbsp;shutdown(int&nbsp;sockfd,int&nbsp;how);&nbsp;<br> how<span style="line-height:1.5;font-family:'宋体';">可以设为下列值：&nbsp;</span><br> ·0-------<span style="line-height:1.5;font-family:'宋体';">不允许继续接收数据&nbsp;</span><br> ·1-------<span style="line-height:1.5;font-family:'宋体';">不允许继续发送数据&nbsp;</span><br> ·2-------<span style="line-height:1.5;font-family:'宋体';">不允许继续发送和接收数据，均为允许则调用</span><span style="line-height:1.5;font-family:'Times New Roman';">close&nbsp;()&nbsp;</span><br> shutdown<span style="line-height:1.5;font-family:'宋体';">在操作成功时返回</span><span style="line-height:1.5;font-family:'Times New Roman';">0</span><span style="line-height:1.5;font-family:'宋体';">，在出现错误时返回</span><span style="line-height:1.5;font-family:'Times New Roman';">-1</span><span style="line-height:1.5;font-family:'宋体';">（并置相应</span><span style="line-height:1.5;font-family:'Times New Roman';">errno</span><span style="line-height:1.5;font-family:'宋体';">）。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">12.&nbsp;gethostbyname<span style="line-height:1.5;font-family:'宋体';">：</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;域名和<span style="line-height:1.5;font-family:'Times New Roman';">IP</span><span style="line-height:1.5;font-family:'宋体';">地址的转换</span><br> struct&nbsp;hostent&nbsp;*gethostbyname(const&nbsp;char&nbsp;*name);</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">13.inet_pton<span style="line-height:1.5;font-family:'宋体';">函数：</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">将点分十进制串转换成网络字节序二进制值，此函数对<span style="line-height:1.5;font-family:'Times New Roman';">IPv4</span><span style="line-height:1.5;font-family:'宋体';">地址和</span><span style="line-height:1.5;font-family:'Times New Roman';">IPv6</span><span style="line-height:1.5;font-family:'宋体';">地址都能处理。&nbsp;</span><br> int&nbsp;inet_pton(int&nbsp;family,const&nbsp;char&nbsp;*&nbsp;strptr,void&nbsp;*&nbsp;addrptr);<span style="line-height:1.5;font-family:'宋体';">　</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">第一个参数可以是<span style="line-height:1.5;font-family:'Times New Roman';">AF_INET</span><span style="line-height:1.5;font-family:'宋体';">或</span><span style="line-height:1.5;font-family:'Times New Roman';">AF_INET6</span><span style="line-height:1.5;font-family:'宋体';">：第二个参数是一个指向点分十进制串的指针：第三个参数是一个指向转换后的网络字节序的二进制值的指针。&nbsp;　　　　　　&nbsp;　&nbsp;</span><br> 返回：<span style="line-height:1.5;font-family:'Times New Roman';">1</span><span style="line-height:1.5;font-family:'宋体';">－－－成功　　　</span><span style="line-height:1.5;font-family:'Times New Roman';">0</span><span style="line-height:1.5;font-family:'宋体';">－－－输入不是有效的表达格式　　　</span><span style="line-height:1.5;font-family:'Times New Roman';">-1</span><span style="line-height:1.5;font-family:'宋体';">－－－失败&nbsp;</span><br><br> 14.inet_ntop<span style="line-height:1.5;font-family:'宋体';">函数：</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">和<span style="line-height:1.5;font-family:'Times New Roman';">inet_pton</span><span style="line-height:1.5;font-family:'宋体';">函数正好相反，</span><span style="line-height:1.5;font-family:'Times New Roman';">inet_ntop</span><span style="line-height:1.5;font-family:'宋体';">函数是将网络字节序二进制值转换成点分十进制串。&nbsp;</span><br> const&nbsp;char&nbsp;*&nbsp;inet_ntop(int&nbsp;family,const&nbsp;void&nbsp;*&nbsp;addrptr,char&nbsp;*&nbsp;strptr,size_t&nbsp;len);&nbsp;<span style="line-height:1.5;font-family:'宋体';">　</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">第一个参数可以是<span style="line-height:1.5;font-family:'Times New Roman';">AF_INET</span><span style="line-height:1.5;font-family:'宋体';">或</span><span style="line-height:1.5;font-family:'Times New Roman';">AF_INET6</span><span style="line-height:1.5;font-family:'宋体';">：第二个参数是一个指向网络字节序的二进制值的指针；第三个参数是一个指向转换后的点分十进制串的指针；第四个参数是目标的大小，以免函数溢出其调用者的缓冲区。&nbsp;</span><br> 返回：指向结果的指针－－－成功　　　<span style="line-height:1.5;font-family:'Times New Roman';">NULL</span><span style="line-height:1.5;font-family:'宋体';">－－－失败&nbsp;</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><span style="line-height:1.5;font-family:'宋体';"><br></span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><span style="line-height:1.5;font-family:'宋体';"><br></span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><span style="line-height:1.5;font-family:'宋体';"><br></span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"><span style="line-height:1.5;font-family:'宋体';"><br></span></p> 
   <p style="line-height:1.5;"><span style="line-height:1.5;"><font color="#4b4b4b"><span style="font-size:13px;">本文转自夏雪冬日博客园博客，原文链接：http://www.cnblogs.com/heyonggang/archive/2012/12/15/2819003.html，如需转载请自行联系原作者</span></font><br></span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
