<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Spatial Reference « NotBeCN</title>
  <meta name="description" content="                  空间参考是GIS的基础，失去了空间参考信息，地理空间内所有的信息也就失去了存在的意义，因为它们是不准确的或是错误的。关于ArcGIS坐标系统文件，可以看看这篇文章——《ArcGIS 坐标系统文件》。 &nbsp;&nbsp;&nbsp;&nbsp;刻画Spatial Refer...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/06/29/weixin_34184158_90121508.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Spatial Reference</h1>
    <p class="post-meta">Jun 29, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body" style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <p><span style="font-size:10pt;font-family:Verdana;">空间参考是GIS的基础，失去了空间参考信息，地理空间内所有的信息也就失去了存在的意义，因为它们是不准确的或是错误的。关于ArcGIS坐标系统文件，可以看看这篇文章——《<a href="http://www.blogjava.net/flyingis/archive/2007/03/02/101347.html" rel="nofollow" style="color:rgb(0,51,102);text-decoration:none;">ArcGIS 坐标系统文件</a>》。<br><br> &nbsp;&nbsp;&nbsp;&nbsp;<strong>刻画Spatial Reference的精度</strong><br><br> &nbsp;&nbsp;&nbsp; 首先，我们主要讨论的是ArcGIS中Spatial Reference的各种精度，看到resolution、tolerance、domain、scale factor、precision，是否很熟悉？为了保证表达的准确性，所有这些关键字使用英文表述，不再译为中文。<br><br> &nbsp;&nbsp;&nbsp; Resolution和domain范围决定了Geometry坐标的存储方式，Resolution和关联的坐标系使用相同的数量单位，如当空间参考使用以米为单位的投影参考时，XY resolution单位为米，默认情况下resolution=0.0001m，不管怎么样resolution值至少应该小于数据精度的1/10。当定位某一坐标到坐标格网时，我们依据如下公式：<br><br> &nbsp;&nbsp;&nbsp; Persisted coordinate = Round((map coordinate - minimum domain extent) / resolution)<br><br> &nbsp;&nbsp;&nbsp; 在ArcGIS 9.2之前，resolution=1/precision，ArcGIS 9.2认为resolution和precision几乎相同，在9.2之前坐标的存储精度是31位，9.2中为53位，对于上面的公式而言，当resolution很小时，坐标系统表达数据会更精确，但在9.2之前的ArcGIS中persisted coordinate会受到限制。例如在ArcGIS 9.2之前，当minimum domain value=0，resolution=1时，maximum domain value=2<sup>31</sup>-2，resolution=0.0001时，maximum domain value=(2<sup>31</sup>-2)*0.0001=<strong>214748.3647</strong>；在ArcGIS 9.2中，当minimum domain value=0，resolution=1时，maximum domain value=2<sup>53</sup>-2，resolution=0.0001时，maximum domain value=(2<sup>53</sup>-2)*0.0001，很显然，ArcGIS 9.1中maximum domain value=<strong>214748.3647</strong>已经不能满足UTM、State Plane等投影坐标系的要求，ArcGIS 9.2存储的数据可以拥有更高精度的空间参考。<br><br> &nbsp;&nbsp;&nbsp; 默认情况下，ArcGIS 9.2为整数坐标采用53位空间存储，当然在编辑没有升级空间参考的空间数据库中的数据时，也可以保持向下兼容。新的COM接口已经可以用来判断数据采用的是低精度的各种空间参考，还是高精度的，同时有新的接口可以在低精度空间参考和高精度空间参考之间转换。<br><br> &nbsp;&nbsp;&nbsp; 还是默认情况下，Tolerance=10*resolution，minimum tolerance=2*resolution=2.0/scale factor，tolerance决定在relational和topological操作中，两个坐标之间的最小距离，当小于该距离时，认为这两个坐标为相同的坐标。relational和topological操作采用不同的tolerance会得到不同的处理结果。9.2之前tolerance值受resolution的影响，9.2中必须要明确指定tolerance的值，在IRelationalOperator、ITopologicalOperator等对两个几何对象进行Geometry操作的接口中，使用第一个对象的tolerance来判断两几何体点点之间的关系，如果空间参考是未定义，或没有空间参考和几何体关联，将采用该格网所允许的最小tolerance取值。<br><br> &nbsp;&nbsp;&nbsp;&nbsp;<strong>如何编程？</strong><br><br> &nbsp;&nbsp;&nbsp; 使用SpatialReferenceEnvironment<br></span></p> 
    <div style="border-width:1px;border-style:solid;font-size:13px;"> 
     <img src="http://www.blogjava.net/Images/OutliningIndicators/None.gif" align="top" alt="" style="border:0px;">
     <span style="color:rgb(0,0,255);">private</span>&nbsp;
     <span style="color:rgb(0,0,255);">void</span>&nbsp;PrintPreDefinedProjections()
     <br>
     <img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" style="border:0px;" alt="ExpandedBlockStart.gif">
     <span>{<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReferenceFactory&nbsp;spatialReferenceFactory&nbsp;=&nbsp;<span style="color:rgb(0,0,255);">new</span>&nbsp;SpatialReferenceEnvironmentClass();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;ISet&nbsp;projectionSet&nbsp;=&nbsp;spatialReferenceFactory.CreatePredefinedProjections();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;System.Windows.Forms.MessageBox.Show("Number&nbsp;of&nbsp;predefined&nbsp;Projections&nbsp;=&nbsp;"&nbsp;+&nbsp;projectionSet.Count);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;projectionSet.Reset();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">for</span>&nbsp;(<span style="color:rgb(0,0,255);">int</span>&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;projectionSet.Count;&nbsp;i++)<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;<span>{<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IProjection&nbsp;projection&nbsp;=&nbsp;projectionSet.Next()&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;IProjection;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Windows.Forms.MessageBox.Show(projection.Name);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;}</span><br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top" alt="" style="border:0px;">}</span> 
    </div> 
    <p><br> &nbsp;&nbsp;&nbsp; CreatePredefinedProjections返回AE中所有预定义的投影坐标，一共59个。ISpatialReferenceFactory的CreateESRISpatialReferenceFromPRJFile方法可以从已定义的PRJ文件获取坐标。</p> 
    <div style="border-width:1px;border-style:solid;font-size:13px;"> 
     <img src="http://www.blogjava.net/Images/OutliningIndicators/None.gif" align="top" alt="" style="border:0px;">
     <span style="color:rgb(0,0,255);">private</span>&nbsp;IProjectedCoordinateSystem&nbsp;LoadProjectedCoordinateSystem()
     <br>
     <img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" style="border:0px;" alt="ExpandedBlockStart.gif">
     <span>{<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReferenceFactory&nbsp;spatialReferenceFactory&nbsp;=&nbsp;<span style="color:rgb(0,0,255);">new</span>&nbsp;SpatialReferenceEnvironmentClass();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;IProjectedCoordinateSystem&nbsp;projectedCoordinateSystem&nbsp;=&nbsp;spatialReferenceFactory.CreateESRISpatialReferenceFromPRJFile("C:\\Program&nbsp;Files\\ArcGIS\\Coordinate&nbsp;Systems\\Projected&nbsp;Coordinate&nbsp;Systems\\World\\Mollweide&nbsp;(world).prj")&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;IProjectedCoordinateSystem;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">return</span>&nbsp;projectedCoordinateSystem;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top" alt="" style="border:0px;">}</span> 
    </div> 
    <br> &nbsp;&nbsp;&nbsp; 除了ISpatialReferenceFactory接口，AE还提供ISpatialReferenceFactory3接口实现了创建垂直坐标系、构建高精度坐标系和低精度坐标系的系列方法。
    <br>
    <div style="border-width:1px;border-style:solid;font-size:13px;"> 
     <img src="http://www.blogjava.net/Images/OutliningIndicators/None.gif" align="top" alt="" style="border:0px;">
     <span style="color:rgb(0,0,255);">private</span>&nbsp;
     <span style="color:rgb(0,0,255);">void</span>&nbsp;ConstructCoordinateSystem(
     <span style="color:rgb(0,0,255);">bool</span>&nbsp;highPrecision)
     <br>
     <img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" style="border:0px;" alt="ExpandedBlockStart.gif">
     <span>{<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReferenceFactory3&nbsp;spatialReferenceFactory&nbsp;=&nbsp;<span style="color:rgb(0,0,255);">new</span>&nbsp;SpatialReferenceEnvironmentClass();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReference3&nbsp;spatialReference&nbsp;=&nbsp;spatialReferenceFactory.CreateESRISpatialReferenceFromPRJFile("D:\\ArcGIS\\Coordinate&nbsp;Systems\\Geographic&nbsp;Coordinate&nbsp;Systems\\World\\WGS&nbsp;1984.prj")&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;ISpatialReference3;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;IControlPrecision2&nbsp;controlPrecision&nbsp;=&nbsp;spatialReference&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;IControlPrecision2;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Determines&nbsp;whether&nbsp;you&nbsp;are&nbsp;constructing&nbsp;a&nbsp;high&nbsp;or&nbsp;low.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;controlPrecision.IsHighPrecision&nbsp;=&nbsp;highPrecision;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReferenceResolution&nbsp;spatialReferenceResolution&nbsp;=&nbsp;spatialReference&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;ISpatialReferenceResolution;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">These&nbsp;three&nbsp;methods&nbsp;are&nbsp;the&nbsp;keys,&nbsp;construct&nbsp;horizon,&nbsp;then&nbsp;set&nbsp;the&nbsp;default&nbsp;x,y&nbsp;resolution&nbsp;and&nbsp;tolerance.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;spatialReferenceResolution.ConstructFromHorizon();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Set&nbsp;the&nbsp;default&nbsp;x,y&nbsp;resolution&nbsp;value.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;spatialReferenceResolution.SetDefaultXYResolution();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Set&nbsp;the&nbsp;default&nbsp;x,y&nbsp;tolerance&nbsp;value.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReferenceTolerance&nbsp;spatialReferenceTolerance&nbsp;=&nbsp;spatialReference&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;ISpatialReferenceTolerance;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;spatialReferenceTolerance.SetDefaultXYTolerance();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">double</span>&nbsp;xMin;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">double</span>&nbsp;xMax;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">double</span>&nbsp;yMin;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">double</span>&nbsp;yMax;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;spatialReference.GetDomain(<span style="color:rgb(0,0,255);">out</span>&nbsp;xMin,&nbsp;<span style="color:rgb(0,0,255);">out</span>&nbsp;xMax,&nbsp;<span style="color:rgb(0,0,255);">out</span>&nbsp;yMin,&nbsp;<span style="color:rgb(0,0,255);">out</span>&nbsp;yMax);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;System.Windows.Forms.MessageBox.Show("Domain&nbsp;:&nbsp;"&nbsp;+&nbsp;xMin&nbsp;+&nbsp;",&nbsp;"&nbsp;+&nbsp;xMax&nbsp;+&nbsp;",&nbsp;"&nbsp;+&nbsp;yMin&nbsp;+&nbsp;",&nbsp;"&nbsp;+&nbsp;yMax);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top" alt="" style="border:0px;">}</span> 
    </div> 
    <br> &nbsp;&nbsp;&nbsp; IControlPrecision2.IsHighPrecision用来判断是否对数据采用高精度坐标，后面的设置空间参考的方法将根据这个判断来决定各种参数的精确程度。highPrecision等于true或false时，返回的Domain分别是：
    <br>
    <br> &nbsp;&nbsp;&nbsp; highPrecision=true&nbsp;&nbsp; -400 9006799.25474099&nbsp;&nbsp;&nbsp; -400 9006799.25474099
    <br> &nbsp;&nbsp;&nbsp; highPrecision=false&nbsp; -400 793.04646944444426 -400 793.04646944444426
    <br>
    <br> &nbsp;&nbsp;&nbsp; 可以看出两者之间精度差别的大小。
    <br>
    <br> &nbsp;&nbsp;&nbsp; 我们可以创建一个新的投影坐标系并保存为prj文件，同时可以利用这个prj生成一个新的投影坐标系。
    <br>
    <div style="border-width:1px;border-style:solid;font-size:13px;"> 
     <img src="http://www.blogjava.net/Images/OutliningIndicators/None.gif" align="top" alt="" style="border:0px;">
     <span style="color:rgb(0,0,255);">private</span>&nbsp;
     <span style="color:rgb(0,0,255);">void</span>&nbsp;ImportExportSR_Example()
     <br>
     <img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" style="border:0px;" alt="ExpandedBlockStart.gif">
     <span>{<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Instantiate&nbsp;a&nbsp;predefined&nbsp;spatial&nbsp;reference&nbsp;and&nbsp;set&nbsp;its&nbsp;coordinate&nbsp;grid&nbsp;information.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReferenceFactory&nbsp;spatialReferenceFactory&nbsp;=&nbsp;<span style="color:rgb(0,0,255);">new</span>&nbsp;SpatialReferenceEnvironmentClass();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;IProjectedCoordinateSystem&nbsp;projectedCoordinateSystem&nbsp;=&nbsp;spatialReferenceFactory.CreateProjectedCoordinateSystem((<span style="color:rgb(0,0,255);">int</span>)esriSRProjCSType.esriSRProjCS_WGS1984UTM_10N);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReferenceResolution&nbsp;spatialReferenceResolution&nbsp;=&nbsp;projectedCoordinateSystem&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;ISpatialReferenceResolution;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReferenceTolerance&nbsp;spatialReferenceTolerance&nbsp;=&nbsp;projectedCoordinateSystem&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;ISpatialReferenceTolerance;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;spatialReferenceResolution.ConstructFromHorizon();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;spatialReferenceTolerance.SetDefaultXYTolerance();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Export&nbsp;the&nbsp;PCS&nbsp;to&nbsp;a&nbsp;.prj&nbsp;file.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;fileName&nbsp;=&nbsp;"c:\\temp\\utm10.prj";<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;spatialReferenceFactory.ExportESRISpatialReferenceToPRJFile(fileName,&nbsp;projectedCoordinateSystem);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Rehydrate&nbsp;it&nbsp;as&nbsp;a&nbsp;new&nbsp;spatial&nbsp;reference&nbsp;object.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReference&nbsp;projectedCoordinateSystem2&nbsp;=&nbsp;spatialReferenceFactory.CreateESRISpatialReferenceFromPRJFile(fileName);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">See&nbsp;if&nbsp;they&nbsp;are&nbsp;equal.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;IClone&nbsp;comparison&nbsp;=&nbsp;projectedCoordinateSystem&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;IClone;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Should&nbsp;be&nbsp;true,&nbsp;but&nbsp;coordinate&nbsp;grid&nbsp;information&nbsp;has&nbsp;not&nbsp;been&nbsp;checked.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;System.Windows.Forms.MessageBox.Show((comparison.IsEqual(projectedCoordinateSystem2&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;IClone)).ToString());<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReference2&nbsp;comparePrecisions&nbsp;=&nbsp;projectedCoordinateSystem&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;ISpatialReference2;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Should&nbsp;be&nbsp;false,&nbsp;PRJ&nbsp;files&nbsp;do&nbsp;not&nbsp;persist&nbsp;coordinate&nbsp;grid&nbsp;information.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;System.Windows.Forms.MessageBox.Show((comparePrecisions.IsXYPrecisionEqual(projectedCoordinateSystem2)).ToString());<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top" alt="" style="border:0px;">}</span> 
    </div> 
    <br> &nbsp;&nbsp;&nbsp; 两个空间参考是否相等不能简单通过一个方法来确定，IClone.isEqual只能比较坐标系相同，而不能确定坐标格网信息是否相同，因此最后一行代码比较的结果是false(IsXYPrecisionEqual是ISpatialReference2接口中的方法)。最后，看看如何自定义一个完整的投影坐标参考系，地理坐标系和垂直坐标系定义方法类似。
    <br>
    <div style="border-width:1px;border-style:solid;font-size:13px;"> 
     <img src="http://www.blogjava.net/Images/OutliningIndicators/None.gif" align="top" alt="" style="border:0px;">
     <span style="color:rgb(0,0,255);">private</span>&nbsp;
     <span style="color:rgb(0,0,255);">void</span>&nbsp;SetProjectionParameters()
     <br>
     <img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" style="border:0px;" alt="ExpandedBlockStart.gif">
     <span>{<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Create&nbsp;a&nbsp;factory.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;ISpatialReferenceFactory2&nbsp;spatialReferenceFactory&nbsp;=&nbsp;<span style="color:rgb(0,0,255);">new</span>&nbsp;SpatialReferenceEnvironmentClass();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Create&nbsp;a&nbsp;projection,&nbsp;GeographicCoordinateSystem,&nbsp;and&nbsp;unit&nbsp;using&nbsp;the&nbsp;factory.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;IProjectionGEN&nbsp;projection&nbsp;=&nbsp;spatialReferenceFactory.CreateProjection((<span style="color:rgb(0,0,255);">int</span>)esriSRProjectionType.esriSRProjection_Sinusoidal)&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;IProjectionGEN;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;IGeographicCoordinateSystem&nbsp;geographicCoordinateSystem&nbsp;=&nbsp;spatialReferenceFactory.CreateGeographicCoordinateSystem((<span style="color:rgb(0,0,255);">int</span>)<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">esriSRGeoCSType.esriSRGeoCS_WGS1984);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;ILinearUnit&nbsp;unit&nbsp;=&nbsp;spatialReferenceFactory.CreateUnit((<span style="color:rgb(0,0,255);">int</span>)esriSRUnitType.esriSRUnit_Meter)&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;ILinearUnit;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Get&nbsp;the&nbsp;default&nbsp;parameters&nbsp;from&nbsp;the&nbsp;projection.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;IParameter[]&nbsp;parameters&nbsp;=&nbsp;projection.GetDefaultParameters();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Iterate&nbsp;through&nbsp;the&nbsp;parameters&nbsp;and&nbsp;print&nbsp;out&nbsp;their&nbsp;name&nbsp;and&nbsp;value.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">for</span>&nbsp;(<span style="color:rgb(0,0,255);">int</span>&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;parameters.Length;&nbsp;i++)<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;<span>{<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IParameter&nbsp;currentParameter&nbsp;=&nbsp;parameters[i];<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">if</span>&nbsp;(currentParameter&nbsp;!=&nbsp;<span style="color:rgb(0,0,255);">null</span>)<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>{<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Windows.Forms.MessageBox.Show(currentParameter.Name&nbsp;+&nbsp;",&nbsp;"&nbsp;+&nbsp;currentParameter.Index&nbsp;+&nbsp;",&nbsp;"&nbsp;+&nbsp;currentParameter.Value);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;}</span><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Reset&nbsp;one&nbsp;of&nbsp;the&nbsp;parameter&nbsp;values.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;IParameter&nbsp;parameter&nbsp;=&nbsp;parameters[2];<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;parameter.Value&nbsp;=&nbsp;45;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Create&nbsp;a&nbsp;projected&nbsp;coordinate&nbsp;system&nbsp;using&nbsp;the&nbsp;Define&nbsp;method.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;IProjectedCoordinateSystemEdit&nbsp;projectedCoordinateSystemEdit&nbsp;=&nbsp;<span style="color:rgb(0,0,255);">new</span>&nbsp;ProjectedCoordinateSystemClass();<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">object</span>&nbsp;name&nbsp;=&nbsp;"Newfoundland";<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">object</span>&nbsp;alias&nbsp;=&nbsp;"NF_LAB";<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">object</span>&nbsp;abbreviation&nbsp;=&nbsp;"NF";<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">object</span>&nbsp;remarks&nbsp;=&nbsp;"Most&nbsp;Eastern&nbsp;Province&nbsp;in&nbsp;Canada";<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">object</span>&nbsp;usage&nbsp;=&nbsp;"When&nbsp;making&nbsp;maps&nbsp;of&nbsp;Newfoundland";<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">object</span>&nbsp;geographicCoordinateSystemObject&nbsp;=&nbsp;geographicCoordinateSystem&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;<span style="color:rgb(0,0,255);">object</span>;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">object</span>&nbsp;unitObject&nbsp;=&nbsp;unit&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;<span style="color:rgb(0,0,255);">object</span>;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">object</span>&nbsp;projectionObject&nbsp;=&nbsp;projection&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;<span style="color:rgb(0,0,255);">object</span>;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">object</span>&nbsp;parametersObject&nbsp;=&nbsp;parameters&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;<span style="color:rgb(0,0,255);">object</span>;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;projectedCoordinateSystemEdit.Define(<span style="color:rgb(0,0,255);">ref</span>&nbsp;name,<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">ref</span>&nbsp;alias,<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">ref</span>&nbsp;abbreviation,<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">ref</span>&nbsp;remarks,<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">ref</span>&nbsp;usage,<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">ref</span>&nbsp;geographicCoordinateSystemObject,<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">ref</span>&nbsp;unitObject,<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">ref</span>&nbsp;projectionObject,<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">ref</span>&nbsp;parametersObject);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;IProjectedCoordinateSystem4GEN&nbsp;projectedCoordinateSystem&nbsp;=&nbsp;projectedCoordinateSystemEdit&nbsp;<span style="color:rgb(0,0,255);">as</span>&nbsp;IProjectedCoordinateSystem4GEN;<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Get&nbsp;the&nbsp;parameters&nbsp;from&nbsp;your&nbsp;new&nbsp;projected&nbsp;coordinate&nbsp;system&nbsp;and&nbsp;verify<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">that&nbsp;the&nbsp;parameter&nbsp;value&nbsp;was&nbsp;changed.<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Create&nbsp;an&nbsp;array&nbsp;of&nbsp;IParameters&nbsp;with&nbsp;16&nbsp;elements.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;IParameter[]&nbsp;newParameters&nbsp;=&nbsp;<span style="color:rgb(0,0,255);">new</span>&nbsp;IParameter[16];<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Get&nbsp;the&nbsp;parameters.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;projectedCoordinateSystem.GetParameters(<span style="color:rgb(0,0,255);">ref</span>&nbsp;newParameters);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,128,0);">//</span><span style="color:rgb(0,128,0);">Iterate&nbsp;through&nbsp;the&nbsp;parameters&nbsp;and&nbsp;print&nbsp;out&nbsp;their&nbsp;name&nbsp;and&nbsp;value.</span><span style="color:rgb(0,128,0);"><br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">for</span>&nbsp;(<span style="color:rgb(0,0,255);">int</span>&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;newParameters.Length;&nbsp;i++)<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;<span>{<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IParameter&nbsp;currentNewParameter&nbsp;=&nbsp;newParameters[i];<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(0,0,255);">if</span>&nbsp;(currentNewParameter&nbsp;!=&nbsp;<span style="color:rgb(0,0,255);">null</span>)<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedSubBlockStart.gif" align="top" style="border:0px;" alt="ExpandedSubBlockStart.gif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>{<br><img src="http://www.blogjava.net/Images/OutliningIndicators/InBlock.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Windows.Forms.MessageBox.Show(currentNewParameter.Name&nbsp;+&nbsp;",&nbsp;"&nbsp;+&nbsp;currentNewParameter.Index&nbsp;+&nbsp;",&nbsp;"&nbsp;+&nbsp;currentNewParameter.Value);<br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedSubBlockEnd.gif" align="top" alt="" style="border:0px;">&nbsp;&nbsp;&nbsp;&nbsp;}</span><br><img src="http://www.blogjava.net/Images/OutliningIndicators/ExpandedBlockEnd.gif" align="top" alt="" style="border:0px;">}</span> 
    </div> 
    <p><br> &nbsp;&nbsp;&nbsp; 具体的可以设置每一个参数，精确定义空间参考。<br><br> &nbsp;&nbsp;&nbsp; 可以看到，关于Spatial Reference编程与实现无非就是在几个接口之间实现，了解了这几个接口及它们之间的联系（参考GeometryObjectModel.pdf文档），也就了解了Spatial Reference编程的方法，当然基础是地理空间参考的基本理论知识。</p> 
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <p style="font-size:10pt;">本文转自Flyingis博客园博客，原文链接：http://www.cnblogs.com/flyingis/archive/2007/05/10/741602.html，如需转载请自行联系原作者</p> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
