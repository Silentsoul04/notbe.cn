<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Visual Studio 2008 可扩展性开发（四）：添加新的命令 « NotBeCN</title>
  <meta name="description" content="             前言    在之前的两篇随笔中，我介绍了Add-In的运行机制，这样对Add-In的事件、生命周期、与VS如何交互可以有个基本的了解了。现在是时候看看如何在VS中完成一些操作，这才是Add-In开发的目的所在。    一般的，Add-In应当提供一些界面元素，这样用户可以进行某些操作，比...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/12/22/weixin_34389926_90135387.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Visual Studio 2008 可扩展性开发（四）：添加新的命令</h1>
    <p class="post-meta">Dec 22, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:medium;"><b>前言</b></span></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">在之前的两篇随笔中，我介绍了Add-In的运行机制，这样对Add-In的事件、生命周期、与VS如何交互可以有个基本的了解了。现在是时候看看如何在VS中完成一些操作，这才是Add-In开发的目的所在。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">一般的，Add-In应当提供一些界面元素，这样用户可以进行某些操作，比如在主菜单内添加一个菜单项，或者在编辑器的上下文菜单内添加一个菜单项，在本文中就来看看如何实现这些。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:medium;"><b>关于命令（Command）</b></span></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">考虑一个极为常见的场景：在编写代码的过程中，选中一段文本，点击Edit-&gt;Copy（或工具栏按钮）或者按下Ctrl+C，我们可以把选中文本拷贝到剪贴板，这个过程的背后发生了什么？</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">是什么完成的拷贝操作呢？答案是命令。可以认为命令就是某个特定的功能，如Copy、Paste、Cut等等。VS本身就内置大量的命令（有数千个之多），而上面说到的菜单项、工具栏或快捷键则执行了这些命令。通过Tools-&gt;Options菜单可以查看命令列表：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VisualStudio2008CommandConquerTODO_11DB1/vs2008-commands_2.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="vs2008-commands" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VisualStudio2008CommandConquerTODO_11DB1/vs2008-commands_thumb.jpg" width="584" height="325" style="border:0px rgb(221,221,221);"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><i>图1：VS的命令列表</i></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">值得注意的是，执行命令并非必须通过界面元素，比如在命令窗口中：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VisualStudio2008CommandConquerTODO_11DB1/vs-commandwindow_2.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="vs-commandwindow" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VisualStudio2008CommandConquerTODO_11DB1/vs-commandwindow_thumb.jpg" width="337" height="152" style="border:0px rgb(221,221,221);"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><i>图2：在命令窗口执行命令</i></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">这样也可以执行同样的命令。现在我们知道存在多种方式来执行命令，即菜单、工具栏、快捷键或命令窗口，这里统称为<b>触发者</b>。在VS中，<b>触发者与命令是分离开来的</b>：用户通过触发者来执行命令，而命令负责检查自身的状态（名称、是否可见、是否可用等等）并执行。这意味着，命令可以对应一个或多个菜单项，也可以不对应任何菜单项。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">另一方面，对于同一个命令，比如Edit.Copy，仍然可能有不同的情况。在文本编辑器内和在解决方案管理器内的Edit.Copy命令执行内容并不相同。这里有一个<b>命令目标</b>（Command Target）的概念，VS将命令转向给了命令目标，而命令目标按自己的实现来执行该命令。总结下来就是：</p> 
   <table border="1" style="border:1px solid #C0C0C0;border-collapse:collapse;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <tbody>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;"><span style="font-size:small;"><b>对象</b></span></td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;"><span style="font-size:small;"><b>职责</b></span></td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;"><span style="font-size:small;">触发者</span></td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;"><span style="font-size:small;">提供一种方式供用户使用</span></td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;"><span style="font-size:small;">命令</span></td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;"><span style="font-size:small;">一个逻辑实体，检查自身的状态，可以执行命令，也可以转向一个命令目标</span></td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;"><span style="font-size:small;">命令目标</span></td> 
      <td valign="top" style="border:1px solid #C0C0C0;border-collapse:collapse;"><span style="font-size:small;">根据传递过来的命令，按自己的实现来执行它</span></td> 
     </tr>
    </tbody>
   </table>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b><br><span style="line-height:1.8;font-size:medium;">关于命令栏（CommandBar）</span></b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">命令是个“乖孩子”，首先是我们让它做什么它就做什么，第二就是它不会单独出门，它会跟其它同伴待在一块儿，它们都被放在命令栏中。比如主菜单中File下的那些菜单项。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">既然这样，如果希望向已经存在的命令栏内添加命令，就得首先找到命令栏才能添加。现在来看一个例子，向Tools菜单中添加一个菜单项。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:medium;"><b>添加一个新命令</b></span></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">使用Add-In向导新建一个Add-In，名字定为NEnhancer，意为对VS进行增强:)，以后关于Add-In的例子都会放在这里面。注意要选中向Tools菜单添加一个菜单项。在Connect类的OnConnection方法中可以看到添加菜单项的代码如下：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(61,129,238);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border-style:none;"></a></span>
    </div> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" width="11" height="16" style="border:0px;" alt="ExpandedBlockStart.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">C# Code - 向Tools菜单添加新项</span>
    <span style="line-height:1.5;"><br><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">try</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;如果需要向其它菜单栏添加命令，将Tools改为其它名称（要使用英文的）<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;关于这些菜单栏的名称，可以查看CommandBar.resx文件</span><span style="color:rgb(0,128,0);line-height:1.5;"><br></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">&nbsp;resourceName;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResourceManager resourceManager&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;">&nbsp;ResourceManager(</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">NEnhancer.CommandBar</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">, Assembly.GetExecutingAssembly());<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CultureInfo cultureInfo&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;">&nbsp;CultureInfo(_applicationObject.LocaleID);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">if</span><span style="line-height:1.5;">(cultureInfo.TwoLetterISOLanguageName&nbsp;</span><span style="line-height:1.5;">==</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">zh</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Globalization.CultureInfo parentCultureInfo&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;">&nbsp;cultureInfo.Parent;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resourceName&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;">&nbsp;String.Concat(parentCultureInfo.Name,&nbsp;</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Tools</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">else</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resourceName&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;">&nbsp;String.Concat(cultureInfo.TwoLetterISOLanguageName,&nbsp;</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Tools</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolsMenuName&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;">&nbsp;resourceManager.GetString(resourceName);<br> &nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">catch</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;如果没能找到，就使用英文版本的名称</span><span style="color:rgb(0,128,0);line-height:1.5;"><br></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolsMenuName&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Tools</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp; }<br><br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;获取VS的主菜单</span><span style="color:rgb(0,128,0);line-height:1.5;"><br></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp; CommandBar menuBarCommandBar&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((CommandBars)_applicationObject.CommandBars)[</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">MenuBar</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">];<br><br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;获取Tools菜单</span><span style="color:rgb(0,128,0);line-height:1.5;"><br></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp; CommandBarControl toolsControl&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;">&nbsp;menuBarCommandBar.Controls[toolsMenuName];<br> &nbsp;&nbsp;&nbsp; CommandBarPopup toolsPopup&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;">&nbsp;(CommandBarPopup)toolsControl;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;如果需要添加多个菜单项，这个try/catch代码块可以多次使用<br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;但别忘了更新QueryStatus/Exec这两个方法</span><span style="color:rgb(0,128,0);line-height:1.5;"><br></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">try</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;向Commands集合添加命令</span><span style="color:rgb(0,128,0);line-height:1.5;"><br></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Command command&nbsp;</span><span style="line-height:1.5;">=</span><span style="line-height:1.5;">&nbsp;commands.AddNamedCommand2(_addInInstance,&nbsp;</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">NEnhancer</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,&nbsp;</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">NEnhancer</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Executes the command for NEnhancer</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">,&nbsp;</span><span style="color:rgb(128,0,128);line-height:1.5;">59</span><span style="line-height:1.5;">,&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">ref</span><span style="line-height:1.5;">&nbsp;contextGUIDS,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">)vsCommandStatus.vsCommandStatusSupported</span><span style="line-height:1.5;">+</span><span style="line-height:1.5;">(</span><span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">)vsCommandStatus.vsCommandStatusEnabled,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">)vsCommandStyle.vsCommandStylePictAndText, vsCommandControlType.vsCommandControlTypeButton);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;向菜单中添加新项</span><span style="color:rgb(0,128,0);line-height:1.5;"><br></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">if</span><span style="line-height:1.5;">((command&nbsp;</span><span style="line-height:1.5;">!=</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">)&nbsp;</span><span style="line-height:1.5;">&amp;&amp;</span><span style="line-height:1.5;">&nbsp;(toolsPopup&nbsp;</span><span style="line-height:1.5;">!=</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; command.AddControl(toolsPopup.CommandBar,&nbsp;</span><span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">catch</span><span style="line-height:1.5;">(System.ArgumentException)<br> &nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;如果引发异常，可能是由于同名的命令已经存在了，可以忽略该异常</span><span style="color:rgb(0,128,0);line-height:1.5;"><br></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp; }</span></span> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(61,129,238);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border-style:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 代码的功能可以查看其中的注释。首先通过资源文件获取Tools菜单的名称（文化相关的），然后是获取主菜单，这里用的就是CommandBar，这里通过名称从<b>DET2.CommandBars</b>集合中进行查找。往下可以看到Tools菜单是主菜单栏下的一个CommandBarPopup控件，获取了Tools菜单后就可以给它添加命令了，其关键是AddNamedCommand2方法，它的参数信息为：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" width="11" height="16" style="border:0px;" alt="ExpandedBlockStart.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">C# Code - Method Signature</span>
    <span style="line-height:1.5;"><br><span style="line-height:1.5;">Command AddNamedCommand2(AddIn AddInInstance,&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">&nbsp;Name,&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">&nbsp;ButtonText,<br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">&nbsp;Tooltip,&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">bool</span><span style="line-height:1.5;">&nbsp;MSOButton,&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">&nbsp;Bitmap,&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">ref</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">[] ContextUIGUIDs,<br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">&nbsp;vsCommandStatusValue,&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">&nbsp;CommandStyleFlags, vsCommandControlType ControlType);</span></span> 
   </div> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">AddInInstance：用作命令对象的AddIn对象</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Name：命令名称</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">ButtonText：当命令显示在菜单或工具栏时的文本</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">ToolTip：命令的提示信息</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">MSOButton：如果是true，表示使用预定义的图标，否则使用自定义的图标</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Bitmap：如果MSOButton值为true，那么该参数的值将用于所用预定义图标的索引；否则用作自定义图标的Id</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">ContextUIGUIDs：VS定义了一些GUID值来标识其状态的改变。比如如果希望进入debug模式命令可用，可将该参数的值设置为vsContextGuidDebugging</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">sCommandStatusValue：命令的默认可用状态</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">CommandStyleFlags：该参数用于控制命令的外观，比如只显示图标、只显示文本或者都显示</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">ControlType：所添加命令对应的UI元素的类型，比如菜单项、组合框等</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">从本文开头举的例子可以看到，对于VS内置的菜单项，它们对应的命令名称是有一定规律的，即按照菜单的嵌套关系，如Edit.Copy，表示Edit下的Copy项（有空格的话要去掉）。那么对于我们的Add-In来说，也是有规律的，即Namespace.ClassName.CommandName，这里就是NEnhancer.Connect.NEnhancer。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">命令的名称应当反应它的意图，所以这里把AddNamedCommand2的第二个参数改为CommandViewer。前面提到过，VS中有很多命令，它们按照命令栏来组织，这里就做一个Add-In来查看所有的命令和命令栏，方便以后的开发。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:medium;"><b>命令的执行</b></span></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">现在命令和菜单项是添加了，当用户点击菜单时，如何处理它呢？要实现IDTCommandTarget接口，一旦实现了它，我们的Connect类就成为一个合格的<b>命令目标</b>（Command Target）了。确切地说，当用户点击菜单时，VS要执行它的Exec方法，Exec方法有如下几个参数：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" width="11" height="16" style="border:0px;" alt="ExpandedBlockStart.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">C# Code - Method Signature</span>
    <span style="line-height:1.5;"><br><span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;">&nbsp;Exec(</span><span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">&nbsp;CmdName, vsCommandExecOption ExecuteOption,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">ref</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">&nbsp;VariantIn,&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">ref</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">&nbsp;VariantOut,&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">ref</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">bool</span><span style="line-height:1.5;">&nbsp;Handled);</span></span> 
   </div> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">CmdName：命令的全称，Add-In中命令的命名规则是Namespace.ClassName.CommandName</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">vsCommandExecOption：绝大多数情况下，该参数的值是vsCommandExecOptionDoDefault值，用于通知Add-In按部就班地行事</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">VariantIn：如果有数据要传给命令，就使用此参数</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">VariantOut：与VariantIn相反，此参数用于向调用者传递数据</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Handler：如果设置为true，VS就知道命令已经执行完毕；如果为false，VS会寻找其它可以执行命令的方法，对Add-In来说，这意味着出错——不可能有其它的地方可以执行我们自定义的命令</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:medium;"><b>命令的状态</b></span></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">有的命令并不总是可用，比如我们开发了一个Add-In，它专门针对于文本编辑器，如果没有任何文件打开，它就不应该是可用的。这里要使用IDTCommandTarget接口的另一个方法QueryStatus，它的参数有：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">CmdName：命令的全称</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">NeededText：当前来说，该参数的值只会是vsCommandStatusTextWantedNone。但是在开发Add-In的时候，强烈建议要对此进行检查，因为VS还保留了其它的可能值作将来之用（可以参考向导生成的代码）</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">StatusOption：这是最重要的参数（ref），我们要给它赋值，告诉VS传入的这个命令是否支持、是否可用或者是否可见，这几种情况可以同时存在，此时对它们可以使用“或”操作。</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">CommandText：此参数当前VS还没有使用，不要给它赋值</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">好了，了解了命令的概念，也知道如何添加、执行命令了，剩下的就是实现命令的功能了。这里要新建一个窗体，添加一个TreeView来显示命令栏和命令：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VisualStudio2008CommandConquerTODO_11DB1/commandbar-viewer-form_2.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="commandbar-viewer-form" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VisualStudio2008CommandConquerTODO_11DB1/commandbar-viewer-form_thumb.jpg" width="464" height="498" style="border:0px rgb(221,221,221);"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><i>图3：CommandBarViewer窗体</i></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">要查看该窗体的具体代码，可以在文章末尾处下载代码。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">现在只要在Connect类中稍作修改显示窗体：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" align="top" width="11" height="16" style="border:0px;" alt="ContractedBlock.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">C# Code - 执行命令</span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 通过这个例子，我们可以了解如何添加新的命令并执行它，其中的关键方法包括OnConnection、AddNamedCommand2、Exec、QueryStatus。本文前面曾提到过<b>命令的命名规则</b>，我们可以由此获知某个菜单项对应的命令，这样就可以在Add-In中使用该命令而不需要再重新发明一次轮子。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:medium;"><b>执行已有命令</b></span></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">先看下图。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VisualStudio2008CommandConquerTODO_11DB1/code-window-tab-context-menu_2.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="code-window-tab-context-menu" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VisualStudio2008CommandConquerTODO_11DB1/code-window-tab-context-menu_thumb.jpg" width="237" height="201" style="border:0px rgb(221,221,221);"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">我们可以关闭当前文档，也可以关闭其它文档，就是不能关闭所有文档。有时候还是需要这个功能的，我想你应该用过Window-&gt;Close All Documents菜单项吧？它实现的正是我们所需要的，现在考虑如何使用这个已有的命令。首先得找到这个命令，按前面的规则，我们到Tools-Options里面去找（见图1），我们可以试着输入window.close，这时就可以看到了：Window.CloseAllDocuments。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">接下来跟前面例子类似，首先要添加一个命令，前面是把命令添加到了主菜单栏（通过“MenuBar”获取命令栏），现在要添加到另外一个命令栏：“Easy MDI Document Window”，这名字有些奇怪（我是在所有的CommandBar中搜了好多次才找到的），在刚才添加Tools菜单项的代码下面添加如下代码：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" align="top" width="11" height="16" style="border:0px;" alt="ContractedBlock.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">C# Code - 添加CloseAllDocuments命令</span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 要使用Window.CloseAllDocuments命令只要一行代码：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" width="11" height="16" style="border:0px;" alt="ExpandedBlockStart.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">C# Code - Execute Command</span>
    <span style="line-height:1.5;"><br><span style="line-height:1.5;">_applicationObject.ExecuteCommand(</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Window.CloseAllDocuments</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,&nbsp;</span><span style="color:rgb(128,0,0);line-height:1.5;">string.Empty</span><span style="line-height:1.5;">);</span></span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 现在菜单项看起来应该是这样的：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VisualStudio2008CommandConquerTODO_11DB1/code-window-tab-context-menu2_2.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="code-window-tab-context-menu2" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VisualStudio2008CommandConquerTODO_11DB1/code-window-tab-context-menu2_thumb.jpg" width="242" height="213" style="border:0px rgb(221,221,221);"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">赶紧试一试吧！这里再提一下，在测试、调试完成之后，如果要发布Add-In，最简单的方法是将dll和.AddIn放在[My Documents Path]\Visual Studio 2008\Addins，同时把那个用来测试的.AddIn文件（如NEnhancer - For Testing.AddIn）移掉。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">代码下载请点击<a href="http://files.cnblogs.com/anderslly/NEnhancer-r8.zip" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;">这里</a>。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>我们身在何处？</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">本文首先介绍了命令和命令栏的概念，正是通过命令VS才可以与Add-In进行交互。然后通过两个例子解释了如何添加、执行命令，以及如何执行VS内置的命令，接下来我们就有办法操作VS的方方面面了：解决方案、项目、文档、代码等等，敬请期待:-)</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>参考</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">《Professional Visual Studio® 2008 Extensibility》<br> 《Working with Microsoft Visual Studio® 2005》</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br></p> 
   <p style="line-height:1.8;"><font color="#333333"><span style="font-size:14px;">本文转自一个程序员的自省博客园博客，原文链接：http://www.cnblogs.com/anderslly/archive/2009/03/09/vs-addin-add-command.html，如需转载请自行联系原作者。</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
