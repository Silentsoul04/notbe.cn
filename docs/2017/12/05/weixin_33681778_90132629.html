<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>谈谈VS中的模板 « NotBeCN</title>
  <meta name="description" content="             基本上，我们每次在VS中新建一个项目（Project）或项（Item）的时候，都用到了它的模板。这些模板给我们提供了一个好的开始。如果你曾经历过从ASP.NET Web Application到AJAX Web Application的升级，就会对此有所体会；如果你是一个开源爱好者，需要...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/12/05/weixin_33681778_90132629.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">谈谈VS中的模板</h1>
    <p class="post-meta">Dec 5, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">基本上，我们每次在VS中新建一个项目（Project）或项（Item）的时候，都用到了它的模板。这些模板给我们提供了一个好的开始。如果你曾经历过从ASP.NET Web Application到AJAX Web Application的升级，就会对此有所体会；如果你是一个开源爱好者，需要在项目中应用大量的开源组件，那么每次的添加引用和配置也会让人厌烦。模板给我们节省了很多时间，并能使同类型的项目/项保持一致。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">在VS中我们可以很方便地导出项目/项模板，可以参考下面两篇文章：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/anderslly/archive/2008/01/20/createProjectTemplateInVs2005.html" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;">在VS2005中创建项目模板来提高开发效率</a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/hjf1223/archive/2008/11/19/project_template.html" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;">制作Visual Studio项目模板</a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">本文将介绍模板的更多内容。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>什么是项目/项模板</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>项目模板包含了创建特定类型的项目所需的必要文件（包括引用）</b>。VS本身就提供了很多内置的项目模板，如Console Application, Class Library和ASP.NET Web Application等等。大部分项目模板基于一种特定的语言，如C#、F#等，同时针对特定的领域，如Windows、Web和Test等等，它们正是以此进行分类组织：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/add-new-proj_6.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="add-new-proj" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/add-new-proj_thumb_2.jpg" width="604" height="369" style="border:0px;"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">这里，创建一个控制台应用程序，</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/create-a-console-application_4.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="create-a-console-application" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/create-a-console-application_thumb_1.jpg" width="281" height="266" style="border:0px;"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">基本的引用已经添加完毕，并且有了一个Program.cs文件，接下来就可以在Main函数编写代码了。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>项模板用于创建逻辑上的单个文件</b>（有时可能是创建了多个文件，比如Web Form模板，不过它们在逻辑上仍被看作单个文件）。这个过程就不再赘述了。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>项目/项模板简析</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">现在该了解一下这些模板是如何实现的了。前面提到，VS内置了很多模板，那就看看它们是怎么做的。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">先来看项目模板，内置的项目模板位于[VS2008 Path]\Common7\IDE\ProjectTemplates，这里可以看到几个以语言名称命名的文件夹，进入CSharp，则是Windows、Web、Test等文件夹，这是前面提到的模板组织方式。继续下去，打开Windows\1033文件夹，可以看多几个zip文件包。从文件名可以想到，VS当中看到的模板就是这里的一个zip包。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">事实正是如此。解压缩ConsoleApplication.zip文件，这里有四个文件：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/contents-of-console-template_2.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="contents-of-console-template" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/contents-of-console-template_thumb.jpg" width="258" height="92" style="border:0px;"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">.cs和.csproj文件就是创建项目后得到的文件，那vstemplate文件呢？它是模板的组织者，没有它，zip包就只是几个零散的文件而已。这个文件称为<b>模板清单</b>（Template Manifest），它实际上就是一个XML文件。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">项模板的情况与此类似，它们位于[VS2008 Path]\Common7\IDE\ItemTemplates。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>模板清单（Template Manifest）</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">清单文件是XML文件，它的Schema文件是[VS2008 Path]\XML\Schemas\1033\vstemplate.xsd，通过xsd文件我们可以了解清单文件的结构。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">它的根节点是&lt;VSTemplate&gt;，该节点有两个Attribute：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Type：指定模板类型（项目模板还是项模板），取值可以是Project、ProjectGroup或Item；</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Version：模板所用于的.NET Framework版本号。</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">该节点在Class文件的模板中是这样的：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&lt;VSTemplate Version="3.0.0" Type="Item" xmlns="<a href="http://schemas.microsoft.com/developer/vstemplate/2005%22" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;">http://schemas.microsoft.com/developer/vstemplate/2005"</a>&gt;<br> &lt;/VSTemplate&gt;</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&lt;VSTemplate&gt;节点可以有四种子节点：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">&lt;TemplateData&gt;：必选项，包含了模板的基本信息，如名称、图标、默认名称等。</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">&lt;TemplateContent&gt;：必选项，指定了模板所包含的文件。</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">&lt;WizardData&gt;：可选项，包含了传给自定义向导的XML数据。</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">&lt;WizardExtension&gt;：可选项，包含了一些自定义模板向导的信息。</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">由于这些节点包含的信息比较多，这里只好偷懒了，它们在MSDN的链接分别是：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">&lt;<a href="http://msdn.microsoft.com/zh-cn/library/hy7dh5te.aspx" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);">TemplateData</a>&gt;</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">&lt;<a href="http://msdn.microsoft.com/zh-cn/library/zfkkzb88.aspx" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);">TemplateContent</a>&gt;</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">&lt;<a href="http://msdn.microsoft.com/zh-cn/library/ms171415.aspx" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);">WizardData</a>&gt;</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">&lt;<a href="http://msdn.microsoft.com/zh-cn/library/ms171411.aspx" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);">WizardExtension</a>&gt;</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">另外还可以看看<a href="http://msdn.microsoft.com/zh-cn/library/6db0hwky(VS.80).aspx" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;">Visual Studio Templates主页</a>，<a href="http://msdn.microsoft.com/zh-cn/library/ms247072(VS.80).aspx" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;">项目模板和项模板之间的区别</a>。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">有了上面这些知识，就可以对清单文件有全面的认识了，下面来看看如何创建模板。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>创建模板</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">项目模板和项模板的创建有所不同，但是都有两种方式：自动方式和手工方式。使用自动方式，跟随VS的向导创建模板，而使用手工方式，则需要编写一些代码，尤其是前面提到的清单文件。一般情况下，自动方式更为简单、快捷，而手工方式则更为强大和灵活。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">手工方式创建模板</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">其过程包含三个步骤：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">创建模板所包含的文件；</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">创建清单文件，编写代码对模板进行配置；</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">部署。</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">首先创建一个类库项目，它的结构如下所示：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/myclasslib-arch_2.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="myclasslib-arch" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/myclasslib-arch_thumb.jpg" width="252" height="100" style="border:0px;"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">接下来在MyClassLibTemplate.vstemplate文件内对模板进行配置：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(61,129,238);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border-style:none;"></a></span>
    </div> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" width="11" height="16" style="border:0px;" alt="ExpandedBlockStart.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">XML Code - 第一个模板清单文件</span>
    <span style="line-height:1.5;"><br><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">VSTemplate&nbsp;</span><span style="color:rgb(255,0,0);line-height:1.5;">Version</span><span style="color:rgb(0,0,255);line-height:1.5;">="2.0.0"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;Type</span><span style="color:rgb(0,0,255);line-height:1.5;">="Project"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;xmlns</span><span style="color:rgb(0,0,255);line-height:1.5;">="http://schemas.microsoft.com/developer/vstemplate/2005"</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">TemplateData</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">Name</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;">My&nbsp;ClassLib&nbsp;Template</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">Name</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">Description</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;">A&nbsp;simple&nbsp;class&nbsp;library&nbsp;template</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">Description</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">ProjectType</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;">CSharp</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">ProjectType</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">ProjectSubType</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">ProjectSubType</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">SortOrder</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;">1000</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">SortOrder</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">CreateNewFolder</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;">true</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">CreateNewFolder</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">DefaultName</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;">MyClassLibProj</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">DefaultName</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">ProvideDefaultName</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;">true</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">ProvideDefaultName</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">LocationField</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;">Enabled</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">LocationField</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">EnableLocationBrowseButton</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;">true</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">EnableLocationBrowseButton</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">Icon</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;">ufo.ico</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">Icon</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">TemplateData</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">TemplateContent</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">Project&nbsp;</span><span style="color:rgb(255,0,0);line-height:1.5;">TargetFileName</span><span style="color:rgb(0,0,255);line-height:1.5;">="MyClassLib.csproj"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;File</span><span style="color:rgb(0,0,255);line-height:1.5;">="MyClassLib.csproj"</span><span style="color:rgb(255,0,0);line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReplaceParameters</span><span style="color:rgb(0,0,255);line-height:1.5;">="true"</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">ProjectItem&nbsp;</span><span style="color:rgb(255,0,0);line-height:1.5;">TargetFileName</span><span style="color:rgb(0,0,255);line-height:1.5;">="SampleClass.cs"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;ReplaceParameters</span><span style="color:rgb(0,0,255);line-height:1.5;">="true"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SampleClass.cs<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">ProjectItem</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">Folder&nbsp;</span><span style="color:rgb(255,0,0);line-height:1.5;">Name</span><span style="color:rgb(0,0,255);line-height:1.5;">="Properties"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;TargetFolderName</span><span style="color:rgb(0,0,255);line-height:1.5;">="Properties"</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">ProjectItem&nbsp;</span><span style="color:rgb(255,0,0);line-height:1.5;">ReplaceParameters</span><span style="color:rgb(0,0,255);line-height:1.5;">="true"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;TargetFileName</span><span style="color:rgb(0,0,255);line-height:1.5;">="AssemblyInfo.cs"</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AssemblyInfo.cs<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">ProjectItem</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">Folder</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">Project</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br></span><span style="color:rgb(0,0,255);line-height:1.5;"></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">TemplateContent</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br></span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">VSTemplate</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span></span> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(61,129,238);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border-style:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 最后是部署。将所有这些文件放在一起（如果有文件夹，要保持它的层次结构），打包为zip文件。将文件拷贝到下面两个路径之一：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">如果是项目模板，拷到[My Documents Path]\Visual Studio 2008\Templates\ProjectTemplates；</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">如果是项模板，拷到[My Documents Path]\Visual Studio 2008\Templates\ItemTemplates。</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">由于刚才创建的模板是项目模板，所以放在第一个路径下。然后打开VS 2008，新建一个项目，在My Templates下可以看到我们自定义的模板：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/add-a-custom-project_2.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="add-a-custom-project" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/add-a-custom-project_thumb.jpg" width="604" height="392" style="border:0px;"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">关于以自动（向导）方式创建模板，可以参考本文开头提到的两篇文章。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>自定义模板</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">前面的例子很简单，甚至是过于简单了。在真实的开发中，可能需要向模板传递一些参数。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">首先，需要在文件中插入占位符，如<span class="MathJax" style="line-height:1.8;word-spacing:normal;border:0px;"><span class="math" style="border:0px;vertical-align:0px;line-height:1.8;"><span style="border:0px;vertical-align:0px;line-height:1.8;font-size:16.24px;"><span style="border:0px;vertical-align:0px;line-height:1.8;"><span class="mrow" style="border:0px;vertical-align:0px;line-height:1.8;"><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">A</span><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">u</span><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">t</span><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">h</span><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">o</span><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">r</span></span><span style="border:0px;vertical-align:0px;line-height:1.8;width:0px;"></span></span></span><span style="border-width:0px;border-left-style:solid;vertical-align:-.068em;line-height:1.8;width:0px;"></span></span><span class="MJX_Assistive_MathML" style="border:0px;vertical-align:0px;line-height:1.8;width:1px;">Author</span></span>，Author就是参数的名称。看下面的例子：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(61,129,238);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border-style:none;"></a></span>
    </div> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" width="11" height="16" style="border:0px;" alt="ExpandedBlockStart.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">C# Code - 设置模板参数占位符</span>
    <span style="line-height:1.5;"><br><span style="color:rgb(0,0,255);line-height:1.5;">namespace</span><span style="line-height:1.5;">&nbsp;ClassLibrary1<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Company:&nbsp;<span class="MathJax" style="word-spacing:normal;border:0px;line-height:1.5;"><span class="math" style="line-height:normal;border:0px;vertical-align:0px;"><span style="line-height:normal;border:0px;vertical-align:0px;"><span style="line-height:normal;border:0px;vertical-align:0px;"><span class="mrow" style="line-height:normal;border:0px;vertical-align:0px;"><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">C<span style="line-height:normal;border:0px;vertical-align:0px;font-family:'Courier New';"></span></span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">o</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">m</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">p</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">a</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">n</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">y<span style="line-height:normal;border:0px;vertical-align:0px;font-family:'Courier New';"></span></span></span><span style="line-height:normal;border:0px;vertical-align:0px;width:0px;"></span></span></span><span style="line-height:normal;border-width:0px;border-left-style:solid;vertical-align:-.329em;width:0px;"></span></span><span class="MJX_Assistive_MathML" style="border:0px;line-height:normal;vertical-align:0px;width:1px;">Company</span></span><br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Created&nbsp;By:&nbsp;<span class="MathJax" style="word-spacing:normal;border:0px;line-height:1.5;"><span class="math" style="line-height:normal;border:0px;vertical-align:0px;"><span style="line-height:normal;border:0px;vertical-align:0px;"><span style="line-height:normal;border:0px;vertical-align:0px;"><span class="mrow" style="line-height:normal;border:0px;vertical-align:0px;"><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">A</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">u</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">t</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">h</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">o</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">r</span></span><span style="line-height:normal;border:0px;vertical-align:0px;width:0px;"></span></span></span><span style="line-height:normal;border-width:0px;border-left-style:solid;vertical-align:-.079em;width:0px;"></span></span><span class="MJX_Assistive_MathML" style="border:0px;line-height:normal;vertical-align:0px;width:1px;">Author</span></span></span><span style="color:rgb(0,128,0);line-height:1.5;"><br></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;">&nbsp;SampleClass<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> }</span></span> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(61,129,238);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border-style:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 接下来需要在模板清单文件中定义这些参数和它们的值，向&lt;TemplateContent&gt;节点中添加&lt;CustomParameters&gt;节点：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" width="11" height="16" style="border:0px;" alt="ExpandedBlockStart.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">XML Code - 设置参数值</span>
    <span style="line-height:1.5;"><br><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">CustomParameters</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">CustomParameter&nbsp;</span><span style="color:rgb(255,0,0);line-height:1.5;">Name</span><span style="color:rgb(0,0,255);line-height:1.5;">="<span class="MathJax" style="word-spacing:normal;border:0px;line-height:1.5;"><span class="math" style="line-height:normal;border:0px;vertical-align:0px;"><span style="line-height:normal;border:0px;vertical-align:0px;"><span style="line-height:normal;border:0px;vertical-align:0px;"><span class="mrow" style="line-height:normal;border:0px;vertical-align:0px;"><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">C<span style="line-height:normal;border:0px;vertical-align:0px;font-family:'Courier New';"></span></span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">o</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">m</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">p</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">a</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">n</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">y<span style="line-height:normal;border:0px;vertical-align:0px;font-family:'Courier New';"></span></span></span><span style="line-height:normal;border:0px;vertical-align:0px;width:0px;"></span></span></span><span style="line-height:normal;border-width:0px;border-left-style:solid;vertical-align:-.329em;width:0px;"></span></span><span class="MJX_Assistive_MathML" style="border:0px;line-height:normal;vertical-align:0px;width:1px;">Company</span></span>"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;Value</span><span style="color:rgb(0,0,255);line-height:1.5;">="my company"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">/&gt;</span><span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">CustomParameter&nbsp;</span><span style="color:rgb(255,0,0);line-height:1.5;">Name</span><span style="color:rgb(0,0,255);line-height:1.5;">="<span class="MathJax" style="word-spacing:normal;border:0px;line-height:1.5;"><span class="math" style="line-height:normal;border:0px;vertical-align:0px;"><span style="line-height:normal;border:0px;vertical-align:0px;"><span style="line-height:normal;border:0px;vertical-align:0px;"><span class="mrow" style="line-height:normal;border:0px;vertical-align:0px;"><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">A</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">u</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">t</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">h</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">o</span><span class="mi" style="font-family:'MathJax_Math-italic';line-height:normal;border:0px;vertical-align:0px;">r</span></span><span style="line-height:normal;border:0px;vertical-align:0px;width:0px;"></span></span></span><span style="line-height:normal;border-width:0px;border-left-style:solid;vertical-align:-.079em;width:0px;"></span></span><span class="MJX_Assistive_MathML" style="border:0px;line-height:normal;vertical-align:0px;width:1px;">Author</span></span>"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;Value</span><span style="color:rgb(0,0,255);line-height:1.5;">="Anders&nbsp;Cui"</span><span style="color:rgb(255,0,0);line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">/&gt;</span><span style="line-height:1.5;"><br></span><span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">CustomParameters</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span></span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 好了，现在重新部署这个模板，添加一个新项目，得到的文件是：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(61,129,238);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border-style:none;"></a></span>
    </div> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top" width="11" height="16" style="border:0px;" alt="ExpandedBlockStart.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">C# Code - 使用参数之后</span>
    <span style="line-height:1.5;"><br><span style="color:rgb(0,0,255);line-height:1.5;">namespace</span><span style="line-height:1.5;">&nbsp;ClassLibrary1<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Company: my company<br> &nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Created&nbsp;By: Anders Cui</span><span style="color:rgb(0,128,0);line-height:1.5;"><br></span><span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;">&nbsp;</span><span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;">&nbsp;SampleClass<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> }</span></span> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(61,129,238);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border-style:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 需要注意的是，相关ProjectItem的ReplaceParameters特性值要为“true”。现在，如果模板中有10个文件用到了<span class="MathJax" style="line-height:1.8;word-spacing:normal;border:0px;"><span class="math" style="border:0px;vertical-align:0px;line-height:1.8;"><span style="border:0px;vertical-align:0px;line-height:1.8;font-size:16.24px;"><span style="border:0px;vertical-align:0px;line-height:1.8;"><span class="mrow" style="border:0px;vertical-align:0px;line-height:1.8;"><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">A</span><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">u</span><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">t</span><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">h</span><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">o</span><span class="mi" style="border:0px;vertical-align:0px;line-height:1.8;font-family:'MathJax_Math-italic';">r</span></span><span style="border:0px;vertical-align:0px;line-height:1.8;width:0px;"></span></span></span><span style="border-width:0px;border-left-style:solid;vertical-align:-.068em;line-height:1.8;width:0px;"></span></span><span class="MJX_Assistive_MathML" style="border:0px;vertical-align:0px;line-height:1.8;width:1px;">Author</span></span>，就能节省不少时间了，不过我还是不满足，能不能在运行时获取用户的输入呢？看看下一节关于向导的内容。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>自定义模板向导</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">VS模板的一个增强特性就是自定义向导，这些向导可以在用户由模板创建项目/项的时候运行。向导的好处在于可以：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">收集用户的输入信息；</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">向模板添加参数值；</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">向项目添加其它文件；</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">使用模板向导，可以访问DTE对象（Development Tools Extensibility，是Visual Studio自动化对象模型中的主对象），从而可以方便地操作项目。创建模板向导的基本步骤为：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">创建一个程序集，它要实现IWizard接口；</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">将该程序集注册到GAC（Global Assembly Cache）；</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">更新模板清单文件，使用该程序集。</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">这里将继续使用上面的例子，不过这次要从用户界面收集参数值，而不是把它们放在模板清单中。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">先来实现IWizard接口，该接口有6个方法，这些方法会在项目模板生命周期的特定时刻执行，其中的部分方法仅适用于项模板，它们的详情请参考：<a href="http://msdn.microsoft.com/zh-cn/library/microsoft.visualstudio.templatewizard.iwizard_members(VS.80).aspx" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;">IWizard成员</a>。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><i>当Visual Studio开始创建项目时，它立即调用RunStarted方法，因此该方法是收集用户输入信息的良好位置</i>。它有四个参数：</p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Object 参数，可强制转换为根 _DTE 对象，以使您能够自定义项目。</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Dictionary 参数，它包含模板中所有预定义参数的集合。</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">WizardRunKind 参数，它包含有关所使用的模板种类的信息。</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Object 数组，它包含通过 Visual Studio 传递给向导的一组参数。</li> 
   </ul>
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">在本例中，将来自用户的输入添加到Dictionary参数中。好了，现在可以开始编码了，新建一个类库项目，名称为CustomTemplateWizard，新建一个Windows Form，用来接受用户输入，界面大体如下：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><img src="https://pic002.cnblogs.com/img/anderslly/200901/2009011822333914.jpg" style="border:0px;" alt="2009011822333914.jpg"></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">其代码为：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" align="top" width="11" height="16" style="border:0px;" alt="ContractedBlock.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">C# Code - 接受用户输入的窗体</span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 下面的类WizardImpl实现了IWizard接口：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" align="top" width="11" height="16" style="border:0px;" alt="ContractedBlock.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">C# Code - 实现IWizard接口的类WizardImpl</span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 然后，编译项目，为项目添加强命名，接着注册到GAC（Global Assembly Cache）。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">接下来要修改模板清单文件，来使用新出炉的程序集，这要在&lt;/TemplateContent&gt;之后添加：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <img src="http://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" align="top" width="11" height="16" style="border:0px;" alt="ContractedBlock.gif">
    <span class="cnblogs_code_Collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">XML Code - 添加对程序集的引用</span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br> 这些都完成后，跟前面一样，打包、部署，然后打开VS，新建一个项目，此时出现一个对话框，在这里输入信息：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/info-collector2_2.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="info-collector2" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/info-collector2_thumb.jpg" width="304" height="206" style="border:0px;"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">点击确定，生成的文件中可以看到参数已被替换：</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://www.cnblogs.com/images/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/replacedfile_2.jpg" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;"><img alt="replacedfile" src="https://images.cnblogs.com/cnblogs_com/anderslly/WindowsLiveWriter/VS_C7BD/replacedfile_thumb.jpg" width="282" height="154" style="border:0px;"></a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>初学者工具包（Starter Kits）</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">初学者工具包是一种特殊的项目模板，用于与其他开发人员分享示例代码和代码资源，可以看作是加强版的项目模板。初学者工具包往往包含了项目模板的所有内容，还可能包含额外的文档内容。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>小结</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">本文首先简单介绍了项目/项模板的概念，然后介绍了模板及其清单文件的结构，在此基础上演示了如何手工创建并部署模板。最后讨论了两种更为灵活和强大的方式：向模板传递参数以及自定义模板向导，后者借助于DTE对象可以完成很复杂的功能。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><b>参考</b></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">《Professional Visual Studio® 2008 Extensibility》</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><a href="http://msdn.microsoft.com/zh-cn/library/6db0hwky(VS.80).aspx" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;">MSDN</a></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br></p> 
   <p style="line-height:1.8;"><font color="#333333"><span style="font-size:14px;">本文转自一个程序员的自省博客园博客，原文链接：http://www.cnblogs.com/anderslly/archive/2009/01/18/vs2008-templates.html，如需转载请自行联系原作者。</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
