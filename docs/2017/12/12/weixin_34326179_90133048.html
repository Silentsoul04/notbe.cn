<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Javascript图表插件HighCharts用法案例 « NotBeCN</title>
  <meta name="description" content="             最近还在忙着基于ABP的项目，但本篇博客和ABP无关，喜欢ABP框架的朋友请点击传送门。    这不，最近项目基本功能做的差不多了，现在在做一个数据统计的功能，需要绘制区域图（或折线图）和饼图。一开始，楼主就去Google了一下最常用的绘图插件都有哪些，最后直接去Github上搜索关键词...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/12/12/weixin_34326179_90133048.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Javascript图表插件HighCharts用法案例</h1>
    <p class="post-meta">Dec 12, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">最近还在忙着基于ABP的项目，但本篇博客和ABP无关，喜欢ABP框架的朋友请点击<strong><a href="http://www.cnblogs.com/farb/p/ABPTheory.html" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">传送门</a></strong>。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这不，最近项目基本功能做的差不多了，现在在做一个数据统计的功能，需要绘制区域图（或折线图）和饼图。一开始，楼主就去Google了一下最常用的绘图插件都有哪些，最后直接去Github上搜索关键词chart，搜索结果如下：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="https://dn-coding-net-production-pp.qbox.me/7f9e056b-a866-4240-86b1-9478b54ce2f2.png?imageView2/2/w/500/h/500&amp;imageMogr2/format/png" style="border:0px;" alt="png"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">点了几个进去看了之后，楼主考虑到项目要以后肯定要维护，万一维护的开发者英文不咋地呢（其实楼主我是喜欢看英文文档的）？所以，我起初选择了某度出品的Echarts.js。但是选择了它之后，查看文档学习，虽然文档是中文的，但我感觉这文档比英文还难读懂，因为有些术语解释不详细，最后好不容易做了个demo，但还出现了bug，开了一个<strong><a href="https://github.com/ecomfe/echarts/issues/2879" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">Issue</a></strong>，维护人员简单地敷衍之后反而直接给关了，楼主表示很受伤也很气愤。心想，好吧，你某度牛逼，我不用你的Echarts行了吧，惹不起还躲不起嘛。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">最后，经过几个朋友的介绍，他们都选择的Highcharts，去Highcharts官网看了下，感觉文档就是比Echarts详细，简单易懂，所以我也就选择了她。【这里建议新手朋友们先使用Highcharts，等对图表熟悉了再使用Echarts，毕竟Echarts的图表种类很丰富】而且，到现在，功能也都实现了，效果如下：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="https://dn-coding-net-production-pp.qbox.me/c2c3becb-d6cf-4c3d-89d4-9b0580ecb93d.png" alt="图片" style="border:0px;"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="https://dn-coding-net-production-pp.qbox.me/6206ed44-fe1b-4f3d-99b3-bf6d5bd76c20.png" alt="图片" style="border:0px;"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">楼主在学习的时候，发现网上这方面的资料也不是很多，尤其是从服务端如何传数据到客户端，没有详细的解决方案，也是摸索了很久，这次，我直接将自己的解决方案拿出来和大家分享，供初学者参考，少走弯路，大神请绕道。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">区域图</h3> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-html"><code class="sourceCode html hljs xml" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"row"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"portlet light bordered"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"portlet-title"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"caption"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">i</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"fa fa-area-chart font-purple"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">i</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">span</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"caption-subject bold uppercase"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span>收入趋势<span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">span</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"portlet-body"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">id</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"incomeTrend"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">style</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"width:98%;height: 500px"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> </code></code></pre>
   </div> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> dateSpan<span class="op">;</span> <span class="va">Highcharts</span>.<span class="at">setOptions</span>(<span class="op">{</span> <span class="dt">lang</span><span class="op">:</span> <span class="op">{</span> <span class="dt">printChart</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'打印图表'</span></span><span class="op">,</span> <span class="dt">downloadJPEG</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'下载为JPEG图片'</span></span><span class="op">,</span> <span class="dt">downloadPDF</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'下载为PDF'</span></span><span class="op">,</span> <span class="dt">downloadPNG</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'下载为PNG图片'</span></span><span class="op">,</span> <span class="dt">downloadSVG</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'下载为SVG矢量图'</span></span><span class="op">,</span> <span class="dt">months</span><span class="op">:</span> [<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"一月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"二月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"三月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"四月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"五月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"六月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"七月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"八月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"九月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"十月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"十一月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"十二月"</span></span>]<span class="op">,</span> <span class="dt">weekdays</span><span class="op">:</span> [<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"周日"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"周一"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"周二"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"周三"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"周四"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"周五"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"周六"</span></span>]<span class="op">,</span> <span class="dt">shortMonths</span><span class="op">:</span> [<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"1月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"2月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"3月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"4月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"5月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"6月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"7月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"8月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"9月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"10月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"11月"</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"12月"</span></span>]<span class="op">,</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> isByDay <span class="op">=</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">true</span></span><span class="op">;</span><span class="co"><span class="hljs-comment" style="color:#008000;">//default by days</span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> option <span class="op">=</span> <span class="op">{</span> <span class="dt">chart</span><span class="op">:</span> <span class="op">{</span> <span class="dt">type</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'area'</span></span> <span class="op">},</span> <span class="dt">title</span><span class="op">:</span> <span class="op">{</span> <span class="dt">text</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'收入趋势图'</span></span> <span class="op">},</span> <span class="dt">subtitle</span><span class="op">:</span> <span class="op">{</span> <span class="dt">text</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'没有选择时间范围的话，默认显示最近7天的数据'</span></span> <span class="op">},</span> <span class="dt">credits</span><span class="op">:</span> <span class="op">{</span> <span class="dt">enabled</span><span class="op">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">false</span></span> <span class="op">},</span> <span class="dt">xAxis</span><span class="op">:</span> <span class="op">{</span> <span class="dt">type</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'datetime'</span></span><span class="op">,</span> <span class="dt">tickmarkPlacement</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'on'</span></span><span class="op">,</span> <span class="dt">title</span><span class="op">:</span> <span class="op">{</span> <span class="dt">enabled</span><span class="op">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">false</span></span> <span class="op">},</span> <span class="dt">dateTimeLabelFormats</span><span class="op">:</span> <span class="op">{</span> <span class="dt">day</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"%Y-%m-%d"</span></span><span class="op">,</span> <span class="dt">week</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"%A"</span></span><span class="op">,</span> <span class="dt">month</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"%Y-%m"</span></span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"%Y"</span></span> <span class="op">}</span> <span class="op">},</span> <span class="dt">yAxis</span><span class="op">:</span> <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="op">{</span> <span class="dt">text</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'单位：元'</span></span> <span class="op">},</span> <span class="dt">labels</span><span class="op">:</span> <span class="op">{</span> <span class="dt">formatter</span><span class="op">:</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function"> (<span class="hljs-params"></span>) </span><span class="op">{</span> <span class="cf"><span class="hljs-keyword" style="color:rgb(0,0,255);">return</span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">this</span></span>.<span class="at">value</span><span class="op">;</span> <span class="op">}</span> <span class="op">}</span> <span class="op">},</span> <span class="dt">tooltip</span><span class="op">:</span> <span class="op">{</span> <span class="dt">shared</span><span class="op">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">true</span></span><span class="op">,</span> <span class="dt">valueSuffix</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">' 元'</span></span><span class="op">,</span> <span class="dt">dateTimeLabelFormats</span><span class="op">:</span> <span class="op">{</span> <span class="dt">day</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"%Y-%m-%d,%A"</span></span><span class="op">,</span> <span class="dt">week</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"%A开始, %Y-%m-%d"</span></span><span class="op">,</span> <span class="dt">month</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"%Y-%m"</span></span><span class="op">,</span> <span class="dt">year</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"%Y"</span></span> <span class="op">}</span> <span class="op">},</span> <span class="dt">plotOptions</span><span class="op">:</span> <span class="op">{</span> <span class="dt">area</span><span class="op">:</span> <span class="op">{</span> <span class="dt">stacking</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'normal'</span></span><span class="op">,</span> <span class="dt">lineColor</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#666666'</span></span><span class="op">,</span> <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">marker</span><span class="op">:</span> <span class="op">{</span> <span class="dt">lineWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">lineColor</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#666666'</span></span> <span class="op">}</span> <span class="op">},</span> <span class="dt">series</span><span class="op">:</span> <span class="op">{</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//pointStart: Date.UTC(nowDate.getFullYear(), nowDate.getMonth(), nowDate.getDate() - 7),</span></span> <span class="co"><span class="hljs-comment" style="color:#008000;">//pointInterval: 24 * 36e5 //一天</span></span> <span class="op">}</span> <span class="op">},</span> <span class="dt">series</span><span class="op">:</span> [<span class="op">{}</span>] <span class="op">}</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> url <span class="op">=</span> <span class="at">getTargetUrl</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'Dashboard'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"GetJsonResult"</span></span>)<span class="op">;</span><span class="co"><span class="hljs-comment" style="color:#008000;">//这里是url</span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> drp <span class="op">=</span> <span class="at">$</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#dateRange'</span></span>).<span class="at">data</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'daterangepicker'</span></span>)<span class="op">;</span> <span class="cf"><span class="hljs-keyword" style="color:rgb(0,0,255);">if</span></span> (<span class="op">!</span>dateSpan) <span class="op">{</span> dateSpan <span class="op">=</span> <span class="op">{</span> <span class="dt">start</span><span class="op">:</span> <span class="va">drp</span>.<span class="va">startDate</span>.<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'YYYY-MM-DD'</span></span>)<span class="op">,</span> <span class="dt">end</span><span class="op">:</span> <span class="va">drp</span>.<span class="va">endDate</span>.<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'YYYY-MM-DD'</span></span>) <span class="op">}</span> <span class="op">}</span> <span class="at">rawChart</span>(isByDay)<span class="op">;</span> <span class="at">$</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#createChart'</span></span>).<span class="at">click</span>(<span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function"> (<span class="hljs-params">e</span>) </span><span class="op">{</span> <span class="cf"><span class="hljs-keyword" style="color:rgb(0,0,255);">if</span></span> (<span class="at">$</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#byMonth'</span></span>).<span class="at">attr</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'checked'</span></span>)) <span class="op">{</span><span class="co"><span class="hljs-comment" style="color:#008000;">//按月</span></span> isByDay <span class="op">=</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">false</span></span><span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//alert('选择了' + $('#byMonth').attr('checked'));</span></span> <span class="op">}</span> <span class="va">e</span>.<span class="at">preventDefault</span>()<span class="op">;</span> <span class="at">drawChart</span>(isByDay)<span class="op">;</span> <span class="at">drawPieChart</span>(isByDay)<span class="op">;</span> <span class="op">}</span>)<span class="op">;</span> <span class="at">$</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#defaultChart'</span></span>).<span class="at">click</span>(<span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function"> (<span class="hljs-params">e</span>) </span><span class="op">{</span> <span class="va">e</span>.<span class="at">preventDefault</span>()<span class="op">;</span> <span class="va">drp</span>.<span class="at">setStartDate</span>(<span class="at">moment</span>().<span class="at">subtract</span>(<span class="dv">7</span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"days"</span></span>))<span class="op">;</span> <span class="va">drp</span>.<span class="at">setEndDate</span>(<span class="at">moment</span>().<span class="at">subtract</span>(<span class="dv">1</span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"days"</span></span>))<span class="op">;</span> dateSpan <span class="op">=</span> <span class="op">{</span> <span class="dt">start</span><span class="op">:</span> <span class="va">drp</span>.<span class="va">startDate</span>.<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'YYYY-MM-DD'</span></span>)<span class="op">,</span> <span class="dt">end</span><span class="op">:</span> <span class="va">drp</span>.<span class="va">endDate</span>.<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'YYYY-MM-DD'</span></span>) <span class="op">};</span> <span class="at">$</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#dateRange'</span></span>).<span class="at">val</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">''</span></span>)<span class="op">;</span> isByDay <span class="op">=</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">true</span></span><span class="op">;</span> <span class="at">drawChart</span>(isByDay)<span class="op">;</span> <span class="at">drawPieChart</span>(isByDay)<span class="op">;</span> <span class="op">}</span>)<span class="op">;</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function"> </span><span class="at"><span class="hljs-function"><span class="hljs-title" style="color:rgb(163,21,21);">drawChart</span></span></span><span class="hljs-function">(<span class="hljs-params">isByDay</span>) </span><span class="op">{</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> year <span class="op">=</span> <span class="at">moment</span>(<span class="va">dateSpan</span>.<span class="at">start</span>).<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'YYYY'</span></span>)<span class="op">;</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> month <span class="op">=</span> <span class="at">moment</span>(<span class="va">dateSpan</span>.<span class="at">start</span>).<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'M'</span></span>) <span class="op">-</span> <span class="dv">1</span><span class="op">;</span><span class="co"><span class="hljs-comment" style="color:#008000;">//js的date函数的月份是从0-11，所以这里减1</span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> day <span class="op">=</span> <span class="at">moment</span>(<span class="va">dateSpan</span>.<span class="at">start</span>).<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'D'</span></span>)<span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//console.log(year,month,day);</span></span> <span class="cf"><span class="hljs-keyword" style="color:rgb(0,0,255);">if</span></span> (isByDay) <span class="op">{</span> <span class="va">$</span>.<span class="at">getJSON</span>(url<span class="op">,</span> dateSpan<span class="op">,</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function"> (<span class="hljs-params">datas</span>) </span><span class="op">{</span> <span class="va">option</span>.<span class="at">series</span> <span class="op">=</span> datas<span class="op">;</span> <span class="va">option</span>.<span class="va">plotOptions</span>.<span class="va">series</span>.<span class="at">pointStart</span> <span class="op">=</span> <span class="va"><span class="hljs-built_in" style="color:rgb(0,0,255);">Date</span></span>.<span class="at">UTC</span>(year<span class="op">,</span> month<span class="op">,</span> day)<span class="op">;</span> <span class="va">option</span>.<span class="va">plotOptions</span>.<span class="va">series</span>.<span class="at">pointInterval</span> <span class="op">=</span> <span class="dv">24</span> <span class="op">*</span> <span class="fl">36e5</span><span class="op">;</span> <span class="at">$</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#incomeTrend'</span></span>).<span class="at">highcharts</span>(option)<span class="op">;</span> <span class="op">}</span>)<span class="op">;</span> <span class="op">}</span> <span class="cf"><span class="hljs-keyword" style="color:rgb(0,0,255);">else</span></span> <span class="op">{</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> start <span class="op">=</span> <span class="va">drp</span>.<span class="va">startDate</span>.<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'YYYY-MM'</span></span>)<span class="op">;</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> end <span class="op">=</span> <span class="va">drp</span>.<span class="va">endDate</span>.<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'YYYY-MM'</span></span>)<span class="op">;</span> <span class="cf"><span class="hljs-keyword" style="color:rgb(0,0,255);">if</span></span> (start <span class="op">==</span> end) <span class="op">{</span> start <span class="op">=</span> <span class="va">drp</span>.<span class="va">startDate</span>.<span class="at">subtract</span>(<span class="dv">5</span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"month"</span></span>).<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'YYYY-MM'</span></span>)<span class="op">;</span> <span class="op">}</span> year <span class="op">=</span> <span class="at">moment</span>(start).<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'YYYY'</span></span>)<span class="op">;</span> month <span class="op">=</span> <span class="at">moment</span>(start).<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'M'</span></span>)<span class="op">-</span><span class="dv">1</span><span class="op">;</span> dateSpan <span class="op">=</span> <span class="op">{</span> <span class="dt">start</span><span class="op">:</span> start<span class="op">,</span> <span class="dt">end</span><span class="op">:</span> end <span class="op">};</span> <span class="va">$</span>.<span class="at">getJSON</span>(url<span class="op">,</span> dateSpan<span class="op">,</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function"> (<span class="hljs-params">datas</span>) </span><span class="op">{</span> <span class="va">option</span>.<span class="at">series</span> <span class="op">=</span> datas<span class="op">;</span> <span class="va">option</span>.<span class="va">plotOptions</span>.<span class="va">series</span>.<span class="at">pointStart</span> <span class="op">=</span> <span class="va"><span class="hljs-built_in" style="color:rgb(0,0,255);">Date</span></span>.<span class="at">UTC</span>(year<span class="op">,</span> month<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="va">option</span>.<span class="va">plotOptions</span>.<span class="va">series</span>.<span class="at">pointInterval</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="va">option</span>.<span class="va">plotOptions</span>.<span class="va">series</span>.<span class="at">pointIntervalUnit</span> <span class="op">=</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"month"</span></span><span class="op">;</span> <span class="at">$</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#incomeTrend'</span></span>).<span class="at">highcharts</span>(option)<span class="op">;</span> <span class="op">}</span>)<span class="op">;</span> <span class="op">}</span> <span class="op">}</span> </code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>注意：</strong>&nbsp;区域图和饼图公用同一个action，所以代码一起放到最后。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">饼图</h3> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-html"><code class="sourceCode html hljs xml" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"row"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"portlet light bordered col-md-8"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"portlet-title"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"caption"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">i</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"fa fa-adjust font-red"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">i</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">span</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"caption-subject bold uppercase"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span>收入比例<span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">span</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">class</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"portlet-body"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">div</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">id</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"incomeRatio"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">style</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"width:90%;height: 500px"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">div</span>&gt;</span></span> </code></code></pre>
   </div> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> pieChartOption <span class="op">=</span> <span class="op">{</span> <span class="dt">chart</span><span class="op">:</span> <span class="op">{</span> <span class="dt">plotBackgroundColor</span><span class="op">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">null</span></span><span class="op">,</span> <span class="dt">plotBorderWidth</span><span class="op">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">null</span></span><span class="op">,</span> <span class="dt">plotShadow</span><span class="op">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">false</span></span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'pie'</span></span> <span class="op">},</span> <span class="dt">title</span><span class="op">:</span> <span class="op">{</span> <span class="dt">text</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">''</span></span> <span class="op">},</span> <span class="dt">credits</span><span class="op">:</span> <span class="op">{</span> <span class="dt">enabled</span><span class="op">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">false</span></span> <span class="op">},</span> <span class="dt">tooltip</span><span class="op">:</span> <span class="op">{</span> <span class="dt">pointFormat</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'{series.name}: &lt;b&gt;{point.percentage:.1f}%&lt;/b&gt;'</span></span> <span class="op">},</span> <span class="dt">plotOptions</span><span class="op">:</span> <span class="op">{</span> <span class="dt">pie</span><span class="op">:</span> <span class="op">{</span> <span class="dt">allowPointSelect</span><span class="op">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">true</span></span><span class="op">,</span> <span class="dt">cursor</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'pointer'</span></span><span class="op">,</span> <span class="dt">dataLabels</span><span class="op">:</span> <span class="op">{</span> <span class="dt">enabled</span><span class="op">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">true</span></span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'&lt;b&gt;{point.name}&lt;/b&gt;: {point.percentage:.1f}%&lt;br/&gt; {y}元 '</span></span><span class="op">,</span> <span class="dt">style</span><span class="op">:</span> <span class="op">{</span> <span class="dt">color</span><span class="op">:</span> (<span class="va">Highcharts</span>.<span class="at">theme</span> <span class="op">&amp;&amp;</span> <span class="va">Highcharts</span>.<span class="va">theme</span>.<span class="at">contrastTextColor</span>) <span class="op">||</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'black'</span></span> <span class="op">}</span> <span class="op">}</span> <span class="op">}</span> <span class="op">},</span> <span class="dt">series</span><span class="op">:</span> [ <span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'占比'</span></span><span class="op">,</span> <span class="dt">colorByPoint</span><span class="op">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">true</span></span><span class="op">,</span> <span class="dt">data</span><span class="op">:</span> [] <span class="op">}</span> ] <span class="op">};</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function"> </span><span class="at"><span class="hljs-function"><span class="hljs-title" style="color:rgb(163,21,21);">drawPieChart</span></span></span><span class="hljs-function">(<span class="hljs-params"></span>) </span><span class="op">{</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> year <span class="op">=</span> <span class="at">moment</span>(<span class="va">dateSpan</span>.<span class="at">start</span>).<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'YYYY'</span></span>)<span class="op">;</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> month <span class="op">=</span> <span class="at">moment</span>(<span class="va">dateSpan</span>.<span class="at">start</span>).<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'M'</span></span>) <span class="op">-</span> <span class="dv">1</span><span class="op">;</span><span class="co"><span class="hljs-comment" style="color:#008000;">//js的date函数的月份是从0-11，所以这里减1</span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> day <span class="op">=</span> <span class="at">moment</span>(<span class="va">dateSpan</span>.<span class="at">start</span>).<span class="at">format</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'D'</span></span>)<span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//console.log(year,month,day);</span></span> <span class="va">$</span>.<span class="at">getJSON</span>(url <span class="op">+</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"?chartType=pie"</span></span><span class="op">,</span> dateSpan<span class="op">,</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function"> (<span class="hljs-params">datas</span>) </span><span class="op">{</span> <span class="va">pieChartOption</span>.<span class="at">series</span>[<span class="dv">0</span>].<span class="at">data</span> <span class="op">=</span> datas<span class="op">;</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> sum<span class="op">=</span><span class="dv">0</span><span class="op">;</span> <span class="cf"><span class="hljs-keyword" style="color:rgb(0,0,255);">for</span></span> (<span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">datas</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span> sum <span class="op">+=</span> datas[i].<span class="at">y</span><span class="op">;</span> <span class="op">}</span> <span class="va">pieChartOption</span>.<span class="va">title</span>.<span class="at">text</span> <span class="op">=</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"收入比例情况：（总收入"</span></span><span class="op">+</span>sum<span class="op">+</span><span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"）元"</span></span><span class="op">;</span> <span class="at">$</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#incomeRatio'</span></span>).<span class="at">highcharts</span>(pieChartOption)<span class="op">;</span> <span class="op">}</span>)<span class="op">;</span> <span class="op">}</span> <span class="at">drawPieChart</span>()<span class="op">;</span> </code></code></pre>
   </div> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">服务端Web层的C#代码如下：</h4> 
   <pre class="c#"><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">        <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">async</span> Task&lt;ContentResult&gt; <span class="hljs-title" style="color:rgb(163,21,21);">GetJsonResult</span>(<span class="hljs-params"><span class="hljs-keyword" style="color:rgb(0,0,255);">string</span> start, <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span> end</span>) </span>{
            <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span> dataJsonStr;
            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> defaultStart = DateTime.Parse(start);
            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> defaultEnd = DateTime.Parse(end);
            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> timeSpan = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> DateTimeSpan { Start = defaultStart, End = defaultEnd };
            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> totalIncomeList = <span class="hljs-keyword" style="color:rgb(0,0,255);">await</span> _orderAppService.GetDateIncome(<span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> GetDateIncomeDto
            {
                Start = defaultStart,
                End = defaultEnd
            });<span class="hljs-comment" style="color:#008000;">//总收入</span>

            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> scanCodeChargeIncomeList = <span class="hljs-keyword" style="color:rgb(0,0,255);">await</span> _orderAppService.GetDateIncome(<span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> GetDateIncomeDto
            {
                Start = defaultStart,
                End = defaultEnd,
                IsScanCodeChargingIncome = <span class="hljs-keyword" style="color:rgb(0,0,255);">true</span>
            });<span class="hljs-comment" style="color:#008000;">//扫码充电收入</span>
            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> lineSoldIncomeList = <span class="hljs-keyword" style="color:rgb(0,0,255);">await</span> _orderAppService.GetDateIncome(<span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> GetDateIncomeDto
            {
                Start = defaultStart,
                End = defaultEnd,
                IsLineSoldIncome = <span class="hljs-keyword" style="color:rgb(0,0,255);">true</span>
            });<span class="hljs-comment" style="color:#008000;">//售线收入</span>

            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> castCoinsIncomeList = <span class="hljs-keyword" style="color:rgb(0,0,255);">await</span> _castCoinsAppService.GetDateCoinsIncome(<span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> GetDateCoinsIncomeDto
            {
                Start = defaultStart,
                End = defaultEnd
            });<span class="hljs-comment" style="color:#008000;">//投币收入</span>

              <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> allKindsOfIncomeList = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> List&lt;DateIncomeListWithName&gt;
                {
                    <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> DateIncomeListWithName
                    {
                        DateIncomeDtos = castCoinsIncomeList,
                        Name = <span class="hljs-string" style="color:rgb(163,21,21);">"投币"</span>
                    },
                       <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> DateIncomeListWithName
                    {
                        DateIncomeDtos = lineSoldIncomeList,
                        Name = <span class="hljs-string" style="color:rgb(163,21,21);">"售线"</span>
                    },
                       <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> DateIncomeListWithName
                    {
                        DateIncomeDtos = scanCodeChargeIncomeList,
                        Name = <span class="hljs-string" style="color:rgb(163,21,21);">"扫码充电"</span>
                    }
                };
            <span class="hljs-keyword" style="color:rgb(0,0,255);">if</span> (Request.QueryString.Get(<span class="hljs-string" style="color:rgb(163,21,21);">"chartType"</span>) == <span class="hljs-string" style="color:rgb(163,21,21);">"pie"</span>)<span class="hljs-comment" style="color:#008000;">//饼图</span>
            {
                <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> pieDataList = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> List&lt;PieChartDataFormat&gt;();
                GetPieChartData(pieDataList, allKindsOfIncomeList);
                dataJsonStr = JsonConvert.SerializeObject(pieDataList, <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> JsonSerializerSettings() { ContractResolver = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> CamelCasePropertyNamesContractResolver() });
            }
            <span class="hljs-keyword" style="color:rgb(0,0,255);">else</span>
            {
                <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> dataList = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> List&lt;ChartDataFormat&gt;();
                allKindsOfIncomeList.Add(<span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> DateIncomeListWithName{DateIncomeDtos = totalIncomeList,Name = <span class="hljs-string" style="color:rgb(163,21,21);">"总收入"</span>});
                GetData(dataList,allKindsOfIncomeList,timeSpan);
                dataJsonStr = JsonConvert.SerializeObject(dataList, <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> JsonSerializerSettings() { ContractResolver = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> CamelCasePropertyNamesContractResolver() });
            }

            <span class="hljs-keyword" style="color:rgb(0,0,255);">return</span> Content(dataJsonStr);
        }

        <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">private</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">void</span> <span class="hljs-title" style="color:rgb(163,21,21);">GetData</span>(<span class="hljs-params">List&lt;ChartDataFormat&gt; dataList, List&lt;DateIncomeListWithName&gt; incomeList, DateTimeSpan span</span>) </span>{
            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> dateList = ConvertTimeSpanToList(span);
            <span class="hljs-keyword" style="color:rgb(0,0,255);">foreach</span> (DateIncomeListWithName dateIncomeListWithName <span class="hljs-keyword" style="color:rgb(0,0,255);">in</span> incomeList)
            {
                <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> newList = CheckoutIncomeList(dateIncomeListWithName.DateIncomeDtos, dateList);
                <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> list = newList.Select(dateIncomeDto =&gt; dateIncomeDto.Income).ToList();

                dataList.Add(<span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> ChartDataFormat
                {
                    Name = dateIncomeListWithName.Name,
                    Data = list
                });

            }
        }

        <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">private</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">void</span> <span class="hljs-title" style="color:rgb(163,21,21);">GetPieChartData</span>(<span class="hljs-params">List&lt;PieChartDataFormat&gt; dataList, List&lt;DateIncomeListWithName&gt; incomeLists</span>) </span>{
            <span class="hljs-keyword" style="color:rgb(0,0,255);">foreach</span> (DateIncomeListWithName dateIncomeListWithName <span class="hljs-keyword" style="color:rgb(0,0,255);">in</span> incomeLists)
            {
                <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> total = dateIncomeListWithName.DateIncomeDtos.Sum(i =&gt; i.Income);
                <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> item = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> PieChartDataFormat
                {
                    Name = dateIncomeListWithName.Name,
                    Y = total
                };
                dataList.Add(item);
            }

        }

        <span class="hljs-function">List&lt;DateIncomeDto&gt; <span class="hljs-title" style="color:rgb(163,21,21);">CheckoutIncomeList</span>(<span class="hljs-params">List&lt;DateIncomeDto&gt; incomeList, List&lt;DateTime&gt; dateList</span>) </span>{
            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> newIncomeList = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> List&lt;DateIncomeDto&gt;();
            newIncomeList = (<span class="hljs-keyword" style="color:rgb(0,0,255);">from</span> date <span class="hljs-keyword" style="color:rgb(0,0,255);">in</span> dateList
                             <span class="hljs-keyword" style="color:rgb(0,0,255);">join</span> incomeDto <span class="hljs-keyword" style="color:rgb(0,0,255);">in</span> incomeList on date.Date equals incomeDto.Date <span class="hljs-keyword" style="color:rgb(0,0,255);">into</span> result
                             <span class="hljs-keyword" style="color:rgb(0,0,255);">from</span> r <span class="hljs-keyword" style="color:rgb(0,0,255);">in</span> result.DefaultIfEmpty()
                             <span class="hljs-keyword" style="color:rgb(0,0,255);">select</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> DateIncomeDto
                             {
                                 Date = date.Date,
                                 Income = r == <span class="hljs-keyword" style="color:rgb(0,0,255);">null</span> ? <span class="hljs-number">0</span> : r.Income
                             }).ToList();

            <span class="hljs-keyword" style="color:rgb(0,0,255);">return</span> newIncomeList;
        }

        <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">private</span> List&lt;DateTime&gt; <span class="hljs-title" style="color:rgb(163,21,21);">ConvertTimeSpanToList</span>(<span class="hljs-params">DateTimeSpan span</span>) </span>{
            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> list = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> List&lt;DateTime&gt;();
            <span class="hljs-keyword" style="color:rgb(0,0,255);">for</span> (DateTime i = span.Start; i &lt;= span.End; i = i.AddDays(<span class="hljs-number">1</span>))
            {
                list.Add(i);
            }
            <span class="hljs-keyword" style="color:rgb(0,0,255);">return</span> list;
        }

</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">上面这段代码，楼主自认为封装的还不错，很简洁（这已经成为楼主编程追求的目标），平均每个方法10行左右(除了第一个)，仅供大家参考。</p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">下面两个类定义了两种图表从Server端到Client端的数据格式 ：</h4> 
   <pre class="c#"><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">    <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">ChartDataFormat</span>
    {
        <span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span> Name { <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span>; <span class="hljs-keyword" style="color:rgb(0,0,255);">set</span>; }
        <span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> List&lt;<span class="hljs-keyword" style="color:rgb(0,0,255);">decimal</span>&gt; Data { <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span>; <span class="hljs-keyword" style="color:rgb(0,0,255);">set</span>; }
    }

    <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">PieChartDataFormat</span>
    {
        <span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span> Name { <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span>; <span class="hljs-keyword" style="color:rgb(0,0,255);">set</span>; }
        <span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">decimal</span> Y { <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span>; <span class="hljs-keyword" style="color:rgb(0,0,255);">set</span>; }
    }

</code></pre> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">应用服务层也贴一个方法的代码，仅供参考</h4> 
   <pre class="c#"><code class="hljs php" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">        <span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> async Task&lt;<span class="hljs-keyword" style="color:rgb(0,0,255);">List</span>&lt;DateIncomeDto&gt;&gt; GetDateIncome(GetDateIncomeDto input)
        {
            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> query= _orderRepository.GetAll()
                .Where(o =&gt; o.Status == OrderStatus.Freezen || o.Status == OrderStatus.Settled || o.Status == OrderStatus.HasInformedDevice)
                .Where(o =&gt; o.OrderDate &gt;= input.Start &amp;&amp; o.OrderDate &lt;= input.End)
                .WhereIf(input.IsLineSoldIncome,o=&gt;o.OrderType==OrderType.LineSold)
                .WhereIf(input.IsScanCodeChargingIncome,o=&gt;o.OrderType==OrderType.Charge)
                .OrderBy(o =&gt; DbFunctions.TruncateTime(o.OrderDate))
                .GroupBy(o =&gt; DbFunctions.TruncateTime(o.OrderDate))
                .Select(group =&gt; <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> DateIncomeDto{Date=group.Key.Value,Income=group.Sum(item=&gt;item.PayFee??<span class="hljs-number">0</span>)});

            <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">list</span> = await query.ToListAsync();
            <span class="hljs-keyword" style="color:rgb(0,0,255);">return</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">list</span>;
        }

</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这些就是整个图表的实现方案，切记仅供参考，不可生搬硬套，如因程序bug导致您公司的重大损失，本人一概不负责任。此话莫当真，纯属娱乐一下。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><br></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><br></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><br></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><br></p> 
   <p><font color="#494949"><span style="font-size:15px;line-height:25px;">本文转自tkbSimplest博客园博客，原文链接：http://www.cnblogs.com/farb/p/JavascriptHighchartsUseCase.html，如需转载请自行联系原作者</span></font><br></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
