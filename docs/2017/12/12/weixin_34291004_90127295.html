<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ORAchk-数据库健康检查 « NotBeCN</title>
  <meta name="description" content="             ORAchk 之前被称为RACcheck，后来它的检查范围进行了扩展，改名为了ORAchk，它是在数据库系统进行健康检查的一个专用工具，这个工具主要用来检查软件的配置是否符合要求以及一些最佳实践是否被应用了。通过这个工具，用户可以很方便地、自动化地对自己的系统进行健康检查和评估。    ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/12/12/weixin_34291004_90127295.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">ORAchk-数据库健康检查</h1>
    <p class="post-meta">Dec 12, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p>ORAchk 之前被称为RACcheck，后来它的检查范围进行了扩展，改名为了ORAchk，它是在数据库系统进行健康检查的一个专用工具，<br>这个工具主要用来检查软件的配置是否符合要求以及一些最佳实践是否被应用了。<br>通过这个工具，用户可以很方便地、自动化地对自己的系统进行健康检查和评估。</p> 
   <p>ORAchk 能够检查的软件主要有：OS、Oracle Clusterware (CRS)、 Grid Infrastructure environment(GI)、Automatic Storage Management (ASM)以及Real Application Clusters (RAC)、单机的数据库、Golden Gate。</p> 
   <pre><code>检查的项目包括：</code></pre> 
   <ul>
    <li>OS kernel 参数</li> 
    <li>OS 包/补丁</li> 
    <li>OS上其它和RAC相关的配置</li> 
    <li>CRS/Grid Infrastructure</li> 
    <li>RDBMS</li> 
    <li>ASM</li> 
    <li>数据库参数</li> 
    <li>对于RAC数据库影响较大的设置</li> 
    <li>升级到11.2.0.3/11.2.0.4/12c时的升级检查</li> 
    <li> <p>Maximum Availability Architecture (MAA)检查</p> <pre><code>目前支持的平台：</code></pre> </li> 
   </ul>
   <pre><code class="js">o Linux x86-64* (Enterprise Linux, RedHat and SuSE 9, SuSE 10 &amp; SuSE 11)
       o Oracle Solaris SPARC (64-bit)(Solaris 10 and 11)
       o Oracle Solaris x86-64 (Solaris 10 and 11)
       o IBM AIX on POWER Systems (64-bit) **
       o HP-UX PA-RISC (64-bit)**
       o HP-UX Itanium **
</code></pre> 
   <ul>
    <li>不支持32位平台，不支持 Linux Itanium</li> 
    <li>需要安装BASH Shell 3.2 或之上</li> 
   </ul>
   <p>目前支持的数据库版本:</p> 
   <ul>
    <li>10gR2</li> 
    <li>11gR1</li> 
    <li>11gR2</li> 
    <li>12cR1</li> 
   </ul>
   <p>ORAchk 能够检查的软件主要有：OS、Oracle Clusterware (CRS)、 Grid Infrastructure environment(GI)、Automatic Storage Management (ASM)以及Real Application Clusters (RAC)、单机的数据库、Golden Gate。</p> 
   <p>检查的项目包括：</p> 
   <ul>
    <li>OS kernel 参数</li> 
    <li>OS 包/补丁</li> 
    <li>OS上其它和RAC相关的配置</li> 
    <li>CRS/Grid Infrastructure</li> 
    <li>RDBMS</li> 
    <li>ASM</li> 
    <li>数据库参数</li> 
    <li>对于RAC数据库影响较大的设置</li> 
    <li>升级到11.2.0.3/11.2.0.4/12c时的升级检查<br>Maximum Availability Architecture (MAA)检查</li> 
   </ul>
   <p>目前支持的平台：</p> 
   <pre><code class="js">o Linux x86-64* (Enterprise Linux, RedHat and SuSE 9, SuSE 10 &amp; SuSE 11)
       o Oracle Solaris SPARC (64-bit)(Solaris 10 and 11)
       o Oracle Solaris x86-64 (Solaris 10 and 11)
       o IBM AIX on POWER Systems (64-bit) **
       o HP-UX PA-RISC (64-bit)**
       o HP-UX Itanium **
</code></pre> 
   <ul>
    <li>不支持32位平台，不支持 Linux Itanium</li> 
    <li>需要安装BASH Shell 3.2 或之上</li> 
   </ul>
   <p>目前支持的数据库版本:</p> 
   <pre><code class="js">o 10gR2
       o 11gR1
       o 11gR2
       o 12cR1
</code></pre> 
   <p>下面是具体界面输出：</p> 
   <pre><code class="js">[oracle@rac1 ~]$ orachk -ebs32bit

CRS stack is running and CRS_HOME is not set. Do you want to set CRS_HOME to /home/grid/11R2/grid?[y/n][y]y

Checking ssh user equivalency settings on all nodes in cluster

Node rac2 is configured for ssh user equivalency for oracle user
 

Searching for running databases . . . . .

. .
</code></pre> 
   <p>List of running databases registered in OCR</p> 
   <ol>
    <li>racdb</li> 
    <li>None of above</li> 
   </ol>
   <pre><code class="js">Select databases from list for checking best practices. For multiple databases, select 1 for All or comma separated number like 1,2 etc [1-2][1].1
. .      


Checking Status of Oracle Software Stack - Clusterware, ASM, RDBMS

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 
-------------------------------------------------------------------------------------------------------
                                                 Oracle Stack Status                            
-------------------------------------------------------------------------------------------------------
Host Name  CRS Installed  ASM HOME       RDBMS Installed  CRS UP    ASM UP    RDBMS UP  DB Instance Name
-------------------------------------------------------------------------------------------------------
rac1        Yes             N/A             Yes             Yes        Yes      Yes      racdb1    
rac2        Yes             N/A             Yes             Yes        Yes      Yes      racdb2    
-------------------------------------------------------------------------------------------------------


Copying plug-ins

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . .
</code></pre> 
   <p>64 of the included audit checks require root privileged data collection . If sudo is not configured or the root password is not available, audit checks which require root privileged data collection can be skipped.</p> 
   <ol>
    <li>Enter 1 if you will enter root password for each host when prompted</li> 
    <li>Enter 2 if you have sudo configured for oracle user to execute root_orachk.sh script</li> 
    <li>Enter 3 to skip the root privileged collections</li> 
    <li>Enter 4 to exit and work with the SA to configure sudo or to arrange for root access and run the tool later.</li> 
   </ol>
   <pre><code class="js">Please indicate your selection from one of the above options for root access[1-4][1]:- 1


Is root password same on all nodes?[y/n][y]y


Enter root password :-

Verifying root password.

. . .


*** Checking Best Practice Recommendations (PASS/WARNING/FAIL) ***

 

Collections and audit checks log file is 
/home/oracle/orachk_rac1_racdb_081814_152310/log/orachk.log

 

Checking for prompts in /home/oracle/.bash_profile on rac1 for oracle user...

 


Checking for prompts in /home/oracle/.bash_profile on rac2 for oracle user...

 

Starting to run orachk in background on rac2

=============================================================
                    Node name - rac1                                
=============================================================

Collecting - ASM DIsk I/O stats 
Collecting - ASM Disk Groups 
Collecting - ASM Diskgroup Attributes 
Collecting - ASM disk partnership imbalance 
Collecting - ASM diskgroup attributes 
Collecting - ASM initialization parameters 
Collecting - Active sessions load balance for racdb database
Collecting - Archived Destination Status for racdb database
Collecting - Cluster Interconnect Config for racdb database
Collecting - Database Archive Destinations for racdb database
Collecting - Database Files for racdb database
Collecting - Database Instance Settings for racdb database
Collecting - Database Parameters for racdb database
Collecting - Database Parameters for racdb database
Collecting - Database Properties for racdb database
Collecting - Database Registry for racdb database
Collecting - Database Sequences for racdb database
Collecting - Database Undocumented Parameters for racdb database
Collecting - Database Undocumented Parameters for racdb database
Collecting - Database Workload Services for racdb database
Collecting - Dataguard Status for racdb database
Collecting - Files not opened by ASM 
Collecting - Log Sequence Numbers for racdb database
Collecting - Percentage of asm disk  Imbalance 
Collecting - Process for shipping Redo to standby for racdb database
Collecting - RDBMS Feature Usage for racdb database
Collecting - Redo Log information for racdb database
Collecting - Standby redo log creation status before switchover for racdb database
Collecting - /proc/cmdline
Collecting - /proc/modules
Collecting - CPU Information
Collecting - CRS active version
Collecting - CRS oifcfg
Collecting - CRS software version
Collecting - CSS Reboot time
Collecting - CSS disktimout
Collecting - Cluster interconnect (clusterware)
Collecting - Clusterware OCR healthcheck 
Collecting - Clusterware Resource Status
Collecting - DiskFree Information
Collecting - DiskMount Information
Collecting - Huge pages configuration
Collecting - Kernel parameters
Collecting - Linux module config.
Collecting - Maximum number of semaphore sets on system
Collecting - Maximum number of semaphores on system
Collecting - Maximum number of semaphores per semaphore set
Collecting - Memory Information
Collecting - NUMA Configuration
Collecting - Network Interface Configuration
Collecting - Network Performance
Collecting - Network Service Switch
Collecting - OS Packages
Collecting - OS version
Collecting - Operating system release information and kernel version
Collecting - Oracle Executable Attributes
Collecting - Patches for Grid Infrastructure 
Collecting - Patches for RDBMS Home 
Collecting - Shared memory segments
Collecting - Table of file system defaults
Collecting - Verify ioctl to advm [ACFS]
Collecting - Voting disks (clusterware)
Collecting - number of semaphore operations per semop system call
Preparing to run root privileged commands  rac1.

Collecting - ACFS and ASM driver version comparison [ACFS] 
Collecting - CRS user time zone check 
Collecting - Custom rc init scripts (rc.local) 
Collecting - Disk Information 
Collecting - Generic ACFS health [ACFS] 
Collecting - Grid Infastructure user shell limits configuration 
Collecting - Health of the mounted ACFS file systems [ACFS] 
Collecting - Health of unmounted ACFS file systems [ACFS] 
Collecting - Interconnect interface config 
Collecting - Network interface stats 
Collecting - Number of RDBMS LMS running in real time 
Collecting - OCFS2 disks 
Collecting - OLR Integrity 
Collecting - Volume list for unmount ACFS file system [ACFS] 
Collecting - ocsf status 
Collecting - root time zone check


Data collections completed. Checking best practices on rac1.
--------------------------------------------------------------------------------------


 WARNING =&gt; SYS.AUDSES$ sequence cache size &lt; 10,000 for racdb
 WARNING =&gt; Without ARCHIVELOG mode the database cannot be recovered from an online backup and Data Guard cannot be used. for racdb
 WARNING =&gt; OCR is NOT being backed up daily
 INFO =&gt;    At some times checkpoints are not being completed for racdb
 WARNING =&gt; Controlfile is NOT multiplexed for racdb
 WARNING =&gt; One or more redo log groups are NOT multiplexed for racdb
 WARNING =&gt; /tmp is NOT on a dedicated filesystem
 WARNING =&gt; Linux Swap Configuration does NOT meet Recommendation
 INFO =&gt;    Number of SCAN listeners is NOT equal to the recommended number of 3.
 WARNING =&gt; NIC bonding is not configured for interconnect
 WARNING =&gt; NIC bonding is NOT configured for public network (VIP)
 WARNING =&gt; OSWatcher is not running as is recommended.
 INFO =&gt;    Jumbo frames (MTU &gt;= 8192) are not configured for interconnect
 WARNING =&gt; NTP is not running with correct setting
 WARNING =&gt; Database parameter DB_BLOCK_CHECKING on PRIMARY is NOT set to the recommended value. for racdb
 FAIL =&gt;    Flashback on PRIMARY is not configured for racdb
 INFO =&gt;    Operational Best Practices
 INFO =&gt;    Database Consolidation Best Practices
 INFO =&gt;    Computer failure prevention best practices
 INFO =&gt;    Data corruption prevention best practices
 INFO =&gt;    Logical corruption prevention best practices
 INFO =&gt;    Database/Cluster/Site failure prevention best practices
 INFO =&gt;    Client failover operational best practices
 WARNING =&gt; fast_start_mttr_target should be greater than or equal to 300. on racdb1 instance

 INFO =&gt;    IMPORTANT: Oracle Database Patch 17478514 PSU is NOT applied to RDBMS Home /home/oracle/11gR2/db_1
 INFO =&gt;    Information about hanganalyze and systemstate dump
 FAIL =&gt;    Table AUD$[FGA_LOG$] should use Automatic Segment Space Management for racdb
 INFO =&gt;    Database failure prevention best practices
 WARNING =&gt; Database Archivelog Mode should be set to ARCHIVELOG for racdb
 FAIL =&gt;    Primary database is NOT protected with Data Guard (standby database) for real-time data protection and availability for racdb
 WARNING =&gt; avahi-daemon process is running
 WARNING =&gt; Redo log write time is more than 500 milliseconds for racdb
 INFO =&gt;    Parallel Execution Health-Checks and Diagnostics Reports for racdb
 INFO =&gt;    Oracle recovery manager(rman) best practices
 WARNING =&gt; RMAN controlfile autobackup should be set to ON for racdb
 INFO =&gt;    Consider increasing the COREDUMPSIZE size
 INFO =&gt;    Consider investigating changes to the schema objects such as DDLs or new object creation for racdb

 

Copying results from rac2 and generating report. This might take a while. Be patient.

=============================================================
                    Node name - rac2                                
=============================================================

Collecting - /proc/cmdline
Collecting - /proc/modules
Collecting - CPU Information
Collecting - CRS active version
Collecting - CRS oifcfg
Collecting - CRS software version
Collecting - Cluster interconnect (clusterware)
Collecting - DiskFree Information
Collecting - DiskMount Information
Collecting - Huge pages configuration
Collecting - Kernel parameters
Collecting - Linux module config.
Collecting - Maximum number of semaphore sets on system
Collecting - Maximum number of semaphores on system
Collecting - Maximum number of semaphores per semaphore set
Collecting - Memory Information
Collecting - NUMA Configuration
Collecting - Network Interface Configuration
Collecting - Network Performance
Collecting - Network Service Switch
Collecting - OS Packages
Collecting - OS version
Collecting - Operating system release information and kernel version
Collecting - Oracle Executable Attributes
Collecting - Patches for Grid Infrastructure 
Collecting - Patches for RDBMS Home 
Collecting - Shared memory segments
Collecting - Table of file system defaults
Collecting - Verify ioctl to advm [ACFS]
Collecting - number of semaphore operations per semop system call
Preparing to run root privileged commands  rac2.

Collecting - ACFS and ASM driver version comparison [ACFS] 
Collecting - CRS user time zone check 
Collecting - Disk Information 
Collecting - Generic ACFS health [ACFS] 
Collecting - Grid Infastructure user shell limits configuration 
Collecting - Health of the mounted ACFS file systems [ACFS] 
Collecting - Health of unmounted ACFS file systems [ACFS] 
Collecting - Interconnect interface config 
Collecting - Network interface stats 
Collecting - Number of RDBMS LMS running in real time 
Collecting - OCFS2 disks 
Collecting - OLR Integrity 
Collecting - Volume list for unmount ACFS file system [ACFS] 
Collecting - ocsf status 
Collecting - root time zone check


Data collections completed. Checking best practices on rac2.
--------------------------------------------------------------------------------------

 

 WARNING =&gt; /tmp is NOT on a dedicated filesystem
 WARNING =&gt; Linux Swap Configuration does NOT meet Recommendation
 INFO =&gt;    Number of SCAN listeners is NOT equal to the recommended number of 3.
 WARNING =&gt; NIC bonding is not configured for interconnect
 WARNING =&gt; NIC bonding is NOT configured for public network (VIP)
 WARNING =&gt; OSWatcher is not running as is recommended.
 INFO =&gt;    Jumbo frames (MTU &gt;= 8192) are not configured for interconnect
 WARNING =&gt; NTP is not running with correct setting
 WARNING =&gt; Database parameter DB_BLOCK_CHECKING on PRIMARY is NOT set to the recommended value. for racdb
 WARNING =&gt; fast_start_mttr_target should be greater than or equal to 300. on racdb2 instance

 INFO =&gt;    IMPORTANT: Oracle Database Patch 17478514 PSU is NOT applied to RDBMS Home /home/oracle/11gR2/db_1
 WARNING =&gt; ezconnect should be configured in sqlnet.ora
 WARNING =&gt; avahi-daemon process is running
 WARNING =&gt; Redo log write time is more than 500 milliseconds for racdb
 INFO =&gt;    Consider increasing the COREDUMPSIZE size

 

---------------------------------------------------------------------------------
                      CLUSTERWIDE CHECKS
---------------------------------------------------------------------------------
 WARNING =&gt; OS Kernel version(uname -r) does not match across cluster.
---------------------------------------------------------------------------------
 

 

 

 

 

Detailed report (html) - /home/oracle/orachk_rac1_racdb_081814_152310/orachk_rac1_racdb_081814_152310.html


UPLOAD(if required) - /home/oracle/orachk_rac1_racdb_081814_152310.zip

 


[oracle@rac1 ~]$ ls -ltr
total 36284
drwxr-xr-x  7 root   root         4096 Aug 28  2013 database
-rwxr-xr-x  1 oracle oinstall  1604239 May 31 14:37 orachk
-rw-r--r--  1 oracle oinstall      432 May 31 14:37 UserGuide.txt
-rw-r--r--  1 oracle oinstall     3879 May 31 14:37 readme.txt
-rwxr-xr-x  1 oracle oinstall  1604239 May 31 14:37 raccheck
-rw-rw-r--  1 oracle oinstall  3384097 May 31 14:37 rules.dat
-rw-rw-r--  1 oracle oinstall 22951324 May 31 14:37 collections.dat
drwxr-xr-x  3 oracle oinstall     4096 Aug 14 11:34 11gR2
drwxrwxr-x 11 oracle oinstall     4096 Aug 14 11:52 diag
drwxr-xr-x  2 oracle oinstall     4096 Aug 14 12:17 checkpoints
drwxr-x---  3 oracle oinstall     4096 Aug 14 12:43 admin
drwxr-x---  6 oracle oinstall     4096 Aug 14 13:06 cfgtoollogs
-rw-r--r--  1 root   root      5770368 Aug 18 15:18 orachk.zip
drwxr-xr-x  7 oracle oinstall    94208 Aug 18 15:38 orachk_rac1_racdb_081814_152310
-rw-r--r--  1 oracle oinstall  1639658 Aug 18 15:38 orachk_rac1_racdb_081814_152310.zip
</code></pre> 
   <p>本文转自ICT时空 dbasdk博客，原文链接：<a href="http://blog.itpub.net/29734436/viewspace-1254198/" rel="nofollow">ORAchk-数据库健康检查</a>，如需转载请自行联系原博主。</p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
