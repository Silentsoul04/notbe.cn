<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ABP理论学习之Javascript API(理论完结篇) « NotBeCN</title>
  <meta name="description" content="             本篇目录        Ajax     Notification     Message     UI block和busy     事件总线     Logging     其他工具功能               说在前面的话     不知不觉，我们送走了2015，同时迎来了201...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/12/11/weixin_34062469_90134856.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">ABP理论学习之Javascript API(理论完结篇)</h1>
    <p class="post-meta">Dec 11, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);">本篇目录</h2> 
   <ul style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPJavascriptAPI.html#Ajax" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">Ajax</a></strong></li> 
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPJavascriptAPI.html#Notification" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">Notification</a></strong></li> 
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPJavascriptAPI.html#Message" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">Message</a></strong></li> 
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPJavascriptAPI.html#block" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">UI block和busy</a></strong></li> 
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPJavascriptAPI.html#eventBus" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">事件总线</a></strong></li> 
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPJavascriptAPI.html#Logging" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">Logging</a></strong></li> 
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPJavascriptAPI.html#other" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">其他工具功能</a></strong></li> 
   </ul>
   <hr style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
   <blockquote style="border:2px solid rgb(239,239,239);line-height:1.6;color:rgb(51,51,51);font-size:15px;font-family:'Microsoft Yahei';clear:both;background:rgb(223,255,163) url(&quot;//files.cnblogs.com/files/farb/o_title.gif&quot;) no-repeat 9px 50%;"> 
    <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);">说在前面的话</h4> 
    <p>不知不觉，我们送走了2015，同时迎来了2016。我相信，每一个人，都会在过去的一年有所失，但我更相信，我们所得到的更多。过去的就过去了，不要再计较了，但要从过去的各种不顺中汲取经验，这样，在全新的2016年里继续留下2015年遗憾的概率才会大大降低！祝大家在新的一年里，代码bug越来越少！</p> 
    <p>本来给这个<strong><a href="http://www.cnblogs.com/farb/p/ABPTheory.html" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">ABP理论学习系列</a></strong>的预算时间是2016年春节前完成，当时还恐怕完成不了任务，现在没想到在2016年元旦假期就完成了。原本计划两个月的完成的任务，结果用了不到一个月就完成了，我的效率还是蛮高的嘛！不过，这多亏了各位园友的鼓励和支持，才让我有了坚持下去的动力，在此谢谢了！</p> 
    <p>ABP理论学习完了，基本上的东西也就懂了！接下来，就需要好好地实战一把了！虽然我写了<strong><a href="http://www.cnblogs.com/farb/p/ABPPracticeContent.html" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">一步一步使用ABP搭建正式项目教程</a></strong>，但是那完全是让新手能迅速使用ABP搭建的项目跑起来。接下来，我会写一个<strong><a href="http://www.cnblogs.com/farb/category/773197.html" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">ABP项目进阶教程</a></strong>系列，教大家使用ABP框架搭建一个完整的例子，实战的同时，讲解一些难点的基本原理，也希望热爱ABP的园友们多多关注。</p> 
    <p>先声明一下，这篇文章稍长，希望大家多点耐心。</p> 
   </blockquote> 
   <hr style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">ABP提供了一些对象和函数集，使得了javascript开发简单且标准化。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">下面，我们一一讲解ABP中的这些javascript API。</p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);"> <a name="Ajax"></a>Ajax</h2> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">使用Ajax调用服务端的服务，并返回服务端响应的内容。因为ABP对于Ajax调用会返回一个标准的响应，因此，建议使用该方法处理标准的返回值。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">Ajax操作的问题</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">现代应用程序频繁使用Ajax调用，特别是在SPA中，它几乎是和服务器交互的唯一方式。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">Ajax调用包含了许多重复性的步骤：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">一般来讲，在客户端javascript代码应该提供一个URL，data是否提供是可选的，以及选择一个执行Ajax调用的方法（Post,Get...）。必须等待然后才能处理返回的值。当向服务端发起调用时可能会发生错误（一般是网络错误）。服务端也可能发生错误，服务器可能发送了一个具有错误信息的失败响应。客户端代码应该处理服务端响应的错误，并选择性地通知用户（可能展示一个error对话框）。如果没有错误，且服务器返回了数据，客户端也必须处理。此外，一般它会阻塞一些（或者整个）屏幕区域，并展示一个繁忙的指示标志，直到Ajax操作结束。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">服务端应该接收请求，然后执行服务端的代码，捕获任何异常并返回一个有效的响应给客户端。在发生错误的情况下，它可以有选择地发送一个错误消息给客户端；成功时，它可以返回数据给客户端。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">ABP采用的方式</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">ABP通过使用<strong>abp.ajax</strong>函数封装Ajax的调用，自动化了这其中的一些步骤。一个ajax调用的例子如下：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> newPerson <span class="op">=</span> <span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'Dougles Adams'</span></span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">42</span> <span class="op">};</span> <span class="va">abp</span>.<span class="at">ajax</span>(<span class="op">{</span> <span class="dt">url</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'/People/SavePerson'</span></span><span class="op">,</span> <span class="dt">data</span><span class="op">:</span> <span class="va"><span class="hljs-built_in" style="color:rgb(0,0,255);">JSON</span></span>.<span class="at">stringify</span>(newPerson) <span class="op">}</span>).<span class="at">done</span>(<span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function">(<span class="hljs-params">data</span>) </span><span class="op">{</span> <span class="va">abp</span>.<span class="va">notify</span>.<span class="at">success</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'created new person with id = '</span></span> <span class="op">+</span> <span class="va">data</span>.<span class="at">personId</span>)<span class="op">;</span> <span class="op">}</span>)<span class="op">;</span> </code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">abp.ajax以一个对象作为接收<strong>选项</strong>。你可以传递任何在jQuery的$.ajax方法中有效的任何参数。这里有一些&nbsp;<strong>默认</strong>的值：dataType是‘json’，type是‘POST’，contentType是‘application/json’（因此，在发送到服务器之前，我们可以调用JSON.stringify将javascript对象转成JSON字符串）。你可以通过将选项传给abp.ajax重写默认值。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">abp.ajax返回了<strong><a href="http://api.jquery.com/deferred.promise/" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">promise</a></strong>。因此，你可以写done,fail,then等处理函数。上面的例子中，我们向&nbsp;<strong>PeopleController的SavePerson</strong>的action发送了简单的Ajax请求。在&nbsp;<strong>done</strong>处理函数中，我们获得了新添加的person的数据库Id，而且展示了一个成功的通知。让我们看一下该Ajax请求的&nbsp;<strong>MVC控制器</strong>：</p> 
   <pre class="c#"><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">PeopleController</span> : <span class="hljs-title" style="color:rgb(163,21,21);">AbpController</span>
{
    [HttpPost]
    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> JsonResult <span class="hljs-title" style="color:rgb(163,21,21);">SavePerson</span>(<span class="hljs-params">SavePersonModel person</span>) </span>{
        <span class="hljs-comment" style="color:#008000;">//<span class="hljs-doctag" style="color:#808080;">TODO:</span>将新的person保存到数据库，并返回该person的Id</span>
        <span class="hljs-keyword" style="color:rgb(0,0,255);">return</span> Json(<span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> {PersonId = <span class="hljs-number">42</span>});
    }
}

</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>SavePersonModel</strong>包含了Name和Age属性。SavePerson标记有&nbsp;<strong>HttpPost</strong>特性，因为abp.ajax默认的方法是POST。这里通过返回一个匿名的对象简化了方法的实现。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这个看上去简单明了，但是ABP背后处理了许多重要的事情。让我们深入细节看一下：</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">Ajax返回的消息</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">虽然我们直接返回了一个具有PersonId=2的对象，但是ABP会使用一个<strong>MVCAjaxResponse</strong>对象封装了它。实际的Ajax响应是像下面那样的：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre class="sourceCode json"><code class="sourceCode json hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="fu">{</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">success</span>"</span><span class="fu">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">true</span></span><span class="fu">,</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">result</span>"</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">personId</span>"</span><span class="fu">:</span> <span class="dv">42</span>
  <span class="fu">},</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">error</span>"</span><span class="fu">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">null</span></span><span class="fu">,</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">targetUrl</span>"</span><span class="fu">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">null</span></span><span class="fu">,</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">unAuthorizedRequest</span>"</span><span class="fu">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">false</span></span>
<span class="fu">}</span>
</code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这里，所有的属性都是camelCase的（因为在javascript中这是惯例），即使在服务端代码中是PascalCased的。下面解释一下所有的字段：</p> 
   <ul style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <li style="list-style:disc;"> <strong>success</strong>:一个布尔值，表示操作的成功状态。如果是true，abp.ajax会解析该promise，并调用&nbsp;<strong>done</strong>处理函数。如果是false（如果在方法调用中发生了异常），它会调用&nbsp;<strong>fail</strong>处理函数并使用abp.message.error函数展示一个&nbsp;<strong>error</strong>消息。</li> 
    <li style="list-style:disc;"> <strong>result</strong>：控制器的action返回的实际值。如果success是true，而且服务器发送了一个返回值，它才有效。</li> 
    <li style="list-style:disc;"> <strong>error</strong>：如果success是false，那么该字段是一个包含了&nbsp;<strong>message</strong>和&nbsp;<strong>detail</strong>字段的对象。</li> 
    <li style="list-style:disc;"> <strong>targetUrl</strong>:这为服务器提供了一种重定向客户端到其他Url的可能性。</li> 
    <li style="list-style:disc;"> <strong>unAuthorizedRequest</strong>:这为服务器提供了通知客户端该操作没有授权或者用户没有认证的可能性。如果该值是true，那么abp.ajax会&nbsp;<strong>重新加载</strong>当前的页面。</li> 
   </ul>
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">通过从<strong>AbpController</strong>类中派生就可以将返回值转换成一个封装的Ajax响应。&nbsp;<strong>abp.ajax</strong>会识别并计算该响应。因此，它们成对工作。如果没有发生错误的话，那么abp.ajax的done处理函数会获得控制器返回的实际值（一个具有personId属性的对象）。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">当从<strong>AbpApiController</strong>类派生时，也会存在相同的机制。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">处理错误</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">正如上面描述的，ABP会处理服务器中的所有异常，并返回一个具有错误信息的对象，如下所示：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre class="sourceCode json"><code class="sourceCode json hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="fu">{</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">targetUrl</span>"</span><span class="fu">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">null</span></span><span class="fu">,</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">result</span>"</span><span class="fu">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">null</span></span><span class="fu">,</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">success</span>"</span><span class="fu">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">false</span></span><span class="fu">,</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">error</span>"</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">message</span>"</span><span class="fu">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"An internal error occured during your request!"</span></span><span class="fu">,</span>
    <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">details</span>"</span><span class="fu">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"..."</span></span>
  <span class="fu">},</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">unAuthorizedRequest</span>"</span><span class="fu">:</span> <span class="kw"><span class="hljs-literal" style="color:rgb(163,21,21);">false</span></span>
<span class="fu">}</span>
</code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">可以看到，success是false，result是null。abp.ajax处理该对象，而且使用abp.message.error函数展示一个错误信息给用户。如果你的服务端代码抛出了一个<strong>UserFriendlyException</strong>类型的异常，它会直接给用户显示异常信息。否则，它会隐藏实际的错误（将错误写到日志中），并展示一个标准的“服务器内部错误...”信息给用户。所有的这些都是ABP自动处理的。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">动态Web API 层</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">虽然ABP提供了一种使得调用Ajax很简单的机制，但是在真实世界的应用中，为每个Ajax调用编写javascript函数是很经典的，比如：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="co"><span class="hljs-comment" style="color:#008000;">//创建一个抽象了Ajax调用的function</span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> savePerson <span class="op">=</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function">(<span class="hljs-params">person</span>) </span><span class="op">{</span> <span class="cf"><span class="hljs-keyword" style="color:rgb(0,0,255);">return</span></span> <span class="va">abp</span>.<span class="at">ajax</span>(<span class="op">{</span> <span class="dt">url</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'/People/SavePerson'</span></span><span class="op">,</span> <span class="dt">data</span><span class="op">:</span> <span class="va"><span class="hljs-built_in" style="color:rgb(0,0,255);">JSON</span></span>.<span class="at">stringify</span>(person) <span class="op">}</span>)<span class="op">;</span> <span class="op">};</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//创建一个新的 person</span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> newPerson <span class="op">=</span> <span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'Dougles Adams'</span></span><span class="op">,</span> <span class="dt">age</span><span class="op">:</span> <span class="dv">42</span> <span class="op">};</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//保存该person</span></span> <span class="at">savePerson</span>(newPerson).<span class="at">done</span>(<span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function">(<span class="hljs-params">data</span>) </span><span class="op">{</span> <span class="va">abp</span>.<span class="va">notify</span>.<span class="at">success</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'created new person with id = '</span></span> <span class="op">+</span> <span class="va">data</span>.<span class="at">personId</span>)<span class="op">;</span> <span class="op">}</span>)<span class="op">;</span> </code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">对于每个Ajax调用都写个函数是个好的做法，但是这耗时且乏味。ASP.NET为应用服务层方法提供了自动生成这些类型的函数机制。请阅读<strong><a href="http://www.cnblogs.com/farb/p/ABPDynamicWebAPI.html" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">《动态Web API层》</a></strong></p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);"> <a name="Notification"></a>Notification</h2> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">展示自动关闭的通知。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">我们喜欢一些事情发生时展示一些精致的自动消失的通知，比如当保存一条记录或者问题发生时。ABP为这个定义了标准的APIs。</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="va">abp</span>.<span class="va">notify</span>.<span class="at">success</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'a message text'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'optional title'</span></span>)<span class="op">;</span> <span class="va">abp</span>.<span class="va">notify</span>.<span class="at">info</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'a message text'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'optional title'</span></span>)<span class="op">;</span> <span class="va">abp</span>.<span class="va">notify</span>.<span class="at">warn</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'a message text'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'optional title'</span></span>)<span class="op">;</span> <span class="va">abp</span>.<span class="va">notify</span>.<span class="at">error</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'a message text'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'optional title'</span></span>)<span class="op">;</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">通知API默认是使用<strong><a href="http://codeseven.github.io/toastr/demo.html" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">toastr</a></strong>库实现的。要使toastr生效，你应该引用toastr的css和javascript文件，然后再在页面中包含abp.toastr.js作为适配器。一个toastr成功通知如下所示：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="http://i.imgur.com/xjBHBtD.png" style="border:0px;" alt="xjBHBtD.png"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">你也可以用你最喜欢的通知库中实现通知。只需要在自定义javascript文件中重写所有的函数，然后把它添加到页面中而不是abp.toastr.js（你可以检查该文件看它是否实现，这个相当简单）中。</p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);"> <a name="Message"></a>Message</h2> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">给用户展示消息对话框。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">消息API用于给用户展示消息或者获得用户的确认。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">消息API默认是使用<strong><a href="http://tristanedwards.me/sweetalert" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">sweetalert</a></strong>实现的。要让sweetalert生效，你应该包含它的css和javascript文件，然后再页面中添加<strong>abp.sweet-alert.js</strong>的引用作为适配器。</p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">展示消息</h4> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">例子如下：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="va">abp</span>.<span class="va">message</span>.<span class="at">info</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'some info message'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'some optional title'</span></span>)<span class="op">;</span> <span class="va">abp</span>.<span class="va">message</span>.<span class="at">success</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'some success message'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'some optional title'</span></span>)<span class="op">;</span> <span class="va">abp</span>.<span class="va">message</span>.<span class="at">warn</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'some warning message'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'some optional title'</span></span>)<span class="op">;</span> <span class="va">abp</span>.<span class="va">message</span>.<span class="at">error</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'some error message'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'some optional title'</span></span>)<span class="op">;</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">一个成功的消息如下所示：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="http://i.imgur.com/gkHdu4k.png" style="border:0px;" alt="gkHdu4k.png"></p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">确认</h4> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">例子如下：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="va">abp</span>.<span class="va">message</span>.<span class="at">confirm</span>( <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'User admin will be deleted.'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'Are you sure?'</span></span><span class="op">,</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function"> (<span class="hljs-params">isConfirmed</span>) </span><span class="op">{</span> <span class="cf"><span class="hljs-keyword" style="color:rgb(0,0,255);">if</span></span> (isConfirmed) <span class="op">{</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//...删除用户</span></span> <span class="op">}</span> <span class="op">}</span> )<span class="op">;</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这里的第二个参数（title）是可选的，因此，回调函数也可以是第二个参数。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">一个确认消息的例子如下所示：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="https://images2015.cnblogs.com/blog/577014/201601/577014-20160111104142897-1109234390.png" style="border:0px;" alt="577014-20160111104142897-1109234390.png"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">ABP内部使用了Message API。比如，如果Ajax调用失败了，那么它会调用abp.message.error。</p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);"> <a name="block"></a>UI block和Busy API</h2> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">使用一个区域（一个div，form，整个页面等）阻塞用户的输入。此外，还使得一个区域处于繁忙状态（具有一个繁忙的指示器，如‘loading...’）。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">UI Block API</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">该API使用一个透明的涂层（transparent overlay）来阻塞整个页面或者该页面上的一个元素。这样，用户的点击就无效了。当保存一个表单或者加载一个区域（一个div或者整个页面）时这是很有用的，比如：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="va">abp</span>.<span class="va">ui</span>.<span class="at">block</span>()<span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//阻塞整个页面</span></span> <span class="va">abp</span>.<span class="va">ui</span>.<span class="at">block</span>(<span class="at">$</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#MyDivElement'</span></span>))<span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//可以使用jQuery 选择器..</span></span> <span class="va">abp</span>.<span class="va">ui</span>.<span class="at">block</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#MyDivElement'</span></span>)<span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//..或者直接使用选择器</span></span> <span class="va">abp</span>.<span class="va">ui</span>.<span class="at">unblock</span>()<span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//解除阻塞整个页面</span></span> <span class="va">abp</span>.<span class="va">ui</span>.<span class="at">unblock</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#MyDivElement'</span></span>)<span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//解除阻塞特定的元素</span></span> </code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">UI Block API默认使用jQuery的blockUI插件实现的。要是它生效，你应该包含它的javascript文件，然后在页面中包含<strong>abp.blockUI.js</strong>作为适配器。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">UI Busy API</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">该API用于使得某些页面或者元素处于繁忙状态。比如，你可能想阻塞一个表单，然后当提交表单至服务器时展示一个繁忙的指示器。例子：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="va">abp</span>.<span class="va">ui</span>.<span class="at">setBusy</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#MyLoginForm'</span></span>)<span class="op">;</span> <span class="va">abp</span>.<span class="va">ui</span>.<span class="at">clearBusy</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#MyLoginForm'</span></span>)<span class="op">;</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">样例截图：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="http://i.imgur.com/ZmAirzt.png" style="border:0px;" alt="ZmAirzt.png"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">该参数应该是一个选择器（如‘#MyLoginForm’）或者jQuery选择器（如$('#MyLoginForm')）。要使得整个页面处于繁忙状态，你可以传入null（或者'body'）作为选择器。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">setBusy函数第二个参数接收一个promise（约定），当该约定完成时会自动清除繁忙的状态。例子：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="va">abp</span>.<span class="va">ui</span>.<span class="at">setBusy</span>( <span class="at">$</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'#MyLoginForm'</span></span>)<span class="op">,</span> <span class="va">abp</span>.<span class="at">ajax</span>(<span class="op">{</span> ... <span class="op">}</span>) )<span class="op">;</span> </code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">因为abp.ajax返回promise，我们可以直接将它作为promise传入。要学习惯于promise更多的东西，查看jQuery的<strong><a href="http://api.jquery.com/category/deferred-object/" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">Deferred</a></strong>。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">UI Busy API是使用<strong><a href="http://fgnass.github.io/spin.js/" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">spin.js</a></strong>实现的。要让它生效，应该包含它的javascript文件，然后在页面中包含<strong>abp.spin.js</strong>作为适配器。</p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);"><a name="eventBus">事件总线</a></h2> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">用于注册和触发客户端的全局事件。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">介绍</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>Pub/sub</strong>事件模型广泛用于客户端，ABP包含了一个简单的<strong>全局事件总线</strong>来&nbsp;<strong>注册</strong>并&nbsp;<strong>触发事件</strong>。</p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">注册事件</h4> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">可以使用<strong>abp.event.on</strong>来注册一个全局事件。一个注册的例子：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="va">abp</span>.<span class="va">event</span>.<span class="at">on</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'itemAddedToBasket'</span></span><span class="op">,</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function"> (<span class="hljs-params">item</span>) </span><span class="op">{</span> <span class="va"><span class="hljs-built_in" style="color:rgb(0,0,255);">console</span></span>.<span class="at">log</span>(<span class="va">item</span>.<span class="at">name</span> <span class="op">+</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">' is added to basket!'</span></span>)<span class="op">;</span> <span class="op">}</span>)<span class="op">;</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">第一个参数是<strong>事件的唯一名称</strong>。第二个是回调函数，当特定事件被触发时，会被调用。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">可以使用<strong>abp.event.off</strong>方法来从一个事件中取消注册。注意：要取消注册，要提供相同的函数。因此，对于上面的例子，你应该将回调函数设置为一个变量，然后在<strong>on和off</strong>方法中使用它。</p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">触发事件</h4> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>abp.event.trigger</strong>用于触发一个全局事件。触发一个已经注册的事件的代码如下：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="va">abp</span>.<span class="va">event</span>.<span class="at">trigger</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'itemAddedToBasket'</span></span><span class="op">,</span> <span class="op">{</span> <span class="dt">id</span><span class="op">:</span> <span class="dv">42</span><span class="op">,</span> <span class="dt">name</span><span class="op">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'Acme Light MousePad'</span></span> <span class="op">}</span>)<span class="op">;</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">第一个参数是<strong>该事件的唯一名称</strong>。第二个是（可选的）<strong>事件参数</strong>。你可以添加任何数量的参数，并且在回调方法中获得它们。</p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);"> <a name="Logging"></a>Logging</h2> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">在客户端记录日志。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">Javascript Logging API</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">当你想要在客户端记录一些简单的日志时，你可以使用console.log('...')API，这你已经知道了。但是这种写法不是所有的浏览器都支持的，而且可能会破坏你的脚本。因此，你应该首先检查console是否可用，此外，你可能想在别的地方记录日志，甚至你想以某种级别记录日志。ABP定义了安全的日志函数：</p> 
   <pre><code class="hljs perl" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">abp.<span class="hljs-keyword" style="color:rgb(0,0,255);">log</span>.debug(<span class="hljs-string" style="color:rgb(163,21,21);">'...'</span>);
abp.<span class="hljs-keyword" style="color:rgb(0,0,255);">log</span>.info(<span class="hljs-string" style="color:rgb(163,21,21);">'...'</span>);
abp.<span class="hljs-keyword" style="color:rgb(0,0,255);">log</span>.<span class="hljs-keyword" style="color:rgb(0,0,255);">warn</span>(<span class="hljs-string" style="color:rgb(163,21,21);">'...'</span>);
abp.<span class="hljs-keyword" style="color:rgb(0,0,255);">log</span>.error(<span class="hljs-string" style="color:rgb(163,21,21);">'...'</span>);
abp.<span class="hljs-keyword" style="color:rgb(0,0,255);">log</span>.fatal(<span class="hljs-string" style="color:rgb(163,21,21);">'...'</span>);
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">你可以通过设置<strong>abp.log.level</strong>为abp.log.levels之一来更改日志级别（比如，abp.log.levels.INFO没有记录调试日志）。这些函数默认将日志记录到了浏览器的控制台里了。但如果你需要的话，你也可以重写或者扩展这个行为。</p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);"> <a name="other"></a>其他工具功能</h2> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">ABP提供了一些通用的工具功能。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">abp.utils.createNamespace</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">用于立即创建更深的命名空间。假设我们有一个基命名空间‘abp’，然后想要创建或者获得‘abp.utils.strings.formatting’命名空间。不需要下面这样写：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="co"><span class="hljs-comment" style="color:#008000;">//创建或获得namespace</span></span> <span class="va">abp</span>.<span class="at">utils</span> <span class="op">=</span> <span class="va">abp</span>.<span class="at">utils</span> <span class="op">||</span> <span class="op">{};</span> <span class="va">abp</span>.<span class="va">utils</span>.<span class="at">strings</span> <span class="op">=</span> <span class="va">abp</span>.<span class="va">utils</span>.<span class="at">strings</span> <span class="op">||</span> <span class="op">{};</span> <span class="va">abp</span>.<span class="va">utils</span>.<span class="va">strings</span>.<span class="at">formatting</span> <span class="op">=</span> <span class="va">abp</span>.<span class="va">utils</span>.<span class="va">strings</span>.<span class="at">formatting</span> <span class="op">||</span> <span class="op">{};</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//给该namespace添加一个function</span></span> <span class="va">abp</span>.<span class="va">utils</span>.<span class="va">strings</span>.<span class="va">formatting</span>.<span class="at">format</span> <span class="op">=</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function">(<span class="hljs-params"></span>) </span><span class="op">{</span> ... <span class="op">};</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">我们可以这样写：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> formatting <span class="op">=</span> <span class="va">abp</span>.<span class="va">utils</span>.<span class="at">createNamespace</span>(abp<span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'utils.strings.formatting'</span></span><span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//给该namespace添加一个function</span></span> <span class="va">formatting</span>.<span class="at">format</span> <span class="op">=</span> <span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">function</span></span></span><span class="hljs-function">(<span class="hljs-params"></span>) </span><span class="op">{</span> ... <span class="op">};</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这样就简化了安全地创建深入的命名空间了。注意，第一个参数是必须存在的根命名空间。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;">abp.utils.formatString</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这个和C#中的string.Format()很相似。用法示例：</p> 
   <div class="sourceCode">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="color:rgb(0,0,0);font-family:'Courier New', sans-serif;font-size:12px;line-height:1.5;vertical-align:middle;border:1px solid rgb(204,204,204);"><span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> str <span class="op">=</span> <span class="va">abp</span>.<span class="va">utils</span>.<span class="at">formatString</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'Hello {0}!'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'World'</span></span>)<span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//str = 'Hello World!'</span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> str <span class="op">=</span> <span class="va">abp</span>.<span class="va">utils</span>.<span class="at">formatString</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'{0} number is {1}.'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'Secret'</span></span><span class="op">,</span> <span class="dv">42</span>)<span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//str = 'Secret number is 42'</span></span></code><code class="sourceCode javascript hljs" style="color:rgb(0,0,0);font-family:'Courier New', sans-serif;font-size:12px;line-height:1.5;vertical-align:middle;border:1px solid rgb(204,204,204);"><span class="co"><span class="hljs-comment" style="color:#008000;"><br></span></span></code><code class="sourceCode javascript hljs" style="color:rgb(0,0,0);font-family:'Courier New', sans-serif;font-size:12px;line-height:1.5;vertical-align:middle;border:1px solid rgb(204,204,204);"><span class="co"><span class="hljs-comment" style="color:#008000;"><br></span></span></code><code class="sourceCode javascript hljs" style="color:rgb(0,0,0);font-family:'Courier New', sans-serif;font-size:12px;line-height:1.5;vertical-align:middle;border:1px solid rgb(204,204,204);"><span class="co"><span class="hljs-comment" style="color:#008000;"><br></span></span></code><code class="sourceCode javascript hljs" style="color:rgb(0,0,0);font-family:'Courier New', sans-serif;font-size:12px;line-height:1.5;vertical-align:middle;border:1px solid rgb(204,204,204);"><span class="co"><span class="hljs-comment" style="color:#008000;"><br></span></span></code><code class="sourceCode javascript hljs" style="color:rgb(0,0,0);font-family:'Courier New', sans-serif;font-size:12px;line-height:1.5;vertical-align:middle;border:1px solid rgb(204,204,204);"><span class="co"><span class="hljs-comment" style="color:#008000;"><br></span></span></code><code class="sourceCode javascript hljs" style="vertical-align:middle;border:1px solid rgb(204,204,204);"><span class="co"><span class="hljs-comment"></span></span></code><code class="sourceCode javascript hljs" style="color:rgb(0,0,0);font-family:'Courier New', sans-serif;font-size:12px;line-height:1.5;vertical-align:middle;border:1px solid rgb(204,204,204);"><span class="co"><span class="hljs-comment" style="color:#008000;"><br></span></span></code></code></pre>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
