<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>JUnit最佳实践 « NotBeCN</title>
  <meta name="description" content="             JUnit是什么？    cherami        JUnit是一个开发源代码的Java测试框架，用于编写和运行可重复的测试。他是用于单元测试框架体系xUnit的一个实例（用于java语言）。它包括以下特性： 1、用于测试期望结果的断言（Assertion） 2、用于共享共同测试数据...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/12/07/weixin_34025051_90118002.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">JUnit最佳实践</h1>
    <p class="post-meta">Dec 7, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;"><font>JUnit是什么？</font></p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;"><font>cherami</font></p> 
   <font> </font>
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">JUnit是一个开发源代码的Java测试框架，用于编写和运行可重复的测试。他是用于单元测试框架体系xUnit的一个实例（用于java语言）。它包括以下特性：<br> 1、用于测试期望结果的断言（Assertion）<br> 2、用于共享共同测试数据的测试工具<br> 3、用于方便的组织和运行测试的测试套件<br> 4、图形和文本的测试运行器</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">JUnit最初是由Erich Gamma（GoF之一）和Kent Beck（xp和refactor的先驱之一）编写的.</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">需要说明的是junit一般是用来进行单元测试的，因此需要了解被测试代码的内部结构（即所谓的白盒测试），另外junit是在xp编程和重构（refactor）中被极力推荐使用的工具，因为在实现自动单元测试的情况下可以大大的提高开发的效率，但是实际上编写测试代码也是需要耗费很多的时间和精力的，那么使用这个东东好处到底在哪里呢？笔者认为是这样的：<br> 1、对于xp编程而言，要求在编写代码之前先写测试，这样可以强制你在写代码之前好好的思考代码（方法）的功能和逻辑，否则编写的代码很不稳定，那么你需要同时维护测试代码和实际代码，这个工作量就会大大增加。因此在xp编程中，基本过程是这样的：构思－》编写测试代码－》编写代码－》测试，而且编写测试和编写代码都是增量式的，写一点测一点，在编写以后的代码中如果发现问题可以较块的追踪到问题的原因，减小回归错误的纠错难度<br> 2、对于重构而言，其好处和xp编程中是类似的，因为重构也是要求改一点测一点，减少回归错误造成的时间消耗。<br> 3、对于非以上两种情况，我们在开发的时候使用junit写一些适当的测试也是有必要的，因为一般我们也是需要编写测试的代码的，可能原来不是使用的junit，如果使用junit，而且针对接口（方法）编写测试代码会减少以后的维护工作，例如以后对方法内部的修改（这个就是相当于重构的工作了）。另外就是因为junit有断言功能，如果测试结果不通过会告诉我们那个测试不通过，为什么，而如果是想以前的一般做法是写一些测试代码看其输出结果，然后再由自己来判断结果使用正确，使用junit的好处就是这个结果是否正确的判断是它来完成的，我们只需要看看它告诉我们结果是否正确就可以了，在一般情况下会大大提高效率。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">JUnit入门</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">cherami 整理</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">安装JUnit</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">安装很简单，先到以下地址下载一个最新的zip包：<br> http://download.sourceforge.net/junit/<br> 下载完以后解压缩到你喜欢的目录下，假设是JUNIT_HOME，然后将JUNIT_HOME下的junit.jar包加到你的系统的CLASSPATH环境变量中，对于IDE环境，对于需要用到的junit的项目增加到lib中，其设置不同的IDE有不同的设置，这里不多讲。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">如何使用JUnit写测试？</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">最简单的范例如下：<br> 1、创建一个TestCase的子类:&nbsp;<br> package junitfaq;</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">import java.util.*;<br> import junit.framework.*;</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">public class SimpleTest extends TestCase {</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">public SimpleTest(String name) {<br> super(name);<br> }</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">2、写一个测试方法断言期望的结果：<br> public void testEmptyCollection() {<br> Collection collection = new ArrayList();<br> assertTrue(collection.isEmpty());<br> }<br> 注意：JUnit推荐的做法是以test作为待测试的方法的开头，这样这些方法可以被自动找到并被测试。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">3、写一个suite()方法，它会使用反射动态的创建一个包含所有的testXxxx方法的测试套件：<br> public static Test suite() {<br> return new TestSuite(SimpleTest.class);<br> }</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">4、写一个main()方法以文本运行器的方式方便的运行测试：<br> public static void main(String args[]) {<br> junit.textui.TestRunner.run(suite());<br> }<br> }</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">5、运行测试：<br> 以文本方式运行：<br> java junitfaq.SimpleTest</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">通过的测试结果是：</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">Time: 0</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">OK (1 tests)</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">Time上的小点表示测试个数，如果测试通过则显示OK。否则在小点的后边标上F，表示该测试失败。<br> 每次的测试结果都应该是OK的，这样才能说明测试是成功的，如果不成功就要马上根据提示信息进行修正了。<br> 如果JUnit报告了测试没有成功，它会区分失败（failures）和错误（errors）。失败是你的代码中的assert方法失败引起的；而错误则是代码异常引起的，例如ArrayIndexOutOfBoundsException。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">以图形方式运行：</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">java junit.swingui.TestRunner junitfaq.SimpleTest</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">通过的测试结果在图形界面的绿色条部分。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">以上是最简单的测试样例，在实际的测试中我们测试某个类的功能是常常需要执行一些共同的操作，完成以后需要销毁所占用的资源（例如网络连接、数据库连接，关闭打开的文件等），TestCase类给我们提供了setUp方法和tearDown方法，setUp方法的内容在测试你编写的TestCase子类的每个testXxxx方法之前都会运行，而tearDown方法的内容在每个testXxxx方法结束以后都会执行。这个既共享了初始化代码，又消除了各个测试代码之间可能产生的相互影响。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">JUnit最佳实践</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">Martin Fowler说过：“当你试图打印输出一些信息或调试一个表达式时，写一些测试代码来替代那些传统的方法。”一开始，你会发现你总是要创建一些新的Fixture，而且测试似乎使你的编程速度慢了下来。然而不久之后，你会发现你重复使用相同的Fixture，而且新的测试通常只涉及添加一个新的测试方法。&nbsp;</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">你可能会写许多测试代码，但你很快就会发现你设想出的测试只有一小部分是真正有用的。你所需要的测试是那些会失败的测试，即那些你认为不会失败的测试，或你认为应该失败却成功的测试。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">我们前面提到过测试是一个不会中断的过程。一旦你有了一个测试，你就要一直确保其正常工作，以检验你所加入的新的工作代码。不要每隔几天或最后才运行测试，每天你都应该运行一下测试代码。这种投资很小，但可以确保你得到可以信赖的工作代码。你的返工率降低了，你会有更多的时间编写工作代码。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">不要认为压力大，就不写测试代码。相反编写测试代码会使你的压力逐渐减轻，应为通过编写测试代码，你对类的行为有了确切的认识。你会更快地编写出有效率地工作代码。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">下面是一些具体的编写测试代码的技巧或较好的实践方法：</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">1. 不要用TestCase的构造函数初始化Fixture，而要用setUp()和tearDown()方法。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">2. 不要依赖或假定测试运行的顺序，因为JUnit利用Vector保存测试方法。所以不同的平台会按不同的顺序从Vector中取出测试方法。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">3. 避免编写有副作用的TestCase。例如：如果随后的测试依赖于某些特定的交易数据，就不要提交交易数据。简单的会滚就可以了。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">4. 当继承一个测试类时，记得调用父类的setUp()和tearDown()方法。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">5. 将测试代码和工作代码放在一起，一边同步编译和更新。（使用Ant中有支持junit的task.）</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">6. 测试类和测试方法应该有一致的命名方案。如在工作类名前加上test从而形成测试类名。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">7. 确保测试与时间无关，不要依赖使用过期的数据进行测试。导致在随后的维护过程中很难重现测试。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">8. 如果你编写的软件面向国际市场，编写测试时要考虑国际化的因素。不要仅用母语的Locale进行测试。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">9. 尽可能地利用JUnit提供地assert/fail方法以及异常处理的方法，可以使代码更为简洁。<br> 10.测试要尽可能地小，执行速度快。</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">JUnit和ant结合</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">cherami 转贴</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">ant 提供了两个 target ： junit 和 junitreport&nbsp;<br> 运行所有 测试用例 ，并生成 html 格式的报表&nbsp;<br> 具体操作如下：</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">1.将 junit.jar 放在 ANT_HOME\lib 目录下&nbsp;<br> 2.修改 build.xml ，加入如下 内容：</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">&lt;property name="report" value="report" /&gt; &lt;target name="junitreport" depends="clean, compile"&gt; &lt;junit printsummary="on" fork="true" haltonfailure="false" failureproperty="tests.failed" showoutput="true"&gt; &lt;classpath refid="myclasspath"/&gt; &lt;formatter type="xml"/&gt; &lt;batchtest todir="${report}"&gt; &lt;fileset dir="${build}"&gt; &lt;include name="**/*Test.*"/&gt; &lt;/fileset&gt; &lt;/batchtest&gt; &lt;/junit&gt; &lt;junitreport todir="${report}"&gt; &lt;fileset dir="${report}"&gt; &lt;include name="TEST-*.xml"/&gt; &lt;/fileset&gt; &lt;report format="frames" todir="${report}"/&gt; &lt;/junitreport&gt; &lt;fail if="tests.failed"&gt; --------------------------------------------------------- One or more tests failed, check the report for detail... --------------------------------------------------------- &lt;/fail&gt; &lt;/target&gt;</p> 
   <p style="color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';font-size:13px;">运行 这个 target ，ant 会运行每个 TestCase&nbsp;<br> 在 report 目录下就有了 很多 TEST*.xml 和 一些网页&nbsp;<br> 打开 report 目录下的 index.html 就可以看到很直观的测试运行报告，一目了然。</p> 
   <p><font color="#4b4b4b"><span style="font-size:13px;">本文转自博客园执着的笨蛋的博客，原文链接：<a href="http://www.blogjava.net/lcs/archive/2008/03/31/189806.html" rel="nofollow">JUnit最佳实践</a></span></font><span style="font-size:13px;color:rgb(75,75,75);font-family:verdana, Arial, helvetica, 'sans-seriff';">，如需转载请自行联系原博主。</span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
