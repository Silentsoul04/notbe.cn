<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>最大长方形 (Maximum Submatrix & Largest Rectangle)（涵盖各种求最大矩形题目） « NotBeCN</title>
  <meta name="description" content="             在这篇文章里，我将探讨几个和求最大长方形相关的题目，并试图说明如何把一些相对复杂的问题化归成简单的易解的问题。这里的最大，可以指长方形内所有元素之各最大，也可以指面积最大。    问题一（最大和子矩阵）&nbsp;： 有一个 m x n 的矩阵，矩阵的元素可正可负。请找出该矩阵的一个子矩...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/12/17/weixin_33816300_90133881.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">最大长方形 (Maximum Submatrix & Largest Rectangle)（涵盖各种求最大矩形题目）</h1>
    <p class="post-meta">Dec 17, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">在这篇文章里，我将探讨几个和求最大长方形相关的题目，并试图说明如何把一些相对复杂的问题化归成简单的易解的问题。这里的最大，可以指长方形内所有元素之各最大，也可以指面积最大。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><strong>问题一（最大和子矩阵）</strong>&nbsp;： 有一个 m x n 的矩阵，矩阵的元素可正可负。请找出该矩阵的一个子矩阵（方块），使得其所有元素之和在所有子矩阵中最大。(问题来源：http://acm.pku.edu.cn/JudgeOnline/problem?id=1050）</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><strong>问题二（</strong>&nbsp;<strong>最大 0/1 方块）</strong>&nbsp;： 有一个 m x n 的矩阵，元素为 0 或 1。一个子矩阵，如果它所有的元素都是 0， 或者都是 1，则称其为一个 0-聚类 或 1-聚类，统称聚类(Cluster)。请找出最大的聚类（元素最多的聚类）。（问题来源：某面试题）</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">这两个问题，除了都是在矩阵上操作之外，似乎没有什么共同之处。其实不然。事实上，它们可以用同一个思路解决。该思路来源于下面的一个问题：</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><strong>问题三（和最大的段）</strong>&nbsp;：有 n 个有正有负的数排成一行，求某个连续的段，使得其元素之和最大。(问题来源：某面试题。事实上，这也是一道经典题目，具体参考 http://en.wikipedia.org/wiki/Maximum_subarray_problem)</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">具体地说，就是把前两个问题化归成多个问题三。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><strong>问题四（最大长方形）</strong>&nbsp;： 有一个有 n 个项的统计直方图，假定所有的直方条 (bar) 的宽度一样。在所有边与 x 轴 和 y 轴平行的长方形中，求该被该直方图包含的面积最大的长方形。（我猜测即使不要求长方形与 x 和 y 轴平行解也是一样的，不过，没有验证过）（问题来源：某面试题目，也是一道经典题目）</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">问题四似乎和前三个问题毫不相关。令人吃惊地是，它的解决方法可以给最大0/1方块问题提供新思路，同样的，就是把最大0/1方块问题化归成多个问题四。本文的重点在于<strong>化归的思想</strong>&nbsp;，即把一些相对难的问题化归成一个或多个相对容易的问题，而这些容易的问题往往有更高效和优美的解。如果化归得当，问题的解会比直接去解该问题量多优美和更有效率。接下来的部分，我们先用动态规划解前两个问题，以给后面不同的解决思路提供对比。接着解决问题三，并介绍如何把前两个问题化归到问题三。最后解决最后一个问题，并应用它来给出问题二另一种思路。为了讨论方便，我们假设 m 和 n 只相差常数倍。否则的话，由于问题的对称性，我们可以翻转矩阵，从而使得时间复杂度取得最小。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><strong>I 前两个问题的动态规划解</strong></span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">先看最大和子矩阵问题。每个子矩阵由列长、行长和左上角的元素位置决定。如果我们指定左上角的元素位置 (i,j) 和列长 c，那么可以求所有这些子矩阵中和最大的。然后，变化列长 c，可以求以 (i,j) 为左上角的最大和子矩阵。最所有左上角位置再求最大和子矩阵，问题就解决了。令 OPT(i,j,c) 表示以 (i,j) 为左上角，列长为 c 的最大和子矩阵之和，OPT(i,j) 表示以 (i,j) 为左上角的最优解，而 S(i,u,v) 表示第 i 行中从列 u 到列 v所有元素之和。则</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;&nbsp;&nbsp; OPT(i,j,c) = OPT(i+1,j,c) + S(i,j,j+c-1)</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;&nbsp;&nbsp; OPT(i,j) = max { OPT(i,j,c) : 1 &lt;= c &lt;= n }</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">其中，j+c-1 &lt;= n。当 i &gt;m 时， OPT(i,j,c) = 0。一共有 O(mn) 个 OPT(i,j) 子问题，而每个 OPT(i,j) 又可以有 n 个决策，因此，总的解规模有 O(mn<sup>2</sup>&nbsp;) 个 OPT(i,j,c)。每个这样的子问题可以在 O(1) 时间内解决（想想怎么做到），因此，时间复杂度为 O(mn<sup>2</sup>&nbsp;)。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">对于最大 0/1 块问题，可以用类似的动态规划求解。首先只考虑 1-聚类。令 OPT(i,j,c) 表示以 (i,j) 为左上角的列长为 c 的最大 1-聚类。则， OPT(i,j,c) =</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;&nbsp;&nbsp; 1) 0，如果 (i,j) 为 0，或者 (i,j), (i,j+1),..., (i,j+1-c) 不全为 1；否则</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;&nbsp;&nbsp; 2) OPT(i+1,j,c) + c。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">然后再考虑 0-聚类，过程类似。总的时间复杂度也是 O(mn<sup>2</sup>&nbsp;)。这种解法虽然可行，效率也还可以，但状态比较多，而且也不够优雅，状态的构造比较生硬。如果各位有更好的动态规划思路，还望不吝留言相告。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><strong>II 和最大的段问题</strong></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">这个问题，最直接的办法是对每个可能的段求和，然后取最大值。这样的话，时间复杂度是 O(n<sup>2</sup>&nbsp;)。最优的解是只扫描数组一遍，因此时间为 O(n)。假设 x1, x2, ..., xt 是最优解。那么，显然， 对任何 i &lt;= t，x1, x2,..., xi 之和不可能为负。否则，砍去这一段，我们可以得到更大的值，这些该段的最优性矛盾。这就是说，最优解的段前缀不可能为负。而换句话说，如果一个段的和为负，则不可能是最优解的一部分。一开始，令当前段为从 x1 开始的段，置为空。我们从数组开始向前搜索，并把遇到的数加入当前段 s，同时记录目前遇到的最大和。这个过程一直持续到加入某个数 xi，使得 s 之和为负，则清空 s，然后以 xi 的下一个元素为当前段的开始，继续向前搜索。重复这个过程直到数组结束。在实现时，并不需要维护集合 s 并每次都对其对和，而只需要维护一个当前段的和，当有新元素加入当前段时，更新段的和；当重新开始一个段时，清 0 该段之和。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <div class="dp-highlighter bg_c-sharp" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;color:rgb(75,75,75);"> 
    <div class="bar"> 
     <div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left:3px solid rgb(108,226,108);"> 
      <strong>[c-sharp]</strong>&nbsp;
      <a class="ViewSource" title="view plain" href="http://blog.csdn.net/linulysses/article/details/5594141" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">view plain</a>
      <a class="CopyToClipboard" title="copy" href="http://blog.csdn.net/linulysses/article/details/5594141" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">copy</a> 
      <div></div> 
     </div> 
    </div> 
    <ol style="border:none;color:rgb(92,92,92);">
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">s&nbsp;=&nbsp;0&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">max&nbsp;=&nbsp;0&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">u&nbsp;=&nbsp;v&nbsp;=&nbsp;1&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//&nbsp;the&nbsp;starting&nbsp;index&nbsp;u&nbsp;and&nbsp;ending&nbsp;index&nbsp;v&nbsp;of&nbsp;current&nbsp;solution</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">max_u&nbsp;=&nbsp;max_v&nbsp;=&nbsp;-1&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//&nbsp;the&nbsp;starting&nbsp;and&nbsp;ending&nbsp;index&nbsp;of&nbsp;optimal&nbsp;solution</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;i&nbsp;from&nbsp;1&nbsp;to&nbsp;n&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;s&nbsp;+&nbsp;xi&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;max&nbsp;&lt;&nbsp;sum(s)&nbsp;then&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;=&nbsp;sum(s)&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;=&nbsp;i;&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max_v&nbsp;=&nbsp;v;&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max_u&nbsp;=&nbsp;u;&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;sum(s)&nbsp;&lt;&nbsp;0&nbsp;then&nbsp;&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;0&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//&nbsp;clear&nbsp;s</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;=&nbsp;v&nbsp;=&nbsp;i+1&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">return</span><span style="border:none;">&nbsp;max,&nbsp;max_u,&nbsp;max_v&nbsp;&nbsp;</span></span></li> 
    </ol>
   </div> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><strong>III 化归 -- 把问题一二转成问题三</strong></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">先看问题一。不难发现，问题一是问题三的二维版。由于一维的问题很好解，自然而然地，如果能把二维的降到一维的来处理，那么，事情就好办了。考虑子问题 OPT(i,j)，其表示所有开始于第 i 行，结束于第 j 行的子矩阵中的最大和。在这些子矩阵中，起止行都一样，只是起止列不相同。也就是说，解 OPT(i,j)，就只是找出某段列，使得其和最大。这就和第三个问题很相似了。为了化了问题三，我们把这些行都叠加到一起，变成一个单行，这就和问题三一样了：找出某个段，使得其和最大。然后，我们在所有 OPT(i,j) 中取最大值，即为原来问题的解。仔细地设计算法，可以使得其时间复杂度为 O(m<sup>2</sup>&nbsp;n)。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <div class="dp-highlighter bg_c-sharp" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;color:rgb(75,75,75);"> 
    <div class="bar"> 
     <div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left:3px solid rgb(108,226,108);"> 
      <strong>[c-sharp]</strong>&nbsp;
      <a class="ViewSource" title="view plain" href="http://blog.csdn.net/linulysses/article/details/5594141" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">view plain</a>
      <a class="CopyToClipboard" title="copy" href="http://blog.csdn.net/linulysses/article/details/5594141" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">copy</a> 
      <div></div> 
     </div> 
    </div> 
    <ol style="border:none;color:rgb(92,92,92);">
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">opt&nbsp;=&nbsp;0&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">row_u,&nbsp;row_v,&nbsp;col_u,&nbsp;col_v&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//&nbsp;record&nbsp;the&nbsp;optimal&nbsp;solution</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;i&nbsp;from&nbsp;1&nbsp;to&nbsp;m&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;line&nbsp;=&nbsp;{0,0,...,0}&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;j&nbsp;from&nbsp;i&nbsp;to&nbsp;m&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;k&nbsp;from&nbsp;1&nbsp;to&nbsp;n&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;line[k]&nbsp;=&nbsp;line[k]&nbsp;+&nbsp;x[j,k]&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//&nbsp;add&nbsp;row&nbsp;j&nbsp;to&nbsp;line</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(max,max_u,max_v)&nbsp;=&nbsp;solve&nbsp;maximum&nbsp;subarray&nbsp;problem&nbsp;one&nbsp;line[1..n]&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;opt&nbsp;&lt;&nbsp;max&nbsp;then&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opt&nbsp;=&nbsp;max&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col_u&nbsp;=&nbsp;max_u&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col_v&nbsp;=&nbsp;max_v&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_u&nbsp;=&nbsp;i;&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_v&nbsp;=&nbsp;j;&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">return</span><span style="border:none;">&nbsp;opt,&nbsp;row_u,&nbsp;row_v,&nbsp;col_u,&nbsp;col_v&nbsp;&nbsp;</span></span></li> 
    </ol>
   </div> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">对于问题二，类似的转化方法，只是在做行叠加时，如果都是 0 或 1，则为1，否则，为 -1。不再穆赘述。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><strong>IV 最大长方形</strong></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">在直方图中，一个长方形由其左边界和右边界决定，其最大可能的高度由两者中的最小者决定。记 R(i,j) 为由第 i 个直方柱为左边界，第 j 个直方柱确定的面积最大的长方形。如果 R(i,j) 的面积最大，那么，第 i 个直方柱比它的前一个直方柱（如果存在的话），即第 i-1 个直方柱要高，而 第 j 个直方柱的高度也比第 j+1 个的要高，否则，由 R(i,j+1) 或 R(i-1,j) 的面积比 R(i,j) 还要大，这违背了 R(i,j) 的最优性。根据这个观察，我们从第1个直方柱开始，寻找第一个 i, 使得直方柱 i 的高度比 i+1 的大，则 i 是一个可能的右边界，而 i 之前的每一根直方柱都是可能是左边界（因为 i 是第一个比 i + 1 高的直方柱，所以，在 i 之前的是一个上升的直方柱序列，每一根都比前一根要高）。这时，我们计算前面所有可能的长方形的面积，并跟当前已知的最大值进行比较，并更新当前已知的最大值（如有必要的话）。然后，我们继续向前搜索第二个这样的 i 。重复这个过程，直到最后一根直方柱。这样，我们已经遍历了所有可能是最优解的长方形，并取了其中的最大值，因此，该算法是正确的。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">至于时间复杂度，似乎还不太明显。对每个直方柱，我们通过跟后一个进行比较就知道其是否为一个可能的右边界。如果是，则需要对前面的一个上升序列的每个直方住计算其和 i 确定的最大长方形的面积，这个上升序列最差情况下似乎有 O(n) 长，时间复杂度最差似乎要 O(n<sup>2</sup>&nbsp;)。其实不然，只要注意到，每个可能的左边界只会被计算一次，因此，总的时间复杂度为 O(n)。我们使用一个栈来保存前面的上升直方柱序列，当遇到一个可能的右边界时，把这些可能的左边界都弹出来，并计算其和右边界确定的长方形面积。显然，每个可能的左边界只会放栈一次。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><br> 代码应该好理解：</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">//O(nlog(n)) solution is like quick sort ,<br> //O(n) solution is like to calculate the smaller closest previous index for each element</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">int CalcHistogram1(int a[], int n)<br> {<br> assert(NULL != a);<br> if(0 == n) return 0;</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">assert(n &gt; 0);</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">//Find the smallest element<br> int nSmallest = 0;<br> for (int i = 0; i &lt; n; i++)<br> {<br> assert(a &gt;= 0);<br> nSmallest = a[nSmallest] &lt; a ? nSmallest : i;<br> }</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">int nRet = a[nSmallest] * n;<br> int nLft = CalcHistogram1(a, nSmallest);<br> int nRgt = CalcHistogram1(a+nSmallest+1, n-nSmallest-1);</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">nRet = nRet &gt; nLft ? nRet : nLft;<br> nRet = nRet &gt; nRgt ? nRet : nRgt;</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">return nRet;<br> }</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">int CalcHistogram2(int a[], int n)<br> {<br> assert(NULL != a);<br> assert(n &gt; 0);</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">int nRet = 0;<br> stack&lt;int&gt; stk;<br> stk.push(0);</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">for (int i = 1; i &lt; n; i++)<br> {<br> assert(a &gt;= 0);<br> if (a &gt;= stk.top())&nbsp;<br> {<br> stk.push(a);<br> continue;<br> }</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">while (!stk.empty() &amp;&amp; stk.top() &gt; a)<br> {<br> int nTop = stk.top();<br> stk.pop();</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">nRet = nRet &gt; (i-nTop)*a[nTop] ? nRet : (i-nTop)*a[nTop];<br> }<br> }</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">int nEnd = stk.top()+1;<br> while (!stk.empty())<br> {<br> int nTop = stk.top();<br> stk.pop();</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">nRet = nRet &gt; (nEnd-nTop)*a[nTop] ? nRet : (nEnd-nTop)*a[nTop];<br> }</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">return nRet;<br> }</p> 
   <div class="dp-highlighter bg_cpp" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;color:rgb(75,75,75);"> 
    <div class="bar"> 
     <div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left:3px solid rgb(108,226,108);"> 
      <strong>[cpp]</strong>&nbsp;
      <a class="ViewSource" title="view plain" href="http://blog.csdn.net/linulysses/article/details/5594141" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">view plain</a>
      <a class="CopyToClipboard" title="copy" href="http://blog.csdn.net/linulysses/article/details/5594141" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">copy</a> 
      <div></div> 
     </div> 
    </div> 
    <ol style="border:none;color:rgb(92,92,92);">
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">max&nbsp;=&nbsp;0&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">u&nbsp;=&nbsp;v&nbsp;=&nbsp;0&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;i&nbsp;from&nbsp;1&nbsp;to&nbsp;n+1&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;=&nbsp;i&nbsp;==&nbsp;n+1&nbsp;?&nbsp;0&nbsp;:&nbsp;bar[i].height&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;stack&nbsp;is&nbsp;empty,&nbsp;or&nbsp;h&nbsp;&gt;=&nbsp;stack[top].height&nbsp;then&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;bar[i]&nbsp;into&nbsp;stack&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">else</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pop&nbsp;the&nbsp;top&nbsp;bar&nbsp;in&nbsp;stack&nbsp;to&nbsp;b&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;area&nbsp;=&nbsp;b.height&nbsp;*&nbsp;(i-b.index)&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;max&nbsp;&lt;&nbsp;area&nbsp;then&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;=&nbsp;area&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;=&nbsp;b.index&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;=&nbsp;i-1&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;stack&nbsp;is&nbsp;empty&nbsp;or&nbsp;h&nbsp;&gt;&nbsp;stack[top].height&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">return</span><span style="border:none;">&nbsp;max,&nbsp;u,&nbsp;v&nbsp;&nbsp;</span></span></li> 
    </ol>
   </div> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">V 化归 -- 把问题二转成问题四</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">依然是先考虑 1-聚类。从最后一行开始向上，某个列上的连续的 1 可以看做一个直方柱，直到碰到 0 或矩阵边界。而最大的1-聚类正是该“直方图”上的最大长方形。因此，我们可以用 OPT(i) 来表示终止于行 i 的最大的 1-聚类。这样，一共有 O(m) 个子问题，而每个子问题可以上面的方法解，时间复杂度为 O(n)，因此总的时间复杂度为 O(mn)！不过，前提时，对每个子问题，我们可以只用 O(n) 的时间转换成一个“直方图”。事实上，除了最后一行开始，我们可以利用 OPT(i) 的直方图来构造 OPT(i-1) 的直方图，并且在整个过程中，每个元素只需要被计算一次即可。</p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">&nbsp;</p> 
   <div class="dp-highlighter bg_c-sharp" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;color:rgb(75,75,75);"> 
    <div class="bar"> 
     <div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left:3px solid rgb(108,226,108);"> 
      <strong>[c-sharp]</strong>&nbsp;
      <a class="ViewSource" title="view plain" href="http://blog.csdn.net/linulysses/article/details/5594141" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">view plain</a>
      <a class="CopyToClipboard" title="copy" href="http://blog.csdn.net/linulysses/article/details/5594141" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">copy</a> 
      <div></div> 
     </div> 
    </div> 
    <ol style="border:none;color:rgb(92,92,92);">
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">opt&nbsp;=&nbsp;0&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">row_u,&nbsp;row_v,&nbsp;col_u,&nbsp;col_v&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//&nbsp;the&nbsp;starting&nbsp;and&nbsp;ending&nbsp;of&nbsp;row&nbsp;and&nbsp;column&nbsp;of&nbsp;optimal&nbsp;solution,&nbsp;respectively</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">bar&nbsp;=&nbsp;[0,0,...,0]&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;i&nbsp;from&nbsp;m&nbsp;to&nbsp;1&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;j&nbsp;from&nbsp;1&nbsp;to&nbsp;n&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;i&nbsp;!=&nbsp;m&nbsp;and&nbsp;x[i+1,j]&nbsp;=&nbsp;1&nbsp;then&nbsp;bar[j]&nbsp;=&nbsp;bar[j]-1&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">else</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;=&nbsp;i&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeat&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bar[j]&nbsp;=&nbsp;bar[j]+1&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;=&nbsp;k-1&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;until&nbsp;k&nbsp;&lt;&nbsp;1&nbsp;or&nbsp;x[k,j]&nbsp;=&nbsp;0&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;(max,u,v)&nbsp;=&nbsp;solve&nbsp;maximum&nbsp;rectangle&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">in</span><span style="border:none;">&nbsp;bar&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;opt&nbsp;&lt;&nbsp;max&nbsp;then&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opt&nbsp;=&nbsp;max&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col_u&nbsp;=&nbsp;u&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col_v&nbsp;=&nbsp;v&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_u&nbsp;=&nbsp;i&nbsp;-&nbsp;the&nbsp;height&nbsp;of&nbsp;the&nbsp;returned&nbsp;rectangle&nbsp;+&nbsp;1&nbsp;&nbsp;</span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_v&nbsp;=&nbsp;i&nbsp;&nbsp;</span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">end&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
     <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">return</span><span style="border:none;">&nbsp;opt,&nbsp;row_u,&nbsp;row_v,&nbsp;col_u,&nbsp;col_v &nbsp;</span></span></li> 
    </ol>
   </div> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">这个解法相比上面的动态规划解要优美得多，而且时间复杂度更低！把一些比较难的或者维度比较高的问题化归到低维或经典的问题，往往可以得到意想不到的更好的解。先决条件是，积累足够多的题解，并善于观察题目与题目之间的联系和相似之处是为自勉。</p> 
   <p><font color="#4b4b4b"><span style="font-size:13px;">本文转自博客园知识天地的博客，原文链接：<a href="http://www.cnblogs.com/mfryf/archive/2012/09/06/2672881.html" rel="nofollow">最大长方形 (Maximum Submatrix &amp; Largest Rectangle)（涵盖各种求最大矩形题目）</a>，如需转载请自行联系原博主。</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
