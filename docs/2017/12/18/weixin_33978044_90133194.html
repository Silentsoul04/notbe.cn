<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ABP理论学习之本地化 « NotBeCN</title>
  <meta name="description" content="             本篇目录        应用语言     本地化资源     获取本地化文本     扩展本地化资源     最佳实践        应用语言    一个应用至少有一种UI语言，许多应用不止有一种语言。ABP为应用提供了一个灵活的本地化系统。    第一件事情就是声明支持哪些语言。这个是...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/12/18/weixin_33978044_90133194.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">ABP理论学习之本地化</h1>
    <p class="post-meta">Dec 18, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);">本篇目录</h2> 
   <ul style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPLocalization.html#appLang" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">应用语言</a></strong></li> 
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPLocalization.html#source" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">本地化资源</a></strong></li> 
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPLocalization.html#text" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">获取本地化文本</a></strong></li> 
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPLocalization.html#extend" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">扩展本地化资源</a></strong></li> 
    <li style="list-style:disc;"><strong><a href="http://www.cnblogs.com/farb/p/ABPLocalization.html#bestPractice" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">最佳实践</a></strong></li> 
   </ul>
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;"> <a name="appLang" style="color:rgb(224,130,131);"></a>应用语言</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">一个应用至少有一种UI语言，许多应用不止有一种语言。ABP为应用提供了一个灵活的本地化系统。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">第一件事情就是声明支持哪些语言。这个是在模块的<strong>PreInitialize</strong>方法中完成的，如下所示：</p> 
   <pre class="c#"><code class="hljs cpp" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">Configuration.Localization.Languages.Add(<span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> LanguageInfo(<span class="hljs-string" style="color:rgb(163,21,21);">"en"</span>, <span class="hljs-string" style="color:rgb(163,21,21);">"English"</span>, <span class="hljs-string" style="color:rgb(163,21,21);">"famfamfam-flag-england"</span>, <span class="hljs-literal" style="color:rgb(163,21,21);">true</span>));
Configuration.Localization.Languages.Add(<span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> LanguageInfo(<span class="hljs-string" style="color:rgb(163,21,21);">"tr"</span>, <span class="hljs-string" style="color:rgb(163,21,21);">"Türkçe"</span>, <span class="hljs-string" style="color:rgb(163,21,21);">"famfamfam-flag-tr"</span>));
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">在服务端，可以先注入<strong>ILocalizationManager</strong>,然后使用它。在客户端，可以使用&nbsp;<strong>abp.localization</strong>Javascript API来获得所有可使用的语言和当前的语言。famfamfam-flag-england (和tr)只是一个Css类而已，你可以根据自己的需要改变它。然后在UI上使用它来展示相关的旗帜（比如各种国旗）。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">ABP模板使用了本地化系统给用户呈现的是一个<strong>切换语言</strong>的下拉列表。你可以创建一个模板项目然后学习一下源代码。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;"> <a name="source" style="color:rgb(224,130,131);"></a>本地化资源</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">本地化文本可以存储在不同的资源中。甚至你可以在相同的应用中使用不止一种语言（如果你有不止一个模块，每个模块可以定义一个单独的本地化资源）。应该为本地化资源实现<strong>ILocalizationSource</strong>接口，然后将它注册到ABP的本地化配置中。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">每个本地化资源必须有一个<strong>唯一的资源名</strong>。&nbsp;<strong>XML文件</strong>和&nbsp;<strong>资源</strong>文件是预定义的本地化资源类型。</p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">XML文件</h4> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">本地化文本可以存储在XML文件中，XML文件的内容就像下面展示的那样：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre class="sourceCode xml"><code class="sourceCode xml hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="kw"><span class="hljs-meta" style="color:rgb(43,145,175);">&lt;?xml</span></span><span class="hljs-meta" style="color:rgb(43,145,175);"> version="1.0" encoding="utf-8" </span><span class="kw"><span class="hljs-meta" style="color:rgb(43,145,175);">?&gt;</span></span>
<span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">localizationDictionary</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">culture</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"en"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span>
  <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">texts</span>&gt;</span></span>
    <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">text</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">name</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"TaskSystem"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">value</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"Task System"</span></span></span><span class="hljs-tag" style="color:rgb(0,0,255);"> </span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">/&gt;</span></span>
    <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">text</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">name</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"TaskList"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">value</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"Task List"</span></span></span><span class="hljs-tag" style="color:rgb(0,0,255);"> </span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">/&gt;</span></span>
    <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">text</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">name</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"NewTask"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">value</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"New Task"</span></span></span><span class="hljs-tag" style="color:rgb(0,0,255);"> </span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">/&gt;</span></span>
    <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">text</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">name</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"Xtasks"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">value</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"{0} tasks"</span></span></span><span class="hljs-tag" style="color:rgb(0,0,255);"> </span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">/&gt;</span></span>
    <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">text</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">name</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"CompletedTasks"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">value</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"Completed tasks"</span></span></span><span class="hljs-tag" style="color:rgb(0,0,255);"> </span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">/&gt;</span></span>
    <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">text</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">name</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"EmailWelcomeMessage"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span>Hi,
Welcome to Simple Task System! This is a sample
email content.<span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">text</span>&gt;</span></span>
  <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">texts</span>&gt;</span></span>
<span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">localizationDictionary</span>&gt;</span></span></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">XML文件必须是<strong>utf-8</strong>编码，&nbsp;<strong>culture="en"</strong>声明该XML文件包含了英语文本。对于文本节点，<strong>name</strong>特性用于标识一个文本。你可以使用&nbsp;<strong>value</strong>特性或者&nbsp;<strong>inner text</strong>(如上面的最后一个)给本地化文本赋值。如下所示，我们为<strong>每种语言</strong>创建了一个单独的XML文件：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="https://images2015.cnblogs.com/blog/577014/201512/577014-20151231232053042-1808284103.png" style="border:0px;" alt="577014-20151231232053042-1808284103.png"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这里，<strong>SimpleTaskSystem</strong>是&nbsp;<strong>资源名称</strong>，SimpleTaskSystem定义了&nbsp;<strong>默认的语言</strong>。当请求一个文本时，ABP会从当前语言的XML文件中获取文本（使用Thread.CurrentThread.<strong>CurrentUICulture</strong>找到当前的语言）。如果不存在当前语言的文本，就会从默认语言的XML文件中获得文本。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>注册XML本地化资源</strong></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">XML文件可以存储在文件系统中或者可以内嵌在一个程序集中。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">对于<strong>文件系统</strong>存储的XML，我们可以注册一个XML本地化资源，如下所示：</p> 
   <pre class="c#"><code class="hljs cpp" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">Configuration.Localization.Sources.Add(
    <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> DictionaryBasedLocalizationSource(
        <span class="hljs-string" style="color:rgb(163,21,21);">"SimpleTaskSystem"</span>,
        <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> XmlFileLocalizationDictionaryProvider(
            HttpContext.Current.Server.MapPath(<span class="hljs-string" style="color:rgb(163,21,21);">"~/Localization/SimpleTaskSystem"</span>)
            )
        )
    );
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这个是在模块的<strong>PreInitialize</strong>事件中完成的（看<strong><a href="http://www.cnblogs.com/farb/p/ABPModuleSystem.html" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">模块系统</a></strong>获取更多信息）。ABP会找到所有给定目录的XML文件并注册这些本地化资源。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">对于<strong>内嵌的XML文件</strong>，我们应该将所有的本地化XML文件标记为内嵌的资源（选中xml文件，打开属性窗口，将生成操作的值改为‘内嵌的资源’）。然后像下面那样注册该本地化资源：</p> 
   <pre class="c#"><code class="hljs css" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-selector-tag" style="color:rgb(0,0,255);">Configuration</span><span class="hljs-selector-class">.Localization</span><span class="hljs-selector-class">.Sources</span><span class="hljs-selector-class">.Add</span>(
    <span class="hljs-selector-tag" style="color:rgb(0,0,255);">new</span> <span class="hljs-selector-tag" style="color:rgb(0,0,255);">DictionaryBasedLocalizationSource</span>(
        "<span class="hljs-selector-tag" style="color:rgb(0,0,255);">SimpleTaskSystem</span>",
        <span class="hljs-selector-tag" style="color:rgb(0,0,255);">new</span> <span class="hljs-selector-tag" style="color:rgb(0,0,255);">XmlEmbeddedFileLocalizationDictionaryProvider</span>(
            <span class="hljs-selector-tag" style="color:rgb(0,0,255);">Assembly</span><span class="hljs-selector-class">.GetExecutingAssembly</span>(),
            "<span class="hljs-selector-tag" style="color:rgb(0,0,255);">MyCompany</span><span class="hljs-selector-class">.MyProject</span><span class="hljs-selector-class">.Localization</span><span class="hljs-selector-class">.Sources</span>"
            )
        )
    );

</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>XmlEmbeddedFileLocalizationDictionaryProvider</strong>会获得包含XML文件的程序集（GetExecutingAssembly简单地指向当前的程序集）和XML文件的&nbsp;<strong>命名空间</strong>（程序集名称+xml文件的文件夹层次）。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">注意：当给内嵌的XML文件起名字时，要加上语言后缀，但是不要使用“.”，比如“MySource.ch.xml”，而要使用短号“-”，比如“MySource-en.xml”。因为当寻找资源时，“.”会造成问题。</p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">JSON文件</h4> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">JSON文件可以用于存储本地化资源的文本。JSON本地化文件的一个简单样例如下所示：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre class="sourceCode json"><code class="sourceCode json hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="fu">{</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">culture</span>"</span><span class="fu">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"en"</span></span><span class="fu">,</span>
  <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">texts</span>"</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">TaskSystem</span>"</span><span class="fu">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"Task system"</span></span><span class="fu">,</span>
    <span class="dt">"<span class="hljs-attr" style="color:#FF0000;">Xtasks</span>"</span><span class="fu">:</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">"{0} tasks"</span></span>
  <span class="fu">}</span>
<span class="fu">}</span></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">JSON文件的格式应该是unicode(utf-8)格式。<code style="line-height:1.8;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">"culture":"en"</code>表示该Json文件包含了英文文本。如下所示，我们为<strong>每种语言</strong>创建了一个单独的Json文件：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="https://dn-coding-net-production-pp.qbox.me/3a2186cf-3d54-4e0c-b70a-98ead158721c.png" alt="图片" style="border:0px;"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这里的<strong>MySourceName</strong>是资源名称， MySourceName.json定义了&nbsp;<strong>默认的语言</strong>，json文件和XML文件很相似。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>注册JSON本地化资源</strong><br> Json文件可以存储在<strong>文件系统</strong>中，也可以&nbsp;<strong>内嵌</strong>到一个程序集中。<br> 对于文件系统存储JSON，我们可以注册一个Json本地化资源，如下所示：</p> 
   <pre class="c#"><code class="hljs cpp" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">Configuration.Localization.Sources.Add(
    <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> DictionaryBasedLocalizationSource(
        <span class="hljs-string" style="color:rgb(163,21,21);">"MySourceName"</span>,
        <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> JsonFileLocalizationDictionaryProvider(
            HttpContext.Current.Server.MapPath(<span class="hljs-string" style="color:rgb(163,21,21);">"~/Localization/MySourceName"</span>)
            )
        )
    );
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这是在模块的<strong>PerInitialize</strong>事件中完成的。ABP会在给定的目录中寻找所有的Json文件，并注册到本地化资源。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">对于<strong>内嵌的Json文件</strong>，首先我们应该将所有的本地化Json文件标记为&nbsp;<strong>内嵌的资源</strong>（选中Json文件，然后打开属性窗口，更改生成操作为内嵌的资源即可）。然后我们就可以像下面那样注册本地化资源了：</p> 
   <pre class="c#"><code class="hljs css" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"> <span class="hljs-selector-tag" style="color:rgb(0,0,255);">Configuration</span><span class="hljs-selector-class">.Localization</span><span class="hljs-selector-class">.Sources</span><span class="hljs-selector-class">.Add</span>(
    <span class="hljs-selector-tag" style="color:rgb(0,0,255);">new</span> <span class="hljs-selector-tag" style="color:rgb(0,0,255);">DictionaryBasedLocalizationSource</span>(
        "<span class="hljs-selector-tag" style="color:rgb(0,0,255);">MySourceName</span>",
        <span class="hljs-selector-tag" style="color:rgb(0,0,255);">new</span> <span class="hljs-selector-tag" style="color:rgb(0,0,255);">JsonEmbeddedFileLocalizationDictionaryProvider</span>(
            <span class="hljs-selector-tag" style="color:rgb(0,0,255);">Assembly</span><span class="hljs-selector-class">.GetExecutingAssembly</span>(),
            "<span class="hljs-selector-tag" style="color:rgb(0,0,255);">MyCompany</span><span class="hljs-selector-class">.MyProject</span><span class="hljs-selector-class">.Localization</span><span class="hljs-selector-class">.Sources</span>"
            )
        )
    );
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>JsonEmbeddedFileLocalizationDictionaryProvider</strong>需要一个包含Json文件的程序集（GetExecutingAssembly指向当前的程序集）和Json文件的命名空间（命名空间是通过程序集名称+json文件的文件夹层次计算出来的）。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>注意：</strong>当我们给json文件添加了语言后缀时，不要使用“.”标记符号，如“MySource.tr.json”，而要使用分隔符如“<strong>MySource-tr.json</strong>”，因为“.”标记符号在寻找资源时可能会发生问题。</p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">资源文件</h4> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">本地化文本也可以存储在.NET的资源文件中。我们可以为每种语言创建一个资源文件，如下所示：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="https://images2015.cnblogs.com/blog/577014/201512/577014-20151231234452479-171479678.png" style="border:0px;" alt="577014-20151231234452479-171479678.png"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>MyTexts.resx</strong>包含了默认的语言文本， MyTexts.tr.resx包含了土耳其语言的文本。当我们打开MyTexts.resx时，我们可以看到所有文本：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="https://images2015.cnblogs.com/blog/577014/201512/577014-20151231234648354-476448936.png" style="border:0px;" alt="577014-20151231234648354-476448936.png"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">在这种情况下，ABP使用了.NET中内置的本地化资源管理者。你应该为该资源配置一个本地化资源：</p> 
   <pre class="c#"><code class="hljs css" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-selector-tag" style="color:rgb(0,0,255);">Configuration</span><span class="hljs-selector-class">.Localization</span><span class="hljs-selector-class">.Sources</span><span class="hljs-selector-class">.Add</span>(
    <span class="hljs-selector-tag" style="color:rgb(0,0,255);">new</span> <span class="hljs-selector-tag" style="color:rgb(0,0,255);">ResourceFileLocalizationSource</span>(
        "<span class="hljs-selector-tag" style="color:rgb(0,0,255);">MySource</span>",
        <span class="hljs-selector-tag" style="color:rgb(0,0,255);">MyTexts</span><span class="hljs-selector-class">.ResourceManager</span>
        ));
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这里，<strong>MySource</strong>是资源的&nbsp;<strong>唯一名字</strong>，而且&nbsp;<strong>MyTexts.ResourceManager</strong>是获取本地化文本的资源管理者的引用。这个是在模块的&nbsp;<strong>Initialize</strong>事件中完成的。</p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">自定义资源</h4> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">自定义本地化资源实现了在不同的资源中（比如数据库）存储文本。你可以直接实现<strong>ILocalizationSource</strong>接口或者从<strong>DictionaryBasedLocalizationSource</strong>类中派生可以使得实现更容易。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;"> <a name="text" style="color:rgb(224,130,131);"></a>获取本地化文本</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">当创建了资源并把它注册到ABP的本地化系统之后，文本就能轻易地本地化了。</p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">服务端</h4> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">在服务端，我们可以注入<strong>ILocalizationManager</strong>，然后使用它的&nbsp;<strong>GetString</strong>方法。</p> 
   <pre class="c#"><code class="hljs swift" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> s1 = _localizationManager.<span class="hljs-type" style="color:rgb(163,21,21);">GetString</span>(<span class="hljs-string" style="color:rgb(163,21,21);">"SimpleTaskSystem"</span>, <span class="hljs-string" style="color:rgb(163,21,21);">"NewTask"</span>);
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">GetString方法会基于<strong>当前线程的UI文化（culture）</strong>获取字符串。如果没有找到，就会返回&nbsp;<strong>默认语言</strong>对应的字符串。如果任何地方都没有定义该字符串，就会默认返回使用&nbsp;<strong>"[]"</strong>&nbsp;包装的&nbsp;<strong>给定字符串</strong>（而不是抛出异常）。这种行为是可以配置的（你可以在模块的PreInitialize中使用Configuration.Loacalization.ReturnGivenTextIfNotFound属性进行配置）。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">记得不要重复资源的名字(运行时会报错)，你可以首先获得<strong>该资源</strong>，然后从该资源中获得字符串：</p> 
   <pre class="c#"><code class="hljs swift" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> source = _localizationManager.<span class="hljs-type" style="color:rgb(163,21,21);">GetSource</span>(<span class="hljs-string" style="color:rgb(163,21,21);">"SimpleTaskSystem"</span>);
<span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> s1 = source.<span class="hljs-type" style="color:rgb(163,21,21);">GetString</span>(<span class="hljs-string" style="color:rgb(163,21,21);">"NewTask"</span>);
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这会返回当前语言的文本。GetString方法也有重载方法通过参数获取不同语言和格式的文本。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">如果我们不能注入ILocalizationManager（也许在一个不能到达依赖注入系统的静态上下文中），那么可以简单地使用<strong>LocalizationHelper</strong>静态类。但是尽可能地注入并使用ILocalizationManager，因为LocalizationHelper是静态的而且静态不好测试（对于写单元测试的人来说）。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">如果你需要在<strong><a href="http://www.cnblogs.com/farb/p/ABPApplicationService.html" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">应用服务</a></strong>、MVC控制器、Razor视图或者其他派生自<strong>AbpServiceBase</strong>的类中本地化，那么可以使用快捷的&nbsp;<strong>L</strong>方法。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>在MVC控制器中</strong></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">一般在MVC控制器和视图中需要本地化文本。这里有一个快捷方式，如下所示：</p> 
   <pre class="c#"><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">HomeController</span> : <span class="hljs-title" style="color:rgb(163,21,21);">SimpleTaskSystemControllerBase</span>
{
    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> ActionResult <span class="hljs-title" style="color:rgb(163,21,21);">Index</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> helloWorldText = L(<span class="hljs-string" style="color:rgb(163,21,21);">"HelloWorld"</span>);
        <span class="hljs-keyword" style="color:rgb(0,0,255);">return</span> View();
    }
}
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>L</strong>方法用于本地化一个字符串。当然，你必须提供一个资源名，这里的HelloWorld就是从资源中找到的。它是在控制器基类SimpleTaskSystemControllerBase(以ControllerBase为后缀的控制器)中完成的，如下所示：</p> 
   <pre class="c#"><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">abstract</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">SimpleTaskSystemControllerBase</span> : <span class="hljs-title" style="color:rgb(163,21,21);">AbpController</span>
{
    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">protected</span> <span class="hljs-title" style="color:rgb(163,21,21);">SimpleTaskSystemControllerBase</span>(<span class="hljs-params"></span>) </span>{
        LocalizationSourceName = <span class="hljs-string" style="color:rgb(163,21,21);">"SimpleTaskSystem"</span>;
    }
}
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">注意L派生自<strong>AbpController</strong>。因此，你可以使用&nbsp;<strong>L</strong>方法轻松地本地化文本。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>在MVC视图中</strong></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">在视图中也可以使用相同的<strong>L</strong>方法：</p> 
   <pre class="c#"><code class="hljs scala" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">&lt;div&gt;
    &lt;form id=<span class="hljs-string" style="color:rgb(163,21,21);">"NewTaskForm"</span> role=<span class="hljs-string" style="color:rgb(163,21,21);">"form"</span>&gt;
        &lt;div <span class="hljs-class"><span class="hljs-keyword" style="color:rgb(0,0,255);">class</span></span>=<span class="hljs-string" style="color:rgb(163,21,21);">"form-group"</span>&gt;
            &lt;label <span class="hljs-keyword" style="color:rgb(0,0,255);">for</span>=<span class="hljs-string" style="color:rgb(163,21,21);">"TaskDescription"</span>&gt;<span class="hljs-meta" style="color:rgb(43,145,175);">@L</span>(<span class="hljs-string" style="color:rgb(163,21,21);">"TaskDescription"</span>)&lt;/label&gt;
            &lt;textarea id=<span class="hljs-string" style="color:rgb(163,21,21);">"TaskDescription"</span> data-bind=<span class="hljs-string" style="color:rgb(163,21,21);">"value: task.description"</span> <span class="hljs-class"><span class="hljs-keyword" style="color:rgb(0,0,255);">class</span></span>=<span class="hljs-string" style="color:rgb(163,21,21);">"form-control"</span> rows=<span class="hljs-string" style="color:rgb(163,21,21);">"3"</span> placeholder=<span class="hljs-string" style="color:rgb(163,21,21);">"@L("</span><span class="hljs-type" style="color:rgb(163,21,21);">EnterDescriptionHere</span><span class="hljs-string" style="color:rgb(163,21,21);">")"</span> required&gt;&lt;/textarea&gt;
        &lt;/div&gt;
        &lt;div <span class="hljs-class"><span class="hljs-keyword" style="color:rgb(0,0,255);">class</span></span>=<span class="hljs-string" style="color:rgb(163,21,21);">"form-group"</span>&gt;
            &lt;label <span class="hljs-keyword" style="color:rgb(0,0,255);">for</span>=<span class="hljs-string" style="color:rgb(163,21,21);">"TaskAssignedPerson"</span>&gt;<span class="hljs-meta" style="color:rgb(43,145,175);">@L</span>(<span class="hljs-string" style="color:rgb(163,21,21);">"AssignTo"</span>)&lt;/label&gt;
            &lt;select id=<span class="hljs-string" style="color:rgb(163,21,21);">"TaskAssignedPerson"</span> data-bind=<span class="hljs-string" style="color:rgb(163,21,21);">"options: people, optionsText: 'name', optionsValue: 'id', value: task.assignedPersonId, optionsCaption: '@L("</span><span class="hljs-type" style="color:rgb(163,21,21);">SelectPerson</span><span class="hljs-string" style="color:rgb(163,21,21);">")'"</span> <span class="hljs-class"><span class="hljs-keyword" style="color:rgb(0,0,255);">class</span></span>=<span class="hljs-string" style="color:rgb(163,21,21);">"form-control"</span>&gt;&lt;/select&gt;
        &lt;/div&gt;
        &lt;button data-bind=<span class="hljs-string" style="color:rgb(163,21,21);">"click: saveTask"</span> <span class="hljs-class"><span class="hljs-keyword" style="color:rgb(0,0,255);">type</span></span>=<span class="hljs-string" style="color:rgb(163,21,21);">"submit"</span> <span class="hljs-class"><span class="hljs-keyword" style="color:rgb(0,0,255);">class</span></span>=<span class="hljs-string" style="color:rgb(163,21,21);">"btn btn-primary"</span>&gt;<span class="hljs-meta" style="color:rgb(43,145,175);">@L</span>(<span class="hljs-string" style="color:rgb(163,21,21);">"CreateTheTask"</span>)&lt;/button&gt;
    &lt;/form&gt;
&lt;/div&gt;
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">为了能够这样使用，你应该让你的视图派生自设置了资源名的一个基类：</p> 
   <pre class="c#"><code class="hljs ruby" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">public abstract <span class="hljs-class"><span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">SimpleTaskSystemWebViewPageBase</span> : <span class="hljs-title" style="color:rgb(163,21,21);">SimpleTaskSystemWebViewPageBase</span>&lt;dynamic&gt;</span>
{

}

public abstract <span class="hljs-class"><span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">SimpleTaskSystemWebViewPageBase</span>&lt;TModel&gt; : <span class="hljs-title" style="color:rgb(163,21,21);">AbpWebViewPage</span>&lt;TModel&gt;</span>
{
    protected SimpleTaskSystemWebViewPageBase()
    {
        LocalizationSourceName = <span class="hljs-string" style="color:rgb(163,21,21);">"SimpleTaskSystem"</span>;
    }
}
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">而且要在web.config中设置这个视图基类：</p> 
   <pre class="webconfig"><code class="hljs django" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="xml"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">pages</span> <span class="hljs-attr" style="color:#FF0000;">pageBaseType</span>=<span class="hljs-string" style="color:rgb(163,21,21);">"SimpleTaskSystem.Web.Views.SimpleTaskSystemWebViewPageBase"</span>&gt;</span> </span></code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">当你从ABP模板创建解决方案时，对于视图和控制器的所有这些都已经准备好了。</p> 
   <h4 style="font-size:14px;color:rgb(205,73,0);border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(205,73,0);font-family:'Microsoft Yahei', Simsun, Arial;line-height:25px;">客户端</h4> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">ABP也使得在javascript代码中使用相同的本地化文本成为了可能。首先，你应该将动态的ABP脚本添加到页面中：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-html"><code class="sourceCode html hljs xml" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">script</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">src</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"/AbpScripts/GetScripts"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">type</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"text/javascript"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span><span class="undefined"></span><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">script</span>&gt;</span></span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">ABP在客户端会自动生成需要的javascript代码来获得本地化的文本。然后，你就可以轻松地使用javascript获得一个本地化的文本，如下所示：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> s1 <span class="op">=</span> <span class="va">abp</span>.<span class="va">localization</span>.<span class="at">localize</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'NewTask'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'SimpleTaskSystem'</span></span>)<span class="op">;</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">这里，NewTask是文本名，SimpleTaskSystem是资源名。记住不要重复资源名。你也可以先获得资源名，然后获得文本：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> source <span class="op">=</span> <span class="va">abp</span>.<span class="va">localization</span>.<span class="at">getSource</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'SimpleTaskSystem'</span></span>)<span class="op">;</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> s1 <span class="op">=</span> <span class="at">source</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'NewTask'</span></span>)<span class="op">;</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>格式化参数</strong></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">本地化方法也可以有额外的格式参数，例子：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="va">abp</span>.<span class="va">localization</span>.<span class="at">localize</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'RoleDeleteWarningMessage'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'MySource'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'Admin'</span></span>)<span class="op">;</span> <span class="co"><span class="hljs-comment" style="color:#008000;">//如果使用上面的getSource找到了资源，就使用source作为快捷方式</span></span> <span class="at">source</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'RoleDeleteWarningMessage'</span></span><span class="op">,</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'Admin'</span></span>)<span class="op">;</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">如果RoleDeleteWarningMessage = 'Role {0} will be deleted'， 那么本地化后的文本就是'Role Admin will be deleted'。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>默认的本地化资源</strong><br> 可以设置默认的本地化资源，然后就能够不使用资源名称也可以使用<code style="line-height:1.8;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">abp.localization.localize</code>方法了。</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre><code class="language-javascript"><code class="sourceCode javascript hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="va">abp</span>.<span class="va">localization</span>.<span class="at">defaultSourceName</span> <span class="op">=</span> <span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'SimpleTaskSystem'</span></span><span class="op">;</span> <span class="kw"><span class="hljs-keyword" style="color:rgb(0,0,255);">var</span></span> s1 <span class="op">=</span> <span class="va">abp</span>.<span class="va">localization</span>.<span class="at">localize</span>(<span class="st"><span class="hljs-string" style="color:rgb(163,21,21);">'NewTask'</span></span>)<span class="op">;</span></code></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">defaultSourceName是全局的，并且一次只能用于一个资源名称。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;"> <a name="extend" style="color:rgb(224,130,131);"></a>扩展本地化资源</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">假设我们已经有一个定义了自己本地化资源的模块。我们可能需要更改它的本地化文本，或者添加一些新的文本或者翻译为其他的语言。如何解决这个呢？ABP允许扩展一个本地化资源，当前只对XML文件有效（实际上任何本地化资源都实现了IDictionaryBasedLocalizationSource接口）。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">ABP也定义了一些本地化资源。比如，<strong>Abp.Web</strong>nuget包定义了一个叫做&nbsp;<strong>AbpWeb</strong>的本地化资源作为内嵌XML文件：</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><img src="https://images2015.cnblogs.com/blog/577014/201601/577014-20160101131030401-240846594.png" style="border:0px;" alt="577014-20160101131030401-240846594.png"></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">默认的（英语）XML文件像下面这个样子（这里只展示一部分文本）：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre class="sourceCode xml"><code class="sourceCode xml hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="kw"><span class="hljs-meta" style="color:rgb(43,145,175);">&lt;?xml</span></span><span class="hljs-meta" style="color:rgb(43,145,175);"> version="1.0" encoding="utf-8" </span><span class="kw"><span class="hljs-meta" style="color:rgb(43,145,175);">?&gt;</span></span>
<span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">localizationDictionary</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">culture</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"en"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span>
  <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">texts</span>&gt;</span></span>
    <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">text</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">name</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"InternalServerError"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">value</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"An internal error occurred during your request!"</span></span></span><span class="hljs-tag" style="color:rgb(0,0,255);"> </span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">/&gt;</span></span>
    <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">text</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">name</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"ValidationError"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">value</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"Your request is not valid!"</span></span></span><span class="hljs-tag" style="color:rgb(0,0,255);"> </span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">/&gt;</span></span>
    ...
  <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">texts</span>&gt;</span></span>
<span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">localizationDictionary</span>&gt;</span></span></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">要扩展AbpWeb资源，我们可以定义XML文件。假设我们只想更改<strong>InternalServerError</strong>文本，我们就可以像下面那样定义一个XML文件：</p> 
   <div class="sourceCode" style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <pre class="sourceCode xml"><code class="sourceCode xml hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);color:rgb(0,0,0);background:rgb(255,255,255);"><span class="kw"><span class="hljs-meta" style="color:rgb(43,145,175);">&lt;?xml</span></span><span class="hljs-meta" style="color:rgb(43,145,175);"> version="1.0" encoding="utf-8" </span><span class="kw"><span class="hljs-meta" style="color:rgb(43,145,175);">?&gt;</span></span>
<span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">localizationDictionary</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">culture</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"en"</span></span></span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&gt;</span></span>
  <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">texts</span>&gt;</span></span>
    <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;<span class="hljs-name">text</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">name</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"InternalServerError"</span></span></span><span class="ot"><span class="hljs-tag" style="color:rgb(0,0,255);"> <span class="hljs-attr" style="color:#FF0000;">value</span>=</span></span><span class="st"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-string" style="color:rgb(163,21,21);">"Sorry :( It seems there is a problem. Let us to solve it and please try again later."</span></span></span><span class="hljs-tag" style="color:rgb(0,0,255);"> </span><span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">/&gt;</span></span>
  <span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">texts</span>&gt;</span></span>
<span class="kw"><span class="hljs-tag" style="color:rgb(0,0,255);">&lt;/<span class="hljs-name">localizationDictionary</span>&gt;</span></span></code></pre>
   </div> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">然后我们在模块的PreInitialize方法中注册它：</p> 
   <pre class="c#"><code class="hljs cpp" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">Configuration.Localization.Sources.Extensions.Add(
    <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> LocalizationSourceExtensionInfo(<span class="hljs-string" style="color:rgb(163,21,21);">"AbpWeb"</span>,
        <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> XmlFileLocalizationDictionaryProvider(
            HttpContext.Current.Server.MapPath(<span class="hljs-string" style="color:rgb(163,21,21);">"~/Localization/AbpWebExtensions"</span>)
            )
        )
    );
</code></pre> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">如果我们想创建内嵌的资源XML文件（上面有讲），那么可以使用XmlEmbeddedFileLocalizationDictionaryProvider。ABP使用XML文件合并了基本的本地化资源。我们也可以添加新的语言文件。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><strong>注意：</strong>我们可以使用Json文件来扩展XMl文件，反过来也一样。</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(111,168,51);border-left-width:13px;border-left-style:solid;border-left-color:rgb(111,168,51);font-family:'Microsoft Yahei', Simsun, Arial;"> <a name="conclusion" style="color:rgb(224,130,131);"></a>结论</h3> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">ABP提供了使用不同资源进行本地化的功能，也提供了在服务端和客户端代码中使用相同的本地化文本的基础设施。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">XML文件，Json文件和资源文件都有自己的长处和弱势，我们建议使用XML文件或者Json文件代替资源文件。因为：</p> 
   <ul style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">
    <li style="list-style:disc;">XML/JSON文件更容易编辑，扩展或者移植。</li> 
    <li style="list-style:disc;">当获取本地化文本时，XML/JSON文件要求string类型的key，而不是像资源文件需要编译时的属性。这个可以被认为是缺点，但是以后更改资源时相对容易一些。甚至我们将本地化不需要更改就可以移动到数据库或者使用了该本地化资源的代码中了（Module-zero已经实现了创建一个<strong>基于数据库和每个租户的</strong>本地化资源，查看《<strong><a href="http://www.cnblogs.com/farb/p/ModuleZeroLanguageManagement.html" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">Module Zero之语言管理</a></strong>》）。</li> 
   </ul>
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">此外，如果你使用XML或者Json，建议不要按照name进行排序文本，而要按照创建日期进行排序。这样，当别人要将文本翻译为其他语言时，ta就可以轻松地看到哪一个文本是新添加的。</p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;">通过实现<strong>ILocalizationSource</strong>接口，你也可以创建你自己的本地化资源并集成到ABP中。&nbsp;<strong>Module-zero</strong>实现了一个&nbsp;<strong>基于数据库</strong>和&nbsp;<strong>各租户</strong>的本地化资源。&nbsp;<strong><a href="http://www.cnblogs.com/farb/p/ModuleZeroLanguageManagement.html" rel="nofollow" style="color:rgb(65,131,196);text-decoration:none;">点击查看文档</a></strong></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><br></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><br></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><br></p> 
   <p style="color:rgb(73,73,73);font-family:'Microsoft Yahei', Simsun, Arial;font-size:15px;line-height:25px;"><br></p> 
   <p><font color="#494949"><span style="font-size:15px;line-height:25px;">本文转自tkbSimplest博客园博客，原文链接：http://www.cnblogs.com/farb/p/ABPLocalization.html，如需转载请自行联系原作者</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
