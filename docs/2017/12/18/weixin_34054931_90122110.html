<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>六之再续：KMP算法之总结篇（必懂KMP） « NotBeCN</title>
  <meta name="description" content="             引记    &nbsp; &nbsp; 此前一天，一位MS的朋友邀我一起去与他讨论快速排序，红黑树，字典树，B树、后缀树，包括KMP算法，唯独在讲解KMP算法的时候，言语磕磕盼盼，我想，原因有二：1、博客内的东西不常回顾，忘了不少；2、便是我对KMP算法的理解还不够彻底，自不用说讲解自如...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/12/18/weixin_34054931_90122110.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">六之再续：KMP算法之总结篇（必懂KMP）</h1>
    <p class="post-meta">Dec 18, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <h3 style="background:rgb(255,255,255) url(&quot;images/title.gif&quot;) no-repeat fixed left top;font-family:verdana;font-size:16px;color:rgb(102,102,102);line-height:1.5;">引记</h3> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; 此前一天，一位MS的朋友邀我一起去与他讨论快速排序，红黑树，字典树，<span>B</span><span>树、后缀树，包括</span><span>KMP</span><span>算法，唯独在讲解</span><span>KMP</span><span>算法的时候，言语磕磕盼盼，我想，原因有二：</span><span>1</span><span>、博客内的东西不常回顾，忘了不少；</span><span>2</span><span>、便是我对</span><span>KMP</span><span>算法的理解还不够彻底，自不用说讲解自如，运用自如了。所以，特再写本篇文章。由于此前，个人已经写过关于</span><span>KMP</span><span>算法的两篇文章，所以，本文名为：</span><span>KMP</span><span>算法之总结篇。</span></span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;本文分为二个部分：第一部分、再次回顾普通的<span>BF</span><span>算法与</span><span>KMP</span><span>算法各自的时间复杂度，并两相对照各自的匹配原理；第二部分、通过我此前一篇文章的引用，用图从头到尾详细阐述</span><span>KMP</span><span>算法中的</span><span>next</span><span>数组求法，并运用求得的</span><span>next</span><span>数组写出</span><span>KMP</span><span>算法的源码</span><span>。力求让此文彻底让读者洞穿此</span><span>KMP</span><span>算法，所有原理，来龙去脉，让读者搞个通通透透。</span></span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; 在看本文之前，你心中如若对前缀和后缀这个两个概念有自己的理解，便最好了。有些东西比如此<span>KMP</span><span>算法需要我们反复思考，反复求解才行。个人写的关于KMP算法的第二篇文章为：<a href="http://blog.csdn.net/v_JULY_v/archive/2011/06/15/6545192.aspx" rel="nofollow" style="color:rgb(52,104,164);">六（续）、从KMP算法一步一步谈到BM算法</a>。</span><span>ok</span><span>，若有任何问题，恳请不吝指正。多谢。</span></span></p> 
   <h3 style="background:rgb(255,255,255) url(&quot;images/title.gif&quot;) no-repeat fixed left top;font-family:verdana;font-size:16px;color:rgb(102,102,102);line-height:1.5;"> <a name="t1"></a>第一部分、<span>KMP</span><span>算法初解</span> </h3> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><strong><span>1<span>、</span>普通字符串匹配BF<span>算法与</span><span>KMP</span><span>算法的时间复杂度比较</span></span></strong></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;KMP<span>算法是一种线性时间复杂的字符串匹配算法，它是对</span><span>BF</span><span>算法（</span><span>Brute-Force</span><span>，最基本的字符串匹配算法的）改进。对于给的原始串</span><span>S</span><span>和模式串</span><span>P</span><span>，需要从字符串</span><span>S</span><span>中找到字符串</span><span>P</span><span>出现的位置的索引。</span></span></p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"> 
    <div class="Section0"> 
     <div> 
      <p><span>BF<span>算法的时间复杂度</span><span>O(strlen(S)&nbsp;*&nbsp;strlen(T))</span><span>，空间复杂度</span><span>O(1)</span><span>。</span></span></p> 
     </div> 
    </div> 
   </blockquote> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"> 
    <div class="Section0"> 
     <div> 
      <p><span>KMP<span>算法的时间复杂度</span><span>O(strlen(S)&nbsp;+&nbsp;strlen(T))</span><span>，空间复杂度</span><span>O(strlen(T))</span><span>。</span></span></p> 
     </div> 
    </div> 
   </blockquote> 
   <div class="Section0" style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"> 
    <div> 
     <p><strong><span>2<span>、</span><span>BF</span><span>算法与</span><span>KMP</span><span>算法的区别</span></span></strong></p> 
     <p><span>&nbsp;&nbsp;&nbsp;&nbsp;假设现在<span>S</span><span>串匹配到</span><span>i</span><span>位置，</span><span>T</span><span>串匹配到</span><span>j</span><span>位置。那么总的来说，两种算法的主要区别在于失配的情况下，对</span><span><img src="http://www.kuqin.com/upimg/allimg/111205/230252H50-0.gif" alt="[j]" style="border:0px;">&nbsp;</span><span>的值做的处理（注意，本文中的字符串下标都是从</span><span>0</span><span>开始计算）：</span></span></p> 
     <p><span>&nbsp;&nbsp;&nbsp;BF<span>算法中，如果当前字符匹配成功，即</span><span>s[i+j]&nbsp;==&nbsp;T[j]</span><span>，令</span><span>j++</span><span>，继续匹配下一个字符；如果失配，即</span><span>S[i&nbsp;+&nbsp;j]&nbsp;!=&nbsp;T[j]</span><span>，<strong>需要让</strong></span><strong><span>i++,</span><span>并且</span><span>j</span>=&nbsp;0</strong><span>，即每次匹配失败的情况下，模式串</span><span>T</span><span>相对于原始串</span><span>S</span><span>向右移动了一位。</span></span></p> 
     <p><span>&nbsp;&nbsp;&nbsp;&nbsp;而<span>KMP</span><span>算法中，如果当前字符匹配成功，即</span><span>S[i]==T[j]</span><span>，令</span><span>i++</span><span>，</span><span>j++</span><span>，继续匹配下一个字符；如果</span>匹配失败，即<span>S[i]&nbsp;!=&nbsp;T[j]</span><span>，需要保持</span><span>i</span><span>不变，并且让</span><span>j&nbsp;=&nbsp;next[j]</span><span>，这里</span><span>next[j]&nbsp;&lt;=j&nbsp;-1</span><span>，即模式串</span><span>T</span><span>相对于原始串</span><span>S</span><span>向右移动了至少</span><span>1</span><span>位</span><span>(</span><span><strong>移动的实际位数</strong></span><span><strong>j&nbsp;-&nbsp;next[j]&nbsp;&nbsp;&gt;=1</strong>),</span></span></p> 
     <p><span>&nbsp;&nbsp;&nbsp;&nbsp;同时移动之后，<span style="text-decoration:underline;"><span>i</span><span>之前的部分（即</span><span>S[i-j+1 ~&nbsp;i-1]</span><span>），和</span><span>j=next[j]</span><span>之前的部分（即</span><span>T[0&nbsp;~&nbsp;j-2]</span></span><span><span style="text-decoration:underline;">）仍然相等</span>。显然，<strong>相对于</strong></span><strong><span>BF</span><span>算法来说，</span><span>KMP</span></strong><span><strong>移动更多的位数，起到了一个加速的作用</strong>！&nbsp;</span><span>(</span><span>失配的特殊情形，令</span><span>j=next[j]</span><span>导致</span>j==0<span>的时候，需要将</span><span>i&nbsp;++</span>，否则此时没有移动模式串<span>)</span><span>。</span><br> &nbsp;</span></p> 
     <p><strong><span>3、BF<span>算法为什么要回溯</span></span></strong></p> 
     <p><span>&nbsp;</span></p> 
     <p><span>&nbsp;</span></p> 
    </div> 
   </div> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>首先说一下为什么<span>BF</span><span>算法要回溯。如下两字符串匹配（恰如上面所述：BF算法中，<span>如果当前字符匹配成功，即</span><span>s[i+j]&nbsp;==&nbsp;T[j]</span><span>，令</span><span>j++</span><span>，继续匹配下一个字符</span>）：</span></span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; &nbsp; i+j<span>（</span><span>j</span><span>随</span><span>T</span><span>中的</span><span>j++</span><span>变，而动）</span></span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>S：aaaacefghij</span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; j++</span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>T：aaac&nbsp;&nbsp;</span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>如果不回溯的话就是从下一位开始比起：</span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>aaaacefghij</span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; &nbsp; &nbsp; aaac</span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span style="font-size:large;">看到上面红颜色的没，如果不回溯的话，那么从<span>a&nbsp;</span><span>的下一位</span><span>c&nbsp;</span><span>比起。然而下述这种情况就漏了（正确的做法当然是要回溯：<span>如果失配，即</span><span>S[i&nbsp;+&nbsp;j]&nbsp;!=&nbsp;T[j]</span><span>，<strong>需要让</strong></span><span>i++,<span>并且</span>j=&nbsp;0</span>）：</span></span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>a<span style="text-decoration:underline;">aaac</span>efghij</span></p> 
   <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; aaac</span></p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"> 
    <div class="Section0"> 
     <div> 
      <p><span>&nbsp;</span></p> 
     </div> 
    </div> 
   </blockquote> 
   <div class="Section0" style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"> 
    <div> 
     <p><span>&nbsp; &nbsp; 所以，BF算法要回溯，其代码如下：</span></p> 
     <div class="dp-highlighter bg_cpp" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;"> 
      <ol style="border:none;color:rgb(92,92,92);">
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="datatypes" style="border:none;"><strong>int</strong></span>&nbsp;Index(SString&nbsp;S,&nbsp;SString&nbsp;T,&nbsp;<strong>int</strong>&nbsp;pos)&nbsp;{&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//返回T在S中第pos个字符之后的位置&nbsp;</span>&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;i=pos;&nbsp;j=1;k=0;&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong>while</strong></span>&nbsp;(&nbsp;i&lt;&nbsp;=&nbsp;S[0]&nbsp;&amp;&amp;&nbsp;j&lt;&nbsp;=&nbsp;T[0]&nbsp;)&nbsp;{&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong>if</strong></span>&nbsp;(S[i+k]&nbsp;=&nbsp;=&nbsp;T[j]&nbsp;)&nbsp;{++k;&nbsp;&nbsp;++j;}&nbsp;&nbsp;&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//继续比较后续字符&nbsp;</span>&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong>else</strong></span>&nbsp;{i=i+1;&nbsp;&nbsp;&nbsp;j=1;&nbsp;k=0;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//指针回溯到&nbsp;下一首位，重新开始&nbsp;</span>&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;}&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong>if</strong></span>(j&gt;T[0])&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong>return</strong></span>&nbsp;i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//子串结束，说明匹配成功&nbsp;</span>&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">&nbsp;&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong>else</strong></span>&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong>return</strong></span>&nbsp;&nbsp;0;&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">}<span class="comment" style="border:none;color:rgb(0,130,0);">//Index</span>&nbsp;&nbsp;</span></li> 
      </ol>
     </div> 
     <div class="dp-highlighter bg_cpp" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;"> 
      <div class="bar"> 
       <div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left:3px solid rgb(108,226,108);"> 
        <strong>[cpp]</strong>&nbsp;
        <a class="ViewSource" title="view plain" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">view plain</a>
        <a class="CopyToClipboard" title="copy" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">copy</a>
        <a class="PrintSource" title="print" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">print</a>
        <a class="About" title="?" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">?</a> 
        <div></div> 
       </div> 
      </div> 
      <ol style="border:none;color:rgb(92,92,92);">
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;Index(SString&nbsp;S,&nbsp;SString&nbsp;T,&nbsp;</span><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;pos)&nbsp;{&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//返回T在S中第pos个字符之后的位置</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">i=pos;&nbsp;j=1;k=0;&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">while</span><span style="border:none;">&nbsp;(&nbsp;i&lt;&nbsp;=&nbsp;S[0]&nbsp;&amp;&amp;&nbsp;j&lt;&nbsp;=&nbsp;T[0]&nbsp;)&nbsp;{&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">&nbsp;(S[i+k]&nbsp;=&nbsp;=&nbsp;T[j]&nbsp;)&nbsp;{++k;&nbsp;&nbsp;++j;}&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);">//继续比较后续字符</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">else</span><span style="border:none;">&nbsp;{i=i+1;&nbsp;&nbsp;&nbsp;j=1;&nbsp;k=0;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);">//指针回溯到&nbsp;下一首位，重新开始</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">}&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">(j&gt;T[0])&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">return</span><span style="border:none;">&nbsp;i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);">//子串结束，说明匹配成功</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">else</span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">return</span><span style="border:none;">&nbsp;&nbsp;0;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">}<span class="comment" style="border:none;color:rgb(0,130,0);">//Index</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
      </ol>
     </div> 
     <p><span>&nbsp;</span></p> 
     <p><span>&nbsp; 不过，也有特殊情况可以不回溯，如下：<br> abcdefghij(<span>主串</span><span>)</span><br> abcdefg(<span>模式串</span><span>)</span><br> &nbsp; 即(<span>模式串</span><span>)</span><span>没有相同的才不需要回溯。</span></span></p> 
     <p><br><span><strong>4<span>、</span><span>KMP&nbsp;</span><span>算法思想</span></strong><br> &nbsp;&nbsp;&nbsp;&nbsp;普通的字符串匹配算法必须要回溯。但回溯就影响了效率，回溯是由T串本身的性质决定的，是因为T串本身有前后'部分匹配'的性质。像上面所说如果主串为abcdef这样的，大没有回溯的必要。</span></p> 
     <p><span>&nbsp;&nbsp;&nbsp;&nbsp;改进的地方也就是这里，我们从<span>T</span><span>串本身出发，事先就找准了</span><span>T</span><span>自身前后部分匹配的位置，那就可以改进算法。</span></span></p> 
     <p><span>&nbsp;&nbsp;&nbsp;&nbsp;如果不用回溯，那模式串下一个位置从哪里开始呢？</span></p> 
     <p><span>&nbsp;&nbsp;&nbsp;&nbsp;还是上面那个例子，<span>T(</span><span>模式串</span><span>)</span><span>为</span><span>ababc</span><span>，如果</span><span>c</span><span>失配，那就可以往前移到</span><span>aba</span><span>最后一个</span><span>a</span><span>的位置，像这样：</span></span></p> 
    </div> 
   </div> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"> 
    <div class="Section0"> 
     <div> 
      <p><span>...ababd...</span></p> 
     </div> 
    </div> 
    <div class="Section0"> 
     <div> 
      <p><span>&nbsp;&nbsp;&nbsp;ababc</span></p> 
     </div> 
    </div> 
    <div class="Section0"> 
     <div> 
      <p><span>&nbsp; &nbsp; -&gt;ababc</span></p> 
     </div> 
    </div> 
   </blockquote> 
   <div class="Section0"> 
    <div> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>这样<span>i</span><span>不用回溯，</span><span>j</span><span>跳到前</span><span>2</span><span>个位置，继续匹配的过程，这就是</span><span>KMP</span><span>算法所在。这个当</span><span>T[j]</span><span>失配后，</span><strong>j&nbsp;<span>应该往前跳的值就是</span><span>j</span><span>的</span><span>next</span><span>值</span>，它是由<span>T</span><span>串本身固有决定的，与</span><span>S</span><span>串</span><span>(</span><span>主串</span><span>)</span><span>无关</span></strong>。</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><br><strong><span>5、next<span>数组的含义</span></span></strong></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>重点来了。下面解释一下next<span>数组的含义</span>，这个也是<span>KMP</span><span>算法中比较不好理解的一点。</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;令原始串为<span>:&nbsp;S[i]</span><span>，其中</span><span>0&lt;=i&lt;=n</span><span>；模式串为</span><span>:&nbsp;T[j]</span><span>，其中</span><span>0&lt;=j&lt;=m</span><span>。</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;假设目前匹配到如下位置</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;S0,S1,S2,...,Si-j,Si-j+1...............,Si-1,&nbsp;Si, Si+1,....,Sn</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T0,T1,...................,Tj-1,&nbsp;Tj, ..........</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;S<span>和</span><span>T</span><span>的绿色部分匹配成功，恰好到</span><span>Si</span><span>和</span><span>Tj</span><span>的时候失配，如果要保持</span><span>i</span><span>不变，同时达到让模式串</span><span>T</span><span>相对于原始串</span><span>S</span><span>右移的话，可以更新</span><span>j</span><span>的值，让</span><span>Si</span><span>和新的</span><span>Tj</span><span>进行匹配，假设新的</span><span>j</span><span>用</span><span>next[j]</span><span>表示，即让</span><span>Si</span><span>和</span><span>next[j]</span><span>匹配，显然新的</span><span>j</span><span>值要小于之前的</span><span>j</span><span>值，模式串才会是右移的效果，也就是说应该有</span><span>next[j]&nbsp;&lt;=&nbsp;j&nbsp;-1</span><span>。那新的</span><span>j</span><span>值也就是</span><span>next[j]</span><span>应该是多少呢？我们观察如下的匹配：</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1)<span>如果</span>模式串右移<span>1</span><span>位（从简单的思考起，移动一位会怎么样）</span>，即<span>next[j]&nbsp;=&nbsp;j&nbsp;-&nbsp;1</span><span>，&nbsp;即让蓝色的</span><span>Si</span><span>和</span><span>Tj-1</span><span>匹配&nbsp;</span><span>(</span><span>注：省略号为未匹配部分</span><span>)</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;S0,S1,S2,...,Si-j,Si-j+1...............,Si-1,&nbsp;Si, Si+1,....,Sn</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T0,T1,...................,Tj-1,&nbsp;Tj, .......... (T的划线部分和S划线部分相等【1】)</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T0,T1,................Tj-2,Tj-1,&nbsp;....... (移动后的T的划线部分和S的划线部分相等【2】)</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;根据【<span>1</span><span>】【</span><span>2</span><span>】可以知道当</span><span>next[j]&nbsp;=j&nbsp;-1</span><span>，即模式串右移一位的时候，有</span><span>T[0&nbsp;~&nbsp;j-2]&nbsp;==&nbsp;T[1&nbsp;~&nbsp;j-1]</span><span>。而这两部分恰好是字符串</span><span>T[0&nbsp;~j-1]</span><span>的前缀和后缀，也就是说</span><span>next[j]</span><span>的值取决于模式串</span><span>T</span><span>中</span><span>j</span><span>前面部分的前缀和后缀相等部分的长度（好好揣摩这两个关键字概念：前缀、后缀，或者再想想，我的上一篇文章，从</span><span>Trie</span><span>树谈到后缀树中，后缀树的概念）。</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2)<span>如果模式串右移</span><span>2</span><span>位，即</span><span>next[j]&nbsp;=&nbsp;j&nbsp;-&nbsp;2</span><span>，&nbsp;即让蓝色的</span><span>Si</span><span>和</span><span>Tj-2</span><span>匹配&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;S0,S1,...,Si-j,Si-j+1,Si-j+2...............,Si-1,&nbsp;Si, Si+1,....,Sn</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T0,T1,T2,...................,Tj-1,&nbsp;Tj, ..........(T的划线部分和S划线部分相等【3】)</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T0,T1,.............,Tj-3,Tj-2,.........(移动后的T的划线部分和S的划线部分相等【4】)</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;同样根据【<span>3</span><span>】【</span><span>4</span><span>】可以知道当</span><span>next[j]&nbsp;=j&nbsp;-2</span><span>，即模式串右移两位的时候，有</span><span>T[0&nbsp;~&nbsp;j-3]&nbsp;==&nbsp;T[2&nbsp;~&nbsp;j-1]</span><span>。而这两部分也恰好是字符串</span><span>T[0&nbsp;~j-1]</span><span>的前缀和后缀，也就是说</span>next[j]<span>的值取决于模式串</span><span>T</span><span>中</span><span>j</span><span>前面部分的前缀和后缀相等部分的长度</span>。</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3)<span>依次类推，可以得到如下结论：</span><strong>当发生失配的情况下，<span>j</span><span>的新值</span><span>next[j]</span><span>取决于模式串中</span><span>T[0&nbsp;~&nbsp;j-1]</span><span>中前缀和后缀相等部分的长度，&nbsp;并且</span><span>next[j]</span><span>恰好等于这个最大长度</span></strong>。</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; 为此，请再允许我引用上文中的一段原文：“<span>KMP</span><span>算法中，如果当前字符匹配成功，即</span><span>S[i]==T[j]</span><span>，令</span><span>i++</span><span>，</span><span>j++</span><span>，继续匹配下一个字符；如果</span><span>匹配失败，即S[i]&nbsp;!=&nbsp;T[j]</span><span>，需要保持</span><span>i</span><span>不变，并且让</span><span>j&nbsp;=&nbsp;next[j]</span><span>，这里</span><span>next[j]&nbsp;&lt;=j&nbsp;-1</span><span>，即模式串</span><span>T</span><span>相对于原始串</span><span>S</span><span>向右移动了至少</span><span>1</span><span>位</span><span>(</span><span><strong>移动的实际位数</strong></span><strong>j&nbsp;-&nbsp;next[j]&nbsp;&nbsp;&gt;=1</strong><span>),</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;同时移动之后，<span style="text-decoration:underline;">i<span>之前的部分（即</span>S[i-j+1 ~&nbsp;i-1]<span>），和</span>j=next[j]<span>之前的部分（即</span>T[0&nbsp;~&nbsp;j-2]</span><span><span style="text-decoration:underline;">）仍然相等</span>。显然，<strong>相对于</strong></span><strong>BF<span>算法来说，</span>KMP</strong><span><strong>移动更多的位数，起到了一个加速的作用</strong>！&nbsp;</span>(<span>失配的特殊情形，令</span>j=next[j]<span>导致</span>j==0<span>的时候，需要将</span>i&nbsp;++，否则此时没有移动模式串)<span>。”</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; 于此，也就不难理解了我的关于KMP算法的第二篇文章之中：“<span>当匹配到S[i] != P[j]的时候有 S[i-j…i-1] = P[0…j-1]. 如果下面用j_next去匹配，则有P[0…j_next-1] = S[i-j_next…i-1] = P[j-j_next…j-1]。此过程如下图3-1所示。</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span><span>&nbsp;&nbsp;当匹配到</span><span>S[i]&nbsp;!=&nbsp;P[j]</span><span>时，<span>S[i-j…i-1] = P[0…j-1]</span>：</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span><span>S:&nbsp;0&nbsp;…&nbsp;</span><span style="text-decoration:underline;">i-j&nbsp;…&nbsp;i-1</span><span>&nbsp;i&nbsp;…</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span><span>P:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="text-decoration:underline;">0&nbsp;…&nbsp;&nbsp; j-1</span><span>&nbsp;j&nbsp;…</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span style="font-size:large;"><span><span><span>&nbsp;&nbsp;如果下面用j_next去匹配，则有P[0…j_next-1] = S[i-j_next…i-1] = P[j-j_next…j-1]。<br> 所以在P中有如下匹配关系（获得这个匹配关系的意义是用来求next数组）</span></span></span><span>：</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span><span>P:&nbsp;0&nbsp;…&nbsp;</span><span style="text-decoration:underline;">j-j_next&nbsp;&nbsp;.…j-1_</span><span>&nbsp;&nbsp;&nbsp;&nbsp;…</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span><span>P:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="text-decoration:underline;">0&nbsp;&nbsp;&nbsp;&nbsp;…&nbsp;.j_next-1</span><span>&nbsp;…</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span><span>&nbsp;&nbsp;所以，</span><span>根据上面两个步骤，推出</span><span>下一匹配位置</span><span>j_next:</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span><span>S:&nbsp;0&nbsp;…&nbsp;i-j&nbsp;…&nbsp;</span><span style="text-decoration:underline;">i-j_next&nbsp;…&nbsp;&nbsp;&nbsp;i-1&nbsp;&nbsp;</span><span>&nbsp;&nbsp;</span><span>&nbsp;&nbsp;</span><span>i&nbsp;…</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span><span>P:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="text-decoration:underline;">0&nbsp;&nbsp;&nbsp;…&nbsp;<strong>j_next-1</strong></span><span>&nbsp;</span><span>&nbsp;</span><span>j_next&nbsp;…</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;图3-1 求j-next（最大的值）的三个步骤</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp; 下面，<strong>我们用变量k来代表求得的j_next的最大值</strong>，即k表示这S[i]、P[j]不匹配时P中下一个用来匹配的位置，使得<span style="text-decoration:underline;">P[0…k-1] = P[j-k…j-1]</span>，而我们要尽量找到这个k的最大值。<span><span>”。</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; &nbsp; 根据上文的【1】与【2】的匹配情况，可得第二篇文章之中所谓的k=1，根据上文的【3】与【4】的匹配情况，k=2。</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; &nbsp;所以，归根究底，KMP算法的本质便是：针对待匹配的模式串的特点，判断它是否有重复的字符，从而找到它的前缀与后缀，进而求出相应的Next数组，最终根据Next数组而进行KMP匹配。</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><strong>6、Next数组的具体求法</strong></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp; 上面给出了<span>next</span><span>数组的含义，下面给出求这个数组的具体算法。</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;1<span>）显然有</span><span>next[0]&nbsp;=&nbsp;0,next[1]&nbsp;=&nbsp;0</span><span>；</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;2<span>）观察【</span><span>1</span><span>】【</span><span>2</span><span>】可以看到如果</span><span>T[j]==T[j&nbsp;-1]</span><span>即</span><span>T[j]&nbsp;==&nbsp;T[next[j]]</span><span>的情况下</span>(<span>一定要注意&nbsp;</span><span>next[j]</span><span>比</span><span>j&nbsp;</span><span>小，有助于理清思路</span><span>)</span>，<span>j+1</span><span>前面字符串的前缀和后缀的相等部分长度增加了</span><span>1</span><span>，所以有</span><span>T[j]==T[next[j]]</span><span>的时候，</span><span>next[j+1]&nbsp;=&nbsp;next[j&nbsp;]&nbsp;+&nbsp;1;</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;同样观察【<span>3</span><span>】【</span><span>4</span><span>】也可以看到如果</span><span>T[j]==T[j-2]</span><span>亦即</span><span>T[j]==T[next[j]</span><span>的情况下，</span><span>j+1</span><span>前面的字符串的前缀和后缀相等部分的长度增加了</span><span>1</span><span>，所以也有</span><span>T[j]==T[next[j]]</span><span>的时候，</span><span>next[j+1]&nbsp;=&nbsp;next[j]&nbsp;+&nbsp;1;</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;综合上面的规律有当<span>T[j]&nbsp;==&nbsp;T[next[j]]</span><span>的情况下</span><span>next[j+1]=next[j]&nbsp;+&nbsp;1;</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>3)&nbsp;<span>当</span><span>T[j]&nbsp;!=&nbsp;T[next[j]]</span><span>的情况</span><span>next[j+1]</span><span>又该等于多少呢？拿【</span><span>1</span><span>】【</span><span>2</span><span>】来说，如果此时</span><span>T[j]&nbsp;!=&nbsp;T[j-1]</span><span>，可以移动【</span><span>2</span><span>】对应的串，直到【</span><span>1</span><span>】中的</span><span>Tj</span><span>等于下面【</span><span>2</span><span>】中对应的字符，此时就找到了</span><span>j+1</span><span>的最大前后缀。</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;注意，移动的时候同样可以用到已经计算出的<span>next</span><span>数组的值</span>。接下来，进入本文的第二部分。</span></p> 
     <h3 style="color:rgb(102,102,102);font-family:verdana;font-size:16px;background:url(&quot;images/title.gif&quot;) no-repeat fixed left top;line-height:1.5;"> <a name="t2"></a>第二部分、<span>next</span><span>数组求法的来龙去脉与</span><span>KMP</span><span>算法的源码</span> </h3> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;本部分引自个人此前的关于<span>KMP</span><span>算法的第二篇文章：六之续、由KMP算法谈到BM算法。前面，我们已经知道<span>即不能让P[j]=P[next[j]]成立成立。不能再出现上面那样的情况啊！</span><span>即不能有这种情况出现：P[3]=b，而竟也有P[next[3]]=P[1]=b</span><span>。</span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span style="font-family:'宋体';"><span><span>&nbsp; &nbsp; 正如在第二篇文章中，所提到的那样：“这里读者理解可能有困难的是因为文中，时而next，时而nextval，把他们的思维搞混乱了。其实next用于表达数组索引，而nextval专用于表达next数组索引下的具体各值，区别细微。至于文中说不允许P<img title="[j]" src="http://www.kuqin.com/upimg/allimg/111205/230252H50-0.gif" alt="[j]" style="border:0px;">=P[next[j] ]出现，是因为已经有P<img title="[3]" src="http://www.kuqin.com/upimg/allimg/111205/2302522I6-2.gif" alt="[3]" style="border:0px;">=b与S<img title="[i]" src="http://www.kuqin.com/upimg/allimg/111205/23025213N-3.gif" alt="[i]" style="border:0px;">匹配败，而P[next<img title="[3]" src="http://www.kuqin.com/upimg/allimg/111205/2302522I6-2.gif" alt="[3]" style="border:0px;">]=P1=b，若再拿P[1]=b去与S<img title="[i]" src="http://www.kuqin.com/upimg/allimg/111205/23025213N-3.gif" alt="[i]" style="border:0px;">匹配则必败。”--<span>六之续、由KMP算法谈到BM算法。</span></span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span><span><span>&nbsp; &nbsp;又恰恰如上文中所述：“<span>模式串</span><span>T</span><span>相对于原始串</span><span>S</span><span>向右移动了至少</span><span>1</span><span>位</span><span>(</span><span><strong>移动的实际位数</strong></span><span>j&nbsp;-&nbsp;next[j]&nbsp;&nbsp;&gt;=1</span><span>)</span><span>”</span><span>。</span></span></span></span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><span>&nbsp; &nbsp; ok，求</span><span>next</span><span>数组的</span><span>get_nextval</span><span>函数正确代码如下：</span></span></p> 
     <div class="dp-highlighter bg_cpp" style="color:rgb(75,75,75);font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;"> 
      <ol style="border:none;color:rgb(92,92,92);">
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;"><span style="border:none;">//代码4-1&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//修正后的求next数组各值的函数代码&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">void</span></strong></span><span style="border:none;">&nbsp;get_nextval(</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">char</span></strong></span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">const</span></strong></span><span style="border:none;">*&nbsp;ptrn,&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">&nbsp;plen,&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">*&nbsp;nextval)&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">{&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">&nbsp;i&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;nextval[i]&nbsp;=&nbsp;-1;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">&nbsp;j&nbsp;=&nbsp;-1;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">while</span></strong></span><span style="border:none;">(&nbsp;i&nbsp;&lt;&nbsp;plen-1&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">if</span></strong></span><span style="border:none;">(&nbsp;j&nbsp;==&nbsp;-1&nbsp;||&nbsp;ptrn[i]&nbsp;==&nbsp;ptrn[j]&nbsp;)&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//循环的if部分&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++i;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++j;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//修正的地方就发生下面这4行&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">if</span></strong></span><span style="border:none;">(&nbsp;ptrn[i]&nbsp;!=&nbsp;ptrn[j]&nbsp;)&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//++i，++j之后，再次判断ptrn[i]与ptrn[j]的关系&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nextval[i]&nbsp;=&nbsp;j;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//之前的错误解法就在于整个判断只有这一句。&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">else</span></strong></span><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nextval[i]&nbsp;=&nbsp;nextval[j];&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">else</span></strong></span><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//循环的else部分&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;=&nbsp;nextval[j];&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">}&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
      </ol>
     </div> 
     <div class="dp-highlighter bg_cpp" style="color:rgb(75,75,75);font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;"> 
      <div class="bar"> 
       <div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left:3px solid rgb(108,226,108);"> 
        <strong>[cpp]</strong>&nbsp;
        <a class="ViewSource" title="view plain" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">view plain</a>
        <a class="CopyToClipboard" title="copy" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">copy</a>
        <a class="PrintSource" title="print" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">print</a>
        <a class="About" title="?" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">?</a> 
        <div></div> 
       </div> 
      </div> 
      <ol style="border:none;color:rgb(92,92,92);">
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//代码4-1</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//修正后的求next数组各值的函数代码</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">void</span><span style="border:none;">&nbsp;get_nextval(</span><span class="datatypes" style="border:none;">char</span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">const</span><span style="border:none;">*&nbsp;ptrn,&nbsp;</span><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;plen,&nbsp;</span><span class="datatypes" style="border:none;">int</span><span style="border:none;">*&nbsp;nextval)&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">{&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;i&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">nextval[i]&nbsp;=&nbsp;-1;&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;j&nbsp;=&nbsp;-1;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">while</span><span style="border:none;">(&nbsp;i&nbsp;&lt;&nbsp;plen-1&nbsp;)&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">{&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">(&nbsp;j&nbsp;==&nbsp;-1&nbsp;||&nbsp;ptrn[i]&nbsp;==&nbsp;ptrn[j]&nbsp;)&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);">//循环的if部分</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">{&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">++i;&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">++j;&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//修正的地方就发生下面这4行</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">(&nbsp;ptrn[i]&nbsp;!=&nbsp;ptrn[j]&nbsp;)&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);">//++i，++j之后，再次判断ptrn[i]与ptrn[j]的关系</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">nextval[i]&nbsp;=&nbsp;j;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" style="border:none;color:rgb(0,130,0);">//之前的错误解法就在于整个判断只有这一句。</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">else</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">nextval[i]&nbsp;=&nbsp;nextval[j];&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">}&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">else</span><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);">//循环的else部分</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">j&nbsp;=&nbsp;nextval[j];&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">}&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">}&nbsp;&nbsp;&nbsp;&nbsp;</span></li> 
      </ol>
     </div> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;</span></p> 
     <blockquote style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;background:none;border:2px solid rgb(239,239,239);"> 
      <p><span>&nbsp;&nbsp;&nbsp; 举个例子，举例说明下上述求next数组的方法。<br> S a b a b a b c<br> P a b a b c<br> S[4] != P[4]<br> &nbsp;&nbsp;&nbsp; 那么下一个和S[4]匹配的位置是k=2(也即P[next[4]])。此处的k=2也再次佐证了上文第3节开头处关于为了找到下一个匹配的位置时k的求法。上面的主串与模式串开头4个字符都是“abab”，所以，匹配失效后下一个匹配的位置直接跳两步继续进行匹配。<br> S a b a b a b c<br> P &nbsp; &nbsp; &nbsp;a b a b c<br> 匹配成功</span></p> 
      <p><span>P的next数组值分别为-1 0 -1 0 2</span></p> 
      <p><span>&nbsp;&nbsp;&nbsp; next数组各值怎么求出来的呢?分以下五步：</span></p> 
      <ol>
       <li style="font-size:12px;list-style-type:decimal;"><span>初始化：i=0，j=-1，<span>由于j == -1，进入上述循环的if部分，++i得i=1，++j得j=0，且ptrn[i] != ptrn[j]（即a！=b）），所以得到第二个next值即nextval[1] = 0；</span>；</span></li> 
       <li style="font-size:12px;list-style-type:decimal;"><span><span>i=1，j=0，进入循环esle部分，</span><span>j=nextval[j]=nextval[0]=-1；</span></span></li> 
       <li style="font-size:12px;list-style-type:decimal;"><span>进入循环的if部分，++i，++j，i=2，j=0，因为ptrn[i]=ptrn[j]=a,所以nextval[2]=nextval[0]=-1；</span></li> 
       <li style="font-size:12px;list-style-type:decimal;"><span>i=2, j=0, 由于ptrn[i]=ptrn[j],再次进入循环if部分，所以++i=3，++j=1,因为ptrn[i]=ptrn[j]=b,所以nextval[3]=nextval[1]=0；</span></li> 
       <li style="font-size:12px;list-style-type:decimal;"><span>i=3,j=1,由于ptrn[i]=ptrn[j]=b,所以++i=4，++j=2,退出循环。&nbsp;</span></li> 
      </ol>
     </blockquote> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp; 这样上例中模式串的next数组各值最终应该为:</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><img src="http://www.kuqin.com/upimg/allimg/111205/23025225G-6.jpg" alt="" width="273" height="104" style="border:0px;"></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp; 图4-1 正确的next数组各值<br></span><span><strong>next数组求解的具体过程如下：<br></strong>&nbsp;&nbsp;&nbsp; 初始化：nextval[0] = -1，我们得到第一个next值即-1.</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><img src="http://www.kuqin.com/upimg/allimg/111205/2302521C6-7.jpg" alt="" width="277" height="84" style="border:0px;"></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp; 图4-2 第一个next值即-1</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp; i = 0，j = -1，由于j == -1，进入上述循环的if部分，++i得i=1，++j得j=0，且ptrn[i] != ptrn[j]（即a！=b）），所以得到第二个next值即nextval[1] = 0；</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><img src="http://www.kuqin.com/upimg/allimg/111205/230252C06-8.jpg" alt="" width="288" height="95" style="border:0px;"></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;图4-3 第二个next值0</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp; 上面我们已经得到，i= 1，j = 0，由于不满足条件j == -1 || ptrn[i] == ptrn[j]，所以进入循环的esle部分，得j = nextval[j] = -1；此时，仍满足循环条件，由于i = 1，j = -1，因为j == -1，再次进入循环的if部分，++i得i=2，++j得j=0，由于ptrn[i] == ptrn[j]（即ptrn[2]=ptrn[0]，也就是说第1个元素和第三个元素都是a），所以进入循环if部分内嵌的else部分，得到nextval[2] = nextval[0] = -1；</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><img src="http://www.kuqin.com/upimg/allimg/111205/2302522K1-9.jpg" alt="" width="266" height="92" style="border:0px;"></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;图4-4 第三个next数组元素值-1</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp; i = 2，j = 0，由于ptrn[i] == ptrn[j]，进入if部分，++i得i=3，++j得j=1，所以ptrn[i] == ptrn[j]（ptrn[3]==ptrn[1]，也就是说第2个元素和第4个元素都是b），所以进入循环if部分内嵌的else部分，得到nextval[3] = nextval[1] = 0；</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><img src="http://www.kuqin.com/upimg/allimg/111205/2302523502-10.jpg" alt="" width="266" height="96" style="border:0px;"></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span><span>图4-5 第四个数组元素值0<br></span>&nbsp;&nbsp;&nbsp; 如果你还是没有弄懂上述过程是怎么一回事，请现在拿出一张纸和一支笔出来，一步一步的画下上述过程。相信我，把图画出来了之后，你一定能明白它的。<br> &nbsp;&nbsp;&nbsp; 然后，我留一个问题给读者，为什么上述的next数组要那么求?有什么原理么?</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp; &nbsp;&nbsp;<span>提示</span>：我们从上述字符串abab 各字符的next值<span style="text-decoration:underline;">-1 0 -1 0</span>，可以看出来，根据求得的next数组值，偷用前缀、后缀的概念，一定可以判断出在abab之中，前缀和后缀相同，即都是ab，反过来，如果一个字符串的前缀和后缀相同，那么根据前缀和后缀依次求得的next各值也是相同的。</span></p> 
     <ul style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:11px;list-style:none;">
      <li style="font-size:12px;list-style-type:disc;"><span><strong>5、利用求得的next数组各值运用Kmp算法</strong></span></li>
     </ul>
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp; Ok，next数组各值已经求得，万事俱备，东风也不欠了。接下来，咱们就要应用求得的next值，应用KMP算法来匹配字符串了。还记得KMP算法是怎么一回事吗?容我再次引用下之前的KMP算法的代码，如下：</span></p> 
     <div class="dp-highlighter bg_cpp" style="color:rgb(75,75,75);font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;"> 
      <ol style="border:none;color:rgb(92,92,92);">
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;"><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//代码5-1&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//int&nbsp;kmp_seach(char&nbsp;const*,&nbsp;int,&nbsp;char&nbsp;const*,&nbsp;int,&nbsp;int&nbsp;const*,&nbsp;int&nbsp;pos)&nbsp;&nbsp;KMP模式匹配函数&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//输入：src,&nbsp;slen主串&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//输入：patn,&nbsp;plen模式串&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//输入：nextval&nbsp;KMP算法中的next函数值数组&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">&nbsp;kmp_search(</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">char</span></strong></span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">const</span></strong></span><span style="border:none;">*&nbsp;src,&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">&nbsp;slen,&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">char</span></strong></span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">const</span></strong></span><span style="border:none;">*&nbsp;patn,&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">&nbsp;plen,&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">const</span></strong></span><span style="border:none;">*&nbsp;nextval,&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">&nbsp;pos)&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">{&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">&nbsp;i&nbsp;=&nbsp;pos;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="datatypes" style="border:none;"><strong><span style="border:none;">int</span></strong></span><span style="border:none;">&nbsp;j&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">while</span></strong></span><span style="border:none;">&nbsp;(&nbsp;i&nbsp;&lt;&nbsp;slen&nbsp;&amp;&amp;&nbsp;j&nbsp;&lt;&nbsp;plen&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">if</span></strong></span><span style="border:none;">(&nbsp;j&nbsp;==&nbsp;-1&nbsp;||&nbsp;src[i]&nbsp;==&nbsp;patn[j]&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++i;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++j;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">else</span></strong></span><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;=&nbsp;nextval[j];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//当匹配失败的时候直接用p[j_next]与s[i]比较，&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment" style="border:none;color:rgb(0,130,0);"><span style="border:none;color:rgb(0,0,0);">//下面阐述怎么求这个值，即匹配失效后下一次匹配的位置&nbsp;&nbsp;&nbsp;</span></span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">if</span></strong></span><span style="border:none;">(&nbsp;j&nbsp;&gt;=&nbsp;plen&nbsp;)&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">return</span></strong></span><span style="border:none;">&nbsp;i-plen;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">else</span></strong></span><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;"><strong><span style="border:none;color:rgb(0,0,0);">return</span></strong></span><span style="border:none;">&nbsp;-1;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span style="border:none;">}&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li> 
      </ol>
     </div> 
     <div class="dp-highlighter bg_cpp" style="color:rgb(75,75,75);font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;"> 
      <div class="bar"> 
       <div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left:3px solid rgb(108,226,108);"> 
        <strong>[cpp]</strong>&nbsp;
        <a class="ViewSource" title="view plain" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">view plain</a>
        <a class="CopyToClipboard" title="copy" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">copy</a>
        <a class="PrintSource" title="print" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">print</a>
        <a class="About" title="?" href="http://blog.csdn.net/yuanzhangmei1/article/details/8502235" rel="nofollow" style="background-image:none;border:none;color:rgb(160,160,160);font-size:9px;text-decoration:none;">?</a> 
        <div></div> 
       </div> 
      </div> 
      <ol style="border:none;color:rgb(92,92,92);">
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//代码5-1</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//int&nbsp;kmp_seach(char&nbsp;const*,&nbsp;int,&nbsp;char&nbsp;const*,&nbsp;int,&nbsp;int&nbsp;const*,&nbsp;int&nbsp;pos)&nbsp;&nbsp;KMP模式匹配函数</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//输入：src,&nbsp;slen主串</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//输入：patn,&nbsp;plen模式串</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//输入：nextval&nbsp;KMP算法中的next函数值数组</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;kmp_search(</span><span class="datatypes" style="border:none;">char</span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">const</span><span style="border:none;">*&nbsp;src,&nbsp;</span><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;slen,&nbsp;</span><span class="datatypes" style="border:none;">char</span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">const</span><span style="border:none;">*&nbsp;patn,&nbsp;</span><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;plen,&nbsp;</span><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">const</span><span style="border:none;">*&nbsp;nextval,&nbsp;</span><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;pos)&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">{&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;i&nbsp;=&nbsp;pos;&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="datatypes" style="border:none;">int</span><span style="border:none;">&nbsp;j&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">while</span><span style="border:none;">&nbsp;(&nbsp;i&nbsp;&lt;&nbsp;slen&nbsp;&amp;&amp;&nbsp;j&nbsp;&lt;&nbsp;plen&nbsp;)&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">{&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">(&nbsp;j&nbsp;==&nbsp;-1&nbsp;||&nbsp;src[i]&nbsp;==&nbsp;patn[j]&nbsp;)&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">{&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">++i;&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">++j;&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">}&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">else</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">{&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">j&nbsp;=&nbsp;nextval[j];&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//当匹配失败的时候直接用p[j_next]与s[i]比较，</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="comment" style="border:none;color:rgb(0,130,0);">//下面阐述怎么求这个值，即匹配失效后下一次匹配的位置</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">}&nbsp;&nbsp;</span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">}&nbsp;&nbsp;</span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">if</span><span style="border:none;">(&nbsp;j&nbsp;&gt;=&nbsp;plen&nbsp;)&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">return</span><span style="border:none;">&nbsp;i-plen;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">else</span><span style="border:none;">&nbsp;&nbsp;</span></span></li> 
       <li class="alt" style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;color:inherit;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">return</span><span style="border:none;">&nbsp;-1;&nbsp;&nbsp;</span></span></li> 
       <li style="border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(108,226,108);list-style-type:decimal;line-height:1.6;list-style-position:outside;"><span style="border:none;color:rgb(0,0,0);">}&nbsp;&nbsp;&nbsp;&nbsp;</span></li> 
      </ol>
     </div> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>我们上面已经求得的next值，如下：</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><img src="http://www.kuqin.com/upimg/allimg/111205/2302523502-10.jpg" alt="" width="266" height="96" style="border:0px;"></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>图5-1 求得的正确的next数组元素各值</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp; 以下是匹配过程，分三步：<br> &nbsp;&nbsp;&nbsp; 第一步：主串和模式串如下，S[3]与P[3]匹配失败。</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><img src="http://www.kuqin.com/upimg/allimg/111205/2302524428-12.jpg" alt="" width="417" height="159" style="border:0px;"></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span><span>图5-2 第一步，S[3]与P[3]匹配失败<br></span>&nbsp;&nbsp;&nbsp; 第二步：S[3]保持不变，P的下一个匹配位置是P[next[3]]，而next[3]=0,所以P[next[3]]=P[0]，即P[0]与S[3]匹配。在P[0]与S[3]处匹配失败。</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><img src="http://www.kuqin.com/upimg/allimg/111205/2302524531-13.jpg" alt="" width="495" height="176" style="border:0px;"></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>图5-3 第二步，在P[0]与S[3]处匹配失败</span></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp; 第三步：与上文中第3小节末的情况一致。由于上述第三步中，P[0]与S[3]还是不匹配。此时i=3,j=nextval[0]=-1,由于满足条件j==-1，所以进入循环的if部分,++i=4,++j=0,即主串指针下移一个位置，从P[0]与S[4]处开始匹配。最后j==plen，跳出循环，输出结果i-plen=4(即字串第一次出现的位置），匹配成功，算法结束。</span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span><img src="http://www.kuqin.com/upimg/allimg/111205/2302524335-14.jpg" alt="" width="451" height="167" style="border:0px;"></span></p> 
     <p style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span><span>图5-4 第三步，匹配成功，算法结束<br></span>&nbsp;&nbsp;&nbsp;&nbsp;<span>所以，综上，总结上述三步为</span>：&nbsp;</span></p> 
     <ol style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">
      <li style="font-size:12px;list-style-type:decimal;"><span>开始匹配，直到P[3]！=S[3]，匹配失败；</span></li> 
      <li style="font-size:12px;list-style-type:decimal;"><span>nextval[3]=0，所以P[0]继续与S[3]匹配，再次匹配失败；</span></li> 
      <li style="font-size:12px;list-style-type:decimal;"><span>nextval[0]=-1，满足循环if部分条件j==-1，所以，++i，++j，主串指针下移一个位置，从P[0]与S[4]处开始匹配，最后j==plen，跳出循环，输出结果i-plen=4，算法结束。</span></li> 
     </ol>
     <h3 style="color:rgb(102,102,102);font-family:verdana;font-size:16px;background:url(&quot;images/title.gif&quot;) no-repeat fixed left top;line-height:1.5;"> <a name="t3"></a>相关链接</h3> 
     <div style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"> 
      <ol>
       <li style="font-size:12px;list-style-type:decimal;"> <a href="http://blog.csdn.net/v_JULY_v/archive/2011/06/15/6545192.aspx" rel="nofollow" style="color:rgb(52,104,164);"><span>六（续）、从KMP算法一步一步谈到BM算法</span></a><span>。<br> &nbsp;</span> </li>
      </ol>
     </div> 
     <h3 style="color:rgb(102,102,102);font-family:verdana;font-size:16px;background:url(&quot;images/title.gif&quot;) no-repeat fixed left top;line-height:1.5;"> <a name="t4"></a>后记 &nbsp;</h3> 
     <div style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">
      <span>&nbsp; &nbsp; &nbsp;OK， 相信，看过此文后，无论是谁，都一定可以把KMP算法搞懂了（但万一还是有读者没有搞懂，那怎么办呢？还有最后一个办法：把<span>本文打印下来，再仔细琢磨</span>。如果是真真正正想彻底弄懂某一个东西，那么必须付出些代价。但万一要是打印下来了却还是没有弄懂呢？那来北京找我吧，我手把手教你。祝好运）。谢谢，完。</span>
     </div> 
     <div style="color:rgb(75,75,75);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">
      <span>&nbsp; &nbsp; July、二零一一年十二月五日中午。</span>
     </div> 
     <div>
      <span><font color="#4b4b4b"><span style="font-size:13px;">本文转自博客园知识天地的博客，原文链接：<a href="http://www.cnblogs.com/mfryf/archive/2013/05/15/3080838.html" rel="nofollow">六之再续：KMP算法之总结篇（必懂KMP）</a>，如需转载请自行联系原博主。</span></font><br></span>
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
