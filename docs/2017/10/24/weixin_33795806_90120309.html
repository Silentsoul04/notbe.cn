<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>我的第一个 Mono for Android 应用 « NotBeCN</title>
  <meta name="description" content="                  我的第一个 Mono for Android 应用     Mono for Android 初体验， 学习怎么使用 Mono for Anrdoid 创建 android 应用， 如何使用 Intent 启动 Activity ， 如何在 Activity 之间传递参数。  ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/24/weixin_33795806_90120309.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">我的第一个 Mono for Android 应用</h1>
    <p class="post-meta">Oct 24, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body" style="color:rgb(17,17,17);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;line-height:23.4px;"> 
    <h2 style="color:rgb(0,0,0);font-size:21px;line-height:1.5;">我的第一个 Mono for Android 应用</h2> 
    <p>Mono for Android 初体验， 学习怎么使用 Mono for Anrdoid 创建 android 应用， 如何使用 Intent 启动 Activity ， 如何在 Activity 之间传递参数。</p> 
    <h3 style="color:rgb(0,0,0);font-size:16px;line-height:1.5;">准备开发环境</h3> 
    <h4 style="color:rgb(0,0,0);font-size:14px;">下载并安装 Mono for Android</h4> 
    <p>在 OSX 系统下准备 Mono for Android 开发环境时比较容易的， 只要去&nbsp;<a href="http://xamarin.com/monoforandroid" rel="nofollow" style="color:rgb(0,102,204);">Xamarin</a>&nbsp;下载一个在线安装程序， 安装程序会自动下载并安装所有的文件， 甚至包括 JDK、 Android SDK 等， 没什么好说的， 一句话， 很简单。</p> 
    <h4 style="color:rgb(0,0,0);font-size:14px;">配置 Android 模拟器</h4> 
    <p>启动 MonoDevelop ， 在 Tools 菜单下找到点击 “Open AVD Manager” ， 将会启动 “Android Virtual Device Manager”， 创建一个新的 Android 虚拟设备， Name 为 Droid4.1， Target 选择 4.1， SD 卡选择 256， Skin 选择内置的 WXGA720 ， 等等， 一切可以参考 Google 的文档。</p> 
    <p>需要注意的是， 要添加一个硬件选项 GPU emulation ， 并设置为 true ， 开启 GPU 模拟， 可以加快模拟器运行速度， 否则模拟器运行真的会很慢。</p> 
    <p>创建好了之后， 先运行一下模拟器， 确认一切配置正常了， 整个开发环境就算准备好了。</p> 
    <h3 style="color:rgb(0,0,0);font-size:16px;line-height:1.5;">创建 Mono for Android 应用</h3> 
    <p>打开 MonoDevelop ， 选择新建解决方案， 左边的分类选择 "Mono for Android" ， 右边选择 "Mono for Android Application" ， 使用默认的模板新建一个 Mono for Android 应用程序， 如下图所示， 项目名称为 “MyFirstApp” 。</p> 
    <p><img src="http://beginor.github.com/assets/post-images/create-new-mono-for-android-app.png" alt="Create first Mono for Android Application" style="border:0px;"></p> 
    <h4 style="color:rgb(0,0,0);font-size:14px;">熟悉默认项目模板</h4> 
    <p>现在， 先不要做其它的， 先来熟悉一下这个项目， 打开项目属性对话框， 看看每个节点都有什么设置项， 重点熟悉下面几个节点：</p> 
    <ul>
     <li style="list-style:disc inside;">Build/General ， 选择 Target Framework ，设置编译应用使用的 Android SDK 版本；</li> 
     <li style="list-style:disc inside;">Build/Mono for Android Build ， 设置如 Linker 、 部署方式、 以及高级标签下的的 CPU架构、 国际化等；</li> 
     <li style="list-style:disc inside;">Build/Mono for Android Application ， 设置应用程序信息， 也就是 AndroidManifest.xml 文件的信息；</li> 
    </ul>
    <p>项目默认的目录结构如下如所示：</p> 
    <p><img src="http://beginor.github.com/assets/post-images/mono-for-android-project-structor.png" alt="项目默认的目录结构" style="border:0px;"></p> 
    <p>注意 Assets 和 Resource 目录：</p> 
    <p><strong>Assets</strong>&nbsp;目录， 如果应用需要用到二进制资源文件， 比如特殊字体、声音等， 放在这个目录下， 并将 BuildAction 设置为 AndrioidAsset ， 资源将会和应用程序一起部署， 在运行时可以通过 AssetManager 使用类似下面的代码进行访问：</p> 
    <pre><code>public class ReadAsset : Activity
{
    protected override void OnCreate (Bundle bundle)
    {
        base.OnCreate (bundle);
        InputStream input = Assets.Open ("my_asset.txt");
    }
}
</code></pre> 
    <p>另外，字体文件可以这样加载：</p> 
    <pre><code>Typeface tf = Typeface.CreateFromAsset(
    Context.Assets, "fonts/samplefont.ttf");
</code></pre> 
    <p><strong>Resource</strong>&nbsp;目录, 包含应用程序所需的图片、 布局描述、 二进制文件和字符串字典等资源文件。 比如， 一个简单的 Android 应用包含一个界面描述文件 (main.axml) ， 一个国际化的字符串字典 (strings.xml) 以及图标 (icon.png) ， 这些文件按照下面的结构保存在 “Resource” 目录内：</p> 
    <pre><code>Resources/
   drawable/
      icon.png
   layout/
      main.axml
   values/
      strings.xml
</code></pre> 
    <p>为了让编译系统能够将资源文件识别出 Android 资源， 需要将其编译动作 (Build Action) 设置为 “Android Resource”。 上面的目录结构经过编译之后， 将会生成类似下面的文件：</p> 
    <pre><code>public class Resource {

    public class Drawable {
        public const int icon = 0x123;
    }

    public class Layout {
        public const int main = 0x456;
    }

    public class Strings {
        public const int FirstString = 0xabc;
        public const int SecondString = 0xbcd;
    }
}
</code></pre> 
    <p>使用&nbsp;<code>Resource.Drawable.icon</code>&nbsp;可以引用 drawable/icon 文件，&nbsp;<code>Resource.Layout.main</code>&nbsp;可以引用 /layout/main.axml 文件， 而使用<code>Resource.Strings.FirstString</code>&nbsp;则可以引用 values/strings.xml 文件中的第一个字符串。</p> 
    <p>以上这些和 Android SDK 文档中介绍的都是大同小异的， 在 Mono for Android 环境下又加上了一些 .Net 特有的风格而已， 对于有经验的 .Net 开发人员来说， 一看就懂了。</p> 
    <h4 style="color:rgb(0,0,0);font-size:14px;">创建 Activity 及 View</h4> 
    <p>与其它平台的应用程序不同， 这些平台上的应用程序通常都有一个单一的入口 main 函数， 应用程序都由这个入口函数启动， 创建窗口、 维护界面。 而 Android 程序则不同， 一个 Android 程序由一些松散的 Activity 提供的界面组成， 因此看起来有点儿像 Web 应用程序， 任何一个 Activity 都可以通过 URL 启动。</p> 
    <p>现在来新建一个 Activity ， 在菜单栏上选择 File -&gt; New -&gt; File ， 在弹出的新建文件对话框中选择 Android Activity ， 如下图所示：</p> 
    <p><img src="http://beginor.github.com/assets/post-images/create-new-activity.png" alt="Create new Activity" style="border:0px;"></p> 
    <p>新建的 Activity 的代码如下：</p> 
    <pre><code>[Activity(Label = "MyFirstApp", MainLauncher = true)]
public class MainActivity : Activity {

    protected override void OnCreate(Bundle bundle) {
        base.OnCreate(bundle);
    }

}
</code></pre> 
    <p>注意 MainActivity 的 ActivityAttribute 标记， 这里指定了两个属性，&nbsp;<code>Label="MyFirstApp"</code>&nbsp;表示 Activity 的显示名称，&nbsp;<code>MainLauncher=true</code>&nbsp;表示在应用程序列表中显示， 在编译时， Mono for Android 会根据这些标记生成一个 AndroidManifest.xml ， 并打包倒最终的 Android 应用程序中。</p> 
    <p>现在来创建 MainActivity 的视图， 先选中项目的 Resources/layout 目录， 在菜单栏上选择 File -&gt; New -&gt; File ， 在弹出的新建文件对话框中选择 Android Layout ， 如下图所示：</p> 
    <p><img src="http://beginor.github.com/assets/post-images/create-android-layout.png" alt="Create Android Layout" style="border:0px;"></p> 
    <p>文件名输入 MainActivityLayout ， MonoDevelop 默认会打开设计视图， 先切换到代码视图， 粘贴下面的代码：</p> 
    <pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="match_parent"
    android:layout_height="match_parent"&gt;
    &lt;EditText
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:id="@+id/MessageEditText"
        android:layout_weight="1"
        android:hint="@string/MessageEditTextHint" /&gt;
    &lt;Button
        android:text="@string/SendButtonText"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:id="@+id/SendButton" /&gt;
&lt;/LinearLayout&gt;
</code></pre> 
    <p>然后切换到设计视图， 看起来如下图所示：</p> 
    <p><img src="http://beginor.github.com/assets/post-images/first-layout-screen.png" alt="Main Activity" style="border:0px;"></p> 
    <p>在 MainActivity.cs 文件中的 base.OnCreate(bundle) 下面加入下面一句代码， 让 MainActivity 使用 MainActivityLayout ：</p> 
    <pre><code>this.SetContentView(Resource.Layout.MainActivityLayout);
</code></pre> 
    <p>用同样的方法， 创建 SecondActivity 以及 SecondActivityLayout ， SecondActivityLayout 的代码以及设计界面如下：</p> 
    <pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"&gt;
    &lt;TextView
        android:text="Large Text"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:id="@+id/MessageTextView" /&gt;
&lt;/LinearLayout&gt;
</code></pre> 
    <p><img src="http://beginor.github.com/assets/post-images/second-activity-screen.png" alt="Second Activity Layout" style="border:0px;"></p> 
    <h4 style="color:rgb(0,0,0);font-size:14px;">使用 Intent 启动 Activity 并传递参数</h4> 
    <p>如果现在运行程序， 将只能看到 MainActivity ， 看不到 SecondActivity ， 如果要想启动 SecondActivity ， 就需要用到 Intent 。 Android 通过 Intent 来启动 Activity ， 以及在 Activity 之间传递参数。</p> 
    <p>打开 MainActivity ， 添加一些代码， 使其看起来如下所示：</p> 
    <pre><code>[Activity(Label = "MyFirstApp", MainLauncher = true)]
public class MainActivity : Activity {

    public const string ExtraMessage = "Cn.Beginor.MyFirstApp.MainActivity.ExtraMessage";

    protected override void OnCreate(Bundle bundle) {
        base.OnCreate(bundle);
        // 设置布局文件
        this.SetContentView(Resource.Layout.MainActivityLayout);
        var sendBtn = this.FindViewById&lt;Button&gt;(Resource.Id.SendButton);
        // 为发送按钮添加事件处理函数
        sendBtn.Click += SendButtonClick;
    }

    void SendButtonClick (object sender, EventArgs e) {
        // 获取用户输入的信息
        var msgEditText = this.FindViewById&lt;EditText&gt;(Resource.Id.MessageEditText);
        if (msgEditText == null) {
            return;
        }
        var msg = msgEditText.Text;
        // 创建 Intent 并传递用户输入的信息
        var intent = new Intent(this, typeof(SecondActivity));
        intent.PutExtra(ExtraMessage, msg);
        // 启动第二个 Activity
        this.StartActivity(intent);
    }
}
</code></pre> 
    <p>再打开 SecondActivity ， 添加接收 ExtraMessage 并显示的代码：</p> 
    <pre><code>protected override void OnCreate(Bundle bundle) {
    base.OnCreate(bundle);
    // 设置布局文件
    this.SetContentView(Resource.Layout.SecondActivityLayout);
    // 从 Intent 中获取 ExtraMessage 
    var intent = this.Intent;
    var msg = intent.GetStringExtra(MainActivity.ExtraMessage);
    // 将 ExtraMessage 显示在 TextView 上
    var textView = this.FindViewById&lt;TextView&gt;(Resource.Id.MessageTextView);
    textView.Text = msg;
}
</code></pre> 
    <p>现在运行这个程序， 可以看到首先启动的是 MainActivity ， 显示界面如下：</p> 
    <p><img src="http://beginor.github.com/assets/post-images/first-activity-runtime-screen.png" alt="MainActivity" style="border:0px;"></p> 
    <p>点击 Send 按钮， 会启动 SecondActivity ， 并将输入的信息显示在界面上：</p> 
    <p><img src="http://beginor.github.com/assets/post-images/second-activity-runtime-screen.png" alt="SecondActivity" style="border:0px;"></p> 
    <h3 style="color:rgb(0,0,0);font-size:16px;line-height:1.5;">总结</h3> 
    <p>Mono for Android 初体验感觉不错， 对于有经验的 .Net 开发人员来讲， 上手的速度非常快， 只要稍微学习一下 Android 的 UI 方面的知识就可以了。 MonoDevelop 的界面和 VS 很相似， 上手也是很容易的事情。 还是那句话， Mono for Android 最大的好处是可以利用现有的 .Net 代码， CodePlex 以及 Github 上有丰富的资源可以利用， 如果你熟悉 .Net 开发， Mono for Android 也是值得一试的。</p> 
   </div> 
   <div style="color:rgb(17,17,17);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;line-height:23.4px;"> 
    <p><a href="http://beginor.github.com/" rel="nofollow" style="color:rgb(0,102,204);">张志敏</a>所有文章遵循<a href="http://creativecommons.org/licenses/by-nc/3.0/deed.zh" rel="nofollow" style="color:rgb(0,102,204);">创作共用版权协议</a>，要求<b>署名、非商业 、保持一致</b>。在满足<a href="http://creativecommons.org/licenses/by-nc/3.0/deed.zh" rel="nofollow" style="color:rgb(0,102,204);">创作共用版权协议</a>的基础上可以转载，但请以超链接形式注明出处。</p> 
    <p><b>本博客已经迁移到 GitHub ， 围观地址：&nbsp;<a href="http://beginor.github.io/" rel="nofollow" style="color:rgb(0,102,204);">http://beginor.github.io/</a></b></p> 
   </div> 
   <div class="clear" style="clear:both;color:rgb(17,17,17);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;line-height:23.4px;"></div> 
   <div> 
    <p style="color:rgb(17,17,17);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;line-height:23.4px;"><br></p> 
    <p><font color="#111111"><span style="font-size:13px;line-height:23.4px;">本文转自张志敏博客园博客，原文链接：http://www.cnblogs.com/beginor/archive/2012/11/02/2751125.html</span></font><span style="font-size:13px;line-height:23.4px;color:rgb(17,17,17);font-family:Verdana, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span></p> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
