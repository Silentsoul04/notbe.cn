<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>C++ 使用API写Windows程序 « NotBeCN</title>
  <meta name="description" content="                 使用API写Windows程序            一 先来看个简单实例:             #include&nbsp;"windows.h"&nbsp;           int&nbsp;WINAPI&nbsp;WinMain&nbsp;(HINSTANCE&nb...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/11/weixin_33912445_90125353.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">C++ 使用API写Windows程序</h1>
    <p class="post-meta">Oct 11, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="postText" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
    使用API写Windows程序
   </div> 
   <div class="postText"> 
    <font><span style="font-size:12px;">一 先来看个简单实例:</span></font>
    <br>
    <div style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
     #include&nbsp;"windows.h"&nbsp;
     <br>
     <br> int&nbsp;WINAPI&nbsp;WinMain&nbsp;(HINSTANCE&nbsp;hInstance,&nbsp;HINSTANCE&nbsp;hPrevInstance,&nbsp;PSTR&nbsp;szCmdLine,&nbsp;int&nbsp;iCmdShow)&nbsp;
     <br>
     <br> {&nbsp;
     <br>
     <br> MessageBox&nbsp;(NULL,&nbsp;TEXT&nbsp;("你好，欢迎来到VC之路"),&nbsp;TEXT&nbsp;("欢迎"),&nbsp;0)&nbsp;;&nbsp;
     <br>
     <br> return&nbsp;0&nbsp;;&nbsp;
     <br>
     <br> }&nbsp;
     <br>
     <br>
    </div> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="font-size:x-small;"><span style="font-family:'宋体';"><span style="color:rgb(204,51,0);">第一个参数：</span><span style="color:rgb(51,0,102);">应用程序的当前实例句柄。</span></span></span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="font-size:x-small;"><span style="font-family:'宋体';"><span style="color:rgb(204,51,0);">第二个参数：</span><span style="color:rgb(51,0,102);">应用程序的前一个实例句柄，别管它，对于Win32位而言，它一般是NULL.</span></span></span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="font-size:x-small;"><span style="font-family:'宋体';"><span style="color:rgb(204,51,0);">第三个参数：</span><span style="color:rgb(51,0,102);">指向任何传给程序的命令行参数。PSTR代表"指向字符串的指针"。</span></span></span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="font-size:x-small;"><span style="font-family:'宋体';"><span style="color:rgb(204,51,0);">第四个参数：</span><span style="color:rgb(51,0,102);">它告诉应用程序如何初始化窗口，如最大化，最小化等状态。</span></span></span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="font-family:'宋体';color:rgb(51,0,102);font-size:x-small;">WinMain()所起的作用：初始化，展示，销毁应用程序等。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="font-family:'宋体';color:rgb(51,0,102);font-size:x-small;">MessageBox()，如果大家在windows下编程，这是一个很常用的API，不用我费话了吧！<br><br> 二 消息机制<br><br></span></p> 
    <div style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">
     #include&nbsp;"stdafx.h"&nbsp;//注意，这个向导产生的头文件不能去掉&nbsp;
     <br>
     <br> #include&nbsp;&lt;windows.h&gt;
     <br>
     <br>
     <br> LRESULT&nbsp;CALLBACK&nbsp;WndProc&nbsp;(HWND,&nbsp;UINT,&nbsp;WPARAM,&nbsp;LPARAM)&nbsp;;
     <br>
     <br> &nbsp;
     <br>
     <br> int&nbsp;WINAPI&nbsp;WinMain&nbsp;(HINSTANCE&nbsp;hInstance,&nbsp;HINSTANCE&nbsp;hPrevInstance,
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PSTR&nbsp;szCmdLine,&nbsp;int&nbsp;iCmdShow)
     <br>
     <br> {
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;TCHAR&nbsp;szAppName[]&nbsp;=&nbsp;TEXT&nbsp;("HelloWin")&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HWND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hwnd&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WNDCLASS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc&nbsp;;
     <br>
     <br> &nbsp;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc.style&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;CS_HREDRAW&nbsp;|&nbsp;CS_VREDRAW&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc.lpfnWndProc&nbsp;&nbsp;&nbsp;=&nbsp;WndProc&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc.cbClsExtra&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc.cbWndExtra&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc.hInstance&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;hInstance&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc.hIcon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LoadIcon&nbsp;(NULL,&nbsp;IDI_APPLICATION)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc.hCursor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LoadCursor&nbsp;(NULL,&nbsp;IDC_ARROW)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc.hbrBackground&nbsp;=&nbsp;(HBRUSH)&nbsp;GetStockObject&nbsp;(WHITE_BRUSH)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc.lpszMenuName&nbsp;&nbsp;=&nbsp;NULL&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wc.lpszClassName&nbsp;=&nbsp;szAppName&nbsp;;
     <br>
     <br> &nbsp;
     <br>
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!RegisterClass&nbsp;(&amp;wc))
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox&nbsp;(NULL,&nbsp;TEXT&nbsp;("This&nbsp;program&nbsp;requires&nbsp;Windows&nbsp;NT!"),&nbsp;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;szAppName,&nbsp;MB_ICONERROR)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hwnd&nbsp;=&nbsp;CreateWindow&nbsp;(szAppName,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;window&nbsp;class&nbsp;name
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;("欢迎你的到来!"),&nbsp;//&nbsp;window&nbsp;caption
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WS_OVERLAPPEDWINDOW,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;window&nbsp;style
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CW_USEDEFAULT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;initial&nbsp;x&nbsp;position
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CW_USEDEFAULT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;initial&nbsp;y&nbsp;position
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CW_USEDEFAULT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;initial&nbsp;x&nbsp;size
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CW_USEDEFAULT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;initial&nbsp;y&nbsp;size
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parent&nbsp;window&nbsp;handle
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;window&nbsp;menu&nbsp;handle
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hInstance,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;program&nbsp;instance&nbsp;handle
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL)&nbsp;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;creation&nbsp;parameters
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ShowWindow&nbsp;(hwnd,&nbsp;iCmdShow)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UpdateWindow&nbsp;(hwnd)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(GetMessage&nbsp;(&amp;msg,&nbsp;NULL,&nbsp;0,&nbsp;0))
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TranslateMessage&nbsp;(&amp;msg)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DispatchMessage&nbsp;(&amp;msg)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;msg.wParam&nbsp;;
     <br>
     <br> }
     <br>
     <br> &nbsp;
     <br>
     <br> &nbsp;
     <br>
     <br> LRESULT&nbsp;CALLBACK&nbsp;WndProc&nbsp;(HWND&nbsp;hwnd,&nbsp;UINT&nbsp;message,&nbsp;WPARAM&nbsp;wParam,&nbsp;LPARAM&nbsp;lParam)
     <br>
     <br> {
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HDC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdc&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PAINTSTRUCT&nbsp;ps&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rect&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(message)
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;WM_PAINT:
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdc&nbsp;=&nbsp;BeginPaint&nbsp;(hwnd,&nbsp;&amp;ps)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetClientRect&nbsp;(hwnd,&nbsp;&amp;rect)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DrawText&nbsp;(hdc,&nbsp;TEXT&nbsp;("你好,欢迎你来到VC之路!"),&nbsp;-1,&nbsp;&amp;rect,
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DT_SINGLELINE&nbsp;|&nbsp;DT_CENTER&nbsp;|&nbsp;DT_VCENTER)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EndPaint&nbsp;(hwnd,&nbsp;&amp;ps)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;WM_DESTROY:
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PostQuitMessage&nbsp;(0)&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0&nbsp;;
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
     <br>
     <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;DefWindowProc&nbsp;(hwnd,&nbsp;message,&nbsp;wParam,&nbsp;lParam)&nbsp;;
     <br>
     <br> }
     <br>
     <br>
    </div> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>Windows编程的特点:</strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">C语言编程至少有一个主程序，其名字是main()。Windows程序则至少两个主程序，一个是WinMain(),</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">int WINAPI WinMain(</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">　　　　　　　　　　HINSTANCE hInstance, 　　<span style="color:rgb(204,51,0);">// handle to current instance</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">　　　　　　　　　　HINSTANCE hPrevInstance, 　<span style="color:rgb(204,51,0);">// handle to previous instance</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">　　　　　　　　　　LPSTR lpCmdLine, 　　　　<span style="color:rgb(204,51,0);">// command line</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">　　　　　　　　　　int nCmdShow 　　　　<span style="color:rgb(204,51,0);">// show state</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">　　　　　　　　　);</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">另一个是窗口过程函数WndProc,它的函数原型为:</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">long FAR PASCAL WndProc(HWND hWnd,WORD message,WORD wParam,LONG lParam);</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">Windows应用程序的编程就围绕这两个部份进行的。其中WinMain函数为应用程序的入口点，它的名字一定要是WinMain。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">在Windows中，应用程序通过要求Windows完成指定操作，而承担这项通信任务的API函数就是Windows的相应窗口函数WndProc。在dos里，程序能直接控制事件的发生顺<br><br> 序，结果等。而在Windows里，应用程序不直接调用任何窗口函数，而是等待Windows调用窗口函数，请求完成任务或返回信息。为保证Windows调用这个窗口函数，这个函<br><br> 数必须先向Windows登记，然后在Windows实施相应操作时回调，所以窗口函数又称为<strong><span style="color:rgb(204,51,0);">回调函数</span></strong>。WndProc是一个主回调函数，Windows至少有一个回调函数。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">回调函数WndProc在哪里定义的呢，请看这个语句:<span style="color:rgb(204,51,0);">wc.lpfnWndProc = WndProc .<br><br></span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">我把这个程序支解为四块:<br></span><strong><span style="font-size:medium;">(一)建立,注册窗口类.<br> (二)创建窗口.<br> (三)显示和更新窗口.<br> (四)创建消息循环.<br> (五)终止应用程序.<br> (六)窗口过程.<br> (七)处理消息.<br><br></span><br></strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>(一)注册窗口类:</strong></p> 
    <p align="center" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>(1)建立窗口类</strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">WinMain()是程序的入口,它相当于一个中介人的角色,把应用程序(指小窗口)介绍给windows.首要的一步是登记应用程序的窗口类.</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">窗口种类是定义窗口属性的模板,这些属性包括窗口式样,鼠标形状,菜单等等,窗口种类也指定处理该类中所有窗口消息的窗口函数.只有先建立窗口种类,才能根据窗口种类来创建Windows应用程序的一个或多个窗口.创建窗口时,还可以指定窗口独有的附加特性.窗口种类简称窗口类,窗口类不能重名.在建立窗口类后,必须向Windows登记.</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">建立窗口类就是用WNDCLASS结构定义一个结构变量,在这个程序中就是指</span><strong>WNDCLASS wc ;</strong><span style="color:rgb(51,0,102);">然后用自己设计的窗口属性的信息填充结构变量wc的域.</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">要WinMain登记窗口类,首先要填写一个WNDCLASS结构,其定义如下所示:</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　typedef struct _WNDCLASSA</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　{</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　UINT style ; 　　　　　　　</span>　//窗口类风格</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　WNDPROC lpfnWndProc ; 　　　</span>//指向窗口过程函数的指针</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　int cbClsExtra ; 　　　　　</span>　//窗口类附加数据</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　int cbWndExtra ;　　　　　　&nbsp;</span>//窗口附加数据</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　HINSTANCE hInstance ; 　　</span>　//拥有窗口类的实例句柄</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　HICON hIcon ; 　　　　　　　</span>//最小窗口图标</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　HCURSOR hCursor ; 　　　　　</span>//窗口内使用的光标</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　HBRUSH hbrBackground ;　　　</span>//用来着色窗口背景的刷子</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　LPCSTR lpszMenuName ;　　　&nbsp;</span>//指向菜单资源名的指针</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　LPCSTR lpszClassName ;　　　</span>// 指向窗口类名的指针</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　}</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">在VC6.0里面，把光标定位在WNDCLASS上，按F1，即可启动MSDN，在MSDN里你可看到这个结构原形.在下节讲解这些参数在本程序中的具体用法.</span></p> 
    <p align="center" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>(2)注册窗口类</strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>(1)第一个参数:</strong><span style="color:rgb(51,0,102);">成员style控制窗口的某些重要特性，在WINDOWS.H中定义了一些前缀为CS的常量，在程序中可组合使用这些常量.也可把sytle设为0.本程序中为</span>wc.style = CS_HREDRAW | CS_VREDRAW，<span style="color:rgb(51,0,102);">它表示当窗口的纵横坐标发生变化时要重画整个窗口。你看：无论你怎样拉动窗口的大小，那行字都会停留在窗口的正中部，而假如把这个参数设为0的话，当改动窗口的大小时，那行字则不一定处于中部了。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>(2)第二个参数:</strong><span style="color:rgb(51,0,102);">lpfnWndProc包括一个指向该窗口类的消息处理函数的指针，此函数称为窗口过程函数。它将接收Windows发送给窗口的消息，并执行相应的任务。其原型为：</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">long FAR PASCAL WndProc(HWND ,unsigned,WORD,LONG);<span style="color:rgb(51,0,102);">并且必须在模快定义中回调它。WndProc是一个回调函数(见第五节),如果暂时无法理解这个模糊的概念意味着什么，可先放过，等到讲消息循环时再详谈。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>(3)第三,四个参数:</strong><span style="color:rgb(51,0,102);">cbWndExtra域指定用本窗口类建立的所有窗口结构分配的额外字节数。当有两个以上的窗口属于同一窗口类时，如果想将不同的数据和每个窗口分别相对应。则使用该域很有用。这般来讲，你只要把它们设为0就行了,不必过多考虑。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>(4)第五个参数:</strong><span style="color:rgb(51,0,102);">hInstance域标识应用程序的实例hInstance,当然，实例名是可以改变的。</span>wc.hInstance = hInstance ;<span style="color:rgb(51,0,102);">这一成员可使Windows连接到正确的程序。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>(5)第六个参数:</strong><span style="color:rgb(51,0,102);">成员hIcon被设置成应用程序所使用图标的句柄，图标是将应用程序最小化时出现在任务栏里的的图标，用以表示程序仍驻留在内存中。Windows提供了一些默认图标，我们也可定义自己的图标，VC里面专有一个制作图标的工具。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong><span style="color:rgb(0,102,153);">(6)第七个参数:</span></strong><span style="color:rgb(51,0,102);">&nbsp;hCursor域定义该窗口产生的光标形状。LoadCursor可返回固有光标句柄或者应用程序定义的光标句柄。IDC_ARROW表示箭头光标.</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong><span style="color:rgb(0,102,153);">(7)第八个参数:</span></strong><span style="color:rgb(51,0,102);">wc.hbrBackground域决定Windows用于着色窗口背景的刷子颜色，函数GetStockObject返回窗口的颜色，本程序中返回的是白色，你也可以把它改变为红色等其他颜色.试试看</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong><span style="color:rgb(0,102,153);">(8)第九个参数:</span></strong><span style="color:rgb(51,0,102);">lpszMenuName用来指定菜单名，本程序中没有定义菜单，所以为NULL。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong><span style="color:rgb(0,102,153);">(9)第十个参数:</span></strong><span style="color:rgb(51,0,102);">lpszClassName指定了本窗口的类名。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">当对WNDCLASS结构域一一赋值后，就可注册窗口类了，在创建窗口之前，是必须要注册窗口类的，注册窗口类用的API函数是</span>RegisterClass,<span style="color:rgb(51,0,102);">注册失败的话，就会出现一个对话框如程序所示，函数</span>RegisterClass<span style="color:rgb(51,0,102);">返回0值,也只能返回0值，因为注册不成功，程序已经不能再进行下去了。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">在本程序中注册窗口类如下:</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">if (!RegisterClass (&amp;wc)) {</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　　　MessageBox (NULL, TEXT ("This program requires Windows NT!"),</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　　　　　　　　　　　szAppName,MB_ICONERROR) ;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　　　return 0 ;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">　　　　　　　　　　　　 }&nbsp;<br></span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong><span style="color:rgb(204,51,0);">(二)创建窗口</span></strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">注册窗口类后，就可以创建窗口了，本程序中创建窗口的有关语句如下:</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">　hwnd = CreateWindow (szAppName, 　 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">// window class name</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TEXT ("欢迎你的到来</span><span style="color:rgb(51,0,102);">!"),&nbsp;</span><span style="color:rgb(204,51,0);">　　　// window caption</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WS_OVERLAPPEDWINDOW,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">// window style</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CW_USEDEFAULT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">// initial x position</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CW_USEDEFAULT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">// initial y position</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CW_USEDEFAULT,</span><span style="color:rgb(204,51,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // initial x size</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CW_USEDEFAULT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">// initial y size</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NULL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">// parent window handle</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NULL,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">// window menu handle</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hInstance,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">// program instance handle</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NULL) ;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">// creation parameters</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>参数1:</strong><span style="color:rgb(51,0,102);">登记的窗口类名，这个类名刚才咱们在注册窗口时已经定义过了。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong></strong><strong>参数2：</strong><span style="color:rgb(51,0,102);">用来表明窗口的标题。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>参数3:</strong><span style="color:rgb(51,0,102);">&nbsp;用来表明窗口的风格，如有无最大化，最小化按纽啊什么的。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>参数4,5:</strong><span style="color:rgb(51,0,102);">&nbsp;用来表明程序运行后窗口在屏幕中的坐标值。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>参数6,7:</strong><span style="color:rgb(51,0,102);">&nbsp;用来表明窗口初始化时(即程序初运行时)窗口的大小，即长度与宽度。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>参数8:&nbsp;</strong><span style="color:rgb(51,0,102);">在创建窗口时可以指定其父窗口，这里没有</span><span style="color:rgb(51,0,102);">父窗口则参数值为0。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>参数9:</strong><span style="color:rgb(51,0,102);">&nbsp;用以指明窗口的菜单，菜单以后会讲，这里暂时为0。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">最后一个参数是附加数据，一般都是0。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">CreateWindow()的返回值是已经创建的窗口的句柄，应用程序使用这个句柄来引用该窗口。如果返回值为0，就应该终止该程序，因为可能某个地方出错了。如果一个程序创建了多个窗口，则每个窗口都有各自不同的句柄.</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);"><strong>(三)显示和更新窗口</strong></span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp; API函数CreateWindow创建完窗口后，要想把它显示出现，还必须调用另一个API函数ShowWindows.形式为:</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">ShowWindow (hwnd, iCmdShow);</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">其第一个参数是窗口句柄，告诉ShowWindow()显示哪一个窗口，而第二个参数则告诉它如何显示这个窗口：最小化(SW_MINIMIZE)，普通(SW_SHOWNORMAL)，还是最大化(SW_SHOWMAXIMIZED)。WinMain在创建完窗口后就调用ShowWindow函数，并把iCmdShow参数传送给这个窗口。你可把iCmdShow改变为这些参数试试。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">WinMain()调用完ShowWindow后，还需要调用函数</span><span style="color:rgb(204,51,0);">UpdateWindow</span><span style="color:rgb(51,0,102);">，最终把窗口显示了出来。调用函数UpdateWindow将产生一个WM_PAINT消息，这个消息将使窗口重画，即使窗口得到更新.</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong><span style="color:rgb(204,51,0);">(四)创建消息循环</span></strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">主窗口显示出来了，WinMain就开始处理消息了，怎么做的呢？</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">Windows为每个正在运行的应用程序都保持一个消息队列。当你按下鼠标或者键盘时，Windows并不是把这个输入事件直接送给应用程序，而是将输入的事件先翻译成一个消息，然后把这个消息放入到这个应用程序的消息队列中去。应用程序又是怎么来接收这个消息呢？这就讲讲消息循环了。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">应用程序的WinMain函数通过执行一段代码从她的队列中来检索Windows送往她的消息。然后WinMain就把这些消息分配给相应的窗口函数以便处理它们，这段代码是一段循环代码，故称为"消息循环"。这段循环代码是什么呢？好，往下看:</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">在咱们的第二只小板凳中,这段代码就是:</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">......</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">MSG msg;<span style="color:rgb(51,0,102);">&nbsp;//定义消息名</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">while (GetMessage (&amp;msg, NULL, 0, 0))</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">{</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">TranslateMessage (&amp;msg) ;</span><span style="color:rgb(51,0,102);">&nbsp;//翻译消息</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">DispatchMessage (&amp;msg) ;</span><span style="color:rgb(51,0,102);">&nbsp;//撤去消息</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">}</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:rgb(204,51,0);">return msg.wParam ;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">MSG结构在头文件中定义如下:</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">typedef struct tagMSG</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">{</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">HWND hwnd;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">UINT message;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">WPARAM wParam;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">LPARAM lParam;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">DWORD time;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">POINT pt;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">} MSG, *PMSG;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">MSG数据成员意义如下：</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">参数1：<span style="color:rgb(51,0,102);">hwnd是消息要发送到的那个窗口的句柄,这个窗口就是咱们用CreateWindows函数创建的那一个。如果是在一个有多个窗口的应用程序中，用这个参数就可决定让哪个窗口接收消息。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">参数2:<span style="color:rgb(51,0,102);">message是一个数字，它唯一标识了一种消息类型。每种消息类型都在Windows文件中定义了，这些常量都以WM_开始后面带一些描述了消息特性的名称。比如说当应用程序退出时，Windows就向应用程序发送一条WM_QUIT消息。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">参数3:<span style="color:rgb(51,0,102);">一个32位的消息参数，这个值的确切意义取决于消息本身。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">参数4:<span style="color:rgb(51,0,102);">同上。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">参数5:<span style="color:rgb(51,0,102);">消息放入消息队列中的时间，在这个域中写入的并不是日期，而是从Windows启动后所测量的时间值。Windows用这个域来使用消息保持正确的顺序。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">参数6:<span style="color:rgb(51,0,102);">消息放入消息队列时的鼠标坐标.</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">消息循环以</span><span style="color:rgb(204,51,0);">GetMessage</span><span style="color:rgb(51,0,102);">调用开始，它从消息队列中取出一个消息：</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">GetMessage(&amp;msg,NULL,0,0)</span><span style="color:rgb(51,0,102);">，第一个参数是要接收消息的MSG结构的地址，第二个参数表示窗口句柄,NULL则表示要获取该应用程序创建的所有窗口的消息；第三，四参数指定消息范围。后面三个参数被设置为默认值，这就是说你打算接收发送到属于这个应用程序的任何一个窗口的所有消息。在接收到除WM_QUIT之外的任何一个消息后，GetMessage()都返回TRUE。如果GetMessage收到一个WM_QUIT消息，则返回FALSE，如收到其他消息，则返回TRUE。因此，在接收到WM_QUIT之前，带有GetMessage()的消息循环可以一直循环下去。只有当收到的消息是</span><span style="color:rgb(204,51,0);">WM_QUIT</span><span style="color:rgb(51,0,102);">时，GetMessage才返回FALSE，结束消息循环，从而终止应用程序。 均为NULL时就表示获取所有消息。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">消息用GetMessage读入后(注意这个消息可不是WM_QUIT消息)，它首先要经过函数</span><span style="color:rgb(204,51,0);">TranslateMessage()</span><span style="color:rgb(51,0,102);">进行翻译，这个函数会转换成一些键盘消息，它检索匹配的WM_KEYDOWN和WM_KEYUP消息，并为窗口产生相应的ASCII字符消息(WM_CHAR),它包含指定键的ANSI字符.但对大多数消息来说它并不起什么作用，所以现在没有必要考虑它。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(51,0,102);">下一个函数调用</span><span style="color:rgb(204,51,0);">DispatchMessage()</span><span style="color:rgb(51,0,102);">要求Windows将消息传送给在MSG结构中为窗口所指定的窗口过程。我们在讲到登记窗口类时曾提到过，登记窗口类时，我们曾指定Windows把函数WindosProc作为咱们这个窗口的窗口过程(就是指处理这个消息的东东)。就是说，Windows会调用函数WindowsProc()来处理这个消息。在WindowProc()处理完消息后，代码又循环到开始去接收另一个消息，这样就完成了一个消息循环。&nbsp;<br><br></span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>(五)终止应用程序:</strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">Windows是一种非剥夺式多任务操作系统。只有的应用程序交出CPU控制权后，Windows才能把控制权交给其他应用程序。当GetMessage函数找不到等待应用程序处理的消息时，自动交出控制权，Windows把CPU的控制权交给其他等待控制权的应用程序。由于每个应用程序都有一个消息循环，这种隐式交出控制权的方式保证合并各个应用程序共享控制权。一旦发往该应用程序的消息到达应用程序队列，即开始执行GetMessage语句的下一条语句。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">当WinMain函数把控制返回到Windows时，应用程序就终止了。应用程序的启动消息循环前要检查引导出消息循环的每一步，以确保每个窗口已注册，每个窗口都已创建。如存在一个错误，应用程序应返回控制权，并显示一条消息。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">但是，一旦WinMain函数进入消息循环，终止应用程序的唯一办法就是使用PostQuitMessage把消息WM_QUIT发送到应用程序队列。当GetMessage函数检索到WM_QUIT消息，它就返回NULL，并退出消息外循环。通常，当主窗口正在删除时(即窗口已接收到一条WM_DESTROY消息),应用程序主窗口的窗口函数就发送一条WM_QUIT消息。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">虽然WinMain指定了返回值的数据类型，但Windows并不使用返回值。不过，在调试一应用程序时，返回值地有用的。通常，可使用与标准C程序相同的返回值约定：0表示成功，非0表示出错。PostQuitMessage函数允许窗口函数指定返回值，这个值复制到WM_QUIT消息的wParam参数中。为了的结束消息循环之后返回这个值，我们的第二只小板凳中使用了以下语句：</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">return msg.wParam ;</span><span style="color:rgb(204,51,0);">//表示从PostQuitMessage返回的值</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">例如：当Windows自身终止时，它会撤消每个窗口，但不把控制返回给应用程序的消息循环，这意味着消息循环将永远不会检索到WM_QUIT消息，并且的循环之后的语句也不能再执行。Windows的终止前的确发送一消息给每个应用程序，因而标准C程序通常会的结束前清理现场并释放资源，但Windows应用程序必须随每个窗口的撤消而被清除，否则会丢失一些数据。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>（六)窗口过程，窗口过程函数</strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">如前所述，函数GetMessage负责从应用程序的消息队列中取出消息，而函数DispatchMessage()要求Windows将消息传送给在MSG结构中为窗口所指定的窗口过程。然后出台的就是这个窗口过程了，这个窗口过程的任务是干什么呢？就是最终用来处理消息的，就是消息的处理器而已，那么这个函数就是WindowProc,在Visual C++6.0中按F1启动MSDN，按下面这个路径走下来：</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong><span style="color:rgb(204,51,0);">PlatForm SDK</span></strong><strong><span style="color:rgb(0,102,153);">--&gt;</span></strong><strong><span style="color:rgb(204,51,0);">User Interface services</span></strong><strong><span style="color:rgb(0,102,153);">--&gt;</span></strong><strong><span style="color:rgb(204,51,0);">Windows user Interface</span></strong><strong><span style="color:rgb(0,102,153);">--&gt;</span></strong><strong><span style="color:rgb(204,51,0);">Windowing</span></strong><strong><span style="color:rgb(0,102,153);">--&gt;</span></strong><strong><span style="color:rgb(204,51,0);">Window Procedures</span></strong><strong><span style="color:rgb(0,102,153);">--&gt;</span></strong><strong><span style="color:rgb(204,51,0);">Window Procedure Reference</span></strong><strong><span style="color:rgb(0,102,153);">--&gt;</span></strong><strong><span style="color:rgb(204,51,0);">Windows Procedure Functions</span></strong><strong><span style="color:rgb(0,102,153);">--&gt;</span></strong><strong><span style="color:rgb(204,51,0);">WindowProc</span></strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">啊，太累了，不过我们终于的MSDN中找到了这个函数，前几次我讲解这些API函数的时候，都是的知道的情况下搜索出来的，所以没有详细给出每个函数的具体位置，而这次我却是一点点去找的，还好，没被累死，体会到MSDN的庞大了吧，不过我用的是MSDN2000，是D版的，三张光盘装。你用的MSDN如果按这个路径走下去的话，可能会找不到，不过我想大致也是在这个位置了，找找看！！！</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">LRESULT CALLBACK WindowProc</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">(</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">HWND hwnd,&nbsp;</span><span style="color:rgb(204,51,0);">// handle to window</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">UINT uMsg,</span><span style="color:rgb(204,51,0);">&nbsp;// message identifier</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">WPARAM wParam,&nbsp;</span><span style="color:rgb(204,51,0);">// first message parameter</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">LPARAM lParam&nbsp;</span><span style="color:rgb(204,51,0);">// second message parameter</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">);</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">这个函数我们的第二只小板凳里被我们称为<span style="color:rgb(204,51,0);">WndProc.</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>下面讲解：</strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">不知你注意到了没有，这个函数的参数与刚刚提到的GetMessage调用把返回的MSG结构的前四个成员相同。如果消息处理成功，WindowProc的返回值为0.</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">Windows的启动应用程序时，先调用WinMain函数，然后调用窗口过程，注意：在我们的这个程序中，只有一个窗口过程，实际上，也许有不止一个的窗口过程。例如，每一个不同的窗口类都 有一个与之相对应的窗口过程。无论Windows何时想传递一个消息到一窗口，都将调用相应的窗口过程。当Windows从环境，或从另一个应用程序，或从用户的应用程序中得到消息时，它将调用窗口过程并将信息传给此函数。总之，窗口过程函数处理所有传送到由此窗口类创建的窗口所得到的消息。并且窗口过程有义务处理Windows扔给它的任何消息。我们在学习Windows程序设计的时候，最主要的就是学习这些消息是什么以及是什么意思，它们是怎么工作的。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">令我们不解的是，在程序中我们看不出来是哪一个函数在调用窗口过程。它其实是一个<strong><span style="color:rgb(204,51,0);">回调函数</span></strong>.前面已经提到，Windows把发生的输入事件转换成输入消息放到消息队列中，而消息循环将它们发送到相应的窗口过程函数，真正的处理是在窗口过程函数中执行的，在Windows中就使用了回调函数来进行这种通信。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">回调函数是输出函数中特殊的一种，它是指那些在Windows环境下直接调用的函数。一个应用程序至少有一个回调函数，因为在应用程序处理消息时，Windows调用回调函数。这种回调函数就是我们前面提到的窗口过程，它对对应于一个活动的窗口，回调函数必须向Windows注册，Windows实施相应操作即行回调。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">每个窗口必须有一个窗口过程与之对应，且Windows直接调用本函数，因此，窗口函数必须采用FAR PASCAL调用约定。在我们的第二只小板凳中，我们的窗口函数为WndProc，必须注意这里的函数名必须是前面注册的窗口类时，向域wc.lpfnWndProc所赋的WndProc。函数WndProc就是前面定义的窗口类所生成的所有窗口的窗口函数。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">在我们的这个窗口函数中，WndProc处理了共有两条消息：<strong><span style="color:rgb(204,51,0);">WM_PAINT</span></strong>和<strong><span style="color:rgb(204,51,0);">WM_DESTROY</span></strong>.</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">窗口函数从Windows中接收消息，这些消息或者是由WinMain函数发送的输入消息，或者是直接来自Windows的窗口管理消息。窗口过程检查一条消息，然后根据这些消息执行特定的动作未被处理的消息通过DefWindowProc函数传回给Windows作缺海上处理。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">可以发送窗口函数的消息约有220种，所有窗口消息都以WM_开头，这些消息在头文件中被定义为常量。引起Windows调用窗口函数的原因有很多，，如改变窗口大小啊，改变窗口在屏幕上的位置啊什么的。<br><strong><span style="color:rgb(204,51,0);">(七)处理消息</span></strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">窗口过程处理消息通常以switch语句开始，对于它要处理的每一条消息ID都跟有一条case语句。大多数windows proc都有具有下面形式的内部结构：</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">switch(uMsgId)</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">{</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">case WM_(something):</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">//这里此消息的处理过程</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">return 0;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">case WM_(something else):</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">//这里是此消息的处理过程</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">ruturn 0;</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">default:</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);">//其他消息由这个默认处理函数来处理</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">return DefWindowProc(hwnd,uMsgId,wParam,lParam);</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,102,153);">}</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">在处理完消息后，要返回0,这很重要-----它会告诉Windows不必再重试了。对于那些在程序中不准备处理的消息，窗口过程会把它们都扔给DefWindowProc进行缺省处理，而且还要返回那个函数的返回值。在消息传递层次中，可以认为DefWindowProc函数是最顶层的函数。这个函数发出WM_SYSCOMMAND消息,由系统执行Windows环境中多数窗口所公用的各种通用操作，例如，画窗口的非用户区，更新窗口的正文标题等等等等。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">再提示一下，以WM_的消息在Windows头文件中都被定义成了常量，如WM_QUIT=XXXXXXXXXXX,但我们没有必要记住这个数值，也不可能记得住，我们只要知道WM_QUIT就OK了。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">在第二只小板凳中我们只让窗口过程处理了两个消息：一个是<strong><span style="color:rgb(204,51,0);">WM_PAINT</span></strong>,另一个是<strong><span style="color:rgb(204,51,0);">WM_DESTROY,</span></strong>先说说第一个消息---<span style="color:rgb(204,51,0);">WM_PAINT.</span></p> 
    <p align="center" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>关于WM_PAINT:</strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">无论何时Windows要求重画当前窗口时，都会发该消息。也可以这样说：无论何时窗口非法，都必须进行重画。 哎呀，什么又是"非法窗口"？什么又是重画啊？你这人有没有完，嗯？</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">稍安勿燥，我比你还烦呢？我午饭到现在还没吃呢！你有点耐心，来点专业精神好不好？？？我开始在MSDN里面找有关这个方面的内容了，别急，我找找看:</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong><span style="color:rgb(204,51,0);">Platform SDK</span><span style="color:rgb(0,102,153);">--&gt;</span><span style="color:rgb(204,51,0);">Graphics and Multimedia Services</span><span style="color:rgb(0,102,153);">--&gt;</span><span style="color:rgb(204,51,0);">Windows GDI</span><span style="color:rgb(0,102,153);">--&gt;</span><span style="color:rgb(204,51,0);">Painting and Drawing</span><span style="color:rgb(0,102,153);">--&gt;</span><span style="color:rgb(204,51,0);">Using the WM_PAINT Message</span></strong>-----终于找到了。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong>下面是一大套理论：</strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">让我们把Windows的屏幕想像成一个桌面，把一个窗口想像成一张纸。当我们把一张纸放到桌面上时，它会盖住其他的纸，这样被盖住的其他纸上的内容都看不到了。但我们只要把这张纸移开，被盖住的其他纸上的内容就会显示出来了---这是一个很简单的道理，谁都明白。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">对于我们的屏幕来说，当一个窗口被另一窗口盖住时，被盖住的窗口的某些部分就看不到了，我们要想看到被盖住的窗口的全部面貌，就要把另一个窗口移开，但是当我们移开后，事情却起了变化-----很可能这个被盖住的窗口上的信息被擦除了或是丢失了。当窗口中的数据丢失或过期时，窗口就变成非法的了---或者称为"无效"。于是我们的任务就来了，我们必须考虑怎样在窗口的信息丢失时"重画窗口"--使窗口恢复成以前的那个样子。这也就是我们在这第二只小板凳中调用UpdateWindow的原因。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">你忘记了吗？刚才我们在<strong><span style="color:rgb(204,51,0);">(三)显示和更新窗口</span></strong>中有下面的一些文字:</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,153,153);">WinMain()调用完ShowWindow后，还需要调用函数</span><span style="color:rgb(204,51,0);">UpdateWindow</span><span style="color:rgb(0,153,153);">，最终把窗口显示了出来。调用函数UpdateWindow将产生一个WM_PAINT消息，这个消息将使窗口重画，即使窗口得到更新.---这是程序第一次调用了这条消息。</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">为重新显示非法区域，Windows就发送WM_PAINT消息实现。要求Windows发送WM_PAINT的情况有改变窗口大小，对话框关闭，使用了UpdateWindows和ScrollWindow函数等。这里注意，Windows并非是消息WM_PAINT的唯一来源，使用InvalidateRect或InvalidateRgn函数也可以产生绘图窗口的WM_PAINT消息......</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">通常情况下用BeginPaint()来响应WM_PAINT消息。如果要在没有WM_PAINT的情况下重画窗口，必须使用GetDC函数得到显示缓冲区的句柄。这里面不再扩展。详细见MDSN。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">这个BeginPaint函数会执行准备绘画所需的所有步骤，包括返回你用于输入的句柄。结束则是以EndPaint();</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">在调用完BeginPaint之后，WndProc接着调用<span style="color:rgb(204,51,0);">GetClientRect:</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">GetClientRect(hwnd,&amp;rect);</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">第一个参数是程序窗口的句柄。第二个参数是一个指针，指向一个RECT类型的结构。查MSDN，可看到这个结构有四个成员。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">WndProc做了一件事，他把这个RECT结构的指针传送给了DrawText的第四个参数。函数DrawText的目的就是在窗口上显示一行字----"<span style="color:rgb(204,51,0);">你好,欢迎你来到VC之路!</span>",有关这个函数的具体用法这里也没必要说了吧。</p> 
    <p align="center" style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><strong><span style="color:rgb(204,51,0);">关于WM_DESTROY</span></strong></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">这个消息要比WM_PAINT消息容易处理得多：只要用户关闭窗口，就会发送WM_DESTROY消息(在窗口从屏幕上移去后）。</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">程序通过调用PostQuitMessage以标准方式响应WM_DESTROY消息:</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">PostQuitMessage (0) ;</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">这个函数在程序的消息队列中插入一个WM_QUIT消息。在<strong><span style="color:rgb(204,51,0);">(四)创建消息循环</span></strong>中我们曾有这么一段话：</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,153,153);">消息循环以GetMessage调用开始，它从消息队列中取出一个消息：</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;">.......</p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(0,153,153);">在接收到除WM_QUIT之外的任何一个消息后，GetMessage()都返回TRUE。如果GetMessage收到一个WM_QUIT消息，则返回FALSE，如收到其他消息，则返回TRUE。因此，在接收到WM_QUIT之前，带有GetMessage()的消息循环可以一直循环下去。</span><span style="color:rgb(204,51,0);">只有当收到的消息是WM_QUIT时，GetMessage才返回FALSE，结束消息循环，从而终止应用程序。<br><br><br> 来自:SDK路报 ,很感谢</span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);"><br></span></p> 
    <p style="font-family:Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif;font-size:12px;"><span style="color:rgb(204,51,0);"><br></span></p> 
    <p><font color="#cc3300"><span style="font-size:12px;">本文转自Work Hard Work Smart博客园博客，原文链接：http://www.cnblogs.com/linlf03/archive/2011/11/20/2256539.html，如需转载请自行联系原作者</span></font><br></p> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
