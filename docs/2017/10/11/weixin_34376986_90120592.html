<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>偶这个前端设计师有生以来写过的最复杂的程序业务逻辑（菜鸟贴）。 « NotBeCN</title>
  <meta name="description" content="             05年底写的，八年工作以来第一次以.net程序员而不是设计师的身份应聘到一公司，在试用期间写过的一个不同单位OA系统间的部门、人员建立及数据同步交换流程，包括界面的处理。    反正对我来说，已经很复杂了……当时可谓是绞尽脑汁，倾力而为，精尽人亡（哈哈，见笑了，个人能力有限。）。写完之后...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/11/weixin_34376986_90120592.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">偶这个前端设计师有生以来写过的最复杂的程序业务逻辑（菜鸟贴）。</h1>
    <p class="post-meta">Oct 11, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-size:16px;line-height:1.5;color:rgb(51,51,51);font-family:'Segoe UI', arial, Helvetica, '微软雅黑', MSYH;border:1px solid rgb(245,245,245);background:rgb(253,253,253);">05年底写的，八年工作以来第一次以.net程序员而不是设计师的身份应聘到一公司，在试用期间写过的一个不同单位OA系统间的部门、人员建立及数据同步交换流程，包括界面的处理。</p> 
   <p style="font-size:16px;line-height:1.5;color:rgb(51,51,51);font-family:'Segoe UI', arial, Helvetica, '微软雅黑', MSYH;border:1px solid rgb(245,245,245);background:rgb(253,253,253);">反正对我来说，已经很复杂了……当时可谓是绞尽脑汁，倾力而为，精尽人亡（哈哈，见笑了，个人能力有限。）。写完之后因为开始主导Web标准的部署重回到设计师的路上就再也没碰过程序了，不知道以后还会不会写，说不定就成个人在编程上的绝唱了，所以一直保留着的，呵呵。</p> 
   <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;line-height:19.5px;border:1px solid rgb(204,204,204);"> 
    <span style="line-height:1.5;color:rgb(0,0,255);">namespace</span>
    <span style="line-height:1.5;">&nbsp;Winstar.Build.HR.Module<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;System;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;System.Data;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;System.Data.SqlClient;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;System.Drawing;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;System.Xml;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;System.Web;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.WebControls;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;Microsoft.Web.UI.WebControls;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;Winstar.Build.HR.BusinessFacade;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;Winstar.Build.HR.Controls;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;Winstar.Build.HR.Common;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;Winstar.Build.HR.DataAccess;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;Winstar.Build.HR.WebUI.Control;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">using</span>
    <span style="line-height:1.5;">&nbsp;Winstar.IACenterAD.WebService.Agent;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">///</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">&lt;summary&gt;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">///</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HR_InitializeOrganization&nbsp;的摘要说明。<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">///</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">&lt;/summary&gt;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">class</span>
    <span style="line-height:1.5;">&nbsp;HR_InitializeOrganization&nbsp;:Winstar.Framework.WebUI.PortalModuleControl<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;Microsoft.Web.UI.WebControls.TreeView&nbsp;TreeViewHR;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.WebControls.TextBox&nbsp;OrganizationName;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.WebControls.TextBox&nbsp;OrganizationOaid;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.WebControls.Label&nbsp;OrganizationID;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.WebControls.Label&nbsp;lblDelTip;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.WebControls.Label&nbsp;lblError;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.WebControls.DropDownList&nbsp;DDLOrganizationType;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlGenericControl&nbsp;ToolBar;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlAnchor&nbsp;Organization_Synchronize;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlAnchor&nbsp;Organization_Add;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlAnchor&nbsp;Organization_Save;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlAnchor&nbsp;Organization_Del;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlAnchor&nbsp;Organization_Back;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlAnchor&nbsp;upBtnGroup;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlAnchor&nbsp;downBtnGroup;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlGenericControl&nbsp;OrganizationDataArea;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlGenericControl&nbsp;DelResultArea;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;System.Web.UI.HtmlControls.HtmlGenericControl&nbsp;SynchronizeTipArea;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;DataTable&nbsp;ReportDT;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CollectionTable&nbsp;ct&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;CollectionTable();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;id,&nbsp;type,&nbsp;stradd,&nbsp;strSynchronize,&nbsp;strSyn,&nbsp;strMorS,&nbsp;strDel,&nbsp;strStyle;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;personcount,&nbsp;departmentcount;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]&nbsp;&nbsp;strcondition;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;selectedtype;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;organizationid,&nbsp;organizationname,&nbsp;organizationoaid,&nbsp;organizationtype;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;Page_Load(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">object</span>
    <span style="line-height:1.5;">&nbsp;sender,&nbsp;System.EventArgs&nbsp;e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.SmartNavigation&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TreeViewHR.AutoPostBack&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;strTreeName&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">_ctl1_TreeViewHR</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;strRef&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;Page.GetPostBackEventReference(TreeViewHR);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;strScript&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&lt;script&nbsp;language=\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">JavaScript\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&gt;&nbsp;\n</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&lt;!--&nbsp;\n</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;function&nbsp;initTree()&nbsp;{&nbsp;\n</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;strTreeName&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.onSelectedIndexChange&nbsp;=&nbsp;function()&nbsp;{&nbsp;\n</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">if&nbsp;(event.oldTreeNodeIndex&nbsp;!=&nbsp;event.newTreeNodeIndex)&nbsp;\n</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">this.queueEvent('onselectedindexchange',&nbsp;event.oldTreeNodeIndex&nbsp;+&nbsp;','&nbsp;+&nbsp;event.newTreeNodeIndex);&nbsp;\n</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">window.setTimeout('</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;strRef.Replace(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">'</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">\\'</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">)&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">',&nbsp;0,&nbsp;'JavaScript');&nbsp;\n</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;}&nbsp;\n</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;}&nbsp;\n</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//&nbsp;--&gt;&nbsp;\n</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&lt;/script&gt;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Page.RegisterClientScriptBlock(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">InitTree</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,strScript&nbsp;);&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">初始化HTML控件显示属性</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationDataArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeTipArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DelResultArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblError.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Add.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Save.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Del.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Back.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(</span>
    <span style="line-height:1.5;">!</span>
    <span style="line-height:1.5;">IsPostBack)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stradd&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建单位</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSynchronize&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">初始化</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSyn&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">同步</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;stradd;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Synchronize</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strSynchronize;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Synchronize.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Add.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitTreeByXml();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;建立TreeView并初始化。</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">private</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;InitTreeByXml()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TreeViewHR.Nodes.Clear();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TreeNode&nbsp;noderoot&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;TreeNode();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noderoot.Text</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">根目录</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noderoot.NavigateUrl&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">DesktopDefault.aspx?tabid=925f53ab-03bd-4de4-9df5-4abad04ec9c9</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.TreeViewHR.Nodes.Add(noderoot);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlDocument&nbsp;xmldoc&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;XmlDocument();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmldoc.Load(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Xml.XmlNodeList&nbsp;xmlChildNodeList&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;xmldoc.SelectNodes(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@Type&nbsp;=&nbsp;'1']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">for</span>
    <span style="line-height:1.5;">&nbsp;(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">;&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">&lt;</span>
    <span style="line-height:1.5;">&nbsp;xmlChildNodeList.Count;&nbsp;i</span>
    <span style="line-height:1.5;">++</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TreeNode&nbsp;node&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;buildTreeByXml(xmlChildNodeList[i]);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;">&nbsp;node)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noderoot.Nodes.Add(node);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">private</span>
    <span style="line-height:1.5;">&nbsp;TreeNode&nbsp;buildTreeByXml(XmlNode&nbsp;xmlTreeNode)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TreeNode&nbsp;node&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;xmlTreeNode)&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">return</span>
    <span style="line-height:1.5;">&nbsp;node;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;TreeNode();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;xmlTreeNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.ID&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;xmlTreeNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">ID</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.Type&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;xmlTreeNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.NodeData&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;xmlTreeNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNodeList&nbsp;nodelist&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;xmlTreeNode.ChildNodes;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">for</span>
    <span style="line-height:1.5;">&nbsp;(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">;&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">&lt;</span>
    <span style="line-height:1.5;">&nbsp;nodelist.Count;&nbsp;i</span>
    <span style="line-height:1.5;">++</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.Nodes.Add(buildTreeByXml(nodelist[i]));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">return</span>
    <span style="line-height:1.5;">&nbsp;node;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;同步OA系统部门及人员数据</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;同步流程</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;SynchronizeFlow(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]&nbsp;strcondition,&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;type)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;newnode;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organize&nbsp;IAagent</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;Organize();&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newnode&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;IAagent.GetOrganizeInfo(</span>
    <span style="line-height:1.5;">""</span>
    <span style="line-height:1.5;">,</span>
    <span style="line-height:1.5;">""</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">XmlDocument&nbsp;xmldoc&nbsp;=&nbsp;new&nbsp;XmlDocument();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">xmldoc.Load(this.Page.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath+"Organization.xml"));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">for</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;i</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">;&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">&lt;</span>
    <span style="line-height:1.5;">&nbsp;strcondition.Length;&nbsp;i</span>
    <span style="line-height:1.5;">++</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNodeList&nbsp;OrganizationNodeList&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;newnode.SelectNodes(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@type&nbsp;=&nbsp;'</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;type&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">'</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;strcondition[i]&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeOrganization(OrganizationNodeList,&nbsp;type);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;同步数据库机构信息</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;SynchronizeOrganization(XmlNodeList&nbsp;OrganizationNodeList,&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;type)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]&nbsp;result&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]{</span>
    <span style="line-height:1.5;">""</span>
    <span style="line-height:1.5;">};<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[,]&nbsp;resultvalue&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[OrganizationNodeList.Count,&nbsp;</span>
    <span style="line-height:1.5;">2</span>
    <span style="line-height:1.5;">];<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;同步机构。</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">for</span>
    <span style="line-height:1.5;">&nbsp;(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">;&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">&lt;</span>
    <span style="line-height:1.5;">&nbsp;OrganizationNodeList.Count;&nbsp;i</span>
    <span style="line-height:1.5;">++</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">建立需要传入过程的一，二维单位参数数组（由OA系统XML文档取得机构数据）||（由取得前台页面输入的新机构数据）</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]&nbsp;arrParameterOrganization&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Guid.NewGuid().ToString(),<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationNodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationNodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[,]&nbsp;arrParameterUnit&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[,]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">unitauthorizedguid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">unitname</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;200</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">unitid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;type&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;取到数据为单位数据</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">将各参数传入数据层，返回操作结果。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlDataAccess&nbsp;getresult&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;SqlDataAccess();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;getresult.GetResult(arrParameterOrganization,&nbsp;arrParameterUnit,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Handle_Unit</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">3</span>
    <span style="line-height:1.5;">);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">建立或更新XML单位节点。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeLocalXmlDoc(OrganizationNodeList[i]);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">查询OA系统XML当前单位节点下的所有部门。||若是建立新单位，则以下查询结果＝null，循环不被执行。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNodeList&nbsp;DepartmentNodeList&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;OrganizationNodeList[i].SelectNodes(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">*</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;同步部门及其人员（循环）</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">for</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;j&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">;&nbsp;j&nbsp;</span>
    <span style="line-height:1.5;">&lt;</span>
    <span style="line-height:1.5;">&nbsp;DepartmentNodeList.Count;&nbsp;j</span>
    <span style="line-height:1.5;">++</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">在该单位节点下建立部门节点。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeLocalXmlDoc(DepartmentNodeList[j]);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">同步人员信息。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizePerson(DepartmentNodeList[j]);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;取到数据为部门数据</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">更新本地XML该部门数据。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeLocalXmlDoc(OrganizationNodeList[i]);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;type&nbsp;</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">10</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">传入的NodeList为OA系统部门信息，执行人员同步操作。（若type=10则传入为新建立部门数据，不执行人员同步）</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizePerson(OrganizationNodeList[i]);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">rptOrganizationResult.DataSource&nbsp;=&nbsp;resultvalue;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">rptOrganizationResult.DataBind();</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;同步数据库人员信息</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;SynchronizePerson(XmlNode&nbsp;DepartmentNode)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">查询OA系统XML当前部门节点下的所有人员。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNodeList&nbsp;PersonNodeList&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;DepartmentNode.SelectNodes(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">members/member</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[,]&nbsp;resultvalue&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[PersonNodeList.Count,</span>
    <span style="line-height:1.5;">2</span>
    <span style="line-height:1.5;">];<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">取得OA系统XML当前人员节点中相关属性。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;同步人员（循环）</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">for</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">;&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">&lt;</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList.Count;&nbsp;i</span>
    <span style="line-height:1.5;">++</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;personnelguid&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;System.Guid.NewGuid().ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;guid&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;personnelguid;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;personname&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;personid&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;oaccount&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">account</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;departmentid&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList[i].ParentNode.ParentNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;telephone&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">tel</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;mobile&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">mobile</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;departmentname&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList[i].ParentNode.ParentNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;unitid&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList[i].ParentNode.ParentNode.ParentNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;unitid&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">0501021148366051</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unitid&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList[i].ParentNode.ParentNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;departmentid</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">""</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;departmentname</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">""</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;iorder&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;PersonNodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">usernumber</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">建立需要传入过程的一，二维人员参数数组</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]&nbsp;arrParameter&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;personnelguid,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;guid,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;personname,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;personid,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oaccount,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;departmentid,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;telephone,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mobile,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;departmentname,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unitid,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iorder<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[,]&nbsp;arrParameterPerson&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[,]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">personnelguid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">guid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">personname</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">personid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">oaccount</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">departmentid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">telephone</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">mobile</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">departmentname</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;200</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">unitid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">iorder</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">将各参数传入数据层，返回操作结果。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlDataAccess&nbsp;getresult&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;SqlDataAccess();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]&nbsp;result&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;getresult.GetResult(arrParameter,&nbsp;arrParameterPerson,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Handle_Person</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">11</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;同步本地XML文档</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;SynchronizeLocalXmlDoc(XmlNode&nbsp;OrganizationNode)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlDocument&nbsp;localxmldoc&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;XmlDocument();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localxmldoc.Load(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;LocalNode&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;狗屎程序故障，见鬼了。</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;OrganizationNode.Attributes["id"]&nbsp;==&nbsp;null)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response.Write("0");<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{Response.Write("1");}</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;localxmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID&nbsp;=&nbsp;'</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;LocalNode&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">本地XML文档中无该节点，建立。&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">(&nbsp;OrganizationNode.ParentNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">该节点为单位节点</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;localxmldoc.DocumentElement;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">该节点为部门节点</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;localxmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID&nbsp;=&nbsp;'</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;OrganizationNode.ParentNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlElement&nbsp;node&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;localxmldoc.CreateElement(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">department</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">ID</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value.ToString());<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value.ToString());<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value.ToString());<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value.ToString());<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value.ToString());<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode.AppendChild(node);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localxmldoc.Save(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(&nbsp;Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">更新节点</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">ID</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;OrganizationNode.Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localxmldoc.Save(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(&nbsp;Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;处理特例直属单位：存入直属单位下所有单位数据到数据库，并删除直属单位</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;ReplaceDBUnit()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]&nbsp;result&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]{</span>
    <span style="line-height:1.5;">""</span>
    <span style="line-height:1.5;">};<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlDocument&nbsp;localxmldoc&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;XmlDocument();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localxmldoc.Load(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNodeList&nbsp;NodeList&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;localxmldoc.DocumentElement.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID&nbsp;=&nbsp;'0501021148366051']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">).SelectNodes(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">*</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">for</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">;&nbsp;i&nbsp;</span>
    <span style="line-height:1.5;">&lt;</span>
    <span style="line-height:1.5;">&nbsp;NodeList.Count;&nbsp;i</span>
    <span style="line-height:1.5;">++</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]&nbsp;arrParameterOrganization&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">ID</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NodeList[i].Attributes[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].Value,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[,]&nbsp;arrParameterUnit&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[,]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">unitauthorizedguid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">unitname</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;200</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">unitid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">SqlDbType.VarChar,&nbsp;50</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlDataAccess&nbsp;getresult&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;SqlDataAccess();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;getresult.GetResult(arrParameterOrganization,&nbsp;arrParameterUnit,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Handle_Unit</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">3</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlDataAccess&nbsp;delresult&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;SqlDataAccess();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;personcount&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;delresult.DeleteOrganization(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">0501021148366051</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">delete</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;绑定相应XML数据</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">private</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;BindXmlData(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;id,&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;name,&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;oaid,&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;type)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DDLOrganizationType.Items.Clear();<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationName.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;name;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationID.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;id;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationOaid.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;oaid;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">判断生成DDL</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;type&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{DDLOrganizationType.Items.Add(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;ListItem(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">单位</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">unit</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;type&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">2</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{DDLOrganizationType.Items.Add(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;ListItem(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">department</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{DDLOrganizationType.Items.Add(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;ListItem(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">领导部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">leaddepartment</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;树点击事件</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;TreeViewHR_SelectedIndexChange(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">object</span>
    <span style="line-height:1.5;">&nbsp;sender,&nbsp;Microsoft.Web.UI.WebControls.TreeViewSelectEventArgs&nbsp;e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TreeNode&nbsp;node&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;TreeViewHR.GetNodeFromIndex(TreeViewHR.SelectedNodeIndex);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;organizationtype&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;node.NodeData;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;organizationname&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;node.Text;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;organizationoaid&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;node.Type;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;organizationid&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;node.ID;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;organizationtype;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;organizationname;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;organizationid;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;organizationoaid;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMorS&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">修改</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">MorS</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strMorS;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strDel&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">删除</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Del</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strDel;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.Expanded&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BindXmlData(organizationid,&nbsp;organizationname,&nbsp;organizationoaid,&nbsp;organizationtype);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Synchronize.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationDataArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Add.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Save.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Del.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;organizationtype&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stradd&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建部门或者领导部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;stradd;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stradd&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建子部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;stradd;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSynchronize&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">同步更新</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Synchronize</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strSynchronize;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;删除单位或者部门</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">private</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;DeleteOrganization(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;id,&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;mark)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">将参数传入数据层，返回操作结果。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SqlDataAccess&nbsp;delresult&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;SqlDataAccess();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;personcount&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;delresult.DeleteOrganization(id,&nbsp;mark);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlDocument&nbsp;localxmldoc&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;XmlDocument();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localxmldoc.Load(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;Node&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;localxmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID&nbsp;=&nbsp;'</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;id&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;mark&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">getdelinfo</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;departmentcount&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;Node.ChildNodes.Count;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;NodeParent&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;Node.ParentNode;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NodeParent.RemoveChild(Node);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localxmldoc.Save(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page&nbsp;.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;按钮</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;同步</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;Organization_Synchronize_Click(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">object</span>
    <span style="line-height:1.5;">&nbsp;sender,&nbsp;EventArgs&nbsp;e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建单位</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;根目录页面</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcondition&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">and&nbsp;@id=05010211483776592</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">and&nbsp;@id=0501021148366051</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Synchronize</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">初始化</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;点击初始化按钮后。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSynchronize&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">确定初始化</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Synchronize</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strSynchronize;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;organizationname&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">提示：同步机构&lt;span&gt;杭州市XXXX单位&lt;/span&gt;和&lt;span&gt;杭州市XXX委员会&lt;/span&gt;中所有部门信息以及各部门下所有人员信息，无则增加，有则更新以保持与OA系统数据一致性。是否确定？</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Add.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Back.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeTipArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;点击确定初始化按钮后。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSynchronize&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">初始化</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Synchronize</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strSynchronize;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stradd&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Add.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Back.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">传参数到同步流程方法中，同步OA。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeFlow(strcondition,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">处理特例——直属单位</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReplaceDBUnit();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">重载树</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitTreeByXml();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Save.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Del.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;非根目录页面<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;查找本地节点，判断OAID。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlDocument&nbsp;localxmldoc&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;XmlDocument();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;localxmldoc.Load(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;node&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;localxmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@Oaid&nbsp;=&nbsp;'</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;str&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">and&nbsp;@id&nbsp;=&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strcondition&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">[]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Synchronize</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">同步更新</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;点击同步更新按钮后。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;node&nbsp;</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSynchronize&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">确定同步</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Synchronize</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strSynchronize;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;organizationname&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">提示：同步机构&lt;span&gt;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&lt;/span&gt;中所有部门信息以及各部门下所有人员信息，无则增加，有则更新以保持与OA系统数据一致性。是否确定？</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Synchronize.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;organizationname&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">提示：机构&lt;span&gt;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&lt;/span&gt;为自建机构，在OA系统中不存在，无法进行同步，请返回。</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Add.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Back.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Save.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Del.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeTipArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;点击确定同步按钮后。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSynchronize&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">同步更新</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMorS&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">修改</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Synchronize</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strSynchronize;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stradd&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationDataArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Add.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Back.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Save.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Del.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">传参数到同步流程方法中，同步OA。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeFlow(strcondition,&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString());<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">处理特例——直属单位</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReplaceDBUnit();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">SynchronizeFlow(strcondition,&nbsp;"1",&nbsp;"Result");</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;添加</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;Organization_Add_Click(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">object</span>
    <span style="line-height:1.5;">&nbsp;sender,&nbsp;EventArgs&nbsp;e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DDLOrganizationType.Items.Clear();<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMorS&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">保存</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">MorS</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strMorS;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">建立页面。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationDataArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Synchronize.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Save.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Back.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationName.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">""</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationID.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;System.Guid.NewGuid().ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationOaid.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建单位</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DDLOrganizationType.Items.Add(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;ListItem(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">单位</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DDLOrganizationType.Items.Add(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;ListItem(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">2</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DDLOrganizationType.Items.Add(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;ListItem(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">领导部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">3</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DDLOrganizationType.SelectedValue&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">2</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;保存或修改</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;Organization_Save_Click(Object&nbsp;sender,&nbsp;EventArgs&nbsp;e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblError.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(OrganizationName.Text&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">""</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMorS&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">MorS</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationDataArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Synchronize.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Save.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Back.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblError.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">用户名不能为空！</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;(ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建单位</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">||</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">)&nbsp;</span>
    <span style="line-height:1.5;">&amp;&amp;</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建部门或者领导部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;lsxml</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&lt;?xml&nbsp;version=\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">1.0</span>
    <span style="line-height:1.5;">\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;encoding=\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">utf</span>
    <span style="line-height:1.5;">-</span>
    <span style="line-height:1.5;">8</span>
    <span style="line-height:1.5;">\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;?&gt;&lt;a&gt;&lt;/a&gt;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlDocument&nbsp;tempxmldoc&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;XmlDocument();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempxmldoc.LoadXml(lsxml);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;LocalNode&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;tempxmldoc.DocumentElement;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlElement&nbsp;node&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;tempxmldoc.CreateElement(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">department</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;OrganizationID.Text);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;OrganizationName.Text);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;OrganizationOaid.Text);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode.AppendChild(node);&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNodeList&nbsp;OrganizationNodeList&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;tempxmldoc.SelectNodes(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//a/department</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeOrganization(OrganizationNodeList,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;lsxml</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&lt;?xml&nbsp;version=\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">1.0</span>
    <span style="line-height:1.5;">\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;encoding=\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">utf</span>
    <span style="line-height:1.5;">-</span>
    <span style="line-height:1.5;">8</span>
    <span style="line-height:1.5;">\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;?&gt;&lt;a&nbsp;id=\</span>
    <span style="line-height:1.5;">""</span>
    <span style="line-height:1.5;">&nbsp;+&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;+&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">\</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&gt;&lt;/a&gt;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlDocument&nbsp;tempxmldoc&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;XmlDocument();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempxmldoc.LoadXml(lsxml);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;LocalNode&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;tempxmldoc.DocumentElement;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlElement&nbsp;node&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;tempxmldoc.CreateElement(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">department</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;OrganizationID.Text);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;OrganizationName.Text);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;OrganizationOaid.Text);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">MorS</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">保存</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;DDLOrganizationType.SelectedValue);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node.SetAttribute(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">type</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString());<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LocalNode.AppendChild(node);&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNodeList&nbsp;OrganizationNodeList&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;tempxmldoc.SelectNodes(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//a/department</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SynchronizeOrganization(OrganizationNodeList,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">10</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Synchronize.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationDataArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Back.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblError.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">机构</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;OrganizationName.Text&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;已保存，请返回。</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">重载树</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitTreeByXml();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;删除</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;Organization_Del_Click(Object&nbsp;sender,&nbsp;EventArgs&nbsp;e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DelResultArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Del.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Back.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Del</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">删除</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DeleteOrganization(ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString(),&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">getdelinfo</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;personcount&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strDel&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">确定删除</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">Del</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strDel;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblDelTip.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">该机构下有部门共&nbsp;&lt;span&gt;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;departmentcount&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&lt;/span&gt;&nbsp;个，是否确定删除？</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Del.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lblDelTip.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">对不起，该机构下有人员共&nbsp;&lt;span&gt;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;personcount&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&lt;/span&gt;&nbsp;个，您不能执行删除操作。</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DeleteOrganization(ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString(),&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">delete</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stradd&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建单位</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;stradd;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSynchronize&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">初始化</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DelResultArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Synchronize.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Add.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Del.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Back.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitTreeByXml();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;返回</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;Organization_Back_Click(Object&nbsp;sender,&nbsp;EventArgs&nbsp;e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DDLOrganizationType.Items.Clear();<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strMorS&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">修改</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">MorS</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strMorS;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">建立页面。</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stradd&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSynchronize&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">同步更新</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationDataArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Synchronize.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Add.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Save.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Del.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">true</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建部门或者领导部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationName.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationID.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationOaid.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DDLOrganizationType.Items.Add(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;ListItem(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">子部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">2</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString()&nbsp;</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建子部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">&nbsp;)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationName.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">name</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationID.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">id</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationOaid.Text&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">oaid</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">].ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DDLOrganizationType.Items.Add(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;ListItem(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">子部门</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">,&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">2</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stradd&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">新建单位</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">add</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;stradd;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strSynchronize&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">初始化</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrganizationDataArea.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Save.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Organization_Del.Visible&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">false</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;上移</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;upBtnGroup_Click(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">object</span>
    <span style="line-height:1.5;">&nbsp;sender,&nbsp;EventArgs&nbsp;e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">new</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">none</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;&nbsp;(TreeViewHR.SelectedNodeIndex</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;strnodeindex&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;TreeViewHR.SelectedNodeIndex;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;strnodeindextemp</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;TreeViewHR.SelectedNodeIndex;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;&nbsp;li_flag&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strnodeindex.LastIndexOf(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlDocument&nbsp;xmldoc</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;XmlDocument();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmldoc.Load(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TreeNode&nbsp;node</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;TreeNode();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">(TreeNode)(TreeViewHR.GetNodeFromIndex(TreeViewHR.SelectedNodeIndex).Parent);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;&nbsp;(node.Nodes[</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">].Text</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">(TreeViewHR.GetNodeFromIndex(TreeViewHR.SelectedNodeIndex).Text))&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">return</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">上移</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;ctri&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;Convert.ToInt16(strnodeindex.Substring(li_flag&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">))</span>
    <span style="line-height:1.5;">-</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strnodeindex&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strnodeindex.Substring(</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">,li_flag</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">);&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strnodeindex&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strnodeindex&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;ctri.ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;xmlparentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;xmlcurrentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;xmlcurrentformanode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;&nbsp;(node.GetNodeIndex()</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlparentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">organizes</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlcurrentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID='</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">TreeViewHR.GetNodeFromIndex(TreeViewHR.SelectedNodeIndex).ID.ToString()&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlcurrentformanode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID='</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">TreeViewHR.GetNodeFromIndex(strnodeindex).ID.ToString()</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlparentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID='</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">node.ID.ToString()</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlcurrentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID='</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">TreeViewHR.GetNodeFromIndex(TreeViewHR.SelectedNodeIndex).ID.ToString()</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlcurrentformanode&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID='</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">TreeViewHR.GetNodeFromIndex(strnodeindex).ID.ToString()&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(xmlparentnode</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">&amp;&amp;</span>
    <span style="line-height:1.5;">&nbsp;xmlcurrentnode</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">&amp;&amp;</span>
    <span style="line-height:1.5;">&nbsp;xmlcurrentformanode</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlparentnode.InsertBefore(xmlcurrentnode,xmlcurrentformanode);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmldoc.Save(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">根据HR_Organization.xml中的内容生成树型目录&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitTreeByXml();&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">/*</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;(TreeViewHR.Nodes.Count&gt;=1)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TreeViewHR.SelectedNodeIndex=strnodeindex;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">*/</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;下移</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">public</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;downBtnGroup_Click(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">object</span>
    <span style="line-height:1.5;">&nbsp;sender,&nbsp;EventArgs&nbsp;e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ViewState[</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">new</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">]</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">none</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;&nbsp;(TreeViewHR.SelectedNodeIndex</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;strnodeindex&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;TreeViewHR.SelectedNodeIndex;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">string</span>
    <span style="line-height:1.5;">&nbsp;strnodeindextemp</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;TreeViewHR.SelectedNodeIndex;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;&nbsp;li_flag&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strnodeindex.LastIndexOf(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlDocument&nbsp;xmldoc</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;XmlDocument();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmldoc.Load(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TreeNode&nbsp;node</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;TreeNode();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;node</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">(TreeNode)(TreeViewHR.GetNodeFromIndex(TreeViewHR.SelectedNodeIndex).Parent);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;&nbsp;(node.Nodes[node.Nodes.Count</span>
    <span style="line-height:1.5;">-</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">].Text</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">(TreeViewHR.GetNodeFromIndex(TreeViewHR.SelectedNodeIndex).Text))&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">return</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">int</span>
    <span style="line-height:1.5;">&nbsp;ctri&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;Convert.ToInt16(strnodeindex.Substring(li_flag&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">))</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strnodeindex&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strnodeindex.Substring(</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">,li_flag</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">1</span>
    <span style="line-height:1.5;">);&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strnodeindex&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">&nbsp;strnodeindex&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">&nbsp;ctri.ToString();&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;xmlparentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;xmlcurrentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XmlNode&nbsp;xmlcurrentformanode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;&nbsp;(node.GetNodeIndex()</span>
    <span style="line-height:1.5;">==</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">0</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlparentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//organizes</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlcurrentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID='</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">TreeViewHR.GetNodeFromIndex(TreeViewHR.SelectedNodeIndex).ID.ToString()</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlcurrentformanode&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID='</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">TreeViewHR.GetNodeFromIndex(strnodeindex).ID.ToString()&nbsp;&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">else</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlparentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID='</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">node.ID.ToString()</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlcurrentnode</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID='</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">TreeViewHR.GetNodeFromIndex(TreeViewHR.SelectedNodeIndex).ID.ToString()</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlcurrentformanode&nbsp;</span>
    <span style="line-height:1.5;">=</span>
    <span style="line-height:1.5;">xmldoc.SelectSingleNode(</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">//department[@ID='</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">TreeViewHR.GetNodeFromIndex(strnodeindex).ID.ToString()&nbsp;&nbsp;</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">']</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">if</span>
    <span style="line-height:1.5;">&nbsp;(xmlparentnode</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">&amp;&amp;</span>
    <span style="line-height:1.5;">&nbsp;xmlcurrentnode</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;">&amp;&amp;</span>
    <span style="line-height:1.5;">&nbsp;xmlcurrentformanode</span>
    <span style="line-height:1.5;">!=</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">null</span>
    <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlparentnode.InsertAfter(xmlcurrentnode,xmlcurrentformanode);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmldoc.Save(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page.Server.MapPath(Winstar.Build.HR.Common.AppConfig.ConfigPath</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">HR_Organization</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">+</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">.xml</span>
    <span style="line-height:1.5;">"</span>
    <span style="line-height:1.5;">));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">根据HR_Organization.xml中的内容生成树型目录&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitTreeByXml();&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">/*</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;(TreeViewHR.Nodes.Count&gt;=1)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TreeViewHR.SelectedNodeIndex=strnodeindex;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">*/</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#region</span>
    <span style="line-height:1.5;">&nbsp;Web&nbsp;窗体设计器生成的代码</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">override</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">protected</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;OnInit(EventArgs&nbsp;e)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;CODEGEN:&nbsp;该调用是&nbsp;ASP.NET&nbsp;Web&nbsp;窗体设计器所必需的。<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">//<br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeComponent();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">base</span>
    <span style="line-height:1.5;">.OnInit(e);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">///</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">&lt;summary&gt;</span>
    <span style="line-height:1.5;color:rgb(0,128,0);"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">///</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;设计器支持所需的方法&nbsp;-&nbsp;不要使用代码编辑器<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">///</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;修改此方法的内容。<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">///</span>
    <span style="line-height:1.5;color:rgb(0,128,0);">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);">&lt;/summary&gt;</span>
    <span style="line-height:1.5;color:rgb(128,128,128);"><br></span>
    <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">private</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">void</span>
    <span style="line-height:1.5;">&nbsp;InitializeComponent()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.TreeViewHR.SelectedIndexChange&nbsp;</span>
    <span style="line-height:1.5;">+=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;Microsoft.Web.UI.WebControls.SelectEventHandler(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.TreeViewHR_SelectedIndexChange);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Load&nbsp;</span>
    <span style="line-height:1.5;">+=</span>
    <span style="line-height:1.5;">&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">new</span>
    <span style="line-height:1.5;">&nbsp;System.EventHandler(</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">this</span>
    <span style="line-height:1.5;">.Page_Load);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="line-height:1.5;color:rgb(0,0,255);">#endregion</span>
    <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> }<br></span> 
   </div> 
   <div>
    <span style="line-height:1.5;"><br></span>
   </div> 
   <div>
    <span style="line-height:24px;">本文转自爆牙齿博客园博客，原文链接：http://www.cnblogs.com/yuntian/archive/2007/03/07/666949.html，如需转载请自行联系原作者</span>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
