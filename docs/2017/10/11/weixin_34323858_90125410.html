<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>LINQ 的查询执行何时是延迟执行，何时是立即执行，以及查询的复用 « NotBeCN</title>
  <meta name="description" content="             LINQ&nbsp;的查询执行何时是延迟执行，何时是立即执行，以及查询的复用    延迟执行的经典例子：    我们用&nbsp;select ++i&nbsp;就可以看到在foreach&nbsp;时候，查询才被执行。    public static void Linq99() { ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/11/weixin_34323858_90125410.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">LINQ 的查询执行何时是延迟执行，何时是立即执行，以及查询的复用</h1>
    <p class="post-meta">Oct 11, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;background:rgb(238,238,238);"><strong><span style="font-size:9pt;color:rgb(68,68,68);font-family:Verdana, sans-serif;"><a href="http://blog.joycode.com/ghj/archive/2007/07/03/104998.aspx" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(34,51,85);text-decoration:none;">LINQ&nbsp;</span><span style="color:rgb(34,51,85);font-family:'宋体';text-decoration:none;">的查询执行何时是延迟执行，何时是立即执行，以及查询的复用</span></a></span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:'宋体';">延迟执行的经典例子</span></strong><span style="font-size:9pt;font-family:'宋体';">：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">我们用</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;select ++i&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">就可以看到在</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">foreach&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">时候，查询才被执行。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq99()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = new int[] { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; int i = 0;<br> &nbsp;&nbsp;&nbsp; var q = from n in numbers select ++i;<br> &nbsp;&nbsp;&nbsp; foreach (var v in q)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">输出结果：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">v = 1, i = 1<br> v = 2, i = 2<br> v = 3, i = 3<br> v = 4, i = 4<br> v = 5, i = 5<br> v = 6, i = 6<br> v = 7, i = 7<br> v = 8, i = 8<br> v = 9, i = 9<br> v = 10, i = 10</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">foreach</span><span style="font-size:9pt;font-family:'宋体';">每一个遍历的时候，</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">select</span><span style="font-size:9pt;font-family:'宋体';">出来的值和当前</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">i</span><span style="font-size:9pt;font-family:'宋体';">的值都是一样的。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:'宋体';">立即执行的经典例子：</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq99()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = new int[] { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; int i = 0;<br> &nbsp;&nbsp;&nbsp; var q = (from n in numbers select ++i).ToList();<br> &nbsp;&nbsp;&nbsp; foreach (var v in q)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">执行结果：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">v = 1, i = 10<br> v = 2, i = 10<br> v = 3, i = 10<br> v = 4, i = 10<br> v = 5, i = 10<br> v = 6, i = 10<br> v = 7, i = 10<br> v = 8, i = 10<br> v = 9, i = 10<br> v = 10, i = 10</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">这个例子的代码跟上面延迟执行的例子代码唯一的差别在于多了一个</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">.ToList();<br></span><span style="font-size:9pt;font-family:'宋体';">这也可以证明我们之前提到的原则：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:'宋体';">只有到用的时候才会去执行查询</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">由于</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;.ToList();&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">的存在，在这里就要用到了，所以在这里就执行了查询，而不是在</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">foreach</span><span style="font-size:9pt;font-family:'宋体';">中执行查询。注意，这时候出来的结果是一个数组了．参看后面的几个例子．</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:'宋体';">执行的一个特殊情况：重复执行</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">请看下面例子：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">查询出一个</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">int</span><span style="font-size:9pt;font-family:'宋体';">数组中小于</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">3</span><span style="font-size:9pt;font-family:'宋体';">的数字。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">下面例子中在第一次查询后，对数据源作了修改，然后再作第二次查询，我们可以看到第二次我们不需要再作</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">lowNumbers = from n in numbers where n &lt;= 3 select n;&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">这样的定义，而是直接使用</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;&nbsp;&nbsp; foreach (int n in lowNumbers)</span><span style="font-size:9pt;font-family:'宋体';">。另外这两次的返回结果是不同的，因为我们</span><span style="font-size:9pt;font-family:Verdana, sans-serif;"><br></span><span style="font-size:9pt;font-family:'宋体';">在第一次查询后，对数据源作了修改。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq101()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = new int[] { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; var lowNumbers = from n in numbers where n &lt;= 3 select n;<br> &nbsp;&nbsp;&nbsp; Console.WriteLine("First run numbers &lt;= 3:");<br> &nbsp;&nbsp;&nbsp; foreach (int n in lowNumbers)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(n);</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; 10; i++)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; numbers[i] = -numbers[i];</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;&nbsp;&nbsp; Console.WriteLine("Second run numbers &lt;= 3:");<br> &nbsp;&nbsp;&nbsp; foreach (int n in lowNumbers)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(n);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">输出结果：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">First run numbers &lt;= 3:<br> 1<br> 3<br> 2<br> 0<br> Second run numbers &lt;= 3:<br> -5<br> -4<br> -1<br> -3<br> -9<br> -8<br> -6<br> -7<br> -2<br> 0</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">下面我们再来看几个例子，加深对查询执行的理解：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:'宋体';">重复查询的再一个例子：</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq102()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = new int[] { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; int i = 0;<br> &nbsp;&nbsp;&nbsp; var q = from n in numbers select ++i;<br> &nbsp;&nbsp;&nbsp; foreach (var v in q)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> &nbsp;&nbsp;&nbsp; foreach (var v in q)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">执行结果：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">v = 1, i = 1<br> v = 2, i = 2<br> v = 3, i = 3<br> v = 4, i = 4<br> v = 5, i = 5<br> v = 6, i = 6<br> v = 7, i = 7<br> v = 8, i = 8<br> v = 9, i = 9<br> v = 10, i = 10<br> v = 11, i = 11<br> v = 12, i = 12<br> v = 13, i = 13<br> v = 14, i = 14<br> v = 15, i = 15<br> v = 16, i = 16<br> v = 17, i = 17<br> v = 18, i = 18<br> v = 19, i = 19<br> v = 20, i = 20</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:'宋体';">只执行一次的立即查询：</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq102()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = new int[] { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; int i = 0;<br> &nbsp;&nbsp;&nbsp; var q = (from n in numbers select ++i).ToList();<br> &nbsp;&nbsp;&nbsp; foreach (var v in q)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> &nbsp;&nbsp;&nbsp; foreach (var v in q)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">执行结果：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">v = 1, i = 10<br> v = 2, i = 10<br> v = 3, i = 10<br> v = 4, i = 10<br> v = 5, i = 10<br> v = 6, i = 10<br> v = 7, i = 10<br> v = 8, i = 10<br> v = 9, i = 10<br> v = 10, i = 10<br> v = 1, i = 10<br> v = 2, i = 10<br> v = 3, i = 10<br> v = 4, i = 10<br> v = 5, i = 10<br> v = 6, i = 10<br> v = 7, i = 10<br> v = 8, i = 10<br> v = 9, i = 10<br> v = 10, i = 10</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:'宋体';">那些函数会导致立即执行查询：</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">以下几个扩展函数会导致</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">LINQ</span><span style="font-size:9pt;font-family:'宋体';">会立即执行。并且只执行一次。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">.ToArray();</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">.ToList();</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">.ToDictionary(k =&gt; k);</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">比如：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq102()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = new int[] { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; int i = 0;<br> &nbsp;&nbsp;&nbsp; var q = (from n in numbers select ++i).ToDictionary(k =&gt; k);<br> &nbsp;&nbsp;&nbsp; foreach (var v in q)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> &nbsp;&nbsp;&nbsp; foreach (var v in q)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">输出结果就是：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">v = [1, 1], i = 10<br> v = [2, 2], i = 10<br> v = [3, 3], i = 10<br> v = [4, 4], i = 10<br> v = [5, 5], i = 10<br> v = [6, 6], i = 10<br> v = [7, 7], i = 10<br> v = [8, 8], i = 10<br> v = [9, 9], i = 10<br> v = [10, 10], i = 10<br> v = [1, 1], i = 10<br> v = [2, 2], i = 10<br> v = [3, 3], i = 10<br> v = [4, 4], i = 10<br> v = [5, 5], i = 10<br> v = [6, 6], i = 10<br> v = [7, 7], i = 10<br> v = [8, 8], i = 10<br> v = [9, 9], i = 10<br> v = [10, 10], i = 10</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">小结：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Q</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">：通过上面几个例子，我们该如何理解</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">LINQ</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">的查询何时执行呢？</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">A</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">：</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">LINQ</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">的查询执行遵循以下原则：</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">1</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、一般情况下（除了下面第三条说的情况），</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">LINQ</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">都是延迟执行，原因：以</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">DLINQ</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">为例，越晚被执行，对业务逻辑的理解就越清晰，</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">DLINQ</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">查询对数据库的请求压力越小。编译器对</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">LINQ</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">查询优化可作的事情越多。</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">2</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、由于是延迟执行，也就是调用的时候才去执行。这样调用一次就被执行一次，这样就具备了重复执行的功能，参看之前的几个重复执行的例子。而这个重复执行是不需要再此书写一边查询语句的。</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">3</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、如果查询中我们对查询结果使用了</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;ToArray</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">ToList</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">ToDictionary&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">这些转换成集合的扩展方法。使用这时候出来的对象是一个独立的集合数组，而不是</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">LINQ</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">查询，所以这时候不会出现多次查询，而只是一次查询。</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">即：</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">var q = from n in numbers select ++i ;&nbsp;&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">这样一条语句我们可以认为它记录的不是等号右边的结果，而是记录的等号右边的表达式。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">而</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;&nbsp;&nbsp; var q = (from n in numbers select ++i).ToDictionary(k =&gt; k);&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">这样一条语句我们记录的是等号右边的计算结果，而不是表达式。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">为理解上面说明，我们可以再看两个例子：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq102()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = new int[] { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; int i = 0;<br> &nbsp;&nbsp;&nbsp; var q = from n in numbers select ++i;<br> &nbsp;&nbsp;&nbsp; var qq = q.ToDictionary(k =&gt; k);<br> &nbsp;&nbsp;&nbsp; foreach (var v in q)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> &nbsp;&nbsp;&nbsp; foreach (var v in q)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">输出结果：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">v = 11, i = 11<br> v = 12, i = 12<br> v = 13, i = 13<br> v = 14, i = 14<br> v = 15, i = 15<br> v = 16, i = 16<br> v = 17, i = 17<br> v = 18, i = 18<br> v = 19, i = 19<br> v = 20, i = 20<br> v = 21, i = 21<br> v = 22, i = 22<br> v = 23, i = 23<br> v = 24, i = 24<br> v = 25, i = 25<br> v = 26, i = 26<br> v = 27, i = 27<br> v = 28, i = 28<br> v = 29, i = 29<br> v = 30, i = 30</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">而</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq102()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = new int[] { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; int i = 0;<br> &nbsp;&nbsp;&nbsp; var q = from n in numbers select ++i;<br> &nbsp;&nbsp;&nbsp; var qq = q.ToDictionary(k =&gt; k);<br> &nbsp;&nbsp;&nbsp; foreach (var v in qq)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> &nbsp;&nbsp;&nbsp; foreach (var v in qq)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("v = {0}, i = {1}", v, i);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">输出结果为：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">v = [1, 1], i = 10<br> v = [2, 2], i = 10<br> v = [3, 3], i = 10<br> v = [4, 4], i = 10<br> v = [5, 5], i = 10<br> v = [6, 6], i = 10<br> v = [7, 7], i = 10<br> v = [8, 8], i = 10<br> v = [9, 9], i = 10<br> v = [10, 10], i = 10<br> v = [1, 1], i = 10<br> v = [2, 2], i = 10<br> v = [3, 3], i = 10<br> v = [4, 4], i = 10<br> v = [5, 5], i = 10<br> v = [6, 6], i = 10<br> v = [7, 7], i = 10<br> v = [8, 8], i = 10<br> v = [9, 9], i = 10<br> v = [10, 10], i = 10</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">参考资料：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;"><a href="http://davidhayden.com/blog/dave/archive/2006/06/02/2980.aspx" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(29,88,209);text-decoration:none;">DLinq Query Execution and Object Identity - LINQ Tutorials</span></a></span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;"><a href="http://msdn2.microsoft.com/en-us/vcsharp/aa336746.aspx" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(29,88,209);text-decoration:none;">101 LINQ Samples</span></a></span></p> 
   <div style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;border-width:1pt medium medium;border-style:solid none none;border-top-color:rgb(221,221,221);"> 
    <p align="left" style="border:medium none;"><span style="font-size:7pt;color:rgb(170,170,170);font-family:'宋体';">发表于</span><span style="font-size:7pt;color:rgb(170,170,170);font-family:Verdana, sans-serif;">&nbsp;@&nbsp;<a title="permalink" href="http://blog.joycode.com/ghj/archive/2007/07/03/104998.aspx" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(34,51,85);text-decoration:none;">16:21</span></a>&nbsp;|&nbsp;<a title="comments, pingbacks, trackbacks" href="http://blog.joycode.com/ghj/archive/2007/07/03/104998.aspx#FeedBack" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(34,51,85);text-decoration:none;">(</span><span style="color:rgb(34,51,85);font-family:'宋体';text-decoration:none;">阅读</span><span style="color:rgb(34,51,85);text-decoration:none;">:4258;</span><span style="color:rgb(34,51,85);font-family:'宋体';text-decoration:none;">评论</span><span style="color:rgb(34,51,85);text-decoration:none;">:2)</span></a></span></p> 
   </div> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;background:rgb(238,238,238);"><strong><span style="font-size:9pt;color:rgb(68,68,68);font-family:Verdana, sans-serif;"><a href="http://blog.joycode.com/ghj/archive/2007/07/03/104979.aspx" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(34,51,85);text-decoration:none;">LINQ</span><span style="color:rgb(34,51,85);font-family:'宋体';text-decoration:none;">的经典例子</span><span style="color:rgb(34,51,85);text-decoration:none;">-Where</span><span style="color:rgb(34,51,85);font-family:'宋体';text-decoration:none;">，</span><span style="color:rgb(34,51,85);text-decoration:none;">Select</span><span style="color:rgb(34,51,85);font-family:'宋体';text-decoration:none;">、</span><span style="color:rgb(34,51,85);text-decoration:none;">SelectMany</span><span style="color:rgb(34,51,85);font-family:'宋体';text-decoration:none;">、</span><span style="color:rgb(34,51,85);text-decoration:none;">SkipWhile</span><span style="color:rgb(34,51,85);font-family:'宋体';text-decoration:none;">子句中使用数组索引</span></a></span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Where&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">子句的用法</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">我们除了可以如下方式书写带</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Where</span><span style="font-size:9pt;font-family:'宋体';">子句的</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">LINQ</span><span style="font-size:9pt;font-family:'宋体';">外：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">from p in products&nbsp;where p.UnitsInStock &gt; 0 &amp;&amp; p.UnitPrice &gt; 3.00M&nbsp;select p;</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">还可以对数组（所有实现了</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">IEnumerable</span><span style="font-size:9pt;font-family:'宋体';">接口的对象都可以）的实体使用</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;Where&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">扩展方法。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">把一个查询语句写成多个扩展函数的方式，这其实是编译器处理查询语句的方法，比如下面的查询语句：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">int[] arr = new int[] { 8, 5, 89, 3, 56, 4, 1, 58 };<br> var m = from n in arr where n &lt; 5 orderby n select n;</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">编译器在编译后，替我们产生的代码等价于如下的代码：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">IOrderedSequence&lt;int&gt; m = arr.Where&lt;int&gt;(delegate (int n) {<br> &nbsp;&nbsp;&nbsp; return (n &lt; 5);<br> }).OrderBy&lt;int, int&gt;(delegate (int n) {<br> &nbsp;&nbsp;&nbsp; return n;<br> });</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">下面我们来看一个使用</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Where</span><span style="font-size:9pt;font-family:'宋体';">扩展方法的例子</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">:</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">我们有一个字符串数组</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">,</span><span style="font-size:9pt;font-family:'宋体';">一次是</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">0</span><span style="font-size:9pt;font-family:'宋体';">到</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">9</span><span style="font-size:9pt;font-family:'宋体';">的英文单词</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">,</span><span style="font-size:9pt;font-family:'宋体';">我们查询出这</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">10</span><span style="font-size:9pt;font-family:'宋体';">个字符的长度比它所在数组的位置</span>&nbsp;<span style="font-size:9pt;font-family:'宋体';">这两个数字比较小的英文单词</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">.</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">这个查询可能有些绕口</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">,</span><span style="font-size:9pt;font-family:'宋体';">你可以先看下面这些代码</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">:</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void LinqDemo01()<br> {<br> &nbsp;&nbsp;&nbsp; string[] digits = { "zero", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine" };<br> &nbsp;&nbsp;&nbsp; var shortDigits = digits.Where((dd, aa) =&gt; dd.Length &lt; aa);<br> &nbsp;&nbsp;&nbsp; Console.WriteLine("Short digits:");<br> &nbsp;&nbsp;&nbsp; foreach (var d in shortDigits)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("The word {0} is shorter than its value.", d);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">输出结果：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">Short digits:<br> The word five is shorter than its value.<br> The word six is shorter than its value.<br> The word seven is shorter than its value.<br> The word eight is shorter than its value.<br> The word nine is shorter than its value.</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">下面我们就来分析上述代码中最核心的代码：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">digits.Where((dd, aa) =&gt; dd.Length &lt; aa);</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">这行代码都赶了些什么？</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">1</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Where</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">子句其实是用扩展方法来实现的</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">如果你对扩展方法不熟悉，请先看我之前的几篇博客：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;"><a href="http://blog.joycode.com/ghj/archive/2007/06/06/103872.aspx" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(29,88,209);text-decoration:none;">C#3.0&nbsp;</span><span style="color:rgb(29,88,209);font-family:'宋体';text-decoration:none;">中的扩展方法</span><span style="color:rgb(29,88,209);text-decoration:none;">&nbsp;(Extension Methods)</span></a></span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;"><a href="http://blog.joycode.com/ghj/archive/2007/06/06/103894.aspx" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(29,88,209);text-decoration:none;">C#3.0&nbsp;</span><span style="color:rgb(29,88,209);font-family:'宋体';text-decoration:none;">中使用扩展方法来扩展接口</span></a></span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;"><a href="http://blog.joycode.com/ghj/archive/2007/06/12/104149.aspx" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(29,88,209);text-decoration:none;">Orcas Beta1&nbsp;</span><span style="color:rgb(29,88,209);font-family:'宋体';text-decoration:none;">对多个同名扩展方法的处理逻辑</span></a></span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">微软替我们实现的</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;Where&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">子句对应的扩展函数实际是如下的定义</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">:</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">namespace System.Linq<br> {<br><span style="color:#008000;">&nbsp;&nbsp;&nbsp; public delegate TResult Func&lt;TArg0, TArg1, TResult&gt;(TArg0 arg0, TArg1 arg1);</span><span style="color:#808000;"><br></span>&nbsp;&nbsp;&nbsp; public static class Enumerable<br> &nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static IEnumerable&lt;TSource&gt; Where&lt;TSource&gt;(this IEnumerable&lt;TSource&gt; source, Func&lt;TSource, bool&gt; predicate);<br><span style="color:#FF0000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static IEnumerable&lt;TSource&gt; Where&lt;TSource&gt;(this IEnumerable&lt;TSource&gt; source, Func&lt;TSource, int, bool&gt; predicate);<br></span>&nbsp;&nbsp;&nbsp; }<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">其中红色字体的那个扩展函数，就是我们上面代码实际使用的扩展函数。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">我们这个扩展函数参数：</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Func&lt;TSource, int, bool&gt; predicate&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">的定义看上面代码的绿色</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">delegate&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">代码。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">2</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Where&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">子句参数书写的是</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Lambda&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">表达式</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">如果你不清楚什么是</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Lambda&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">表达式，你可以参看我之前的博客：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;"><a href="http://blog.joycode.com/ghj/archive/2007/06/12/104122.aspx" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(29,88,209);text-decoration:none;">C# 3.0&nbsp;</span><span style="color:rgb(29,88,209);font-family:'宋体';text-decoration:none;">的</span><span style="color:rgb(29,88,209);text-decoration:none;">Lambda</span><span style="color:rgb(29,88,209);font-family:'宋体';text-decoration:none;">表达式（</span><span style="color:rgb(29,88,209);text-decoration:none;">Lambda Expressions</span><span style="color:rgb(29,88,209);font-family:'宋体';text-decoration:none;">）</span></a></span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">(dd, aa) =&gt; dd.Length &lt; aa&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">就相当于</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;C# 2.0&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">的匿名函数。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">LINQ</span><span style="font-size:9pt;font-family:'宋体';">中所有关键字比如</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;Select</span><span style="font-size:9pt;font-family:'宋体';">，</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">SelectMany</span><span style="font-size:9pt;font-family:'宋体';">，</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;Count</span><span style="font-size:9pt;font-family:'宋体';">，</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;All&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">等等其实都是用扩展方法来实现的。上面的用法同样也适用于这些关键字子句。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">3</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、这个</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Where</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">子句中</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Lambda&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">表达式第二个参数是数组索引，我们可以在</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Lambda&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">表达式内部使用数组索引。来做一些复杂的判断。</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">具有数组索引的</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">LINQ</span><span style="font-size:9pt;font-family:'宋体';">关键字除了</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Where</span><span style="font-size:9pt;font-family:'宋体';">还以下几个</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Select</span><span style="font-size:9pt;font-family:'宋体';">，</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">SelectMany</span><span style="font-size:9pt;font-family:'宋体';">，</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;Count</span><span style="font-size:9pt;font-family:'宋体';">，</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;All</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">我们下面就来依次举例</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Select&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">子句使用数组索引的例子</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">下面代码有一个整数数组，我们找出这个数字是否跟他在这个数组的位置一样</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void LinqDemo01()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; var numsInPlace = numbers.Select((num, index) =&gt; new { Num = num, InPlace = (num == index) });<br> &nbsp;&nbsp;&nbsp; Console.WriteLine("Number: In-place?");<br> &nbsp;&nbsp;&nbsp; foreach (var n in numsInPlace)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("{0}: {1}", n.Num, n.InPlace);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">输出结果：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">Number: In-place?<br> 5: False<br> 4: False<br> 1: False<br> 3: True<br> 9: False<br> 8: False<br> 6: True<br> 7: True<br> 2: False<br> 0: False</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">其中我们用到的这个</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Select</span><span style="font-size:9pt;font-family:'宋体';">子句对应的扩展函数定义，以及其中</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Func&lt;TSource, int, TResult&gt;</span><span style="font-size:9pt;font-family:'宋体';">委托定义如下：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static IEnumerable&lt;TResult&gt; Select&lt;TSource, TResult&gt;(this IEnumerable&lt;TSource&gt; source, Func&lt;TSource, int, TResult&gt; selector);</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public delegate TResult Func&lt;TArg0, TArg1, TResult&gt;(TArg0 arg0, TArg1 arg1);</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">SelectMany&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">子句使用数组索引的例子</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">几个句子组成的数组，我们希望把这几个句子拆分成单词，并显示每个单词在那个句子中。查询语句如下：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Demo01()<br> {<br> &nbsp;&nbsp;&nbsp; string[] text = { "Albert was here",&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Burke slept late",&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Connor is happy" };<br> &nbsp;&nbsp;&nbsp; var tt = text.SelectMany((s, index) =&gt; from ss in s.Split(' ') select new { Word = ss, Index = index });<br> &nbsp;&nbsp;&nbsp; foreach (var n in tt)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("{0}:{1}", n.Word,n.Index);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">结果：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">Albert:0<br> was:0<br> here:0<br> Burke:1<br> slept:1<br> late:1<br> Connor:2<br> is:2<br> happy:2</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">SkipWhile&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">子句使用数组索引的例子</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">SkipWhile&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">意思是一直跳过数据，一直到满足表达式的项时，才开始返回数据，而不管之后的项是否仍然满足表达式，需要注意他跟</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Where</span><span style="font-size:9pt;font-family:'宋体';">是不一样的，</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Where</span><span style="font-size:9pt;font-family:'宋体';">是满足条件的记录才返回，</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">SkipWhile&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">是找到一个满足条件的，然后后面的数据全部返回。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">下面例子返回一个整数数组中，这个整数比他自身在这个数组的位置大于等于的第一个位置以及之后的数据。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq27()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; var laterNumbers = numbers.SkipWhile((n, index) =&gt; n &gt;= index);<br> &nbsp;&nbsp;&nbsp; Console.WriteLine("All elements starting from first element less than its position:");<br> &nbsp;&nbsp;&nbsp; foreach (var n in laterNumbers)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(n);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">输出结果：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">All elements starting from first element less than its position:<br> 1<br> 3<br> 9<br> 8<br> 6<br> 7<br> 2<br> 0</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">First&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">FirstOrDefault</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Any</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">All</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">、</span></strong><strong><span style="font-size:9pt;font-family:Verdana, sans-serif;">Count&nbsp;</span></strong><strong><span style="font-size:9pt;font-family:'宋体';">子句</span></strong></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">注意：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;"><a href="http://msdn2.microsoft.com/en-us/vcsharp/aa336746.aspx" rel="nofollow" style="color:rgb(100,102,179);"><span style="color:rgb(29,88,209);text-decoration:none;">101 LINQ Samples</span></a>&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">中</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;First - Indexed</span><span style="font-size:9pt;font-family:'宋体';">、</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">FirstOrDefault - Indexed</span><span style="font-size:9pt;font-family:'宋体';">、</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;Any - Indexed</span><span style="font-size:9pt;font-family:'宋体';">、</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">All - Indexed</span><span style="font-size:9pt;font-family:'宋体';">、</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Count - Indexed&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">这五个例子在</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">&nbsp;Orcas Beta1</span><span style="font-size:9pt;font-family:'宋体';">中已经不在可用，即下面代码是错误的。</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:12pt;font-family:'宋体';">public void Linq60() {<br> &nbsp;&nbsp;&nbsp;&nbsp;int[] numbers = { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp;&nbsp;int evenNum = numbers.First((num, index) =&gt; (num % 2 == 0) &amp;&amp; (index % 2 == 0));<br> &nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine("{0} is an even number at an even position within the list.", evenNum);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:12pt;font-family:'宋体';">public void Linq63() {<br> &nbsp;&nbsp;&nbsp;&nbsp;double?[] doubles = { 1.7, 2.3, 4.1, 1.9, 2.9 };<br> &nbsp;&nbsp;&nbsp;&nbsp;double? num = doubles.FirstOrDefault((n, index) =&gt; (n &gt;= index - 0.5 &amp;&amp; n &lt;= index + 0.5));<br> &nbsp;&nbsp;&nbsp;&nbsp;if (num != null)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine("The value {1} is within 0.5 of its index position.", num);<br> &nbsp;&nbsp;&nbsp;&nbsp;else<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Console.WriteLine("There is no number within 0.5 of its index position.", num);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:12pt;font-family:'宋体';">public void Linq68() {&nbsp;<br> &nbsp;&nbsp;&nbsp;int[] numbers = { -9, -4, -8, -3, -5, -2, -1, -6, -7 };&nbsp;<br> &nbsp;&nbsp;&nbsp;bool negativeMatch = numbers.Any((n, index) =&gt; n == -index);&nbsp;<br> &nbsp;&nbsp;&nbsp;Console.WriteLine("There is a number that is the negative of its index: {0}", negativeMatch);&nbsp;<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:12pt;font-family:'宋体';">public void Linq71() {&nbsp;<br> &nbsp;&nbsp;&nbsp;int[] lowNumbers = { 1, 11, 3, 19, 41, 65, 19 };&nbsp;<br> &nbsp;&nbsp;&nbsp;int[] highNumbers = { 7, 19, 42, 22, 45, 79, 24 };&nbsp;<br> &nbsp;&nbsp;&nbsp;bool allLower = lowNumbers.All((num, index) =&gt; num &lt; highNumbers[index]);&nbsp;<br> &nbsp;&nbsp;&nbsp;Console.WriteLine("Each number in the first list is lower than its counterpart in the second list: {0}", allLower);&nbsp;<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:12pt;font-family:'宋体';">public void Linq75() {&nbsp;<br> &nbsp;&nbsp;&nbsp;int[] numbers = { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp;int oddEvenMatches = numbers.Count((n, index) =&gt; n % 2 == index % 2);<br> &nbsp;&nbsp;&nbsp;Console.WriteLine("There are {0} numbers in the list whose odd/even status " +&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"matches that of their position.", oddEvenMatches);&nbsp;<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:'宋体';">要实现这个功能，可以用</span><span style="font-size:9pt;font-family:Verdana, sans-serif;">Where&nbsp;</span><span style="font-size:9pt;font-family:'宋体';">子句，如下：</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq60()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; int evenNum = numbers.Where((num,index) =&gt;( num % 2 == 0 &amp;&amp; index %2 == 0) ).First();<br> &nbsp;&nbsp;&nbsp; Console.WriteLine("{0} is an even number at an even position within the list.", evenNum);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq63()<br> {<br> &nbsp;&nbsp;&nbsp; double?[] doubles = { 1.7, 2.3, 4.1, 1.9, 2.9 };<br> &nbsp;&nbsp;&nbsp; double? num = doubles.Where((n, index) =&gt; (n &gt;= index - 0.5 &amp;&amp; n &lt;= index + 0.5)).FirstOrDefault();<br> &nbsp;&nbsp;&nbsp; if (num != null)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("The value {1} is within 0.5 of its index position.", num);<br> &nbsp;&nbsp;&nbsp; else<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine("There is no number within 0.5 of its index position.", num);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq68()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = { -9, -4, -8, -3, -5, -2, -1, -6, -7 };<br> &nbsp;&nbsp;&nbsp; bool negativeMatch = numbers.Where((n, index) =&gt; n == -index).Any();<br> &nbsp;&nbsp;&nbsp; Console.WriteLine("There is a number that is the negative of its index: {0}", negativeMatch);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq71()<br> {<br> &nbsp;&nbsp;&nbsp; int[] lowNumbers = { 1, 11, 3, 19, 41, 65, 19 };<br> &nbsp;&nbsp;&nbsp; int[] highNumbers = { 7, 19, 42, 22, 45, 79, 24 };<br> &nbsp;&nbsp;&nbsp; bool allLower = lowNumbers.Where((num, index) =&gt; num &lt; highNumbers[index]).All(n =&gt; true);<br> &nbsp;&nbsp;&nbsp; Console.WriteLine("Each number in the first list is lower than its counterpart in the second list: {0}", allLower);<br> }</span></p> 
   <p align="left" style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;"><span style="font-size:9pt;font-family:Verdana, sans-serif;">public static void Linq75()<br> {<br> &nbsp;&nbsp;&nbsp; int[] numbers = { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };<br> &nbsp;&nbsp;&nbsp; int oddEvenMatches = numbers.Where((n, index) =&gt; n % 2 == index % 2).Count();<br> &nbsp;&nbsp;&nbsp; Console.WriteLine("There are {0} numbers in the list whose odd/even status " +<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "matches that of their position.", oddEvenMatches);<br> }</span></p> 
   <p style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:21px;">&nbsp;</p> 
   <p><font color="#393939"><span style="font-size:14px;line-height:21px;">本文转自温景良博客园博客，原文链接：http://www.cnblogs.com/wenjl520/archive/2008/10/28/1321730.html</span></font><span style="font-size:14px;line-height:21px;color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
