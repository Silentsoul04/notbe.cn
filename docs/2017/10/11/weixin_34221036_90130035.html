<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Gerrit上分支操作记录（创建分支、删除分支） « NotBeCN</title>
  <meta name="description" content="                  Git分支对于一个项目的代码管理而言，是十分重要的！许多久用git的朋友可能已经掌握的很牢固了，但对于一些初涉git的童鞋来说，可能还不是很熟悉。 在此，我将自己的一些操作经历做一梳理，希望能帮助到有用到的朋友们。     gerrit分支操作常用的命令可以参考：http://...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/11/weixin_34221036_90130035.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Gerrit上分支操作记录（创建分支、删除分支）</h1>
    <p class="post-meta">Oct 11, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;line-height:19.5px;"> 
    <p style="line-height:1.5;">Git分支对于一个项目的代码管理而言，是十分重要的！许多久用git的朋友可能已经掌握的很牢固了，但对于一些初涉git的童鞋来说，可能还不是很熟悉。<br> 在此，我将自己的一些操作经历做一梳理，希望能帮助到有用到的朋友们。</p> 
    <p style="line-height:1.5;">gerrit分支操作常用的命令可以参考：<a href="http://www.cnblogs.com/kevingrace/p/5690820.html" rel="nofollow" style="color:rgb(7,93,179);">http://www.cnblogs.com/kevingrace/p/5690820.html</a></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,0,255);">1）首先，利用gitlab进行创建分支</span><br> 登陆gitlab，创建组test，在这个组上创建工程apptest，然后让这个工程里添加内容<br> 注意：在添加内容的使用，我们可以自定义分支名，这个分支就是我们想要创建的分支<br> 如下截图：</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720155410919-1008612422.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720155454029-241341154.png" alt="" style="border:0px;">&nbsp;</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720155528201-646742790.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">这样，就创建了三个分支：master（默认），test，dev</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(128,0,128);"><strong>特别注意：</strong></span></p> 
    <p style="line-height:1.5;">后面创建的分支都是以前面当前分支为源创建的</p> 
    <p style="line-height:1.5;">所以新创建分支的文件都会包括前面的分支的文件，应该将和前面分支重复的文件删除！</p> 
    <p style="line-height:1.5;">如：</p> 
    <p style="line-height:1.5;">master分支下是testfile文件</p> 
    <p style="line-height:1.5;">test分支下是testfile文件、123文件，应该将testfile文件删除</p> 
    <p style="line-height:1.5;">dev分支下是testfile文件、123文件、zhonghon文件，应该将testfile文件和zhonghon文件删除</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">如下：</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720155817263-1596494802.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720155837372-691998717.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720155849701-386964517.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">在linux客户机上操作分支，修改分支下的代码并上传到远程的git分支上</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ &nbsp;git clone&nbsp;git@103.10.86.30:test/apptest.git</p> 
    <p style="line-height:1.5;">[gerrit@115~]$&nbsp;git branch -av &nbsp; &nbsp; &nbsp; &nbsp; ＃查看当前分支情况，发现了上面在gitlab里面创建的三个分组master，dev，test</p> 
    <p style="line-height:1.5;">*&nbsp;master 1c2ecde 12 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ＃发现当前在master分支下（＊指向master）<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 6eae416 234<br> remotes/origin/master 1c2ecde 12<br> remotes/origin/test d5b51b9 Delete zhonghogn</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ vim .gitrevirw</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ vim .testr.conf</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ git add .</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ git commit -m “add on master"</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ git push -u origin master &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;＃提交到master分支下，查看gitlab上apptest工程下的master分支，已经有这两个文件</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">接着选择一个非master的分支，如dev分支，修改里面的代码</p> 
    <p style="line-height:1.5;">[gerrit@115~]$&nbsp;git branch dev remotes/origin/dev &nbsp; &nbsp; &nbsp;＃先将远程gitlab上创建的分支在本地别名化</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ git checkout dev &nbsp; &nbsp; &nbsp; &nbsp; ＃使用git checkout命令切换到dev分支下<br> Switched to branch 'dev'<br> [gerrit@115~]$ git branch -av &nbsp; &nbsp; &nbsp; &nbsp;＃查看当前分支，发现本地有了dev分支了（上面设置过的分支别名）<br><strong><span style="line-height:1.5;color:rgb(255,0,0);">*&nbsp;</span>dev</strong>&nbsp;6eae416 234<br><strong>master</strong>&nbsp;1c2ecde 12<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 6eae416 234<br> remotes/origin/master 1c2ecde 12<br> remotes/origin/test d5b51b9 Delete zhonghogn</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ vim .gitrevirw &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;＃修改dev分支下的代码 &nbsp;</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ vim .testr.conf</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ git add .</p> 
    <p style="line-height:1.5;">[gerrit@115~]$ git commit -m “add on dev"</p> 
    <p style="line-height:1.5;">[gerrit@115~]$&nbsp;<span style="line-height:1.5;color:rgb(255,0,255);"><strong>git push -u&nbsp;<span style="line-height:1.5;color:rgb(0,0,255);">origin</span>&nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">dev</span>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</strong><span style="line-height:1.5;color:rgb(0,0,0);">&nbsp;＃注意，这里提交到dev分支下</span></span><br> Counting objects: 5, done.<br> Delta compression using up to 32 threads.<br> Compressing objects: 100% (4/4), done.<br> Writing objects: 100% (4/4), 535 bytes, done.<br> Total 4 (delta 0), reused 0 (delta 0)<br> To git@103.10.86.30:test/apptest.git<br> 7a4b6e6..6eae416 dev -&gt; dev<br> Branch dev set up to track remote branch dev from origin.</p> 
    <p style="line-height:1.5;">git push -u origin dev<br> Counting objects: 5, done.<br> Delta compression using up to 32 threads.<br> Compressing objects: 100% (4/4), done.<br> Writing objects: 100% (4/4), 535 bytes, done.<br> Total 4 (delta 0), reused 0 (delta 0)<br> To git@103.10.86.30:test/apptest.git<br> 7a4b6e6..6eae416 dev -&gt; dev<br> Branch dev set up to track remote branch dev from origin.</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);"><strong>这样就能push到远程的remotes/origin/dev 上了，去gitlab上看看dev分支下已经有了这两个文件.gitreview和.testr.conf</strong></span></p> 
    <p style="line-height:1.5;">如下：</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720160735607-5645398.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">其他的分支如上面gitlab里的test分支，要想弄到本地，操作和上面的dev分支操作一样</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,128,128);"><strong>＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊</strong></span></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">线上部署了gerrit+gitlab环境（代码同步），将git代码放到上面进行维护管理了！</p> 
    <p style="line-height:1.5;">应开发同事要求，要在他们的项目下创建除master默认分支之外的其他分支</p> 
    <p style="line-height:1.5;">在gerrit上创建分支，这里我总结了下面两种情况的操作，在此做一详细记录：</p> 
    <p style="line-height:1.5;">&nbsp;(1)</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,0,0);font-size:16px;"><strong>第一种情况：gerrit上还没有创建项目</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,0,0);font-size:16px;"><strong>《gerrit上的项目最好是从gitlab上git clone --bare过来，并且项目不要为空》</strong></span></p> 
    <p style="line-height:1.5;">思路：</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(51,153,102);"><strong>先在gitlab上创建分支（上面截图），然后在linux服务器（这里选择gerrit本机）git clone下载gitlab里的项目（如上面的apptest）</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(51,153,102);"><strong>最后将整个项目发布到gerrit上</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(51,153,102);"><strong>关于怎么在gerrit上设置项目，大家可参考我的另一片博客，里面有详细介绍（<a href="http://www.cnblogs.com/kevingrace/p/5651447.html" rel="nofollow" style="color:rgb(7,93,179);">http://www.cnblogs.com/kevingrace/p/5651447.html</a>）</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);"><strong>《注意，上面在新分支下添加的.gitreview文件一定要有，不然就不能使用git review命令提交代码审核了，具体上面参考的另一篇博客中有说明》</strong></span></p> 
    <p style="line-height:1.5;">在gerrit的一个普通用户如wangshibo下操作：</p> 
    <p style="line-height:1.5;">如果修改apptest项目的非master分支下的代码，如上面的dev分支</p> 
    <p style="line-height:1.5;">用 gerrit用户在 Gerrit 上创建 test-project1 项目<br> 要知道 review 是在 gerrit 上，而 gerrit 上现在是没有项目的，想让 gitlab 上的项目能在 gerrit 上 review 的话，必须在 gerrit 上创建相同的项目，并有相同的仓库文件.</p> 
    <p style="line-height:1.5;">用 gerrit用户在 Gerrit 上创建 apptest 项目<br> [gerrit@115]$ ssh-gerrit gerrit create-project apptest &nbsp; &nbsp; &nbsp;＃这时候gerrit上其实已经有apptest项目了<br> &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br> ssh-gerrit是别名<br> [gerrit@115r ~]$ cat ~/.bashrc&nbsp;<br> # .bashrc</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;"># Source global definitions<br> if [ -f /etc/bashrc ]; then<br> . /etc/bashrc<br> fi<br> alias ssh-gerrit='ssh -p 29418 -i ~/.ssh/id_rsa 103.10.86.30 -l gerrit'&nbsp;<br> # User specific aliases and functions<br> &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</p> 
    <p style="line-height:1.5;">虽然上面创建了apptest项目，并且gerrit界面里已经有这个项目，但是个空目录<br> 我们需要将Gitlab上的apptest项目发布到gerrit上<br> 在此需要用到git clone –bare 命令<br> [gerrit@115]$ cd /home/gerrit/gerrit_site/git/ &nbsp; &nbsp; &nbsp; &nbsp;#即登陆到gerrit安装目录的git下<br> [gerrit@115 git]$ rm -fr apptest.git<br> [gerrit@115 git]$ git clone --bare git@103.10.86.30:test/apptest.git<br> [gerrit@115 git]$ ls<br> All-Projects.git All-Users.git apptest.git&nbsp;<br> [gerrit@115 git]$ cd apptest.git/&nbsp;<br> [gerrit@115 git]$ ls &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;＃即test-project1工程和gerrit里默认的All-Projects.git工程结构是一样的了<br> branches config description HEAD hooks info objects packed-refs refs</p> 
    <p style="line-height:1.5;"><br> 登陆gerrit界面，发现apptest工程已经创建了。</p> 
    <p style="line-height:1.5;">&nbsp;<img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720224019404-1352676375.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720224232201-1065414485.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">接着修改非master分支，比如dev分支的代码并提交到gerrit里审核</p> 
    <p style="line-height:1.5;">[root@115~]＃ su － wangshibo &nbsp; &nbsp;＃切换到gerrit的用户用户wangshibo下</p> 
    <p style="line-height:1.5;">[wangshibo@115~]$&nbsp;git branch -av &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;＃查看本地的分支结构</p> 
    <p style="line-height:1.5;">* master 1c2ecde 12<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 6eae416 234<br> remotes/origin/master 1c2ecde 12<br> remotes/origin/test d0ef218 444</p> 
    <p style="line-height:1.5;">[wangshibo@115~]$&nbsp;git branch dev remotes/origin/dev &nbsp; &nbsp;将远程分支本地别名化</p> 
    <p style="line-height:1.5;">[wangshibo@115~]$ git checkout dev &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 切换到dev分支下</p> 
    <p style="line-height:1.5;">[wangshibo@115~]$ vim haha</p> 
    <p style="line-height:1.5;">[wangshibo@115~]$git add haha</p> 
    <p style="line-height:1.5;">[wangshibo@115~]$git commit -m "23232323"</p> 
    <p style="line-height:1.5;">[wangshibo@115~]$git review dev &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #提交代码审核的时候，注意要指定提交到分支dev上审核</p> 
    <p style="line-height:1.5;">然后用wangshibo用户登录gerrit，进行审核</p> 
    <p style="line-height:1.5;">审核通过后，通过apptest的dev分支的gitweb就能查看到提交的代码，如下：</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720170111560-369867749.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720170134372-1662613614.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">&nbsp;<img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720170203357-2056712948.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720170212529-1061227943.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">Gerrit里面分支代码审核通过后，会自动同步到Gitlab上相应工程的分支下的</p> 
    <p style="line-height:1.5;">也就是说：Gerrit到Gitlab的同步策略包含所有的分支！</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">***************************************************************************</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,0,0);font-size:16px;"><strong>第二种情况：gerrit上已经创建好了项目，后续创建分支并插入到gerrit的项目里：</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,0,0);font-size:16px;">【gerrit上对应项目的access的refs/heads/*的“push”权限可以运行推送代码和分支到gerrit上；“Create Reference”权限运行创建分支；】</span></p> 
    <p style="line-height:1.5;">首先在gerrit界面创建分支（这里新创建分支ops），如下：</p> 
    <p style="line-height:1.5;">管理员帐号登陆gerrit，点击apptest项目的Branches-&gt;Create Branch &nbsp;(默认的initial Revision是HEAD)</p> 
    <p style="line-height:1.5;">刚创建后，会发现新分支和mater分支的Revision一致，HEAD指针是一致的</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720230509888-1023681417.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">接着在本地git clone把代码重新克隆下来，</p> 
    <p style="line-height:1.5;">比如上面在gerrit里已经创建好了apptest项目，将这个项目clone到本地</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720230132763-1980174786.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">[gerrit@115～ ]$&nbsp;git clone ssh://gerrit@103.10.86.30:29418/apptest &amp;&amp; scp -p -P 29418 gerrit@103.10.86.30:hooks/commit-msg apptest/.git/hooks/</p> 
    <p style="line-height:1.5;">[gerrit@115～ ]$ cd apptest</p> 
    <p style="line-height:1.5;">[gerrit@115～ apptest]$ git branch -av &nbsp; &nbsp; &nbsp; &nbsp; ＃查看分支情况，已经可以发现gerrit界面里创建的新分支ops<br><span style="line-height:1.5;color:rgb(255,0,0);"><strong>*</strong>&nbsp;</span>master 486e140 Merge "123" &nbsp; &nbsp; &nbsp; &nbsp; ＃当前在master分支下<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 27a1d5c 343434<br><strong><span style="line-height:1.5;color:rgb(0,0,255);">remotes/origin/master</span>&nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">486e140 Merge "123"</span>&nbsp;&nbsp; &nbsp; ＃新分支刚创建时，跟当前所在分支的ID是一致的</strong><br><strong><span style="line-height:1.5;color:rgb(0,0,255);">remotes/origin/ops</span>&nbsp;<span style="line-height:1.5;color:rgb(0,128,0);">486e140 Merge "123"</span></strong><br> remotes/origin/test d0ef218 444</p> 
    <p style="line-height:1.5;">[gerrit@115～ apptest]$&nbsp;<span style="line-height:1.5;color:rgb(255,102,0);"><strong>git checkout</strong></span>&nbsp;-b ops remotes/origin/ops &nbsp; &nbsp; ＃将新建分支在本地别名化，并<span style="line-height:1.5;color:rgb(255,102,0);"><strong>切换进去</strong></span><br> Branch ops set up to track remote branch ops from origin.<br> Switched to a new branch 'ops'<br> [gerrit@115～ apptest]$ git branch -av &nbsp; &nbsp; &nbsp;再查看，发现当前分支就是ops了<br> master 486e140 Merge "123"<br><span style="line-height:1.5;color:rgb(255,0,0);"><strong>*</strong></span>&nbsp;ops 486e140 Merge "123"<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 27a1d5c 343434<br><strong>remotes/origin/master 486e140 Merge "123"</strong><br><strong>remotes/origin/ops 486e140 Merge "123"</strong><br> remotes/origin/test d0ef218 444</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);"><strong>千万记住一点：：</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);"><strong>新分支创建后，是和创建时的当前所在分支下的内容是一致的。</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);"><strong>切换到新建分之以后，如果不清空当前内容，直接push上去，那该分支代码和你切换之前的分支是一样的。</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);"><strong>所以要删除新分支里的内容，然后再push提交，提交后查看分支情况，就会发现新建分支和之前的分支的 Revision指向就不一样了，如下：</strong></span></p> 
    <p style="line-height:1.5;">[gerrit@115～apptest]$ rm -rf ./*<br> [gerrit@115～ apptest]$ git add .<br> [gerrit@115～ apptest]$ git commit -am "222" &nbsp; &nbsp;#因为前面是直接rm删除的，所以这里commit要多加一个－a，如果是git rm删除就不用加－a<br> [ops 3a26276] 222<br> 2 files changed, 0 insertions(+), 2 deletions(-)<br> delete mode 100644 haha<br> delete mode 100644 zhonghogn<br> [gerrit@Zabbix-server apptest]$ git push -u origin ops &nbsp; &nbsp; &nbsp; ＃这里是gerrit管理员下，所以可以直接push，普通用户就git review ops了<br> Counting objects: 3, done.<br> Delta compression using up to 32 threads.<br> Compressing objects: 100% (2/2), done.<br> Writing objects: 100% (2/2), 246 bytes, done.<br> Total 2 (delta 1), reused 0 (delta 0)<br> remote: Resolving deltas: 100% (1/1)<br> remote: Processing changes: refs: 1, done&nbsp;<br> To ssh://gerrit@103.10.86.30:29418/apptest<br> 486e140..3a26276 ops -&gt; ops<br> Branch ops set up to track remote branch ops from origin.</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">这时候再查看分支情况，就会发现ops分支和master分支的ID不一样了</p> 
    <p style="line-height:1.5;">[gerrit@Zabbix-server apptest]$ git branch -av<br> master 486e140 Merge "123"<br> * ops 3a26276 222<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 27a1d5c 343434<br><strong><span style="line-height:1.5;color:rgb(0,0,255);">remotes/origin/master</span>&nbsp;<span style="line-height:1.5;color:rgb(51,153,102);">486e140 Merge "123"</span></strong><br><strong><span style="line-height:1.5;color:rgb(0,0,255);">remotes/origin/ops</span>&nbsp;<span style="line-height:1.5;color:rgb(51,153,102);">3a26276 222</span></strong><br> remotes/origin/test d0ef218 444</p> 
    <p style="line-height:1.5;">再次登录gerrit界面，就会发现Revision自然也就不一致了，ops分支下的内容和master分支下的内容也不一样了</p> 
    <p style="line-height:1.5;">&nbsp;ops分支下这个时候还是空的（上面已经清空了）</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720200319951-7678171.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">接着就可以往ops分支里创建或修改代码了，如下：</p> 
    <p style="line-height:1.5;">[root@115～ ]＃ su － wangshibo &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ＃切换到gerrit普通用户wangshibo账号下操作<br> [wangshibo@115~ ]$ git clone ssh://gerrit@103.10.86.30:29418/apptest &amp;&amp; scp -p -P 29418 gerrit@103.10.86.30:hooks/commit-msg apptest/.git/hooks/<br> [wangshibo@115~ ]$ cd apptest/<br> [wangshibo@115~ ]$ git branch -av &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;＃查看分支，当前分支是master<br> * master 486e140 Merge "123"<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 27a1d5c 343434<br> remotes/origin/master 486e140 Merge "123"<br> remotes/origin/ops 3a26276 222<br> remotes/origin/test d0ef218 444<br> [wangshibo@115~ ]$ git checkout -b ops remotes/origin/ops &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;＃将远程分支本地别名化<br> Branch ops set up to track remote branch ops from origin.<br> Switched to a new branch 'ops'<br> [wangshibo@115~ ]$ git branch -av &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;＃发现当前分支已经是ops了<br> master 486e140 Merge "123"<br> * ops 3a26276 222<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 27a1d5c 343434<br> remotes/origin/master 486e140 Merge "123"<br> remotes/origin/ops 3a26276 222<br> remotes/origin/test d0ef218 444<br> [wangshibo@115~ ]$ ls &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #没有内容，上面已经提到，切换后就讲内容清空了<br> [wangshibo@115~ ]$ vim testfile &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ＃新增内容<br> [wangshibo@115~ ]$ git add testfile&nbsp;<br> [wangshibo@115~ ]$ git commit -m "branch test"<br> [ops ba9572e] branch test<br> 1 files changed, 2 insertions(+), 0 deletions(-)<br> create mode 100644 testfile<br> [wangshibo@115~ ]$ git review ops &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;＃提交代码审核，提交是指定到分支ops里<br> Creating a git remote called "gerrit" that maps to:<br> ssh://wangshibo@103.10.86.30:29418/apptest.git<br> remote: Processing changes: new: 1, refs: 1, done&nbsp;<br> remote:&nbsp;<br> remote: New Changes:<br> remote: http://103.10.86.30:80/64 branch test<br> remote:&nbsp;<br> To ssh://wangshibo@103.10.86.30:29418/apptest.git<br> * [new branch] HEAD -&gt; refs/publish/ops</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">登陆gerrit，就会发现有个review的审核请求了</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720233620826-678244509.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">通过审核</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720233708341-1125755616.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720233742826-826087365.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720233806607-409243645.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">这个时候，review审核已经通过了</p> 
    <p style="line-height:1.5;">通过apptest项目的ops分支的gitweb就能看到新增的代码了</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720233936888-1328134572.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720234008888-499206804.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201607/907596-20160720234033060-1869710783.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(0,0,255);"><strong>最后，登陆Gitlab，就能发现相应项目的分支代码也都同步过来了（前提是gerrit里面做了相应的replication同步配置）！很神奇的~~~~~</strong></span></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">***********************************************************************&nbsp;**************&nbsp;*********&nbsp;</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,102,0);"><strong>如何删除gerrit界面上创建的分支？也可以理解在本地如何删除远程分支：</strong></span></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">git 删除远程分支<br> 一不小心把本地的临时分支push误提交到server上去了，想要删除。<br> [wangshibo@115 ~]$ git branch -av<br> master<br> remote/origin/master<br> remote/origin/<span style="line-height:1.5;color:rgb(255,0,0);">origin/master</span>&nbsp; &nbsp; &nbsp;#这个就是误提交的分支</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">这个时候，执行下面命令即可删除远程分支<br> [wangshibo@115 ~]$git push origin :<span style="line-height:1.5;color:rgb(255,0,0);">origin/master</span></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(255,0,0);font-size:18px;"><strong><span style="line-height:1.5;color:rgb(128,0,128);">冒号前面的空格不能少</span>，原理是把一个空分支push到server上，相当于删除该分支。其实也是一个push推送过程，只不过是推送的空的而已！</strong></span></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">比如下面一例，在本地误提交了一个分支到远程的gerrit上了！现在需要删除。</p> 
    <p style="line-height:1.5;">[wangshibo@115 GItLearn]$ git branch -av<br> * master 44f4b3a Add new file<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 44f4b3a Add new file<br> remotes/origin/master 44f4b3a Add new file<br> remotes/origin/<span style="line-height:1.5;color:rgb(255,0,0);">remotes/origin/devlop</span>&nbsp;dc21d7f 123 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#删除这个多余的分支</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">[wangshibo@115 GItLearn]$ git push origin :<span style="line-height:1.5;color:rgb(255,0,0);">remotes/origin/devlop</span><br> remote: Processing changes: refs: 1, done&nbsp;<br> To ssh://wangshibo@103.11.186.130:29418/GItLearn<br> - [deleted] remotes/origin/devlop<br> [wangshibo@115 GItLearn]$ git branch -av #再次查看，上面多余的分支已经删除了！<br> devlop dc21d7f 123<br> * master 44f4b3a Add new file<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 44f4b3a Add new file<br> remotes/origin/master 44f4b3a Add new file</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">再次登陆gerrit查看，上面多余的分支就没有了！</p> 
    <p style="line-height:1.5;"><strong><span style="line-height:1.5;color:rgb(255,0,0);">************************************************************************************************</span></strong></p> 
    <p style="line-height:1.5;"><strong><span style="line-height:1.5;color:rgb(255,0,0);">如何在本地创建分支，然后上传到gerrit上？也可以理解为在本地创建分支，然后推送到远程新分支上：</span></strong></p> 
    <p style="line-height:1.5;">命令格式如下：<br> #<span style="line-height:1.5;color:rgb(0,0,255);"><strong>git push origin local_branch:remote_branch</strong></span></p> 
    <p style="line-height:1.5;">注意：<br><span style="line-height:1.5;"><strong>这个操作，local_branch必须为你本地存在的分支，remote_branch为远程分支，如果remote_branch不存在则会自动创建分支。</strong></span></p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;"><strong>只不过这个上传到远程后，分支内容是和master分支内容是一样的！</strong></span></p> 
    <p style="line-height:1.5;">另外：<br> #git push origin :remote_branch<br> 上面的local_branch留空（即冒号前面留有空格），则是删除远程remote_branch分支。（上面已经提到了！）</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;"><span style="line-height:1.5;color:rgb(128,0,0);"><strong>如下面的例子：</strong></span><br> [wangshibo@115 GItLearn]$ git branch -av<br> * master 44f4b3a Add new file<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 44f4b3a Add new file<br> remotes/origin/master 44f4b3a Add new file</p> 
    <p style="line-height:1.5;"><br> 本地创建分支devlop，然后上传到gerrit上：<br> [wangshibo@115 GItLearn]$ git branch devlop &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#新建devlop分支<br> [wangshibo@115 GItLearn]$ git branch -av<br> devlop 44f4b3a Add new file<br> * master 44f4b3a Add new file<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 44f4b3a Add new file<br> remotes/origin/master 44f4b3a Add new file<br> [wangshibo@115 GItLearn]$&nbsp;<span style="line-height:1.5;color:rgb(255,102,0);"><strong>git push origin devlop:devlop</strong>&nbsp;&nbsp;</span>&nbsp;&nbsp; &nbsp; #上传到远程gerrit上，gerrit上若没有devlop，则会自动创建<br> Total 0 (delta 0), reused 0 (delta 0)<br> remote: Processing changes: refs: 1, done&nbsp;<br> To ssh://wangshibo@103.10.86.30:29418/GItLearn<br> * [new branch] devlop -&gt; devlop<br> [wangshibo@115 GItLearn]$ git branch -av &nbsp; &nbsp; &nbsp; &nbsp; #再次查看，发现已经上传到远程gerrit上了<br> devlop 44f4b3a Add new file<br> * master 44f4b3a Add new file<br> remotes/origin/HEAD -&gt; origin/master<br> remotes/origin/dev 44f4b3a Add new file<br> remotes/origin/devlop 44f4b3a Add new file<br> remotes/origin/master 44f4b3a Add new file</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">登陆gerrit查看，发现已经有了这个分支了！【这样上传后，分支内容和master分支内容是一样的，因为在本地创建devlop分支的时候，当前分支是master】</p> 
    <p style="line-height:1.5;"><img src="https://images2015.cnblogs.com/blog/907596/201608/907596-20160829194409433-1461281703.png" alt="" style="border:0px;"></p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;"><strong><span style="line-height:1.5;color:rgb(255,0,0);">************************************************************************************************</span></strong></p> 
    <p style="line-height:1.5;">将远程gerrit上的代码分支迁移到本地新的gerrit分支上<br> 迁移流程：<br> 1.先将远程gerrit整个代码clone到本地（默认迁移过来后的当前分支是master）<br> 2.clone到本地后，查看分支列表<br> 3.在本地gerrit上创建同名分支<br> 4.切换到clone下来的代码的各个分支，然后将分支内容push到本地新gerrit上的同名分支上</p> 
    <p style="line-height:1.5;">*******<br> 把本地仓库提交到远程仓库的master分支中（其他分支操作一样）<br> git push ssh://gerrit@103.10.86.30:29418/apptest_ios.git master #或者像上面一样，将远程分支本地化，然后一步步提交</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
   </div> 
   <div style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;line-height:19.5px;">
    ***************当你发现自己的才华撑不起野心时，就请安静下来学习吧***************
   </div> 
   <div class="clear" style="clear:both;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;line-height:19.5px;"></div> 
   <div> 
    <div> 
     <font><span style="font-size:13px;line-height:19.5px;">本文转自散尽浮华博客园博客，原文链接：http://www.cnblogs.com/kevingrace/p/5688724.html</span></font>
     <span style="font-size:13px;line-height:19.5px;font-family:Verdana, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
