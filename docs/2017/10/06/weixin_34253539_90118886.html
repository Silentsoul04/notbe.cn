<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>9、ASP.NET MVC入门到精通——Controller(控制器) « NotBeCN</title>
  <meta name="description" content="             本系列目录：ASP.NET MVC4入门到精通系列目录汇总         Controller主要负责响应用户的输入。主要关注的是应用程序流，输入数据的处理，以及对相关视图(View)输出数据的提供。            继承自：System.Web.Mvc.Controller  ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/06/weixin_34253539_90118886.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">9、ASP.NET MVC入门到精通——Controller(控制器)</h1>
    <p class="post-meta">Oct 6, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">本系列目录：<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/jiekzou/p/4772273.html" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">ASP.NET MVC4入门到精通系列目录汇总</a></p> 
   <blockquote style="background:rgb(255,255,163) url(&quot;//images.cnblogs.com/cnblogs_com/jiekzou/780174/o_o_title.png&quot;) no-repeat scroll 9px 0px;border:2px solid rgb(239,239,239);color:rgb(51,51,51);line-height:1.6em;clear:both;font-family:'Microsoft Yahei';font-size:15px;"> 
    <p>Controller主要负责响应用户的输入。主要关注的是应用程序流，输入数据的处理，以及对相关视图(View)输出数据的提供。</p> 
   </blockquote> 
   <ul style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <li>继承自：System.Web.Mvc.Controller</li> 
    <li>一个Controller可以包含多个Action. 每一个Action都是一个方法, 返回一个ActionResult实例</li> 
    <li>一个Controller对应一个xxController.cs控制文件，对应在View中有一个xx文件夹。一般情况一个Action对应一个View页面</li> 
   </ul>
   <h2 style="color:#FFFFFF;line-height:25px;font-size:17px;background:none repeat scroll 0px 0px;font-family:'微软雅黑', '宋体', '黑体', Arial;">Controller Action方法参数与返回值</h2> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Action方法接收参数：<br> a.接收浏览器传过来的参数(get-两种格式/post)<br> &nbsp;&nbsp; a1.接收FormCollection Request.Form</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;1.<span style="line-height:1.8;font-family:'宋体';">通过</span>Request.Form["name"]&nbsp;逐个获取&nbsp;表单提交的数据</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">在View视图中</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre>  @Html.TextBoxFor(x =&gt; x.CusName, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> { @class = <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">trade-timen</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, @id = <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">cusName</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span> })&lt;span <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">wtps</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>&gt;* @Html.ValidationMessageFor(m =&gt; m.CusName)</pre>
   </div> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">控制器中</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="font-size:12px;line-height:1.5;"> [HttpPost]<br>
public string UpdateCustomerInfo(FormCollection form)<br>
{<br>
return&nbsp; Request.Form["CusName"];;<br>
&nbsp;}</span></pre>
   </div> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">注意：在View界面要存在name属性为CusName的表单元素，因为提交表单数据的时候，只会提交所有带name标签的数据。</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;2.<span style="line-height:1.8;font-family:'宋体';">通过&nbsp;</span>FormCollection&nbsp;form逐个获取&nbsp;表单提交的数据</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre>[HttpPost]<br><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">string</span><span style="font-size:12px;line-height:1.5;"> UpdateCustomerInfo(FormCollection form)
 {
      </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> form[<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">CusName</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>];  <br>
}</pre>
   </div> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp; a2.接收Model</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-family:'宋体';">通过&nbsp;</span>实体对象&nbsp;一次性获取&nbsp;表单元素的数据，并设置到实体对象对应的属性中</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:medium none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:medium none;"></a></span>
    </div> 
    <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// 修改客户<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="info"&gt;&lt;/param&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [HttpPost]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public ActionResult UpdateCustomer(CustomerInfo info)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string msg = string.Empty;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ModelState.IsValid)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CustomerInfo model = CustomerInfo.Load(info.ID);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.CusCode = info.CusCode;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.CusName = info.CusName;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.Phone = info.Phone;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.Tel = info.Tel;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.Email = info.Email;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.Fax = info.Fax;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.Country = info.Country;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.Address = info.Address;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.CompanyName = info.CompanyName;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.BusssinessType = info.BusssinessType;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.Status = info.Status;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; model.Update();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; msg = "修改客户成功。";<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; msg = "修改客户失败！" + ex.Message;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ViewBag.Msg = string.Format(message, msg, false, "1");<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ViewBag.Msg = string.Format(message, msg, true, "0");<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return View();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:medium none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:medium none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">注意：&nbsp;表单中的表单元素的属性名称必须和实体对象的属性一样！</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">折叠类中所有方法：<span style="line-height:1.8;font-family:Calibri;">ctr</span>l+m+o&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">折叠类中所有的代码块，包括类：ctrl+m+l</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">b.接收Get数据，Request.QueryString</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">直接通过请求上下文对象里的&nbsp;<span style="line-height:1.8;font-family:Calibri;">Request</span><span style="line-height:1.8;font-family:'宋体';">获取&nbsp;</span>url&nbsp;?<span style="line-height:1.8;font-family:'宋体';">后的的参数：</span></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;浏览器请求路径为：<span style="line-height:1.8;font-family:Calibri;">/User/UserList/1?kjy=jp</span></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;控制器获取：Request.QueryString["kjy"];</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>Action方法输出返回值：</strong></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">b1.string：直接 返回响应报文字符串；</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">b2.ActionResult：返回控制器结果对象<br> &nbsp;&nbsp;&nbsp;&nbsp; (里面会包含什么呢？能做什么呢？)</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">b3.JsonResult：返回 Json 字符串</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>Action的返回值-ActionResult</strong></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><img src="https://images2015.cnblogs.com/blog/413851/201509/413851-20150903172109888-1123268221.png" alt="" style="border:0px none;"></strong></p> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">Action指定使用视图</h3> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:medium none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:medium none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span><span style="font-size:12px;line-height:1.5;"> ActionResult Index()
{
     </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> View();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//默认情况下不给参数返回和方法同名的视图，即</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">使用视图 Index.cshtml 路径在当前控制器对应的View目录下面</span>
     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> View(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">OtherIndex</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">使用 OtherIndex.cshtml</span>
     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> View(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">~/Views/Home/Test.cshtml</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">);
}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:medium none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:medium none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;Controller是如何向View进行数据传输的呢？</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>控制器将处理后的数据“传”给视图的方式</strong></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">ViewData/ViewBag/TempData/Model</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">我们先来看下示例</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">控制器代码：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:medium none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:medium none;"></a></span>
    </div> 
    <pre>        <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span><span style="font-size:12px;line-height:1.5;"> ActionResult Index()
        {
            ViewBag.UserName </span>= <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">小李飞刀</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">;
            ViewData[</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">UserName</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>] = <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">陆小凤</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">;
            TempData[</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">UserName</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>] = <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">楚留香</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">临时数据</span>
<span style="font-size:12px;line-height:1.5;">
            User model </span>= <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> User { UserName = <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">谢晓峰</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;"> };

            </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span><span style="font-size:12px;line-height:1.5;"> View(model); //这行代码其实就相当于<span style="font-size:12px;line-height:1.5;">ViewData</span>.<span style="font-size:12px;line-height:1.5;"><span style="font-size:12px;line-height:1.5;">Model=model</span></span>
        }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:medium none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:medium none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">View代码：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:medium none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:medium none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">@{
    ViewBag.Title </span>= <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">Index</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">;
}

</span>&lt;div&gt;@ViewBag.UserName &lt;/div&gt;
&lt;div&gt;@ViewData[<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">UserName</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>] &lt;/div&gt;
&lt;div&gt;@TempData[<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">UserName</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>] &lt;/div&gt;
&lt;div&gt;@Model.UserName&lt;/div&gt;</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:medium none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:medium none;"></a></span>
    </div> 
   </div> 
   <pre><span style="line-height:1.8;color:rgb(255,0,0);">Model其实就是ViewData.Model</span></pre> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">大家可能觉得这十分显而易见，结果肯定是</p> 
   <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    小李飞刀
   </div> 
   <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    陆小凤
   </div> 
   <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    楚留香
   </div> 
   <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    谢晓峰
   </div> 
   <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    可是，我要告诉你，结果并不是像你想象的那样，而是会显示为这样：
   </div> 
   <div> 
    <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     陆小凤
    </div> 
    <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     陆小凤
    </div> 
    <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     楚留香
    </div> 
    <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     谢晓峰
    </div> 
    <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     为什么呢？因为ViewData
     <span style="line-height:1.8;font-family:'宋体';">和</span>
     <span style="line-height:1.8;font-family:Calibri;">ViewBag</span>
     <span style="line-height:1.8;font-family:'宋体';">本质上都是【</span>ViewDataDictionary】类型，并且两者之间的数据共享，只不过提供了不同的语法操作方式而已。
    </div> 
    <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     所以“陆小凤”覆盖了原先的值”小李飞刀“。
    </div> 
    <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     TempData，看名称我们就知道，只用来临时存储的，存储一次就失效了，不会再共享啊什么的。
    </div> 
    <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     打开我一直吐血推荐的犀利工具Reflector，我们来看下源码
    </div> 
    <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     我们看到HomeController : Controller，public abstract class Controller : ControllerBase
    </div> 
    <div style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     <img src="https://images2015.cnblogs.com/blog/413851/201509/413851-20150903192313638-1266234469.jpg" alt="" style="border:0px none;">
    </div> 
    <div> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">发现，只要从TempData<span style="line-height:1.8;font-family:'宋体';">中取出一个元素，就会立即将此元素移除！</span></p> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-family:'宋体';"><img src="https://images2015.cnblogs.com/blog/413851/201509/413851-20150903193003278-1756437256.jpg" alt="" style="border:0px none;"></span></p> 
     <h4 style="color:rgb(0,0,0);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Model&nbsp;<span style="line-height:1.8;font-family:'宋体';">强类型参数</span> </h4> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">在控制器里的Action<span style="line-height:1.8;font-family:'宋体';">方法最后&nbsp;调用</span><span style="line-height:1.8;font-family:Calibri;">View</span><span style="line-height:1.8;font-family:'宋体';">加载视图的时候，将&nbsp;数据对象传入。</span></p> 
     <pre><span style="line-height:1.8;color:rgb(0,0,255);">return<span style="line-height:1.8;color:rgb(0,0,0);"> View(model);<br></span></span></pre> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">视图中，可以通过&nbsp;Model<span style="line-height:1.8;font-family:'宋体';">属性获取！并且不需要转型就可以直接使用！</span></p> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-family:'宋体';"><img src="https://images2015.cnblogs.com/blog/413851/201509/413851-20150903193225466-1989609009.jpg" alt="" style="border:0px none;"></span></p> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">注意：<span style="line-height:1.8;font-family:Calibri;">Model</span><span style="line-height:1.8;font-family:'宋体';">虽然可以不转型就直接使用，但是&nbsp;因为编译器无法在编译时获取它的类型，所以就无法出现智能提示！为了解决这个问题，我们可以在试图的最上面通过代码指定</span><span style="line-height:1.8;font-family:Calibri;">model</span><span style="line-height:1.8;font-family:'宋体';">类型</span></p> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-family:'宋体';"><img src="https://images2015.cnblogs.com/blog/413851/201509/413851-20150903193429575-1183876737.jpg" alt="" style="border:0px none;">&nbsp;</span></p> 
     <pre><strong>查看源码：</strong></pre> 
     <pre>当我们在试图上添加了&nbsp;@model<span style="line-height:1.8;font-family:'宋体';">指令时&nbsp;</span></pre> 
     <font color="#333333"><span style="font-size:14px;"><img src="https://images2015.cnblogs.com/blog/413851/201509/413851-20150903193625591-1140587384.png" alt="" style="border:0px none;"></span></font>
     <br>
     <pre>当前视图就会继承于&nbsp;<span style="line-height:1.8;font-family:Calibri;">WebViewPage&lt;T&gt;&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">强类型视图页面类，并且指定</span><span style="line-height:1.8;font-family:Calibri;">T</span><span style="line-height:1.8;font-family:'宋体';">为</span><span style="line-height:1.8;font-family:Calibri;">Student</span><span style="line-height:1.8;font-family:'宋体';">：</span></pre> 
     <font color="#333333"><span style="font-size:14px;"><img src="https://images2015.cnblogs.com/blog/413851/201509/413851-20150903193646325-55130051.png" alt="" style="border:0px none;"></span></font>
     <pre></pre> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;如果没有添加@model<span style="line-height:1.8;font-family:'宋体';">指令：</span>当前视图就会继承于&nbsp;<span style="line-height:1.8;font-family:Calibri;">WebViewPage&lt;T&gt;&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">强类型视图页面类，但</span><span style="line-height:1.8;font-family:Calibri;">T</span><span style="line-height:1.8;font-family:'宋体';">变成了&nbsp;</span>dynamic</p> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">到这里，Controller的数据怎么就传到View了，我明明只给Controller中的ViewData/ViewBag/TempData/赋值了，或者只把对象传给了View方法。</p> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">为什么View中就可以直接调用了呢？我们知道以前的ASP.NET，aspx和aspx.cs是一个继承关系，子类可以直接调用父类的属性方法。你ASP.NET MVC中View和Controller之间又有什么关系呢？</p> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">View和Controller中都有ViewData/ViewBag/TempData这几个对象，在给Controller中这些对象赋值后，Controller会把这些值赋值給View中对应的这几个对象。</p> 
     <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">本系列目录：<a class="postTitle2" href="http://www.cnblogs.com/jiekzou/p/4772273.html" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">ASP.NET MVC4入门到精通系列目录汇总</a></p> 
     <p><font color="#333333">本文转自邹琼俊博客园博客，原文链接：http://www.cnblogs.com/jiekzou/p/4780412.html，如需转载请自行联系原作者</font><br></p> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
