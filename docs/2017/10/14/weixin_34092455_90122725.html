<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>连接各种数据库 « NotBeCN</title>
  <meta name="description" content="             这里详细的介绍了各种数据库的各种连接http://www.connectionstrings.com/    &nbsp;    &nbsp;    例如：String strConn="Data Source=.;Initial Catalog=数据库的名字;Integrated Se...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/14/weixin_34092455_90122725.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">连接各种数据库</h1>
    <p class="post-meta">Oct 14, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">这里详细的介绍了各种数据库的各种连接<br><a href="http://www.connectionstrings.com/" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">http://www.connectionstrings.com/</a></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">例如：String strConn="Data Source=.;Initial Catalog=数据库的名字;Integrated Security=ture"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp; String strConn="Data Source=.;Initial Catalog=数据库的名字;Integrated Security=false";User ID=sa;Passwrod=123;<br> &nbsp;&nbsp; String strConn="Server=.;Database=数据库名称";User Id=sa;Password=123;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">1、Data Source<br> &nbsp;&nbsp; 数据源，也可以说是服务器。 　　<br> “Data Source”可以由下列字符串代替：“server”，“address”，“addr”和“network address”。 　　<br> 本地数据源：Data Source=./SQLExpress,Data Source=(Local)/SQLExpress</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">2、Initial Catalog<br> 数据库名称<br> Initial Catalog 可以由下俩字符串代替：“Database”<br> 3、Integrated Security<br> “Integrated Security”可以写成“trusted_connection”<br> 为true时，使用当前的 Windows 身份验证<br> 为false时，需要在连接中指定用户名和密码(即使连接字符串中有User Id 和Password也是不起作用的！)<br><span style="line-height:21px;font-family:tahoma, helvetica, arial;color:rgb(69,69,69);">Integrated Security 可以设置为: True, false, yes, no ，这四个容易理解了，另外，还可以设置为：sspi ，相当于 True<br></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">//sql server 身份验证 连接字符串<br> private string ConnstrSqlServer = "server=服务器名称;uid=登录名称;pwd=登录密码;database=数据库名称";</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">//windows 身份验证连接字符串<br> private string ConnstrWindows = "server=服务器名称;database=数据库名称;Trusted_Connection=SSPI";</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">// 在 C# 代码中用 SqlClient 的方式访问 SQL Server 2008 数据库&nbsp;&nbsp;&nbsp;&nbsp;<br> // .NET Framework Data Provider for SQL Server 标准写法&nbsp;&nbsp;&nbsp;&nbsp;<br> Data Source=myServerAddress;Initial Catalog=myDataBase;User Id=myUsername;Password=myPassword;&nbsp;&nbsp;&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">// .NET Framework Data Provider for SQL Server 另一种标准写法&nbsp;&nbsp;&nbsp;&nbsp;<br> Server=myServerAddress;Database=myDataBase;User ID=myUsername;Password=myPassword;Trusted_Connection=False;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">// .NET Framework Data Provider for SQL Server 信任连接写法&nbsp;&nbsp;&nbsp;&nbsp;<br> Data Source=myServerAddress;Initial Catalog=myDataBase;Integrated Security=SSPI;&nbsp;&nbsp;&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">// .NET Framework Data Provider for SQL Server 信任连接另一种写法&nbsp;&nbsp;&nbsp;<br> Server=myServerAddress;Database=myDataBase;Trusted_Connection=True;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);">SQL Server .NET Data Provider 连接字符串包含一个由一些属性名/值对组成的集合。每一个属性/值对都由分号隔开。</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyName1=Value1;PropertyName2=Value2;PropertyName3=Value3;.....</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">同样，连接字符串必须包含SQL Server实例名称:</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Data Source=ServerName;</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 使用本地的SQL Server(localhost)，如果想要使用远程服务器运行，应该在示例对象中把正确的服务器赋给Data Source 属性。此外，还必须指定所支持的两种身份验证方法(即Windows身份验证和SQL Server身份验证)中的其中一种。Windows身份验证使用Windows登录用户身份连接数据库，而SQL身份验证要求显式地指定SQL Server用户ID和密码。要想使用Windows身份验证，必须在连接字符串中包括 Integrated Security 属性:</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Data Source=ServerName;Integrated Security=True;</span></p> 
   <p style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;color:rgb(51,102,255);"><span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 默认情况下，Integrated Security 属性为 False ，这意味着将禁用Windows身份验证。如果没有显式地把这个属性的值设置为True，连接将使用SQL Server身份验证，因此，必须提供SQL Server用户ID和密码。Integrated Security属性还能识别的其他值只有SSPI(Security Support Provider Interface，安全性支持提供者接口).在所有的Windows NT操作系统上，其中包括Windows NT 4.0、2000、XP，都支持值SSPI。它是使用Windows身份验证时可以使用的惟一接口，相当于把Integrated Security 属性值设置为True。</span></p> 
   <p style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;color:rgb(51,102,255);"><span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在Windows身份验证模式中，SQL Server使用Windows的安全子系统对用户连接进行有效性验证。即使显示地指定用户ID和密码，SQL Server也不检查连接字符串中的用户ID和密码。因为只有Windows NT、2000、XP支持SSPI，因此如果正使用的是这些操作系统，则只能使用Windows集成的安全策略去连接SQL Server。不论使用哪一个操作系统，当使用SQL Server身份验证时，必须在连接字符串中指定用户ID和密码：</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">Data Source=ServerName;User ID=donaldx;Password=unbreakable</span></p> 
   <p style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;color:rgb(51,102,255);"><span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 默认情况下，SQL Server .NET Data Provider连接指定用户的默认数据库，当在数据库中创建用户时，可以设置用户的默认数据库。此外，也可以在任意时间更改用户的默认数据库。例如，系统管理员的默认数据库是master。如果想要连接不同的数据库，应该指定数据库的名称：</span><span style="line-height:1.8;color:rgb(0,0,255);">Data Source=ServerName;Integrated Security=SSPI;Initial Catalog=Northwind</span></p> 
   <p style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;color:rgb(51,102,255);"><span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 每一种身份验证都有它的优点和缺点。Windows身份验证使用单一的用户信息库源，因此，不需要为数据库访问去分别配置用户。连接字符串不包含用户ID和密码，因此消除了把用户ID和密码暴露给未授权的用户的危险。可以在Active Directory中管理用户和他们的角色，而不必在SQL Server中显式地配置他们的属性。</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">Windows身份验证的缺点是，它要求客户通过Windows的安全子系统支持的安全通道去连接SQL Server。如果应用种序需要通过不安全的网络(例如Internet)连接SQL Server，Windows身份验证将不工作。此外，这种身份验证方法也部分地把管理数据库访问控制的责任从DBA身上转移到了系统管理员身上，这在确定的环境中也许是一个问题。</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 一般而言，在设计通用的应用程序时，为了使用Windows身份验证，将会对一些方面进行加强。大多数公司的数据库都驻留在比较健壮的Windows服务器操作系统上，那些操作系统都支持Windows身份验证。数据访问层和数据表示层的分离也促进了把数据访问代码封装在中间层组件思想的应用，中间层组件通常运行在具有数据库服务器的内部网络中。当这样设计时，就不需要通过不安全通道建立数据库连接。除此之外，Web服务也使直接连接不同域中数据库的需要大减少。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);">数据库的连接性已经发展成为应用程序开发的一个标准方面。数据库连接字符串现在已经成为每个项目的标准必备条件。我发现自己为了找到所需要的句法，经常要从另外一个应用程序中复制连接字符串或者进行一次搜索。这个在与SQL Server交互操作时更是如此，因为它有太多的连接字符串选项。现在就让我们来研究一下连接字符串的众多方面。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>连接字符串</strong></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);">在对象实例化或者建立期间，数据库连接字符串通过属性或方法被传递到必要的对象。连接字符串的格式是一个以分号为界，划分键／值参数对的列表。<strong><a style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"><span style="line-height:1.8;color:rgb(0,0,255);">列表A</span></a></strong>中包括了一个C#中的例子，说明了怎样用创建SqlConnection对象的方法连接到SQL Server（实际的连接字符串是通过对象的ConnectionString属性分配的）。<strong><a style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"><span style="line-height:1.8;color:rgb(0,0,255);">列表B</span></a></strong>中包括的是VB.NET的版本。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>列表</strong><strong>A</strong></span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);">string cString = "Data Source=server;Initial Catalog=db;User ID=test;Password=test;";</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">SqlConnectionconn = new SqlConnection();</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">conn.ConnectionString = cString;</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">conn.Open();</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>列表</strong><strong>B</strong></span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);">Dim cString As String</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">cString = "Data Source=server;Initial Catalog=db;User ID=test;Password=test;"</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);">Dim conn As SqlConnection = New SqlConnection()</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">conn.ConnectionString = cString</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">conn.Open()</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);">连接字符串会指定数据库服务器和数据库，以及访问数据库必需的用户名和密码。但是这种格式并不是对所有数据库交互都适用，它的确有许多可用的选项，其中很多选项都有同义词。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(0,0,255);">和Data Source（数据源）、Initial Catalog（初始编目）、User ID（用户ID）、和Password（密码）等元素一起，下面这些选项都是可用的：</span></p> 
   <p style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;color:rgb(51,102,255);"><span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;</span></p> 
   <ul style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <li>
     <ul style="color:rgb(51,51,51);">
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Application Name</strong><strong>（应用程序名称）：</strong>应用程序的名称。如果没有被指定的话，它的值为.NET SqlClient Data Provider（数据提供程序）.</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>AttachDBFilename</strong><strong>／</strong><strong>extended properties</strong><strong>（扩展属性）／</strong><strong>Initial File Name</strong><strong>（初始文件名）：</strong>可连接数据库的主要文件的名称，包括完整路径名称。数据库名称必须用关键字数据库指定。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Connect Timeout</strong><strong>（连接超时）／</strong><strong>Connection Timeout</strong><strong>（连接超时）：</strong>一个到服务器的连接在终止之前等待的时间长度（以秒计），缺省值为15。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Connection Lifetime</strong><strong>（连接生存时间）：</strong>当一个连接被返回到连接池时，它的创建时间会与当前时间进行对比。如果这个时间跨度超过了连接的有效期的话，连接就被取消。其缺省值为0。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Connection Reset</strong><strong>（连接重置）：</strong>表示一个连接在从连接池中被移除时是否被重置。一个伪的有效在获得一个连接的时候就无需再进行一个额外的服务器来回运作，其缺省值为真。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Current Language</strong><strong>（当前语言）：</strong>SQL Server语言记录的名称。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Data Source</strong><strong>（数据源）／</strong><strong>Server</strong><strong>（服务器）／</strong><strong>Address</strong><strong>（地址）／</strong><strong>Addr</strong><strong>（地址）／</strong><strong>Network Address</strong><strong>（网络地址）：</strong>SQL Server实例的名称或网络地址。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Encrypt</strong><strong>（加密）：</strong>当值为真时，如果服务器安装了授权证书，SQL Server就会对所有在客户和服务器之间传输的数据使用SSL加密。被接受的值有true（真）、false（伪）、yes（是）和no（否）。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Enlist</strong><strong>（登记）：</strong>表示连接池程序是否会自动登记创建线程的当前事务语境中的连接，其缺省值为真。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Database</strong><strong>（数据库）／</strong><strong>Initial Catalog</strong><strong>（初始编目）</strong>：数据库的名称。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Integrated Security</strong><strong>（集成安全）／</strong><strong>Trusted Connection</strong><strong>（受信连接）：</strong>表示Windows认证是否被用来连接数据库。它可以被设置成真、伪或者是和真对等的sspi，其缺省值为伪。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Max Pool Size</strong><strong>（连接池的最大容量）：</strong>连接池允许的连接数的最大值，其缺省值为100。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Min Pool Size</strong><strong>（连接池的最小容量）：</strong>连接池允许的连接数的最小值，其缺省值为0。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Network Library</strong><strong>（网络库）／</strong><strong>Net</strong><strong>（网络）：</strong>用来建立到一个SQL Server实例的连接的网络库。支持的值包括： dbnmpntw (Named Pipes)、dbmsrpcn (Multiprotocol／RPC)、dbmsvinn(Banyan Vines)、dbmsspxn (IPX／SPX)和dbmssocn (TCP／IP)。协议的动态链接库必须被安装到适当的连接，其缺省值为TCP／IP。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Packet Size</strong><strong>（数据包大小）：</strong>用来和数据库通信的网络数据包的大小。其缺省值为8192。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Password</strong><strong>（密码）／</strong><strong>Pwd</strong><strong>：</strong>与帐户名相对应的密码。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Persist Security Info</strong><strong>（保持安全信息）：</strong>用来确定一旦连接建立了以后安全信息是否可用。如果值为真的话，说明像用户名和密码这样对安全性比较敏感的数据可用，而如果值为伪则不可用。重置连接字符串将重新配置包括密码在内的所有连接字符串的值。其缺省值为伪。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>Pooling</strong><strong>（池）：</strong>确定是否使用连接池。如果值为真的话，连接就要从适当的连接池中获得，或者，如果需要的话，连接将被创建，然后被加入合适的连接池中。其缺省值为真。</span></li> 
      <li style="list-style:disc;"><span style="line-height:1.8;color:rgb(0,0,255);"><strong>User ID</strong><strong>（用户</strong><strong>ID</strong><strong>）：</strong>用来登陆数据库的帐户名。</span></li> 
      <li style="list-style:disc;"> <span style="line-height:1.8;color:rgb(0,0,255);"><strong>Workstation ID</strong><strong>（工作站</strong><strong>ID</strong><strong>）：</strong>连接到SQL Server的工作站的名称。其缺省值为本地计算机的名称。</span> <p><span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;</span></p> <p><span style="line-height:1.8;color:rgb(0,0,255);">&nbsp;</span></p> 
       <div class="postTitle" style="border-bottom:1px solid rgb(238,238,238);font-weight:bold;">
        <span style="line-height:1.8;color:rgb(0,0,255);"><a class="postTitle2" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"><span style="line-height:1.8;color:rgb(0,0,255);">解决SQL Server 连接时的一些基本问题后的若干初浅心得</span></a></span>
       </div> <p><span style="line-height:1.8;color:rgb(0,0,255);">学生做了一个题库系统，用Ｃ＃写的ＡＳＰ应用程序，数据库用SQL Server2000，交给我看看。放到服务器上后，出现问题。反复调整后发现了解决的方法，其实很简单。回过头去看了看，发现是自己对SQL Server的连接语句和用户权限的认识不足所造成的。下面将我的一些心得以及网上查到的有关资料汇集一下，以为后来者借鉴，当然很肤浅。</span><br><span style="line-height:1.8;color:rgb(0,0,255);">1、SQL Server的连接方式</span></p> 
       <div>
        <span style="line-height:1.8;color:rgb(0,0,255);">以本地服务器(LocalHost)，数据库(Northwind)为例，可以有以下一些连接方式</span>
       </div> 
       <div>
        <span style="line-height:1.8;color:rgb(0,0,255);">SqlConnection conn=new SqlConnection( "Server=LocalHost;Integrated Security=SSPI;Database=Northwind");</span>
       </div> 
       <div>
        <span style="line-height:1.8;color:rgb(0,0,255);">SqlConnection conn = new SqlConnection("Data Source=LocalHost;Integrated Security=SSPI;Initial Catalog=Northwind;");</span>
       </div> 
       <div> 
        <span style="line-height:1.8;color:rgb(0,0,255);">SqlConnection conn = new SqlConnection(" Data Source=LocalHost;Initial Catalog=Northwind;Integrated Security=SSPI;Persist Security Info=False;Workstation Id=XURUI;Packet Size=4096; ");</span>&nbsp;
        <span style="line-height:1.8;color:rgb(0,0,255);">SqlConnection myConn = new SqlConnection("Persist Security Info=False;Integrated Security=SSPI;Database=northwind;Server=LocalHost");</span>
        <span style="line-height:1.8;color:rgb(0,0,255);">SqlConnection conn = new SqlConnection(" Uid=sa;Pwd=***;Initial Catalog=Northwind;Data Source=LocalHost;Connect Timeout=900");</span> 
       </div> <p><span style="line-height:1.8;color:rgb(0,0,255);">心得：</span></p> 
       <div> 
        <span style="line-height:1.8;color:rgb(0,0,255);">a.Server和Database，Data Source和Initial Catalog配对使用的，可以互相替换（见笑）</span>&nbsp;
        <span style="line-height:1.8;color:rgb(0,0,255);">b.Integrated Security默认值是False，此时需要提供Uid和Pwd，即将以Sql Server 用户身份登陆数据库；如果设置为True，Yes 或 SSPI，这不能出现Uid和Pwd，将以Windows用户省份登陆数据库。强烈推荐用后一种形式，安全性更高。</span>&nbsp;
        <span style="line-height:1.8;color:rgb(0,0,255);">c.Integrated Security和Persist Security Info同时出现，后者设置为False，可保证信息安全。</span> 
       </div> <p><span style="line-height:1.8;color:rgb(0,0,255);">更多字符串连接说明请看MSDN：</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);"><a style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"><span style="line-height:1.8;color:rgb(0,0,255);">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemDataSqlClientSqlConnectionClassConnectionStringTopic.asp</span></a></span></p> 
       <div> 
        <p><span style="line-height:1.8;color:rgb(0,0,255);">连接字符串的书写应该熟练后应该没有什么问题，我是再看别人的程序，说实话有些东东还真不清楚。但连接不上的问题出现后，得解决呀。所以必须要弄懂这些关键字的意义，修改后再测试。</span></p> 
       </div> <p><span style="line-height:1.8;color:rgb(0,0,255);">2、SQL Server的用户设置</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">问题一、采用连接字符串</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">SqlConnection conn = new SqlConnection(" Uid=sa;Pwd=***;Initial Catalog=Northwind;Data Source=LocalHost;Connect Timeout=900");</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">错误：</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">用户"sa"登陆失败，没有可信任的Sql Server连接</span><span style="line-height:1.8;color:rgb(0,0,255);">查资料后找到解决方法：</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">原因：Sql Server的验证方式需要设置为Sql Server验证和Windows集成验证的混合方式，如果仅设置为后一种方式，就会出像上述问题</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">解决：运行Sql Server的企业管理器，点击服务器，在右键菜单中选择属性，选安全性，更改验证方式即可</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">问题二、采用连接字符串</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">SqlConnection conn = new SqlConnection("Data Source=LocalHost;Integrated Security=SSPI;Initial Catalog=Northwind;");</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">错误：</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">用户"computername\IWAM_servername"登陆失败</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">原因：SQL Server的登陆用户中不包括IWAM_servername</span>&nbsp;<span style="line-height:1.8;color:rgb(0,0,255);">解决方法：运行Sql Server的企业管理器，点击服务器，选安全性，选登陆，新建登陆中加入IWAM_servername，并配备相应的权限，如只能访问Northwind数据库，数据库的角色设置为public和db_owner。</span></p> <p><span style="line-height:1.8;color:rgb(0,0,255);">3、关于连接的安全性</span></p> <p><span style="line-height:1.8;color:rgb(0,0,255);">最好使用SSPI的集成安全方式连接数据库，而sa用户的方式连接会存在安全隐患，我认为主要是因为在安装SQL Server时，经常会为了访问的方便设置sa的密码为空，黑客一旦让sa成为管理员，就可以获得对系统的所有访问权限。所以为了数据库的安全，可以设置 SQL server的访问用户只能经过windows集成验证，设置sa的安全密码，加强数据库的安全性。当然设置为windows集成验证后，数据库的性能和访问的灵活性势必会受到影响，管理员可以针对每一个数据库设置不同的验证方式，而不必对SQL server设置成统一的方式。</span></p> </li> 
     </ul></li>
   </ul>
   <div>
    <font color="#0000ff"><span style="font-size:14px;"><br></span></font>
   </div> 
   <div>
    <font color="#0000ff"><span style="font-size:14px;"><br></span></font>
   </div> 
   <div>
    <font color="#0000ff"><span style="font-size:14px;">本文转自武沛齐博客园博客，原文链接：http://www.cnblogs.com/wupeiqi/archive/2013/05/04/3058914.html，如需转载请自行联系原作者</span><br></font>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
