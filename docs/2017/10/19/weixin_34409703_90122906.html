<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>路径，文件，目录，I/O常见操作汇总（一） « NotBeCN</title>
  <meta name="description" content="             &nbsp; &nbsp;   摘要:   &nbsp;&nbsp;&nbsp; 文件操作是程序中非常基础和重要的内容，而路径、文件、目录以及I/O都是在进行文件操作时的常见主题，这里想把这些常见的问题作个总结，对于每个问题，尽量提供一些解决方案，即使没有你想要的答案，也希望能提供给你一...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/19/weixin_34409703_90122906.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">路径，文件，目录，I/O常见操作汇总（一）</h1>
    <p class="post-meta">Oct 19, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp; &nbsp;</span>
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">摘要:<br></strong>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 文件操作是程序中非常基础和重要的内容，而路径、文件、目录以及I/O都是在进行文件操作时的常见主题，这里想把这些常见的问题作个总结，对于每个问题，尽量提供一些解决方案，即使没有你想要的答案，也希望能提供给你一点有益的思路，如果你有好的建议，恳请能够留言，使这些内容更加完善。&nbsp;</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;font-weight:bold;">主要内容：<br></span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 一、路径的相关操作， 如判断路径是否合法，路径类型，路径的特定部分，合并路径，系统文件夹路径等内容；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 二、相关通用文件对话框，这些对话框可以帮助我们操作文件系统中的文件和目录；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 三、文件、目录、驱动器的操作，如获取它们的基本信息，获取和设置文件和目录的属性，文件的版本信息，</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 搜索文件和目录，文件判等，复制、移动、删除、重命名文件和目录；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 四、读写文件，包括临时文件，随机文件名等；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 五、对文件系统的监视；&nbsp;</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 这一篇就先写一下前两部分。</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">一、路径相关操作</strong>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 问题1：</span>
   <span style="font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;color:rgb(31,0,252);">如何判定一个给定的路径是否有效/合法；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 解决方案：通过Path.GetInvalidPathChars或Path.GetInvalidFileNameChars方法获得非法的路径/文件名字符，可以</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 根据它来判断路径中是否包含非法字符；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 问题2：</span>
   <span style="font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;color:rgb(31,0,252);">如何确定一个路径字符串是表示目录还是文件；<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">解决方案：</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 1、使用Directory.Exists或File.Exist方法，如果前者为真，则路径表示目录；如果后者为真，则路径表示文件；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 2、上面的方法有个缺点就是不能处理那些不存在的文件或目录。这时可以考虑使用Path.GetFileName方法获得</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 其包含的文件名，如果一个路径不为空，而文件名为空那么它表示目录，否则表示文件；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 问题3：</span>
   <span style="font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;color:rgb(32,0,255);">如何获得路径的某个特定部分（如文件名、扩展名等）；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 解决方案：</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 下面是几个相关方法：</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; Path.GetDirectoryName ：返回指定路径字符串的目录信息；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; Path.GetExtension ： 返回指定的路径字符串的扩展名；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; Path.GetFileName ： 返回指定路径字符串的文件名和扩展名；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; Path.GetFileNameWithoutExtension ：返回不具有扩展名的路径字符串的文件名；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; Path.GetPathRoot ：获取指定路径的根目录信息；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; （更多内容还请参考MSDN）</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 问题4：</span>
   <span style="font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;color:rgb(32,0,255);">如何准确地合并两个路径而不用去担心那个烦人的”\”字符；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 解决方案：</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 使用Path.Combine方法，它会帮你处理烦人的”\”；</span> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 问题5：<span style="line-height:1.8;color:rgb(32,0,255);">如何获得系统目录的的路径（如桌面，我的文档，临时文件夹等）；</span><br> &nbsp;&nbsp;&nbsp; 解决方案：<br> &nbsp;&nbsp;&nbsp; 主要是使用System. Environment类的相关属性和方法：<br> &nbsp;&nbsp;&nbsp; Environment. SystemDirectory属性：获取系统目录的完全限定路径；<br> &nbsp;&nbsp;&nbsp; Environment. GetFolderPath方法：该方法接受的参数类型为Environment.SpecialFolder枚举，<br> &nbsp;&nbsp;&nbsp; 通过这个方法可以获得大量系统文件夹的路径，如我的电脑，我的电脑，桌面，系统目录等；<br> &nbsp;&nbsp;&nbsp; （更多内容还请参考MSDN）；<br> &nbsp;&nbsp;&nbsp; Path.GetTempPath方法：返回当前系统的临时文件夹的路径；</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 问题6：<span style="line-height:1.8;color:rgb(32,0,255);">如何判断一个路径是绝对路径还是相对路径；</span><br> &nbsp;&nbsp;&nbsp; 解决方案：<br> &nbsp;&nbsp;&nbsp; 使用Path.IsPathRooted方法；</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 问题7：<span style="line-height:1.8;color:rgb(32,0,255);">如何读取或设置当前目录；</span><br> &nbsp;&nbsp;&nbsp; 解决方案：<br> &nbsp;&nbsp;&nbsp; 使用Directory类的GetCurrentDirectory和SetCurrentDirectory方法；</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 问题8：<span style="line-height:1.8;color:rgb(32,0,255);">如何使用相对路径；</span><br> &nbsp;&nbsp;&nbsp; 解决方案：<br> &nbsp;&nbsp;&nbsp; 设置当前目录后（见问题7），就可以使用相对路径了。对于一个相对路径，我们可以<br> &nbsp;&nbsp;&nbsp; 使用Path.GetFullPath方法获得它的完全限定路径（绝对路径）。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 注意：如果打算使用相对路径，建议你将工作目录设置为各个交互文件的共同起点，否则可能会引入<br> &nbsp;&nbsp;&nbsp; 一些不易发现的安全隐患，被恶意用户利用来访问系统文件。<br><br> &nbsp;&nbsp;&nbsp; 更多内容：<br> &nbsp;&nbsp;&nbsp; 通常我们可以使用System.IO.Path类来处理路径。该类提供了一套方法和属性用于对包含文件或目录路径信息的字符串执行操作，这些操作是以跨平台的方式执行的，而这些方法和属性都是静态的。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 注意路径仅仅是提供文件或目录位置的字符串。路径不必指向磁盘上的位置，例如，路径可以映射到内存中或设备上的位置。路径的准确格式是由当前平台确定的。例如，在某些系统上，路径可以驱动器号或卷号开始，而此元素在其他系统中是不存在的。在某些系统上，文件路径可以包含扩展名，扩展名指示在文件中存储的信息的类型。文件扩展名的格式是与平台相关的；例如，某些系统将扩展名的长度限制为 3 个字符，而其他系统则没有这样的限制。当前平台还确定用于分隔路径中各元素的字符集，以及确定在指定路径时不能使用的字符集。因为这些差异，所以 Path 类的字段以及 Path 类的某些成员的准确行为是与平台相关的。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 路径可以包含绝对或相对位置信息。绝对路径完整指定一个位置：文件或目录可被唯一标识，而与当前位置无关。相对路径指定部分位置：当定位用相对路径指定的文件时，当前位置用作起始点。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; Path类的大多数成员不与文件系统交互，并且不验证路径字符串指定的文件是否存在。修改路径字符串的Path 类成员（例如 ChangeExtension）对文件系统中文件的名称没有影响。但Path成员确实验证指定路径字符串的内容；并且如果字符串包含在路径字符串中无效的字符（如 InvalidPathChars 中的定义），则引发 ArgumentException异常。例如，在基于 Windows 的桌面平台上，无效路径字符可能包括引号 (")、小于号 (&lt;)、大于号 (&gt;)、管道符号 (|)、退格 (\b)、空 (\0) 以及从 16 到 18 和从 20 到 25的 Unicode 字符。</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; Path 类的成员使您可以快速方便地执行常见操作，例如确定文件扩展名是否是路径的一部分，以及将两个字符串组合成一个路径名。</p> 
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 多数情况下，如果这些方法接收了无效的路径会抛出异常，但如果路径名是因为包含了通配符（*或?）从而无效，则不会抛出异常（可以使用GetInvalidPathChars方法来非法的路径字符）。我们可以根据该原则判断一个路径是否合法。</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp; &nbsp;&nbsp;</span>
   <strong style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">二、相关的通用文件对话框</strong>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;</span> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 1、<span style="line-height:1.8;color:rgb(32,0,255);">文件夹浏览对话框</span>（FolderBrowserDialog类）<br> &nbsp;&nbsp;&nbsp; 用户可以通过该对话框浏览、新建并选择文件夹，如下图：<br> &nbsp;&nbsp;&nbsp;&nbsp;<img alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/FolderBrowserDialog.JPG" height="325" width="338" style="border:0px;"><br></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 主要属性：<br> &nbsp;&nbsp;&nbsp; Description：树视图控件上显示的说明文本，如上图中的”选择要进行计算的目录”；<br> &nbsp;&nbsp;&nbsp; RootFolder：获取或设置从其开始浏览的根文件夹，如上图中设置的我的电脑（默认为桌面）；<br> &nbsp;&nbsp;&nbsp; SelectedPath：获取或设置用户选定的路径，如果设置了该属性，打开对话框时会定位到指定路径，默认为根文件夹，关闭对话框时根据该属性获取用户用户选定的路径；<br> &nbsp;&nbsp;&nbsp; ShowNewFolderButton：获取或设置是否显示新建对话框按钮；</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 主要方法：<br> &nbsp;&nbsp;&nbsp; ShowDialog：打开该对话框，返回值为DialogResult类型值，如果为DialogResult.OK，则可以由SelectedPath属性获取用户选定的路径；<br></p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border:1px solid rgb(204,204,204);font-size:13px;"> 
    <span style="color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;dlgOpenFolder.Description&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">选择要进行计算的目录</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;dlgOpenFolder.RootFolder&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;Environment.SpecialFolder.MyComputer;<br> &nbsp;&nbsp;&nbsp;&nbsp;dlgOpenFolder.ShowNewFolderButton&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">true</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;DialogResult&nbsp;result&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;dlgOpenFolder.ShowDialog(</span>
    <span style="color:rgb(0,0,255);">this</span>
    <span style="color:rgb(0,0,0);">);<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">&nbsp;(result&nbsp;</span>
    <span style="color:rgb(0,0,0);">==</span>
    <span style="color:rgb(0,0,0);">&nbsp;DialogResult.OK)<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;txtDirPath.Text&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;dlgOpenFolder.SelectedPath;<br> &nbsp;&nbsp;&nbsp;&nbsp;}</span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 2、<span style="line-height:1.8;color:rgb(32,0,255);">打开文件对话框</span>（OpenFileDialog类）<br> &nbsp;&nbsp;&nbsp; 用户可以通过该对话框选择一个文件，见下图：<br> &nbsp;&nbsp;&nbsp;&nbsp;<img alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/OpenFileDialog.JPG" height="419" width="571" style="border:0px;"><br></p> 
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 主要属性：</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; CheckFileExists：该值指示如果用户指定不存在的文件名，对话框是否显示警告；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; FileName(s)：获取或设置一个包含在文件对话框中选定的文件名的字符串；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; Filter：获取或设置对话框的文件类型列表；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; FilterIndex：对话框的文件类型列表的索引（基于1的）；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; InitialDirectory：获取或设置文件对话框显示的初始目录；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; Multiselect：该值指示对话框是否允许选择多个文件；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; ShowReadOnly：该值指示对话框是否包含只读复选框；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; Title：获取或设置文件对话框标题；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 主要方法：</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; OpenFile：打开用户选定的具有</span>
   <span style="font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;color:rgb(32,0,255);">只读</span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">权限的文件；</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; ShowDialog：打开该模式对话框；&nbsp;</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border:1px solid rgb(204,204,204);font-size:13px;"> 
    <span style="color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;dlgOpenFile.Title&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">打开源文件</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;dlgOpenFile.InitialDirectory&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">@"</span>
    <span style="color:rgb(0,0,0);">C:\Inetpub\</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;dlgOpenFile.Filter&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">文本文件&nbsp;(*.txt)|*.txt|所有文件&nbsp;(*.*)|*.*</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;dlgOpenFile.FilterIndex&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">2</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;dlgOpenFile.ShowReadOnly&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">true</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;DialogResult&nbsp;dr&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;dlgOpenFile.ShowDialog();<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">&nbsp;(dr&nbsp;</span>
    <span style="color:rgb(0,0,0);">==</span>
    <span style="color:rgb(0,0,0);">&nbsp;DialogResult.OK)<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;fileName = dlgOpenFile.FileName;<br> &nbsp;&nbsp;&nbsp;&nbsp;}</span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 3、<span style="line-height:1.8;color:rgb(32,0,255);">保存文件对话框</span>（SaveFileDialog类）<br> &nbsp;&nbsp;&nbsp; 用户可以通过该对话框保存一个文件，见下图：<br> &nbsp;&nbsp;&nbsp;&nbsp;<img alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/SaveFileDialog.JPG" height="422" width="571" style="border:0px;"><br></p> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 主要属性：<br> &nbsp;&nbsp;&nbsp; 大部分与打开文件对话框类似，此处略过，下面几个值得注意：<br> &nbsp;&nbsp;&nbsp; CreatePrompt：该值指示如果用户指定不存在的文件，是否提示用户允许创建该文件；<br> &nbsp;&nbsp;&nbsp; OverwritePrompt：该值指示如果用户指定的文件名已存在，对话框是否显示警告；<br> &nbsp;&nbsp;&nbsp; 主要方法：<br> &nbsp;&nbsp;&nbsp; OpenFile：打开用户选定的具有读/写权限的文件；<br> &nbsp;&nbsp;&nbsp; ShowDialog：打开该模式对话框；<br> &nbsp;&nbsp;&nbsp; 示例代码：<br></p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border:1px solid rgb(204,204,204);font-size:13px;"> 
    <span style="color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;dlgSaveFile.Title&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">打开目标文件</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;dlgSaveFile.InitialDirectory&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">@"</span>
    <span style="color:rgb(0,0,0);">C:\Inetpub\</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;dlgSaveFile.Filter&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">文本文件&nbsp;(*.txt)|*.txt|所有文件&nbsp;(*.*)|*.*</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;dlgSaveFile.FilterIndex&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">2</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;DialogResult&nbsp;dr&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;dlgSaveFile.ShowDialog();<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">&nbsp;(dr&nbsp;</span>
    <span style="color:rgb(0,0,0);">==</span>
    <span style="color:rgb(0,0,0);">&nbsp;DialogResult.OK)<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;fileName = dlgSaveFile.FileName;<br> &nbsp;&nbsp;&nbsp;&nbsp;}</span> 
   </div> 
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 至此，我们操作的都只是路径，要知道，这些路径仅仅是字符串，还没有涉及到文件系统中的真实文件。下一篇中会详细了解有关文件和目录的相关操作。</span>
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
   <span style="font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;color:rgb(32,0,255);">Anders Cui<span style="color:rgb(0,0,0);"><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<br></span></span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"></span> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 参考：<br></p> 
   <ul style="list-style:none;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">Apress-Visual C# 2005 Recipes A Problem Solution Approach</li> 
    <li style="background-image:url(&quot;images/icon_miniarrow.gif&quot;);background-position:0px 9px;background-repeat:no-repeat;list-style-type:disc;">还有不可缺少的MSDN</li> 
   </ul>
   <div>
    <font color="#333333"><span style="font-size:14px;"><br></span></font>
   </div> 
   <div> 
    <font color="#333333"><span style="font-size:14px;">本文转自一个程序员的自省博客园博客，原文链接：http://www.cnblogs.com/anderslly/archive/2006/12/24/pathcommondialog.html</span></font>
    <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">，如需转载请自行联系原作者。</span> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
