<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>QTP的那些事--操作excel的函数 « NotBeCN</title>
  <meta name="description" content="                1:  QTP Excel函数 操作EXCEL 数据表格 表单 编辑EXCEL 工作表       2:  Dim ExcelApp    'As Excel.Application       3:  Dim excelSheet 'As Excel.worksheet     ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/17/weixin_33966365_90135508.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">QTP的那些事--操作excel的函数</h1>
    <p class="post-meta">Oct 17, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <pre><span class="lnum">   1:  </span>QTP Excel函数 操作EXCEL 数据表格 表单 编辑EXCEL 工作表</pre> 
   <pre><span class="lnum">   2:  </span><span class="kwrd">Dim</span> ExcelApp    <span class="rem">'As Excel.Application</span></pre> 
   <pre><span class="lnum">   3:  </span><span class="kwrd">Dim</span> excelSheet <span class="rem">'As Excel.worksheet</span></pre> 
   <pre><span class="lnum">   4:  </span><span class="kwrd">Dim</span> excelBook   <span class="rem">'As Excel.workbook</span></pre> 
   <pre><span class="lnum">   5:  </span><span class="kwrd">Dim</span> fso         <span class="rem">'As scrīpting.FileSystemObject</span></pre> 
   <pre><span class="lnum">   6:  </span>&nbsp;</pre> 
   <pre><span class="lnum">   7:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum">   8:  </span><span class="rem">' 函数说明：创建一个Excel应用程序ExcelApp,并创建一个新的工作薄Workbook;</span></pre> 
   <pre><span class="lnum">   9:  </span><span class="rem">' 参数说明：无</span></pre> 
   <pre><span class="lnum">  10:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum">  11:  </span><span class="rem">'           CreateExcel()</span></pre> 
   <pre><span class="lnum">  12:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum">  13:  </span>&nbsp;</pre> 
   <pre><span class="lnum">  14:  </span><span class="kwrd">Function</span> CreateExcel()</pre> 
   <pre><span class="lnum">  15:  </span>    <span class="kwrd">Dim</span> excelSheet</pre> 
   <pre><span class="lnum">  16:  </span>    <span class="kwrd">Set</span> ExcelApp = CreateObject(<span class="str">"Excel.Application"</span>)</pre> 
   <pre><span class="lnum">  17:  </span>    ExcelApp.Workbooks.Add</pre> 
   <pre><span class="lnum">  18:  </span>    ExcelApp.Visible = <span class="kwrd">True</span></pre> 
   <pre><span class="lnum">  19:  </span>    <span class="kwrd">Set</span> CreateExcel = ExcelApp</pre> 
   <pre><span class="lnum">  20:  </span><span class="kwrd">End</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum">  21:  </span>&nbsp;</pre> 
   <pre><span class="lnum">  22:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum">  23:  </span><span class="rem">' 函数说明：关闭Excel应用程序;</span></pre> 
   <pre><span class="lnum">  24:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum">  25:  </span><span class="rem">'          (1)ExcelApp:Excel应用程序名称;</span></pre> 
   <pre><span class="lnum">  26:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum">  27:  </span><span class="rem">'           CloseExcel(ExcelApp)</span></pre> 
   <pre><span class="lnum">  28:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum">  29:  </span><span class="kwrd">Sub</span> CloseExcel(ExcelApp)</pre> 
   <pre><span class="lnum">  30:  </span>    <span class="kwrd">Set</span> excelSheet = ExcelApp.ActiveSheet</pre> 
   <pre><span class="lnum">  31:  </span>    <span class="kwrd">Set</span> excelBook = ExcelApp.ActiveWorkbook</pre> 
   <pre><span class="lnum">  32:  </span>    <span class="kwrd">Set</span> fso = CreateObject(<span class="str">"scrīpting.FileSystemObject"</span>)</pre> 
   <pre><span class="lnum">  33:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum">  34:  </span>    fso.CreateFolder <span class="str">"C:\Temp"</span></pre> 
   <pre><span class="lnum">  35:  </span>    fso.DeleteFile <span class="str">"C:\Temp\ExcelExamples.xls"</span></pre> 
   <pre><span class="lnum">  36:  </span>    excelBook.SaveAs <span class="str">"C:\Temp\ExcelExamples.xls"</span></pre> 
   <pre><span class="lnum">  37:  </span>    ExcelApp.Quit</pre> 
   <pre><span class="lnum">  38:  </span>    <span class="kwrd">Set</span> ExcelApp = <span class="kwrd">Nothing</span></pre> 
   <pre><span class="lnum">  39:  </span>    <span class="kwrd">Set</span> fso = <span class="kwrd">Nothing</span></pre> 
   <pre><span class="lnum">  40:  </span>    Err = 0</pre> 
   <pre><span class="lnum">  41:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">GoTo</span> 0</pre> 
   <pre><span class="lnum">  42:  </span><span class="kwrd">End</span> <span class="kwrd">Sub</span></pre> 
   <pre><span class="lnum">  43:  </span>&nbsp;</pre> 
   <pre><span class="lnum">  44:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum">  45:  </span><span class="rem">' 函数说明：保存工作薄;</span></pre> 
   <pre><span class="lnum">  46:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum">  47:  </span><span class="rem">'          (1)ExcelApp:Excel应用程序名称;</span></pre> 
   <pre><span class="lnum">  48:  </span><span class="rem">'          (2)workbookIdentifier:属于ExcelApp的工作薄名称;</span></pre> 
   <pre><span class="lnum">  49:  </span><span class="rem">'          (3)path:保存的路径;</span></pre> 
   <pre><span class="lnum">  50:  </span><span class="rem">' 返回结果：</span></pre> 
   <pre><span class="lnum">  51:  </span><span class="rem">'          (1)保存成功，返回字符串：OK</span></pre> 
   <pre><span class="lnum">  52:  </span><span class="rem">'          (2)保存失败，返回字符串：Bad Worksheet Identifier</span></pre> 
   <pre><span class="lnum">  53:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum">  54:  </span><span class="rem">'           ret = SaveWorkbook(ExcelApp, "Book1", "D:\Example1.xls")</span></pre> 
   <pre><span class="lnum">  55:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum">  56:  </span>&nbsp;</pre> 
   <pre><span class="lnum">  57:  </span><span class="kwrd">Function</span> SaveWorkbook(ExcelApp, workbookIdentifier, path) <span class="rem">'As String</span></pre> 
   <pre><span class="lnum">  58:  </span>    <span class="kwrd">Dim</span> workbook</pre> 
   <pre><span class="lnum">  59:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span> <span class="rem">'启用错误处理程序</span></pre> 
   <pre><span class="lnum">  60:  </span>    <span class="kwrd">Set</span> workbook = ExcelApp.Workbooks(workbookIdentifier)</pre> 
   <pre><span class="lnum">  61:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">GoTo</span> 0   <span class="rem">'禁用错误处理程序</span></pre> 
   <pre><span class="lnum">  62:  </span>&nbsp;</pre> 
   <pre><span class="lnum">  63:  </span>    <span class="kwrd">If</span> <span class="kwrd">Not</span> workbook <span class="kwrd">Is</span> <span class="kwrd">Nothing</span> <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum">  64:  </span>        <span class="kwrd">If</span> path = <span class="str">""</span> <span class="kwrd">Or</span> path = workbook.FullName <span class="kwrd">Or</span> path = workbook.Name <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum">  65:  </span>            workbook.Save</pre> 
   <pre><span class="lnum">  66:  </span>        <span class="kwrd">Else</span></pre> 
   <pre><span class="lnum">  67:  </span>            <span class="kwrd">Set</span> fso = CreateObject(<span class="str">"scrīpting.FileSystemObject"</span>)</pre> 
   <pre><span class="lnum">  68:  </span>&nbsp;</pre> 
   <pre><span class="lnum">  69:  </span>            <span class="rem">'判断路径中是否已添加扩展名.xls</span></pre> 
   <pre><span class="lnum">  70:  </span>            <span class="kwrd">If</span> InStr(path, <span class="str">"."</span>) = 0 <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum">  71:  </span>                path = path &amp; <span class="str">".xls"</span></pre> 
   <pre><span class="lnum">  72:  </span>            <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum">  73:  </span>&nbsp;</pre> 
   <pre><span class="lnum">  74:  </span>            <span class="rem">'删除路径下现有同名的文件</span></pre> 
   <pre><span class="lnum">  75:  </span>            <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum">  76:  </span>            fso.DeleteFile path</pre> 
   <pre><span class="lnum">  77:  </span>            <span class="kwrd">Set</span> fso = <span class="kwrd">Nothing</span></pre> 
   <pre><span class="lnum">  78:  </span>            Err = 0</pre> 
   <pre><span class="lnum">  79:  </span>            <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">GoTo</span> 0</pre> 
   <pre><span class="lnum">  80:  </span>          </pre> 
   <pre><span class="lnum">  81:  </span>            workbook.SaveAs path</pre> 
   <pre><span class="lnum">  82:  </span>        <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum">  83:  </span>        SaveWorkbook = <span class="str">"OK"</span></pre> 
   <pre><span class="lnum">  84:  </span>    <span class="kwrd">Else</span></pre> 
   <pre><span class="lnum">  85:  </span>        SaveWorkbook = <span class="str">"Bad Workbook Identifier"</span></pre> 
   <pre><span class="lnum">  86:  </span>    <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum">  87:  </span><span class="kwrd">End</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum">  88:  </span>&nbsp;</pre> 
   <pre><span class="lnum">  89:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum">  90:  </span><span class="rem">' 函数说明：设置工作表excelSheet单元格的值</span></pre> 
   <pre><span class="lnum">  91:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum">  92:  </span><span class="rem">'          (1)excelSheet:工作表名称;</span></pre> 
   <pre><span class="lnum">  93:  </span><span class="rem">'          (2)row:列的序号,第一列为1;</span></pre> 
   <pre><span class="lnum">  94:  </span><span class="rem">'          (3)column:行的序号,第一行为1;</span></pre> 
   <pre><span class="lnum">  95:  </span><span class="rem">'          (4)value:单元格要设置的值;</span></pre> 
   <pre><span class="lnum">  96:  </span><span class="rem">' 返回结果：</span></pre> 
   <pre><span class="lnum">  97:  </span><span class="rem">'          无返回值</span></pre> 
   <pre><span class="lnum">  98:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum">  99:  </span><span class="rem">'           SetCellValue excelSheet1, 1, 2, "test"</span></pre> 
   <pre><span class="lnum"> 100:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 101:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 102:  </span><span class="kwrd">Sub</span> SetCellValue(excelSheet, row, column, value)</pre> 
   <pre><span class="lnum"> 103:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 104:  </span>    excelSheet.Cells(row, column) = value</pre> 
   <pre><span class="lnum"> 105:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">GoTo</span> 0</pre> 
   <pre><span class="lnum"> 106:  </span><span class="kwrd">End</span> <span class="kwrd">Sub</span></pre> 
   <pre><span class="lnum"> 107:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 108:  </span><span class="rem">'The GetCellValue returns the cell's value according to its row column and sheet</span></pre> 
   <pre><span class="lnum"> 109:  </span><span class="rem">'excelSheet - the Excel Sheet in which the cell exists</span></pre> 
   <pre><span class="lnum"> 110:  </span><span class="rem">'row - the cell's row</span></pre> 
   <pre><span class="lnum"> 111:  </span><span class="rem">'column - the cell's column</span></pre> 
   <pre><span class="lnum"> 112:  </span><span class="rem">'return 0 if the cell could not be found</span></pre> 
   <pre><span class="lnum"> 113:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 114:  </span><span class="rem">' 函数说明：获取工作表excelSheet单元格的值</span></pre> 
   <pre><span class="lnum"> 115:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum"> 116:  </span><span class="rem">'          (1)excelSheet:工作表名称;</span></pre> 
   <pre><span class="lnum"> 117:  </span><span class="rem">'          (2)row:列的序号;</span></pre> 
   <pre><span class="lnum"> 118:  </span><span class="rem">'          (3)column:行的序号;</span></pre> 
   <pre><span class="lnum"> 119:  </span><span class="rem">' 返回结果：</span></pre> 
   <pre><span class="lnum"> 120:  </span><span class="rem">'          (1)单元格存在,返回单元格值;</span></pre> 
   <pre><span class="lnum"> 121:  </span><span class="rem">'          (2)单元格不存在，返回0;</span></pre> 
   <pre><span class="lnum"> 122:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum"> 123:  </span><span class="rem">'           set CellValue = GetCellValue(excelSheet, 1, 2)</span></pre> 
   <pre><span class="lnum"> 124:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 125:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 126:  </span><span class="kwrd">Function</span> GetCellValue(excelSheet, row, column)</pre> 
   <pre><span class="lnum"> 127:  </span>    value = 0</pre> 
   <pre><span class="lnum"> 128:  </span>    Err = 0</pre> 
   <pre><span class="lnum"> 129:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 130:  </span>    tempValue = excelSheet.Cells(row, column)</pre> 
   <pre><span class="lnum"> 131:  </span>    <span class="kwrd">If</span> Err = 0 <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 132:  </span>        value = tempValue</pre> 
   <pre><span class="lnum"> 133:  </span>        Err = 0</pre> 
   <pre><span class="lnum"> 134:  </span>    <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 135:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">GoTo</span> 0</pre> 
   <pre><span class="lnum"> 136:  </span>    GetCellValue = value</pre> 
   <pre><span class="lnum"> 137:  </span><span class="kwrd">End</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 138:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 139:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 140:  </span><span class="rem">' 函数说明：获取并返回工作表对象</span></pre> 
   <pre><span class="lnum"> 141:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum"> 142:  </span><span class="rem">'          (1)ExcelApp:Excel应用程序名称;</span></pre> 
   <pre><span class="lnum"> 143:  </span><span class="rem">'          (2)sheetIdentifier:属于ExcelApp的工作表名称;</span></pre> 
   <pre><span class="lnum"> 144:  </span><span class="rem">' 返回结果：</span></pre> 
   <pre><span class="lnum"> 145:  </span><span class="rem">'          (1)成功：工作表对象Excel.worksheet</span></pre> 
   <pre><span class="lnum"> 146:  </span><span class="rem">'          (1)失败：Nothing</span></pre> 
   <pre><span class="lnum"> 147:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum"> 148:  </span><span class="rem">'           Set excelSheet1 = GetSheet(ExcelApp, "Sheet Name")</span></pre> 
   <pre><span class="lnum"> 149:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 150:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 151:  </span><span class="kwrd">Function</span> GetSheet(ExcelApp, sheetIdentifier)</pre> 
   <pre><span class="lnum"> 152:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 153:  </span>    <span class="kwrd">Set</span> GetSheet = ExcelApp.Worksheets.Item(sheetIdentifier)</pre> 
   <pre><span class="lnum"> 154:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">GoTo</span> 0</pre> 
   <pre><span class="lnum"> 155:  </span><span class="kwrd">End</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 156:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 157:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 158:  </span><span class="rem">' 函数说明：添加一张新的工作表</span></pre> 
   <pre><span class="lnum"> 159:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum"> 160:  </span><span class="rem">'          (1)ExcelApp:Excel应用程序名称;</span></pre> 
   <pre><span class="lnum"> 161:  </span><span class="rem">'          (2)workbookIdentifier:属于ExcelApp的工作薄名称;</span></pre> 
   <pre><span class="lnum"> 162:  </span><span class="rem">'          (2)sheetName:要插入的工作表名称;</span></pre> 
   <pre><span class="lnum"> 163:  </span><span class="rem">' 返回结果：</span></pre> 
   <pre><span class="lnum"> 164:  </span><span class="rem">'          (1)成功：工作表对象worksheet</span></pre> 
   <pre><span class="lnum"> 165:  </span><span class="rem">'          (1)失败：Nothing</span></pre> 
   <pre><span class="lnum"> 166:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum"> 167:  </span><span class="rem">'           InsertNewWorksheet(ExcelApp, workbookIdentifier, "new sheet")</span></pre> 
   <pre><span class="lnum"> 168:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 169:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 170:  </span><span class="kwrd">Function</span> InsertNewWorksheet(ExcelApp, workbookIdentifier, sheetName)</pre> 
   <pre><span class="lnum"> 171:  </span>    <span class="kwrd">Dim</span> workbook <span class="rem">'As Excel.workbook</span></pre> 
   <pre><span class="lnum"> 172:  </span>    <span class="kwrd">Dim</span> worksheet <span class="rem">'As Excel.worksheet</span></pre> 
   <pre><span class="lnum"> 173:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 174:  </span>    <span class="rem">'如果指定的工作薄不存在，将在当前激活状态的工作表中添加工作表</span></pre> 
   <pre><span class="lnum"> 175:  </span>    <span class="kwrd">If</span> workbookIdentifier = <span class="str">""</span> <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 176:  </span>        <span class="kwrd">Set</span> workbook = ExcelApp.ActiveWorkbook</pre> 
   <pre><span class="lnum"> 177:  </span>    <span class="kwrd">Else</span></pre> 
   <pre><span class="lnum"> 178:  </span>        <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 179:  </span>        Err = 0</pre> 
   <pre><span class="lnum"> 180:  </span>        <span class="kwrd">Set</span> workbook = ExcelApp.Workbooks(workbookIdentifier)</pre> 
   <pre><span class="lnum"> 181:  </span>        <span class="kwrd">If</span> Err &lt;&gt; 0 <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 182:  </span>            <span class="kwrd">Set</span> InsertNewWorksheet = <span class="kwrd">Nothing</span></pre> 
   <pre><span class="lnum"> 183:  </span>            Err = 0</pre> 
   <pre><span class="lnum"> 184:  </span>            <span class="kwrd">Exit</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 185:  </span>        <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 186:  </span>        <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">GoTo</span> 0</pre> 
   <pre><span class="lnum"> 187:  </span>    <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 188:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 189:  </span>    sheetCount = workbook.Sheets.Count <span class="rem">'获取工作薄中工作表的数量</span></pre> 
   <pre><span class="lnum"> 190:  </span>    workbook.Sheets.Add , sheetCount <span class="rem">'添加工作表</span></pre> 
   <pre><span class="lnum"> 191:  </span>    <span class="kwrd">Set</span> worksheet = workbook.Sheets(sheetCount + 1) <span class="rem">'初始化worksheet为新添加的工作表对象</span></pre> 
   <pre><span class="lnum"> 192:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 193:  </span>    <span class="rem">'设置新添加的工作表名称</span></pre> 
   <pre><span class="lnum"> 194:  </span>    <span class="kwrd">If</span> sheetName &lt;&gt; <span class="str">""</span> <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 195:  </span>        worksheet.Name = sheetName</pre> 
   <pre><span class="lnum"> 196:  </span>    <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 197:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 198:  </span>    <span class="kwrd">Set</span> InsertNewWorksheet = worksheet</pre> 
   <pre><span class="lnum"> 199:  </span><span class="kwrd">End</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 200:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 201:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 202:  </span><span class="rem">' 函数说明：修改工作表的名称;</span></pre> 
   <pre><span class="lnum"> 203:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum"> 204:  </span><span class="rem">'          (1)ExcelApp:Excel应用程序名称;</span></pre> 
   <pre><span class="lnum"> 205:  </span><span class="rem">'          (2)workbookIdentifier:属于ExcelApp的工作薄名称;</span></pre> 
   <pre><span class="lnum"> 206:  </span><span class="rem">'          (3)worksheetIdentifier:属于workbookIdentifier工作薄的工作表名称;</span></pre> 
   <pre><span class="lnum"> 207:  </span><span class="rem">'          (4)sheetName:修改后的工作表名称;</span></pre> 
   <pre><span class="lnum"> 208:  </span><span class="rem">' 返回结果：</span></pre> 
   <pre><span class="lnum"> 209:  </span><span class="rem">'          (1)修改成功，返回字符串：OK</span></pre> 
   <pre><span class="lnum"> 210:  </span><span class="rem">'          (2)修改失败，返回字符串：Bad Worksheet Identifier</span></pre> 
   <pre><span class="lnum"> 211:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum"> 212:  </span><span class="rem">'           set ret = RenameWorksheet(ExcelApp, "Book1", "Sheet1", "Sheet Name")</span></pre> 
   <pre><span class="lnum"> 213:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 214:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 215:  </span><span class="kwrd">Function</span> RenameWorksheet(ExcelApp, workbookIdentifier, worksheetIdentifier, sheetName)</pre> 
   <pre><span class="lnum"> 216:  </span>    <span class="kwrd">Dim</span> workbook</pre> 
   <pre><span class="lnum"> 217:  </span>    <span class="kwrd">Dim</span> worksheet</pre> 
   <pre><span class="lnum"> 218:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 219:  </span>    Err = 0</pre> 
   <pre><span class="lnum"> 220:  </span>    <span class="kwrd">Set</span> workbook = ExcelApp.Workbooks(workbookIdentifier)</pre> 
   <pre><span class="lnum"> 221:  </span>    <span class="kwrd">If</span> Err &lt;&gt; 0 <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 222:  </span>        RenameWorksheet = <span class="str">"Bad Workbook Identifier"</span></pre> 
   <pre><span class="lnum"> 223:  </span>        Err = 0</pre> 
   <pre><span class="lnum"> 224:  </span>        <span class="kwrd">Exit</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 225:  </span>    <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 226:  </span>    <span class="kwrd">Set</span> worksheet = workbook.Sheets(worksheetIdentifier)</pre> 
   <pre><span class="lnum"> 227:  </span>    <span class="kwrd">If</span> Err &lt;&gt; 0 <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 228:  </span>        RenameWorksheet = <span class="str">"Bad Worksheet Identifier"</span></pre> 
   <pre><span class="lnum"> 229:  </span>        Err = 0</pre> 
   <pre><span class="lnum"> 230:  </span>        <span class="kwrd">Exit</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 231:  </span>    <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 232:  </span>    worksheet.Name = sheetName</pre> 
   <pre><span class="lnum"> 233:  </span>    RenameWorksheet = <span class="str">"OK"</span></pre> 
   <pre><span class="lnum"> 234:  </span><span class="kwrd">End</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 235:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 236:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 237:  </span><span class="rem">' 函数说明：删除工作表;</span></pre> 
   <pre><span class="lnum"> 238:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum"> 239:  </span><span class="rem">'          (1)ExcelApp:Excel应用程序名称;</span></pre> 
   <pre><span class="lnum"> 240:  </span><span class="rem">'          (2)workbookIdentifier:属于ExcelApp的工作薄名称;</span></pre> 
   <pre><span class="lnum"> 241:  </span><span class="rem">'          (3)worksheetIdentifier:属于workbookIdentifier工作薄的工作表名称;</span></pre> 
   <pre><span class="lnum"> 242:  </span><span class="rem">' 返回结果：</span></pre> 
   <pre><span class="lnum"> 243:  </span><span class="rem">'          (1)删除成功，返回字符串：OK</span></pre> 
   <pre><span class="lnum"> 244:  </span><span class="rem">'          (2)删除失败，返回字符串：Bad Worksheet Identifier</span></pre> 
   <pre><span class="lnum"> 245:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum"> 246:  </span><span class="rem">'           set ret = RemoveWorksheet(ExcelApp, "Book1", "Sheet1")</span></pre> 
   <pre><span class="lnum"> 247:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 248:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 249:  </span><span class="kwrd">Function</span> RemoveWorksheet(ExcelApp, workbookIdentifier, worksheetIdentifier)</pre> 
   <pre><span class="lnum"> 250:  </span>    <span class="kwrd">Dim</span> workbook <span class="rem">'As Excel.workbook</span></pre> 
   <pre><span class="lnum"> 251:  </span>    <span class="kwrd">Dim</span> worksheet <span class="rem">'As Excel.worksheet</span></pre> 
   <pre><span class="lnum"> 252:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 253:  </span>    Err = 0</pre> 
   <pre><span class="lnum"> 254:  </span>    <span class="kwrd">Set</span> workbook = ExcelApp.Workbooks(workbookIdentifier)</pre> 
   <pre><span class="lnum"> 255:  </span>    <span class="kwrd">If</span> Err &lt;&gt; 0 <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 256:  </span>        RemoveWorksheet = <span class="str">"Bad Workbook Identifier"</span></pre> 
   <pre><span class="lnum"> 257:  </span>        <span class="kwrd">Exit</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 258:  </span>    <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 259:  </span>    <span class="kwrd">Set</span> worksheet = workbook.Sheets(worksheetIdentifier)</pre> 
   <pre><span class="lnum"> 260:  </span>    <span class="kwrd">If</span> Err &lt;&gt; 0 <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 261:  </span>        RemoveWorksheet = <span class="str">"Bad Worksheet Identifier"</span></pre> 
   <pre><span class="lnum"> 262:  </span>        <span class="kwrd">Exit</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 263:  </span>    <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 264:  </span>    worksheet.Delete</pre> 
   <pre><span class="lnum"> 265:  </span>    RemoveWorksheet = <span class="str">"OK"</span></pre> 
   <pre><span class="lnum"> 266:  </span><span class="kwrd">End</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 267:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 268:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 269:  </span><span class="rem">' 函数说明：添加新的工作薄</span></pre> 
   <pre><span class="lnum"> 270:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum"> 271:  </span><span class="rem">'          (1)ExcelApp:Excel应用程序名称;</span></pre> 
   <pre><span class="lnum"> 272:  </span><span class="rem">' 返回结果：</span></pre> 
   <pre><span class="lnum"> 273:  </span><span class="rem">'          (1)成功：工作表对象NewWorkbook</span></pre> 
   <pre><span class="lnum"> 274:  </span><span class="rem">'          (1)失败：Nothing</span></pre> 
   <pre><span class="lnum"> 275:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum"> 276:  </span><span class="rem">'          set NewWorkbook = CreateNewWorkbook(ExcelApp)</span></pre> 
   <pre><span class="lnum"> 277:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 278:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 279:  </span><span class="kwrd">Function</span> CreateNewWorkbook(ExcelApp)</pre> 
   <pre><span class="lnum"> 280:  </span>    <span class="kwrd">Set</span> NewWorkbook = ExcelApp.Workbooks.Add()</pre> 
   <pre><span class="lnum"> 281:  </span>    <span class="kwrd">Set</span> CreateNewWorkbook = NewWorkbook</pre> 
   <pre><span class="lnum"> 282:  </span><span class="kwrd">End</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 283:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 284:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 285:  </span><span class="rem">' 函数说明：打开工作薄</span></pre> 
   <pre><span class="lnum"> 286:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum"> 287:  </span><span class="rem">'          (1)ExcelApp:Excel应用程序名称;</span></pre> 
   <pre><span class="lnum"> 288:  </span><span class="rem">'          (2)path:要打开的工作薄路径;</span></pre> 
   <pre><span class="lnum"> 289:  </span><span class="rem">' 返回结果：</span></pre> 
   <pre><span class="lnum"> 290:  </span><span class="rem">'          (1)成功：工作表对象NewWorkbook</span></pre> 
   <pre><span class="lnum"> 291:  </span><span class="rem">'          (1)失败：Nothing</span></pre> 
   <pre><span class="lnum"> 292:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum"> 293:  </span><span class="rem">'          set NewWorkbook = CreateNewWorkbook(ExcelApp)</span></pre> 
   <pre><span class="lnum"> 294:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 295:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 296:  </span><span class="kwrd">Function</span> OpenWorkbook(ExcelApp, path)</pre> 
   <pre><span class="lnum"> 297:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 298:  </span>    <span class="kwrd">Set</span> NewWorkbook = ExcelApp.Workbooks.Open(path)</pre> 
   <pre><span class="lnum"> 299:  </span>    <span class="kwrd">Set</span> ōpenWorkbook = NewWorkbook</pre> 
   <pre><span class="lnum"> 300:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">GoTo</span> 0</pre> 
   <pre><span class="lnum"> 301:  </span><span class="kwrd">End</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 302:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 303:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 304:  </span><span class="rem">' 函数说明：将工作薄设置为当前工作状态</span></pre> 
   <pre><span class="lnum"> 305:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum"> 306:  </span><span class="rem">'          (1)ExcelApp:Excel应用程序名称;</span></pre> 
   <pre><span class="lnum"> 307:  </span><span class="rem">'          (2)workbookIdentifier:要设置为当前工作状态的工作薄名称;</span></pre> 
   <pre><span class="lnum"> 308:  </span><span class="rem">' 返回结果：无返回值;</span></pre> 
   <pre><span class="lnum"> 309:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum"> 310:  </span><span class="rem">'          ActivateWorkbook(ExcelApp, workbook1)</span></pre> 
   <pre><span class="lnum"> 311:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 312:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 313:  </span><span class="kwrd">Sub</span> ActivateWorkbook(ExcelApp, workbookIdentifier)</pre> 
   <pre><span class="lnum"> 314:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 315:  </span>    ExcelApp.Workbooks(workbookIdentifier).Activate</pre> 
   <pre><span class="lnum"> 316:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">GoTo</span> 0</pre> 
   <pre><span class="lnum"> 317:  </span><span class="kwrd">End</span> <span class="kwrd">Sub</span></pre> 
   <pre><span class="lnum"> 318:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 319:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 320:  </span><span class="rem">' 函数说明：关闭Excel工作薄;</span></pre> 
   <pre><span class="lnum"> 321:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum"> 322:  </span><span class="rem">'          (1)ExcelApp:Excel应用程序名称;</span></pre> 
   <pre><span class="lnum"> 323:  </span><span class="rem">'          (2)workbookIdentifier:</span></pre> 
   <pre><span class="lnum"> 324:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum"> 325:  </span><span class="rem">'           CloseWorkbook(ExcelApp, workbookIdentifier)</span></pre> 
   <pre><span class="lnum"> 326:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 327:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 328:  </span><span class="kwrd">Sub</span> CloseWorkbook(ExcelApp, workbookIdentifier)</pre> 
   <pre><span class="lnum"> 329:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">Resume</span> <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 330:  </span>    ExcelApp.Workbooks(workbookIdentifier).Close</pre> 
   <pre><span class="lnum"> 331:  </span>    <span class="kwrd">On</span> <span class="kwrd">Error</span> <span class="kwrd">GoTo</span> 0</pre> 
   <pre><span class="lnum"> 332:  </span><span class="kwrd">End</span> <span class="kwrd">Sub</span></pre> 
   <pre><span class="lnum"> 333:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 334:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 335:  </span><span class="rem">' 函数说明：判断两个工作表对应单元格内容是否相等</span></pre> 
   <pre><span class="lnum"> 336:  </span><span class="rem">' 参数说明：</span></pre> 
   <pre><span class="lnum"> 337:  </span><span class="rem">'          (1)sheet1:工作表1的名称;</span></pre> 
   <pre><span class="lnum"> 338:  </span><span class="rem">'          (2)sheet2:工作表2的名称;</span></pre> 
   <pre><span class="lnum"> 339:  </span><span class="rem">'          (3)startColumn:开始比较的行序号;</span></pre> 
   <pre><span class="lnum"> 340:  </span><span class="rem">'          (4)numberOfColumns:要比较的行数;</span></pre> 
   <pre><span class="lnum"> 341:  </span><span class="rem">'          (5)startRow:开始比较的列序号;</span></pre> 
   <pre><span class="lnum"> 342:  </span><span class="rem">'          (6)numberOfRows:要比较的列数;</span></pre> 
   <pre><span class="lnum"> 343:  </span><span class="rem">'          (7)trimed:是否先除去字符串开始的空格和尾部空格后再进行比较,true或flase;</span></pre> 
   <pre><span class="lnum"> 344:  </span><span class="rem">' 返回结果：</span></pre> 
   <pre><span class="lnum"> 345:  </span><span class="rem">'          (1)两工作表对应单元格内容相等：true</span></pre> 
   <pre><span class="lnum"> 346:  </span><span class="rem">'          (2)两工作表对应单元格内容不相等:flase       </span></pre> 
   <pre><span class="lnum"> 347:  </span><span class="rem">' 调用方法:</span></pre> 
   <pre><span class="lnum"> 348:  </span><span class="rem">'           ret = CompareSheets(excelSheet1, excelSheet2, 1, 10, 1, 10, False)</span></pre> 
   <pre><span class="lnum"> 349:  </span><span class="rem">' *********************************************************************************************</span></pre> 
   <pre><span class="lnum"> 350:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 351:  </span><span class="kwrd">Function</span> CompareSheets(sheet1, sheet2, startColumn, numberOfColumns, startRow, numberOfRows, trimed)</pre> 
   <pre><span class="lnum"> 352:  </span>    <span class="kwrd">Dim</span> returnVal <span class="rem">'As Boolean</span></pre> 
   <pre><span class="lnum"> 353:  </span>    returnVal = <span class="kwrd">True</span></pre> 
   <pre><span class="lnum"> 354:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 355:  </span>    <span class="rem">'判断两个工作表是否都存在,任何一个不存在停止判断，返回flase</span></pre> 
   <pre><span class="lnum"> 356:  </span>    <span class="kwrd">If</span> sheet1 <span class="kwrd">Is</span> <span class="kwrd">Nothing</span> <span class="kwrd">Or</span> sheet2 <span class="kwrd">Is</span> <span class="kwrd">Nothing</span> <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 357:  </span>        CompareSheets = <span class="kwrd">False</span></pre> 
   <pre><span class="lnum"> 358:  </span>        <span class="kwrd">Exit</span> <span class="kwrd">Function</span></pre> 
   <pre><span class="lnum"> 359:  </span>    <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 360:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 361:  </span>    <span class="rem">'循环判断两个工作表单元格的值是否相等</span></pre> 
   <pre><span class="lnum"> 362:  </span>    <span class="kwrd">For</span> r = startRow <span class="kwrd">to</span> (startRow + (numberOfRows - 1))</pre> 
   <pre><span class="lnum"> 363:  </span>        <span class="kwrd">For</span> c = startColumn <span class="kwrd">to</span> (startColumn + (numberOfColumns - 1))</pre> 
   <pre><span class="lnum"> 364:  </span>            Value1 = sheet1.Cells(r, c)</pre> 
   <pre><span class="lnum"> 365:  </span>            Value2 = sheet2.Cells(r, c)</pre> 
   <pre><span class="lnum"> 366:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 367:  </span>            <span class="rem">'如果trimed为true,去除单元格内容前面和尾部空格</span></pre> 
   <pre><span class="lnum"> 368:  </span>            <span class="kwrd">If</span> trimed <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 369:  </span>                Value1 = Trim(Value1)</pre> 
   <pre><span class="lnum"> 370:  </span>                Value2 = Trim(Value2)</pre> 
   <pre><span class="lnum"> 371:  </span>            <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 372:  </span>&nbsp;</pre> 
   <pre><span class="lnum"> 373:  </span>            <span class="rem">'如果单元格内容不一致,函数返回flase</span></pre> 
   <pre><span class="lnum"> 374:  </span>            <span class="kwrd">If</span> Value1 &lt;&gt; Value2 <span class="kwrd">Then</span></pre> 
   <pre><span class="lnum"> 375:  </span>                <span class="kwrd">Dim</span> cell <span class="rem">'As Excel.Range</span></pre> 
   <pre><span class="lnum"> 376:  </span>                <span class="rem">'修改sheet2工作表中对应单元格值</span></pre> 
   <pre><span class="lnum"> 377:  </span>                sheet2.Cells(r, c) = <span class="str">"Compare conflict - Value was '"</span> &amp; Value2 &amp; <span class="str">"', Expected value is '"</span> &amp; Value1 &amp; <span class="str">"'."</span></pre> 
   <pre><span class="lnum"> 378:  </span>                <span class="rem">'初始化cell为sheet2中r:c单元格对象</span></pre> 
   <pre><span class="lnum"> 379:  </span>                <span class="kwrd">Set</span> cell = sheet2.Cells(r, c) <span class="rem">'</span></pre> 
   <pre><span class="lnum"> 380:  </span>                <span class="rem">'将sheet2工作表中对应单元格的颜色设置为红色</span></pre> 
   <pre><span class="lnum"> 381:  </span>                cell.Font.Color = vbRed</pre> 
   <pre><span class="lnum"> 382:  </span>                returnVal = <span class="kwrd">False</span></pre> 
   <pre><span class="lnum"> 383:  </span>            <span class="kwrd">End</span> <span class="kwrd">If</span></pre> 
   <pre><span class="lnum"> 384:  </span>        <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 385:  </span>    <span class="kwrd">Next</span></pre> 
   <pre><span class="lnum"> 386:  </span>    CompareSheets = returnVal</pre> 
   <pre><span class="lnum"> 387:  </span><span class="kwrd">End</span> <span class="kwrd">Function</span></pre> 
   <p style="font-size:12px;"><span class="lnum"> 388: </span>&nbsp;</p> 
   <p style="font-size:12px;"><br></p> 
   <p style="font-size:12px;"><br></p> 
   <p><span style="font-size:12px;">本文转自hcy's workbench博客园博客，原文链接：http://www.cnblogs.com/alterhu/archive/2011/12/29/2306014.html，如需转载请自行联系原作者。</span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
