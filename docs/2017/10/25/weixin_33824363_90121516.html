<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>(转)理解 Ruby Symbol « NotBeCN</title>
  <meta name="description" content="                  Symbol 是什么     　　Ruby 是一个强大的面向对象脚本语言（本文所用 Ruby 版本为1.8.6），在 Ruby 中 Symbol 表示“名字”，比如字符串的名字，标识符的名字。创建一个 Symbol 对象的方法是在名字或者字符串前面加上冒号：     创建 sy...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/25/weixin_33824363_90121516.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">(转)理解 Ruby Symbol</h1>
    <p class="post-meta">Oct 25, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body"> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span class="atitle" style="line-height:1.8;">Symbol 是什么</span></strong></p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　Ruby 是一个强大的面向对象脚本语言（本文所用 Ruby 版本为1.8.6），在 Ruby 中 Symbol 表示“名字”，比如字符串的名字，标识符的名字。创建一个 Symbol 对象的方法是在名字或者字符串前面加上冒号：</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><strong>创建 symbol 对象</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">:foo
:test </pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"> <pre class="displaycode"><code>:”</code>abc<code>”</code></pre> <pre class="displaycode">:"I am a boy”</pre> </td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　你可能会问，字符串就是字符串，干吗还有字符串的名字？这是因为在 Ruby 中字符串也是一种对象，即 String 对象。无论其结构还是操作和 Symbol 对象都是不同的。在 Ruby 中每一个对象都有唯一的对象标识符（Object Identifier），可以通过 object_id 方法来得到一个对象的标识符。我们来看看 Symbol 对象和 String 对象的差别：</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><strong>Ruby 对象标识符</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">irb(main):001:0&gt; puts :foo.object_id
327458
=&gt; nil
irb(main):002:0&gt; puts :foo.object_id
327458
=&gt; nil
irb(main):003:0&gt; puts :"foo".object_id
327458
=&gt; nil
irb(main):004:0&gt; puts "foo".object_id
24303850
=&gt; nil
irb(main):005:0&gt; puts "foo".object_id
24300010
=&gt; nil
irb(main):006:0&gt; puts "foo".object_id
24296170
=&gt; nil</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　可以看到，前三行语句中的 :foo （或者 :"foo"）都是同一个 Symbol 对象，其 object id 为327458，而后三行中的字符串”foo”都是不同的对象，其 object id 依次为24303850、24300010、24296170。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　可见，每个 String 对象都是不同的，即便他们包含了相同的字符串内容；而对于 Symbol 对象，一个名字（字符串内容）<strong>唯一确定</strong>一个 Symbol 对象。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">值得注意的是创建 Symbol 对象的字符串中不能含有’\0’字符，而 String 对象是可以的。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><strong>非法 Symbol 字符串</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">irb(main):001:0&gt;  :"fo\0o"
SyntaxError: compile error
(irb):1: symbol cannot contain '\0'
        from (irb):1
irb(main):002:0&gt; :"foo\0"
SyntaxError: compile error
(irb):2: symbol cannot contain '\0'
        from (irb):2
irb(main):003:0&gt; puts "foo\0".object_id
24305140
=&gt; nil
irb(main):004:0&gt; puts "fo\0o".object_id
24301000
=&gt; nil
irb(main):005:0&gt;</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　除了可以采用一般的字符串，还可以使用操作符（例如+, -, *, /），变量，常量，方法甚至类的名字来创建 Symbol 对象，例如:+就是一个合法的 Symbol 。实际上，在 Ruby 内部操作符、变量等名字本身就是作为 Symbol 处理的，例如当你定义一个实例变量时， Ruby 会自动创建一个 Symbol 对象，例如 @test 对应为 :@test 。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><a name="N10090" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a><strong>实例变量的 Symbol</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">class Test  			
 attr_accessor :test
end</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　这个类定义了一个具有读写方法的实例变量 @test 。实际上 Ruby 创建了两个 Symbol ，一个是实例变量的 symbol :@test ，另一个是 :test 。那如果使用字符串对象 ”test” 作为参数呢？也可以，仍然会创建两个 symbol ，:test 和 :@test ，为什么还会创建 :test 呢？这是和Ruby的实现相关的（至少Ruby1.8.6里是这样）。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">注意，类变量 @@test 和实例变量 @test 对应的 Symbol 显然是不同的。记住：<strong>名字相同，则Symbol 相同</strong>。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><a name="N100A3" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a><strong>名字相同， Symbol 相同</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">class Test  			
  puts :Test.object_id
  Test = 10
  puts :Test.object_id
  
  def Test  					
    puts :Test.object_id
  end  
end 

Test.new.Test</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>运行结果</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">224298
224298
224298</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong></strong>&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>名字不同， Symbol 不同</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">class Test  			
  puts :Test.object_id

  @@test = 10
  puts :@@test.object_id
  def test  					
    puts :test.object_id
    @test = 10  				
    puts :@test.object_id

  end  
end 

t =Test.new  
t.test  </pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><strong>运行结果</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">224298
288068
79858
288108</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　第一个例子里，类名、常量名和方法名都是 Test ，因此相应的 Symbol 对象都是 :Test 。不用担心， Ruby 可以很好区分它在不同上下文中到底表示什么。当然这并不是一个好的编程风格，但对于理解 Ruby 的 Symbol 还是有帮助的： Symbol 表示一个名字，仅此而已。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　Symbol 对象一旦定义将一直存在，直到程序执行退出。所有 Symbol 对象存放在 Ruby 内部的符号表中，可以通过类方法&nbsp;<code>Symbol.all_symbols</code>&nbsp;得到当前 Ruby 程序中定义的所有 Symbol 对象，该方法返回一个 Symbol 对象数组。由于 Symbol 比较多，你可以 dump 到文件中来查看。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><a name="N100D5" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a><strong>all_symbols 方法</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">irb(main):001:0&gt; Symbol.all_symbols.size
=&gt; 4047
irb(main):002:0&gt; Symbol.all_symbols[0..9]
=&gt; [:@level_notifier, :ppx, :msg_dn, :version, :secs, :@user, :pos, :socketpair,
 :TkENSURE, :HTTPAccepted]
irb(main):003:0&gt; File.open("sym", "w") do |file| file.puts Symbol.all_symbols end
=&gt; nil</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><a name="2.Symbol%20%E5%92%8C%20String%7Coutline" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a><strong><span class="atitle" style="line-height:1.8;">Symbol 和 String</span></strong></p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　Symbol 对象和 String 对象是完全不同的东西，对象标识符很明确的说明了这一点。除此之外，我们还可以从两种对象的方法上区分。查看 Ruby 库参考，你会发现 String 类有非常多的方法，包括 Mixed-in 方法（Ruby中一个类通过 include 其他模块而得到的方法，实现多重继承的效果）、类方法和实例方法；而 Symbol 类只有一个类方法&nbsp;<code>all_symbols</code>&nbsp;和7个实例方法。例如，可以通过&nbsp;<code>[]=</code>&nbsp;方法改变 string 的内容，而 symbol 则不行：</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><a name="N100F6" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a><strong>[]= 方法比较</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">irb(main):001:0&gt; s="test"
=&gt; "test"
irb(main):002:0&gt; s[0]='1'
=&gt; "1"
irb(main):003:0&gt; puts s
1est
=&gt; nil
irb(main):004:0&gt; sym=:test
=&gt; :test
irb(main):005:0&gt; sym[0]=1
<strong>NoMethodError: undefined method `[]=' for :test:Symbol</strong>
        from (irb):5
irb(main):006:0&gt;</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　虽然 Symbol 和 String 是不同的对象，但它们之间关系很密切。 Ruby 提供了方法在 Symbol和 String 之间转换。<span class="smalltitle" style="line-height:1.8;">Symbol 转化为 String,</span>使用 to_s 或 id2name 方法将 Symbol 转化为一个 String 对象：</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><a name="N1010F" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a><strong>Symbol 到 String</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">irb(main):001:0&gt; :test.id2name
=&gt; "test"
irb(main):002:0&gt; :test.to_s
=&gt; "test"
irb(main):003:0&gt; :"I am a boy".to_s
=&gt; "I am a boy"</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(255,0,0);">　　注意</span>，每个 String 对象都是唯一的，因此对一个 Symbol 调用多次将产生多个 String 对象。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span class="smalltitle" style="line-height:1.8;">　　String 转化为 Symbol,</span>除了在字符串前面加冒号，还可以使用 to_sym 或 intern 方法将 String 转化为 Symbol ，如果该 Symbol 已经存在，则直接返回。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><strong>String 到 Symbol</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">irb(main):001:0&gt; var1 = "test".to_sym
=&gt; :test
irb(main):002:0&gt; var2 = "test".intern
=&gt; :test
irb(main):003:0&gt; var1 == var2
=&gt; true
irb(main):004:0&gt;</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><a name="3.%E4%BD%BF%E7%94%A8%20Symbol%7Coutline" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a><strong><span class="atitle" style="line-height:1.8;">使用 Symbol</span></strong></p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　正如前边提到的， Ruby 内部一直在使用 Symbol ，比如 Ruby 程序中的各种名字，Symbol本质上是 Ruby 符号表中的东西。使用 Symbol 处理名字可以降低 Ruby 内存消耗，提高执行速度，这点我们在下一篇文章中会看到。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　那么 Symbol 对我们有什么用呢？当然也是内存。使用 String 的开销太大了，因为每一个String 都是一个对象。想想前边的例子，一个字符串每出现一次 Ruby 就会创建一个 String 对象。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　通常来讲，当你面临 String 还是 Symbol 的选择时，可以参考以下标准：</p> 
    <ul style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     <li style="list-style:disc;">如果使用字符串的内容，这个内容可能会变化，使用 String</li>
    </ul>
    <ul style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     <li style="list-style:disc;">如果使用固定的名字或者说是标识符，使用 Symbol</li>
    </ul>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　那么什么时候我们会用到名字呢？很多时候都会，比如枚举值、关键字（哈希表关键字、方法的参数）等等;<span class="smalltitle" style="line-height:1.8;">作为哈希表的 key,</span>哈希表是 Symbol 应用最为广泛的地方。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">在ruby中，哈希和数组类似，一个哈希表是一系列 key/value 对的集合，只不过它的 key 取值范围更广泛，可以是任何对象，比如正则表达式。但通常我们都会取有意义的 key ，比如 String、Symbol 。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">下面这个哈希表表示按城市分类的一些机器的集合。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><strong>一个哈希表例子</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">hosts{
       'beijing' =&gt; 'machine1',
       'shanghai'  =&gt; 'machine2',
       'guangzhou' =&gt; 'machine3',
       'tianjin' =&gt;  'machine4',
       'shenzhen' =&gt;　'machine5'
}</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　如果要引用 beijing 的机器，使用 hosts['beijing'] 。但如果我们程序中要频繁引用哈希表中 value ，这样就不大好了，因为 Ruby 对每一次字符串引用都会生成一个 String 对象，累积下来这个开销是相当大的。</p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">我们完全可以使用 Symbol ，因为对于这些 key 来讲，我们用的就是名字而已，例如下面hosts[:beijing]</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong></strong>&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>使用 Symbol 作为 key</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">hosts　=　{
　:beijing　=&gt;　'machine1',
　:shanghai　=&gt;　'machine2',
　:guangzhou　=&gt;　'machine3',
　:tianjin 　=&gt;　'machine4',
　:shenzhen　=&gt;　'machine5'
}</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong></strong>&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>哈希参数</strong></p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　通常我们定义的函数的参数的个数和顺序是写死的，调用函数的时候要确保参数的个数、顺序匹配，有时候这样很不方便，使用哈希参数可以解决这个问题。ROR 中就大量地运用这种方式，也许你已经看到了，到处都是 Symbol 和哈希。比如：<br><strong></strong></p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>使用哈希参数的方法调用</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">link_to 'Show', :action =&gt; 'show', :id =&gt; product

add_column :products, :price, :decimal, 
:precision =&gt; 8, :scale =&gt; 2, :default =&gt; 0</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">使用哈希参数的方法可以如下定义，前半部分为固定参数，后面为可变参数，或者干脆全采用哈希参数：<br><strong></strong></p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>哈希参数</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">def my_method(para1, …, options={})
#your code
end

def my_method(options={})
#your code
end</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;　　</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　如果你希望设定一些默认参数，并允许调用者更改这些参数，可以使用哈希对象的 merge! 方法,&nbsp;<code>hsh.merge!( other_hash )</code>。<code>该方法将</code>&nbsp;<code>other_hash</code>&nbsp;<code>里内容加到</code>&nbsp;<code>hsh</code>&nbsp;<code>中，如果other_hash</code>&nbsp;<code>与</code>&nbsp;<code>hsh</code>&nbsp;<code>有重复的</code>&nbsp;<code>key</code>&nbsp;<code>，则</code>&nbsp;<code>key</code>&nbsp;<code>在</code>&nbsp;<code>other_hash</code>&nbsp;<code>中的</code>&nbsp;<code>value</code>&nbsp;<code>覆盖</code>&nbsp;<code>hsh</code>&nbsp;<code>中对应</code>&nbsp;<code>key</code>&nbsp;<code>的</code>&nbsp;<code>value</code>&nbsp;<code>。</code></p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><strong>方法定义-使用默认参数</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">class Test
 def my_method(opts={})
  default_opts={:arg1 =&gt; 10, :arg2 =&gt; "abc"}
  <strong>default_opts.merge!(opts)</strong>
  default_opts.each{|key,value| puts "#{key} is #{value}"}
 end
end

t = Test.new
t.my_method :arg1=&gt;5, :arg3=&gt;"def"</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>运行结果</strong></p> 
    <table border="0" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <td class="code-outline" style="border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="displaycode">arg1 is 5
arg2 is abc
arg3 is def</pre></td>
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">注：本文转自：<a href="http://www.ibm.com/developerworks/cn/opensource/os-cn-rubysbl/" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">http://www.ibm.com/developerworks/cn/opensource/os-cn-rubysbl/</a>, 详细信息请访问文章出处，本文仅供学习之用。</p> 
    <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     <br>
    </div> 
    <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     <br>
    </div> 
    <div> 
     <font color="#333333"><span style="font-size:14px;">本文转自贺满博客园博客，原文链接：http://www.cnblogs.com/puresoul/archive/2012/01/05/2313055.html</span></font>
     <span style="font-size:14px;color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者。</span> 
    </div> 
   </div> 
   <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"> 
    <div></div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
