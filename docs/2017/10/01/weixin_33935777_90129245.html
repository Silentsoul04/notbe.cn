<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Android -- 再来一发Notification « NotBeCN</title>
  <meta name="description" content="                             之前写过一个Notificaiton的文章，用上面的方式去操作也是OK的，但是到后面的SDK之后，有些方法被弃用，甚至我到SDK23的时候，我发现有些方法直接没了，所以在这里重新写一下最新的用法。http://www.cnblogs.com/yydcdut...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/01/weixin_33935777_90129245.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Android -- 再来一发Notification</h1>
    <p class="post-meta">Oct 1, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div>
    <br>
   </div> 
   <div> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">之前写过一个Notificaiton的文章，用上面的方式去操作也是OK的，但是到后面的SDK之后，有些方法被弃用，甚至我到SDK23的时候，我发现有些方法直接没了，所以在这里重新写一下最新的用法。<br><a href="http://www.cnblogs.com/yydcdut/p/3828941.html" rel="nofollow" class="uri" style="color:rgb(153,153,153);text-decoration:none;">http://www.cnblogs.com/yydcdut/p/3828941.html</a></p> 
    <h2 style="color:rgb(177,177,177);font-size:21px;line-height:1.5;font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;">步骤</h2> 
    <ul style="color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <li style="list-style-type:disc;">创建一个通知栏的Builder构造类</li> 
     <li style="list-style-type:disc;">定义通知栏的Action</li> 
     <li style="list-style-type:disc;">设置通知栏点击事件</li> 
     <li style="list-style-type:disc;">通知</li> 
    </ul>
    <h2 style="color:rgb(177,177,177);font-size:21px;line-height:1.5;font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;">代码</h2> 
    <div class="sourceCode" style="font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <pre><code class="language-java"><code class="sourceCode java hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;background:rgb(255,255,255);border:1px solid rgb(47,47,47);color:rgb(131,148,150);">NotificationManager mNotificationManager = (NotificationManager) <span class="fu">getSystemService</span>(NOTIFICATION_SERVICE); otificationCompat.<span class="fu">Builder</span> mBuilder = <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">new</span></span> NotificationCompat.<span class="fu">Builder</span>(<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">this</span></span>); mBuilder.<span class="fu">setContentTitle</span>(<span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"测试标题"</span></span>)<span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//设置通知栏标题 </span></span> .<span class="fu">setContentText</span>(<span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"测试内容"</span></span>) <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//设置通知栏显示内容&lt;/span&gt; </span></span> .<span class="fu">setContentIntent</span>(<span class="fu">getDefalutIntent</span>(Notification.<span class="fu">FLAG_AUTO_CANCEL</span>)) <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//设置通知栏点击意图 </span></span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// .setNumber(number) //设置通知集合的数量 </span></span> .<span class="fu">setTicker</span>(<span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"测试通知来啦"</span></span>) <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//通知首次出现在通知栏，带上升动画效果的 </span></span> .<span class="fu">setWhen</span>(System.<span class="fu">currentTimeMillis</span>())<span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//通知产生的时间，会在通知信息里显示，一般是系统获取到的时间 </span></span> .<span class="fu">setPriority</span>(Notification.<span class="fu">PRIORITY_DEFAULT</span>) <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//设置该通知优先级 </span></span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// .setAutoCancel(true)//设置这个标志当用户单击面板就可以让通知将自动取消 </span></span> .<span class="fu">setOngoing</span>(<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">false</span></span>)<span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//ture，设置他为一个正在进行的通知。他们通常是用来表示一个后台任务,用户积极参与(如播放音乐)或以某种方式正在等待,因此占用设备(如一个文件下载,同步操作,主动网络连接) </span></span> .<span class="fu">setDefaults</span>(Notification.<span class="fu">DEFAULT_VIBRATE</span>)<span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//向通知添加声音、闪灯和振动效果的最简单、最一致的方式是使用当前的用户默认设置，使用defaults属性，可以组合 </span></span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//Notification.DEFAULT_ALL Notification.DEFAULT_SOUND 添加声音 // requires VIBRATE permission </span></span> .<span class="fu">setSmallIcon</span>(R.<span class="fu">drawable</span>.<span class="fu">ic_launcher</span>);</code></code></pre>
    </div> 
    <h3 style="font-size:16px;color:rgb(153,153,153);line-height:1.5;font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;">对应的各个方法的属性</h3> 
    <blockquote style="background:rgb(63,63,63) none;border:2px solid rgb(239,239,239);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;"> 
     <p style="line-height:24px;color:rgb(153,153,153);">Flags</p> 
    </blockquote> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">功能：提醒标志符，向通知添加声音、闪灯和振动效果等设置达到通知提醒效果，可以组合多个属性</p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">有2种设置方法：</p> 
    <ol style="color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <li style="list-style-type:decimal;">实例化通知栏之后通过给他添加.flags属性赋值。</li>
    </ol>
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;"><code style="line-height:1.8;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(47,47,47);color:rgb(208,208,208);">java Notification notification = mBuilder.build(); notification.flags = Notification.FLAG_AUTO_CANCEL;</code></p> 
    <ol style="color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <li style="list-style-type:decimal;">通过setContentIntent(PendingIntent intent)方法中的意图设置对应的flags</li>
    </ol>
    <div class="sourceCode" style="font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <pre><code class="language-java"><code class="sourceCode java hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;background:rgb(255,255,255);border:1px solid rgb(47,47,47);color:rgb(131,148,150);"><span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(133,153,0);">public</span></span></span><span class="hljs-function"> PendingIntent </span><span class="fu"><span class="hljs-function"><span class="hljs-title" style="color:rgb(38,139,210);">getDefalutIntent</span></span></span><span class="hljs-function">(</span><span class="dt"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword" style="color:rgb(133,153,0);">int</span></span></span></span><span class="hljs-function"> flags)</span>{ PendingIntent pendingIntent= PendingIntent.<span class="fu">getActivity</span>(<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">this</span></span>, <span class="dv">1</span>, <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">new</span></span> <span class="fu">Intent</span>(), flags); <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">return</span></span> pendingIntent; } </code></code></pre>
    </div> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">提醒标志符成员</p> 
    <div class="sourceCode" style="font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <pre><code class="language-java"><code class="sourceCode java hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;background:rgb(255,255,255);border:1px solid rgb(47,47,47);color:rgb(131,148,150);">Notification.<span class="fu">FLAG_SHOW_LIGHTS</span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//三色灯提醒，在使用三色灯提醒时候必须加该标志符</span></span> Notification.<span class="fu">FLAG_ONGOING_EVENT</span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//发起正在运行事件（活动中）</span></span> Notification.<span class="fu">FLAG_INSISTENT</span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//让声音、振动无限循环，直到用户响应 （取消或者打开）</span></span> Notification.<span class="fu">FLAG_ONLY_ALERT_ONCE</span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//发起Notification后，铃声和震动均只执行一次</span></span> Notification.<span class="fu">FLAG_AUTO_CANCEL</span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//用户单击通知后自动消失</span></span> Notification.<span class="fu">FLAG_NO_CLEAR</span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//只有全部清除时，Notification才会清除 ，不清楚该通知(QQ的通知无法清除，就是用的这个)</span></span> Notification.<span class="fu">FLAG_FOREGROUND_SERVICE</span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//表示正在运行的服务</span></span></code></code></pre>
    </div> 
    <blockquote style="background:rgb(63,63,63) none;border:2px solid rgb(239,239,239);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;"> 
     <p style="line-height:24px;color:rgb(153,153,153);">setDefaults(int defaults) &nbsp;</p> 
    </blockquote> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">NotificationCompat.Builder中的方法，用于提示。</p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">功能：向通知添加声音、闪灯和振动效果的最简单、使用默认（defaults）属性，可以组合多个属性（和方法1中提示效果一样的）</p> 
    <div class="sourceCode" style="font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <pre><code class="language-java"><code class="sourceCode java hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;background:rgb(255,255,255);border:1px solid rgb(47,47,47);color:rgb(131,148,150);">Notification.<span class="fu">DEFAULT_VIBRATE</span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//添加默认震动提醒 需要 VIBRATE permission</span></span> Notification.<span class="fu">DEFAULT_SOUND</span> <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// 添加默认声音提醒</span></span> Notification.<span class="fu">DEFAULT_LIGHTS</span><span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// 添加默认三色灯提醒</span></span> Notification.<span class="fu">DEFAULT_ALL</span><span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// 添加默认以上3种全部提醒</span></span></code></code></pre>
    </div> 
    <blockquote style="background:rgb(63,63,63) none;border:2px solid rgb(239,239,239);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;"> 
     <p style="line-height:24px;color:rgb(153,153,153);">setVibrate(long[] pattern)</p> 
    </blockquote> 
    <div class="sourceCode" style="font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <pre><code class="language-java"><code class="sourceCode java hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;background:rgb(255,255,255);border:1px solid rgb(47,47,47);color:rgb(131,148,150);">.<span class="fu">setVibrate</span>(<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">new</span></span> <span class="dt"><span class="hljs-keyword" style="color:rgb(133,153,0);">long</span></span>[] {<span class="dv">0</span>,<span class="dv">300</span>,<span class="dv">500</span>,<span class="dv">700</span>}); <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//或者</span></span> mBuilder.<span class="fu">build</span>().<span class="fu">vibrate</span> = <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">new</span></span> <span class="dt"><span class="hljs-keyword" style="color:rgb(133,153,0);">long</span></span>[] {<span class="dv">0</span>,<span class="dv">300</span>,<span class="dv">500</span>,<span class="dv">700</span>}; </code></code></pre>
    </div> 
    <blockquote style="background:rgb(63,63,63) none;border:2px solid rgb(239,239,239);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;"> 
     <p style="line-height:24px;color:rgb(153,153,153);">setLights(intledARGB&nbsp;,intledOnMS&nbsp;,intledOffMS&nbsp;)</p> 
    </blockquote> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">功能：android支持三色灯提醒，这个方法就是设置不同场景下的不同颜色的灯。</p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">描述：其中ledARGB 表示灯光颜色、&nbsp;ledOnMS 亮持续时间、ledOffMS 暗的时间。</p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">注意：1）只有在设置了标志符Flags为Notification.FLAG_SHOW_LIGHTS的时候，才支持三色灯提醒。2）这边的颜色跟设备有关，不是所有的颜色都可以，要看具体设备。</p> 
    <div class="sourceCode" style="font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <pre><code class="language-java"><code class="sourceCode java hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;background:rgb(255,255,255);border:1px solid rgb(47,47,47);color:rgb(131,148,150);">.<span class="fu">setLights</span>(<span class="bn">0xff0000ff</span>, <span class="dv">300</span>, <span class="dv">0</span>) Notification notify = mBuilder.<span class="fu">build</span>(); notify.<span class="fu">flags</span> = Notification.<span class="fu">FLAG_SHOW_LIGHTS</span>; notify.<span class="fu">ledARGB</span> = <span class="bn">0xff0000ff</span>; notify.<span class="fu">ledOnMS</span> = <span class="dv">300</span>; notify.<span class="fu">ledOffMS</span> = <span class="dv">300</span>; </code></code></pre>
    </div> 
    <blockquote style="background:rgb(63,63,63) none;border:2px solid rgb(239,239,239);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;"> 
     <p style="line-height:24px;color:rgb(153,153,153);">setSound(Uri sound)</p> 
    </blockquote> 
    <div class="sourceCode" style="font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <pre><code class="language-java"><code class="sourceCode java hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;background:rgb(255,255,255);border:1px solid rgb(47,47,47);color:rgb(131,148,150);"><span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//获取默认铃声 </span></span> .<span class="fu">setDefaults</span>(Notification.<span class="fu">DEFAULT_SOUND</span>) <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//获取自定义铃声 </span></span> .<span class="fu">setSound</span>(Uri.<span class="fu">parse</span>(<span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"file:///sdcard/xx/xx.mp3"</span></span>)) <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//获取Android多媒体库内的铃声 </span></span> .<span class="fu">setSound</span>(Uri.<span class="fu">withAppendedPath</span>(Audio.<span class="fu">Media</span>.<span class="fu">INTERNAL_CONTENT_URI</span>, <span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"5"</span></span>)) </code></code></pre>
    </div> 
    <blockquote style="background:rgb(63,63,63) none;border:2px solid rgb(239,239,239);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;"> 
     <p style="line-height:24px;color:rgb(153,153,153);">setOngoing(boolean ongoing)</p> 
    </blockquote> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">功能：设置为ture，表示它为一个正在进行的通知。他们通常是用来表示一个后台任务,用户积极参与(如播放音乐)或以某种方式正在等待,因此占用设备(如一个文件下载,同步操作,主动网络连接)</p> 
    <blockquote style="background:rgb(63,63,63) none;border:2px solid rgb(239,239,239);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;"> 
     <p style="line-height:24px;color:rgb(153,153,153);">setProgress(int max, int progress,boolean indeterminate)</p> 
    </blockquote> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">属性：max:进度条最大数值 &nbsp;、progress:当前进度、indeterminate:表示进度是否不确定，true为不确定，如下第3幅图所示 &nbsp;，false为确定下第1幅图所示</p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">注意：此方法在4.0及以后版本才有用，如果为早期版本：需要自定义通知布局，其中包含ProgressBar视图</p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">使用：如果为确定的进度条：调用setProgress(max, progress, false)来设置通知，在更新进度的时候在此发起通知更新progress，并且在下载完成后要移除进度条，通过调用setProgress(0, 0, false)既可。</p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">如果为不确定（持续活动）的进度条，这是在处理进度无法准确获知时显示活动正在持续，所以调用setProgress(0, 0, true) ，操作结束时，调用setProgress(0, 0, false)并更新通知以移除指示条</p> 
    <h2 style="color:rgb(177,177,177);font-size:21px;line-height:1.5;font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;">自定义View</h2> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">这里要用到RemoteViews这个类。</p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">Notification的自定义布局是RemoteViews，和其他RemoteViews一样，在自定义视图布局文件中，仅支持FrameLayout、LinearLayout、RelativeLayout三种布局控件和AnalogClock、Chronometer、Button、ImageButton、ImageView、ProgressBar、TextView、ViewFlipper、ListView、GridView、StackView和AdapterViewFlipper这些显示控件，不支持这些类的子类或Android提供的其他控件。否则会引起ClassNotFoundException异常。</p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;"><img src="https://images2015.cnblogs.com/blog/587773/201509/587773-20150920114130383-1235804170.png" style="border:0px;" alt="587773-20150920114130383-1235804170.png"></p> 
    <div class="sourceCode" style="font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <pre><code class="language-java"><code class="sourceCode java hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;background:rgb(255,255,255);border:1px solid rgb(47,47,47);color:rgb(131,148,150);"><span class="kw"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(133,153,0);">public</span></span></span><span class="hljs-function"> </span><span class="dt"><span class="hljs-function"><span class="hljs-keyword" style="color:rgb(133,153,0);">void</span></span></span><span class="hljs-function"> </span><span class="fu"><span class="hljs-function"><span class="hljs-title" style="color:rgb(38,139,210);">showButtonNotify</span></span></span><span class="hljs-function">()</span>{ NotificationCompat.<span class="fu">Builder</span> mBuilder = <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">new</span></span> <span class="fu">Builder</span>(<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">this</span></span>); RemoteViews mRemoteViews = <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">new</span></span> <span class="fu">RemoteViews</span>(<span class="fu">getPackageName</span>(), R.<span class="fu">layout</span>.<span class="fu">view_custom_button</span>); mRemoteViews.<span class="fu">setImageViewResource</span>(R.<span class="fu">id</span>.<span class="fu">custom_song_icon</span>, R.<span class="fu">drawable</span>.<span class="fu">sing_icon</span>); <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//API3.0 以上的时候显示按钮，否则消失 </span></span> mRemoteViews.<span class="fu">setTextViewText</span>(R.<span class="fu">id</span>.<span class="fu">tv_custom_song_singer</span>, <span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"周杰伦"</span></span>); mRemoteViews.<span class="fu">setTextViewText</span>(R.<span class="fu">id</span>.<span class="fu">tv_custom_song_name</span>, <span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"七里香"</span></span>); <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//如果版本号低于（3。0），那么不显示按钮 </span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">if</span></span>(BaseTools.<span class="fu">getSystemVersion</span>() &lt;= <span class="dv">9</span>){ mRemoteViews.<span class="fu">setViewVisibility</span>(R.<span class="fu">id</span>.<span class="fu">ll_custom_button</span>, View.<span class="fu">GONE</span>); }<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">else</span></span>{ mRemoteViews.<span class="fu">setViewVisibility</span>(R.<span class="fu">id</span>.<span class="fu">ll_custom_button</span>, View.<span class="fu">VISIBLE</span>); } <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// </span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">if</span></span>(isPlay){ mRemoteViews.<span class="fu">setImageViewResource</span>(R.<span class="fu">id</span>.<span class="fu">btn_custom_play</span>, R.<span class="fu">drawable</span>.<span class="fu">btn_pause</span>); }<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">else</span></span>{ mRemoteViews.<span class="fu">setImageViewResource</span>(R.<span class="fu">id</span>.<span class="fu">btn_custom_play</span>, R.<span class="fu">drawable</span>.<span class="fu">btn_play</span>); } <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//点击的事件处理 </span></span> Intent buttonIntent = <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">new</span></span> <span class="fu">Intent</span>(ACTION_BUTTON); <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">/* 上一首按钮 */</span></span> buttonIntent.<span class="fu">putExtra</span>(INTENT_BUTTONID_TAG, BUTTON_PREV_ID); <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//这里加了广播，所及INTENT的必须用getBroadcast方法 </span></span> PendingIntent intent_prev = PendingIntent.<span class="fu">getBroadcast</span>(<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">this</span></span>, <span class="dv">1</span>, buttonIntent, PendingIntent.<span class="fu">FLAG_UPDATE_CURRENT</span>); mRemoteViews.<span class="fu">setOnClickPendingIntent</span>(R.<span class="fu">id</span>.<span class="fu">btn_custom_prev</span>, intent_prev); <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">/* 播放/暂停 按钮 */</span></span> buttonIntent.<span class="fu">putExtra</span>(INTENT_BUTTONID_TAG, BUTTON_PALY_ID); PendingIntent intent_paly = PendingIntent.<span class="fu">getBroadcast</span>(<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">this</span></span>, <span class="dv">2</span>, buttonIntent, PendingIntent.<span class="fu">FLAG_UPDATE_CURRENT</span>); mRemoteViews.<span class="fu">setOnClickPendingIntent</span>(R.<span class="fu">id</span>.<span class="fu">btn_custom_play</span>, intent_paly); <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">/* 下一首 按钮 */</span></span> buttonIntent.<span class="fu">putExtra</span>(INTENT_BUTTONID_TAG, BUTTON_NEXT_ID); PendingIntent intent_next = PendingIntent.<span class="fu">getBroadcast</span>(<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">this</span></span>, <span class="dv">3</span>, buttonIntent, PendingIntent.<span class="fu">FLAG_UPDATE_CURRENT</span>); mRemoteViews.<span class="fu">setOnClickPendingIntent</span>(R.<span class="fu">id</span>.<span class="fu">btn_custom_next</span>, intent_next); mBuilder.<span class="fu">setContent</span>(mRemoteViews) .<span class="fu">setContentIntent</span>(<span class="fu">getDefalutIntent</span>(Notification.<span class="fu">FLAG_ONGOING_EVENT</span>)) .<span class="fu">setWhen</span>(System.<span class="fu">currentTimeMillis</span>())<span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// 通知产生的时间，会在通知信息里显示 </span></span> .<span class="fu">setTicker</span>(<span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"正在播放"</span></span>) .<span class="fu">setPriority</span>(Notification.<span class="fu">PRIORITY_DEFAULT</span>)<span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// 设置该通知优先级 </span></span> .<span class="fu">setOngoing</span>(<span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">true</span></span>) .<span class="fu">setSmallIcon</span>(R.<span class="fu">drawable</span>.<span class="fu">sing_icon</span>); Notification notify = mBuilder.<span class="fu">build</span>(); notify.<span class="fu">flags</span> = Notification.<span class="fu">FLAG_ONGOING_EVENT</span>; mNotificationManager.<span class="fu">notify</span>(notifyId, notify); } </code></code></pre>
    </div> 
    <h2 style="color:rgb(177,177,177);font-size:21px;line-height:1.5;font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;">大视图风格通知</h2> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">注：4.1之前的版本不支持大视图</p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;"><img src="https://images2015.cnblogs.com/blog/587773/201509/587773-20150920114143883-545052462.png" style="border:0px;" alt="587773-20150920114143883-545052462.png"></p> 
    <p style="line-height:24px;color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">详情区域根据用途可有多种风格：</p> 
    <ol style="color:rgb(153,153,153);font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <li style="list-style-type:decimal;">NotificationCompat.BigPictureStyle&nbsp;大图片风格：详情区域包含一个256dp高度的位图</li> 
     <li style="list-style-type:decimal;">NotificationCompat.BigTextStyle&nbsp;大文字风格：显示一个大的文字块</li> 
     <li style="list-style-type:decimal;">NotificationCompat.InboxStyle &nbsp;收件箱风格：显示多行文字 &nbsp;</li> 
    </ol>
    <div class="sourceCode" style="font-family:'Comic Sans MS', '微软雅黑', '宋体', Arial;font-size:15px;">
     <pre><code class="language-java"><code class="sourceCode java hljs" style="line-height:1.5;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;background:rgb(255,255,255);border:1px solid rgb(47,47,47);color:rgb(131,148,150);">NotificationCompat.<span class="fu">BigPictureStyle</span> inboxStyle = <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">new</span></span> NotificationCompat.<span class="fu">InboxStyle</span>(); String[] events = <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">new</span></span> String[<span class="dv">5</span>]; <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// Sets a title for the Inbox style big view </span></span> inboxStyle.<span class="fu">setBigContentTitle</span>(<span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"大视图内容:"</span></span>); <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// Moves events into the big view </span></span> <span class="kw"><span class="hljs-keyword" style="color:rgb(133,153,0);">for</span></span> (<span class="dt"><span class="hljs-keyword" style="color:rgb(133,153,0);">int</span></span> i=<span class="dv">0</span>; i &lt; events.<span class="fu">length</span>; i++) { inboxStyle.<span class="fu">addLine</span>(events[i]); } mBuilder.<span class="fu">setContentTitle</span>(<span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"测试标题"</span></span>) .<span class="fu">setContentText</span>(<span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"测试内容"</span></span>) <span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">// .setNumber(number)//显示数量 </span></span> .<span class="fu">setStyle</span>(inboxStyle)<span class="co"><span class="hljs-comment" style="color:rgb(181,137,0);">//设置风格 </span></span> .<span class="fu">setTicker</span>(<span class="st"><span class="hljs-string" style="color:rgb(38,139,210);">"测试通知来啦"</span></span>); 本文转自我爱物联网博客园博客，原文链接：http://www.cnblogs.com/yydcdut/p/4823133.html，如需转载请自行联系原作者</code></code></pre>
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
