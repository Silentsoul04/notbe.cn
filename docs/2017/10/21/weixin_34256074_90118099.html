<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>DOM+CSS3实现小游戏SwingCopters « NotBeCN</title>
  <meta name="description" content="             些日子看到了一则新闻，flappybird原作者将携新游戏SwingCopters来袭，准备再靠这款姊妹篇游戏引爆大众眼球。就是下面这个小游戏：    　　　        　　前者的传奇故事大家都有耳闻，至于这第二个游戏能否更加火爆那是后话了。不过我看了作者的宣传视频后，蠢蠢欲动，这么...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/10/21/weixin_34256074_90118099.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">DOM+CSS3实现小游戏SwingCopters</h1>
    <p class="post-meta">Oct 21, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">些日子看到了一则新闻，flappybird原作者将携新游戏SwingCopters来袭，准备再靠这款姊妹篇游戏引爆大众眼球。就是下面这个小游戏：</p> 
   <p style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">　　<img src="https://images0.cnblogs.com/blog/520134/201409/121514458879567.jpg" alt="" width="569" height="497" style="border:0px;">　</p> 
   <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
    　　前者的传奇故事大家都有耳闻，至于这第二个游戏能否更加火爆那是后话了。不过我看了作者的宣传视频后，蠢蠢欲动，这么简单的小游戏我山寨一个网页版出来如何？简单思索一下，打算用DOM+CSS3来实现一个。一来强化一个下自己的CSS3知识，二来也探索下用原生DOM来做动画的性能到底如何。
    <br> 三四天后，原作者的SwingCopters貌似没怎么火起来，看来flappybird的神话只是一个偶然呀~不过我的山寨版倒是有模有样的做出来了，
    <a href="http://idoube.com/proj/SwingCopters/" rel="nofollow" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;line-height:normal;">点这里查看Demo</a>，请在chrome下打开， 你懂的。
   </div> 
   <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;"> 
    <div>
     　　先来说下整体思路，基本的动画效果，如移动、旋转，用CSS3的transition、transform+keyframes来做，把基本的动画单元做成一个个css类，为元素添加对应的class就可以让它动起来，删除、更改class则可以让元素停止、切换动画。至于什么时候进行切换，一方面是根据用户的操作，另一方面是根据游戏的“主线程”来判断。所谓“主线程”，就是控制游戏画面不停刷新的代码，游戏的主控制逻辑都写在这里，包括场景生成、碰撞检测等。大家都知道动画是由页面的不停重绘来产生的，当每秒的刷新次数达到60时，人眼会感觉到流畅的动画，这也是大多数游戏追求60fps的原因。关于如何做帧刷新有几种方法，具体可参看这里（http://qingbob.com/javascript-high-performance-animation-and-page-rendering/）。我这里采用requestAnimationFrame来做，它的好处是让你用代码来请求一次帧刷新，这样能避免“掉帧”，但是负面影响是，当机器性能不好时，会降低帧率，表现就是你看到游戏的动画变缓慢了。 
     <div> 
      <div>
       &nbsp; &nbsp; &nbsp;requestAnimationFrame在PC端的支持还不错，不过在移动端的就有点挫了，Android4.4才支持，所以有必要做一下兼容处理，幸好已经有大神提供代码了，直接拿来用：
      </div> 
      <div> 
       <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
        <div class="cnblogs_code_toolbar">
         <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
        </div> 
        <pre>(<span style="color:rgb(0,0,255);line-height:1.5;">function</span><span style="line-height:1.5;">(){
    </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> lastTime = 0<span style="line-height:1.5;">;
    </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> vendors = ['ms', 'moz', 'webkit', 'o'<span style="line-height:1.5;">];
    </span><span style="color:rgb(0,0,255);line-height:1.5;">for</span> (<span style="color:rgb(0,0,255);line-height:1.5;">var</span> x = 0; x &lt; vendors.length &amp;&amp; !window.requestAnimationFrame; ++<span style="line-height:1.5;">x) {
        window.requestAnimationFrame </span>= window[vendors[x] + 'RequestAnimationFrame'<span style="line-height:1.5;">];
        window.cancelAnimationFrame </span>= window[vendors[x] + 'CancelAnimationFrame'] || window[vendors[x] + 'CancelRequestAnimationFrame'<span style="line-height:1.5;">];
    }
    </span><span style="color:rgb(0,0,255);line-height:1.5;">if</span> (!window.requestAnimationFrame) window.requestAnimationFrame = <span style="color:rgb(0,0,255);line-height:1.5;">function</span><span style="line-height:1.5;">(callback, element) {
        </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> currTime = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> Date().getTime();
        </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> timeToCall = Math.max(0, 16 - (currTime -<span style="line-height:1.5;"> lastTime));
        </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> id = window.setTimeout(<span style="color:rgb(0,0,255);line-height:1.5;">function</span><span style="line-height:1.5;">() {
            callback(currTime </span>+<span style="line-height:1.5;"> timeToCall);
        }, timeToCall);
        lastTime </span>= currTime +<span style="line-height:1.5;"> timeToCall;
        </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> id;
    }
    </span><span style="color:rgb(0,0,255);line-height:1.5;">if</span> (!window.cancelAnimationFrame) window.cancelAnimationFrame = <span style="color:rgb(0,0,255);line-height:1.5;">function</span><span style="line-height:1.5;">(id) {
        clearTimeout(id);
    }
}());</span></pre> 
        <div class="cnblogs_code_toolbar">
         <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
        </div> 
       </div> 
       <p>　　下面我把一些技术细节来介绍下，介于小弟也是第一次做游戏，有些地方的实现不免走了弯路，或者损耗性能，有大牛发现了请一定赐教~</p> 
       <div> 
        <strong>自适应的容器</strong>
        <br> &nbsp;&nbsp;&nbsp;&nbsp; 先从最简单的来说起吧，首先需要一个div来做整个游戏的容器，由于游戏要能在手机上玩，所以宽高就必须做成自适应的，那么viewport的设置是必不可少的：
       </div> 
       <div> 
        <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">
         <pre><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">meta </span><span style="color:rgb(255,0,0);line-height:1.5;">name</span><span style="color:rgb(0,0,255);line-height:1.5;">="viewport"</span><span style="color:rgb(255,0,0);line-height:1.5;"> content</span><span style="color:rgb(0,0,255);line-height:1.5;">="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> <span style="color:rgb(0,0,255);line-height:1.5;">/&gt;</span></pre>
        </div> 
        <div>
         　　这个不多解释了。div默认宽度100%所以不用管，高度要做到根据屏幕100%显示，我们需要给文档的根节点这样的css代码：
        </div> 
        <div> 
         <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
          <div class="cnblogs_code_toolbar">
           <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
          </div> 
          <pre><span style="color:rgb(128,0,0);line-height:1.5;">html, body</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
     height</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 100%</span>;<span style="color:rgb(255,0,0);line-height:1.5;">
     position</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> relative</span>;<span style="color:rgb(255,0,0);line-height:1.5;">
     margin</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 0</span>;<span style="color:rgb(255,0,0);line-height:1.5;">
     overflow</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> hidden</span>;<span style="color:rgb(255,0,0);line-height:1.5;">
     -webkit-user-select</span>:<span style="color:rgb(0,0,255);line-height:1.5;">none</span>;
}</pre> 
          <div class="cnblogs_code_toolbar">
           <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
          </div> 
         </div> 
         <div>
          　　高度100%。定位属性relative，让子元素的定位以它为参照。同时overflow:hidden防止出现滚动条。最后还加了user-select:none，防止用户连续点击的时候出现难看的选区。
          <br> &nbsp;&nbsp;&nbsp;&nbsp; 接下来是容器container的样式：
         </div> 
         <div> 
          <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
           <div class="cnblogs_code_toolbar">
            <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
           </div> 
           <pre><span style="color:rgb(128,0,0);line-height:1.5;">#container</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
     height</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 100%</span>;<span style="color:rgb(255,0,0);line-height:1.5;">
     position</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> relative</span>;<span style="color:rgb(255,0,0);line-height:1.5;">
     overflow</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> hidden</span>;
}</pre> 
           <div class="cnblogs_code_toolbar">
            <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
           </div> 
          </div> 
          <div>
           　　这样高度就能充满整个屏幕了。
           <br> &nbsp;&nbsp;&nbsp;&nbsp; 另外，为了让游戏在PC浏览器中也可以玩，我又用媒体查询做了如下设置：
          </div> 
          <div> 
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre><span style="color:rgb(128,0,0);line-height:1.5;">@media screen and (min-width: 1024px) </span>{<span style="color:rgb(255,0,0);line-height:1.5;">
     #container{
          width</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 360px</span>;<span style="color:rgb(255,0,0);line-height:1.5;">
          margin</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 0 auto</span>;
     }<span style="color:rgb(128,0,0);line-height:1.5;">
}</span></pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> 
           <div>
            　　给容器360像素的宽度并居中对齐。这样在PC浏览器中就不会拉伸的很难看了。
           </div> 
           <div> 
            <div> 
             <strong>移动的背景</strong>
             <br>
             <strong>&nbsp;&nbsp;&nbsp;&nbsp;</strong>&nbsp;游戏的容器container有一个背景图片，这个背景图片是需要连续且无限滚动的。首先，图片纵向平铺嘛，一个background-repeat: repeat-y;搞定。原先我考虑这么简单的运动用css3肯定能做的啦，但细细考虑之后发现竟然实现不了。。。假设在keyframes中设置关键帧，改变background-position来实现背景移动，移动倒是没问题，关键是这个连续无限滚动比较棘手，要连续滚动必须给一个很大的值才行，background-position需要设为多大才算无限呢？天知道玩家能玩多长时间，而且这样做显然是不合理的。或者把动画的播放次数设为infinite呢？这也不行，因为每次循环都会从头开始播放一遍，这样背景会闪动。所以最终还是把背景的移动放在js中来操作了，用一个变量来记录背景的位置，然后在主线程中不断递增。大概的代码结构是这样子的：
            </div> 
            <div> 
             <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
              <div class="cnblogs_code_toolbar">
               <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
              </div> 
              <pre><span style="color:rgb(0,0,255);line-height:1.5;">var</span> game =<span style="line-height:1.5;"> {
     bgMove : </span><span style="color:rgb(0,0,255);line-height:1.5;">function</span><span style="line-height:1.5;">(){
          posMark </span>+= 2<span style="line-height:1.5;">;
          container.css(</span>'background-position', '0 '+posMark+'px'<span style="line-height:1.5;">);
          timmer </span>=<span style="line-height:1.5;"> requestAnimationFrame(game.bgMove);
     }
}</span></pre> 
              <div class="cnblogs_code_toolbar">
               <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
              </div> 
             </div> 
             <div>
              　　只要调用game.bgMove()，就会通过 requestAnimationFrame来递归调用，用一个全局的变量来标记背景的位置，每次递增，从而不断修改背景位置，实现背景无限移动。
             </div> 
             <div> 
              <div>
               <strong>逐步播放动画实现旋转的螺旋桨</strong>
              </div> 
              <div> 
               <strong>&nbsp; &nbsp; &nbsp;</strong>游戏中人物头上的螺旋桨在不停转动，如何实现这个动画呢？其实原理很简单，我们只需准备这样一张图片：
              </div> 
              <div>
               　　
               <img src="https://images0.cnblogs.com/blog/520134/201409/121522269187655.png" alt="" style="border:0px;">
              </div> 
              <div> 
               <div>
                　　这是向左飞行和向右飞行的几个状态，将它设置为背景图片，然后不停改变背景的位置即可。要注意的是背景位置并不是连续变化，而是在几个值之间“切换”。
               </div> 
               <div> 
                <strong>&nbsp; &nbsp; &nbsp;</strong>css3的keyframes + animation是通过定义关键帧的方式来实现动画，像flash一样，帧之间的过渡效果由浏览器来替你完成。但我们此处并不想要过渡效果，我们只想让播放两个帧而已。这里要用到animate-timing-function的一个比较特殊的取值：steps()，它可以控制动画最终由多少步来完成。这里我们需要图片中的第一个状态和第二个状态来切换，所以取steps(2)就OK了。代码如下：
               </div> 
               <div>
                　　首先我们定义关键帧：
               </div> 
               <div> 
                <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
                 <div class="cnblogs_code_toolbar">
                  <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
                 </div> 
                 <pre><span style="color:rgb(128,0,0);line-height:1.5;">@-webkit-keyframes flyr</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
     0%{
          background-position</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 0 0</span>;
     }<span style="color:rgb(128,0,0);line-height:1.5;">
     100%</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
        background-position</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> -108px 0</span>;
     }<span style="color:rgb(128,0,0);line-height:1.5;">
}</span></pre> 
                 <div class="cnblogs_code_toolbar">
                  <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
                 </div> 
                </div> 
                <div>
                 　　然后定义一个class，只要在元素上加上这个类就可以进行动画了：
                </div> 
                <div> 
                 <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">
                  <pre><span style="color:rgb(128,0,0);line-height:1.5;">.flyr</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
     -webkit-animation</span>:<span style="color:rgb(0,0,255);line-height:1.5;">flyr 200ms steps(2) 0 infinite</span>;
}</pre>
                 </div> 
                 <div> 
                  <div>
                   　　我直接使用了animation这个混合属性，取值的含义依次是：animation-name(动画名称)，animation-duration(动画时间)，animation-delay(开始播放时间)，animation-iteration-count(播放次数)，animation-direction(播放方向)，animation-fill-mode(播放后的状态)，animation-play-state(设置动画的状态)，不写则取默认值。
                  </div> 
                  <div>
                   &nbsp; &nbsp; &nbsp;来看一下效果吧：
                  </div> 
                  <div>
                   &nbsp;
                  </div> 
                 </div> 
                </div> 
               </div> 
              </div> 
             </div> 
            </div> 
           </div> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
    </div> 
   </div> 
   <div class="flyr" style="width:50px;background-image:url(&quot;http://images.cnblogs.com/cnblogs_com/lvdabao/507840/o_player.png&quot;);color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
    &nbsp;
   </div> 
   <div> 
    <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
     　　
    </div> 
    <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
     　　向左飞的动画也同理，改变background-position的值即可。我们取名为flyl，只需要让元素的类名在flyl和flyr直接切换，就可以改变飞行的方向，是不是很方便。
    </div> 
    <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
     &nbsp; &nbsp; &nbsp;在这里需要注意的一点是，steps(2)控制的两步播放，并不是播放0%和100%时的状态，而是根据具体的css属性的值来计算最终播放的两帧是什么状态。你可以自己写个例子看一下，这里不多说了。
    </div> 
    <div> 
     <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
      <strong>起步向上飞行</strong>
     </div> 
     <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;"> 
      <strong>&nbsp; &nbsp; &nbsp;</strong>人物一开始是在地上站着的，游戏开始时会先上升到半空中，然后垂直位置不再改变。这个比较好做，我们只需定义一个名为up的动画，如下：
     </div> 
     <div> 
      <div class="cnblogs_code" style="color:rgb(0,0,0);font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
       <pre><span style="color:rgb(128,0,0);line-height:1.5;">@-webkit-keyframes up</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
     0%{
          bottom</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 0</span>;
     }<span style="color:rgb(128,0,0);line-height:1.5;">
     100%</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
          bottom</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 44%</span>;
     }<span style="color:rgb(128,0,0);line-height:1.5;">
}</span></pre> 
       <div class="cnblogs_code_toolbar">
        <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
       </div> 
      </div> 
      <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
       　　然后一块加在flyl类上即可，多个动画用逗号隔开。于是flyl就变成了这样：
      </div> 
      <div> 
       <div class="cnblogs_code" style="color:rgb(0,0,0);font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);">
        <pre><span style="color:rgb(128,0,0);line-height:1.5;">.flyl</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
    -webkit-animation</span>:<span style="color:rgb(0,0,255);line-height:1.5;">flyl 200ms steps(2) 0 infinite, up 4s linear 0 1 normal forwards</span>;
}</pre>
       </div> 
       <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
        　　这里animation-iteration-count取值为1，因为只播放一次就可以了。另外要注意的一点是，这一遍播放完后动画应该停留在结束时的状态，所以我们还需设置animation-fill-mod值为forwards。
       </div> 
       <div> 
        <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
         <strong>人物的左右移动</strong>
        </div> 
        <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;"> 
         <strong>&nbsp; &nbsp; &nbsp;</strong>通过点击改变了飞行方向后，人物会向对应的方向横向移动，这个怎么来做呢？一开始我想简单了，左右移动嘛，跟上升还不是一个道理？于是想当然的定义一个这样的动画：
        </div> 
        <div> 
         <div class="cnblogs_code" style="color:rgb(0,0,0);font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
          <div class="cnblogs_code_toolbar">
           <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
          </div> 
          <pre><span style="color:rgb(128,0,0);line-height:1.5;">@-webkit-keyframes mover</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
     0%{
          left </span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 0</span>;
      }<span style="color:rgb(128,0,0);line-height:1.5;">
     100%</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
          left </span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 100%</span>;
     }<span style="color:rgb(128,0,0);line-height:1.5;">
}</span></pre> 
          <div class="cnblogs_code_toolbar">
           <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
          </div> 
         </div> 
         <div> 
          <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
           　　只需在flyl后面再加个逗号，加上movel就行了。或者定义成一个类，为人物添加这个类来实现向左移动。
          </div> 
          <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
           &nbsp; &nbsp; &nbsp;但事实证明这样是错误的。因为在实际操作中，改变飞行方向可能发生在任何一刻，而这个时候人物的left值可能是20、50或者其他任何值。我们需要的是在当前left的基础上进行改变，而不是让它先归零。所以这里便不能用keyframes了，因为我们总是无法确定这个初始的left是多少。
          </div> 
          <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
           &nbsp; &nbsp; &nbsp;这个时候css3的transition就派上用场了，它的作用也是自动创建补间动画，只不过没有animation那么复杂，只需为它指明需要过渡哪些属性就可以了。所以，我的flyl和flyr就变成了这样：
          </div> 
          <div> 
           <div class="cnblogs_code" style="color:rgb(0,0,0);font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre><span style="color:rgb(128,0,0);line-height:1.5;">.flyl</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
     left</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 0 !important</span>;<span style="color:rgb(255,0,0);line-height:1.5;">
     -webkit-animation</span>:<span style="color:rgb(0,0,255);line-height:1.5;">flyl 200ms steps(2) 0 infinite, up 4s linear 0 1 normal forwards</span>;
}<span style="color:rgb(128,0,0);line-height:1.5;">
.flyr</span>{<span style="color:rgb(255,0,0);line-height:1.5;">
     left</span>:<span style="color:rgb(0,0,255);line-height:1.5;"> 100% !important</span>;<span style="color:rgb(255,0,0);line-height:1.5;">
     -webkit-animation</span>:<span style="color:rgb(0,0,255);line-height:1.5;">flyr 200ms steps(2) 0 infinite, up 4s linear 0 1 normal forwards</span>;
}   </pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> 
           <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
            　　与此同时，我们的player要加上这一行：
           </div> 
           <div> 
            <div class="cnblogs_code" style="color:rgb(0,0,0);font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);">
             <pre><span style="color:rgb(128,0,0);line-height:1.5;">-webkit-transition : left 1.5s 0 linear;</span></pre>
            </div> 
            <div> 
             <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
              　　这样我们巧妙的摆脱了之前的困境，只需指定left即可，管它是从哪个值变来的，交给transition过渡去就好了。
             </div> 
             <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
              &nbsp; &nbsp; &nbsp;现在只要监听click事件，根据玩家的点击来为人物切换class，我们的就可以来回飞了。js代码如下：
             </div> 
             <div> 
              <div class="cnblogs_code" style="color:rgb(0,0,0);font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
               <div class="cnblogs_code_toolbar">
                <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
               </div> 
               <pre>$(document).on('click', <span style="color:rgb(0,0,255);line-height:1.5;">function</span><span style="line-height:1.5;">(){
               </span><span style="color:rgb(0,0,255);line-height:1.5;">if</span>(++direction%2==0<span style="line-height:1.5;">){
                    player[</span>0].className = 'flyl'<span style="line-height:1.5;">;
               }
               </span><span style="color:rgb(0,0,255);line-height:1.5;">else</span><span style="line-height:1.5;">{
                    player[</span>0].className = 'flyr'<span style="line-height:1.5;">;
               }
          });</span></pre> 
               <div class="cnblogs_code_toolbar">
                <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
               </div> 
              </div> 
              <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
               　　我们用一个变量direction来记录当前的方向，每次点击让它递增，然后根据奇偶性来改变className即可。之所以用变量来记录而不是通过hasClass来判断当前方向的原因是减少DOM访问。
              </div> 
              <div> 
               <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                <strong>摆锤的产生和移动</strong>
               </div> 
               <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;"> 
                <strong>&nbsp; &nbsp; &nbsp;</strong>先说摆锤的左右摆动动画，这个其实也不难，用transform:rotate控制旋转一定的角度即可。有一点要注意的是，transform的变形圆点默认是元素的中心位置，而我们的摆锤可不是原地旋转的，所以旋转的中心应该控制在元素的顶部位置，我们用transform-origin来设置变形圆点位置，代码如下：
               </div> 
               <div> 
                <div class="cnblogs_code" style="color:rgb(0,0,0);font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);">
                 <pre><span style="color:rgb(128,0,0);line-height:1.5;">-webkit-transform-origin:center 4px;</span></pre>
                </div> 
                <div> 
                 <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                  　　摆锤是挂在横梁上的，横梁是自上而下移动的，在横梁的移动中其实就包含了我们游戏的主要逻辑：
                 </div> 
                 <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                  &nbsp; &nbsp; &nbsp;1. 产生长度随机的横梁
                 </div> 
                 <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                  &nbsp; &nbsp; &nbsp;2. 检测摆锤与飞机的碰撞
                 </div> 
                 <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                  &nbsp; &nbsp; &nbsp;3. 飞过一层横梁则得分加1
                 </div> 
                 <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                  &nbsp; &nbsp; &nbsp;4. 横梁移出屏幕可视范围，remove节点
                 </div> 
                 <div> 
                  <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                   　　这里用纯css实现横梁的移动的话会有一些逻辑无法实现，这中间必须有js来控制的。所以横梁/摆锤的产生就放在了我们游戏的“主线程”里。
                  </div> 
                  <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                   &nbsp; &nbsp; &nbsp;简单说下思路：
                  </div> 
                  <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                   &nbsp; &nbsp; &nbsp;有两个常量，分别表示横梁之间的水平距离和垂直距离，另外我们还需定义横梁的最小长度和最大长度，在这两个值之间产生一个随机数作为左侧横梁的长度，然后根据水平距离来计算出右侧横梁的长度。
                  </div> 
                  <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                   &nbsp; &nbsp; &nbsp;至于碰撞检测，我这里就简单处理了（考虑到这个摆锤在不停的摆动），直接用圆形模型来做，即两个圆心的距离小于半径之和则认为发生了碰撞。
                  </div> 
                  <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                   &nbsp; &nbsp; &nbsp;计算得分也比较简单，只要横梁的top值大于飞机的top值了，就认为已经越过了这一道横梁，得分加1.
                  </div> 
                  <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                   &nbsp; &nbsp; &nbsp;最后，当横梁的top值大于整个容器的高度时，说明它已经移出可视范围，直接把节点remove掉，避免游戏运行一段时间后，DOM节点太多造成卡顿。
                  </div> 
                  <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                   &nbsp; &nbsp; &nbsp;下面是主线程的代码:
                  </div> 
                  <div> 
                   <div class="cnblogs_code" style="color:rgb(0,0,0);font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
                    <div class="cnblogs_code_toolbar">
                     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
                    </div> 
                    <pre>bgMove : <span style="color:rgb(0,0,255);line-height:1.5;">function</span><span style="line-height:1.5;">(){
          game.generateHand();</span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">产生横梁</span>
          posMark += 2<span style="line-height:1.5;">;
          container.css(</span>'background-position', '0 '+posMark+'px'<span style="line-height:1.5;">);
         
          </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> hands = $('.hand_l, .hand_r'<span style="line-height:1.5;">);
          hands.each(</span><span style="color:rgb(0,0,255);line-height:1.5;">function</span><span style="line-height:1.5;">(index, element){
               </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> _this = $(<span style="color:rgb(0,0,255);line-height:1.5;">this</span><span style="line-height:1.5;">),
                    thisTop </span>= parseInt(_this.css('top'<span style="line-height:1.5;">));
               </span><span style="color:rgb(0,0,255);line-height:1.5;">if</span>(thisTop&gt;<span style="line-height:1.5;">cHeight){
                    _this.remove();
               }
               </span><span style="color:rgb(0,0,255);line-height:1.5;">else</span><span style="line-height:1.5;">{
                    thisTop </span>+= 2<span style="line-height:1.5;">;
                    _this.css(</span>'top', thisTop+'px'<span style="line-height:1.5;">);
               }
               </span><span style="color:rgb(0,0,255);line-height:1.5;">if</span>(thisTop&gt;player.offset().top+<span style="line-height:1.5;">e1H){
                    </span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">已经位于下方</span>
                    <span style="color:rgb(0,0,255);line-height:1.5;">if</span>(!_this.data('pass') &amp;&amp; index%2==0<span style="line-height:1.5;">){
                         scroeC.text(</span>++<span style="line-height:1.5;">score);
                         _this.data(</span>'pass', 1<span style="line-height:1.5;">);
                    }
               }
               </span><span style="color:rgb(0,0,255);line-height:1.5;">else</span><span style="line-height:1.5;">{
                    </span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">碰撞检测</span>
                    <span style="color:rgb(0,0,255);line-height:1.5;">if</span>(game.impactCheck(player, _this.find('.t'<span style="line-height:1.5;">))){
                         game.stop();
                         </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">false</span><span style="line-height:1.5;">;
                    }
               }
              
          });

          timmer </span>=<span style="line-height:1.5;"> requestAnimationFrame(game.bgMove);
     }</span></pre> 
                    <div class="cnblogs_code_toolbar">
                     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
                    </div> 
                   </div> 
                   <div> 
                    <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                     　　你会发现里面其实也有好多写的不好的地方，例如每次刷新一帧都会用&nbsp;$('.hand_l, .hand_r')把页面上所有的横梁节点都取一遍，这样扫描DOM树挺消耗时间的。完全可以把这些节点存在一个数组里。产生横梁的时候在数组中push，需要remove的时候从数组中删除。
                    </div> 
                    <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                     　　至此，这个小游戏的关键部分就都完成了。剩下就是游戏的控制部分了，stop、restart什么的，其实只要把控制游戏的参数变量和class重置，cancelAnimationFrame，就ok了。
                    </div> 
                    <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                     &nbsp;
                    </div> 
                    <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                     <strong>兼容PC和手机</strong>
                    </div> 
                    <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                     　　这里的兼容主要是指click事件的300ms延迟，由于游戏来说，哪怕是一点点的延迟都会不爽。所以我检测了设备类型，如果是移动端，就绑定touchstart事件，代码片段如下：
                    </div> 
                    <div> 
                     <div class="cnblogs_code" style="color:rgb(0,0,0);font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
                      <div class="cnblogs_code_toolbar">
                       <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
                      </div> 
                      <pre>isMobile : <span style="color:rgb(0,0,255);line-height:1.5;">function</span><span style="line-height:1.5;">(){
          </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> sUserAgent=<span style="line-height:1.5;"> navigator.userAgent.toLowerCase(),
          bIsIpad</span>= sUserAgent.match(/ipad/i) == "ipad"<span style="line-height:1.5;">,
          bIsIphoneOs</span>= sUserAgent.match(/iphone os/i) == "iphone os"<span style="line-height:1.5;">,
          bIsMidp</span>= sUserAgent.match(/midp/i) == "midp"<span style="line-height:1.5;">,
          bIsUc7</span>= sUserAgent.match(/rv:1.2.3.4/i) == "rv:1.2.3.4"<span style="line-height:1.5;">,
          bIsUc</span>= sUserAgent.match(/ucweb/i) == "ucweb"<span style="line-height:1.5;">,
          bIsAndroid</span>= sUserAgent.match(/android/i) == "android"<span style="line-height:1.5;">,
          bIsCE</span>= sUserAgent.match(/windows ce/i) == "windows ce"<span style="line-height:1.5;">,
          bIsWM</span>= sUserAgent.match(/windows mobile/i) == "windows mobile"<span style="line-height:1.5;">,
          bIsWebview </span>= sUserAgent.match(/webview/i) == "webview"<span style="line-height:1.5;">;
          </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span> (bIsIpad || bIsIphoneOs || bIsMidp || bIsUc7 || bIsUc || bIsAndroid || bIsCE ||<span style="line-height:1.5;"> bIsWM);
     }


</span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> eventType = <span style="color:rgb(0,0,255);line-height:1.5;">this</span>.isMobile() ? 'touchstart' : 'click'<span style="line-height:1.5;">;
          $(document).on(eventType, </span><span style="color:rgb(0,0,255);line-height:1.5;">function</span><span style="line-height:1.5;">(){
               </span><span style="color:rgb(0,0,255);line-height:1.5;">if</span>(++direction%2==0<span style="line-height:1.5;">){
                    player[</span>0].className = 'flyl'<span style="line-height:1.5;">;
               }
               </span><span style="color:rgb(0,0,255);line-height:1.5;">else</span><span style="line-height:1.5;">{
                    player[</span>0].className = 'flyr'<span style="line-height:1.5;">;
               }
          });</span></pre> 
                      <div class="cnblogs_code_toolbar">
                       <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;text-decoration:underline;line-height:normal;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
                      </div> 
                     </div> 
                     <div> 
                      <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                       <strong>分享到微博</strong>
                      </div> 
                      <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                       　　为了让游戏易于传播，在网上搜了一段分享到微博的代码，试了一下好用，直接贴过来：
                      </div> 
                      <div> 
                       <div class="cnblogs_code" style="color:rgb(0,0,0);font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);">
                        <pre><span style="color:rgb(0,0,255);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">a </span><span style="color:rgb(255,0,0);line-height:1.5;">id</span><span style="color:rgb(0,0,255);line-height:1.5;">="share"</span><span style="color:rgb(255,0,0);line-height:1.5;"> href</span><span style="color:rgb(0,0,255);line-height:1.5;">="javascript:(function(){window.open('http://v.t.sina.com.cn/share/share.php?title=网页版SwingCopters，来，看看你有多挫&amp;url=idoube.com/proj/SwingCopters&amp;source=bookmark&amp;pic=http%3A%2F%2Fidoube.com%2Fproj%2FSwingCopters%2FSwingCopters%2Fshot.jpg','_blank','width=450,height=400');})()"</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span>分享到微博<span style="color:rgb(0,0,255);line-height:1.5;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5;">a</span><span style="color:rgb(0,0,255);line-height:1.5;">&gt;</span></pre>
                       </div> 
                       <div> 
                        <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                         　　其实在手机上的话，还应该加上微信分享，但是我在手机上玩了一下这个游戏后，顿时感觉没必要了。因为，手机上，那个卡啊！！fps估计在20左右。配置不错的三星尚且如此，可以想象其他安卓机会是什么情况。
                        </div> 
                        <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                         　　另一个可喜的是，在iphone上玩竟然很流程！在此也不得不佩服ios对图形渲染的处理。
                        </div> 
                        <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                         　　不过，如果以后再做这种动画比较多的游戏，我是肯定不会选择用DOM来做了。
                        </div> 
                        <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                         &nbsp;
                        </div> 
                        <div> 
                         <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                          <strong>总结</strong>
                         </div> 
                         <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                          　　这是楼主第一次写小游戏，虽然最终搞出来的游戏像模像样也能玩，但写的过于仓促，有些知识也没有深究，中间踩了一些坑，整体代码质量也并不高。在这里列一列吧：
                         </div> 
                         <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                          　　1. 有些动画是用纯css3完成，有些是写在js里，到底动画该如何归类应该细细考虑
                         </div> 
                         <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                          　　2. 没有进行性能监测，我的机器配置较高，在chrome里可以跑到接近60fps。但感觉代码有些地方效率并不高。在Android机上直接卡爆。
                         </div> 
                         <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                          　　3. 代码简单，js中用了很多全局变量。因为以前有听人说过，简单的程序直接用全局变量就行，性能高，但没有求证这种说法，不知正确与否，有高手知道请指点。
                         </div> 
                         <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                          　　4. 对于动画比较多的小游戏，用DOM来做不是一个很好的选择，因为手机上卡，不能在微信里分享，效果直接就大打折扣了。下次试着用canvas来写。
                         </div> 
                         <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;"> 
                          <div>
                           　　5. 整个代码还是操作DOM的思维，其实做游戏应该用面向对象的风格来组织代码。
                          </div> 
                          <div>
                           &nbsp;
                          </div> 
                          <div>
                           　　再次附上游戏地址，欢迎体验：
                           <a href="http://idoube.com/proj/SwingCopters/" rel="nofollow" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;line-height:normal;">http://idoube.com/proj/SwingCopters/</a> 
                          </div> 
                         </div> 
                         <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                          &nbsp;
                         </div> 
                         <div style="color:rgb(51,51,51);font-family:'Microsoft Yahei';font-size:16px;">
                          　　最后推荐一个我写css3动画经常参考的一个文档：
                          <a href="http://ecd.tencent.com/css3/guide.html" rel="nofollow" style="color:rgb(171,98,43);font-family:Arial, Helvetica, sans-serif;font-size:14px;line-height:normal;">http://ecd.tencent.com/css3/guide.html</a>&nbsp;&nbsp;
                         </div> 
                         <div> 
                          <font color="#333333">本文转自吕大豹博客园博客，原文链接：http://www.cnblogs.com/lvdabao/p/3968464.html，如需转载请自行联系原作者</font>
                          <br>
                         </div> 
                        </div> 
                       </div> 
                      </div> 
                     </div> 
                    </div> 
                   </div> 
                  </div> 
                 </div> 
                </div> 
               </div> 
              </div> 
             </div> 
            </div> 
           </div> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
