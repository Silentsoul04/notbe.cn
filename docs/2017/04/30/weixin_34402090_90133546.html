<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>iOS：quartz2D绘图小项目(涂鸦画板) « NotBeCN</title>
  <meta name="description" content="                  介绍：学了quartz2D的绘图知识后,我根据它的一些功能制作了一个小项目:涂鸦画板。     功能：绘制各种图形,还可以选取相册上的照片做涂鸦,然后保存到相册中。其中，还包括功能有：颜色的选取、线宽的选取、橡皮擦除、撤销上一次绘制痕迹、清除所有痕迹。     用到的自定义控件...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/04/30/weixin_34402090_90133546.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">iOS：quartz2D绘图小项目(涂鸦画板)</h1>
    <p class="post-meta">Apr 30, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;">介绍：学了quartz2D的绘图知识后,我根据它的一些功能制作了一个小项目:涂鸦画板。</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:medium;"><span style="line-height:24px;">功能：绘制各种图形,还可以选取相册上的照片做涂鸦,然后保存到相册中。其中，还包括功能有：颜色的选取、线宽的选取、橡皮擦除、撤销上一次绘制痕迹、清除所有痕迹。</span></span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;">用到的自定义控件：工具栏控件(UIToolBar)、工具栏上的按钮控件(UIBarButtonItem)、警告框控件(UIAlertView、UIActionSheet)、图像选择器控制器控件(UIImagePickerController)等。</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;">需要的类：除了应用程序代理类AppDelegate和控制器类ViewController外，还需要一个自定义的视图类DemoView和一个自定义的绘制路径类MyPath。MyPath类是用来封装绘制路径的,因为路径是结构体,所以不能直接动作对象使用,封装后可以将路径保存数组中,用来连续绘图。</span></p> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;">具体操作如下：</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;">1、创建如上介绍的类的截图为：</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;"><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013205710772-142092588.png" alt="" style="border:0px;"></span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;">2、将自定义的视图类DemiView与控制器的视图关联起来：</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;"><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013205724507-68983300.png" alt="" style="border:0px;">&nbsp; &nbsp;<img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013205730976-2141334570.png" alt="" style="border:0px;">&nbsp;</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;">3、下面就是具体针对每一个类的代码了：</span></p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;color:rgb(255,0,0);">&lt;1&gt;在MyPath.h文件中</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,0,255);">#import</span> &lt;Foundation/Foundation.h&gt;
<span style="line-height:1.8;color:rgb(0,0,255);">#import</span> &lt;UIKit/UIKit.h&gt;
<span style="line-height:1.8;color:rgb(0,0,255);">#define</span> PHOTO_RECT (CGRectMake(0,0,375,667))<span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">绘制照片局域宏定义</span>
<span style="line-height:1.8;color:rgb(0,0,255);">@interface</span><span style="line-height:1.8;"> MyPath : NSObject
@property (assign,nonatomic)CGMutablePathRef path;   <span style="line-height:1.8;color:rgb(0,128,0);">//可变的路径</span>
@property (strong,nonatomic)UIColor </span>*<span style="line-height:1.8;">color;  <span style="line-height:1.8;color:rgb(0,128,0);">//颜色</span>
@property (assign,nonatomic)NSInteger lineWidth; <span style="line-height:1.8;color:rgb(0,128,0);">//线宽</span>
@property (strong,nonatomic)UIImage </span>*<span style="line-height:1.8;">image;<span style="line-height:1.8;color:rgb(0,128,0);">//图像 </span></span><span style="line-height:1.8;color:rgb(0,0,255);">@end</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;color:rgb(255,0,0);font-size:16px;font-family:'楷体';">&lt;2&gt;在Application.m文件中：</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *<span style="line-height:1.8;">)launchOptions {

    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">设置偏好</span>
    NSUserDefaults *userDefaults =<span style="line-height:1.8;"> [NSUserDefaults standardUserDefaults];
    [userDefaults setBool:YES forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">isDefualtColor</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [userDefaults setBool:YES forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">isDefualtLine</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [userDefaults synchronize];
    
    </span><span style="line-height:1.8;color:rgb(0,0,255);">return</span><span style="line-height:1.8;"> YES;
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;color:rgb(255,0,0);font-size:16px;font-family:'楷体';">&lt;3&gt;在DemoView类中</span></p> 
    <p><span style="line-height:1.8;color:rgb(255,0,255);">DemoView.h文件</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,0,255);">#import</span> &lt;UIKit/UIKit.h&gt;
<span style="line-height:1.8;color:rgb(0,0,255);">@interface</span><span style="line-height:1.8;"> DemoView : UIView
@property (strong,nonatomic)UIColor </span>*<span style="line-height:1.8;">color;        <span style="line-height:1.8;color:rgb(0,128,0);">//颜色</span>
@property (assign,nonatomic)NSInteger lineWidth;   <span style="line-height:1.8;color:rgb(0,128,0);">//线宽</span>
@property (strong,nonatomic)NSMutableArray </span>*<span style="line-height:1.8;">paths; <span style="line-height:1.8;color:rgb(0,128,0);">//可变数组,用来保存路径</span>
@property(assign,nonatomic)BOOL isUndo;  <span style="line-height:1.8;color:rgb(0,128,0);">//标示符</span>
@property (strong,nonatomic)UIImage </span>*<span style="line-height:1.8;">image; <span style="line-height:1.8;color:rgb(0,128,0);">//图像</span>
@property (assign,nonatomic)CGMutablePathRef path;<span style="line-height:1.8;color:rgb(0,128,0);"> //可变的路径 </span></span><span style="line-height:1.8;color:rgb(0,0,255);">@end</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;color:rgb(255,0,255);">DemoView.m文件</span></p> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//懒加载</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre>-(NSMutableArray*<span style="line-height:1.8;">)paths
{
    </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span> (!<span style="line-height:1.8;">_paths)
    {
        _paths </span>=<span style="line-height:1.8;"> [NSMutableArray array];
    }
    </span><span style="line-height:1.8;color:rgb(0,0,255);">return</span><span style="line-height:1.8;"> _paths;
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p>&nbsp;<span style="line-height:1.8;color:rgb(128,0,0);">//画图</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre>- (<span style="line-height:1.8;color:rgb(0,0,255);">void</span><span style="line-height:1.8;">)drawRect:(CGRect)rect
{    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">1.获取绘制图上下文</span>
    CGContextRef context =<span style="line-height:1.8;"> UIGraphicsGetCurrentContext();
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">4.添加保存的路径到上下文</span>
    <span style="line-height:1.8;color:rgb(0,0,255);">for</span> (MyPath *myPath <span style="line-height:1.8;color:rgb(0,0,255);">in</span><span style="line-height:1.8;"> self.paths)
    {
        CGContextAddPath(context, myPath.path);
        
        </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span><span style="line-height:1.8;">(myPath.image)
        {
            [myPath.image drawInRect:PHOTO_RECT];
        }
        
        </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">设置绘图属性</span>
        [myPath.color <span style="line-height:1.8;color:rgb(0,0,255);">set</span><span style="line-height:1.8;">];
        CGContextSetLineWidth(context, myPath.lineWidth);
        
        </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">绘制路径</span>
<span style="line-height:1.8;">        CGContextDrawPath(context, kCGPathStroke);
    }
    
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">如果是清除或撤销,就不执行当前绘图</span>
    <span style="line-height:1.8;color:rgb(0,0,255);">if</span> (!<span style="line-height:1.8;">self.isUndo)
    {
        </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span><span style="line-height:1.8;">(self.image)
        {
            [self.image drawInRect:PHOTO_RECT];
        }
        
        </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">添加当前路径</span>
<span style="line-height:1.8;">        CGContextAddPath(context, _path);
        
        </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">5.设置当前绘图属性</span>
        [self.color <span style="line-height:1.8;color:rgb(0,0,255);">set</span><span style="line-height:1.8;">];
        CGContextSetLineWidth(context, self.lineWidth);
        
        </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">6.绘制路径</span>
<span style="line-height:1.8;">        CGContextDrawPath(context, kCGPathStroke);
    }
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//开始触摸事件(设置绘制属性)</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre>-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)<span style="line-height:1.8;color:rgb(0,0,255);">event</span><span style="line-height:1.8;">
{
    self.isUndo </span>=<span style="line-height:1.8;"> NO;
    
    NSUserDefaults </span>*userDefaults =<span style="line-height:1.8;"> [NSUserDefaults standardUserDefaults];    
    </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span> ([userDefaults boolForKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">isDefualtColor</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">])
    {
        </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">设置默认颜色</span>
        self.color =<span style="line-height:1.8;"> [UIColor blackColor];
    }
    </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span> ([userDefaults boolForKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">isDefualtLine</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">])
    {
        </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">设置默认线宽</span>
        self.lineWidth = <span style="line-height:1.8;color:rgb(128,0,128);">1.0</span><span style="line-height:1.8;">;
    }
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">接收颜色通知</span>
    [[NSNotificationCenter defaultCenter]addObserver:self selector:@selector(seclectColor:) name:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">ColorNitification</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span> <span style="line-height:1.8;color:rgb(0,0,255);">object</span><span style="line-height:1.8;">:nil];
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">接收线宽通知</span>
    [[NSNotificationCenter defaultCenter]addObserver:self selector:@selector(selectedWidth:) name:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">WidthNitification</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>  <span style="line-height:1.8;color:rgb(0,0,255);">object</span><span style="line-height:1.8;">:nil];
    
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">创建路径</span>
    _path =<span style="line-height:1.8;"> CGPathCreateMutable();
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">创建起始点</span>
    UITouch *touch =<span style="line-height:1.8;"> [touches anyObject];
    CGPoint location </span>=<span style="line-height:1.8;"> [touch locationInView:self];
    CGPathMoveToPoint(_path, nil, location.x, location.y);
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//获取通知中的颜色和线宽数据</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">从通知中获取颜色</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)seclectColor:(NSNotification*<span style="line-height:1.8;">)notification
{
    self.color </span>= notification.<span style="line-height:1.8;color:rgb(0,0,255);">object</span><span style="line-height:1.8;">;
    
    </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span> (self.color ==<span style="line-height:1.8;"> NULL)
    {
        self.color </span>=<span style="line-height:1.8;"> [UIColor blackColor];
    }
}

</span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">从通知中获取线宽</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)selectedWidth:(NSNotification*<span style="line-height:1.8;">) notification
{
    NSNumber </span>*number = notification.<span style="line-height:1.8;color:rgb(0,0,255);">object</span><span style="line-height:1.8;">;
    self.lineWidth </span>=<span style="line-height:1.8;"> [number integerValue];
    </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span> (self.lineWidth == <span style="line-height:1.8;color:rgb(128,0,128);">0</span><span style="line-height:1.8;">)
    {
        self.lineWidth </span>= <span style="line-height:1.8;color:rgb(128,0,128);">1.0</span><span style="line-height:1.8;">;
    }
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//触摸移动(添加新路径,刷新视图)</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre>-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)<span style="line-height:1.8;color:rgb(0,0,255);">event</span><span style="line-height:1.8;">
{
    </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span><span style="line-height:1.8;"> (_path)
    {
        </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">向路径添加新的直线</span>
        UITouch *touch =<span style="line-height:1.8;"> [touches anyObject];
        CGPoint location </span>=<span style="line-height:1.8;"> [touch locationInView:self];
        CGPathAddLineToPoint(_path, nil, location.x, location.y);
        
        </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">让视图刷新</span>
<span style="line-height:1.8;">        [self setNeedsDisplay];
    }
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//触摸结束(封装路径并保存到数组中)</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre>-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)<span style="line-height:1.8;color:rgb(0,0,255);">event</span><span style="line-height:1.8;">
{
    </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span><span style="line-height:1.8;"> (_path)
    {
        </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">保存路径</span>
        MyPath *myPath =<span style="line-height:1.8;"> [[MyPath alloc]init];
        myPath.path </span>=<span style="line-height:1.8;"> self.path;
        myPath.color </span>=<span style="line-height:1.8;"> self.color;
        myPath.lineWidth </span>=<span style="line-height:1.8;"> self.lineWidth;
        
        </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span><span style="line-height:1.8;">(self.image)
        {
            myPath.image </span>=<span style="line-height:1.8;"> self.image;
            self.image </span>=<span style="line-height:1.8;"> nil;
        }
        <br><span style="line-height:1.8;color:rgb(0,128,0);">//保存路径</span>
        [self.paths addObject:myPath];
    }
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//清理路径</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre>-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span><span style="line-height:1.8;">)dealloc
{
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">清理保存的路径</span>
    <span style="line-height:1.8;color:rgb(0,0,255);">for</span> (MyPath *myPath <span style="line-height:1.8;color:rgb(0,0,255);">in</span><span style="line-height:1.8;"> self.paths)
    {
        CGPathRelease(myPath.path);
    }
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;font-size:16px;font-family:'楷体';color:rgb(255,0,0);">&lt;4&gt;在ViewController.m文件中</span></p> 
    <p><span style="line-height:1.8;font-size:15px;color:rgb(128,0,0);">//设置属性</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,0,255);">@interface</span> ViewController ()&lt;UIAlertViewDelegate,UIActionSheetDelegate,UIImagePickerControllerDelegate,UINavigationControllerDelegate&gt;<span style="line-height:1.8;">
@property (strong,nonatomic)UIToolbar </span>*<span style="line-height:1.8;">toolBar;
@property (strong,nonatomic)NSMutableDictionary </span>*<span style="line-height:1.8;">DicM;

</span><span style="line-height:1.8;color:rgb(0,0,255);">@end</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//初始化和创建控件</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre>- (<span style="line-height:1.8;color:rgb(0,0,255);">void</span><span style="line-height:1.8;">)viewDidLoad {
    [super viewDidLoad];
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">初始化</span>
    self.DicM =<span style="line-height:1.8;"> [NSMutableDictionary dictionary];
    ((DemoView </span>*)self.view).isUndo =<span style="line-height:1.8;"> NO;
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">创建工具栏对象</span>
    self.toolBar =<span style="line-height:1.8;"> [[UIToolbar alloc]init];
    self.toolBar.barTintColor </span>=<span style="line-height:1.8;"> [UIColor brownColor];
    self.toolBar.frame </span>= CGRectMake(<span style="line-height:1.8;color:rgb(128,0,128);">0</span>, <span style="line-height:1.8;color:rgb(128,0,128);">0</span>, <span style="line-height:1.8;color:rgb(128,0,128);">375</span>, <span style="line-height:1.8;color:rgb(128,0,128);">40</span><span style="line-height:1.8;">);
    
    
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">创建工具栏项目</span>
    UIBarButtonItem *colorItem = [[UIBarButtonItem alloc]initWithTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">颜色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;"> style:UIBarButtonItemStylePlain target:self action:@selector(SelectColor:)];
    
    UIBarButtonItem </span>*lineWidthItem = [[UIBarButtonItem alloc]initWithTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">线宽</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;"> style:UIBarButtonItemStylePlain target:self action:@selector(SelectWidth:)];
    
    UIBarButtonItem </span>*clearpartItem = [[UIBarButtonItem alloc]initWithTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">橡皮</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;"> style:UIBarButtonItemStylePlain target:self action:@selector(ClearPart:)];
    
    UIBarButtonItem </span>*backdoneItem = [[UIBarButtonItem alloc]initWithTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">撤销</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;"> style:UIBarButtonItemStylePlain target:self action:@selector(BackDone:)];
    
    UIBarButtonItem </span>*clearallItem = [[UIBarButtonItem alloc]initWithTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">清空</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;"> style:UIBarButtonItemStylePlain target:self action:@selector(ClearAll:)];
    
    UIBarButtonItem </span>*photoItem = [[UIBarButtonItem alloc]initWithTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">照片</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;"> style:UIBarButtonItemStylePlain target:self action:@selector(selectPhoto:)];
    
    UIBarButtonItem </span>*saveItem = [[UIBarButtonItem alloc]initWithTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">保存</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;"> style:UIBarButtonItemStylePlain target:self action:@selector(Save:)];
    
    UIBarButtonItem </span>*flexibleItem =<span style="line-height:1.8;"> [[UIBarButtonItem alloc]initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
    
    [self.toolBar setItems:@[colorItem,flexibleItem,lineWidthItem,flexibleItem,clearpartItem,flexibleItem,backdoneItem,flexibleItem,clearallItem,flexibleItem,photoItem,flexibleItem,saveItem]];
    
    [self.view addSubview:self.toolBar];
    <br><span style="line-height:1.8;color:rgb(0,128,0);"> //开始时隐藏工具栏</span>
    self.toolBar.hidden </span>=<span style="line-height:1.8;"> YES;
    
    
    
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">创建点击手势(双击时显示和隐藏工具栏)</span>
    UITapGestureRecognizer *tap =<span style="line-height:1.8;"> [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(showToolBar:)];
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">设置点击次数</span>
    tap.numberOfTapsRequired = <span style="line-height:1.8;color:rgb(128,0,128);">2</span><span style="line-height:1.8;">;
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">添加手势</span>
<span style="line-height:1.8;">    [self.view addGestureRecognizer:tap];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//设置颜色选项</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">选择颜色</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)SelectColor:(UIBarButtonItem *<span style="line-height:1.8;">)sender
{
    UIAlertView </span>*alertView = [[UIAlertView alloc]initWithTitle:nil message:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">可选颜色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span> <span style="line-height:1.8;color:rgb(0,0,255);">delegate</span>:self cancelButtonTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">取消</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span> otherButtonTitles:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">红色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">绿色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">紫色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">黄色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">黑色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">白色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">蓝色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">灰色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">棕色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">,nil];
    
    
    [self.DicM setObject:[UIColor redColor]   forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">红色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[UIColor greenColor] forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">绿色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[UIColor purpleColor]forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">紫色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[UIColor yellowColor]forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">黄色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[UIColor blackColor] forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">黑色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[UIColor whiteColor] forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">白色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[UIColor blueColor]  forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">蓝色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[UIColor grayColor]  forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">灰色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[UIColor brownColor] forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">棕色</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    
    [alertView show];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//设置线宽选项</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">选择线宽</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)SelectWidth:(UIBarButtonItem *<span style="line-height:1.8;">)sender
{
    UIActionSheet </span>*actionSheet = [[UIActionSheet alloc]initWithTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">可选线宽</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span> <span style="line-height:1.8;color:rgb(0,0,255);">delegate</span>:self cancelButtonTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">取消</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span> destructiveButtonTitle:nil otherButtonTitles:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">1号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">2号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">3号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">4号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">5号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">6号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">7号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">8号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">9号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span>,<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">10号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">,nil];
    
    [self.DicM setObject:[NSNumber numberWithInteger:</span><span style="line-height:1.8;color:rgb(128,0,128);">1</span>]  forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">1号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[NSNumber numberWithInteger:</span><span style="line-height:1.8;color:rgb(128,0,128);">2</span>]  forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">2号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[NSNumber numberWithInteger:</span><span style="line-height:1.8;color:rgb(128,0,128);">3</span>]  forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">3号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[NSNumber numberWithInteger:</span><span style="line-height:1.8;color:rgb(128,0,128);">4</span>]  forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">4号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[NSNumber numberWithInteger:</span><span style="line-height:1.8;color:rgb(128,0,128);">5</span>]  forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">5号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[NSNumber numberWithInteger:</span><span style="line-height:1.8;color:rgb(128,0,128);">6</span>]  forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">6号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[NSNumber numberWithInteger:</span><span style="line-height:1.8;color:rgb(128,0,128);">7</span>]  forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">7号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[NSNumber numberWithInteger:</span><span style="line-height:1.8;color:rgb(128,0,128);">8</span>]  forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">8号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[NSNumber numberWithInteger:</span><span style="line-height:1.8;color:rgb(128,0,128);">9</span>]  forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">9号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [self.DicM setObject:[NSNumber numberWithInteger:</span><span style="line-height:1.8;color:rgb(128,0,128);">10</span>] forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">10号</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    
    [actionSheet showInView:self.view];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//实现UIAlertView警告框协议</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,0,255);">#pragma</span> mark -&lt;UIAlertViewDelegate&gt;
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)alertView:(UIAlertView *<span style="line-height:1.8;">)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    NSString </span>*key =<span style="line-height:1.8;"> [alertView buttonTitleAtIndex:buttonIndex];
    
    UIColor </span>*selectedcolor =<span style="line-height:1.8;"> [self.DicM objectForKey:key];

    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">发送通知附带颜色数据</span>
    [[NSNotificationCenter defaultCenter]postNotificationName:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">ColorNitification</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span> <span style="line-height:1.8;color:rgb(0,0,255);">object</span><span style="line-height:1.8;">:selectedcolor];
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">重设偏好</span>
    [[NSUserDefaults standardUserDefaults] setBool:NO forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">isDefualtColor</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [[NSUserDefaults standardUserDefaults] synchronize];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//实现UIActionSheet警告框协议</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,0,255);">#pragma</span> mark -&lt;UIActionSheetDelegate&gt;
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)actionSheet:(UIActionSheet *<span style="line-height:1.8;">)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex
{
    NSString </span>*key =<span style="line-height:1.8;"> [actionSheet buttonTitleAtIndex:buttonIndex];
    
    NSNumber </span>*number =<span style="line-height:1.8;"> [self.DicM objectForKey:key];
    
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">发送通知附带线宽数据</span>
    [[NSNotificationCenter defaultCenter]postNotificationName:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">WidthNitification</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span> <span style="line-height:1.8;color:rgb(0,0,255);">object</span><span style="line-height:1.8;">:number];
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">重设偏好</span>
    [[NSUserDefaults standardUserDefaults] setBool:NO forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">isDefualtLine</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [[NSUserDefaults standardUserDefaults] synchronize];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//擦除功能</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">橡皮擦除(其实就是用白色重绘)</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)ClearPart:(UIBarButtonItem *<span style="line-height:1.8;">)sender
{
    UIColor </span>*selectedcolor =<span style="line-height:1.8;"> [UIColor whiteColor];
    [[NSNotificationCenter defaultCenter]postNotificationName:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">ColorNitification</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span> <span style="line-height:1.8;color:rgb(0,0,255);">object</span><span style="line-height:1.8;">:selectedcolor];
    
    NSNumber </span>*number = [NSNumber numberWithInteger:<span style="line-height:1.8;color:rgb(128,0,128);">10</span><span style="line-height:1.8;">];
    [[NSNotificationCenter defaultCenter]postNotificationName:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">WidthNitification</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span> <span style="line-height:1.8;color:rgb(0,0,255);">object</span><span style="line-height:1.8;">:number];
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">重设偏好</span>
    [[NSUserDefaults standardUserDefaults] setBool:NO forKey:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">isDefualtColor</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [[NSUserDefaults standardUserDefaults] synchronize];
    
    [[NSUserDefaults standardUserDefaults] setBool:NO forKey:</span><span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">isDefualtLine</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">];
    [[NSUserDefaults standardUserDefaults] synchronize];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//撤销功能</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">撤销</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)BackDone:(UIBarButtonItem *<span style="line-height:1.8;">)sender
{
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">先做清理工作</span>
    MyPath *path = [((DemoView *<span style="line-height:1.8;">)self.view).paths lastObject];
    CGPathRelease(path.path);
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">删除最后一个路径</span>
    [((DemoView *<span style="line-height:1.8;">)self.view).paths removeLastObject];
    ((DemoView </span>*)self.view).image =<span style="line-height:1.8;"> nil;
    
    ((DemoView </span>*)self.view).isUndo =<span style="line-height:1.8;"> YES;
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">让视图重绘</span>
<span style="line-height:1.8;">    [self.view setNeedsDisplay];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//清空功能</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">清空绘图</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)ClearAll:(UIBarButtonItem *<span style="line-height:1.8;">)sender
{
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">先做清理工作</span>
    <span style="line-height:1.8;color:rgb(0,0,255);">for</span>(MyPath *path <span style="line-height:1.8;color:rgb(0,0,255);">in</span> ((DemoView *<span style="line-height:1.8;">)self.view).paths)
    {
        CGPathRelease(path.path);
    }
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">删除所有</span>
    [((DemoView *<span style="line-height:1.8;">)self.view).paths removeAllObjects];
    ((DemoView </span>*)self.view).image =<span style="line-height:1.8;"> nil;
    
    ((DemoView </span>*)self.view).isUndo =<span style="line-height:1.8;"> YES;
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">让视图重绘</span>
<span style="line-height:1.8;">    [self.view setNeedsDisplay];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//保存绘图功能</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">保存绘图</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)Save:(UIBarButtonItem *<span style="line-height:1.8;">)sender
{
    [self didSelectedSave];
}
</span>-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span><span style="line-height:1.8;">)didSelectedSave
{
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">开始图像绘制上下文</span>
<span style="line-height:1.8;">    UIGraphicsBeginImageContext(self.view.bounds.size);
    
    CGContextRef context </span>=<span style="line-height:1.8;"> UIGraphicsGetCurrentContext();
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);"> 先画保存的path</span>
    <span style="line-height:1.8;color:rgb(0,0,255);">for</span>(MyPath *myPath <span style="line-height:1.8;color:rgb(0,0,255);">in</span> ((DemoView *<span style="line-height:1.8;">)self.view).paths)
    {
        </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span><span style="line-height:1.8;">(myPath.image)
        {
            [myPath.image drawInRect: PHOTO_RECT ];
        }
        
        CGContextAddPath(context, myPath.path);
        [myPath.color </span><span style="line-height:1.8;color:rgb(0,0,255);">set</span><span style="line-height:1.8;">];
        CGContextSetLineWidth(context, myPath.lineWidth);
        CGContextStrokePath(context);
    }
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">获取绘制的图片</span>
    UIImage *image =<span style="line-height:1.8;"> UIGraphicsGetImageFromCurrentImageContext();
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">结束图像绘制上下文</span>
<span style="line-height:1.8;">    UIGraphicsEndImageContext();
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">保存图片</span>
<span style="line-height:1.8;">    UIImageWriteToSavedPhotosAlbum(image, self, @selector(image:didFinishSavingWithError:contextInfo:), NULL);
}
</span>- (<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)image: (UIImage *<span style="line-height:1.8;">) image
    didFinishSavingWithError: (NSError </span>*<span style="line-height:1.8;">) error
                 contextInfo: (</span><span style="line-height:1.8;color:rgb(0,0,255);">void</span> *<span style="line-height:1.8;">) contextInfo
{
    NSString </span>*msg =<span style="line-height:1.8;"> nil;
    </span><span style="line-height:1.8;color:rgb(0,0,255);">if</span><span style="line-height:1.8;">(error)
    {
        msg </span>= <span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">图片保存失败</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">;
    }
    </span><span style="line-height:1.8;color:rgb(0,0,255);">else</span><span style="line-height:1.8;">
    {
        msg </span>= <span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">图片保存成功</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;">;
    }
    UIAlertView </span>*alert = [[UIAlertView alloc]initWithTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">保存图片</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span> message:msg <span style="line-height:1.8;color:rgb(0,0,255);">delegate</span>:self cancelButtonTitle:<span style="line-height:1.8;color:rgb(128,0,0);">@"</span><span style="line-height:1.8;color:rgb(128,0,0);">OK</span><span style="line-height:1.8;color:rgb(128,0,0);">"</span><span style="line-height:1.8;"> otherButtonTitles:nil];
    [alert show];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//选取照片功能</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">选取照片</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)selectPhoto:(UIBarButtonItem*<span style="line-height:1.8;">)sender
{
    [self didSelectedPhoto];
}

</span>-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span><span style="line-height:1.8;">)didSelectedPhoto
{
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">显示照片选择窗口</span>
    UIImagePickerController *picker =<span style="line-height:1.8;"> [[UIImagePickerController alloc]init];
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">图片来源是相册</span>
    picker.sourceType =<span style="line-height:1.8;"> UIImagePickerControllerSourceTypePhotoLibrary;
    
    
    picker.</span><span style="line-height:1.8;color:rgb(0,0,255);">delegate</span> =<span style="line-height:1.8;"> self;
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">以模态窗口的形式显示图片</span>
<span style="line-height:1.8;">    [self presentViewController:picker animated:YES completion:nil];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//图像选择器控制器协议方法</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="line-height:1.8;color:rgb(0,0,255);">#pragma</span> mark - imagePikerController 代理方法
<span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">选取图片</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *<span style="line-height:1.8;">)info
{
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">取出图片</span>
    UIImage *image =<span style="line-height:1.8;"> [info objectForKey:UIImagePickerControllerOriginalImage];
    
    ((DemoView </span>*)self.view).image =<span style="line-height:1.8;"> image;
    
    ((DemoView </span>*)self.view).isUndo =<span style="line-height:1.8;"> NO;
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">创建路径</span>
    ((DemoView *)self.view).path =<span style="line-height:1.8;"> CGPathCreateMutable();
    
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">关闭模态窗口</span>
<span style="line-height:1.8;">    [picker dismissViewControllerAnimated:YES completion:nil];
    
    </span><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">刷新视图</span>
<span style="line-height:1.8;">    [self.view setNeedsDisplay];
}</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.8;color:rgb(128,0,0);">//手势事件,是否显示工具栏</span></p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">
     <pre><span style="line-height:1.8;color:rgb(0,128,0);">//</span><span style="line-height:1.8;color:rgb(0,128,0);">按钮事件是否显示工具栏</span>
-(<span style="line-height:1.8;color:rgb(0,0,255);">void</span>)showToolBar:(UIButton *<span style="line-height:1.8;">)sender
{
    self.toolBar.hidden </span>= !<span style="line-height:1.8;">self.toolBar.hidden;
}</span></pre>
    </div> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;color:rgb(0,0,0);font-size:18px;font-family:'楷体';">演示截图如下：</span></p> 
    <p><span style="line-height:1.8;color:rgb(51,102,255);font-size:16px;font-family:'楷体';">开始时： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;　　　　　　　　　　　　双击显示工具栏：<br></span></p> 
    <p><span style="line-height:1.8;color:rgb(51,102,255);font-size:16px;font-family:'楷体';"><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013212606554-1571639638.png" alt="" style="border:0px;">&nbsp; &nbsp;&nbsp;<img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013212640913-132141226.png" alt="" style="border:0px;"></span></p> 
    <p><span style="line-height:1.8;color:rgb(51,102,255);font-size:16px;font-family:'楷体';">(使用默认颜色和线宽)绘制直线 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;选颜色绘制直线 ,选红色&nbsp;</span></p> 
    <p><span style="line-height:1.8;color:rgb(0,0,0);font-size:18px;font-family:'楷体';"><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013212751538-1668077686.png" alt="" style="border:0px;">&nbsp; &nbsp;<img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013212804632-1195206907.png" alt="" style="border:0px;"></span></p> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;color:rgb(0,0,0);font-size:18px;font-family:'楷体';"><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013212817835-100126887.png" alt="" style="border:0px;"></span></p> 
    <p>&nbsp;</p> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;font-family:'楷体';font-size:16px;color:rgb(51,102,255);">接着选择线宽绘制直线：选10号</span></p> 
    <p><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013212922413-1405268023.png" alt="" style="border:0px;">&nbsp;&nbsp;<img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013212937351-1676375205.png" alt="" style="border:0px;"></p> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;color:rgb(51,102,255);font-family:'楷体';font-size:16px;">点击橡皮擦除： &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;　　　　　　　　　　　　　　　　点击撤销，被擦除部分还原<br></span></p> 
    <p><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013213031804-1419191047.png" alt="" style="border:0px;">&nbsp; &nbsp; &nbsp;<img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013213122397-318885574.png" alt="" style="border:0px;"></p> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;font-size:16px;font-family:'楷体';color:rgb(51,102,255);">点击清空，什么都没有了： &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 点击照片，打开相册 &nbsp;&nbsp;</span></p> 
    <p><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013213250741-780099707.png" alt="" style="border:0px;">&nbsp; &nbsp;<img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013213324819-1942560911.png" alt="" style="border:0px;"></p> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;color:rgb(51,102,255);font-size:16px;font-family:'楷体';">任意选取一张照片,选取X</span></p> 
    <p><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013213428397-588348416.png" alt="" style="border:0px;">&nbsp;&nbsp;<img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013213438319-1543502727.png" alt="" style="border:0px;"></p> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;color:rgb(51,102,255);font-size:16px;font-family:'楷体';">绘制图片并保存到相册：</span></p> 
    <p><span style="line-height:1.8;color:rgb(51,102,255);font-size:16px;font-family:'楷体';"><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013214508726-1337615495.png" alt="" style="border:0px;">&nbsp; &nbsp;&nbsp;<img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013213556726-1548700220.png" alt="" style="border:0px;"></span></p> 
    <p><span style="line-height:1.8;color:rgb(51,102,255);font-size:16px;font-family:'楷体';">查看保存的图片</span></p> 
    <p><span style="line-height:1.8;color:rgb(51,102,255);font-size:16px;font-family:'楷体';"><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013213628601-186168191.png" alt="" style="border:0px;">&nbsp;<img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013213647413-1895647310.png" alt="" style="border:0px;"></span></p> 
    <p>&nbsp;</p> 
    <p>&nbsp;</p> 
    <p><span style="line-height:1.8;font-size:16px;font-family:'楷体';color:rgb(0,0,255);">可以再双击隐藏工具栏：</span></p> 
    <p><img src="https://images2015.cnblogs.com/blog/791499/201510/791499-20151013214018647-1427237765.png" alt="" style="border:0px;"></p> 
   </div> 
   <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    程序猿神奇的手，每时每刻，这双手都在改变着世界的交互方式！
   </div> 
   <div class="clear" style="clear:both;color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></div> 
   <div> 
    <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     分类:&nbsp;
     <a href="http://www.cnblogs.com/XYQ-208910/category/742527.html" rel="nofollow" style="text-decoration:none;color:rgb(156,186,57);border-bottom:1px dotted rgb(153,153,153);border-top-color:rgb(153,153,153);border-right-color:rgb(153,153,153);border-left-color:rgb(153,153,153);">iOS高级</a> 
    </div> 
    <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     <br>
    </div> 
    <div> 
     <font color="#333333"><span style="font-size:14px;">本文转自当天真遇到现实博客园博客，原文链接：http://www.cnblogs.com/XYQ-208910/p/4875974.html，如需转载请自行联系原作者</span></font>
     <br>
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
