<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ASP.NET(c#)常用类函数 « NotBeCN</title>
  <meta name="description" content="                  常用函数系列: public static string Get_ClientIP() 得到客户端IP public static string Get_CMac(string IP) 得到客户端 CMac 地址 public static string RequestF(st...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/04/30/weixin_33769125_90124275.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">ASP.NET(c#)常用类函数</h1>
    <p class="post-meta">Apr 30, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"> 
    <p style="line-height:1.5;">常用函数系列:<br> public static string Get_ClientIP() 得到客户端IP<br> public static string Get_CMac(string IP) 得到客户端 CMac 地址<br> public static string RequestF(string xPName,string xPType,int xLenDef) 安全接收数据系列<br> public static string Show_Cont(string xStr) 过滤显示字串<br> public static string Show_jsStr(string xStr) 过滤显示js</p> 
    <p style="line-height:1.5;">安全检测函数:<br> public static string CheckUrl(string xDirPage) 上页地址认证<br> public static string Chk_Perm0(string xPerm,string xSys,string xAct) 权限认证系列<br> public static string Chk_Perm1(string xPerm,string xSys,string xAct) 权限认证系列<br> public static string Chk_Perm2(string xPerm,string xSys,string xAct) 权限认证系列</p> 
    <p style="line-height:1.5;">邮件发送函数:<br> public void SendEmail(string xSubj,string xCont,string FmAddr,string ToAddr)&nbsp;<br> public void SendSmtp(string xSubj,string xCont,string xFrom,string xTo)</p> 
    <p style="line-height:1.5;">加密解密函数：<br> public static string Enc_PW(string xID,string xPW,int xLen) 改装sha1+md5加密解密函数加密函数<br> public static string Conv_10toXX(long xNum,int xBase) 10进制 转 XX 进制<br> public static long Conv_XXto10(string xStr,int xBase) xx进制 转 10 进制<br> public static string DESDec(string pToDecrypt, string sKey) DES解密<br> public static string DESEnc(string pToEncrypt, string sKey) DES加密密<br> public static string DESPeace(string xStr, string xType) 改装DES<br> public static string DESSwap(string xStr, int xN) DES 改装算法</p> 
    <p style="line-height:1.5;">文件操作函数：<br> public static string fCreate(string xFile,string xContent) 建立文件<br> public void ImgCode (Page containsPage,string validateNum) 生成图片认证码<br> public static string ImgShow(string xPName,int xImgW,int xImgH,int xMaxW,int xMaxH) 按比例大小显示图片<br> public static DataTable fList(string xPath) 显示文件列表 显示文件夹列表<br> public static string fRead(string xFile) 文件读取函数<br> public static ArrayList fUpload(HttpPostedFile xFile,string xPath,string xOrg,int xSize,string xType) 文件上传认证函数</p> 
    <p style="line-height:1.5;"><br> 时间/随即字串函数：<br> public static string Get_AutoID(int xLen) 自动随机 ID 串<br> public static string Get_HHMMSS()&nbsp; 得到时间HHmmss格式<br> public static string Get_TimeID()&nbsp; 得到年月日时间YYYY-MM-DD HH:mm:ss格式<br> public static string Get_YYYYMMDD() 得到年月日YYYYMMDD格式<br> public static string Get_mSec() 得到毫秒<br> public static string Rnd_ID(string xType,int xLen)&nbsp; 自动随机 ID 串<br> public static int Rnd_NM(int xN,int xM)&nbsp; 自动随机 N ~ M 数字</p> 
    <p style="line-height:1.5;"><br> 数据库操作函数：<br> public static void rs_AddLog(string xconn,string xUSID,string xAct,string xSys,string xNote) 添加 Log<br> public static int rs_Count(string xConn,string xSQL,string xTable) 计算记录条数<br> public static void rs_DoSQL(string xConn,string xSQL) 执行SQL语句<br> public static string rs_Exist(string xConn,string xSQL,string xTable) 检查是否存在<br> public static void rs_List(DropDownList xDDList,string xConn,string xSql,string xDefValue,string xClear) 绑定DropDownList<br> public static string rs_Val(string xConn,string xSQL,string xTable,string xCol) 得到特定 字段值</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <p style="line-height:1.5;">&nbsp;</p> 
    <hr>
    <p style="line-height:1.5;">using System;<br> using System.Collections;<br> using System.ComponentModel;<br> using System.Data;<br> using System.Data.SqlClient;<br> using System.Diagnostics;<br> using System.Drawing;<br> using System.Drawing.Imaging;<br> using System.Drawing.Drawing2D;<br> using System.IO;<br> using System.Web;<br> using System.Web.Mail;<br> using System.Web.UI;<br> using System.Web.UI.WebControls;<br> using System.Web.UI.HtmlControls;<br> using System.Web.Security;<br> using System.Security.Cryptography;<br> using System.Text;<br> using System.Text.RegularExpressions;<br> using PubSet;</p> 
    <p style="line-height:1.5;">namespace Peace<br> {<br> &nbsp;public class WebCS&nbsp;<br> &nbsp;{&nbsp;&nbsp;<br> &nbsp;&nbsp;public static string RequestQ(string xPName,string xPType,int xLenDef)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string PValue = HttpContext.Current.Request.QueryString[xPName];&nbsp;<br> &nbsp;&nbsp;&nbsp;return RequestS(PValue,xPType,xLenDef);&nbsp;<br> &nbsp;&nbsp;}<br> &nbsp;&nbsp;public static string RequestF(string xPName,string xPType,int xLenDef)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string PValue = HttpContext.Current.Request.Form[xPName];&nbsp;<br> &nbsp;&nbsp;&nbsp;return RequestS(PValue,xPType,xLenDef);&nbsp;<br> &nbsp;&nbsp;}<br> &nbsp;&nbsp;public static string RequestA(string xPName,string xPType,int xLenDef)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string PValue = HttpContext.Current.Request[xPName];&nbsp;<br> &nbsp;&nbsp;&nbsp;return RequestS(PValue,xPType,xLenDef);&nbsp;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string RequestS(string xPName,string xPType,int xLenDef)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string PValue = xPName+"";&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;string tmpType = xPType;<br> &nbsp;&nbsp;&nbsp;switch (tmpType)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;case "N": // Number -1,0,1<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;&nbsp;{&nbsp;string tI = (int.Parse(PValue)).ToString();&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch&nbsp;{&nbsp;PValue = xLenDef.ToString();}&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br> &nbsp;&nbsp;&nbsp;&nbsp;case "D": // Date&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;&nbsp;{&nbsp;DateTime tD = DateTime.Parse(PValue);&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;catch&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PValue = xLenDef.ToString();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PValue = PValue.Substring(0,4)+"-"+PValue.Substring(4,2)+"-"+PValue.Substring(6,2);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br> &nbsp;&nbsp;&nbsp;&nbsp;default: // Text xLenDef = 19001231<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(PValue.Length &gt; xLenDef)&nbsp;{&nbsp;PValue = PValue.Substring(0,xLenDef);&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PValue = PValue.Replace("'","''");<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return PValue;<br> &nbsp;&nbsp;}&nbsp;</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Show_Text(string xStr)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string tStr = xStr;<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("&lt;","&amp;lt;");<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("&gt;","&amp;gt;");<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("\r","&lt;br&gt;");<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("&nbsp; ","&amp;nbsp;&amp;nbsp;");<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("\t","&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;");<br> &nbsp;&nbsp;&nbsp;return tStr;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Show_Cont(string xStr)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string tStr = Show_Text(xStr);<br> &nbsp;&nbsp;&nbsp;return tStr;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Show_Form(string xStr)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string tStr = xStr;<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("\'","'");<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("\"",""");<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("&lt;","&amp;lt;");<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("&gt;","&amp;gt;");<br> &nbsp;&nbsp;&nbsp;return tStr;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Show_jsStr(string xStr)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string tStr = xStr;<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("\'","<a>\\\'</a>");<br> &nbsp;&nbsp;&nbsp;tStr = tStr.Replace("\"","<a>\\\</a>"");<br> &nbsp;&nbsp;&nbsp;return tStr;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Get_ClientIP()<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string result = HttpContext.Current.Request.ServerVariables["HTTP_X_FORWARDED_FOR"];<br> &nbsp;&nbsp;&nbsp;if (null == result || result == String.Empty)&nbsp;<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;result = HttpContext.Current.Request.ServerVariables["REMOTE_ADDR"];<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;if (null == result || result == String.Empty)&nbsp;<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;result = HttpContext.Current.Request.UserHostAddress;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return result;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Get_CMac(string IP) //para IP is the&nbsp;<a href="mailto:client@#s" rel="nofollow" style="color:rgb(7,93,179);">client@#s</a>&nbsp;IP&nbsp;<br> &nbsp;&nbsp;{&nbsp;<br> &nbsp;&nbsp;&nbsp;string dirResults=""; //IP = "192.168.37.175";//"211.156.182.34";<br> &nbsp;&nbsp;&nbsp;ProcessStartInfo psi&nbsp; = new ProcessStartInfo();&nbsp;<br> &nbsp;&nbsp;&nbsp;Process proc = new Process();&nbsp;<br> &nbsp;&nbsp;&nbsp;psi.FileName = "nbtstat";&nbsp;<br> &nbsp;&nbsp;&nbsp;psi.RedirectStandardInput = false;&nbsp;<br> &nbsp;&nbsp;&nbsp;psi.RedirectStandardOutput = true;&nbsp;<br> &nbsp;&nbsp;&nbsp;psi.Arguments = "-A " + IP;&nbsp;<br> &nbsp;&nbsp;&nbsp;psi.UseShellExecute = false;&nbsp;<br> &nbsp;&nbsp;&nbsp;proc = Process.Start(psi);&nbsp;<br> &nbsp;&nbsp;&nbsp;dirResults = proc.StandardOutput.ReadToEnd();&nbsp;<br> &nbsp;&nbsp;&nbsp;proc.WaitForExit();&nbsp;<br> &nbsp;&nbsp;&nbsp;dirResults=dirResults.Replace("\r","").Replace("\n","").Replace("\t","");&nbsp;<br> &nbsp;&nbsp;&nbsp;Regex reg=new Regex("Mac[ ]{0,}Address[ ]{0,}=[ ]{0,}(?&lt;key&gt;((.)*?)) __MAC",RegexOptions.IgnoreCase|RegexOptions.Compiled);&nbsp;<br> &nbsp;&nbsp;&nbsp;Match mc=reg.Match(dirResults+"__MAC");&nbsp;<br> &nbsp;&nbsp;&nbsp;if(mc.Success)&nbsp;<br> &nbsp;&nbsp;&nbsp;{&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;return mc.Groups["key"].Value;&nbsp;<br> &nbsp;&nbsp;&nbsp;}&nbsp;<br> &nbsp;&nbsp;&nbsp;else&nbsp;<br> &nbsp;&nbsp;&nbsp;{&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;reg=new Regex("Host not found",RegexOptions.IgnoreCase|RegexOptions.Compiled);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;mc=reg.Match(dirResults);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;if(mc.Success)&nbsp;{ return "Host not found!"; }&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;{ return "N/A"; }&nbsp;<br> &nbsp;&nbsp;&nbsp;}&nbsp;<br> &nbsp;&nbsp;}<br> &nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;public class WebID&nbsp;<br> &nbsp;{&nbsp;<br> &nbsp;&nbsp;public static string Get_TimeID()<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string YMDHMS = System.DateTime.Now.ToString("yyyyMMddHHmmss");<br> &nbsp;&nbsp;&nbsp;string mSec = Get_mSec();<br> &nbsp;&nbsp;&nbsp;return YMDHMS+mSec;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Get_YYYYMMDD()<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;return System.DateTime.Now.ToString("yyyyMMdd");<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Get_HHMMSS()<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;return System.DateTime.Now.ToString("HHmmss");<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Get_mSec()<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string mSec = System.DateTime.Now.Millisecond.ToString();<br> &nbsp;&nbsp;&nbsp;mSec = "00" + mSec;<br> &nbsp;&nbsp;&nbsp;return mSec.Substring(mSec.Length-3,3);<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Get_AutoID(int xLen)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;long tNum = DateTime.Now.Ticks;<br> &nbsp;&nbsp;&nbsp;string tStr = tNum.ToString("X16");<br> &nbsp;&nbsp;&nbsp;if(xLen&lt;tStr.Length)&nbsp;{&nbsp;tStr = tStr.Substring(0,xLen);&nbsp;}<br> &nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;tStr += Rnd_ID("KEY",xLen-tStr.Length);&nbsp;}<br> &nbsp;&nbsp;&nbsp;return tStr;&nbsp;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Rnd_ID(string xType,int xLen)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string rChar;<br> &nbsp;&nbsp;&nbsp;int rMax,i;<br> &nbsp;&nbsp;&nbsp;string orgNum = "0123456789";&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp; 10&nbsp;&nbsp; xType = 0,A,KEY<br> &nbsp;&nbsp;&nbsp;string orgCap = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";&nbsp;//&nbsp; 26&nbsp;&nbsp; .&nbsp; -&nbsp; _&nbsp; $&nbsp; |&nbsp; !&nbsp; #&nbsp; [&nbsp; ]&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;string orgKey = "ABCDEFGHJKLMNPQRSTUVWXY";&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; 23&nbsp;&nbsp; I&nbsp; O&nbsp; Z<br> &nbsp;&nbsp;&nbsp;string oStr = "";<br> &nbsp;&nbsp;&nbsp;string tStr = "";<br> &nbsp;&nbsp;&nbsp;switch (xType)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;case "0":&nbsp;rMax = 10;&nbsp;tStr = orgNum;&nbsp;break;<br> &nbsp;&nbsp;&nbsp;&nbsp;case "A":&nbsp;rMax = 26;&nbsp;tStr = orgCap;&nbsp;break;<br> &nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;rMax = 33;&nbsp;tStr = orgNum + orgKey;&nbsp;break;&nbsp;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;System.Random ran = new Random(System.DateTime.Now.Second + (int)System.DateTime.Now.Ticks);&nbsp;<br> &nbsp;&nbsp;&nbsp;for (i=0;i&lt;Math.Abs(xLen);i++)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;int rin = ran.Next(0,rMax-1);<br> &nbsp;&nbsp;&nbsp;&nbsp;rChar = tStr.Substring(rin,1);<br> &nbsp;&nbsp;&nbsp;&nbsp;oStr += rChar;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return oStr;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static int Rnd_NM(int xN,int xM)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;System.Random ran = new Random(System.DateTime.Now.Second + (int)System.DateTime.Now.Ticks);&nbsp;<br> &nbsp;&nbsp;&nbsp;return ran.Next(xN,xM);<br> &nbsp;&nbsp;}<br> &nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;public class WebRS&nbsp;<br> &nbsp;{<br> &nbsp;&nbsp;public static void rs_AddLog(string xconn,string xUSID,string xAct,string xSys,string xNote)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string Tim,IP,PNow,PRef,sql;<br> &nbsp;&nbsp;&nbsp;Tim = System.DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")+Peace.WebID.Rnd_ID("KEY",5);&nbsp;<br> &nbsp;&nbsp;&nbsp;IP = Peace.WebCS.Get_ClientIP() ;<br> &nbsp;&nbsp;&nbsp;PNow = HttpContext.Current.Request.Url.ToString(); ;<br> &nbsp;&nbsp;&nbsp;PRef = HttpContext.Current.Request.ServerVariables["http_referer"]+"";<br> &nbsp;&nbsp;&nbsp;PNow = Peace.WebCS.RequestS(PNow,"",96);<br> &nbsp;&nbsp;&nbsp;PRef = Peace.WebCS.RequestS(PRef,"",96);<br> &nbsp;&nbsp;&nbsp;xAct = xAct.Replace("'","");&nbsp;<br> &nbsp;&nbsp;&nbsp;xNote = Peace.WebCS.RequestS(xNote,"",255);&nbsp;<br> &nbsp;&nbsp;&nbsp;if (PRef.IndexOf("?")&gt;0)&nbsp;{&nbsp;PRef = PRef.Substring(0,PRef.IndexOf("?"));&nbsp;}<br> &nbsp;&nbsp;&nbsp;if (PNow.IndexOf("?")&gt;0)&nbsp;{&nbsp;PNow = PNow.Substring(0,PNow.IndexOf("?"));&nbsp;}<br> &nbsp;&nbsp;&nbsp;sql&nbsp; = " INSERT INTO AdmLogs (LGTime,USID,LGAct,LGPag1,LGPag2,LGSyst,LGNote,LGIP) VALUES ";<br> &nbsp;&nbsp;&nbsp;sql += " ('"+Tim+"','"+xUSID+"','"+xAct+"','"+PNow+"','"+PRef+"','"+xSys+"','"+xNote+"','"+IP+"')";<br> &nbsp;&nbsp;&nbsp;Peace.WebRS.rs_DoSQL(xconn,sql);<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string rs_Val(string xConn,string xSQL,string xTable,string xCol)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string rObj;<br> &nbsp;&nbsp;&nbsp;SqlConnection cnRec = new SqlConnection(xConn);<br> &nbsp;&nbsp;&nbsp;SqlDataAdapter cmRec = new SqlDataAdapter(xSQL, cnRec);<br> &nbsp;&nbsp;&nbsp;DataSet dsRec = new DataSet();<br> &nbsp;&nbsp;&nbsp;cmRec.Fill(dsRec, xTable);<br> &nbsp;&nbsp;&nbsp;if(dsRec.Tables[0].Rows.Count&gt;0)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;DataRow curDR;<br> &nbsp;&nbsp;&nbsp;&nbsp;curDR = dsRec.Tables[0].Rows[0];<br> &nbsp;&nbsp;&nbsp;&nbsp;rObj&nbsp; = curDR[xCol].ToString();&nbsp;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;rObj = "";&nbsp;}<br> &nbsp;&nbsp;&nbsp;return rObj;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string rs_Exist(string xConn,string xSQL,string xTable)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string rObj;<br> &nbsp;&nbsp;&nbsp;SqlConnection cnRec = new SqlConnection(xConn);<br> &nbsp;&nbsp;&nbsp;SqlDataAdapter cmRec = new SqlDataAdapter(xSQL, cnRec);<br> &nbsp;&nbsp;&nbsp;DataSet dsRec = new DataSet();<br> &nbsp;&nbsp;&nbsp;cmRec.Fill(dsRec, xTable);<br> &nbsp;&nbsp;&nbsp;if(dsRec.Tables[0].Rows.Count&gt;0)&nbsp;{&nbsp;rObj = "YES";&nbsp;}<br> &nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;rObj = "EOF";&nbsp;}<br> &nbsp;&nbsp;&nbsp;return rObj;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static int rs_Count(string xConn,string xSQL,string xTable)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;SqlConnection cnRec = new SqlConnection(xConn);<br> &nbsp;&nbsp;&nbsp;SqlDataAdapter cmRec = new SqlDataAdapter(xSQL, cnRec);<br> &nbsp;&nbsp;&nbsp;DataSet dsRec = new DataSet();<br> &nbsp;&nbsp;&nbsp;cmRec.Fill(dsRec, xTable);<br> &nbsp;&nbsp;&nbsp;return dsRec.Tables[0].Rows.Count;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static void rs_DoSQL(string xConn,string xSQL)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;SqlConnection conn = new SqlConnection(xConn);<br> &nbsp;&nbsp;&nbsp;conn.Open();<br> &nbsp;&nbsp;&nbsp;SqlCommand insCMD = new SqlCommand(xSQL,conn);<br> &nbsp;&nbsp;&nbsp;Int32 recordsAffected = insCMD.ExecuteNonQuery();<br> &nbsp;&nbsp;&nbsp;conn.Close();<br> &nbsp;&nbsp;}&nbsp;</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static void rs_List(DropDownList xDDList,string xConn,string xSql,string xDefValue,string xClear)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string conn=PubSet.Config.cnStr; //HttpContext.Current<br> &nbsp;&nbsp;&nbsp;SqlConnection cn = new SqlConnection( conn );<br> &nbsp;&nbsp;&nbsp;SqlCommand cm = new SqlCommand( xSql, cn );&nbsp;<br> &nbsp;&nbsp;&nbsp;cm.Connection.Open();&nbsp;<br> &nbsp;&nbsp;&nbsp;SqlDataReader iReader = cm.ExecuteReader();&nbsp;<br> &nbsp;&nbsp;&nbsp;if (xClear.Length&gt;0)&nbsp;&nbsp;&nbsp;// Clear Old Records;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;xDDList.Items.Clear();&nbsp;}<br> &nbsp;&nbsp;&nbsp;while ( iReader.Read() )&nbsp;<br> &nbsp;&nbsp;&nbsp;{&nbsp;xDDList.Items.Add( new ListItem( iReader[1].ToString(),iReader[0].ToString() ) );&nbsp;}&nbsp;<br> &nbsp;&nbsp;&nbsp;if(xDDList.Items.Count==0)&nbsp;&nbsp;// If NOT found record,Add blank value,but NOT [Null]<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;xDDList.Items.Add( new ListItem( "", "" ) );&nbsp;}&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;cm.Connection.Close();&nbsp;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;public class WebCheck&nbsp;<br> &nbsp;{<br> &nbsp;&nbsp;public static string CheckUrl(string xDirPage)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string sPrev = HttpContext.Current.Request.ServerVariables["http_referer"]+"";<br> &nbsp;&nbsp;&nbsp;string sNow&nbsp; = HttpContext.Current.Request.Url.ToString();<br> &nbsp;&nbsp;&nbsp;sPrev = sPrev.ToLower();<br> &nbsp;&nbsp;&nbsp;sPrev = sPrev.Replace("http://","");<br> &nbsp;&nbsp;&nbsp;sPrev = sPrev.Replace("www.","");<br> &nbsp;&nbsp;&nbsp;if(sPrev.IndexOf("/",0)&gt;0)<br> &nbsp;&nbsp;&nbsp;{&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;sPrev = sPrev.Substring(0,sPrev.IndexOf("/",0));<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;sNow&nbsp; = sNow.ToLower();<br> &nbsp;&nbsp;&nbsp;if( (sPrev.Length==0) || (sNow.IndexOf(sPrev,0)&lt;0) )<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;if(xDirPage=="")&nbsp;{ /*xObj.Response.Redirect(Config.WHome);*/&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;HttpContext.Current.Response.Redirect(xDirPage);&nbsp;}&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return sPrev ;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Chk_Perm1(string xSys,string xAct,string xPath)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string AdmPerm = (string)HttpContext.Current.Session["AdmPerm"]+"";<br> &nbsp;&nbsp;&nbsp;string flgPerm = "Error";<br> &nbsp;&nbsp;&nbsp;if(AdmPerm.Length&lt;3)&nbsp;&nbsp;{&nbsp;flgPerm = "Error";&nbsp;}<br> &nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;flgPerm = Chk_Perm0(AdmPerm,xSys,xAct);&nbsp;}<br> &nbsp;&nbsp;&nbsp;if( flgPerm=="Error" )<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;if(xPath=="")&nbsp;&nbsp;&nbsp;{&nbsp;/*xObj.Response.Redirect(Config.WHome);*/&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;HttpContext.Current.Response.Redirect(xPath);&nbsp;}&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return flgPerm ;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Chk_Perm2(string xSys,string xAct,string xPath)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string AdmPerm = (string)HttpContext.Current.Session["AdmPerm"]+"";<br> &nbsp;&nbsp;&nbsp;string MemPerm = (string)HttpContext.Current.Session["MemPerm"]+"";<br> &nbsp;&nbsp;&nbsp;string flgPerm = "Error";<br> &nbsp;&nbsp;&nbsp;if(MemPerm.Length&lt;3)&nbsp;&nbsp;{&nbsp;flgPerm = "Error";&nbsp;}<br> &nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;flgPerm = Chk_Perm0(MemPerm,xSys,xAct);&nbsp;}<br> &nbsp;&nbsp;&nbsp;if(AdmPerm.Length&gt;3)&nbsp;&nbsp;{&nbsp;flgPerm = "Pass";&nbsp;}<br> &nbsp;&nbsp;&nbsp;if( flgPerm=="Error" )<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;if(xPath=="")&nbsp;&nbsp;&nbsp;{&nbsp;HttpContext.Current.Response.Redirect("/");&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;HttpContext.Current.Response.Redirect(xPath);&nbsp;}&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return flgPerm ;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Chk_Perm0(string xPerm,string xSys,string xAct)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string flgPerm = "(N/A)";<br> &nbsp;&nbsp;&nbsp;if(xSys=="")&nbsp;&nbsp;&nbsp;{&nbsp;flgPerm = "Pass";&nbsp;}<br> &nbsp;&nbsp;&nbsp;else&nbsp;<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;if(xPerm.IndexOf("("+xSys+")")&gt;=0)<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(xAct=="")&nbsp;{&nbsp;flgPerm = "Pass";&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int p1 = xPerm.IndexOf("("+xSys+")");<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int p2 = xPerm.IndexOf("(/"+xSys+")");<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( (p1&gt;=0) &amp;&amp; (p2&gt;p1) )<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xPerm = xPerm.Substring(p1,p2-p1);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xAct = xAct.ToUpper();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(xPerm.IndexOf(""+xAct+"")&gt;=0)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;flgPerm = "Pass";&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;{&nbsp;flgPerm = "Error";&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;{&nbsp;flgPerm = "Error";&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;flgPerm = "Error";&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return flgPerm ;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;public class WebEnc&nbsp;<br> &nbsp;{<br> &nbsp;&nbsp;public static string Enc_PW(string xID,string xPW,int xLen)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string eStr1 = FormsAuthentication.HashPasswordForStoringInConfigFile(xID,"sha1"); // 40<br> &nbsp;&nbsp;&nbsp;string eStr2 = "";<br> &nbsp;&nbsp;&nbsp;string tStr;<br> &nbsp;&nbsp;&nbsp;for(int i=0; i&lt;4; i++)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;tStr = eStr1.Substring(10*i,10);<br> &nbsp;&nbsp;&nbsp;&nbsp;eStr2 += FormsAuthentication.HashPasswordForStoringInConfigFile(xPW+tStr,"md5"); // 32<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;int ne1 = (128 - xLen)/2;&nbsp;<br> &nbsp;&nbsp;&nbsp;return eStr2.Substring(ne1,xLen);<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string DESPeace(string xStr, string xType)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string oStr,sKey=PubSet.Config.DESOffset;<br> &nbsp;&nbsp;&nbsp;if (xType=="Enc")&nbsp;<br> &nbsp;&nbsp;&nbsp;{&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;oStr = DESEnc(xStr,sKey);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;oStr = Peace.WebEnc.DESSwap(oStr,4);<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;{&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;xStr = Peace.WebEnc.DESSwap(xStr,4);<br> &nbsp;&nbsp;&nbsp;&nbsp;oStr = DESDec(xStr,sKey);<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return oStr;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string DESSwap(string xStr, int xN)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;int sLen;&nbsp;<br> &nbsp;&nbsp;&nbsp;string s1="",s2="",s3="";<br> &nbsp;&nbsp;&nbsp;sLen = xStr.Length;<br> &nbsp;&nbsp;&nbsp;if ( (xN&gt;1) &amp;&amp; (xN&lt;sLen) )<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;s1 = xStr.Substring(0,xN);<br> &nbsp;&nbsp;&nbsp;&nbsp;s2 = xStr.Substring(sLen-xN,xN);<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;for(int i=(sLen-xN-1);i&gt;=xN;i--)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;s3 += xStr.Substring(i,1);<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return s1 + s3 + s2; // xStr.Substring(xN,sLen-(2*xN))<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string DESEnc(string pToEncrypt, string sKey)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;DESCryptoServiceProvider des = new DESCryptoServiceProvider();<br> &nbsp;&nbsp;&nbsp;byte[] inputByteArray = Encoding.Default.GetBytes(pToEncrypt);<br> &nbsp;&nbsp;&nbsp;des.Key = ASCIIEncoding.ASCII.GetBytes(sKey);<br> &nbsp;&nbsp;&nbsp;des.IV = ASCIIEncoding.ASCII.GetBytes(sKey);<br> &nbsp;&nbsp;&nbsp;MemoryStream ms = new MemoryStream();<br> &nbsp;&nbsp;&nbsp;CryptoStream cs = new CryptoStream(ms, des.CreateEncryptor(),CryptoStreamMode.Write);<br> &nbsp;&nbsp;&nbsp;cs.Write(inputByteArray, 0, inputByteArray.Length);<br> &nbsp;&nbsp;&nbsp;cs.FlushFinalBlock();<br> &nbsp;&nbsp;&nbsp;StringBuilder ret = new StringBuilder();<br> &nbsp;&nbsp;&nbsp;foreach(byte b in ms.ToArray())<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;ret.AppendFormat("{0:X2}", b);<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;ret.ToString();<br> &nbsp;&nbsp;&nbsp;return ret.ToString();<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string DESDec(string pToDecrypt, string sKey)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;DESCryptoServiceProvider des = new DESCryptoServiceProvider();<br> &nbsp;&nbsp;&nbsp;byte[] inputByteArray = new byte[pToDecrypt.Length / 2];<br> &nbsp;&nbsp;&nbsp;for(int x = 0; x &lt; pToDecrypt.Length / 2; x++)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;int i = (Convert.ToInt32(pToDecrypt.Substring(x * 2, 2), 16));<br> &nbsp;&nbsp;&nbsp;&nbsp;inputByteArray[x] = (byte)i;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;des.Key = ASCIIEncoding.ASCII.GetBytes(sKey);<br> &nbsp;&nbsp;&nbsp;des.IV = ASCIIEncoding.ASCII.GetBytes(sKey);<br> &nbsp;&nbsp;&nbsp;MemoryStream ms = new MemoryStream();<br> &nbsp;&nbsp;&nbsp;CryptoStream cs = new CryptoStream(ms, des.CreateDecryptor(),CryptoStreamMode.Write);<br> &nbsp;&nbsp;&nbsp;cs.Write(inputByteArray, 0, inputByteArray.Length);<br> &nbsp;&nbsp;&nbsp;cs.FlushFinalBlock();<br> &nbsp;&nbsp;&nbsp;StringBuilder ret = new StringBuilder(); // 把解密后的文本变成流对象<br> &nbsp;&nbsp;&nbsp;return System.Text.Encoding.Default.GetString(ms.ToArray());<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string Conv_10toXX(long xNum,int xBase)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string oStr = "0123456789ABCDEFGHJKLMNPQRSTUVWXY";<br> &nbsp;&nbsp;&nbsp;long nm = xNum;&nbsp;<br> &nbsp;&nbsp;&nbsp;long ni = nm / xBase;<br> &nbsp;&nbsp;&nbsp;long nr = nm % xBase;<br> &nbsp;&nbsp;&nbsp;int&nbsp; nk = (int)nr;<br> &nbsp;&nbsp;&nbsp;string ch = "";<br> &nbsp;&nbsp;&nbsp;string ns = "";<br> &nbsp;&nbsp;&nbsp;while (nm &gt;= xBase)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;ni = nm / xBase;<br> &nbsp;&nbsp;&nbsp;&nbsp;nr = nm % xBase;<br> &nbsp;&nbsp;&nbsp;&nbsp;nk = (int)nr;<br> &nbsp;&nbsp;&nbsp;&nbsp;ch = oStr.Substring(nk,1);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;ns += ch;<br> &nbsp;&nbsp;&nbsp;&nbsp;nm = ni;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;if(nm!=0)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;nk = (int)nm;<br> &nbsp;&nbsp;&nbsp;&nbsp;ch = oStr.Substring(nk,1);&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;ns += ch;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;string rs = "";<br> &nbsp;&nbsp;&nbsp;for(int i=ns.Length; i&gt;0; i--)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;rs += ns.Substring(i-1,1);<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return rs;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static long Conv_XXto10(string xStr,int xBase)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string oStr = "0123456789ABCDEFGHJKLMNPQRSTUVWXY";<br> &nbsp;&nbsp;&nbsp;int i,p;<br> &nbsp;&nbsp;&nbsp;double rn = 0;<br> &nbsp;&nbsp;&nbsp;string ch = "" ;<br> &nbsp;&nbsp;&nbsp;for(i=xStr.Length; i&gt;0; i--)<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;ch = xStr.Substring(i-1,1);<br> &nbsp;&nbsp;&nbsp;&nbsp;p = oStr.IndexOf(ch);<br> &nbsp;&nbsp;&nbsp;&nbsp;rn += p * Math.Pow(xBase,(xStr.Length-i));<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return (long)rn;<br> &nbsp;&nbsp;}<br> &nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;public class WebEmail&nbsp;<br> &nbsp;{<br> &nbsp;&nbsp;public void SendEmail(string xSubj,string xCont,string FmAddr,string ToAddr)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;//<br> &nbsp;&nbsp;&nbsp;////string MsgSubj;<br> &nbsp;&nbsp;&nbsp;//<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public void SendSmtp(string xSubj,string xCont,string xFrom,string xTo)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;MailMessage mObj = new MailMessage();<br> &nbsp;&nbsp;&nbsp;mObj.From&nbsp;&nbsp;&nbsp; = xFrom;<br> &nbsp;&nbsp;&nbsp;mObj.To&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = xTo;<br> &nbsp;&nbsp;&nbsp;mObj.Subject = xSubj;<br> &nbsp;&nbsp;&nbsp;mObj.Body&nbsp;&nbsp;&nbsp; = xCont;<br> &nbsp;&nbsp;&nbsp;mObj.BodyFormat&nbsp;&nbsp; = MailFormat.Html;<br> &nbsp;&nbsp;&nbsp;//mObj.BodyEncoding = "gb2312";<br> &nbsp;&nbsp;&nbsp;//mObj.Priority = MailPriority.Normal/Low/High;<br> &nbsp;&nbsp;&nbsp;//mObj.Attachments.Add(new MailAttachment("c:\\test.txt"));<br> &nbsp;&nbsp;&nbsp;SmtpMail.Send(mObj);<br> &nbsp;&nbsp;}<br> &nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;public class WebFile<br> &nbsp;{<br> &nbsp;&nbsp;// File.Delete("F:\\net\\241.net\\t2\\t2\\t2\txt");<br> &nbsp;&nbsp;// Directory.CreateDirectory("F:\\net\\241.net\\t2\\t2\\t2");&nbsp;&nbsp;<br> &nbsp;&nbsp;// Directory.Delete();<br> &nbsp;&nbsp;public static string fCreate(string xFile,string xContent)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string fRes;<br> &nbsp;&nbsp;&nbsp;FileStream fs;<br> &nbsp;&nbsp;&nbsp;if ( !File.Exists(xFile) )&nbsp;<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;fs = new FileStream(xFile, FileMode.OpenOrCreate, FileAccess.Write);<br> &nbsp;&nbsp;&nbsp;&nbsp;fRes = "Create";&nbsp;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;else&nbsp;<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;fs = new FileStream(xFile, FileMode.Truncate, FileAccess.Write);<br> &nbsp;&nbsp;&nbsp;&nbsp;fRes = "Edit";<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;StreamWriter w = new StreamWriter(fs);<br> &nbsp;&nbsp;&nbsp;w.Write (xContent);<br> &nbsp;&nbsp;&nbsp;w.Flush();&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;fs.Close();<br> &nbsp;&nbsp;&nbsp;return fRes;<br> &nbsp;&nbsp;}<br> &nbsp;&nbsp;public static string fRead(string xFile)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string fRes;<br> &nbsp;&nbsp;&nbsp;if ( !File.Exists(xFile) )&nbsp;{&nbsp;fRes = "\0";&nbsp;}<br> &nbsp;&nbsp;&nbsp;else&nbsp;<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;FileStream fs = new FileStream(xFile, FileMode.Open, FileAccess.Read);<br> &nbsp;&nbsp;&nbsp;&nbsp;StreamReader sr = new StreamReader(fs); // ,Encoding.GetEncoding(950),true<br> &nbsp;&nbsp;&nbsp;&nbsp;fRes = sr.ReadToEnd();&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;fs.Close();<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;return fRes;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static DataTable fList(string xPath)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;Directory.CreateDirectory(xPath);<br> &nbsp;&nbsp;&nbsp;DataTable dt = new DataTable();<br> &nbsp;&nbsp;&nbsp;DataRow dr;<br> &nbsp;&nbsp;&nbsp;dt.Columns.Add(new DataColumn("Object Name", typeof(string)));<br> &nbsp;&nbsp;&nbsp;dt.Columns.Add(new DataColumn("Type", typeof(string)));<br> &nbsp;&nbsp;&nbsp;dt.Columns.Add(new DataColumn("Size", typeof(string)));<br> &nbsp;&nbsp;&nbsp;dt.Columns.Add(new DataColumn("Date Created", typeof(string)));<br> &nbsp;&nbsp;&nbsp;dt.Columns.Add(new DataColumn("Date Modified", typeof(string)));</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;DirectoryInfo cd = new DirectoryInfo(xPath+&nbsp; "\\");&nbsp;<br> &nbsp;&nbsp;&nbsp;foreach (DirectoryInfo Dir in cd.GetDirectories())&nbsp;<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;dr = dt.NewRow();&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;dr[0] = Dir.Name;<br> &nbsp;&nbsp;&nbsp;&nbsp;dr[1] = "Dir.";<br> &nbsp;&nbsp;&nbsp;&nbsp;dr[2] = "";&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;dr[3] = Dir.CreationTime.ToString("yy-MM-dd HH:mm");<br> &nbsp;&nbsp;&nbsp;&nbsp;dr[4] = Dir.LastWriteTime.ToString("yy-MM-dd HH:mm");<br> &nbsp;&nbsp;&nbsp;&nbsp;dt.Rows.Add(dr);&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;foreach (FileInfo Fil in cd.GetFiles())&nbsp;<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;dr = dt.NewRow();<br> &nbsp;&nbsp;&nbsp;&nbsp;dr[0] = Fil.Name;<br> &nbsp;&nbsp;&nbsp;&nbsp;dr[1] = "File";<br> &nbsp;&nbsp;&nbsp;&nbsp;dr[2] = Fil.Length; // "999,999,999,999"<br> &nbsp;&nbsp;&nbsp;&nbsp;dr[3] = Fil.CreationTime.ToString("yy-MM-dd HH:mm");<br> &nbsp;&nbsp;&nbsp;&nbsp;dr[4] = Fil.LastWriteTime.ToString("yy-MM-dd HH:mm");<br> &nbsp;&nbsp;&nbsp;&nbsp;dt.Rows.Add(dr);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;return dt;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static ArrayList fUpload(HttpPostedFile xFile,string xPath,string xOrg,int xSize,string xType)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;ArrayList OutArr = new ArrayList();<br> &nbsp;&nbsp;&nbsp;OutArr.Add(""); //Rerurn Result&nbsp;<br> &nbsp;&nbsp;&nbsp;OutArr.Add(""); //Extend File Name<br> &nbsp;&nbsp;&nbsp;OutArr.Add(""); //Org File Name<br> &nbsp;&nbsp;&nbsp;OutArr.Add("0"); //Size<br> &nbsp;&nbsp;&nbsp;OutArr.Add("0"); //Width<br> &nbsp;&nbsp;&nbsp;OutArr.Add("0"); //Height<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;HttpPostedFile pFile = xFile;&nbsp;// Get Files Info<br> &nbsp;&nbsp;&nbsp;int fSize = pFile.ContentLength;&nbsp;<br> &nbsp;&nbsp;&nbsp;byte[] fData = new byte[fSize];<br> &nbsp;&nbsp;&nbsp;string upFlag = "(OK)";<br> &nbsp;&nbsp;&nbsp;string fType = "",fName="";</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;xSize *= 1024;&nbsp;&nbsp;&nbsp;&nbsp;// Check Files Size<br> &nbsp;&nbsp;&nbsp;if( (xSize&lt;5120)||(xSize&gt;204800) )&nbsp;{ xSize = 198*1024; }<br> &nbsp;&nbsp;&nbsp;if(fSize==0)&nbsp;&nbsp;&nbsp; { upFlag = "Siz0"; }<br> &nbsp;&nbsp;&nbsp;if(fSize&gt;xSize) { upFlag = "Size"; }<br> &nbsp;&nbsp;&nbsp;OutArr[3] = fSize.ToString(); //OutFileSize = fSize;&nbsp;// *****</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;if(upFlag=="(OK)")&nbsp;&nbsp; // Check Files Type<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;int cPos = xOrg.LastIndexOf("\\") + 1;<br> &nbsp;&nbsp;&nbsp;&nbsp;fName = xOrg.Substring(cPos,(xOrg.Length-cPos));<br> &nbsp;&nbsp;&nbsp;&nbsp;fType = fName;<br> &nbsp;&nbsp;&nbsp;&nbsp;cPos = fType.LastIndexOf(".");<br> &nbsp;&nbsp;&nbsp;&nbsp;if(cPos&gt;0)&nbsp;{&nbsp;fType = fName.Substring(cPos,(fName.Length-cPos)).ToUpper(); }<br> &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;{&nbsp;fType = "(ER)";&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;OutArr[1] = fType; //OutFileExt = fType;&nbsp;&nbsp;// *****<br> &nbsp;&nbsp;&nbsp;&nbsp;OutArr[2] = fName; //OutFileName = fName;&nbsp;// *****<br> &nbsp;&nbsp;&nbsp;&nbsp;xType = xType.ToUpper();<br> &nbsp;&nbsp;&nbsp;&nbsp;if(xType.IndexOf(fType)&lt;0)&nbsp;{&nbsp;upFlag = "Type"; }<br> &nbsp;&nbsp;&nbsp;&nbsp;string yType = "/.ASP/.ASPX/.EXE/.ASAX/.ASA/";<br> &nbsp;&nbsp;&nbsp;&nbsp;if(yType.IndexOf(fType)&gt;=0)&nbsp;{&nbsp;upFlag = "yTyp"; }<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;if(upFlag=="(OK)")&nbsp; // Save Files<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;pFile.InputStream.Read(fData,0,fSize);<br> &nbsp;&nbsp;&nbsp;&nbsp;xPath += fType;<br> &nbsp;&nbsp;&nbsp;&nbsp;FileStream tFile = new FileStream(xPath,FileMode.Create);<br> &nbsp;&nbsp;&nbsp;&nbsp;tFile.Write(fData,0,fData.Length);<br> &nbsp;&nbsp;&nbsp;&nbsp;tFile.Close();&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;if ( (fType==".GIF")||(fType==".JPG")||(fType==".JPEG") )&nbsp;// Get Size<br> &nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileStream fs = File.Open(xPath,FileMode.Open,FileAccess.Read,FileShare.Read);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bitmap tImg = new Bitmap(fs);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OutArr[4] = tImg.Width.ToString(); //OutFileWidth = tImg.Width;&nbsp;&nbsp;// *****<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OutArr[5] = tImg.Height.ToString(); //OutFileHeight = tImg.Height;&nbsp;// *****<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fs.Close();<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;OutArr[0] = upFlag; //OutFileRes = upFlag;<br> &nbsp;&nbsp;&nbsp;return OutArr;</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;public static string ImgShow(string xPName,int xImgW,int xImgH,int xMaxW,int xMaxH)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;string fRes="";<br> &nbsp;&nbsp;&nbsp;float oW=xMaxW, oH=xMaxH;<br> &nbsp;&nbsp;&nbsp;float oScale=xMaxW/xMaxH;<br> &nbsp;&nbsp;&nbsp;float iScale=xImgW/xImgW;<br> &nbsp;&nbsp;&nbsp;if(( xImgW&gt;xMaxW) &amp;&amp; (xImgH&gt;xMaxH) )&nbsp;{ // &gt;&gt;<br> &nbsp;&nbsp;&nbsp;&nbsp;if(iScale&gt;oScale)&nbsp;{&nbsp;oW = xMaxW;&nbsp;oH = xImgH/iScale;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;if(iScale&lt;oScale)&nbsp;{&nbsp;oH = xMaxH;&nbsp;oW = xMaxW*iScale;&nbsp;}<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;if(( xImgW&gt;xMaxW) &amp;&amp; (xImgH&lt;xMaxH) )&nbsp;{ // &gt;&lt;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oW = xMaxW;&nbsp;oH = xImgH/iScale;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;if(( xImgW&lt;xMaxW) &amp;&amp; (xImgH&gt;xMaxH) )&nbsp;{ // &lt;&gt;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oH = xMaxH;&nbsp;oW = xMaxW*iScale;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;if(( xImgW&lt;xMaxW) &amp;&amp; (xImgH&lt;xMaxH) )&nbsp;{ // &lt;&lt;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oW = xImgW;&nbsp;oH = xImgH;&nbsp;<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;fRes = "&lt;img border='0' src='" +xPName+ "' width=" +oW+ " height=" +oH+ "&gt;";<br> &nbsp;&nbsp;&nbsp;return fRes;<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;&nbsp;/**********************Created by Chen**************************&nbsp;<br> &nbsp;&nbsp;*如果你觉得本人的文章好,要引用请尊重著作人的劳动果实,说明&nbsp;<br> &nbsp;&nbsp;<a href="http://edu.pingjiang.com/net/02/45843.htm" rel="nofollow" style="color:rgb(7,93,179);">http://edu.pingjiang.com/net/02/45843.htm</a><br> &nbsp;&nbsp;*出处以及原创作者,Thank you!!!&nbsp;&nbsp; email:aishen944-sohu.com<br> &nbsp;&nbsp;<a href="http://www.dg.gd.cn/" rel="nofollow" style="color:rgb(7,93,179);">http://www.dg.gd.cn</a>&nbsp;东莞网络 谢永顺[Peace] 整理修改 (<a href="mailto:xpigeon@163.com;QQ:80893510" rel="nofollow" style="color:rgb(7,93,179);">xpigeon@163.com;QQ:80893510</a>)<br> &nbsp;&nbsp;*******************************************************************/<br> &nbsp;&nbsp;/// &lt;summary&gt;<br> &nbsp;&nbsp;/// 创建验证码的图片 CreateValidateGraphic<br> &nbsp;&nbsp;/// &lt;/summary&gt;<br> &nbsp;&nbsp;/// &lt;param name="containsPage"&gt;要输出到的page对象&lt;/param&gt;<br> &nbsp;&nbsp;/// &lt;param name="validateNum"&gt;验证码&lt;/param&gt;<br> &nbsp;&nbsp;public void ImgCode (Page containsPage,string validateNum)<br> &nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;Bitmap image=new Bitmap((int)Math.Ceiling(validateNum.Length*12.5),22);<br> &nbsp;&nbsp;&nbsp;Graphics g=Graphics.FromImage(image);<br> &nbsp;&nbsp;&nbsp;try<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;//生成随机生成器<br> &nbsp;&nbsp;&nbsp;&nbsp;Random random=new Random();<br> &nbsp;&nbsp;&nbsp;&nbsp;//清空图片背景色<br> &nbsp;&nbsp;&nbsp;&nbsp;g.Clear(Color.White);<br> &nbsp;&nbsp;&nbsp;&nbsp;//画图片的干扰线<br> &nbsp;&nbsp;&nbsp;&nbsp;for(int i=0;i&lt;5;i++)<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int x1=random.Next(image.Width);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int x2=random.Next(image.Width);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int y1=random.Next(image.Height);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int y2=random.Next(image.Height);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g.DrawLine(new Pen(Color.Silver),x1,y1,x2,y2);<br> &nbsp;&nbsp;&nbsp;&nbsp;}//<br> &nbsp;&nbsp;&nbsp;&nbsp;Font font=new Font("Courier",12,(FontStyle.Bold)); //Arial |FontStyle.Italic<br> &nbsp;&nbsp;&nbsp;&nbsp;LinearGradientBrush brush=new LinearGradientBrush(new Rectangle(0,0,image.Width,image.Height),<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Color.Blue,Color.DarkRed,1.2f,true);<br> &nbsp;&nbsp;&nbsp;&nbsp;g.DrawString(validateNum,font,brush,3,2);<br> &nbsp;&nbsp;&nbsp;&nbsp;//画图片的前景干扰点<br> &nbsp;&nbsp;&nbsp;&nbsp;for(int i=0;i&lt;10;i++)<br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int x=random.Next(image.Width);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int y=random.Next(image.Height);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image.SetPixel(x,y,Color.FromArgb(random.Next()));<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;//画图片的边框线<br> &nbsp;&nbsp;&nbsp;&nbsp;g.DrawRectangle(new Pen(Color.Silver),0,0,image.Width-1,image.Height-1);<br> &nbsp;&nbsp;&nbsp;&nbsp;//保存图片数据<br> &nbsp;&nbsp;&nbsp;&nbsp;MemoryStream stream=new MemoryStream();<br> &nbsp;&nbsp;&nbsp;&nbsp;image.Save(stream,ImageFormat.Jpeg);<br> &nbsp;&nbsp;&nbsp;&nbsp;//输出图片<br> &nbsp;&nbsp;&nbsp;&nbsp;containsPage.Response.Clear();<br> &nbsp;&nbsp;&nbsp;&nbsp;containsPage.Response.ContentType="image/jpeg";<br> &nbsp;&nbsp;&nbsp;&nbsp;containsPage.Response.BinaryWrite(stream.ToArray());<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;finally<br> &nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;g.Dispose();<br> &nbsp;&nbsp;&nbsp;&nbsp;image.Dispose();<br> &nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;}</p> 
    <p style="line-height:1.5;">&nbsp;}<br> &nbsp;// Get_rsOpt(xconn,xTab,xID,xName,xType,xWhere,xDef)&nbsp;&nbsp;<br> &nbsp;// Get_Option(xmid,xfirst,xend,xstep) ;&nbsp;<br> &nbsp;// Get_vPath(xLen) Get_fName()<br> }</p> 
   </div> 
   <div class="clear" style="clear:both;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;"></div> 
   <div> 
    <div style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">
     分类:&nbsp;
     <a href="http://www.cnblogs.com/happyday56/category/93641.html" rel="nofollow" style="color:rgb(7,93,179);">C# Asp.net</a> 
    </div> 
    <div style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13px;">
     <br>
    </div> 
    <div> 
     <font><span style="font-size:13px;">本文转自快乐就好博客园博客，原文链接：http://www.cnblogs.com/happyday56/archive/2007/11/01/946130.html，如需转载请自行联系原作者</span></font>
     <br>
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
