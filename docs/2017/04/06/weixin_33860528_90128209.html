<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>利用 JAVA 操作 EXCEL 文件 « NotBeCN</title>
  <meta name="description" content="                               简介：&nbsp;使用 Windows 操作系统的朋友对 Excel（电子表格）一定不会陌生，但是要使用 Java 语言来操纵 Excel 文件并不是一件容易的事。在 Web 应用日益盛行的今天，通过 Web 来操作 Excel 文件的需求越来越强烈，...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/04/06/weixin_33860528_90128209.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">利用 JAVA 操作 EXCEL 文件</h1>
    <p class="post-meta">Apr 6, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border-bottom:1px solid rgb(204,204,204);"> 
    <div class="ibm-container-body ibm-two-column"> 
     <div class="ibm-column ibm-first" style="width:500px;"> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><strong>简介：</strong>&nbsp;使用 Windows 操作系统的朋友对 Excel（电子表格）一定不会陌生，但是要使用 Java 语言来操纵 Excel 文件并不是一件容易的事。在 Web 应用日益盛行的今天，通过 Web 来操作 Excel 文件的需求越来越强烈，目前较为流行的操作是在 JSP 或 Servlet 中创建一个 CSV （comma separated values）文件，并将这个文件以 MIME，text/csv 类型返回给浏览器，接着浏览器调用 Excel 并且显示 CSV 文件。这样只是说可以访问到 Excel 文件，但是还不能真正的操纵 Excel 文件，本文将给大家一个惊喜，向大家介绍一个开放源码项目，Java Excel API，使用它大家就可以方便地操纵 Excel 文件了。</p> 
      <div class="ibm-no-print"> 
       <p style="line-height:14px;font-family:arial, nsimsun, sans-serif;font-size:.76em;"><b style="font-size:1em;">本文的标签:</b>&nbsp;&nbsp;<a style="color:rgb(76,110,148);">excel</a>,&nbsp;<a style="color:rgb(76,110,148);">java</a>,&nbsp;<a style="color:rgb(76,110,148);">java编程</a>,&nbsp;<a style="color:rgb(76,110,148);">利用</a>,&nbsp;<a style="color:rgb(76,110,148);">操作</a>,&nbsp;<a style="color:rgb(76,110,148);">文件(转的)</a></p> 
      </div> 
      <div class="ibm-access" style="width:500px;"></div> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"></p> 
      <div class="ibm-no-print" style="background-image:url(&quot;http://dw1.s81c.com/developerworks/i/dwtag_icon_maverick.gif&quot;);font-family:arial, sans-serif;background-position:2px 0px;font-size:.76em;">
       <a class="ibm-external-link" href="http://www.ibm.com/developerworks/cn/java/l-javaExcel/" rel="nofollow" style="color:rgb(76,110,148);text-decoration:none;background-image:url(&quot;http://dw1.s81c.com/developerworks/i/dwtag_icon_maverick.gif&quot;);background-position:0px 0px;margin-left:2px;font-weight:bold;"><span style="font-size:small;">标记本文！</span></a>
      </div> 
      <div class="ibm-no-print"></div> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><span style="font-size:small;"></span></p> 
     </div> 
     <div class="ibm-column ibm-second" style="width:380px;"> 
      <p style="line-height:18px;font-family:arial, nsimsun, sans-serif;font-size:.76em;"><b style="font-size:1em;">发布日期：</b>&nbsp;2003 年 1 月 11 日&nbsp;<br><b style="font-size:1em;">级别：</b>&nbsp;初级&nbsp;<br><strong>访问情况</strong>&nbsp;22433 次浏览&nbsp;<br><strong>建议：</strong>&nbsp;<span>0&nbsp;(<a href="http://www.ibm.com/developerworks/cn/java/l-javaExcel/#icomments" rel="nofollow" style="color:rgb(76,110,148);text-decoration:none;">添加评论</a>)</span></p> 
      <div style="width:370px;"> 
       <a style="color:rgb(76,110,148);"><img title="点击评分 1 星" alt="1 star" src="http://www.ibm.com/developerworks/js/artrating/avg-star-on.gif" width="20" height="20" style="border:0px;"></a>
       <a style="color:rgb(76,110,148);"><img title="点击评分 2 星" alt="2 stars" src="http://www.ibm.com/developerworks/js/artrating/avg-star-on.gif" width="20" height="20" style="border:0px;"></a>
       <a style="color:rgb(76,110,148);"><img title="点击评分 3 星" alt="3 stars" src="http://www.ibm.com/developerworks/js/artrating/avg-star-on.gif" width="20" height="20" style="border:0px;"></a>
       <a style="color:rgb(76,110,148);"><img title="点击评分 4 星" alt="4 stars" src="http://www.ibm.com/developerworks/js/artrating/avg-star-on.gif" width="20" height="20" style="border:0px;"></a>
       <a style="color:rgb(76,110,148);"><img title="点击评分 5 星" alt="5 stars" src="http://www.ibm.com/developerworks/js/artrating/star-off.gif" width="20" height="20" style="border:0px;"></a>
       <span style="font-family:arial, sans-serif;font-size:.76em;vertical-align:5px;"><span style="font-size:small;">&nbsp;平均分 （共 35 个评分 ）</span></span> 
      </div> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><span style="font-size:small;"></span></p> 
     </div> 
    </div> 
   </div> 
   <div style="background-image:none;background-attachment:scroll;background-position:0px 0px;clear:both;"> 
    <div style="clear:left;"> 
     <div class="ibm-container"> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><a name="1"><span class="atitle" style="font-size:1.5em;font-weight:bold;"><span style="font-size:large;">JAVA EXCEL API 简介</span></span></a></p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">Java Excel 是一开放源码项目，通过它 Java 开发人员可以读取 Excel 文件的内容、创建新的 Excel 文件、更新已经存在的 Excel 文件。使用该 API 非 Windows 操作系统也可以通过纯 Java 应用来处理 Excel 数据表。因为是使用 Java 编写的，所以我们在 Web 应用中可以通过 JSP、Servlet 来调用 API 实现对 Excel 数据表的访问。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">现在发布的稳定版本是 V2.0，提供以下功能：</p> 
      <ul style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.76em;margin-left:30px;">
       <li style="list-style-type:disc;font-family:arial, nsimsun, sans-serif;">从 Excel 95、97、2000 等格式的文件中读取数据；</li> 
       <li style="list-style-type:disc;font-family:arial, nsimsun, sans-serif;">读取 Excel 公式（可以读取 Excel 97 以后的公式）；</li> 
       <li style="list-style-type:disc;font-family:arial, nsimsun, sans-serif;">生成 Excel 数据表（格式为 Excel 97）；</li> 
       <li style="list-style-type:disc;font-family:arial, nsimsun, sans-serif;">支持字体、数字、日期的格式化；</li> 
       <li style="list-style-type:disc;font-family:arial, nsimsun, sans-serif;">支持单元格的阴影操作，以及颜色操作；</li> 
       <li style="list-style-type:disc;font-family:arial, nsimsun, sans-serif;">修改已经存在的数据表；</li> 
      </ul>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">现在还不支持以下功能，但不久就会提供了：</p> 
      <ol style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.76em;">
       <li style="list-style-type:decimal;font-family:arial, nsimsun, sans-serif;">不能够读取图表信息；</li> 
       <li style="list-style-type:decimal;font-family:arial, nsimsun, sans-serif;">可以读，但是不能生成公式，任何类型公式最后的计算值都可以读出；</li> 
      </ol>
      <div class="ibm-alternate-rule" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;background-image:url(&quot;http://1.www.s81c.com/i/solid.gif&quot;);clear:both;"></div> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;text-align:right;clear:both;"><a class="ibm-anchor-up-link" href="http://www.ibm.com/developerworks/cn/java/l-javaExcel/#ibm-pcon" rel="nofollow" style="color:rgb(76,110,148);text-decoration:none;background-image:url(&quot;http://1.www.s81c.com/i/v16/icons/u_bold.gif&quot;);background-position:0px -1px;font-weight:bold;">回页首</a></p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><a name="2"><span class="atitle" style="font-size:1.5em;font-weight:bold;"><span style="font-size:large;">应用示例</span></span></a></p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><a name="N10079"><span class="smalltitle" style="font-size:1.2em;font-weight:bold;"><span style="font-size:medium;">1 从 Excel 文件读取数据表</span></span></a></p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">Java Excel API 既可以从本地文件系统的一个文件 (.xls)，也可以从输入流中读取 Excel 数据表。读取 Excel 数据表的第一步是创建 Workbook( 术语：工作薄 )，下面的代码片段举例说明了应该如何操作：( 完整代码见 ExcelReading.java)</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> import java.io.*;
 import jxl.*;
… … … …
 try
 {
 // 构建 Workbook 对象 , 只读 Workbook 对象
	 // 直接从本地文件创建 Workbook
 // 从输入流创建 Workbook
    InputStream is = new FileInputStream(sourcefile);
    jxl.Workbook rwb = Workbook.getWorkbook(is);
 }
 catch (Exception e)
 {
	 e.printStackTrace();
 }
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">一旦创建了 Workbook，我们就可以通过它来访问 Excel Sheet( 术语：工作表 )。参考下面的代码片段：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> // 获取第一张 Sheet 表
 Sheet rs = rwb.getSheet(0);
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">我们既可能通过 Sheet 的名称来访问它，也可以通过下标来访问它。如果通过下标来访问的话，要注意的一点是下标从 0 开始，就像数组一样。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">一旦得到了 Sheet，我们就可以通过它来访问 Excel Cell( 术语：单元格 )。参考下面的代码片段：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> // 获取第一行，第一列的值
 Cell c00 = rs.getCell(0, 0);
 String strc00 = c00.getContents();
 // 获取第一行，第二列的值
 Cell c10 = rs.getCell(1, 0);
 String strc10 = c10.getContents();
 // 获取第二行，第二列的值
 Cell c11 = rs.getCell(1, 1);
 String strc11 = c11.getContents();
 System.out.println("Cell(0, 0)" + " value : " + strc00 + "; type : " + c00.getType());
 System.out.println("Cell(1, 0)" + " value : " + strc10 + "; type : " + c10.getType());
 System.out.println("Cell(1, 1)" + " value : " + strc11 + "; type : " + c11.getType());
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">如果仅仅是取得 Cell 的值，我们可以方便地通过 getContents() 方法，它可以将任何类型的 Cell 值都作为一个字符串返回。示例代码中 Cell(0, 0) 是文本型，Cell(1, 0) 是数字型，Cell(1,1) 是日期型，通过 getContents()，三种类型的返回值都是字符型。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">如果有需要知道 Cell 内容的确切类型，API 也提供了一系列的方法。参考下面的代码片段：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> String strc00 = null;
 double strc10 = 0.00;
 Date strc11 = null;
 Cell c00 = rs.getCell(0, 0);
 Cell c10 = rs.getCell(1, 0);
 Cell c11 = rs.getCell(1, 1);
 if(c00.getType() == CellType.LABEL)
 {
 LabelCell labelc00 = (LabelCell)c00;
 strc00 = labelc00.getString();
 }
 if(c10.getType() == CellType.NUMBER)
 {
	 NmberCell numc10 = (NumberCell)c10;
 strc10 = numc10.getValue();
 }
 if(c11.getType() == CellType.DATE)
 {
 DateCell datec11 = (DateCell)c11;
 strc11 = datec11.getDate();
 }
 System.out.println("Cell(0, 0)" + " value : " + strc00 + "; type : " + c00.getType());
 System.out.println("Cell(1, 0)" + " value : " + strc10 + "; type : " + c10.getType());
 System.out.println("Cell(1, 1)" + " value : " + strc11 + "; type : " + c11.getType());
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">在得到 Cell 对象后，通过 getType() 方法可以获得该单元格的类型，然后与 API 提供的基本类型相匹配，强制转换成相应的类型，最后调用相应的取值方法 getXXX()，就可以得到确定类型的值。API 提供了以下基本类型，与 Excel 的数据格式相对应，如下图所示：</p> 
      <br>
      <img alt="" src="http://www.ibm.com/developerworks/cn/java/l-javaExcel/image001.jpg" width="365" height="218" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;border:0px;">
      <font><span style="font-size:14px;">&nbsp;</span></font>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">每种类型的具体意义，请参见 Java Excel API Document。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">当你完成对 Excel 电子表格数据的处理后，一定要使用 close() 方法来关闭先前创建的对象，以释放读取数据表的过程中所占用的内存空间，在读取大量数据时显得尤为重要。参考如下代码片段：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> // 操作完成时，关闭对象，释放占用的内存空间
 rwb.close();
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">Java Excel API 提供了许多访问 Excel 数据表的方法，在这里我只简要地介绍几个常用的方法，其它的方法请参考附录中的 Java Excel API Document。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><strong>Workbook 类提供的方法</strong></p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">1. int getNumberOfSheets()&nbsp;<br> 获得工作薄（Workbook）中工作表（Sheet）的个数，示例：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));
 int sheets = rwb.getNumberOfSheets();
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">2. Sheet[] getSheets()&nbsp;<br> 返回工作薄（Workbook）中工作表（Sheet）对象数组，示例：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));
 Sheet[] sheets = rwb.getSheets();
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">3. String getVersion()&nbsp;<br> 返回正在使用的 API 的版本号，好像是没什么太大的作用。</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));
 String apiVersion = rwb.getVersion();
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><strong>Sheet 接口提供的方法</strong></p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">1) String getName()&nbsp;<br> 获取 Sheet 的名称，示例：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));
 jxl.Sheet rs = rwb.getSheet(0);
 String sheetName = rs.getName();
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">2) int getColumns()&nbsp;<br> 获取 Sheet 表中所包含的总列数，示例：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));
 jxl.Sheet rs = rwb.getSheet(0);
 int rsColumns = rs.getColumns();
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">3) Cell[] getColumn(int column)&nbsp;<br> 获取某一列的所有单元格，返回的是单元格对象数组，示例：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));
 jxl.Sheet rs = rwb.getSheet(0);
 Cell[] cell = rs.getColumn(0);
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">4) int getRows()&nbsp;<br> 获取 Sheet 表中所包含的总行数，示例：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));
 jxl.Sheet rs = rwb.getSheet(0);
 int rsRows = rs.getRows();
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">5) Cell[] getRow(int row)&nbsp;<br> 获取某一行的所有单元格，返回的是单元格对象数组，示例子：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));
 jxl.Sheet rs = rwb.getSheet(0);
 Cell[] cell = rs.getRow(0);
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">6) Cell getCell(int column, int row)&nbsp;<br> 获取指定单元格的对象引用，需要注意的是它的两个参数，第一个是列数，第二个是行数，这与通常的行、列组合有些不同。</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));
 jxl.Sheet rs = rwb.getSheet(0);
 Cell cell = rs.getCell(0, 0);
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><a name="N1011E"><span class="smalltitle" style="font-size:1.2em;font-weight:bold;"><span style="font-size:medium;">2 生成新的 Excel 工作薄</span></span></a></p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">下面的代码主要是向大家介绍如何生成简单的 Excel 工作表，在这里单元格的内容是不带任何修饰的 ( 如：字体，颜色等等 )，所有的内容都作为字符串写入。( 完整代码见 ExcelWriting.java)</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">与读取 Excel 工作表相似，首先要使用 Workbook 类的工厂方法创建一个可写入的工作薄 (Workbook) 对象，这里要注意的是，只能通过 API 提供的工厂方法来创建 Workbook，而不能使用 WritableWorkbook 的构造函数，因为类 WritableWorkbook 的构造函数为 protected 类型。示例代码片段如下：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> import java.io.*;
 import jxl.*;
 import jxl.write.*;
… … … …
 try
 {
 // 构建 Workbook 对象 , 只读 Workbook 对象
 //Method 1：创建可写入的 Excel 工作薄
    jxl.write.WritableWorkbook wwb = Workbook.createWorkbook(new File(targetfile));
 //Method 2：将 WritableWorkbook 直接写入到输出流
 /*
    OutputStream os = new FileOutputStream(targetfile);
    jxl.write.WritableWorkbook wwb = Workbook.createWorkbook(os);
 */
 }
 catch (Exception e)
 {
	 e.printStackTrace();
 }
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">API 提供了两种方式来处理可写入的输出流，一种是直接生成本地文件，如果文件名不带全路径的话，缺省的文件会定位在当前目录，如果文件名带有全路径的话，则生成的 Excel 文件则会定位在相应的目录；另外一种是将 Excel 对象直接写入到输出流，例如：用户通过浏览器来访问 Web 服务器，如果 HTTP 头设置正确的话，浏览器自动调用客户端的 Excel 应用程序，来显示动态生成的 Excel 电子表格。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">接下来就是要创建工作表，创建工作表的方法与创建工作薄的方法几乎一样，同样是通过工厂模式方法获得相应的对象，该方法需要两个参数，一个是工作表的名称，另一个是工作表在工作薄中的位置，参考下面的代码片段：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> // 创建 Excel 工作表
 jxl.write.WritableSheet ws = wwb.createSheet("Test Sheet 1", 0);
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">"这锅也支好了，材料也准备齐全了，可以开始下锅了！"，现在要做的只是实例化 API 所提供的 Excel 基本数据类型，并将它们添加到工作表中就可以了，参考下面的代码片段：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> //1. 添加 Label 对象
 jxl.write.Label labelC = new jxl.write.Label(0, 0, "This is a Label cell");
 ws.addCell(labelC);
 // 添加带有字型 Formatting 的对象
 jxl.write.WritableFont wf = new jxl.write.WritableFont(WritableFont.TIMES, 18,
 WritableFont.BOLD, true);
 jxl.write.WritableCellFormat wcfF = new jxl.write.WritableCellFormat(wf);
 jxl.write.Label labelCF = new jxl.write.Label(1, 0, "This is a Label Cell", wcfF);
 ws.addCell(labelCF);
 // 添加带有字体颜色 Formatting 的对象
 jxl.write.WritableFont wfc = new jxl.write.WritableFont(WritableFont.ARIAL, 10,
 WritableFont.NO_BOLD, false,
 UnderlineStyle.NO_UNDERLINE, jxl.format.Colour.RED);
 jxl.write.WritableCellFormat wcfFC = new jxl.write.WritableCellFormat(wfc);
 jxl.write.Label labelCFC = new jxl.write.Label(1, 0, "This is a Label Cell", wcfFC);
 ws.addCell(labelCF);
 //2. 添加 Number 对象
 jxl.write.Number labelN = new jxl.write.Number(0, 1, 3.1415926);
 ws.addCell(labelN);
 // 添加带有 formatting 的 Number 对象
 jxl.write.NumberFormat nf = new jxl.write.NumberFormat("#.##");
 jxl.write.WritableCellFormat wcfN = new jxl.write.WritableCellFormat(nf);
 jxl.write.Number labelNF = new jxl.write.Number(1, 1, 3.1415926, wcfN);
 ws.addCell(labelNF);
 //3. 添加 Boolean 对象
 jxl.write.Boolean labelB = new jxl.write.Boolean(0, 2, false);
 ws.addCell(labelB);
 //4. 添加 DateTime 对象
 jxl.write.DateTime labelDT = new jxl.write.DateTime(0, 3, new java.util.Date());
 ws.addCell(labelDT);
 // 添加带有 formatting 的 DateFormat 对象
 jxl.write.DateFormat df = new jxl.write.DateFormat("dd MM yyyy hh:mm:ss");
 jxl.write.WritableCellFormat wcfDF = new jxl.write.WritableCellFormat(df);
 jxl.write.DateTime labelDTF = new jxl.write.DateTime(1, 3, new java.util.Date(),
 wcfDF);
 ws.addCell(labelDTF);
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">这里有两点大家要引起大家的注意。第一点，在构造单元格时，单元格在工作表中的位置就已经确定了。一旦创建后，单元格的位置是不能够变更的，尽管单元格的内容是可以改变的。第二点，单元格的定位是按照下面这样的规律 (column, row)，而且下标都是从 0 开始，例如，A1 被存储在 (0, 0)，B1 被存储在 (1, 0)。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">最后，不要忘记关闭打开的 Excel 工作薄对象，以释放占用的内存，参见下面的代码片段：</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> // 写入 Exel 工作表
 wwb.write();
 // 关闭 Excel 工作薄对象
 wwb.close();
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">这可能与读取 Excel 文件的操作有少少不同，在关闭 Excel 对象之前，你必须要先调用 write() 方法，因为先前的操作都是存储在缓存中的，所以要通过该方法将操作的内容保存在文件中。如果你先关闭了 Excel 对象，那么只能得到一张空的工作薄了。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><a name="N1014E"><span class="smalltitle" style="font-size:1.2em;font-weight:bold;"><span style="font-size:medium;">3 拷贝、更新 Excel 工作薄</span></span></a></p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">接下来简要介绍一下如何更新一个已经存在的工作薄，主要是下面二步操作，第一步是构造只读的 Excel 工作薄，第二步是利用已经创建的 Excel 工作薄创建新的可写入的 Excel 工作薄，参考下面的代码片段：( 完整代码见 ExcelModifying.java)</p> 
      <table border="0" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.8em;border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td class="code-outline" style="border:1px solid rgb(204,204,204);border-collapse:collapse;font-family:arial, nsimsun, sans-serif;"><pre class="displaycode"> // 创建只读的 Excel 工作薄的对象
 jxl.Workbook rw = jxl.Workbook.getWorkbook(new File(sourcefile));
 // 创建可写入的 Excel 工作薄对象
 jxl.write.WritableWorkbook  wwb = Workbook.createWorkbook(new File(targetfile), rw);

 // 读取第一张工作表
 jxl.write.WritableSheet ws = wwb.getSheet(0);
 // 获得第一个单元格对象
 jxl.write.WritableCell wc = ws.getWritableCell(0, 0);

 // 判断单元格的类型 , 做出相应的转化
 if(wc.getType() == CellType.LABEL)
 {
 Label l = (Label)wc;
    l.setString("The value has been modified.");
 }
 // 写入 Excel 对象
 wwb.write();
 // 关闭可写入的 Excel 对象
 wwb.close();
 // 关闭只读的 Excel 对象
 rw.close();
</pre></td>
        </tr>
       </tbody>
      </table>
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">之所以使用这种方式构建 Excel 对象，完全是因为效率的原因，因为上面的示例才是 API 的主要应用。为了提高性能，在读取工作表时，与数据相关的一些输出信息，所有的格式信息，如：字体、颜色等等，是不被处理的，因为我们的目的是获得行数据的值，既使没有了修饰，也不会对行数据的值产生什么影响。唯一的不利之处就是，在内存中会同时保存两个同样的工作表，这样当工作表体积比较大时，会占用相当大的内存，但现在好像内存的大小并不是什么关键因素了。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">一旦获得了可写入的工作表对象，我们就可以对单元格对象进行更新的操作了，在这里我们不必调用 API 提供的 add() 方法，因为单元格已经于工作表当中，所以我们只需要调用相应的 setXXX() 方法，就可以完成更新的操作了。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">尽单元格原有的格式化修饰是不能去掉的，我们还是可以将新的单元格修饰加上去，以使单元格的内容以不同的形式表现。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">新生成的工作表对象是可写入的，我们除了更新原有的单元格外，还可以添加新的单元格到工作表中，这与示例 2 的操作是完全一样的。</p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">最后，不要忘记调用 write() 方法，将更新的内容写入到文件中，然后关闭工作薄对象，这里有两个工作薄对象要关闭，一个是只读的，另外一个是可写入的。</p> 
      <div class="ibm-alternate-rule" style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;background-image:url(&quot;http://1.www.s81c.com/i/solid.gif&quot;);clear:both;"></div> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;text-align:right;clear:both;"><a class="ibm-anchor-up-link" href="http://www.ibm.com/developerworks/cn/java/l-javaExcel/#ibm-pcon" rel="nofollow" style="color:rgb(76,110,148);text-decoration:none;background-image:url(&quot;http://1.www.s81c.com/i/v16/icons/u_bold.gif&quot;);background-position:0px -1px;font-weight:bold;">回页首</a></p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><a name="3"><span class="atitle" style="font-size:1.5em;font-weight:bold;"><span style="font-size:large;">小结</span></span></a></p> 
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;">本文只是对 Java Excel API 中常用的方法作了介绍，要想更详尽地了解 API，请大家参考 API 文档，或源代码。Java Excel API 是一个开放源码项目，请大家关注它的最新进展，有兴趣的朋友也可以申请加入这个项目，或者是提出宝贵的意见。</p> 
      <br>
      <p style="font-family:arial, nsimsun, sans-serif;font-size:.76em;"><a name="resources"><span class="atitle" style="font-size:1.5em;font-weight:bold;"><span style="font-size:large;">参考资料</span></span></a></p> 
      <ol style="font-family:verdana, Arial, Helvetica, sans-serif;font-size:.76em;">
       <li style="list-style-type:decimal;font-family:arial, nsimsun, sans-serif;">Java Excel API 文档</li> 
       <li style="list-style-type:decimal;font-family:arial, nsimsun, sans-serif;"><a href="http://www.andykhan.com/jexcelapi/" rel="nofollow" style="color:rgb(76,110,148);text-decoration:none;">http://www.andykhan.com/jexcelapi/</a></li> 
      </ol>
      <div>
       <font><span style="font-size:10.9091px;"><br></span></font>
      </div> 
      <div> 
       <font> </font>
       <div>
        <span style="font-size:10.9091px;">本文转自茄子_2008博客园博客，原文链接：http://www.cnblogs.com/xd502djj/archive/2011/07/22/2114062.html，如需转载请自行联系原作者。</span>
       </div> 
       <div style="font-size:10.9091px;">
        <br>
       </div> 
      </div> 
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
