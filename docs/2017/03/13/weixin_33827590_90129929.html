<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Linux Shell 文本处理工具集锦【转】 « NotBeCN</title>
  <meta name="description" content="             转自：http://www.cnblogs.com/me115/p/3427319.html         内容目录：          find 文件查找      grep 文本搜索      xargs 命令行参数转换      sort 排序      uniq 消除重复行  ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/03/13/weixin_33827590_90129929.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Linux Shell 文本处理工具集锦【转】</h1>
    <p class="post-meta">Mar 13, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p>转自：<a href="http://www.cnblogs.com/me115/p/3427319.html" rel="nofollow">http://www.cnblogs.com/me115/p/3427319.html</a></p> 
   <div class="dir"> 
    <h3>内容目录：</h3> 
    <ul>
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h20" rel="nofollow">find 文件查找</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h21" rel="nofollow">grep 文本搜索</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h22" rel="nofollow">xargs 命令行参数转换</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h23" rel="nofollow">sort 排序</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h24" rel="nofollow">uniq 消除重复行</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h25" rel="nofollow">用tr进行转换</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h26" rel="nofollow">cut 按列切分文本</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h27" rel="nofollow">paste 按列拼接文本</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h28" rel="nofollow">wc 统计行和字符的工具</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h29" rel="nofollow">sed 文本替换利器</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h210" rel="nofollow">awk 数据流处理工具</a></li> 
     <li><a href="http://www.cnblogs.com/me115/p/3427319.html#h211" rel="nofollow">迭代文件中的行、单词和字符</a></li> 
    </ul>
   </div> 
   <div> 
    <p>本文将介绍Linux下使用Shell处理文本时最常用的工具：<br>find、grep、xargs、sort、uniq、tr、cut、paste、wc、sed、awk；<br>提供的例子和参数都是最常用和最为实用的；<br>我对shell脚本使用的原则是命令单行书写，尽量不要超过2行；<br>如果有更为复杂的任务需求，还是考虑python吧；</p> 
    <h2>find 文件查找</h2> 
    <ul>
     <li> <p>查找txt和pdf文件</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> \( <span class="pun">-<span class="pln">name <span class="str">"*.txt"<span class="pln"> <span class="pun">-<span class="pln">o <span class="pun">-<span class="pln">name <span class="str">"*.pdf"<span class="pln"> \) <span class="pun">-<span class="kwd">print</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>正则方式查找.txt和pdf</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">regex <span class="str">".*\(\.txt|\.pdf\)$"</span></span></span></span></span></span></code></pre> <p>-iregex： 忽略大小写的正则</p> </li> 
     <li> <p>否定参数<br>查找所有非txt文本</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">!<span class="pln"> <span class="pun">-<span class="pln">name <span class="str">"*.txt"<span class="pln"> <span class="pun">-<span class="kwd">print</span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>指定搜索深度<br>打印出当前目录的文件（深度为1）</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">maxdepth <span class="lit">1<span class="pln"> <span class="pun">-<span class="pln">type f </span></span></span></span></span></span></span></span></span></code></pre> </li> 
    </ul>
    <h3>定制搜索</h3> 
    <ul>
     <li> <p>按类型搜索：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">type d <span class="pun">-<span class="kwd">print<span class="pln"> <span class="com">//只列出所有目录</span></span></span></span></span></span></span></span></span></code></pre> <p>-type f 文件 / l 符号链接</p> </li> 
     <li> <p>按时间搜索：<br>-atime 访问时间 (单位是天，分钟单位则是-amin，以下类似）<br>-mtime 修改时间 （内容被修改）<br>-ctime 变化时间 （元数据或权限变化）<br>最近7天被访问过的所有文件：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">atime <span class="lit">7<span class="pln"> <span class="pun">-<span class="pln">type f <span class="pun">-<span class="kwd">print</span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>按大小搜索：<br>w字 k M G<br>寻找大于2k的文件</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">type f <span class="pun">-<span class="pln">size <span class="pun">+<span class="lit">2k</span></span></span></span></span></span></span></span></span></code></pre> <p>按权限查找：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">type f <span class="pun">-<span class="pln">perm <span class="lit">644<span class="pln"> <span class="pun">-<span class="kwd">print<span class="pln"> <span class="com">//找具有可执行权限的所有文件</span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> <p>按用户查找：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">type f <span class="pun">-<span class="pln">user weber <span class="pun">-<span class="kwd">print<span class="com">// 找用户weber所拥有的文件</span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
    </ul>
    <h3>找到后的后续动作</h3> 
    <ul>
     <li> <p>删除：<br>删除当前目录下所有的swp文件：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">type f <span class="pun">-<span class="pln">name <span class="str">"*.swp"<span class="pln"> <span class="pun">-<span class="kwd">delete</span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>执行动作（强大的exec）</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">type f <span class="pun">-<span class="pln">user root <span class="pun">-<span class="kwd">exec<span class="pln"> chown weber <span class="pun">{}<span class="pln"> \; <span class="com">//将当前目录下的所有权变更为weber</span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> <p>注：{}是一个特殊的字符串，对于每一个匹配的文件，{}会被替换成相应的文件名；<br>eg：将找到的文件全都copy到另一个目录：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> find <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">type f <span class="pun">-<span class="pln">mtime <span class="pun">+<span class="lit">10<span class="pln"> <span class="pun">-<span class="pln">name <span class="str">"*.txt"<span class="pln"> <span class="pun">-<span class="kwd">exec<span class="pln"> cp <span class="pun">{}<span class="pln"> OLD \;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>结合多个命令<br>tips: 如果需要后续执行多个命令，可以将多个命令写成一个脚本。然后 -exec 调用时执行脚本即可；</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> <span class="pun">-<span class="kwd">exec<span class="pln"> <span class="pun">./<span class="pln">commands<span class="pun">.<span class="pln">sh <span class="pun">{}<span class="pln"> \;</span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
    </ul>
    <h3>-print的定界符</h3> 
    <p>默认使用'\n'作为文件的定界符；<br>-print0 使用'\0'作为文件的定界符，这样就可以搜索包含空格的文件；</p> 
    <h2>grep 文本搜索</h2> 
    <p>grep match_patten file // 默认访问匹配行</p> 
    <ul>
     <li> <p>常用参数<br>-o 只输出匹配的文本行 <strong>VS </strong>-v 只输出没有匹配的文本行<br>-c 统计文件中包含文本的次数</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> grep <span class="pun">-<span class="pln">c <span class="str">"text"<span class="pln"> filename</span></span></span></span></span></code></pre> <p>-n 打印匹配的行号<br>-i 搜索时忽略大小写<br>-l 只打印文件名</p> </li> 
     <li> <p>在多级目录中对文本递归搜索(程序员搜代码的最爱）：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> grep <span class="str">"class"<span class="pln"> <span class="pun">.<span class="pln"> <span class="pun">-<span class="pln">R <span class="pun">-<span class="pln">n</span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li>匹配多个模式 <pre class="code prettyprint prettyprinted"><code><span class="pln"> grep <span class="pun">-<span class="pln">e <span class="str">"class"<span class="pln"> <span class="pun">-<span class="pln">e <span class="str">"vitural"<span class="pln"> file</span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li>grep输出以\0作为结尾符的文件名：（-z） <pre class="code prettyprint prettyprinted"><code><span class="pln"> grep <span class="str">"test"<span class="pln"> file<span class="pun">*<span class="pln"> <span class="pun">-<span class="pln">lZ<span class="pun">|<span class="pln"> xargs <span class="pun">-<span class="lit">0<span class="pln"> rm</span></span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
    </ul>
    <h2>xargs 命令行参数转换</h2> 
    <p>xargs 能够将输入数据转化为特定命令的命令行参数；这样，可以配合很多命令来组合使用。比如grep，比如find；</p> 
    <ul>
     <li> <p>将多行输出转化为单行输出<br>cat file.txt| xargs<br>\n 是多行文本间的定界符</p> </li> 
     <li> <p>将单行转化为多行输出<br>cat single.txt | xargs -n 3<br>-n：指定每行显示的字段数</p> </li> 
    </ul>
    <h3>xargs参数说明</h3> 
    <p>-d 定义定界符 （默认为空格 多行的定界符为 \n）<br>-n 指定输出为多行<br>-I {} 指定替换字符串，这个字符串在xargs扩展时会被替换掉,用于待执行的命令需要多个参数时<br>eg：</p> 
    <pre class="code prettyprint prettyprinted"><code><span class="pln">cat file<span class="pun">.<span class="pln">txt <span class="pun">|<span class="pln"> xargs <span class="pun">-<span class="pln">I <span class="pun">{}<span class="pln"> <span class="pun">./<span class="pln">command<span class="pun">.<span class="pln">sh <span class="pun">-<span class="pln">p <span class="pun">{}<span class="pln"> <span class="pun">-<span class="lit">1</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> 
    <p>-0：指定\0为输入定界符<br>eg：统计程序行数</p> 
    <pre class="code prettyprint prettyprinted"><code><span class="pln">find source_dir<span class="pun">/<span class="pln"> <span class="pun">-<span class="pln">type f <span class="pun">-<span class="pln">name <span class="str">"*.cpp"<span class="pln"> <span class="pun">-<span class="pln">print0 <span class="pun">|<span class="pln">xargs <span class="pun">-<span class="lit">0<span class="pln"> wc <span class="pun">-<span class="pln">l</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> 
    <h2>sort 排序</h2> 
    <p>字段说明：<br>-n 按数字进行排序 VS -d 按字典序进行排序<br>-r 逆序排序<br>-k N 指定按第N列排序<br>eg：</p> 
    <pre class="code prettyprint prettyprinted"><code><span class="pln">sort <span class="pun">-<span class="pln">nrk <span class="lit">1<span class="pln"> data<span class="pun">.<span class="pln">txt sort <span class="pun">-<span class="pln">bd data <span class="com">// 忽略像空格之类的前导空白字符</span></span></span></span></span></span></span></span></span></span></code></pre> 
    <h2>uniq 消除重复行</h2> 
    <ul>
     <li>消除重复行 <pre class="code prettyprint prettyprinted"><code><span class="pln"> sort unsort<span class="pun">.<span class="pln">txt <span class="pun">|<span class="pln"> uniq </span></span></span></span></span></code></pre> </li> 
     <li>统计各行在文件中出现的次数 <pre class="code prettyprint prettyprinted"><code><span class="pln"> sort unsort<span class="pun">.<span class="pln">txt <span class="pun">|<span class="pln"> uniq <span class="pun">-<span class="pln">c</span></span></span></span></span></span></span></code></pre> </li> 
     <li>找出重复行 <pre class="code prettyprint prettyprinted"><code><span class="pln"> sort unsort<span class="pun">.<span class="pln">txt <span class="pun">|<span class="pln"> uniq <span class="pun">-<span class="pln">d</span></span></span></span></span></span></span></code></pre> 可指定每行中需要比较的重复内容：-s 开始位置 -w 比较字符数</li> 
    </ul>
    <h2>用tr进行转换</h2> 
    <ul>
     <li> <p>通用用法</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> echo <span class="lit">12345<span class="pln"> <span class="pun">|<span class="pln"> tr <span class="str">'0-9'<span class="pln"> <span class="str">'9876543210'<span class="pln"> <span class="com">//加解密转换，替换对应字符<span class="pln"> cat text<span class="pun">|<span class="pln"> tr <span class="str">'\t'<span class="pln"> <span class="str">' '<span class="pln"> <span class="com">//制表符转空格</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>tr删除字符</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> cat file <span class="pun">|<span class="pln"> tr <span class="pun">-<span class="pln">d <span class="str">'0-9'<span class="pln"> <span class="com">// 删除所有数字</span></span></span></span></span></span></span></span></code></pre> <p>-c 求补集</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> cat file <span class="pun">|<span class="pln"> tr <span class="pun">-<span class="pln">c <span class="str">'0-9'<span class="pln"> <span class="com">//获取文件中所有数字<span class="pln"> cat file <span class="pun">|<span class="pln"> tr <span class="pun">-<span class="pln">d <span class="pun">-<span class="pln">c <span class="str">'0-9 \n'<span class="pln"> <span class="com">//删除非数字数据</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>tr压缩字符<br>tr -s 压缩文本中出现的重复字符；最常用于压缩多余的空格</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> cat file <span class="pun">|<span class="pln"> tr <span class="pun">-<span class="pln">s <span class="str">' '</span></span></span></span></span></span></code></pre> </li> 
     <li> <p>字符类<br>tr中可用各种字符类：<br>alnum：字母和数字<br>alpha：字母<br>digit：数字<br>space：空白字符<br>lower：小写<br>upper：大写<br>cntrl：控制（非可打印）字符<br>print：可打印字符<br>使用方法：tr [:class:] [:class:]</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> eg<span class="pun">:<span class="pln"> tr <span class="str">'[:lower:]'<span class="pln"> <span class="str">'[:upper:]'</span></span></span></span></span></span></code></pre> </li> 
    </ul>
    <h2>cut 按列切分文本</h2> 
    <ul>
     <li>截取文件的第2列和第4列： <pre class="code prettyprint prettyprinted"><code><span class="pln"> cut <span class="pun">-<span class="pln">f2<span class="pun">,<span class="lit">4<span class="pln"> filename</span></span></span></span></span></span></code></pre> </li> 
     <li>去文件除第3列的所有列： <pre class="code prettyprint prettyprinted"><code><span class="pln"> cut <span class="pun">-<span class="pln">f3 <span class="pun">--<span class="pln">complement filename</span></span></span></span></span></code></pre> </li> 
     <li>-d 指定定界符： <pre class="code prettyprint prettyprinted"><code><span class="pln"> cat <span class="pun">-<span class="pln">f2 <span class="pun">-<span class="pln">d<span class="str">";"<span class="pln"> filename</span></span></span></span></span></span></span></code></pre> </li> 
     <li>cut 取的范围<br>N- 第N个字段到结尾<br>-M 第1个字段为M<br>N-M N到M个字段</li> 
     <li>cut 取的单位<br>-b 以字节为单位<br>-c 以字符为单位<br>-f 以字段为单位（使用定界符）</li> 
     <li>eg: <pre class="code prettyprint prettyprinted"><code><span class="pln"> cut <span class="pun">-<span class="pln">c1<span class="pun">-<span class="lit">5<span class="pln"> file <span class="com">//打印第一到5个字符<span class="pln"> cut <span class="pun">-<span class="pln">c<span class="pun">-<span class="lit">2<span class="pln"> file <span class="com">//打印前2个字符</span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
    </ul>
    <h2>paste 按列拼接文本</h2> 
    <p>将两个文本按列拼接到一起;</p> 
    <pre class="code prettyprint prettyprinted"><code><span class="pln">cat file1 <span class="lit">1<span class="pln"> <span class="lit">2<span class="pln"> cat file2 colin book paste file1 file2 <span class="lit">1<span class="pln"> colin <span class="lit">2<span class="pln"> book</span></span></span></span></span></span></span></span></span></code></pre> 
    <p>默认的定界符是制表符，可以用-d指明定界符<br>paste file1 file2 -d ","<br>1,colin<br>2,book</p> 
    <h2>wc 统计行和字符的工具</h2> 
    <p>wc -l file // 统计行数<br>wc -w file // 统计单词数<br>wc -c file // 统计字符数</p> 
    <h2>sed 文本替换利器</h2> 
    <ul>
     <li>首处替换 <pre class="code prettyprint prettyprinted"><code><span class="pln"> seg <span class="str">'s/text/replace_text/'<span class="pln"> file <span class="com">//替换每一行的第一处匹配的text</span></span></span></span></code></pre> </li> 
     <li> <p>全局替换</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> seg <span class="str">'s/text/replace_text/g'<span class="pln"> file</span></span></span></code></pre> <p>默认替换后，输出替换后的内容，如果需要直接替换原文件,使用-i：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> seg <span class="pun">-<span class="pln">i <span class="str">'s/text/repalce_text/g'<span class="pln"> file</span></span></span></span></span></code></pre> </li> 
     <li> <p>移除空白行：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> sed <span class="str">'/^$/d'<span class="pln"> file</span></span></span></code></pre> </li> 
     <li> <p>变量转换<br>已匹配的字符串通过标记&amp;来引用.</p> <pre class="code prettyprint prettyprinted"><code><span class="pln">echo <span class="kwd">this<span class="pln"> <span class="kwd">is<span class="pln"> en example <span class="pun">|<span class="pln"> seg <span class="str">'s/\w+/[&amp;]/g'<span class="pln"> $<span class="pun">&gt;[<span class="kwd">this<span class="pun">]<span class="pln"> <span class="pun">[<span class="kwd">is<span class="pun">]<span class="pln"> <span class="pun">[<span class="pln">en<span class="pun">]<span class="pln"> <span class="pun">[<span class="pln">example<span class="pun">]</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>子串匹配标记<br>第一个匹配的括号内容使用标记 \1 来引用</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> sed <span class="str">'s/hello\([0-9]\)/\1/'</span></span></code></pre> </li> 
     <li> <p>双引号求值<br>sed通常用单引号来引用；也可使用双引号，使用双引号后，双引号会对表达式求值：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> sed <span class="str">'s/$var/HLLOE/'</span></span></code></pre> <p>当使用双引号时，我们可以在sed样式和替换字符串中指定变量；</p> <pre class="code prettyprint prettyprinted"><code><span class="pln">eg<span class="pun">:<span class="pln"> p<span class="pun">=<span class="pln">patten r<span class="pun">=<span class="pln">replaced echo <span class="str">"line con a patten"<span class="pln"> <span class="pun">|<span class="pln"> sed <span class="str">"s/$p/$r/g"<span class="pln"> $<span class="pun">&gt;<span class="pln">line con a replaced</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>其它示例<br>字符串插入字符：将文本中每行内容（PEKSHA） 转换为 PEK/SHA</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> sed <span class="str">'s/^.\{3\}/&amp;\//g'<span class="pln"> file</span></span></span></code></pre> </li> 
    </ul>
    <h2>awk 数据流处理工具</h2> 
    <ul>
     <li> <p>awk脚本结构<br>awk ' BEGIN{ statements } statements2 END{ statements } '</p> </li> 
     <li> <p>工作方式<br>1.执行begin中语句块；<br>2.从文件或stdin中读入一行，然后执行statements2，重复这个过程，直到文件全部被读取完毕；<br>3.执行end语句块；</p> </li> 
    </ul>
    <h3>print 打印当前行</h3> 
    <ul>
     <li> <p>使用不带参数的print时，会打印当前行;</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> echo <span class="pun">-<span class="pln">e <span class="str">"line1\nline2"<span class="pln"> <span class="pun">|<span class="pln"> awk <span class="str">'BEGIN{print "start"} {print } END{ print "End" }'</span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>print 以逗号分割时，参数以空格定界;</p> <pre class="code prettyprint prettyprinted"><code><span class="pln">echo <span class="pun">|<span class="pln"> awk <span class="str">' {var1 = "v1" ; var2 = "V2"; var3="v3"; \ print var1, var2 , var3; }'<span class="pln"> $<span class="pun">&gt;<span class="pln">v1 V2 v3</span></span></span></span></span></span></span></code></pre> </li> 
     <li>使用-拼接符的方式（""作为拼接符）; <pre class="code prettyprint prettyprinted"><code><span class="pln">echo <span class="pun">|<span class="pln"> awk <span class="str">' {var1 = "v1" ; var2 = "V2"; var3="v3"; \ print var1"-"var2"-"var3; }'<span class="pln"> $<span class="pun">&gt;<span class="pln">v1<span class="pun">-<span class="pln">V2<span class="pun">-<span class="pln">v3</span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
    </ul>
    <h3>特殊变量： NR NF $0 $1 $2</h3> 
    <p>NR:表示记录数量，在执行过程中对应当前行号；<br>NF:表示字段数量，在执行过程总对应当前行的字段数；<br>$0:这个变量包含执行过程中当前行的文本内容；<br>$1:第一个字段的文本内容；<br>$2:第二个字段的文本内容；</p> 
    <pre class="code prettyprint prettyprinted"><code><span class="pln">echo <span class="pun">-<span class="pln">e <span class="str">"line1 f2 f3\n line2 \n line 3"<span class="pln"> <span class="pun">|<span class="pln"> awk <span class="str">'{print NR":"$0"-"$1"-"$2}'</span></span></span></span></span></span></span></span></code></pre> 
    <ul>
     <li>打印每一行的第二和第三个字段： <pre class="code prettyprint prettyprinted"><code><span class="pln"> awk <span class="str">'{print $2, $3}'<span class="pln"> file</span></span></span></code></pre> </li> 
     <li> <p>统计文件的行数：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> awk <span class="str">' END {print NR}'<span class="pln"> file</span></span></span></code></pre> </li> 
     <li> <p>累加每一行的第一个字段：</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> echo <span class="pun">-<span class="pln">e <span class="str">"1\n 2\n 3\n 4\n"<span class="pln"> <span class="pun">|<span class="pln"> awk <span class="str">'BEGIN{num = 0 ; print "begin";} {sum += $1;} END {print "=="; print sum }'</span></span></span></span></span></span></span></span></code></pre> </li> 
    </ul>
    <h3>传递外部变量</h3> 
    <pre class="code prettyprint prettyprinted"><code><span class="kwd">var<span class="pun">=<span class="lit">1000<span class="pln"> echo <span class="pun">|<span class="pln"> awk <span class="str">'{print vara}'<span class="pln"> vara<span class="pun">=<span class="pln">$var <span class="com"># 输入来自stdin<span class="pln"> awk <span class="str">'{print vara}'<span class="pln"> vara<span class="pun">=<span class="pln">$var file <span class="com"># 输入来自文件</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> 
    <h3>用样式对awk处理的行进行过滤</h3> 
    <p>awk 'NR &lt; 5' #行号小于5<br>awk 'NR==1,NR==4 {print}' file #行号等于1和4的打印出来<br>awk '/linux/' #包含linux文本的行（可以用正则表达式来指定，超级强大）<br>awk '!/linux/' #不包含linux文本的行</p> 
    <h3>设置定界符</h3> 
    <p>使用-F来设置定界符（默认为空格）<br>awk -F: '{print $NF}' /etc/passwd</p> 
    <h3>读取命令输出</h3> 
    <p>使用getline，将外部shell命令的输出读入到变量cmdout中；</p> 
    <pre class="code prettyprint prettyprinted"><code><span class="pln">echo <span class="pun">|<span class="pln"> awk <span class="str">'{"grep root /etc/passwd" | getline cmdout; print cmdout }'</span></span></span></span></code></pre> 
    <h3>在awk中使用循环</h3> 
    <p>for(i=0;i&lt;10;i++){print $i;}<br>for(i in array){print array[i];}</p> 
    <p>eg:<br>以逆序的形式打印行：(tac命令的实现）</p> 
    <pre class="code prettyprint prettyprinted"><code><span class="pln">seq <span class="lit">9<span class="pun">|<span class="pln"> \ awk <span class="str">'{lifo[NR] = $0; lno=NR} \ END{ for(;lno&gt;-1;lno--){print lifo[lno];} } '</span></span></span></span></span></code></pre> 
    <h3>awk实现head、tail命令</h3> 
    <ul>
     <li> <p>head:</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> awk <span class="str">'NR&lt;=10{print}'<span class="pln"> filename</span></span></span></code></pre> </li> 
     <li> <p>tail:</p> <pre class="code prettyprint prettyprinted"><code><span class="pln"> awk <span class="str">'{buffer[NR%10] = $0;} END{for(i=0;i&lt;11;i++){ \ print buffer[i %10]} } '<span class="pln"> filename</span></span></span></code></pre> </li> 
    </ul>
    <h3>打印指定列</h3> 
    <ul>
     <li>awk方式实现： <pre class="code prettyprint prettyprinted"><code><span class="pln"> ls <span class="pun">-<span class="pln">lrt <span class="pun">|<span class="pln"> awk <span class="str">'{print $6}'</span></span></span></span></span></span></code></pre> </li> 
     <li>cut方式实现 <pre class="code prettyprint prettyprinted"><code><span class="pln"> ls <span class="pun">-<span class="pln">lrt <span class="pun">|<span class="pln"> cut <span class="pun">-<span class="pln">f6</span></span></span></span></span></span></span></code></pre> </li> 
    </ul>
    <h3>打印指定文本区域</h3> 
    <ul>
     <li>确定行号 <pre class="code prettyprint prettyprinted"><code><span class="pln"> seq <span class="lit">100<span class="pun">|<span class="pln"> awk <span class="str">'NR==4,NR==6{print}'</span></span></span></span></span></code></pre> </li> 
     <li>确定文本<br>打印处于start_pattern 和end_pattern之间的文本； <pre class="code prettyprint prettyprinted"><code><span class="pln"> awk <span class="str">'/start_pattern/, /end_pattern/'<span class="pln"> filename</span></span></span></code></pre> eg: <pre class="code prettyprint prettyprinted"><code><span class="pln">seq <span class="lit">100<span class="pln"> <span class="pun">|<span class="pln"> awk <span class="str">'/13/,/15/'<span class="pln"> cat <span class="pun">/<span class="pln">etc<span class="pun">/<span class="pln">passwd<span class="pun">|<span class="pln"> awk <span class="str">'/mai.*mail/,/news.*news/'</span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
    </ul>
    <h3>awk常用内建函数</h3> 
    <p>index(string,search_string):返回search_string在string中出现的位置<br>sub(regex,replacement_str,string):将正则匹配到的第一处内容替换为replacement_str;<br>match(regex,string):检查正则表达式是否能够匹配字符串；<br>length(string)：返回字符串长度</p> 
    <pre class="code prettyprint prettyprinted"><code><span class="pln">echo <span class="pun">|<span class="pln"> awk <span class="str">'{"grep root /etc/passwd" | getline cmdout; print length(cmdout) }'</span></span></span></span></code></pre> 
    <p>printf 类似c语言中的printf，对输出进行格式化<br>eg：</p> 
    <pre class="code prettyprint prettyprinted"><code><span class="pln">seq <span class="lit">10<span class="pln"> <span class="pun">|<span class="pln"> awk <span class="str">'{printf "-&gt;%4s\n", $1}'</span></span></span></span></span></span></code></pre> 
    <h2>迭代文件中的行、单词和字符</h2> 
    <h3>1. 迭代文件中的每一行</h3> 
    <ul>
     <li> <p>while 循环法</p> <pre class="code prettyprint prettyprinted"><code><span class="kwd">while<span class="pln"> read line<span class="pun">;<span class="pln"> <span class="kwd">do<span class="pln"> echo $line<span class="pun">;<span class="pln"> <span class="kwd">done<span class="pln"> <span class="pun">&lt;<span class="pln"> file<span class="pun">.<span class="pln">txt <span class="pun">改成子<span class="pln">shell<span class="pun">:<span class="pln"> cat file<span class="pun">.<span class="pln">txt <span class="pun">|<span class="pln"> <span class="pun">(<span class="kwd">while<span class="pln"> read line<span class="pun">;<span class="kwd">do<span class="pln"> echo $line<span class="pun">;<span class="kwd">done<span class="pun">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> </li> 
     <li> <p>awk法：<br>cat file.txt| awk '{print}'</p> </li> 
    </ul>
    <h3>2.迭代一行中的每一个单词</h3> 
    <pre class="code prettyprint prettyprinted"><code><span class="kwd">for<span class="pln"> word <span class="kwd">in<span class="pln"> $line<span class="pun">;<span class="pln"> <span class="kwd">do<span class="pln"> echo $word<span class="pun">;<span class="pln"> <span class="kwd">done</span></span></span></span></span></span></span></span></span></span></span></code></pre> 
    <h3>3. 迭代每一个字符</h3> 
    <p>${string:start_pos:num_of_chars}：从字符串中提取一个字符；(bash文本切片）<br>${#word}:返回变量word的长度</p> 
    <pre class="code prettyprint prettyprinted"><code><span class="kwd">for<span class="pun">((<span class="pln">i<span class="pun">=<span class="lit">0<span class="pun">;<span class="pln">i<span class="pun">&lt;<span class="pln">$<span class="pun">{#<span class="pln">word<span class="pun">};<span class="pln">i<span class="pun">++))<span class="pln"> <span class="kwd">do<span class="pln"> echo $<span class="pun">{<span class="pln">word<span class="pun">:<span class="pln">i<span class="pun">:<span class="lit">1<span class="pun">);<span class="pln"> <span class="kwd">done</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> 
    <p>本文为《linux Shell脚本攻略》的读书笔记，文中主要内容和示例来自于<br><a title="Linux Shell脚本攻略" href="http://www.amazon.cn/Linux-Shell%E8%84%9A%E6%9C%AC%E6%94%BB%E7%95%A5-%E6%8B%89%E5%85%8B%E4%BB%80%E6%9B%BC/dp/B0060FSIE4?SubscriptionId=AKIAJOMEZLLKFEWYT4PQ&amp;tag=z08-23&amp;linkCode=xm2&amp;camp=2025&amp;creative=165953&amp;creativeASIN=B0060FSIE4" rel="nofollow">《linux Shell脚本攻略》</a>；</p> 
    <p>Posted by: 大CC | 18NOV,2013<br>博客：<a href="http://blog.me115.com" rel="nofollow">blog.me115.com</a><br>微博：<a href="http://weibo.com/bigcc115" rel="nofollow">新浪微博</a></p> 
   </div> 
   <div> 
    <div>
     【作者】
     <a href="http://www.cnblogs.com/sky-heaven/" rel="nofollow">张昺华</a> 
    </div> 
    <div>
     【出处】
     <a href="http://www.cnblogs.com/sky-heaven/" rel="nofollow">http://www.cnblogs.com/sky-heaven/</a> 
    </div> 
    <div>
     【博客园】 
     <a href="http://www.cnblogs.com/sky-heaven/" rel="nofollow">http://www.cnblogs.com/sky-heaven/</a> 
    </div> 
    <div>
     【新浪博客】 
     <a href="http://blog.sina.com.cn/u/2049150530" rel="nofollow">http://blog.sina.com.cn/u/2049150530</a> 
    </div> 
    <div>
     【知乎】 
     <a href="http://www.zhihu.com/people/zhang-bing-hua" rel="nofollow">http://www.zhihu.com/people/zhang-bing-hua</a> 
    </div> 
    <div>
     【我的作品---旋转倒立摆】 
     <a href="http://v.youku.com/v_show/id_XODM5NDAzNjQw.html?spm=a2hzp.8253869.0.0&amp;from=y1.7-2" rel="nofollow">http://v.youku.com/v_show/id_XODM5NDAzNjQw.html?spm=a2hzp.8253869.0.0&amp;from=y1.7-2</a> 
    </div> 
    <div>
     【我的作品---自平衡自动循迹车】 
     <a href="http://v.youku.com/v_show/id_XODM5MzYyNTIw.html?spm=a2hzp.8253869.0.0&amp;from=y1.7-2" rel="nofollow">http://v.youku.com/v_show/id_XODM5MzYyNTIw.html?spm=a2hzp.8253869.0.0&amp;from=y1.7-2</a> 
    </div> 
    <div>
     【新浪微博】 张昺华--sky
    </div> 
    <div>
     【twitter】 @sky2030_
    </div> 
    <div>
     【facebook】 张昺华 zhangbinghua
    </div> 
    <div>
     本文版权归作者和博客园共有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，否则保留追究法律责任的权利.
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
