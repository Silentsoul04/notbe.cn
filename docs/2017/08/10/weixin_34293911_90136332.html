<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ASP.NET MVC5+EF6+EasyUI 后台管理系统（74）-微信公众平台开发-自定义菜单 « NotBeCN</title>
  <meta name="description" content="             系列目录        引言         1、如果不借用Senparc.Weixin SDK自定义菜单，编码起来，工作量是非常之大     2、但是借助SDK似乎一切都是简单得不要不要的     3、自定义菜单无需要建立数据库表     4、自定义菜单最多包括3个一级菜单，每个一级菜...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/08/10/weixin_34293911_90136332.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">ASP.NET MVC5+EF6+EasyUI 后台管理系统（74）-微信公众平台开发-自定义菜单</h1>
    <p class="post-meta">Aug 10, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong style="font-size:1em;line-height:1.5;"><a href="http://www.cnblogs.com/ymnets/p/3424309.html" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">系列目录</a></strong></p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><em><img src="https://images201609.cnblogs.com/blog/439652/201609/439652-20160903182214764-1465203937.png" alt="" style="border:0px;"></em></p> 
   <h1 style="color:#008080;line-height:1.5;font-size:28px;border-bottom:2pt solid #008080;font-family:Verdana, Arial, Helvetica, sans-serif;">引言</h1> 
   <blockquote style="background:rgb(239,239,239);border:2px solid rgb(239,239,239);color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"> 
    <p style="text-indent:2em;">1、如果不借用Senparc.Weixin SDK自定义菜单，编码起来，工作量是非常之大</p> 
    <p style="text-indent:2em;">2、但是借助SDK似乎一切都是简单得不要不要的</p> 
    <p style="text-indent:2em;">3、自定义菜单无需要建立数据库表</p> 
    <p style="text-indent:2em;">4、自定义菜单最多包括3个一级菜单，每个一级菜单最多包含5个二级菜单。</p> 
    <p style="text-indent:2em;">5、一级菜单最多4个汉字，二级菜单最多7个汉字，多出来的部分将会以“...”代替。</p> 
    <p style="text-indent:2em;">6、创建自定义菜单后，菜单的刷新策略是，在用户进入公众号会话页或公众号profile页时，如果发现上一次拉取菜单的请求在5分钟以前，就会拉取一下菜单，如果菜单有更新，就会刷新客户端的菜单。</p> 
    <p style="text-indent:2em;">测试时可以尝试取消关注公众账号后再次关注，则可以看到创建后的效果。</p> 
    <p style="text-indent:2em;">7、下载尾部代码，跑起来调试</p> 
   </blockquote> 
   <h1 style="color:#008080;line-height:1.5;font-size:28px;border-bottom:2pt solid #008080;font-family:Verdana, Arial, Helvetica, sans-serif;">自定义接口的类型</h1> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">1、click：点击推事件用户点击click类型按钮后，微信服务器会通过消息接口推送消息类型为event的结构给开发者（参考消息接口指南），并且带上按钮中开发者填写的key值，开发者可以通过自定义的key值与用户进行交互；</p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">2、view：跳转URL用户点击view类型按钮后，微信客户端将会打开开发者在按钮中填写的网页URL，可与网页授权获取用户基本信息接口结合，获得用户基本信息。</p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">3、scancode_push：扫码推事件用户点击按钮后，微信客户端将调起扫一扫工具，完成扫码操作后显示扫描结果（如果是URL，将进入URL），且会将扫码的结果传给开发者，开发者可以下发消息。</p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">4、scancode_waitmsg：扫码推事件且弹出“消息接收中”提示框用户点击按钮后，微信客户端将调起扫一扫工具，完成扫码操作后，将扫码的结果传给开发者，同时收起扫一扫工具，然后弹出“消息接收中”提示框，随后可能会收到开发者下发的消息。</p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">5、pic_sysphoto：弹出系统拍照发图用户点击按钮后，微信客户端将调起系统相机，完成拍照操作后，会将拍摄的相片发送给开发者，并推送事件给开发者，同时收起系统相机，随后可能会收到开发者下发的消息。</p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">6、pic_photo_or_album：弹出拍照或者相册发图用户点击按钮后，微信客户端将弹出选择器供用户选择“拍照”或者“从手机相册选择”。用户选择后即走其他两种流程。</p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">7、pic_weixin：弹出微信相册发图器用户点击按钮后，微信客户端将调起微信相册，完成选择操作后，将选择的相片发送给开发者的服务器，并推送事件给开发者，同时收起相册，随后可能会收到开发者下发的消息。</p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">8、location_select：弹出地理位置选择器用户点击按钮后，微信客户端将调起地理位置选择工具，完成选择操作后，将选择的地理位置发送给开发者的服务器，同时收起位置选择工具，随后可能会收到开发者下发的消息。</p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">9、media_id：下发消息（除文本消息）用户点击media_id类型按钮后，微信服务器会将开发者填写的永久素材id对应的素材下发给用户，永久素材类型可以是图片、音频、视频、图文消息。请注意：永久素材id必须是在“素材管理/新增永久素材”接口上传后获得的合法id。</p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">10、view_limited：跳转图文消息URL用户点击view_limited类型按钮后，微信客户端将打开开发者在按钮中填写的永久素材id对应的图文消息URL，永久素材类型只支持图文消息。请注意：永久素材id必须是在“素材管理/新增永久素材”接口上传后获得的合法id。</p> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">总结出类型：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre> &lt;<span style="color:rgb(0,0,255);line-height:1.5;">select</span> id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">buttonDetails_type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">dllButtonDetails</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">click</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> selected=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">selected</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;点击事件（传回服务器）&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">view</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;访问网页（直接跳转）&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">location_select</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;弹出地理位置选择器&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">pic_photo_or_album</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;弹出拍照或者相册发图&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">pic_sysphoto</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;弹出系统拍照发图&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">pic_weixin</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;弹出微信相册发图器&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">scancode_push</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;扫码推事件&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">scancode_waitmsg</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;扫码推事件且弹出“消息接收中”提示框&lt;/option&gt;
                                    &lt;/<span style="color:rgb(0,0,255);line-height:1.5;">select</span>&gt;</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h1 style="color:#008080;line-height:1.5;font-size:28px;border-bottom:2pt solid #008080;font-family:Verdana, Arial, Helvetica, sans-serif;">接口的调用和类型</h1> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141013&amp;token=&amp;lang=zh_CN" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141013&amp;token=&amp;lang=zh_CN</a></p> 
   <h1 style="color:#008080;line-height:1.5;font-size:28px;border-bottom:2pt solid #008080;font-family:Verdana, Arial, Helvetica, sans-serif;">借助Senparc.Weixin SDK</h1> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">由于不需要数据库，所以只有控制器和前端</p> 
   <h3 style="color:#008080;font-size:16px;line-height:45px;font-family:Verdana, Arial, Helvetica, sans-serif;">控制器：编辑菜单，删除菜单，获取菜单</h3> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="line-height:1.5;">        [HttpPost]
        </span><span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;"> ActionResult CreateMenu( GetMenuResultFull resultFull, MenuMatchRule menuMatchRule)
        {
            WC_OfficalAccountsModel model </span>=<span style="line-height:1.5;"> account_BLL.GetCurrentAccount();
            </span><span style="color:rgb(0,0,255);line-height:1.5;">string</span> token =<span style="line-height:1.5;"> model.AccessToken;
            </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> useAddCondidionalApi = menuMatchRule != <span style="color:rgb(0,0,255);line-height:1.5;">null</span> &amp;&amp; !<span style="line-height:1.5;">menuMatchRule.CheckAllNull();
            </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> apiName = <span style="color:rgb(0,0,255);line-height:1.5;">string</span>.Format(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">使用接口：{0}。</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, (useAddCondidionalApi ? <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">个性化菜单接口</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> : <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">普通自定义菜单接口</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">));
            </span><span style="color:rgb(0,0,255);line-height:1.5;">try</span><span style="line-height:1.5;">
            {
                </span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">重新整理按钮信息</span>
                WxJsonResult result = <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">;
                IButtonGroupBase buttonGroup </span>= <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">;
                </span><span style="color:rgb(0,0,255);line-height:1.5;">if</span><span style="line-height:1.5;"> (useAddCondidionalApi)
                {
                    </span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">个性化接口</span>
                    buttonGroup = Senparc.Weixin.MP.CommonAPIs.CommonApi.GetMenuFromJsonResult(resultFull, <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> ConditionalButtonGroup()).menu;

                    </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> addConditionalButtonGroup = buttonGroup <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> ConditionalButtonGroup;
                    addConditionalButtonGroup.matchrule </span>=<span style="line-height:1.5;"> menuMatchRule;
                    result </span>=<span style="line-height:1.5;"> Senparc.Weixin.MP.CommonAPIs.CommonApi.CreateMenuConditional(token, addConditionalButtonGroup);
                    apiName </span>+= <span style="color:rgb(0,0,255);line-height:1.5;">string</span>.Format(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">menuid：{0}。</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, (result <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> CreateMenuConditionalResult).menuid);
                }
                </span><span style="color:rgb(0,0,255);line-height:1.5;">else</span><span style="line-height:1.5;">
                {
                    </span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">普通接口</span>
                    buttonGroup = Senparc.Weixin.MP.CommonAPIs.CommonApi.GetMenuFromJsonResult(resultFull, <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> ButtonGroup()).menu;
                    result </span>=<span style="line-height:1.5;"> Senparc.Weixin.MP.CommonAPIs.CommonApi.CreateMenu(token, buttonGroup);
                }

                </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> json = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;">
                {
                    Success </span>= result.errmsg == <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">ok</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,
                    Message </span>= <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">菜单更新成功。</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> +<span style="line-height:1.5;"> apiName
                };
                </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> Json(json);
            }
            </span><span style="color:rgb(0,0,255);line-height:1.5;">catch</span><span style="line-height:1.5;"> (Exception ex)
            {
                </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> json = <span style="color:rgb(0,0,255);line-height:1.5;">new</span> { Success = <span style="color:rgb(0,0,255);line-height:1.5;">false</span>, Message = <span style="color:rgb(0,0,255);line-height:1.5;">string</span>.Format(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">更新失败：{0}。{1}</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">, ex.Message, apiName) };
                </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> Json(json);
            }
        }

        </span><span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;"> ActionResult GetMenu()
        {
            WC_OfficalAccountsModel model </span>=<span style="line-height:1.5;"> account_BLL.GetCurrentAccount();
            </span><span style="color:rgb(0,0,255);line-height:1.5;">string</span> token =<span style="line-height:1.5;"> model.AccessToken;
            </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> result =<span style="line-height:1.5;"> Senparc.Weixin.MP.CommonAPIs.CommonApi.GetMenu(token);
            </span><span style="color:rgb(0,0,255);line-height:1.5;">if</span> (result == <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">)
            {
                </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span> Json(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> { error = <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">菜单不存在或验证失败！</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;"> }, JsonRequestBehavior.AllowGet);
            }
            </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> Json(result, JsonRequestBehavior.AllowGet);
        }

        </span><span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;"> ActionResult DeleteMenu()
        {
            </span><span style="color:rgb(0,0,255);line-height:1.5;">try</span><span style="line-height:1.5;">
            {
                WC_OfficalAccountsModel model </span>=<span style="line-height:1.5;"> account_BLL.GetCurrentAccount();
                </span><span style="color:rgb(0,0,255);line-height:1.5;">string</span> token =<span style="line-height:1.5;"> model.AccessToken;
                </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> result =<span style="line-height:1.5;"> Senparc.Weixin.MP.CommonAPIs.CommonApi.DeleteMenu(token);
                </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> json = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;">
                {
                    Success </span>= result.errmsg == <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">ok</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,
                    Message </span>=<span style="line-height:1.5;"> result.errmsg
                };
                </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> Json(json, JsonRequestBehavior.AllowGet);
            }
            </span><span style="color:rgb(0,0,255);line-height:1.5;">catch</span><span style="line-height:1.5;"> (Exception ex)
            {
                </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> json = <span style="color:rgb(0,0,255);line-height:1.5;">new</span> { Success = <span style="color:rgb(0,0,255);line-height:1.5;">false</span>, Message =<span style="line-height:1.5;"> ex.Message };
                </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> Json(json, JsonRequestBehavior.AllowGet);
            }
        }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">都用SDK来完成接口的调用</p> 
   <h3 style="color:#008080;font-size:16px;line-height:45px;font-family:Verdana, Arial, Helvetica, sans-serif;">前端代码&nbsp;</h3> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>&lt;style&gt;<span style="line-height:1.5;">
    .menutable {
        border: 1px #ccc solid;
        text</span>-<span style="line-height:1.5;">align: center;
        width: 1000px;
        line</span>-<span style="line-height:1.5;">height: 55px;
    }

        .menutable input[type</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">] {
            width: 150px;
        }

        .menutable th {
            border: 1px #ccc solid;
            text</span>-<span style="line-height:1.5;">align: center;
        }

        .menutable td {
            border: 1px #ccc solid;
        }

    .</span><span style="color:rgb(0,0,255);line-height:1.5;">float</span>-<span style="line-height:1.5;">left {
        </span><span style="color:rgb(0,0,255);line-height:1.5;">float</span><span style="line-height:1.5;">: right;
    }
    .menu</span>-<span style="line-height:1.5;">state {
        line</span>-<span style="line-height:1.5;">height:40px;
    }
</span>&lt;/style&gt;
&lt;div <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">mvctool</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;<span style="line-height:1.5;">
    @Html.ToolButton(</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">btnGetMenu</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">fa fa-pencil</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">获取当前菜单</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(0,0,255);line-height:1.5;">ref</span> perm, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Edit</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">)
    @Html.ToolButton(</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">submitMenu</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">fa fa-pencil</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">更新到服务器</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(0,0,255);line-height:1.5;">ref</span> perm, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Edit</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">)
    @Html.ToolButton(</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">btnDeleteMenu</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">fa fa-trash</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">删除菜单</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(0,0,255);line-height:1.5;">ref</span> perm, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Delete</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">)
    </span>&lt;div <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">rightdiv color-green</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;<span style="line-height:1.5;">
        当前操作公众号：</span>&lt;span id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">CurrentOfficalAccount</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;@(account.OfficalName)&lt;/span&gt;<span style="line-height:1.5;">

        @{</span><span style="color:rgb(0,0,255);line-height:1.5;">if</span> (<span style="color:rgb(0,0,255);line-height:1.5;">string</span>.IsNullOrEmpty(account.AppId) || <span style="color:rgb(0,0,255);line-height:1.5;">string</span>.IsNullOrEmpty(account.AppSecret) || <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">.IsNullOrEmpty(account.AccessToken))
            {
                </span>&lt;span <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">color-red</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;当前公众号没有菜单功能&lt;/span&gt;<span style="line-height:1.5;">
            }
        }
    </span>&lt;/div&gt;
&lt;/div&gt;
    &lt;form id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">form_Menu</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> action=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">/WC/MenuSetting/CreateMenu</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> method=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">post</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
        &lt;p <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">displaynone</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;<span style="line-height:1.5;">
            当前Token:
            </span>&lt;input id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">tokenStr</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">token</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> style=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">width: 900px;</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">readonly</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">readonly</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;&lt;br /&gt;
        &lt;/p&gt;

        &lt;p <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">menu-state color-green</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;<span style="line-height:1.5;">
            操作状态：</span>&lt;strong id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">menuState</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;-&lt;/strong&gt;
        &lt;/p&gt;
        &lt;table&gt;
            &lt;tr&gt;
                &lt;td&gt;
                    &lt;table <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">formtable menutable</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> style=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">width:650px;</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
                        &lt;thead&gt;
                            &lt;tr&gt;
                                &lt;th&gt;&lt;/th&gt;
                                &lt;th&gt;第一列&lt;/th&gt;
                                &lt;th&gt;第二列&lt;/th&gt;
                                &lt;th&gt;第三列&lt;/th&gt;
                            &lt;/tr&gt;
                        &lt;/thead&gt;
                        &lt;tbody&gt;<span style="line-height:1.5;">
                            @for (</span><span style="color:rgb(0,0,255);line-height:1.5;">int</span> i = <span style="color:rgb(128,0,128);line-height:1.5;">0</span>; i &lt; <span style="color:rgb(128,0,128);line-height:1.5;">6</span>; i++<span style="line-height:1.5;">)
                        {
                            </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> isRootMenu = i == <span style="color:rgb(128,0,128);line-height:1.5;">5</span><span style="line-height:1.5;">;
                        </span>&lt;tr id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@(isRootMenu ? </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>subMenuRow_<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;"> + i : </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>rootMenuRow<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">)</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
                            &lt;td&gt;<span style="line-height:1.5;">
                                @(isRootMenu </span>? <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">一级菜单按钮</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> : (<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">二级菜单No.</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> + (i + <span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">)))
                            </span>&lt;/td&gt;<span style="line-height:1.5;">
                            @for (</span><span style="color:rgb(0,0,255);line-height:1.5;">int</span> j = <span style="color:rgb(128,0,128);line-height:1.5;">0</span>; j &lt; <span style="color:rgb(128,0,128);line-height:1.5;">3</span>; j++<span style="line-height:1.5;">)
                                {
                                    </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> namePrefix = isRootMenu ? <span style="color:rgb(0,0,255);line-height:1.5;">string</span>.Format(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">menu.button[{0}]</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, j) : <span style="color:rgb(0,0,255);line-height:1.5;">string</span>.Format(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">menu.button[{0}].sub_button[{1}]</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">, j, i);
                                    </span><span style="color:rgb(0,0,255);line-height:1.5;">var</span> idPrefix = isRootMenu ? <span style="color:rgb(0,0,255);line-height:1.5;">string</span>.Format(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">menu_button{0}</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, j) : <span style="color:rgb(0,0,255);line-height:1.5;">string</span>.Format(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">menu_button{0}_sub_button{1}</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">, j, i);
                                </span>&lt;td&gt;
                                    &lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">hidden</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@(namePrefix).key</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@(idPrefix)_key</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
                                    &lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">hidden</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@(namePrefix).type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@(idPrefix)_type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">click</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
                                    &lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">hidden</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@(namePrefix).url</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@(idPrefix)_url</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
                                    &lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@(namePrefix).name</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@(idPrefix)_name</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">txtButton</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> data-i=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@i</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> data-j=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@j</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> @Html.Raw(isRootMenu ? <span style="color:rgb(0,0,255);line-height:1.5;">string</span>.Format(<span style="color:rgb(128,0,0);line-height:1.5;">@"</span><span style="color:rgb(128,0,0);line-height:1.5;">data-root=""{0}""</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, j) : <span style="color:rgb(128,0,0);line-height:1.5;">""</span>) /&gt;
                                &lt;/td&gt;<span style="line-height:1.5;">
                                }
                        </span>&lt;/tr&gt;<span style="line-height:1.5;">
                        }
                        </span>&lt;/tbody&gt;
                    &lt;/table&gt;
                &lt;/td&gt;

                &lt;td style=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">width:500px</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
                    &lt;div id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">buttonDetails</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
                        &lt;table <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">formtable</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
                            &lt;tr&gt;
                                &lt;th&gt;&lt;/th&gt;
                                &lt;td&gt;<span style="line-height:1.5;">
                                    按钮其他参数
                                </span>&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                                &lt;th&gt;Name：&lt;/th&gt;
                                &lt;td&gt;&lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">buttonDetails_name</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input txtButton</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> disabled=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">disabled</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                                &lt;th&gt;<span style="line-height:1.5;">
                                    Type：
                                </span>&lt;/th&gt;
                                &lt;td&gt;
                                    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">select</span> id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">buttonDetails_type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">dllButtonDetails</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">click</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> selected=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">selected</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;点击事件（传回服务器）&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">view</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;访问网页（直接跳转）&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">location_select</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;弹出地理位置选择器&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">pic_photo_or_album</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;弹出拍照或者相册发图&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">pic_sysphoto</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;弹出系统拍照发图&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">pic_weixin</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;弹出微信相册发图器&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">scancode_push</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;扫码推事件&lt;/option&gt;
                                        &lt;option value=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">scancode_waitmsg</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;扫码推事件且弹出“消息接收中”提示框&lt;/option&gt;
                                    &lt;/<span style="color:rgb(0,0,255);line-height:1.5;">select</span>&gt;
                                &lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">buttonDetails_key_area</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
                                &lt;th&gt;<span style="line-height:1.5;">
                                    Key：
                                </span>&lt;/th&gt;
                                &lt;td&gt;&lt;input id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">buttonDetails_key</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input txtButtonDetails</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">buttonDetails_url_area</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
                                &lt;th&gt;<span style="line-height:1.5;">
                                    Url：
                                </span>&lt;/th&gt;
                                &lt;td&gt;
                                    &lt;input id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">buttonDetails_url</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input txtButtonDetails</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
                                &lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                                &lt;th&gt;&lt;/th&gt;
                                &lt;td&gt;<span style="line-height:1.5;">
                                    如果还有下级菜单请忽略Type和Key、Url。
                                </span>&lt;/td&gt;
                            &lt;/tr&gt;
                        &lt;/table&gt;
                    &lt;/div&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
        &lt;div id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">addConditionalArea</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
            &lt;p&gt;&lt;h3&gt;个性化菜单设置&lt;/h3&gt;&lt;/p&gt;
            &lt;table&gt;
                &lt;tr&gt;
                    &lt;th&gt;group_id&lt;/th&gt;
                    &lt;td&gt;
                        &lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">MenuMatchRule.group_id</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> placeholder=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">用户分组id，可通过用户分组管理接口获取</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                &lt;tr&gt;&lt;th&gt;sex&lt;/th&gt;&lt;td&gt;&lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">MenuMatchRule.sex</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> placeholder=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">性别：男（1）女（2），不填则不做匹配</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;&lt;/td&gt;&lt;/tr&gt;
                &lt;tr&gt;&lt;th&gt;country&lt;/th&gt;&lt;td&gt;&lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">MenuMatchRule.country</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> placeholder=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">国家信息，是用户在微信中设置的地区，具体请参考地区信息表</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;&lt;/td&gt;&lt;/tr&gt;
                &lt;tr&gt;&lt;th&gt;province&lt;/th&gt;&lt;td&gt;&lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">MenuMatchRule.province</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> placeholder=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">省份信息，是用户在微信中设置的地区，具体请参考地区信息表</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;&lt;/td&gt;&lt;/tr&gt;
                &lt;tr&gt;&lt;th&gt;city&lt;/th&gt;&lt;td&gt;&lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">MenuMatchRule.city</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> placeholder=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">城市信息，是用户在微信中设置的地区，具体请参考地区信息表</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;&lt;/td&gt;&lt;/tr&gt;
                &lt;tr&gt;&lt;th&gt;client_platform_type&lt;/th&gt;&lt;td&gt;&lt;input type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">text</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">MenuMatchRule.client_platform_type</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> placeholder=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">客户端版本，当前只具体到系统型号：IOS(1), Android(2),Others(3)，不填则不做匹配</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">control-input</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;&lt;/td&gt;&lt;/tr&gt;
            &lt;/table&gt;
            &lt;p&gt;&lt;i&gt;提示：如果所有字段都留空，则使用普通自定义菜单，如果任何一个条件有值，则使用个性化菜单接口&lt;/i&gt;&lt;/p&gt;
        &lt;/div&gt;
        &lt;div <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">clear</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;&lt;/div&gt;
      
    &lt;/form&gt;
&lt;div id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">reveiveJSON</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">displaynone</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
    &lt;p&gt;接收菜单JSON：&lt;/p&gt;
    &lt;p&gt;&lt;textarea id=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">txtReveiceJSON</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;&lt;/textarea&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;script src=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">@Url.Content(</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>~/Scripts/WeChat/senparc.menu.js<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">)</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;&lt;/script&gt;
&lt;script&gt;<span style="line-height:1.5;">
    $(function () {
        senparc.menu.init();
    });
</span>&lt;/script&gt;</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <img class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" style="border:0px;vertical-align:middle;">&nbsp;
    <span class="cnblogs_code_collapse" style="border-width:1px;border-style:solid;border-color:#808080;line-height:1.5;">senparc.menu.js</span> 
   </div> 
   <h1 style="color:#008080;line-height:1.5;font-size:28px;border-bottom:2pt solid #008080;font-family:Verdana, Arial, Helvetica, sans-serif;">最后界面</h1> 
   <p style="text-indent:2em;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images201609.cnblogs.com/blog/439652/201609/439652-20160903181044796-576821070.png" alt="" style="border:0px;"></p> 
   <h1 style="color:#008080;line-height:1.5;font-size:28px;border-bottom:2pt solid #008080;font-family:Verdana, Arial, Helvetica, sans-serif;">总结</h1> 
   <blockquote style="background:rgb(239,239,239);border:2px solid rgb(239,239,239);color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"> 
    <p style="text-indent:2em;">1.普通菜单只要关注了就可以查看</p> 
    <p style="text-indent:2em;">2.个性化菜单是有查看条件，比如性别，那么微信所属人的性别对应才可以查看</p> 
    <p style="text-indent:2em;">&nbsp; &nbsp;一般个性化菜单，适用于会员级别享有特殊权限</p> 
    <p style="text-indent:2em;"><strong>示例代码下载：https://yunpan.cn/cM9ffkutawueD &nbsp;访问密码 2f0d</strong></p> 
   </blockquote> 
   <h1 style="color:#008080;line-height:1.5;font-size:28px;border-bottom:2pt solid #008080;font-family:Verdana, Arial, Helvetica, sans-serif;">本文转自ymnets博客园博客，原文链接：http://www.cnblogs.com/ymnets/p/5837650.html，如需转载请自行联系原作者<br></h1> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
