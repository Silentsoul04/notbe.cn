<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Automation prepare steps « NotBeCN</title>
  <meta name="description" content="             自己开发的一个结合QTP 和Hudson的一个框架》    | Step Name | Description | Expected Result&nbsp; | Create host instance from template | Choose a template, instan...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/08/11/weixin_34233421_90119462.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Automation prepare steps</h1>
    <p class="post-meta">Aug 11, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:12px;">自己开发的一个结合QTP 和Hudson的一个框架》</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:12px;">| Step Name | Description | Expected Result&nbsp;<br> | Create host instance from template | Choose a template, instantiate the system from template.If creating a new server from OS iso image, see next step. |&nbsp;<br> | | |&nbsp;<br> | Call &lt;Automation_VMware_instance_from_ISO_create_auto&gt; | Call &lt;Automation_VMware_instance_from_ISO_create_auto&gt; |&nbsp;<br> | | |&nbsp;<br> | Activate windows | run command slui.exe to activate windows after setting the hostname and ip address. |&nbsp;<br> | | |&nbsp;<br> | activate windows | If prompted, you can try to activate windows but it will likely fail because a network connection is not yet created. Instead slect 'ask me later' |&nbsp;<br> | | |&nbsp;<br> | Set host name and IP address | Log into the host, change the IP address, hostname, domain.reboot |&nbsp;<br> | | |&nbsp;<br> | Set windows to not update automatically | Configure windows update to check for updates but not download or install them unless you review them. |&nbsp;<br> | | |&nbsp;<br> | Install ALM Addins | The following add ins are required in order to remotely execute ALM tests.Log into the hostStart IEGo to&nbsp;<a href="http://qc2d.atlanta.hp.com/qcbinSelect" rel="nofollow" style="color:rgb(0,0,0);">http://qc2d.atlanta.hp.com/qcbinSelect</a>&nbsp;'Add Ins Page'HP Quality Center Connectivity Add-inSelect 'HP Quality Center Connectivity'Either run the install from the link or download and then run from hard drive.File is also available at \\pdebld1.fc.hp.com\qatest\software\qtp\qtp11\HP_QC_Connectivity_Addin\tdconnect.exeHP Quality Center System Test Remote Agent Add-inWhen installer finishes, return to the add in page.Select "HP Quality Center System Test Remote Agent Add-in"Either run the install from the link or download and then run from hard drive.File is also available at \\pdebld1.fc.hp.com\qatest\software\qtp\qtp11\QTP11_QC_System_Test_Remote_Agent\SysAgent.exeHP ALM Client Registration Add-inWhen installer finishes, return to the add in page.Select 'HP ALM Client Registration'Select 'Register HP ALM Client'If prompted, install the active X controlIf prompted, accept to install any required files.Note this install can take up to 15 minutes, and the browser may appear unresponsive.Wait at least 15 minutes and if the installer does not indicated complete, then stop the browser and try the install again.If prompted, install "Microsoft .NET Framework 3.5 service pack 1", which is required for the client registration.If IE displays a message that is is not configured to download files, then close all windows, run inetcpl.cpl, select security tab, click internet, click customer level button, scroll to download category, set 'file download' to enable and 'automatic prompting for file downloads" to enable, click ok, yes, close window, try download again.If you receive a message that "You must use the role management tool to install or configure microsoft .Net Framework 3.5 SP1" then In Windows Server 2008 R2, you don’t have to install .Net Framework 3.0, it was include in .Net Framework 3.5. You can navigate to Server Manager &gt; Features &gt; Add Features to add .Net Framework.If prompted, download and install 'Microsoft Visual C++ 2005 Service Pack 1 redistributable Package MFC Security Update", you will need the x86 version even if installing on a 64 bit machine.Close the browser window |&nbsp;<br> | | |&nbsp;<br> | Enable remote execution communication | For vapi-xp scripts to run the firewall on the test hos must allow communication.Currently, I don this by disabling the firewall.There are probably more specific settings that could be used. |&nbsp;<br> | | |&nbsp;<br> | Turn off windows Firewall | Start windows Server ManagerThis can be done by clicking the server icon on the windows task barIn task manager navigate to windows firewallTurn off the firewall for all profiles (Domain, Private, Public) |&nbsp;<br> | | |&nbsp;<br> | Enable psexec connections | Open firewall: start, admin tools, windows firewallSelect inbound rulesEnable the following entries under "File and Printer Sharing" Echo RequestICMpv4-InICMpv6-InNB-Datagram-InNB-Name-InNB-Session-In |&nbsp;<br> | | |&nbsp;<br> | Turn off UCA | Copy file \\pdebld1.fc.hp.com\qatest\software\EnableUAC2k8Server.regand put into c:\tempNote: login to pdebld1.fc.hp.com is qatest\L0ngh)rnExecute EnableUAC2k8Server.reg by double clicking itThe script should finish with 5 seconds. |&nbsp;<br> | | |&nbsp;<br> | Turn of UAC | For vapi-xp scripts to run remotely as 'qatest', UAC must be turned off. There may be more specific settings to allow 'qatest' to run remotely, but for now I am turning off 'UAC' |&nbsp;<br> | | |&nbsp;<br> | Enable remote desktop | Enable remote desktop. |&nbsp;<br> | | |&nbsp;<br> | Configure quick launch | place the following icons on the quick launch bar:IEcommand windowwindows explorerconfigure command window to allow quick edit modeconfigure windows explorer to not hide known file extensionsStep through IE configuration |&nbsp;<br> | | |&nbsp;<br> | Create qatest user | LoginCreate administrative user qatest. |&nbsp;<br> | | |&nbsp;<br> | Set pasword to never expire | Set Administrator and qatest accounts so password never expires |&nbsp;<br> | | |&nbsp;<br> | To be automated | the following steps may be automated |&nbsp;<br> | | |&nbsp;<br> | Create c:\temp | create directory c:\temp |&nbsp;<br> | | |&nbsp;<br> | Install windows updates | If required install windows updates. |&nbsp;<br> | | |&nbsp;<br> | Copy over baretail | Copy baretail from \\pdebld1\qatest\software\baretail and put into c:\ |&nbsp;<br> | | |&nbsp;<br> | Install OS language | Install any OS languate required.Set to the default and system language. |&nbsp;<br> | | |&nbsp;<br> | Install web browser | Install any web browser required for testing.Set browser to the default browserSet browser to a home page of 'blank'Set bowser to use web proxy 'web-proxy.fc.hp.com:8088' and to bypass the web proxy for the following: *.hp.com 15.* 16.*Step through any web browser config requests when the browser is opened so these will not be seen every time the browser opens. |&nbsp;<br> | | |&nbsp;<br> | Call &lt;Both_Antivirus_install&gt; | Call &lt;Both_Antivirus_install&gt; |&nbsp;<br> | | |&nbsp;<br> | Configure browser to explicitly bypass proxy for local address | To ensure 5.x and 7.x I-RS interfaces will display when run locally using host name, the browsers need to be set to explicitly bypass the proxy for local addresses.IE: open IE, select Tools, Internet options, connections, lan settings, select bypass proxy server for local address, click advanced for the proxy server, add exception ‘*.hp.com’, ok/apply to save and close settings"FF: Open FF, tools, options, advanced, network, settings, in the 'no proxy for' box, add "*.hp.com", ok/apply to save and close settings. |&nbsp;<br> | | |&nbsp;<br> | Log in as correct user | In order for automated tests to run, a user must be logged into the system.Also, the user the automated tests are to be run as must be logged in.From the vshpere client, select the host, right click, open console.Hit ctl-alt-insert, then enter the login for the user required for testing.leave the console open until the next step to capture the snapshot is complete. Determine what local user the tests should run as. This is available by looking at past test sets executed on the host and determining what user, administrator or qatest, the test were to be executed as.Start the vmware client associated with the test host you are saving a snapshot for. Example: log into webes-schnapps if the test host is hosted by webes-schnaps; log into webesvcgalway if the test host is hosted by webesvcgalwayFind the test host in the vsphere listing, right click and select 'open console'Wait for the console window to openClick the open consoleIf the local user is not logged in, select keys ctrl-alt-insert to obtain the login prompt. Log in as the user that the tests are to operate as.If the local user is already logged in, verify the correct user is logged in: start, run, cmd.exe, in the command window enter 'whoami' and then return. If the user name is not correct, then logout and log back in (see above step for logging in) |&nbsp;<br> | | |&nbsp;<br> | Call &lt;Both_Windows_Windows_Installer_4.5&gt; | Call &lt;Both_Windows_Windows_Installer_4.5&gt; |&nbsp;<br> | | |&nbsp;<br> | Take Baseline_noPrep snapshot | Take system snapshot named 'Baseline_noPrep'.In comments enter the date in format YYYYMMDD and your name and the template used. |&nbsp;<br> | | |&nbsp;<br> | Update automation spreadsheets | Update testdata.xls and Snapshot_Configuration.xls with host and lun information.The autoamtion tests need to know the host's lun, name, ip address in order to function. |<br> | | |&nbsp;<br> | Call &lt;Both_Postgre_ODBC_Driver_DSN_install&gt; | Call &lt;Both_Postgre_ODBC_Driver_DSN_install&gt; |&nbsp;<br> | | |&nbsp;<br> | Call &lt;Both_Windows_Screen_saver_timeout&gt; | Call &lt;Both_Windows_Screen_saver_timeout&gt; |&nbsp;<br> | | |&nbsp;<br> | Update vmware tools | |&nbsp;<br> | | |&nbsp;<br> | Install certifcate | Install the HP certificate.This is required for the host to communicate with the data center. |&nbsp;<br> | | |&nbsp;<br> | Turn off Firefox updating | This must be done on all systems where Firefox is installed, even if FireFox is not used for testing.Start Firefox.Tools, Options, UpdateIn "Automatically check for updates to" section, UN-check all boxes.Click OK |&nbsp;<br> | | |&nbsp;<br> | Prevent Internet Explorer config request | When IE 8 or 9 is installed, IE will request the user to walk through some config windows.Typically user click the 'Ask later" button to prevent walking through the IE config windows, but the user will be asked the next time IE is started.For automation, this constant request for configuration info is problematic.Therefore, the config request screens should be walked through to prevent the request for occuring in the future.Start IEIf asked to walk through configuration screens, then walk through the screens. For each question select the option that will cause the least amount of processing overhead. For example, select to NOT load any special features, select to NOT load a favorite search engine, etc.If not asked to walk through config screens, then the walk through has already been done.Note IE9 presents the pop up request at the BOTTOM of the screen. |&nbsp;<br> | | |&nbsp;<br> | Make IE9 status bar visible | If the host has IE9 installed, ensure IE9 is displaying its status bar: -Start IE9-Move the cursor over the top area of the window-Right click and select 'status' so that status has a check mark next to the text and the status bar is shown at the bottom of the window. |&nbsp;<br> | | |&nbsp;<br> | Run prep script | Copy file \\pdebld1.fc.hp.com\auto\Test_Script\0000_Server_prep.vbs to c:\tempNote: login to \\pdebld1.fc.hp.com is qatest\L0ngh)rnExecute c:\temp\0000_Server_prep.vbs by double clicking on the file.The script should run and finish within 15 seconds.You can review the log file on the test host at c:\irsautomation\test_result_log\0000_Server_prep.logThe last entry will indicate the script finished.Move file 0000_Server_prep.vbs from c:\temp to c:\irsautomation\test_scripts |&nbsp;<br> | | |&nbsp;<br> | Call &lt;Automation_ALM_install_auto&gt; | Call &lt;Automation_ALM_install_auto&gt; |&nbsp;<br> | | |&nbsp;<br> | Call &lt;Automation_QTP11_install_auto&gt; | Call &lt;Automation_QTP11_install_auto&gt; |&nbsp;<br> | | |&nbsp;<br> | Start and configure QTP11 Remote Agent | Start the QTP Remote agent -Start, programs, HP Quick Test Professional\tools\Remote Agent -A new icon will appear on the Windows taskbar. The icon looks like a yellow gear. -Right click on the Remote Agent icon, and select Settings -The Remmote Agent settings window is displayed -Select log leve setting of 'Low' -Enter log folder value of c:\irsautomation\test_results_log -Set 'Cleanup, Restart testing tool after " to 1 runs -Uncheck 'Run Quicktest in hidden mode' -Check 'Keep QuickTest open after a test lab run session ends' -Set 'seconds to operation' to a value of 2700 (this is represents 45 minutes) -Set 'seconds for queries' to a value of 2700 (this is represents 45 minutes) -Leave all other defaults and click OK |&nbsp;<br> | | |&nbsp;<br> | Reboot the server | Reboot the server |&nbsp;<br> | | |&nbsp;<br> | Verify Remote Agent started up | Log into the serverVerify the Remote Agent icon is listed in the windows task bar.The icon looks like a yellow gear.The icon is displayed in the lower right corner of the windows task bar.Right click on the icon, and select Settings.Verify the settings are set to low logging to directory c:\irsautomation\Test_Result_Log |&nbsp;<br> | | |&nbsp;<br> | Clean up hard drive | Deleted c:\temp\qtp11Empty the recycle bin |&nbsp;<br> | | |&nbsp;<br> | Wait for processes to finish | QTP tests will not be able to start if a snapshot is created while the OS is performing resource intensive processes, such as a virus scan. Therefore, the OS processing status must be verified to be in a proper status prior to saving a snapshot.Starte task manager (either ctrl-alt-del or ctrl-alt-end and then select task manager, or move the cursor over the OS taskbar, right click, and select 'start task manager')Review the process tab, sorting descendign on the 'cpu' column to determine if a processes is using a large amount ( &gt; 20%) of the CPU. If a processes is using a lot of CPU, wait for the process to finish and the CPU usage is low before moving to the next step to save a snapshot.Note: process rtvscan is a virus scan process |&nbsp;<br> | | |&nbsp;<br> | Reboot | Reboot the host before taking a snapshot. |&nbsp;<br> | | |&nbsp;<br> | Save Snapshot | After making changes to an automated test host, save a snapshot. The saved snapshot will provide the starting point for the automated test. It is important that when saving a snapshot the local host user is logged into the local console (not a remote desktop or terminal services session). The automated tests cannot start execution unless the local user is logged in Once the user is logged in, save the snapshot. Use the correct snapshot name and change the name of any previous snapshots with the same name to be different. If two snapshots have the same name, the automated tests will not run. Example: an existing snapshot named 'Baseline_None_noRelease' has been updated. Rename the existing snapshot to 'Baseline_None_noRelease_old', then save the new snapshot to name 'Baseline_None_noRelease'Delete any unnecessary snapshots. |&nbsp;<br> | | | &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:12px;"><br></p> 
   <p><font><span style="font-size:12px;">本文转自hcy's workbench博客园博客，原文链接：http://www.cnblogs.com/alterhu/archive/2012/11/01/2749859.html</span></font><span style="font-size:12px;font-family:Verdana, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者。</span></p> 
   <p><span class="Apple-tab-span" style="font-size:12px;"><font> </font></span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
