<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>浅尝辄止 Parallel Python « NotBeCN</title>
  <meta name="description" content="             &nbsp; 最近在关注如何提升Python执行效率的问题，自己没有时间去深入研究，就直接选择了开源的Parallel Python，希望能够充分发挥多核CPU及集群环境的优势。 &nbsp;&nbsp;&nbsp;&nbsp;Parallel Python是Python进行分布式计算的...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/07/01/weixin_34409741_90130568.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">浅尝辄止 Parallel Python</h1>
    <p class="post-meta">Jul 1, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"><span style="font-size:10pt;">&nbsp; 最近在关注如何提升</span><a id="lsis" title="Python" href="http://www.python.org/" rel="nofollow" style="color:rgb(0,51,102);text-decoration:none;"><span style="font-size:10pt;">Python</span></a><span style="font-size:10pt;">执行效率的问题，自己没有时间去深入研究，就直接选择了开源的Parallel Python，希望能够充分发挥多核CPU及集群环境的优势。</span><br> &nbsp;&nbsp;&nbsp;&nbsp;<a id="zi16" title="Parallel Python" href="http://www.parallelpython.com/" rel="nofollow" style="color:rgb(0,51,102);text-decoration:none;"><span style="font-size:10pt;">Parallel Python</span></a><span style="font-size:10pt;">是Python进行分布式计算的开源模块，能够将计算压力分布到多核CPU或集群的多台计算机上，能够非常方便的在内网中搭建一个自组织的分布式计算平台。先从多核计算开始，普通的Python应用程序只能够使用一个CPU进程，而通过Parallel Python能够很方便的将计算扩展到多个CPU进程中，使用官方网站上的一个例子。</span><br></p> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(0,51,102);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;math,&nbsp;time<br><br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">def</span>
     <span style="line-height:1.5;">&nbsp;isprime(n):<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"""</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Returns&nbsp;True&nbsp;if&nbsp;n&nbsp;is&nbsp;prime&nbsp;and&nbsp;False&nbsp;otherwise</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"""</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">not</span>
     <span style="line-height:1.5;">&nbsp;isinstance(n,&nbsp;int):<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">raise</span>
     <span style="line-height:1.5;">&nbsp;TypeError(</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">argument&nbsp;passed&nbsp;to&nbsp;is_prime&nbsp;is&nbsp;not&nbsp;of&nbsp;'int'&nbsp;type</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;n&nbsp;</span>
     <span style="line-height:1.5;">&lt;</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">2</span>
     <span style="line-height:1.5;">:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">return</span>
     <span style="line-height:1.5;">&nbsp;False<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;n&nbsp;</span>
     <span style="line-height:1.5;">==</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">2</span>
     <span style="line-height:1.5;">:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">return</span>
     <span style="line-height:1.5;">&nbsp;True<br> &nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;int(math.ceil(math.sqrt(n)))<br> &nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">2</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">while</span>
     <span style="line-height:1.5;">&nbsp;i&nbsp;</span>
     <span style="line-height:1.5;">&lt;=</span>
     <span style="line-height:1.5;">&nbsp;max:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;n&nbsp;</span>
     <span style="line-height:1.5;">%</span>
     <span style="line-height:1.5;">&nbsp;i&nbsp;</span>
     <span style="line-height:1.5;">==</span>
     <span style="line-height:1.5;">&nbsp;0:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">return</span>
     <span style="line-height:1.5;">&nbsp;False<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;</span>
     <span style="line-height:1.5;">+=</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">1</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">return</span>
     <span style="line-height:1.5;">&nbsp;True<br><br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">def</span>
     <span style="line-height:1.5;">&nbsp;sum_primes(n):<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"""</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Calculates&nbsp;sum&nbsp;of&nbsp;all&nbsp;primes&nbsp;below&nbsp;given&nbsp;integer&nbsp;n</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"""</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">return</span>
     <span style="line-height:1.5;">&nbsp;sum([x&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;x&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;xrange(</span>
     <span style="line-height:1.5;">2</span>
     <span style="line-height:1.5;">,n)&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;isprime(x)])<br><br> start_time&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;time.time()<br><br> inputs&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;(</span>
     <span style="line-height:1.5;">100000</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100100</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100200</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100300</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100400</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100500</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100600</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100700</span>
     <span style="line-height:1.5;">)<br><br> jobs&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;[(input,&nbsp;sum_primes(input))&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;input&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;inputs]<br><br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;input,&nbsp;job&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;jobs:<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Sum&nbsp;of&nbsp;primes&nbsp;below</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;input,&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">is</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;job<br><br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Time&nbsp;elapsed:&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;time.time()&nbsp;</span>
     <span style="line-height:1.5;">-</span>
     <span style="line-height:1.5;">&nbsp;start_time,&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">s</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(0,51,102);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> &nbsp;
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    <span style="font-size:10pt;">&nbsp;&nbsp;&nbsp; 计算指定数值范围内所有素数的和，运行程序消耗时间为4.46900010109 s，程序运行结果和CPU使用率如下所示：</span>
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <span style="font-size:10pt;">Sum of primes below 100000 is 454396537</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100100 is 454996777</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100200 is 455898156</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100300 is 456700218</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100400 is 457603451</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100500 is 458407033</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100600 is 459412387</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100700 is 460217613</span>
    <br>
    <span style="font-size:10pt;">Time elapsed:&nbsp; 4.46900010109 s</span> 
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <div>
     <a href="http://docs.google.com/File?id=dhsstjnc_244d6vv2kgm_b" rel="nofollow" style="color:rgb(0,51,102);text-decoration:none;"><img src="http://docs.google.com/File?id=dhsstjnc_244d6vv2kgm_b" alt="" style="border:0px;"></a>
    </div> 
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    &nbsp;
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    <span style="font-size:10pt;">&nbsp;&nbsp;&nbsp; 将程序稍作调整，引入pp模块。</span>
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(0,51,102);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">!</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;File:&nbsp;sum_primes.py</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Author:&nbsp;VItalii&nbsp;Vanovschi</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Desc:&nbsp;This&nbsp;program&nbsp;demonstrates&nbsp;parallel&nbsp;computations&nbsp;with&nbsp;pp&nbsp;module</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;It&nbsp;calculates&nbsp;the&nbsp;sum&nbsp;of&nbsp;prime&nbsp;numbers&nbsp;below&nbsp;a&nbsp;given&nbsp;integer&nbsp;in&nbsp;parallel</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Parallel&nbsp;Python&nbsp;Software:&nbsp;http://www.parallelpython.com/</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;math,&nbsp;sys,&nbsp;time<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;pp<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">def</span>
     <span style="line-height:1.5;">&nbsp;isprime(n):<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"""</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Returns&nbsp;True&nbsp;if&nbsp;n&nbsp;is&nbsp;prime&nbsp;and&nbsp;False&nbsp;otherwise</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"""</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">not</span>
     <span style="line-height:1.5;">&nbsp;isinstance(n,&nbsp;int):<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">raise</span>
     <span style="line-height:1.5;">&nbsp;TypeError(</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">argument&nbsp;passed&nbsp;to&nbsp;is_prime&nbsp;is&nbsp;not&nbsp;of&nbsp;'int'&nbsp;type</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;n&nbsp;</span>
     <span style="line-height:1.5;">&lt;</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">2</span>
     <span style="line-height:1.5;">:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">return</span>
     <span style="line-height:1.5;">&nbsp;False<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;n&nbsp;</span>
     <span style="line-height:1.5;">==</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">2</span>
     <span style="line-height:1.5;">:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">return</span>
     <span style="line-height:1.5;">&nbsp;True<br> &nbsp;&nbsp;&nbsp;&nbsp;max&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;int(math.ceil(math.sqrt(n)))<br> &nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">2</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">while</span>
     <span style="line-height:1.5;">&nbsp;i&nbsp;</span>
     <span style="line-height:1.5;">&lt;=</span>
     <span style="line-height:1.5;">&nbsp;max:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;n&nbsp;</span>
     <span style="line-height:1.5;">%</span>
     <span style="line-height:1.5;">&nbsp;i&nbsp;</span>
     <span style="line-height:1.5;">==</span>
     <span style="line-height:1.5;">&nbsp;0:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">return</span>
     <span style="line-height:1.5;">&nbsp;False<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;</span>
     <span style="line-height:1.5;">+=</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">1</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">return</span>
     <span style="line-height:1.5;">&nbsp;True<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">def</span>
     <span style="line-height:1.5;">&nbsp;sum_primes(n):<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"""</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Calculates&nbsp;sum&nbsp;of&nbsp;all&nbsp;primes&nbsp;below&nbsp;given&nbsp;integer&nbsp;n</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"""</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">return</span>
     <span style="line-height:1.5;">&nbsp;sum([x&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;x&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;xrange(</span>
     <span style="line-height:1.5;">2</span>
     <span style="line-height:1.5;">,n)&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;isprime(x)])<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"""</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Usage:&nbsp;python&nbsp;sum_primes.py&nbsp;[ncpus]<br> &nbsp;&nbsp;&nbsp;&nbsp;[ncpus]&nbsp;-&nbsp;the&nbsp;number&nbsp;of&nbsp;workers&nbsp;to&nbsp;run&nbsp;in&nbsp;parallel,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;omitted&nbsp;it&nbsp;will&nbsp;be&nbsp;set&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;processors&nbsp;in&nbsp;the&nbsp;system<br></span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"""</span>
     <span style="line-height:1.5;"><br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;tuple&nbsp;of&nbsp;all&nbsp;parallel&nbsp;python&nbsp;servers&nbsp;to&nbsp;connect&nbsp;with</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">ppservers&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;()<br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">ppservers&nbsp;=&nbsp;("10.0.0.1",)</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;len(sys.argv)&nbsp;</span>
     <span style="line-height:1.5;">&gt;</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">1</span>
     <span style="line-height:1.5;">:<br> &nbsp;&nbsp;&nbsp;&nbsp;ncpus&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;int(sys.argv[</span>
     <span style="line-height:1.5;">1</span>
     <span style="line-height:1.5;">])<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Creates&nbsp;jobserver&nbsp;with&nbsp;ncpus&nbsp;workers</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;job_server&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;pp.Server(ncpus,&nbsp;ppservers</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">ppservers)<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">else</span>
     <span style="line-height:1.5;">:<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Creates&nbsp;jobserver&nbsp;with&nbsp;automatically&nbsp;detected&nbsp;number&nbsp;of&nbsp;workers</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;job_server&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;pp.Server(ppservers</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">ppservers)<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Starting&nbsp;pp&nbsp;with</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;job_server.get_ncpus(),&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">workers</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;"><br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Submit&nbsp;a&nbsp;job&nbsp;of&nbsp;calulating&nbsp;sum_primes(100)&nbsp;for&nbsp;execution.&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;sum_primes&nbsp;-&nbsp;the&nbsp;function</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;(100,)&nbsp;-&nbsp;tuple&nbsp;with&nbsp;arguments&nbsp;for&nbsp;sum_primes</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;(isprime,)&nbsp;-&nbsp;tuple&nbsp;with&nbsp;functions&nbsp;on&nbsp;which&nbsp;function&nbsp;sum_primes&nbsp;depends</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;("math",)&nbsp;-&nbsp;tuple&nbsp;with&nbsp;module&nbsp;names&nbsp;which&nbsp;must&nbsp;be&nbsp;imported&nbsp;before&nbsp;sum_primes&nbsp;execution</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Execution&nbsp;starts&nbsp;as&nbsp;soon&nbsp;as&nbsp;one&nbsp;of&nbsp;the&nbsp;workers&nbsp;will&nbsp;become&nbsp;available</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">job1&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;job_server.submit(sum_primes,&nbsp;(</span>
     <span style="line-height:1.5;">100</span>
     <span style="line-height:1.5;">,),&nbsp;(isprime,),&nbsp;(</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">math</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,))<br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Retrieves&nbsp;the&nbsp;result&nbsp;calculated&nbsp;by&nbsp;job1</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;The&nbsp;value&nbsp;of&nbsp;job1()&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;sum_primes(100)</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;If&nbsp;the&nbsp;job&nbsp;has&nbsp;not&nbsp;been&nbsp;finished&nbsp;yet,&nbsp;execution&nbsp;will&nbsp;wait&nbsp;here&nbsp;until&nbsp;result&nbsp;is&nbsp;available</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">result&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;job1()<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Sum&nbsp;of&nbsp;primes&nbsp;below&nbsp;100&nbsp;is</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;result<br> start_time&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;time.time()<br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;The&nbsp;following&nbsp;submits&nbsp;8&nbsp;jobs&nbsp;and&nbsp;then&nbsp;retrieves&nbsp;the&nbsp;results</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">inputs&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;(</span>
     <span style="line-height:1.5;">100000</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100100</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100200</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100300</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100400</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100500</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100600</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="line-height:1.5;">100700</span>
     <span style="line-height:1.5;">)<br> jobs&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;[(input,&nbsp;job_server.submit(sum_primes,(input,),&nbsp;(isprime,),&nbsp;(</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">math</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,)))&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;input&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;inputs]<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;input,&nbsp;job&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;jobs:<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Sum&nbsp;of&nbsp;primes&nbsp;below</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;input,&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">is</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;job()<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Time&nbsp;elapsed:&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;time.time()&nbsp;</span>
     <span style="line-height:1.5;">-</span>
     <span style="line-height:1.5;">&nbsp;start_time,&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">s</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;"><br> job_server.print_stats()</span> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(0,51,102);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    &nbsp;
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    <span style="font-size:10pt;">&nbsp;&nbsp;&nbsp; 再次执行，任务管理器中两个CPU进程齐头并进，咱们不仅仅需要所有CPU努力干活，而且还需得到非常好的效果，通过简单的"time.time() - start_time"发现时间比之前缩短了近100%为2.26600003242，job_server.print_stats()能够得到更加详细的分析结果：</span>
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <span style="font-size:10pt;">Starting pp with 2 workers</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100 is 1060</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100000 is 454396537</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100100 is 454996777</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100200 is 455898156</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100300 is 456700218</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100400 is 457603451</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100500 is 458407033</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100600 is 459412387</span>
    <br>
    <span style="font-size:10pt;">Sum of primes below 100700 is 460217613</span>
    <br>
    <span style="font-size:10pt;">Time elapsed:&nbsp; 2.26600003242 s</span>
    <br>
    <span style="font-size:10pt;">Job execution statistics:</span>
    <br>
    <span style="font-size:10pt;">&nbsp;job count | % of all jobs | job time sum | time per job | job server</span>
    <br>
    <span style="font-size:10pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 100.00 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3.9700 |&nbsp;&nbsp;&nbsp;&nbsp; 0.441111 | local</span> 
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <div>
     <a href="http://docs.google.com/File?id=dhsstjnc_245hkc7jbc7_b" rel="nofollow" style="color:rgb(0,51,102);text-decoration:none;"><img src="http://docs.google.com/File?id=dhsstjnc_245hkc7jbc7_b" alt="" style="border:0px;"></a>
    </div> 
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <br>
    <span style="font-size:10pt;">&nbsp;&nbsp;&nbsp; 看到这样的测试结果，还来不及尝试多计算机的集群计算，就开始好奇该模块在ArcGIS Python空间计算中的应用效果。动手之前先想想问题吧，ArcGIS Python实际上是对粗粒度AO对象的调用，真正的计算压力实际上是在COM里面，而Parallel Python针对的是原生Python脚本中产生的计算量，所以应该不会有明显的性能提升，实践出真理，怎么都得写个Sample测试一番：将指定文件夹内所有personal geodatabase的空间数据拷贝到相应的file geodatabase中，以全国400万数据为例。</span> 
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(0,51,102);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Import&nbsp;native&nbsp;arcgisscripting&nbsp;module</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;arcgisscripting<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;os<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;time<br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;import&nbsp;sys</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Create&nbsp;the&nbsp;geoprocessor&nbsp;object</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #<br></span>
     <span style="line-height:1.5;">gp&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;arcgisscripting.create(</span>
     <span style="line-height:1.5;">9.3</span>
     <span style="line-height:1.5;">)<br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Allow&nbsp;for&nbsp;the&nbsp;overwriting&nbsp;of&nbsp;file&nbsp;geodatabases,&nbsp;if&nbsp;they&nbsp;previously&nbsp;exist</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #<br></span>
     <span style="line-height:1.5;">gp.OverWriteOutput&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">1</span>
     <span style="line-height:1.5;"><br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Set&nbsp;workspace&nbsp;to&nbsp;folder&nbsp;containing&nbsp;personal&nbsp;geodatabases</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #<br> #</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;gp.Workspace&nbsp;=&nbsp;sys.argv[1]</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">gp.workspace&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">D:\\Dev\\Python\\pp\\arcgis_test</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;"><br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Identify&nbsp;personal&nbsp;geodatabases</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br> #<br></span>
     <span style="line-height:1.5;">pgdbs&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;gp.ListWorkspaces(</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">""</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Access</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">)<br> start_time&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;time.time()<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;pgdb&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;pgdbs:<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Set&nbsp;workspace&nbsp;to&nbsp;current&nbsp;personal&nbsp;geodatabase</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;gp.workspace&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;pgdb<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Create&nbsp;file&nbsp;geodatabase&nbsp;based&nbsp;on&nbsp;personal&nbsp;geodatabase</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;fgdb&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;pgdb[:</span>
     <span style="line-height:1.5;">-</span>
     <span style="line-height:1.5;">4</span>
     <span style="line-height:1.5;">]&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">.gdb</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;gp.CreateFileGDB(os.path.dirname(fgdb),&nbsp;os.path.basename(fgdb))<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Identify&nbsp;feature&nbsp;classes&nbsp;and&nbsp;copy&nbsp;to&nbsp;file&nbsp;gdb</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;fcs&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;gp.ListFeatureClasses()<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;fc&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;fcs:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Copying&nbsp;feature&nbsp;class&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;fc&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">&nbsp;to&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;fgdb<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gp.Copy(fc,&nbsp;fgdb&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;os.sep&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;fc)<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Identify&nbsp;tables&nbsp;and&nbsp;copy&nbsp;to&nbsp;file&nbsp;gdb</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;tables&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;gp.ListTables()<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;table&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;tables:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Copying&nbsp;table&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;table&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">&nbsp;to&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;fgdb<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gp.Copy(table,&nbsp;fgdb&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;os.sep&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;table)<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Identify&nbsp;datasets&nbsp;and&nbsp;copy&nbsp;to&nbsp;file&nbsp;gdb</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;&nbsp;&nbsp;Copy&nbsp;will&nbsp;include&nbsp;contents&nbsp;of&nbsp;datasets</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;datasets&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;gp.ListDatasets()<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;dataset&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;datasets:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Copying&nbsp;dataset&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;dataset&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">&nbsp;to&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;fgdb<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gp.Copy(dataset,&nbsp;fgdb&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;os.sep&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;dataset)<br> &nbsp;&nbsp;&nbsp;&nbsp;<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Time&nbsp;elapsed:&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;time.time()&nbsp;</span>
     <span style="line-height:1.5;">-</span>
     <span style="line-height:1.5;">&nbsp;start_time,&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">s</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(0,51,102);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <br>
    <span style="font-size:10pt;">计算完成后消耗时间为73.453999962s，引入pp模块。</span> 
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;"> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(0,51,102);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;arcgisscripting<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;pp<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;os<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;time<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">import</span>
     <span style="line-height:1.5;">&nbsp;sys<br><br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">def</span>
     <span style="line-height:1.5;">&nbsp;func(ws&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">D:\\Dev\\Python\\pp\\arcgis_test</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">):<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Create&nbsp;the&nbsp;geoprocessor&nbsp;object</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;gp&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;arcgisscripting.create(</span>
     <span style="line-height:1.5;">9.3</span>
     <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Allow&nbsp;for&nbsp;the&nbsp;overwriting&nbsp;of&nbsp;file&nbsp;geodatabases,&nbsp;if&nbsp;they&nbsp;previously&nbsp;exist</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;gp.OverWriteOutput&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">1</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Set&nbsp;workspace&nbsp;to&nbsp;folder&nbsp;containing&nbsp;personal&nbsp;geodatabases</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;gp.Workspace&nbsp;=&nbsp;sys.argv[1]</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;gp.workspace&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;ws<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Identify&nbsp;personal&nbsp;geodatabases</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;pgdbs&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;gp.ListWorkspaces(</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">""</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Access</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">)<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;pgdb&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;pgdbs:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Set&nbsp;workspace&nbsp;to&nbsp;current&nbsp;personal&nbsp;geodatabase</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gp.workspace&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;pgdb<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Create&nbsp;file&nbsp;geodatabase&nbsp;based&nbsp;on&nbsp;personal&nbsp;geodatabase</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fgdb&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;pgdb[:</span>
     <span style="line-height:1.5;">-</span>
     <span style="line-height:1.5;">4</span>
     <span style="line-height:1.5;">]&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">.gdb</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gp.CreateFileGDB(os.path.dirname(fgdb),&nbsp;os.path.basename(fgdb))<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Identify&nbsp;feature&nbsp;classes&nbsp;and&nbsp;copy&nbsp;to&nbsp;file&nbsp;gdb</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcs&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;gp.ListFeatureClasses()<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;fc&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;fcs:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Copying&nbsp;feature&nbsp;class&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;fc&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">&nbsp;to&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;fgdb<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gp.Copy(fc,&nbsp;fgdb&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;os.sep&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;fc)<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Identify&nbsp;tables&nbsp;and&nbsp;copy&nbsp;to&nbsp;file&nbsp;gdb</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tables&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;gp.ListTables()<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;table&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;tables:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Copying&nbsp;table&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;table&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">&nbsp;to&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;fgdb<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gp.Copy(table,&nbsp;fgdb&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;os.sep&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;table)<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Identify&nbsp;datasets&nbsp;and&nbsp;copy&nbsp;to&nbsp;file&nbsp;gdb</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;&nbsp;&nbsp;Copy&nbsp;will&nbsp;include&nbsp;contents&nbsp;of&nbsp;datasets</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#<br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datasets&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;gp.ListDatasets()<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">for</span>
     <span style="line-height:1.5;">&nbsp;dataset&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">in</span>
     <span style="line-height:1.5;">&nbsp;datasets:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Copying&nbsp;dataset&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;dataset&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">&nbsp;to&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;fgdb<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gp.Copy(dataset,&nbsp;fgdb&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;os.sep&nbsp;</span>
     <span style="line-height:1.5;">+</span>
     <span style="line-height:1.5;">&nbsp;dataset)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;tuple&nbsp;of&nbsp;all&nbsp;parallel&nbsp;python&nbsp;servers&nbsp;to&nbsp;connect&nbsp;with</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">ppservers&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;()<br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">ppservers&nbsp;=&nbsp;("10.0.0.1",)</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;"><br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">if</span>
     <span style="line-height:1.5;">&nbsp;len(sys.argv)&nbsp;</span>
     <span style="line-height:1.5;">&gt;</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="line-height:1.5;">1</span>
     <span style="line-height:1.5;">:<br> &nbsp;&nbsp;&nbsp;&nbsp;ncpus&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;int(sys.argv[</span>
     <span style="line-height:1.5;">1</span>
     <span style="line-height:1.5;">])<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Creates&nbsp;jobserver&nbsp;with&nbsp;ncpus&nbsp;workers</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;job_server&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;pp.Server(ncpus,&nbsp;ppservers</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">ppservers)<br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">else</span>
     <span style="line-height:1.5;">:<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;Creates&nbsp;jobserver&nbsp;with&nbsp;automatically&nbsp;detected&nbsp;number&nbsp;of&nbsp;workers</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;job_server&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;pp.Server(ppservers</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">ppservers)<br><br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Starting&nbsp;pp&nbsp;with</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;job_server.get_ncpus(),&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">workers</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;"><br><br> start_time&nbsp;</span>
     <span style="line-height:1.5;">=</span>
     <span style="line-height:1.5;">&nbsp;time.time()<br><br></span>
     <span style="color:rgb(0,128,0);line-height:1.5;">#</span>
     <span style="color:rgb(0,128,0);line-height:1.5;">&nbsp;job1&nbsp;=&nbsp;job_server.submit(sum_primes,&nbsp;(100,),&nbsp;(isprime,),&nbsp;("math",))</span>
     <span style="color:rgb(0,128,0);line-height:1.5;"><br></span>
     <span style="line-height:1.5;">job_server.submit(func(),&nbsp;(</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">D:\\Dev\\Python\\pp\\arcgis_test</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;),&nbsp;(),&nbsp;(</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">arcgisscripting</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">os</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">))<br><br></span>
     <span style="color:rgb(0,0,255);line-height:1.5;">print</span>
     <span style="line-height:1.5;">&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">Time&nbsp;elapsed:&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;">,&nbsp;time.time()&nbsp;</span>
     <span style="line-height:1.5;">-</span>
     <span style="line-height:1.5;">&nbsp;start_time,&nbsp;</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">s</span>
     <span style="color:rgb(128,0,0);line-height:1.5;">"</span>
     <span style="line-height:1.5;"><br> job_server.print_stats()<br><br></span> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(0,51,102);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> &nbsp;
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    <span style="font-size:10pt;">&nbsp;&nbsp;&nbsp; 时间几乎相同，没有太大变化，这也证明了最初的分析，看来提升ArcGIS Python应用效率还得从根本入手，当然也有可能是对Parallel Python和Python多线程处理了解不够深入，关于Parallel Python的问题，网上有一些说法：</span>
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    <span style="font-size:10pt;">&nbsp;&nbsp;&nbsp; 1.如果数据交换存在瓶颈，大数据量的应用效果不明显，或反而效率更低。</span>
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    <span style="font-size:10pt;">&nbsp;&nbsp;&nbsp; 2.高计算复杂度的应用效果不明显，ArcGIS Python中的分析计算恰好属于此类。</span>
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    &nbsp;
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    <span style="font-size:10pt;">&nbsp;&nbsp;&nbsp; 当然测试脚本针对的主要是空间数据拷贝的操作，如果不死心还可以试试空间分析。接着深入，待续吧。</span>
   </div> 
   <div style="font-family:palatino, georgia, verdana, arial, sans-serif;font-size:13.5px;">
    <span style="font-size:10pt;"><br></span>
   </div> 
   <div> 
    <font><span style="font-size:13.3333px;">本文转自Flyingis博客园博客，原文链接：http://www.cnblogs.com/flyingis/archive/2009/11/12/1601574.html，如需转载请自行联系原作者</span></font>
    <br>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
