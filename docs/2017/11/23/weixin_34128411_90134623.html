<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>【转】MFC中listctrl控件的常用详细总结 « NotBeCN</title>
  <meta name="description" content="                        以下未经说明，listctrl默认view 风格为report      相关类及处理函数      MFC：CListCtrl类      SDK：以 “ListView_”开头的一些宏。如 ListView_InsertColumn      ---------...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/23/weixin_34128411_90134623.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">【转】MFC中listctrl控件的常用详细总结</h1>
    <p class="post-meta">Nov 23, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body" style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;"> 
    <div style="line-height:1.5;"> 
     <p style="line-height:1.5;">以下未经说明，listctrl默认view 风格为<strong>report</strong></p> 
     <p style="line-height:1.5;">相关类及处理函数</p> 
     <p style="line-height:1.5;">MFC：CListCtrl类</p> 
     <p style="line-height:1.5;">SDK：以 “ListView_”开头的一些宏。如 ListView_InsertColumn</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">1. CListCtrl 风格<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LVS_ICON: 为每个item显示大图标<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LVS_SMALLICON: 为每个item显示小图标<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LVS_LIST: 显示一列带有小图标的item<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LVS_REPORT: 显示item详细资料</p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 直观的理解：windows资源管理器，“查看”标签下的“大图标，小图标，列表，详细资料”</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">2. 设置listctrl 风格及扩展风格<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LONG lStyle;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lStyle = GetWindowLong(m_list.m_hWnd, GWL_STYLE);//获取当前窗口style<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lStyle &amp;= ~LVS_TYPEMASK; //清除显示方式位<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lStyle |= LVS_REPORT; //设置style<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetWindowLong(m_list.m_hWnd, GWL_STYLE, lStyle);//设置style<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DWORD dwStyle = m_list.GetExtendedStyle();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dwStyle |= LVS_EX_FULLROWSELECT;//选中某行使整行高亮（只适用与report风格的listctrl）<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dwStyle |= LVS_EX_GRIDLINES;//网格线（只适用与report风格的listctrl）<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dwStyle |= LVS_EX_CHECKBOXES;//item前生成checkbox控件<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.SetExtendedStyle(dwStyle); //设置扩展风格<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 注：listview的style请查阅msdn<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wceshellui5/html/wce50lrflistviewstyles.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wceshellui5/html/wce50lrflistviewstyles.asp</span></a></p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">3. 插入数据<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.InsertColumn( 0, "ID", LVCFMT_LEFT, 40 );//插入列<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.InsertColumn( 1, "NAME", LVCFMT_LEFT, 50 );<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int nRow = m_list.InsertItem(0, “11”);//插入行<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.SetItemText(nRow, 1, “jacky”);//设置数据</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">4. 一直选中item<br> &nbsp;&nbsp;&nbsp; 选中style中的Show selection always，或者在上面第2点中设置LVS_SHOWSELALWAYS</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">5. 选中和取消选中一行<br> &nbsp;&nbsp;&nbsp; int nIndex = 0;<br> &nbsp;&nbsp;&nbsp; //选中<br> &nbsp;&nbsp;&nbsp; m_list.SetItemState(nIndex, LVIS_SELECTED|LVIS_FOCUSED, LVIS_SELECTED|LVIS_FOCUSED);<br> &nbsp;&nbsp;&nbsp; //取消选中<br> &nbsp;&nbsp;&nbsp; m_list.SetItemState(nIndex, 0, LVIS_SELECTED|LVIS_FOCUSED);<br> &nbsp;<br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">6. 得到listctrl中所有行的checkbox的状态<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.SetExtendedStyle(LVS_EX_CHECKBOXES);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString str;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(int i=0; i&lt;m_list.GetItemCount(); i++)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if( m_list.GetItemState(i, LVIS_SELECTED) == LVIS_SELECTED || m_list.GetCheck(i))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.Format(_T("第%d行的checkbox为选中状态"), i);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AfxMessageBox(str);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">7. 得到listctrl中所有选中行的序号</p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 方法一：<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString str;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(int i=0; i&lt;m_list.GetItemCount(); i++)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if( m_list.GetItemState(i, LVIS_SELECTED) == LVIS_SELECTED )<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str.Format(_T("选中了第%d行"), i);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AfxMessageBox(str);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 方法二：<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POSITION pos = m_list.GetFirstSelectedItemPosition();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (pos == NULL)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TRACE0("No items were selected!\n");<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (pos)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int nItem = m_list.GetNextSelectedItem(pos);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TRACE1("Item %d was selected!\n", nItem);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // you could do your own processing on nItem here<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">8. 得到item的信息<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TCHAR szBuf[1024];<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LVITEM lvi;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvi.iItem = nItemIndex;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvi.iSubItem = 0;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvi.mask = LVIF_TEXT;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvi.pszText = szBuf;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvi.cchTextMax = 1024;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.GetItem(&amp;lvi);</p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 关于得到设置item的状态，还可以参考msdn文章<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Q173242: Use Masks to Set/Get Item States in CListCtrl<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://support.microsoft.com/kb/173242/en-us" rel="nofollow" style="color:rgb(68,68,68);"><span>http://support.microsoft.com/kb/173242/en-us</span></a></p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">9. 得到listctrl的所有列的header字符串内容<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LVCOLUMN lvcol;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char&nbsp; str[256];<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int&nbsp;&nbsp; nColNum;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString&nbsp; strColumnName[4];//假如有4列</p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nColNum = 0;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvcol.mask = LVCF_TEXT;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvcol.pszText = str;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvcol.cchTextMax = 256;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while(m_list.GetColumn(nColNum, &amp;lvcol))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strColumnName[nColNum] = lvcol.pszText;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; nColNum++;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">10. 使listctrl中一项可见，即滚动滚动条<br> &nbsp;&nbsp;&nbsp; m_list.EnsureVisible(i, FALSE);</p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">11. 得到listctrl列数<br> &nbsp;&nbsp;&nbsp; int nHeadNum = m_list.GetHeaderCtrl()-&gt;GetItemCount();</p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">12. 删除所有列<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 方法一：<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while ( m_list.DeleteColumn (0))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 因为你删除了第一列后，后面的列会依次向上移动。</p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 方法二：<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int nColumns = 4;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i=nColumns-1; i&gt;=0; i--)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.DeleteColumn (i);</p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">13. 得到单击的listctrl的行列号<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 添加listctrl控件的NM_CLICK消息相应函数<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void CTest6Dlg::OnClickList1(NMHDR* pNMHDR, LRESULT* pResult)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 方法一：<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 方法二:<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *pResult = 0;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">14. 判断是否点击在listctrl的checkbox上<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 添加listctrl控件的NM_CLICK消息相应函数<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void CTest6Dlg::OnClickList1(NMHDR* pNMHDR, LRESULT* pResult)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DWORD dwPos = GetMessagePos();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CPoint point( LOWORD(dwPos), HIWORD(dwPos) );<br> &nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.ScreenToClient(&amp;point);<br> &nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LVHITTESTINFO lvinfo;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvinfo.pt = point;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvinfo.flags = LVHT_ABOVE;<br> &nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UINT nFlag;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int nItem = m_list.HitTest(point, &amp;nFlag);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //判断是否点在checkbox上<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(nFlag == LVHT_ONITEMSTATEICON)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AfxMessageBox("点在listctrl的checkbox上");<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *pResult = 0;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">15. 右键点击listctrl的item弹出菜单<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 添加listctrl控件的NM_RCLICK消息相应函数<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void CTest6Dlg::OnRclickList1(NMHDR* pNMHDR, LRESULT* pResult)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NM_LISTVIEW* pNMListView = (NM_LISTVIEW*)pNMHDR;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(pNMListView-&gt;iItem != -1)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DWORD dwPos = GetMessagePos();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CPoint point( LOWORD(dwPos), HIWORD(dwPos) );<br> &nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CMenu menu;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VERIFY( menu.LoadMenu( IDR_MENU1 ) );<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CMenu* popup = menu.GetSubMenu(0);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ASSERT( popup != NULL );<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popup-&gt;TrackPopupMenu(TPM_LEFTALIGN | TPM_RIGHTBUTTON, point.x, point.y, this );<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *pResult = 0;<br> &nbsp; }</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">16. item切换焦点时(包括用键盘和鼠标切换item时)，状态的一些变化顺序<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 添加listctrl控件的LVN_ITEMCHANGED消息相应函数<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void CTest6Dlg::OnItemchangedList1(NMHDR* pNMHDR, LRESULT* pResult)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NM_LISTVIEW* pNMListView = (NM_LISTVIEW*)pNMHDR;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // TODO: Add your control notification handler code here<br> &nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString sTemp;<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if((pNMListView-&gt;uOldState &amp; LVIS_FOCUSED) == LVIS_FOCUSED &amp;&amp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (pNMListView-&gt;uNewState &amp; LVIS_FOCUSED) == 0)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sTemp.Format("%d losted focus",pNMListView-&gt;iItem);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if((pNMListView-&gt;uOldState &amp; LVIS_FOCUSED) == 0 &amp;&amp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (pNMListView-&gt;uNewState &amp; LVIS_FOCUSED) == LVIS_FOCUSED)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sTemp.Format("%d got focus",pNMListView-&gt;iItem);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if((pNMListView-&gt;uOldState &amp; LVIS_SELECTED) == LVIS_SELECTED &amp;&amp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (pNMListView-&gt;uNewState &amp; LVIS_SELECTED) == 0)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sTemp.Format("%d losted selected",pNMListView-&gt;iItem);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if((pNMListView-&gt;uOldState &amp; LVIS_SELECTED) == 0 &amp;&amp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (pNMListView-&gt;uNewState &amp; LVIS_SELECTED) == LVIS_SELECTED)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sTemp.Format("%d got selected",pNMListView-&gt;iItem);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *pResult = 0;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">17. 得到另一个进程里的listctrl控件的item内容<br><a href="http://www.codeproject.com/threads/int64_memsteal.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/threads/int64_memsteal.asp</span></a></p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">18. 选中listview中的item<br> Q131284: How To Select a Listview Item Programmatically<br><a href="http://support.microsoft.com/kb/131284/en-us" rel="nofollow" style="color:rgb(68,68,68);"><span>http://support.microsoft.com/kb/131284/en-us</span></a></p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">19. 如何在CListView中使用CListCtrl的派生类<br><a href="http://www.codeguru.com/cpp/controls/listview/introduction/article.php/c919/" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeguru.com/cpp/controls/listview/introduction/article.php/c919/</span></a><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">20. listctrl的subitem添加图标<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.SetExtendedStyle(LVS_EX_SUBITEMIMAGES);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.SetItem(..); //具体参数请参考msdn<br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">21. 在CListCtrl显示文件，并根据文件类型来显示图标<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 网上找到的代码，share<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BOOL CTest6Dlg::OnInitDialog()<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CDialog::OnInitDialog();<br> &nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HIMAGELIST himlSmall;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HIMAGELIST himlLarge;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHFILEINFO sfi;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char&nbsp; cSysDir[MAX_PATH];<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString&nbsp; strBuf;<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memset(cSysDir, 0, MAX_PATH);<br> &nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetWindowsDirectory(cSysDir, MAX_PATH);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strBuf = cSysDir;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sprintf(cSysDir, "%s", strBuf.Left(strBuf.Find("<a style="color:rgb(68,68,68);"><span>\\")+1</span></a>));<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; himlSmall = (HIMAGELIST)SHGetFileInfo ((LPCSTR)cSysDir,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;sfi,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sizeof(SHFILEINFO),&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHGFI_SYSICONINDEX | SHGFI_SMALLICON );<br> &nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; himlLarge = (HIMAGELIST)SHGetFileInfo((LPCSTR)cSysDir,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;sfi,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sizeof(SHFILEINFO),&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHGFI_SYSICONINDEX | SHGFI_LARGEICON);<br> &nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (himlSmall &amp;&amp; himlLarge)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ::SendMessage(m_list.m_hWnd, LVM_SETIMAGELIST,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (WPARAM)LVSIL_SMALL, (LPARAM)himlSmall);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ::SendMessage(m_list.m_hWnd, LVM_SETIMAGELIST,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (WPARAM)LVSIL_NORMAL, (LPARAM)himlLarge);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return TRUE;&nbsp; // return TRUE&nbsp; unless you set the focus to a control<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void CTest6Dlg::AddFiles(LPCTSTR lpszFileName, BOOL bAddToDocument)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int nIcon = GetIconIndex(lpszFileName, FALSE, FALSE);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString strSize;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CFileFind filefind;<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp; get file size<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (filefind.FindFile(lpszFileName))<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filefind.FindNextFile();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strSize.Format("%d", filefind.GetLength());<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strSize = "0";<br> &nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // split path and filename<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString strFileName = lpszFileName;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CString strPath;<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int nPos = strFileName.ReverseFind('\\');<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (nPos != -1)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strPath = strFileName.Left(nPos);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strFileName = strFileName.Mid(nPos + 1);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // insert to list<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int nItem = m_list.GetItemCount();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.InsertItem(nItem, strFileName, nIcon);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.SetItemText(nItem, 1, strSize);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.SetItemText(nItem, 2, strFileName.Right(3));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.SetItemText(nItem, 3, strPath);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int CTest6Dlg::GetIconIndex(LPCTSTR lpszPath, BOOL bIsDir, BOOL bSelected)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHFILEINFO sfi;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memset(&amp;sfi, 0, sizeof(sfi));<br> &nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (bIsDir)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHGetFileInfo(lpszPath,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FILE_ATTRIBUTE_DIRECTORY,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;sfi,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sizeof(sfi),&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHGFI_SMALLICON | SHGFI_SYSICONINDEX |<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHGFI_USEFILEATTRIBUTES |(bSelected ? SHGFI_OPENICON : 0));&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return&nbsp; sfi.iIcon;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHGetFileInfo (lpszPath,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FILE_ATTRIBUTE_NORMAL,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;sfi,&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sizeof(sfi),&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHGFI_SMALLICON | SHGFI_SYSICONINDEX |&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHGFI_USEFILEATTRIBUTES | (bSelected ? SHGFI_OPENICON : 0));<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return&nbsp;&nbsp; sfi.iIcon;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return&nbsp; -1;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">22. listctrl内容进行大数据量更新时，避免闪烁<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.SetRedraw(FALSE);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //更新内容<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.SetRedraw(TRUE);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.Invalidate();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_list.UpdateWindow();<br> 或者参考<br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vclib/html/_mfc_cwnd.3a3a.setredraw.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vclib/html/_mfc_cwnd.3a3a.setredraw.asp</span></a></p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">列表控件可以看作是功能增强的ListBox，它提供了四种风格，而且可以同时显示一列的多中属性值。MFC中使用CListCtrl类来封装列表控件的各种操作。通过调用 BOOL Create( DWORD dwStyle, const RECT&amp; rect, CWnd* pParentWnd, UINT nID );创建一个窗口，dwStyle中可以使用以下一些列表控件的专用风格：</p> 
     <p style="line-height:1.5;">LVS_ICON LVS_SMALLICON LVS_LIST LVS_REPORT 这四种风格决定控件的外观，同时只可以选择其中一种，分别对应：大图标显示，小图标显示，列表显示，详细报表显示<br> LVS_EDITLABELS 结点的显示字符可以被编辑，对于报表风格来讲可编辑的只为第一列。<br> LVS_SHOWSELALWAYS 在失去焦点时也显示当前选中的结点<br> LVS_SINGLESEL 同时只能选中列表中一项<br> 首先你需要设置列表控件所使用的ImageList，如果你使用大图标显示风格，你就需要以如下形式调用： CImageList* SetImageList( CImageList* pImageList, LVSIL_NORMAL); 如果使用其它三种风格显示而不想显示图标你可以不进行任何设置，否则需要以如下形式调用： CImageList* SetImageList( CImageList* pImageList, LVSIL_SMALL);<br> 通过调用int InsertItem( int nItem, LPCTSTR lpszItem );可以在列表控件中nItem指明位置插入一项，lpszItem为显示字符。除LVS_REPORT风格外其他三种风格都只需要直接调用 InsertItem就可以了，但如果使用报表风格就必须先设置列表控件中的列信息。</p> 
     <p style="line-height:1.5;">通过调用int InsertColumn( int nCol, LPCTSTR lpszColumnHeading, int nFormat , int nWidth, int nSubItem);可以插入列。iCol为列的位置，从零开始，lpszColumnHeading为显示的列名，nFormat为显示对齐方式， nWidth为显示宽度，nSubItem为分配给该列的列索引。</p> 
     <p style="line-height:1.5;">在有多列的列表控件中就需要为每一项指明其在每一列中的显示字符，通过调用 BOOL SetItemText( int nItem, int nSubItem, LPTSTR lpszText );可以设置每列的显示字符。nItem为设置的项的位置，nSubItem为列位置，lpszText为显示字符。下面的代码演示了如何设置多列并插入数据：</p> 
     <p style="line-height:1.5;">m_list.SetImageList(&amp;m_listSmall,LVSIL_SMALL);//设置ImageList<br> m_list.InsertColumn(0,"Col 1",LVCFMT_LEFT,300,0);//设置列<br> m_list.InsertColumn(1,"Col 2",LVCFMT_LEFT,300,1);<br> m_list.InsertColumn(2,"Col 3",LVCFMT_LEFT,300,2);</p> 
     <p style="line-height:1.5;">m_list.InsertItem(0,"Item 1_1");//插入行<br> m_list.SetItemText(0,1,"Item 1_2");//设置该行的不同列的显示字符<br> m_list.SetItemText(0,2,"Item 1_3");<br> 此外CListCtrl还提供了一些函数用于得到/修改控件的状态。 COLORREF GetTextColor( )/BOOL SetTextColor( COLORREF cr );用于得到/设置显示的字符颜色。 COLORREF GetTextBkColor( )/BOOL SetTextBkColor( COLORREF cr );用于得到/设置显示的背景颜色。 void SetItemCount( int iCount );用于得到添加进列表中项的数量。 BOOL DeleteItem(int nItem);用于删除某一项，BOOL DeleteAllItems( );将删除所有项。 BOOL SetBkImage(HBITMAP hbm, BOOL fTile , int xOffsetPercent, int yOffsetPercent);用于设置背景位图。 CString GetItemText( int nItem, int nSubItem );用于得到某项的显示字符。</p> 
     <p style="line-height:1.5;">列表控件的消息映射同样使用ON_NOTIFY宏，形式如同：ON_NOTIFY( wNotifyCode, id, memberFxn )，wNotifyCode为通知代码，id为产生该消息的窗口ID，memberFxn为处理函数，函数的原型如同void OnXXXList(NMHDR* pNMHDR, LRESULT* pResult)，其中pNMHDR为一数据结构，在具体使用时需要转换成其他类型的结构。对于列表控件可能取值和对应的数据结构为：</p> 
     <p style="line-height:1.5;">LVN_BEGINLABELEDIT 在开始某项编辑字符时发送，所用结构：NMLVDISPINFO<br> LVN_ENDLABELEDIT 在结束某项编辑字符时发送，所用结构：NMLVDISPINFO<br> LVN_GETDISPINFO 在需要得到某项信息时发送，（如得到某项的显示字符）所用结构：NMLVDISPINFO<br> 关于ON_NOTIFY有很多内容，将在以后的内容中进行详细讲解。<br> 关于动态提供结点所显示的字符：首先你在项时需要指明lpszItem参数为： LPSTR_TEXTCALLBACK。在控件显示该结点时会通过发送TVN_GETDISPINFO来取得所需要的字符，在处理该消息时先将参数 pNMHDR转换为LPNMLVDISPINFO，然后填充其中item.pszText。通过item中的iItem,iSubItem可以知道当前显示的为那一项。下面的代码演示了这种方法：</p> 
     <p style="line-height:1.5;">char szOut[8][3]={"No.1","No.2","No.3"};</p> 
     <p style="line-height:1.5;">//添加结点<br> m_list.InsertItem(LPSTR_TEXTCALLBACK,...)<br> m_list.InsertItem(LPSTR_TEXTCALLBACK,...)<br> //处理消息<br> void CParentWnd::OnGetDispInfoList(NMHDR* pNMHDR, LRESULT* pResult)<br> {<br> &nbsp;LV_DISPINFO* pLVDI = (LV_DISPINFO*)pNMHDR;<br> &nbsp;pLVDI-&gt;item.pszText=szOut[pTVDI-&gt;item.iItem];//通过iItem得到需要显示的字符在数组中的位置<br> &nbsp;*pResult = 0;<br> }<br> 关于编辑某项的显示字符：（在报表风格中只对第一列有效）首先需要设置列表控件的 LVS_EDITLABELS风格，在开始编辑时该控件将会发送LVN_BEGINLABELEDIT，你可以通过在处理函数中返回TRUE来取消接下来的编辑，在编辑完成后会发送LVN_ENDLABELEDIT，在处理该消息时需要将参数pNMHDR转换为LPNMLVDISPINFO，然后通过其中的item.pszText得到编辑后的字符，并重置显示字符。如果编辑在中途中取消该变量为NULL。下面的代码说明如何处理这些消息：</p> 
     <p style="line-height:1.5;">//处理消息 LVN_BEGINLABELEDIT<br> void CParentWnd::OnBeginEditList(NMHDR* pNMHDR, LRESULT* pResult)<br> {<br> &nbsp;LV_DISPINFO* pLVDI = (LV_DISPINFO*)pNMHDR;<br> &nbsp;if(pLVDI-&gt;item.iItem==0);//判断是否取消该操作<br> &nbsp; *pResult = 1;<br> &nbsp;else<br> &nbsp; *pResult = 0;<br> }<br> //处理消息 LVN_BEGINLABELEDIT<br> void CParentWnd::OnBeginEditList(NMHDR* pNMHDR, LRESULT* pResult)<br> {<br> &nbsp;LV_DISPINFO* pLVDI = (LV_DISPINFO*)pNMHDR;<br> &nbsp;if(pLVDI-&gt;item.pszText==NULL);//判断是否已经取消取消编辑<br> &nbsp; m_list.SetItemText(pLVDI-&gt;item.iItem,0,pLVDI-&gt;pszText);//重置显示字符<br> &nbsp;*pResult = 0;<br> }<br> 上面讲述的方法所进行的消息映射必须在父窗口中进行（同样WM_NOTIFY的所有消息都需要在父窗口中处理）。<br> 如何得到当前选中项位置：在列表控件中没有一个类似于ListBox中GetCurSel()的函数，但是可以通过调用GetNextItem( -1, LVNI_ALL | LVNI_SELECTED);得到选中项位置。</p> 
     <p style="line-height:1.5;">23. listctrl排序<br> Q250614：How To Sort Items in a CListCtrl in Report View<br><a href="http://support.microsoft.com/kb/250614/en-us" rel="nofollow" style="color:rgb(68,68,68);"><span>http://support.microsoft.com/kb/250614/en-us</span></a></p> 
     <p style="line-height:1.5;"><br> &nbsp;// 排序用的比较函数</p> 
     <p style="line-height:1.5;">static int CALLBACK MyCompareProc(LPARAMlParam1, LPARAMlParam2, LPARAMlParamSort)<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp; CString &amp;lp1 = *((CString *)lParam1);<br> &nbsp;&nbsp;&nbsp;&nbsp; CString &amp;lp2 = *((CString *)lParam2);<br> &nbsp;&nbsp;&nbsp;&nbsp; int &amp;sort = *(int *)lParamSort;<br> &nbsp;&nbsp;&nbsp;&nbsp; if (sort == 0)<br> &nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; returnlp1.CompareNoCase(lp2);<br> &nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp; else<br> &nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; returnlp2.CompareNoCase(lp1);<br> &nbsp;&nbsp;&nbsp;&nbsp; }<br> }<br> //要处理的事件<br> ON_NOTIFY(LVN_COLUMNCLICK, IDC_LIST1, &amp;CDlg::OnLvnColumnclickList1)<br> //处理代码</p> 
     <p style="line-height:1.5;">voidCDlg::OnLvnColumnclickList1(NMHDR *pNMHDR, LRESULT *pResult)<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp; LPNMLISTVIEWpNMLV = reinterpret_cast&lt;LPNMLISTVIEW&gt;(pNMHDR);<br> &nbsp;&nbsp;&nbsp;&nbsp; intLength = m_ListCtrl.GetItemCount();<br> &nbsp;&nbsp;&nbsp;&nbsp; CArray&lt;CString,CString&gt; ItemData;<br> &nbsp;&nbsp;&nbsp;&nbsp; ItemData.SetSize(Length);<br> &nbsp;&nbsp;&nbsp;&nbsp; for (inti = 0; i &lt; Length; i++)<br> &nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ItemData[i] = m_ListCtrl.GetItemText(i,pNMLV-&gt;iSubItem);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m_ListCtrl.SetItemData(i,(DWORD_PTR)&amp;ItemData[i]);//设置排序关键字<br> &nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp; staticintsort = 0;<br> &nbsp;&nbsp;&nbsp;&nbsp; staticintSubItem = 0;<br> &nbsp;&nbsp;&nbsp;&nbsp; if (SubItem != pNMLV-&gt;iSubItem)<br> &nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sort = 0;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SubItem = pNMLV-&gt;iSubItem;<br> &nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp; else<br> &nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (sort == 0)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sort = 1;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sort = 0;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp; m_ListCtrl.SortItems(MyCompareProc,(DWORD_PTR)&amp;sort);//排序<br> &nbsp;&nbsp;&nbsp;&nbsp; *pResult = 0;<br> }</p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">24. 在listctrl中选中某个item时动态改变其icon或bitmap<br> Q141834: How to change the icon or the bitmap of a CListCtrl item in Visual C++<br><a href="http://support.microsoft.com/kb/141834/en-us" rel="nofollow" style="color:rgb(68,68,68);"><span>http://support.microsoft.com/kb/141834/en-us</span></a></p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">25. 在添加item后，再InsertColumn()后导致整列数据移动的问题<br> Q151897: CListCtrl::InsertColumn() Causes Column Data to Shift<br><a href="http://support.microsoft.com/kb/151897/en-us" rel="nofollow" style="color:rgb(68,68,68);"><span>http://support.microsoft.com/kb/151897/en-us</span></a></p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">26. 关于listctrl第一列始终居左的问题<br> 解决办法：把第一列当一个虚列，从第二列开始插入列及数据，最后删除第一列。<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> 具体解释参阅&nbsp;&nbsp;&nbsp;<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/listview/structures/lvcolumn.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/listview/structures/lvcolumn.asp</span></a></p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">27. 锁定column header的拖动<br><a href="http://msdn.microsoft.com/msdnmag/issues/03/06/CQA/" rel="nofollow" style="color:rgb(68,68,68);"><span>http://msdn.microsoft.com/msdnmag/issues/03/06/CQA/</span></a></p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">28. 如何隐藏clistctrl的列<br> &nbsp;&nbsp;&nbsp; 把需隐藏的列的宽度设为0,然后检测当该列为隐藏列时，用上面第27点的锁定column 的拖动来实现</p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">29. listctrl进行大数据量操作时，使用virtual list&nbsp;&nbsp;&nbsp;<br><a href="http://www.microsoft.com/msj/archive/S2061.aspx" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.microsoft.com/msj/archive/S2061.aspx</span></a><br><a href="http://www.codeguru.com/cpp/controls/listview/advanced/article.php/c4151/" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeguru.com/cpp/controls/listview/advanced/article.php/c4151/</span></a><br><a href="http://www.codeproject.com/listctrl/virtuallist.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/virtuallist.asp</span></a></p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">30. 关于item只能显示259个字符的问题<br> 解决办法：需要在item上放一个edit。</p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">31. 响应在listctrl的column header上的鼠标右键单击<br> Q125694: How To Find Out Which Listview Column Was Right-Clicked<br><a href="http://support.microsoft.com/kb/125694/en-us" rel="nofollow" style="color:rgb(68,68,68);"><span>http://support.microsoft.com/kb/125694/en-us</span></a></p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">32. 类似于windows资源管理器的listview<br> Q234310: How to implement a ListView control that is similar to Windows Explorer by using DirLV.exe<br><a href="http://support.microsoft.com/kb/234310/en-us" rel="nofollow" style="color:rgb(68,68,68);"><span>http://support.microsoft.com/kb/234310/en-us</span></a></p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">33. 在ListCtrl中OnTimer只响应两次的问题<br> Q200054：<br> PRB: OnTimer() Is Not Called Repeatedly for a List Control<br><a href="http://support.microsoft.com/kb/200054/en-us" rel="nofollow" style="color:rgb(68,68,68);"><span>http://support.microsoft.com/kb/200054/en-us</span></a></p> 
     <p style="line-height:1.5;"><br> --------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">34. 以下为一些为实现各种自定义功能的listctrl派生类<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (1)&nbsp;&nbsp;&nbsp; 拖放&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/dragtest.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/dragtest.asp</span></a></p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在CListCtrl和CTreeCtrl间拖放<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://support.microsoft.com/kb/148738/en-us" rel="nofollow" style="color:rgb(68,68,68);"><span>http://support.microsoft.com/kb/148738/en-us</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (2)&nbsp;&nbsp;&nbsp; 多功能listctrl<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 支持subitem可编辑，图标，radiobutton，checkbox，字符串改变颜色的类<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/quicklist.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/quicklist.asp</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 支持排序，subitem可编辑，subitem图标，subitem改变颜色的类<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/ReportControl.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/ReportControl.asp</span></a></p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (3)&nbsp;&nbsp;&nbsp; subitem中显示超链接<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/CListCtrlLink.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/CListCtrlLink.asp</span></a></p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (4)&nbsp;&nbsp;&nbsp; subitem的tooltip提示<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/ctooltiplistctrl.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/ctooltiplistctrl.asp</span></a></p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (5)&nbsp;&nbsp;&nbsp; subitem中显示进度条&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/ProgressListControl.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/ProgressListControl.asp</span></a><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/napster.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/napster.asp</span></a><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeguru.com/Cpp/controls/listview/article.php/c4187/" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeguru.com/Cpp/controls/listview/article.php/c4187/</span></a></p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (6)&nbsp;&nbsp;&nbsp; 动态改变subitem的颜色和背景色<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/highlightlistctrl.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/highlightlistctrl.asp</span></a><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeguru.com/Cpp/controls/listbox/colorlistboxes/article.php/c4757/" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeguru.com/Cpp/controls/listbox/colorlistboxes/article.php/c4757/</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (7)&nbsp;&nbsp;&nbsp; 类vb属性对话框<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/propertylistctrl.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/propertylistctrl.asp</span></a><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeguru.com/Cpp/controls/listview/propertylists/article.php/c995/" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeguru.com/Cpp/controls/listview/propertylists/article.php/c995/</span></a><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeguru.com/Cpp/controls/listview/propertylists/article.php/c1041/" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeguru.com/Cpp/controls/listview/propertylists/article.php/c1041/</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (8)&nbsp;&nbsp;&nbsp; 选中subitem(只高亮选中的item)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/SubItemSel.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/SubItemSel.asp</span></a><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/ListSubItSel.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/ListSubItSel.asp</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (9)&nbsp;&nbsp;&nbsp; 改变行高<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/changerowheight.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/changerowheight.asp</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (10)&nbsp;&nbsp; 改变行颜色<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/coloredlistctrl.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/coloredlistctrl.asp</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (11)&nbsp;&nbsp; 可编辑subitem的listctrl<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/nirs2000.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/nirs2000.asp</span></a><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/editing_subitems_in_listcontrol.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/editing_subitems_in_listcontrol.asp</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (12)&nbsp;&nbsp; subitem可编辑，插入combobox，改变行颜色，subitem的tooltip提示<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/reusablelistcontrol.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/reusablelistcontrol.asp</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (13)&nbsp;&nbsp; header 中允许多行字符串<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/headerctrlex.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/headerctrlex.asp</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (14)&nbsp;&nbsp; 插入combobox<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeguru.com/Cpp/controls/listview/editingitemsandsubitem/article.php/c979/" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeguru.com/Cpp/controls/listview/editingitemsandsubitem/article.php/c979/</span></a><br> &nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (15)&nbsp;&nbsp; 添加背景图片<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeguru.com/Cpp/controls/listview/backgroundcolorandimage/article.php/c4173/" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeguru.com/Cpp/controls/listview/backgroundcolorandimage/article.php/c4173/</span></a><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeguru.com/Cpp/controls/listview/backgroundcolorandimage/article.php/c983/" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeguru.com/Cpp/controls/listview/backgroundcolorandimage/article.php/c983/</span></a></p> 
     <p style="line-height:1.5;"><a href="http://www.vchelp.net/vchelp/archive.asp?type_id=9&amp;class_id=1&amp;cata_id=1&amp;article_id=1088&amp;search_term" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.vchelp.net/vchelp/archive.asp?type_id=9&amp;class_id=1&amp;cata_id=1&amp;article_id=1088&amp;search_term</span></a>=<br> &nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (16)&nbsp; 自适应宽度的listctrl<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/useritems/AutosizeListCtrl.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/useritems/AutosizeListCtrl.asp</span></a></p> 
     <p style="line-height:1.5;"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (17)&nbsp; 改变ListCtrl高亮时的颜色(默认为蓝色)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;处理 NM_CUSTOMDRAW<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.codeproject.com/listctrl/lvcustomdraw.asp" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.codeproject.com/listctrl/lvcustomdraw.asp</span></a></p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (18)&nbsp; 改变header颜色<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://www.pocketpcdn.com/articles/hdr_color.html" rel="nofollow" style="color:rgb(68,68,68);"><span>http://www.pocketpcdn.com/articles/hdr_color.html</span></a></p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;">35.CListCtrl显示样式的改变<br> m_pCtrl = &amp;this-&gt;GetListCtrl(); //获得指针<br> //CListCtrl样式改变<br> LONG lStyle;<br> lStyle = GetWindowLong(m_pCtrl-&gt;m_hWnd, GWL_STYLE);&nbsp;&nbsp;&nbsp;&nbsp; //获取当前窗口style<br> lStyle &amp;= ~LVS_TYPEMASK;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //清除显示方式<br> lStyle |= LVS_REPORT;&nbsp;&nbsp; //设置style为Report显示<br> SetWindowLong(m_pCtrl-&gt;m_hWnd, GWL_STYLE, lStyle);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> //CListCtrl扩展样式改变<br> DWORD dwStyle;<br> dwStyle = m_pCtrl-&gt;GetStyle();&nbsp; //取得样式<br> dwStyle |=&nbsp;&nbsp;&nbsp; LVS_EX_GRIDLINES | LVS_EX_FULLROWSELECT ;&nbsp;&nbsp; //添加样式<br> m_pCtrl-&gt;SetExtendedStyle(dwStyle);&nbsp;&nbsp;&nbsp;&nbsp; //重新设置<br> 需要的样式(根据自己的需要的样式选择) LVS_ICON: 为每个item显示大图标 LVS_SMALLICON: 为每个item显示小图标 LVS_LIST: 显示一列带有小图标的item LVS_REPORT: 显示item详细资料 LVS_EX_FULLROWSELECT: 表示选中某行使整行高亮（只适用与report风格的CListCtrl） LVS_EX_GRIDLINES: 表示显示网格线(只适用与report风格的CListCtrl) 24.添加CListCtrl的记录</p> 
     <p style="line-height:1.5;">//插入列<br> m_pCtrl-&gt;InsertColumn(1,"第一列",LVCFMT_CENTER,47);&nbsp; //序号,标题,标题显示位置,列宽度<br> m_pCtrl-&gt;InsertColumn(2,"第二列",LVCFMT_CENTER,100);<br> //写入数据<br> int nRow = m_list.InsertItem(0, “无用字符串”); //插入行<br> m_list.SetItemText(nRow, 1, “1111”);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //设置数据<br> m_list.SetItemText(nRow, 2, “2222”);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //设置数据<br> 25.判断CListCtrl的哪行记录被选中了</p> 
     <p style="line-height:1.5;">int n = -1;<br> POSITION pos = m_pCtrl-&gt;GetFirstSelectedItemPosition(); //返回第一个选中的行位置<br> if (pos != NULL)<br> {<br> &nbsp;&nbsp; while (pos)<br> &nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; n = m_pCtrl-&gt;GetNextSelectedItem(pos);&nbsp; //返回下一个选中的行数(返回值从0开始)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //做相应操作<br> &nbsp;&nbsp; }<br> }</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;"><br> 36.响应单击CListCtrl事件</p> 
     <p style="line-height:1.5;">//响应CMyListView的=NUM_CLICK消息</p> 
     <p style="line-height:1.5;">//直接用VC类向导生成后,不用再次添加声明和消息映射<br> //添加函数声明<br> afx_msg void OnClick(NMHDR* pNMHDR, LRESULT* pResult);<br> //添加消息映射<br> ON_NOTIFY_REFLECT(NM_CLICK, OnClick)<br> void CMyListView::OnClick(NMHDR* pNMHDR, LRESULT* pResult)<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // TODO: Add your control notification handler code here<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NM_LISTVIEW* pNMListView = (NM_LISTVIEW*)pNMHDR;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(pNMListView-&gt;iItem != -1)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //值从0开始计算,无数据区不相应时间<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //相应操作<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *pResult = 0;<br> }</p> 
     <p style="line-height:1.5;">--------------------------------------------------------------------------------</p> 
     <p style="line-height:1.5;"><br> 37 CListCtrl,CListView与LVN_ITEMCHANGED消息</p> 
     <p style="line-height:1.5;">若要在CListCtrl中行发生改变时得到通知，可以映射LVN_ITEMCHANGED消息。</p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp; ON_NOTIFY_REFLECT(LVN_ITEMCHANGED, OnItemchanged)</p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp; afx_msg void OnItemchanged(NMHDR* pNMHDR,LRESULT* pResult);</p> 
     <p style="line-height:1.5;">// 行选择改变<br> void CMyListCtrl::OnItemchanged(NMHDR* pNMHDR, LRESULT* pResult)<br> {<br> &nbsp;&nbsp;&nbsp; NM_LISTVIEW* pNMListView = (NM_LISTVIEW*)pNMHDR;<br> &nbsp;&nbsp;&nbsp; ...您要进行的操作...<br> &nbsp;&nbsp;&nbsp; *pResult = 0;<br> }<br> 注意，LVN_ITEMCHANGED消息的产生有以下几种可能：&nbsp;&nbsp;&nbsp;<br> 1、由选中到没选中的变化；&nbsp;&nbsp;&nbsp;<br> 2、由没选中到选中的变化；&nbsp;&nbsp;&nbsp;&nbsp;<br> 3、由选中一行到选中另外一行的变化；&nbsp;&nbsp;&nbsp;<br> 4、使用CListCtrl::SetItem函数更改了行；&nbsp;&nbsp;&nbsp;&nbsp;<br> 如何检测LVN_ITEMCHANGED消息是由那一变化产生的呢？&nbsp;&nbsp;&nbsp;<br> NM_LISTVIEW结构成员变量uChanged和uNewState包含着这类信息，看如下代码：</p> 
     <p style="line-height:1.5;">void CRunListView::OnItemchanged(NMHDR* pNMHDR, LRESULT* pResult)<br> {<br> &nbsp;&nbsp;&nbsp; NM_LISTVIEW* pNMListView = (NM_LISTVIEW*)pNMHDR;<br> &nbsp;&nbsp;&nbsp; if(pNMListView-&gt;uChanged == LVIF_STATE)<br> &nbsp;&nbsp;&nbsp; {<br> &nbsp;if(pNMListView-&gt;uNewState)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TRACE0("选择改变且有选中的行\r\n");<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TRACE0("选择改变且没有选中的行\r\n");<br> &nbsp;&nbsp;&nbsp; }<br> &nbsp;&nbsp;&nbsp; else<br> &nbsp;&nbsp;&nbsp; TRACE0("行改变(CListCtrl::SetItem)\r\n");</p> 
     <p style="line-height:1.5;">&nbsp;&nbsp;&nbsp; *pResult = 0;<br> }</p> 
    </div> 
   </div> 
   <div class="clear" style="clear:both;color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;"></div> 
   <div> 
    <div> 
     <font color="#444444"><span style="font-size:12px;">本文转自编程小翁博客园博客，原文链接：http://www.cnblogs.com/wengzilin/archive/2013/04/27/3047908.html，如需转载请自行联系原作者</span></font>
     <br>
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
