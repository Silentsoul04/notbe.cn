<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>《101 Windows Phone 7 Apps》读书笔记-Local FM Radio « NotBeCN</title>
  <meta name="description" content="             程内容    Ø Radio Turner    Ø The NetworkInterface.InterfaceType Property    &nbsp;    &nbsp;&nbsp;&nbsp; Local FM Radio应用程序提供了一种特定的接口来操作手机内置的FM收音机...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/15/weixin_34405354_90121175.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">《101 Windows Phone 7 Apps》读书笔记-Local FM Radio</h1>
    <p class="post-meta">Nov 15, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font><strong>程内容</strong></font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>Ø Radio Turner</font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>Ø The NetworkInterface.InterfaceType Property</font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font></font>&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>&nbsp;&nbsp;&nbsp; Local FM Radio应用程序提供了一种特定的接口来操作手机内置的FM收音机。与“Music + Videos hub”中手机内置的收音机不同，该应用程序允许用户直接输入想要收听的电台频率。而且，应用程序还显示当前的接收信号强度，这也是对我们所处的无线环境的一个验证。该应用程序的目的是展示手机中使用简单有效的收音机操作接口，即Microsoft.Devices.Radio命名空间中的FMRadio类。虽然它提供的功能非常有限，但是也具备了一些优点。比如，它能够与“Music + Video hub”中的历史记录和播放列表自动集成。</font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font></font>&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>&nbsp;&nbsp;&nbsp; 该应用程序需要获取手机中的媒体库（即具备ID_CAP_MEDIALIB能力）。如果没有这个能力的话，虽然应用程序仍旧可以显示收音机的一些基本信息，但是在启动收音机时，程序会抛出一个名为“RadioDisabledException”的异常。</font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font></font>&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><strong><font>The User Interface</font></strong></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>&nbsp;&nbsp;&nbsp; 正如我们从应用程序的截图所看到的那样，该应用程序的用户界面就是“Tip Calculator”与“Alarm Clock”的混合。</font></p> 
   <p align="center" style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><a href="http://images.cnblogs.com/cnblogs_com/dearsj001/201208/201208200720556898.png" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;"><font></font></a><font><a href="http://images.cnblogs.com/cnblogs_com/dearsj001/201208/201208200720561292.png" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;"><img title="image" alt="image" src="https://images.cnblogs.com/cnblogs_com/dearsj001/201208/201208200720561783.png" height="501" width="304" style="border:0px;background-image:none;"></a></font></p> 
   <p align="center" style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>图32.1 应用程序主页面</font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>注意：</font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font> 除了double-zero按钮被power按钮所替代以外，页面资源集合中的button和相关的canvas样式与第10章“Tip Calculator”应用程序中使用的极其相似。</font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font> 显示频率用的自定义七段数码管字体在FrequencyDisplay这个用户控件中实现。它几乎与第20章“Alarm Clock”中的TimeDisplay用户控件一致，但还是要稍微简单一些。本章不涉及这方面的内容介绍，但是我们可以查看工程源代码。</font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font></font>&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><strong><font>The Code-Behind</font></strong></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font> 这里使用的大多数代码与第10章“Tip Calculator”有很多相似之处。除了与FMRadio类交互以及处理power按钮的代码不同之外，它们之间最大的差异就是：显示频率值的时候，只保留了一位小数；而“Tip Calculator”中使用了两位小数。</font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>我们可以通过静态的FMRadio.Instance属性，得到一个FMRadio类的实例。该实例包含了三个可读写的属性，用来控制手机中的收音机操作：</font></p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"> 
    <p style="line-height:1.5;"><font>* Frequency，表示当前播放电台频率的double类型值。</font></p> 
    <p style="line-height:1.5;"><font>* PowerMode，只能是On或者是Off。</font></p> 
    <p style="line-height:1.5;"><font>* CurrentRegion，可以是美国，日本，或者是欧洲。后者的含义就是“除了美国和日本之外的所有地域”。</font></p> 
   </blockquote> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>&nbsp;&nbsp;&nbsp; FMRadio还包含一个只读的、类型为double的SignalStrength属性，它用来指示接收信号强度（RSSI）。该属性值的范围还没有规定，但从我测试的结果来看，它是一个0到1之间的值，其中0表示无信号，1表示最强信号。</font></p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"> 
    <p style="line-height:1.5;"><font>在手机通过Zune与PC机相连时，为什么收音机不工作？</font></p> 
    <p style="line-height:1.5;"><font>桌面端运行的Zune软件会锁定媒体库，这就使得需要ID_CAP_MEDIALIB能力的程序无法正常工作（同样，在手机与Zune连接时，我们无法使用Marketplace这个应用程序）。如果我们需要测试具备这种功能的程序，我们可以使用“Windows Phone Connect Tool”这个工具，它包含在“Windows Phone Developer Tools”中，使得PC机可以不运行Zune的情况下，建立于手机的连接。</font></p> 
   </blockquote> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"> 
    <p style="line-height:1.5;"><font>由于这个功能的限制，我们用户不得不关闭Zune，或者断开与手机的连接。但最好的方法是，在程序中检测这种情况，在发生时，我们知道出现这种现象的原因。Local FM Radio应用程序在StartRadio方法中检测这种情况。它假设PowerMode设置失败就是手机连接Zune的缘故，这不失为一种安全的假设。</font></p> 
   </blockquote> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"> 
    <p style="line-height:1.5;"><font>检测这种情况的另一种方法就是，检查NetworkInterface. InterfaceType属性值（位于Microsoft.Phone.Net.NetworkInformation命名空间中）是否是Ethernet，它只有在与Zune建立连接后，值变为Ethernet。但是，这是一个并不可靠的属性，因为获取它的值，需要经历一个长时间的阻塞过程。如果我们决定使用这种方式的话，最好是在后台线程中使用它。</font></p> 
   </blockquote> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>由于收音机的信号强度值是可变的，但它并没有与收音机相关的事件，所以主页面的构造函数使用定时器对信号强度值每隔两秒进行刷新一次。虽然这种循环的方式比较耗电，但一般情况下，用户不会长时间地运行该应用程序。那是因为在应用程序退出以后，收音机仍旧保持工作（重要的是，该应用程序在锁屏状态下停止运行）。构造函数同时初始化FM频率为上一次设置的FM频率值。</font></p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"> 
    <p style="line-height:1.5;"><font>FMRadio中的Frequency属性是一个全局设置！</font></p> 
    <p style="line-height:1.5;"><font>如果我们改变了收音机的电台，这会影响内置的收音机应用（同样，其他任何使用收音机的第三方应用程序也会受影响）。一方面，这个操作非常的方便，因为在应用程序启动时，不需要记住上一次的收音机频率（事实上，Local FM Radio应用程序并没有在隔离存储空间中存放任何的数据）。另一方面，如果我们希望应用程序与手机内置的收音机进行隔离，那么我们就需要做一些额外的工作。</font></p> 
    <p style="line-height:1.5;"><font>StartRadio 和 StopRadio这两个方法可以改变PowerMode属性的值。如果接收信号强度为0，StartRadio方法同样显示与内置收音机应用程序一样的信息，如图32.2所示。本应用程序假设这种情况发生时，用户的耳机线没有处于插入状态，因为对于当前的手机来说，耳机线就充当了FM广播的接收天线。</font></p> 
   </blockquote> 
   <p align="center" style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><a href="http://images.cnblogs.com/cnblogs_com/dearsj001/201208/201208200720576733.png" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;"><font></font></a><font><a href="http://images.cnblogs.com/cnblogs_com/dearsj001/201208/201208200720571684.png" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;"><img title="image" alt="image" src="https://images.cnblogs.com/cnblogs_com/dearsj001/201208/201208200721017176.png" height="504" width="304" style="border:0px;background-image:none;"></a></font></p> 
   <p align="center" style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>图32.2 在没有连接手机的耳机线时，应用程序无法获取任何FM信号。</font></p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"> 
    <p style="line-height:1.5;"><font>FMRadio的PowerMode属性在Windows Phone 7.0版本中存在bug！</font></p> 
    <p style="line-height:1.5;"><font>在一些手机上，把PowerMode设置为Off后，收音机会停止一小段时间，但随后，即使PowerMode不设置回来，收音机仍旧处于工作状态。这就使得无法实现一个显示与收音机状态同步的按钮。相反，该应用程序中的power按键表现得非常怪异。在这种情况下，假如应用程序启动时，由于连接Zune的原因，导致收音机无法工作，那么这种方式就可以用于启动收音机。</font></p> 
   </blockquote> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font> 在收音机打开的情况下，将频率设置为一个无效的值会引发异常。有效或者无效的值是相对于本地电台频率来说的，如果这通过用户逻辑来实现的话，就显得有些复杂。因此，本应用程序采用了最简单的方法，那就是在异常发生时，将显示的频率值变红（当然，如果当前的主题颜色是红色，那就无法看到效果了）。</font></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font> 在用户离开应用程序后（这时应用程序还在运行），我们仍旧可以通过点击volume-up 或者是 volume-down 按钮来控制收音机。应用程序这时会在屏幕上方弹出一个界面，如图32.3所示。有趣的是，通过后退或者是前进按钮，我们还可以搜索上一个/下一个电台，所以，如果在Local FM Radio运行过程中，我们按了上述的两个按钮，当前播放的电台就会和显示的频率值不一致。虽然本应用程序可以通过它定时器的Tick事件处理程序来检测并验证这种情况，但是，这并不是一个什么大问题。</font></p> 
   <p align="center" style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><a href="http://images.cnblogs.com/cnblogs_com/dearsj001/201208/201208200721014078.png" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;"><font></font></a><font><a href="http://images.cnblogs.com/cnblogs_com/dearsj001/201208/201208200721024569.png" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;"><img title="image" alt="image" src="https://images.cnblogs.com/cnblogs_com/dearsj001/201208/201208200721025059.png" height="504" width="304" style="border:0px;background-image:none;"></a></font></p> 
   <p align="center" style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font>图32.3 除了更改音量以外，音量控制界面还可以进行开启收音机或者停止收音机的操作，甚至还可以通过接收信号的强度，来搜索前一个或者后一个电台。</font></p> 
   <p align="left" style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;"><font></font>&nbsp;</p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);"> 
    <p style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;line-height:1.5;"><font>我们是否可以获取当前播放电台的呼叫号码、名称、或者是“当前播放节目”的信息？</font></p> 
    <p style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;line-height:1.5;"><font>答案是否定的，虽然内置的收音机应用程序可以显示这些信息，但是从目前向开发者开放的API来看，我们无法做到这些。</font></p> 
    <p style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;line-height:1.5;"><font><br></font></p> 
    <p style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;line-height:1.5;"><font></font></p> 
    <p style="line-height:1.5;"><font color="#4b4b4b">本文转自施炯博客园博客，原文链接：</font></p> 
    <font color="#4b4b4b">http://www.cnblogs.com/dearsj001/archive/2012/08/20/101App4WP7_FMRadio.html</font> 
    <p style="line-height:1.5;"><font color="#4b4b4b">，如需转载请自行联系原作者</font><br></p> 
    <div style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:16px;">
     <br>
    </div> 
   </blockquote> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
