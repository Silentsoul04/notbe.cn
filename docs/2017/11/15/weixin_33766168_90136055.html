<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>ASP做paypal支付接口详细代码和实例 « NotBeCN</title>
  <meta name="description" content="             ASP做贝宝(paypal)支付接口 !!    今天网速很慢,想想整理一下前些天做的接口吧! 整理 ! 整理一下 !    事实上,paypal可以说分两个 :    国际www.paypal.com&nbsp; 中国www.paypal.com/cn    国际的这个只支付 美元 收...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/15/weixin_33766168_90136055.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">ASP做paypal支付接口详细代码和实例</h1>
    <p class="post-meta">Nov 15, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>ASP做贝宝(paypal)支付接口 !!</strong></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>今天网速很慢,想想整理一下前些天做的接口吧! 整理 ! 整理一下 !</strong></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);">事实上,paypal可以说分两个 :</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);">国际</span><a><span style="line-height:1.5;color:rgb(0,0,128);">www.paypal.com</span></a><span style="line-height:1.5;color:rgb(0,0,128);">&nbsp;<br> 中国</span><a><span style="line-height:1.5;color:rgb(0,0,128);">www.paypal.com/cn</span></a></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>国际的这个只支付 美元 收付 ! 而中国的这个支持 人民币 收付 !</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>这个先清楚了 !</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>流程思路:</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>事实上贝宝帐号上直接就可以得到一个支付接口的: 如下:</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(255,102,0);">&lt;form target="paypal" action="</span><a><span style="line-height:1.5;color:rgb(255,102,0);">https://www.paypal.com/cgi-bin/webscr</span></a><span style="line-height:1.5;color:rgb(255,102,0);">" method="post"&gt;</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(255,102,0);">&lt;input type="image" src="</span><a><span style="line-height:1.5;color:rgb(255,102,0);">https://www.paypal.com/zh_CN/i/btn/x-click-but22.gif</span></a><span style="line-height:1.5;color:rgb(255,102,0);">" border="0" name="submit" alt="贝宝— 最安全便捷的在线支付方式！"&gt; &lt;input type="hidden" name="add" value="1"&gt; &lt;input type="hidden" name="cmd" value="_cart"&gt;<br> &lt;input type="hidden" name="business" value="</span><a><span style="line-height:1.5;color:rgb(255,102,0);">zwfec@163.com</span></a><span style="line-height:1.5;color:rgb(255,102,0);">"&gt;<br> &lt;input type="hidden" name="item_name" value="asss"&gt;<br> &lt;input type="hidden" name="item_number" value="df"&gt;<br> &lt;input type="hidden" name="amount" value="10.00"&gt;<br> &lt;input type="hidden" name="no_shipping" value="0"&gt;<br> &lt;input type="hidden" name="no_note" value="1"&gt;<br> &lt;input type="hidden" name="currency_code" value="CNY"&gt;<br> &lt;input type="hidden" name="weight" value="1"&gt;<br> &lt;input type="hidden" name="weight_unit" value="kgs"&gt;<br> &lt;input type="hidden" name="bn" value="PP-ShopCartBF"&gt;<br> &lt;/form&gt;</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>直接使用这种代码有些不方便! 要一个个添加才可以, 不过想一想, 这段代码, 也可以动态生成的, 用php,asp都可以,只要里面授的一些值改变一下,你的商品的支付代码就可以通过读取数据库来生成了,也不用一个个来写入了!!</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>我是这样写的: 读取数据库:rs 这个大家应该都知道的吧</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);">&lt;form action="</span><a><span style="line-height:1.5;color:rgb(0,0,128);">https://www.paypal.com/cgi-bin/webscr</span></a><span style="line-height:1.5;color:rgb(0,0,128);">" method="post"&gt;<br> &nbsp;&nbsp;&nbsp; &lt;input type="hidden" name="cmd" value="_xclick"&gt;<br> &nbsp;&nbsp;&nbsp; &lt;input type="hidden" name="business" value="&lt;%=rs("email")%&gt;"&gt;'你的paypal帐号<br> &nbsp;&nbsp;&nbsp; &lt;input type="hidden" name="item_name" value="&lt;%=rs("ordernum")%&gt;"&gt;&nbsp; '你的网站上的购物车上的订单号<br> &nbsp;&nbsp;&nbsp; &lt;input type="hidden" name="currency_code" value="USD"&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'USD 美元 ! CNY 人民币 !<br> &nbsp;&nbsp;&nbsp; &lt;input type="hidden" name="amount" value="&lt;%=rs("price")%&gt;"&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '产品价格<br> &lt;input type="hidden" name="return" value="</span><a><span style="line-height:1.5;color:rgb(0,0,128);">http://&lt;%</span></a><span style="line-height:1.5;color:rgb(0,0,128);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '这里是客户支付成功, 返回信息的地址!&nbsp;<br> theurl=LCase(Request.ServerVariables("HTTP_HOST"))&amp;Request.ServerVariables("URL") theurl=Left(theurl,InstrRev(theurl,"/")) response.write theurl&amp;"inc/paypalreturn.asp" %&gt;"&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br> &lt;input type="submit" name="Submit3" value="Use Paypal Payment"&gt; &lt;/form&gt;</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>这个支付肯定是可以的? 至于是否支付成功, 做一个认证然后更改订单状态 !</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>这个认证就是在paypalreturn.asp这个页里来实现: 代码如下 : paypalreturn.asp:</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(128,128,0);">&lt;%&nbsp;<br> mainpath="paypal.mdb"&nbsp;<br> Set conn = Server.CreateObject("ADODB.Connection")&nbsp;<br> connstr="Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" &amp; Server.MapPath(mainpath)&nbsp;<br> conn.Open connstr</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(128,128,0);">Function viate(itemnumber,paymentid,payamount,payeremail)&nbsp;<br> set rs=server.CreateObject("adodb.recordset") s<br> ql="select * from orders where ordernum='"&amp;itemnumber&amp;"'"&nbsp;&nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,255,0);">'这里是订单表 如果会员支付成功, 更改订单状态为已付款 !&nbsp;<br></span>rs.open sql,conn,1,3</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(128,128,0);">If Not(rs.bof Or rs.eof) Then &nbsp;&nbsp;&nbsp;<br> rs("orderline")="3" &nbsp;&nbsp;&nbsp;<br> rs("paymentid")=paymentid &nbsp;&nbsp;&nbsp;<br> rs("payamount")=payamount &nbsp;&nbsp;&nbsp;<br> rs("payeremail")=payeremail &nbsp;&nbsp;&nbsp;<br> rs("paydate")=Now() &nbsp;&nbsp;&nbsp;<br> rs.update<br> Else &nbsp;&nbsp;&nbsp;<br> response.write "&lt;script&gt;alert('NO this order number ! Please contact website administrator !!');&lt;/script&gt;"&nbsp;<br> End If&nbsp;<br> rs.close&nbsp;<br> Set rs=Nothing&nbsp;<br> End Function</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(128,128,0);">function urldecode(encodestr)&nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,255,0);">'这个函数是对paypal返回值的urldecode解码的</span>&nbsp;<br> newstr="" havechar=false&nbsp;<br> lastchar=""&nbsp;<br> for i=1 to len(encodestr)&nbsp;<br> char_c=mid(encodestr,i,1)&nbsp;<br> if char_c="+" then&nbsp;<br> newstr=newstr &amp; " "&nbsp;<br> elseif&nbsp;<br> char_c="%" then&nbsp;<br> next_1_c=mid(encodestr,i+1,2)&nbsp;<br> next_1_num=cint("&amp;H" &amp; next_1_c)&nbsp;<br> if havechar then&nbsp;<br> havechar=false&nbsp;<br> newstr=newstr &amp; chr(cint("&amp;H" &amp; lastchar &amp; next_1_c))&nbsp;<br> else if abs(next_1_num)&lt;=127 then&nbsp;<br> newstr=newstr &amp; chr(next_1_num)&nbsp;<br> else&nbsp;<br> havechar=true&nbsp;<br> lastchar=next_1_c&nbsp;<br> end if&nbsp;<br> end if&nbsp;&nbsp;<br> i=i+2&nbsp;<br> else&nbsp;<br> newstr=newstr &amp; char_c&nbsp;<br> end if&nbsp;<br> next&nbsp;<br> urldecode=newstr&nbsp;<br> end Function</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(128,128,0);">str1=Trim(request.querystring("tx"))&nbsp;<br> str2="&amp;at=RDqubRmDD5AWgXJh5q2HMHKmcetP4Q8Ulj9AaPIx0B1l3f9aQiv9EPN1084"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><span style="line-height:1.5;color:rgb(0,255,0);">'这里是Paypal身份标记</span>&nbsp;&nbsp;&nbsp;&nbsp;<a>获取方法</a>&nbsp;</span><br><span style="line-height:1.5;color:rgb(128,128,0);">str = "?tx="&amp;str1&amp; "&amp;cmd=_notify-synch"&amp;str2&nbsp;<br> 'https://www.sandbox.paypal.com/cgi-bin/webscr&nbsp;<br> paypalurl="</span><a><span style="line-height:1.5;color:rgb(128,128,0);">https://www.paypal.com/cgi-bin/webscr</span></a><span style="line-height:1.5;color:rgb(128,128,0);">"&nbsp;<br> paypalurl=paypalurl&amp;str&nbsp;<br> 'response.write "&lt;br&gt;"&amp;paypalurl&amp;"&lt;br&gt;"&amp;"&lt;br&gt;"&amp;"&lt;br&gt;"</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(128,128,0);">Set objHttp=Server.CreateObject("Msxml2.ServerXMLHTTP.3.0")&nbsp;<br> objHttp.setOption 2, 13056&nbsp;<br> objHttp.open "POST",paypalurl,False,"",""&nbsp;<br> objHttp.send()</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(128,128,0);">ResponseTxt = objHttp.ResponseText&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.5;color:rgb(255,102,0);">'示例下面有写</span>&nbsp;<br> Set objHttp=Nothing&nbsp;<br><span style="line-height:1.5;color:rgb(0,255,0);">'-------------------------------------------------核对取得值</span>&nbsp;<br> ResponseTxt=UrlDecode(ResponseTxt)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,255,0);">'将返回值解码并赋给 responsetxt&nbsp;<br></span>If Mid(ResponseTxt,1,7) = "SUCCESS" Then&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,255,0);">&nbsp;&nbsp; '取得返回值的状态, sucess表示支付成功 ! Fail 表示支付失败 ! 返回值只有这两种情况 !&nbsp;<br></span>ResponseTxt = Mid(ResponseTxt,9)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,255,0);">'取得除了前9个字符的返回值,并返回给responsetxt&nbsp;<br></span>sParts = Split(ResponseTxt, vbLf)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,255,0);">'将返回值以vbLf(在vb里面这是回车&lt;换行&gt;的意思)分开,并赋给一个数组sParts&nbsp;<br></span>iParts = UBound(sParts) - 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,255,0);">'对这个数组分离取值, 后面的应该都可以看得懂的吧!&nbsp;<br></span>ReDim sResults(iParts, 1)&nbsp;<br> For i = 0 To iParts&nbsp;<br> aParts = Split(sParts(i), "=")&nbsp;<br> sKey = aParts(0)&nbsp;<br> sValue = aParts(1)&nbsp;<br> sResults(i, 0) = sKey&nbsp;<br> sResults(i, 1) = sValue</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(128,128,0);">Select Case sKey&nbsp;<br> Case "first_name"&nbsp;<br> firstName = sValue&nbsp;<br> Case "last_name"&nbsp;<br> lastName = sValue&nbsp;<br> Case "item_name"&nbsp;<br> itemName = sValue&nbsp;<br> Case "mc_gross"&nbsp;<br> mcGross = sValue&nbsp;<br> Case "mc_currency"&nbsp;<br> mcCurrency = sValue&nbsp;<br> Case "txn_id"&nbsp;<br> liushuihao = Trim(sValue)&nbsp;<br> Case "payer_email"&nbsp;<br> payeremail=Trim(sValue)&nbsp;<br> End Select&nbsp;<br> Next&nbsp;<br> Call viate(itemName,liushuihao,mcGross,payeremail)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.5;color:rgb(0,255,0);">'这里调用viate()这个function 进行认证, 并对这个订单状态进行更新 !&nbsp;<br></span>Msg="Pay for success! Please wait for delivery! "&amp;"\n \n Your Order Number: "&amp;itemName&amp;" !"&nbsp;<br> Else&nbsp;<br> Msg="Sorry ! Your operating error! Please contact website administrator !!"&nbsp;<br> End If&nbsp;<br> response.write "&lt;script&gt;alert('"&amp;msg&amp;"');<br> location.href='user.asp'&lt;/script&gt;"&nbsp;<span style="line-height:1.5;color:rgb(0,255,0);">'支付完毕返回 用户信息页 !&nbsp;<br></span>%&gt;</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>ResponseTxt 示例:</strong></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>SUCCESS mc_gross=44.00 protection_eligibility=Eligible address_status=confirmed payer_id=TMTNG8HATR5Y6 tax=0.00 address_street=1+Main+St payment_date=07%3A32%3A55+Dec+22%2C+2008+PST payment_status=Completed charset=windows-1252 address_zip=95131 first_name=Test mc_fee=1.58 address_country_code=US address_name=Test+User custom= payer_status=verified business=q2_1227410340_biz%40163.com address_country=United+States address_city=San+Jose quantity=1 payer_email=q1_1227410229_per%40163.com contact_phone= txn_id=7U833557W75672524 payment_type=instant last_name=User address_state=CA receiver_email=q2_1227410340_biz%40163.com payment_fee=1.58 receiver_id=5Q2AS9DBJGWLC txn_type=web_accept item_name=20081222225300 mc_currency=USD item_number= residence_country=US handling_amount=0.00 transaction_subject=20081222225300 payment_gross=44.00 shipping=0.00</strong></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>说明一下: 可能你的paypal帐号也没钱来做测试,所在paypal想的还是很周到的, 做一个与paypal一样功能的二级域名的网站:</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><a><span style="line-height:1.5;color:rgb(0,0,128);"><strong>https://developer.paypal.com/</strong></span></a></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>接口:https://www.sandbox.paypal.com/cgi-bin/webscr</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>在这里注册一个帐号后, 在里面可以设置两个测试帐号, 这两个测试帐号里的钱是用不完的, 你可以拿来做测试 ! 相关资料:&nbsp;&nbsp;&nbsp;<a>查看</a></strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>注:</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><strong>Paypal的提交时的字段与返回的字段含义</strong></span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);">’========================================================&nbsp;<br> ’mc_gross 交易收入&nbsp;&nbsp;&nbsp;&nbsp;<br></span><span style="line-height:1.5;color:rgb(0,0,128);">’address_status 地址信息状态&nbsp;&nbsp;&nbsp;<br> ’paypal_address_id Paypal地址信息ID&nbsp;&nbsp;&nbsp;<br> ’payer_id 付款人的Paypal ID&nbsp;&nbsp;&nbsp;<br> ’tax 税收&nbsp;&nbsp;&nbsp;<br> ’address_street 通信地址&nbsp;&nbsp;&nbsp;<br> ’payment_date 交易时间&nbsp;&nbsp;&nbsp;<br> ’payment_status 交易状态&nbsp;&nbsp;&nbsp;<br> ’charset 语言编码&nbsp;&nbsp;&nbsp;<br> ’address_zip 邮编&nbsp;&nbsp;&nbsp;<br> ’first_name 付款人姓氏&nbsp;&nbsp;&nbsp;<br> ’address_country_code 国别&nbsp;&nbsp;&nbsp;<br> ’address_name 收件人姓名&nbsp;&nbsp;&nbsp;<br> ’custom 自定义值&nbsp;&nbsp; ’<br> payer_status 付款人账户状态&nbsp;&nbsp;&nbsp;<br> ’business 收款人Paypal账户&nbsp;&nbsp;&nbsp;<br> ’address_country 通信地址国家&nbsp;&nbsp;&nbsp;<br> ’address_city 通信地址城市&nbsp;&nbsp;&nbsp;<br> ’quantity 货物数量&nbsp;&nbsp;&nbsp;<br> ’payer_email 付款人email&nbsp;&nbsp;&nbsp;<br> ’txn_id 交易ID&nbsp;&nbsp;&nbsp;<br> ’payment_type 交易类型&nbsp;&nbsp;&nbsp;<br> ’last_name 付款人名&nbsp;&nbsp;&nbsp;<br> ’address_state 通信地址省份&nbsp;&nbsp;&nbsp;<br> ’receiver_email 收款人email&nbsp;&nbsp;&nbsp;<br> ’address_owner 尚未公布/正式启用&nbsp;&nbsp;&nbsp;<br> ’receiver_id 收款人ID&nbsp;&nbsp;&nbsp;<br> ’ebay_address_id 易趣用户地址ID&nbsp;&nbsp;&nbsp;<br> ’txn_type 交易通告方式&nbsp;&nbsp;&nbsp;<br> ’item_name 货品名称&nbsp;&nbsp;&nbsp;<br> ’mc_currency 货币种类&nbsp;&nbsp;&nbsp;<br> ’item_number 货品编号&nbsp;&nbsp;&nbsp;<br> ’payment_gross 交易总额[只适用于美元情况]&nbsp;&nbsp;&nbsp;<br> ’shipping 运送费</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);">’========================================================&nbsp;<br> ’主要参数：&nbsp;<br> ’add：一次只能购买单种商品&nbsp;<br> ’upload:可以购买多种商品&nbsp;<br> ’购物车 ’&lt;input type="hidden" name="cmd" value="_cart"&gt;&nbsp;<br> ’卖家的帐户 ’&lt;input type="hidden" name="business"&nbsp;</span><a><span style="line-height:1.5;color:rgb(0,0,128);">value=ziyunyang1981@sina.com</span></a><span style="line-height:1.5;color:rgb(0,0,128);">&gt;&nbsp;<br> ’商品名 ’&lt;input type="hidden" name="item_name" value="Java"&gt;&nbsp;<br> ’商品编号 ’&lt;input type="hidden" name="item_number" value="1001"&gt;&nbsp;<br> ’商品价格 ’&lt;input type="hidden" name="amount" value="1.00"&gt;&nbsp;<br> ’商品数量-针对每一种商品 ’&lt;input type="hidden" name="quantity" value="2"&gt;&nbsp;<br> ’货币类型 CNY:人民币,USD:美元 ’&lt;input type="hidden" name="currency_code" value="CNY"&gt; ’取消交易并要返回的位置 ’&lt;input type="hidden" name="cancel_return" value="&nbsp;</span><a><span style="line-height:1.5;color:rgb(0,0,128);">http://www.updateweb.cn</span></a><span style="line-height:1.5;color:rgb(0,0,128);">&nbsp;;"&gt;&nbsp;<br> ’交易完后自动返回的位置 ’&lt;input type="hidden" name="return" value="</span><a><span style="line-height:1.5;color:rgb(0,0,128);">http://www.updateweb.cn</span></a><span style="line-height:1.5;color:rgb(0,0,128);">&nbsp;"&gt;&nbsp;<br> ’=============================================================</span></p> 
   <p style="line-height:1.5;font-size:13px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;color:rgb(0,0,128);"><br></span></p> 
   <p style="line-height:1.5;"><span style="line-height:1.5;"><font color="#000080"><span style="font-size:13px;">本文转自寒意博客园博客，原文链接：http://www.cnblogs.com/hnyei/archive/2012/02/13/ASP%e5%81%9apaypal%e6%94%af%e4%bb%98%e6%8e%a5%e5%8f%a3%e8%af%a6%e7%bb%86%e4%bb%a3%e7%a0%81%e5%92%8c%e5%ae%9e%e4%be%8b.html，如需转载请自行联系原作者</span></font><br></span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
