<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Mina框架断包、粘包问题解决方式 « NotBeCN</title>
  <meta name="description" content="             Mina框架断包、粘包问题解决方式        Apache Mina Server 是一个网络通信应用框架，也就是说，它主要是对基于TCP/IP、UDP/IP协议栈的通信框架（当然。也能够提供JAVA 对象的序列化服务、虚拟机管道通信服务等），Mina 能够帮助我们高速开发高性能、高...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/15/weixin_34415923_90132378.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Mina框架断包、粘包问题解决方式</h1>
    <p class="post-meta">Nov 15, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <h1 style="line-height:1.5;font-size:28px;font-family:verdana, Arial, Helvetica, sans-serif;">Mina框架断包、粘包问题解决方式</h1> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">Apache Mina Server 是一个网络通信应用框架，也就是说，它主要是对基于TCP/IP、UDP/IP协议栈的通信框架（当然。也能够提供JAVA 对象的序列化服务、虚拟机管道通信服务等），Mina 能够帮助我们高速开发高性能、高扩展性的网络通信应用，Mina 提供了事件驱动、异步（Mina 的异步IO 默认使用的是JAVA NIO 作为底层支持）操作的编程模型。</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">在mina中，一般的应用场景用TextLine的Decode和Encode就够用了（TextLine的默认切割符尽管是\r\n，但事实上分隔符是能够自己指定的，如：newTextLineDecoder(charset, decodingDelimiter);）</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">但默认解码器每次读取缓冲的数据是有限制的，即ReadBufferSize的大小。默认是2048个字节。当数据包比較大时将被分成多次读取。造成断包。</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">尽管能够通过acceptor.getSessionConfig().setReadBufferSize(newsize)这样的方式来添加默认容量，但毕竟不是王道（太大了浪费空间。肯定会减少数据的处理效率）。</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">所以。当我们接收的数据的大小不是非常固定，且easy偏大的时候，默认的TextLine就不适合了。</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">这时我们在解析之前就须要推断数据包是否完整，这样处理起来就会非常麻烦。那么Mina 中幸好提供了CumulativeProtocolDecoder</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">类，从名字上能够看出累积性的协议解码器，也就是说仅仅要有数据发送过来。这个类就会去读取数据。然后累积到内部的IoBuffer 缓冲区，可是详细的拆包（把累积到缓冲区的数据解码为JAVA 对象）交由子类的doDecode()方法完毕，实际上CumulativeProtocolDecoder就是在decode()重复的调用暴漏给子类实现的doDecode()方法。</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">详细运行步骤例如以下所看到的：</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">A. 你的doDecode()方法返回true 时，CumulativeProtocolDecoder 的decode()方法会首先推断你是否在doDecode()方法中从内部的IoBuffer 缓冲区读取了数据。假设没有，则会抛出非法的状态异常，也就是你的doDecode()方法返回true 就表示你已经消费了本次数据（相当于聊天室中一个完整的消息已经读取完成），进一步说，也就是此时你必须已经消费过内部的IoBuffer 缓冲区的数据（哪怕是消费了一个字节的数据）。</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">假设验证通过，那么CumulativeProtocolDecoder会检查缓冲区内是否还有数据未读取。假设有就继续调用doDecode()方法。没有就停止对doDecode()方法的调用。直到有新的数据被缓冲。</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">B. 当你的doDecode()方法返回false 时。CumulativeProtocolDecoder 会停止对doDecode()方法的调用。但此时假设本次数据还有未读取完的，就将含有剩余数据的IoBuffer 缓冲区保存到IoSession 中，以便下一次数据到来时能够从IoSession 中提取合并。</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">假设发现本次数据全都读取完成，则清空IoBuffer 缓冲区。</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">简而言之，当你觉得读取到的数据已经够解码了。那么就返回true，否则就返回false。这个CumulativeProtocolDecoder事实上最重要的工作就是帮你完毕了数据的累积，由于这个工作是非常烦琐的。</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">一、&nbsp;&nbsp;&nbsp;&nbsp;实现解码器</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">CumulativeProtocolDecoder是一个抽象类，必须继承并实现其doDecode方法。用户自己定义协议的拆分就应该写在doDecode方法中，以下的MyDecoder类是一个其子类的实现：</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="line-height:1.8;color:rgb(127,0,85);">public</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">class</span></strong>&nbsp;MyDecoder&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">extends</span></strong>&nbsp;CumulativeProtocolDecoder {</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">public</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">static</span></strong>&nbsp;Logger&nbsp;<em><span style="line-height:1.8;color:rgb(0,0,192);">log</span></em>&nbsp;= Logger.<em>getLogger</em>(MyDecoder.<strong><span style="line-height:1.8;color:rgb(127,0,85);">class</span></strong>);</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:rgb(63,95,191);">/**</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;&nbsp;&nbsp; &nbsp;*&nbsp;</span><span style="line-height:1.8;color:rgb(63,95,191);">包解码器组件</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;&nbsp;&nbsp; &nbsp;*/</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">private</span></strong>&nbsp;PacketComponent&nbsp;<span style="line-height:1.8;color:rgb(0,0,192);background:#FFFF00;">packetComponent</span>;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; &nbsp;<span style="line-height:1.8;color:rgb(63,95,191);">/**</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;</span><span style="line-height:1.8;color:rgb(63,95,191);">这种方法的返回值是重点：</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;&nbsp;&nbsp;&nbsp; * 1</span><span style="line-height:1.8;color:rgb(63,95,191);">、当内容刚好时，返回</span><span style="line-height:1.8;color:rgb(63,95,191);">false</span><span style="line-height:1.8;color:rgb(63,95,191);">，告知父类接收下一批内容</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;&nbsp;&nbsp;&nbsp; * 2</span><span style="line-height:1.8;color:rgb(63,95,191);">、内容不够时须要下一批发过来的内容，此时返回</span><span style="line-height:1.8;color:rgb(63,95,191);">false</span><span style="line-height:1.8;color:rgb(63,95,191);">，这样父类</span><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;CumulativeProtocolDecoder</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;&nbsp;</span><span style="line-height:1.8;color:rgb(63,95,191);">会将内容放进</span><span style="line-height:1.8;color:rgb(63,95,191);">IoSession</span><span style="line-height:1.8;color:rgb(63,95,191);">中，等下次来数据后就自己主动拼装再交给本类的</span><span style="line-height:1.8;color:rgb(63,95,191);">doDecode</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;&nbsp;&nbsp;&nbsp; * 3</span><span style="line-height:1.8;color:rgb(63,95,191);">、当内容多时，返回</span><span style="line-height:1.8;color:rgb(63,95,191);">true</span><span style="line-height:1.8;color:rgb(63,95,191);">，由于须要再将本批数据进行读取。父类会将剩余的数据再次推送本</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;</span><span style="line-height:1.8;color:rgb(63,95,191);">类的</span><span style="line-height:1.8;color:rgb(63,95,191);">doDecode</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;&nbsp;&nbsp;&nbsp; */</span>&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">public</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">boolean</span></strong>&nbsp;doDecode(IoSession session,IoBuffer in,&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProtocolDecoderOutput out)&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">throws</span></strong>&nbsp;Exception {&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<em><span style="line-height:1.8;color:rgb(0,0,192);">log</span></em>.info(<span style="line-height:1.8;color:rgb(42,0,255);">"in.remaining : "</span>+in.remaining());</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">if</span></strong>(in.remaining() &gt; 0){<span style="line-height:1.8;color:rgb(63,127,95);">//</span><span style="line-height:1.8;color:rgb(63,127,95);">有数据时。读取前</span><span style="line-height:1.8;color:rgb(63,127,95);">8</span><span style="line-height:1.8;color:rgb(63,127,95);">字节推断消息长度</span><span style="line-height:1.8;color:rgb(63,127,95);">&nbsp;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">byte</span></strong>&nbsp;[] sizeBytes =&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">new</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">byte</span></strong>[8];&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in.mark();<span style="line-height:1.8;color:rgb(63,127,95);">//</span><span style="line-height:1.8;color:rgb(63,127,95);">标记当前位置。以便</span><span style="line-height:1.8;color:rgb(63,127,95);">reset</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,127,95);">//</span><span style="line-height:1.8;color:rgb(63,127,95);">由于我的前数据包的长度是保存在第</span><span style="line-height:1.8;color:rgb(63,127,95);">4-8</span><span style="line-height:1.8;color:rgb(63,127,95);">字节中，</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in.get(sizeBytes,0,8);<span style="line-height:1.8;color:rgb(63,127,95);">//</span><span style="line-height:1.8;color:rgb(63,127,95);">读取</span><span style="line-height:1.8;color:rgb(63,127,95);">4</span><span style="line-height:1.8;color:rgb(63,127,95);">字节</span><span style="line-height:1.8;color:rgb(63,127,95);">&nbsp;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:rgb(63,127,95);">//DataTypeChangeHelper</span><span style="line-height:1.8;color:rgb(63,127,95);">是自己写的一个</span><span style="line-height:1.8;color:rgb(63,127,95);">byte[]</span><span style="line-height:1.8;color:rgb(63,127,95);">转</span><u><span style="line-height:1.8;color:rgb(63,127,95);">int</span></u><span style="line-height:1.8;color:rgb(63,127,95);">的一个工具类</span><span style="line-height:1.8;color:rgb(63,127,95);">&nbsp;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">int</span></strong>&nbsp;size = (<strong><span style="line-height:1.8;color:rgb(127,0,85);">int</span></strong>) DataTypeUtil.<em>bytesToInt</em>(sizeBytes,4);</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em><span style="line-height:1.8;color:rgb(0,0,192);">log</span></em>.info(<span style="line-height:1.8;color:rgb(42,0,255);">"size : "</span>+size);</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in.reset();</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">if</span></strong>(size &gt; in.remaining()){<span style="line-height:1.8;color:rgb(63,127,95);">//</span><span style="line-height:1.8;color:rgb(63,127,95);">假设消息内容不够，则重置。相当于不读取</span><span style="line-height:1.8;color:rgb(63,127,95);">size&nbsp;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">return</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">false</span></strong>;<span style="line-height:1.8;color:rgb(63,127,95);">//</span><span style="line-height:1.8;color:rgb(63,127,95);">父类接收新数据，以拼凑成完整数据</span><span style="line-height:1.8;color:rgb(63,127,95);">&nbsp;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">else</span></strong>{&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">byte</span></strong>[] bytes =&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">new</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">byte</span></strong>[size];&nbsp;&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; in.get(bytes, 0, size);</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //把字节转换为Java对象的工具类</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PackageData pack =&nbsp;<span style="line-height:1.8;color:rgb(0,0,192);background:#C0C0C0;">packetComponent</span>.getDataFromBuffer(IoBuffer.<em>wrap</em>(bytes));</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; out.write(pack);</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">if</span></strong>(in.remaining() &gt; 0){<span style="line-height:1.8;color:rgb(63,127,95);">//</span><span style="line-height:1.8;color:rgb(63,127,95);">假设读取内容后还粘了包，就让父类再重读</span><span style="line-height:1.8;color:rgb(63,127,95);">&nbsp;&nbsp;</span><span style="line-height:1.8;color:rgb(63,127,95);">一次。进行下一次解析</span><span style="line-height:1.8;color:rgb(63,127,95);">&nbsp;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">return</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">true</span></strong>;&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">return</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">false</span></strong>;<span style="line-height:1.8;color:rgb(63,127,95);">//</span><span style="line-height:1.8;color:rgb(63,127,95);">处理成功，让父类进行接收下个包</span><span style="line-height:1.8;color:rgb(63,127,95);">&nbsp;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; }</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">getter();</span></strong></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="line-height:1.8;color:rgb(127,0,85);">&nbsp;&nbsp;&nbsp; Setter();</span></strong></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">}</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">二、&nbsp;&nbsp;&nbsp;&nbsp;实现编解码工厂和解码器</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">我们还须要一个编解码工厂，用来为编解码过滤器提供编码器和解码器，解码器此处我们用不到。可是也必须提供，所以能够提供一个空的实现。</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">/**</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;*</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;*&nbsp;</span><span style="line-height:1.8;color:rgb(63,95,191);">编解码工厂</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;*</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;*/</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="line-height:1.8;color:rgb(127,0,85);">public</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">class</span></strong>&nbsp;MyCodecFcatory&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">implements</span></strong>&nbsp;ProtocolCodecFactory {</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">private</span></strong>&nbsp;ProtocolEncoder&nbsp;<span style="line-height:1.8;color:rgb(0,0,192);">encoder</span>&nbsp;=&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">null</span></strong>;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">private</span></strong>&nbsp;ProtocolDecoder&nbsp;<span style="line-height:1.8;color:rgb(0,0,192);">decoder</span>&nbsp;=&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">null</span></strong>;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">public</span></strong>&nbsp;MyCodecFcatory(ProtocolEncoder encoder, ProtocolDecoderdecoder) {</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">this</span></strong>.<span style="line-height:1.8;color:rgb(0,0,192);">encoder</span>&nbsp;= encoder;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">this</span></strong>.<span style="line-height:1.8;color:rgb(0,0,192);">decoder</span>&nbsp;= decoder;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; }</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:rgb(100,100,100);">@Override</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">public</span></strong>&nbsp;ProtocolEncoder getEncoder(IoSession session)&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">throws</span></strong>&nbsp;Exception {</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">return</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">this</span></strong>.<span style="line-height:1.8;color:rgb(0,0,192);">encoder</span>;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; }</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:rgb(100,100,100);">@Override</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">public</span></strong>&nbsp;ProtocolDecoder getDecoder(IoSession session)&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">throws</span></strong>&nbsp;Exception {</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">return</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">this</span></strong>.<span style="line-height:1.8;color:rgb(0,0,192);">decoder</span>;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; }</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">}</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">/**</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;*</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;*&nbsp;</span><span style="line-height:1.8;color:rgb(63,95,191);">编码器：不做不论什么操作，数据已是约定好的格式。按原格式编码</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;*</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;*/</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="line-height:1.8;color:rgb(127,0,85);">public</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">class</span></strong>&nbsp;MyEncoder&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">extends</span></strong>&nbsp;ProtocolEncoderAdapter {</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:rgb(100,100,100);">@Override</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">public</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,85);">void</span></strong>&nbsp;encode(IoSession session, Object message,</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProtocolEncoderOutput out)&nbsp;<strong><span style="line-height:1.8;color:rgb(127,0,85);">throws</span></strong>&nbsp;Exception {</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:rgb(63,127,95);">//&nbsp;</span><strong><span style="line-height:1.8;color:rgb(127,159,191);">TODO</span></strong><span style="line-height:1.8;color:rgb(63,127,95);">&nbsp;Do nothing</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; }</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">}</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">三、&nbsp;&nbsp;&nbsp;&nbsp;配置编解码过滤器</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">以下就能够配置编解码过滤器了：</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:rgb(63,95,191);">&lt;!--&nbsp;</span><span style="line-height:1.8;color:rgb(63,95,191);">累加数据包解码器：解断丢包、粘包问题</span><span style="line-height:1.8;color:rgb(63,95,191);">&nbsp;--&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">bean</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">id</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"codec"</span></em>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">class</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"org.apache.mina.filter.codec.ProtocolCodecFilter"</span></em><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">constructor-arg</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">bean</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">class</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"com.mina.codec.MyCodecFcatory"</span></em><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">constructor-arg</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">index</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"0"</span></em><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">bean</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">class</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"com.mina.codec.MyEncoder"</span></em><span style="line-height:1.8;color:#008080;">&gt;&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">bean</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">constructor-arg</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">constructor-arg</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">index</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"1"</span></em><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">bean</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">class</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"com.mina.codec.MyDecoder"</span></em><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">property</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">name</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"packetComponent"</span></em><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">bean</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">class</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"com. mina.component.RootComponent"</span></em><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">bean</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">property</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">bean</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">constructor-arg</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">bean</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">constructor-arg</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">bean</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);background:#C0C0C0;">bean</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">id</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"filterChainBuilder"</span></em>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">class</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"org.apache.mina.core.filterchain.DefaultIoFilterChainBuilder"</span></em><span style="line-height:1.8;color:#008080;">&gt;</span>&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">property</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">name</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"filters"</span></em><span style="line-height:1.8;color:#008080;">&gt;</span>&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">map</span><span style="line-height:1.8;color:#008080;">&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">entry</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">key</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"codec"</span></em>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">value-ref</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"codec"</span></em><span style="line-height:1.8;color:#008080;">/&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">entry</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">key</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"logger"</span></em>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">value-ref</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"loggerFilter"</span></em><span style="line-height:1.8;color:#008080;">/&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;</span><span style="line-height:1.8;color:rgb(63,127,127);">entry</span>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">key</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"executors"</span></em>&nbsp;<span style="line-height:1.8;color:rgb(127,0,127);">value-ref</span>=<em><span style="line-height:1.8;color:rgb(42,0,255);">"executors"</span></em><span style="line-height:1.8;color:#008080;">/&gt;</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">map</span><span style="line-height:1.8;color:#008080;">&gt;</span>&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);">property</span><span style="line-height:1.8;color:#008080;">&gt;</span>&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="line-height:1.8;color:#008080;">&lt;/</span><span style="line-height:1.8;color:rgb(63,127,127);background:#C0C0C0;">bean</span><span style="line-height:1.8;color:#008080;">&gt;</span>&nbsp;</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">须要注意的是：在doDecode中通过out.write(pack) 把数据输出后，官方的说明文档中说接下来会继续运行后面的过滤器，然后是IoHandle。假设你是仅仅用了一个编解码过滤器的话，这可能全然没问题，可是假设使用了两个编解码过滤器（可能非常少有人会这样做，但本人因为前期使用了另外一个自己定义的编解码过滤器。后来想加上这个可累加的解码器。为了图省事就在原过滤器的前面新添加了一个编解码过滤器，后来数据流就不走我原来的编解码过滤器了，out.write()之后直接到了IoHandle里面，搞了我好久，无奈最后把两个编解码过滤器合二为一啦。当中原因我还没时间去搞个清楚。为防止大家和我犯同一个错误，特此提醒！</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p align="left"><font color="#333333"><span style="font-size:14px;">本文转自mfrbuaa博客园博客，原文链接：http://www.cnblogs.com/mfrbuaa/p/5069487.html，如需转载请自行联系原作者</span></font></p> 
   <div>
    <br>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
