<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>iBATIS In Action：什么是iBATIS（一） « NotBeCN</title>
  <meta name="description" content="             在上一章中我们详细讨论了iBATIS的哲学观，以及这个框架的来历。我们也说过，iBATIS是一个混合式的解决方案（hybrid solution），借鉴了多种操作关系数据库的方法的理念。那么iBATIS到底是什么呢？这一章就来回答这个问题。    iBATIS是一种data mapper...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/15/weixin_34232617_90119061.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">iBATIS In Action：什么是iBATIS（一）</h1>
    <p class="post-meta">Nov 15, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">在上一章中我们详细讨论了</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">的哲学观，以及这个框架的来历。我们也说过，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">是一个混合式的解决方案（</span><span style="line-height:1.8;">hybrid solution</span><span style="line-height:1.8;font-family:'宋体';">），借鉴了多种操作关系数据库的方法的理念。那么</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">到底是什么呢？这一章就来回答这个问题。</span><br></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">是一种</span><span style="line-height:1.8;">data mapper</span><span style="line-height:1.8;font-family:'宋体';">。</span><span style="line-height:1.8;">Martin Fowler</span><span style="line-height:1.8;font-family:'宋体';">在他的《</span><span style="line-height:1.8;">Patterns of Enterprise Application Architecture</span><span style="line-height:1.8;font-family:'宋体';">》一书中是这样描述</span><span style="line-height:1.8;">Data Mapper</span><span style="line-height:1.8;font-family:'宋体';">的：</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">一个映射层，在对象和数据库间传递数据，并保持两者与映射层本身相独立。</span><span style="line-height:1.8;">.</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">注：</span><span style="line-height:1.8;">Mapper</span><span style="line-height:1.8;font-family:'宋体';">是在两个独立对象间建立通信关系的一种对象。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">Martin</span><span style="line-height:1.8;font-family:'宋体';">很好地区分了数据映射（</span><span style="line-height:1.8;">Data Mapping</span><span style="line-height:1.8;font-family:'宋体';">）和元数据映射（</span><span style="line-height:1.8;">Metadata Mapping</span><span style="line-height:1.8;font-family:'宋体';">），后者正是</span><span style="line-height:1.8;">O/RM</span><span style="line-height:1.8;font-family:'宋体';">工具的依据，这种工具将数据库的表和列映射到应用程序中的类和字段（</span><span style="line-height:1.8;">field</span><span style="line-height:1.8;font-family:'宋体';">），也就是说它将数据库的元数据映射到类的元数据。图</span><span style="line-height:1.8;">2.1</span><span style="line-height:1.8;font-family:'宋体';">显示了类和数据库表的</span><span style="line-height:1.8;">O/R&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">映射的情形。在这种情况下，类的每个字段映射到了表中的一个相应的列。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;"><img alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/iBatis/Figure2.1ORM.JPG" height="198" width="576" style="border:0px;"></span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">译注：在</span><span style="line-height:1.8;">C#</span><span style="line-height:1.8;font-family:'宋体';">中通常在类的属性（</span><span style="line-height:1.8;">Property</span><span style="line-height:1.8;font-family:'宋体';">）与表的列间进行映射。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">则与之不同，它不是直接在类与数据表或字段与列之间进行关联，而是把</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">语句的参数（</span><span style="line-height:1.8;">parameter</span><span style="line-height:1.8;font-family:'宋体';">）和返回结果（</span><span style="line-height:1.8;">result</span><span style="line-height:1.8;font-family:'宋体';">）映射至类。在本书的剩余部分您将看到，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">是处于类和数据表之间的一个中间层，这使得它在类和数据表之间进行映射时更加灵活，而不需要数据库模型或对象模型（</span><span style="line-height:1.8;">object model</span><span style="line-height:1.8;font-family:'宋体';">）的任何修改。我们所说的中间层实际上就是</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">，它使得</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">能够更好地分离数据库和对象模型的设计，这样就相对减少了两者间的耦合。图</span><span style="line-height:1.8;">2.2</span><span style="line-height:1.8;font-family:'宋体';">说明了</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">如何使用</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">映射数据。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;"><img alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/iBatis/Figure2.2iBATISSQLMapping.JPG" height="215" width="556" style="border:0px;"><br></span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">从图</span><span style="line-height:1.8;">2.2</span><span style="line-height:1.8;font-family:'宋体';">可以看到，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">的映射层正是</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">。您只管写您的</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">会为您处理类的属性和数据表的列之间的映射。有鉴于此，同时也为了消除与其它各种映射方式引起的混淆，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">团队通常称这种</span><span style="line-height:1.8;">Data Mapper</span><span style="line-height:1.8;font-family:'宋体';">为</span><span style="line-height:1.8;">SQL Mapper</span><span style="line-height:1.8;font-family:'宋体';">。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-weight:bold;"><span style="line-height:1.8;">2.1 SQL&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">映射</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">任何</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">语句都可看作是一组输入和输出。输入的值是参数（</span><span style="line-height:1.8;">parameter</span><span style="line-height:1.8;font-family:'宋体';">），通常出现在</span><span style="line-height:1.8;">WHERE</span><span style="line-height:1.8;font-family:'宋体';">子句中。输出的值则是出现在</span><span style="line-height:1.8;">SELECT</span><span style="line-height:1.8;font-family:'宋体';">子句中的列。图</span><span style="line-height:1.8;">2.3</span><span style="line-height:1.8;font-family:'宋体';">描述了这种观点。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;"><img alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/iBatis/Figure2.3SQLAsInputsAndOutputs.JPG" height="209" width="255" style="border:0px;"><br></span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">这种方式的优势在于</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">语句给开发人员带来了很大的灵活性。我们可以轻松地操作数据使之与对象模型匹配而无需修改后台的数据库设计。此外，开发人员可以使用内置的数据库函数或存储过程来返回多个不同的表或结果，</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">的强大能力变得信手拈来。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">使用一个简单的</span><span style="line-height:1.8;">XML</span><span style="line-height:1.8;font-family:'宋体';">描述文件来映射</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">语句的输入和输出。列表</span><span style="line-height:1.8;">2.1</span><span style="line-height:1.8;font-family:'宋体';">显示了一个描述文件的示例。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;"><img alt="" src="https://images.cnblogs.com/cnblogs_com/anderslly/iBatis/List2.1SqlMapperDescriptorSample.JPG" style="border:0px;"><br></span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">此处我们可以看到一条</span><span style="line-height:1.8;">SELECT SQL</span><span style="line-height:1.8;font-family:'宋体';">语句，它返回的是地址信息。根据</span><span style="line-height:1.8;">&lt;select&gt;</span><span style="line-height:1.8;font-family:'宋体';">元素我们可以了解它接受一个整型数作为参数，也就是</span><span style="line-height:1.8;">WHERE</span><span style="line-height:1.8;font-family:'宋体';">子句中标记为</span><span style="line-height:1.8;">#id#</span><span style="line-height:1.8;font-family:'宋体';">的部分。我们也可了解结果为</span><span style="line-height:1.8;">Address</span><span style="line-height:1.8;font-family:'宋体';">类型的一个实例，这里假定</span><span style="line-height:1.8;">Address</span><span style="line-height:1.8;font-family:'宋体';">类包含了与</span><span style="line-height:1.8;">SELECT</span><span style="line-height:1.8;font-family:'宋体';">子句中每一列的别名名称相同的属性。例如，别名为</span><span style="line-height:1.8;">id</span><span style="line-height:1.8;font-family:'宋体';">的列将会映射至</span><span style="line-height:1.8;">Address</span><span style="line-height:1.8;font-family:'宋体';">类的</span><span style="line-height:1.8;">id</span><span style="line-height:1.8;font-family:'宋体';">属性。信不信由你，这就是映射一条接受整型参数、返回</span><span style="line-height:1.8;">Address</span><span style="line-height:1.8;font-family:'宋体';">对象的</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">语句所需的全部了。执行这条语句使用的</span><span style="line-height:1.8;">Java</span><span style="line-height:1.8;font-family:'宋体';">代码是：</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">Address address = (Address) sqlMap.queryForObject("getAddress", new Integer(5));</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">我们的</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">映射方式可移植性很强，可以应用到任何特性完整的编程语言。比如，使用</span><span style="line-height:1.8;">iBATIS.NET</span><span style="line-height:1.8;font-family:'宋体';">的</span><span style="line-height:1.8;">C#</span><span style="line-height:1.8;font-family:'宋体';">代码为：</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">Address address = (Address) sqlMap.QueryForObject("getAddress", 5);</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">当然，关于映射还有更多的高级选项，特别是返回结果（</span><span style="line-height:1.8;">result</span><span style="line-height:1.8;font-family:'宋体';">）相关的，我们将会在第二部分（</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">基础）进行讨论。现在，理解</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">的特性和优点以及其工作原理更为重要。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-weight:bold;"><span style="line-height:1.8;">2.2&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">工作原理</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">最根本的一点是，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">可用于替代</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">。</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">提供的</span><span style="line-height:1.8;">API</span><span style="line-height:1.8;font-family:'宋体';">非常强大，却繁复而冗长。考虑下面的</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">代码：</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"></p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border:1px solid rgb(204,204,204);font-size:13px;"> 
    <span style="color:rgb(0,0,255);">public</span>
    <span style="color:rgb(0,0,0);">&nbsp;Employee&nbsp;GetEmployee(</span>
    <span style="color:rgb(0,0,255);">int</span>
    <span style="color:rgb(0,0,0);">&nbsp;number)<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;Employee&nbsp;employee&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">null</span>
    <span style="color:rgb(0,0,0);">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;connString&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">Server=(local);Database=iBatisInAction;Uid=sa;Pwd=sa;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,128,0);">//</span>
    <span style="color:rgb(0,128,0);">&nbsp;Our&nbsp;SQL&nbsp;is&nbsp;buried&nbsp;here.</span>
    <span style="color:rgb(0,128,0);"><br></span>
    <span style="color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">&nbsp;sql&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">SELECT&nbsp;*&nbsp;FROM&nbsp;EMPLOYEE&nbsp;WHERE&nbsp;EMPLOYEE_NUMBER&nbsp;=&nbsp;@EmployeeNumber</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;SqlConnection&nbsp;conn&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">null</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;SqlCommand&nbsp;command&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">null</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;SqlDataReader&nbsp;reader&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">null</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">try</span>
    <span style="color:rgb(0,0,0);"><br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">new</span>
    <span style="color:rgb(0,0,0);">&nbsp;SqlConnection(connString);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn.Open();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">new</span>
    <span style="color:rgb(0,0,0);">&nbsp;SqlCommand(sql,&nbsp;conn);</span>
    <span style="color:rgb(0,128,0);"><br></span>
    <span style="color:rgb(0,0,0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;command.Parameters.Add(</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">@EmployeeNumber</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">,&nbsp;SqlDbType.Int).Value&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;number;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reader&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;command.ExecuteReader(CommandBehavior.CloseConnection);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">while</span>
    <span style="color:rgb(0,0,0);">&nbsp;(reader.Read())<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;employee&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">new</span>
    <span style="color:rgb(0,0,0);">&nbsp;Employee();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;employee.Id&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;Convert.ToInt32(reader[</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">ID</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">]);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;employee.EmployeeNumber&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;Convert.ToInt32(reader[</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">EMPLOYEE_NUMBER</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">]);<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;employee.FirstName&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;reader[</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">FIRST_NAME</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">]&nbsp;</span>
    <span style="color:rgb(0,0,255);">as</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;employee.LastName&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;reader[</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">LAST_NAME</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">]&nbsp;</span>
    <span style="color:rgb(0,0,255);">as</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;employee.Title&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;reader[</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">TITLE</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">]&nbsp;</span>
    <span style="color:rgb(0,0,255);">as</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">string</span>
    <span style="color:rgb(0,0,0);">;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">finally</span>
    <span style="color:rgb(0,0,0);"><br> &nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">try</span>
    <span style="color:rgb(0,0,0);"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">&nbsp;(reader&nbsp;</span>
    <span style="color:rgb(0,0,0);">!=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">null</span>
    <span style="color:rgb(0,0,0);">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reader.Close();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">finally</span>
    <span style="color:rgb(0,0,0);"><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">if</span>
    <span style="color:rgb(0,0,0);">&nbsp;(conn&nbsp;</span>
    <span style="color:rgb(0,0,0);">!=</span>
    <span style="color:rgb(0,0,0);">&nbsp;</span>
    <span style="color:rgb(0,0,255);">null</span>
    <span style="color:rgb(0,0,0);">)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn.Close();<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;}<br> &nbsp;&nbsp;&nbsp;&nbsp;</span>
    <span style="color:rgb(0,0,255);">return</span>
    <span style="color:rgb(0,0,0);">&nbsp;employee;<br> }</span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">不难看出</span><span style="line-height:1.8;">ADO.NET API</span><span style="line-height:1.8;font-family:'宋体';">的复杂。每一行都是必须的，因而无法精简代码。最好也只能做到将一些公用代码提取到工具方法中，尤其是在释放资源的那部分代码。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">译注：微软的</span><span style="line-height:1.8;">SqlHelper</span><span style="line-height:1.8;font-family:'宋体';">类就是这样的工具类。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">实际上，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">会以近似于</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">的方式运行。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">会连接到数据库，设置参数，执行语句，获取结果，然后关闭和释放资源。但您需要写的代码则显著减少。代码清单</span><span style="line-height:1.8;">2.3</span><span style="line-height:1.8;font-family:'宋体';">显示了在</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">中执行相同语句所需的代码。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"></p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border:1px solid rgb(204,204,204);font-size:13px;"> 
    <span style="color:rgb(0,0,255);">&lt;</span>
    <span style="color:rgb(128,0,0);">select&nbsp;</span>
    <span style="color:rgb(255,0,0);">id</span>
    <span style="color:rgb(0,0,255);">="GetEmployee"</span>
    <span style="color:rgb(255,0,0);">&nbsp;parameterClass</span>
    <span style="color:rgb(0,0,255);">="int"</span>
    <span style="color:rgb(255,0,0);">&nbsp;resultClass</span>
    <span style="color:rgb(0,0,255);">="Employee"</span>
    <span style="color:rgb(0,0,255);">&gt;</span>
    <span style="color:rgb(0,0,0);"><br> &nbsp;&nbsp;&nbsp;&nbsp;SELECT<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ID&nbsp;AS&nbsp;Id,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EMPLOYEE_NUMBER&nbsp;AS&nbsp;EmployeeNumber,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIRST_NAME&nbsp;AS&nbsp;FirstName,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LAST_NAME&nbsp;AS&nbsp;LastName,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TITLE&nbsp;AS&nbsp;Title<br> &nbsp;&nbsp;&nbsp;&nbsp;From&nbsp;Employee<br> &nbsp;&nbsp;&nbsp;&nbsp;Where&nbsp;EMPLOYEE_NUMBER&nbsp;=&nbsp;#EmployeeNumber#<br></span>
    <span style="color:rgb(0,0,255);">&lt;/</span>
    <span style="color:rgb(128,0,0);">select</span>
    <span style="color:rgb(0,0,255);">&gt;</span> 
   </div> 
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;">两者实在是没可比性。<span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">的代码要简练得多，而且也更容易维护。我们将在本章的后面部分讨论</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">的更多好处。不过现在，您也许想知道如何在代码中执行它。就如在您在前面的例子中所见的，它只需一行简单的代码：</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"></p> 
   <div style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;border:1px solid rgb(204,204,204);font-size:13px;"> 
    <span style="color:rgb(0,0,0);">Employee&nbsp;emp&nbsp;</span>
    <span style="color:rgb(0,0,0);">=</span>
    <span style="color:rgb(0,0,0);">&nbsp;sqlMap.QueryForObject</span>
    <span style="color:rgb(0,0,0);">&lt;</span>
    <span style="color:rgb(0,0,0);">Employee</span>
    <span style="color:rgb(0,0,0);">&gt;</span>
    <span style="color:rgb(0,0,0);">(</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">GetEmployee</span>
    <span style="color:rgb(0,0,0);">"</span>
    <span style="color:rgb(0,0,0);">,&nbsp;number);</span> 
   </div> 
   <br style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">
   <p style="line-height:1.8;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"></p> 
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">再不需要其它的了。这一行代码会执行</span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">SQL</span>
   <span style="color:rgb(51,51,51);font-size:14px;font-family:'宋体';">语句，设置参数值，返回一个</span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">C#</span>
   <span style="color:rgb(51,51,51);font-size:14px;font-family:'宋体';">对象作为结果。</span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">SQL</span>
   <span style="color:rgb(51,51,51);font-size:14px;font-family:'宋体';">被很好地封装在了</span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">XML</span>
   <span style="color:rgb(51,51,51);font-size:14px;font-family:'宋体';">文件中。</span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">iBATIS</span>
   <span style="color:rgb(51,51,51);font-size:14px;font-family:'宋体';">会管理所有藏在“幕后”的资源，其结果则于清单</span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">2.2</span>
   <span style="color:rgb(51,51,51);font-size:14px;font-family:'宋体';">中的</span>
   <span style="color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">ADO.NET</span>
   <span style="color:rgb(51,51,51);font-size:14px;font-family:'宋体';">代码相同。</span> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">上述方式引出一个问题，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">会以相同的方式工作于所有系统？它是否特别适合于某些特定类型的应用？下面几个小节将回答这个问题，先看看</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">是多么适合小型应用程序。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.2.1&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">在小型、简单的系统中使用</span><span style="line-height:1.8;">iBATIS</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">小的应用程序通常只使用单个数据库，用户界面和领域模型（</span><span style="line-height:1.8;">domain model</span><span style="line-height:1.8;font-family:'宋体';">）也较为简单。业务逻辑非常基础，甚至在一些简单的</span><span style="line-height:1.8;">CRUD</span><span style="line-height:1.8;font-family:'宋体';">（</span><span style="line-height:1.8;">Create</span><span style="line-height:1.8;font-family:'宋体';">，</span><span style="line-height:1.8;">Read</span><span style="line-height:1.8;font-family:'宋体';">，</span><span style="line-height:1.8;">Update</span><span style="line-height:1.8;font-family:'宋体';">，</span><span style="line-height:1.8;">Delete</span><span style="line-height:1.8;font-family:'宋体';">）应用程序中根本不存在。有三种原因使得</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">很适合于这种小型的应用程序。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">首先，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">本身就是小巧而简单的。它不需要服务器和任何其它中间件（</span><span style="line-height:1.8;">middleware</span><span style="line-height:1.8;font-family:'宋体';">）。不需要任何额外机制的支持。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">不依赖于其它第三方组件。一份最小的</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">安装只需引用一个</span><span style="line-height:1.8;">dll</span><span style="line-height:1.8;font-family:'宋体';">文件和</span><span style="line-height:1.8;">244KB</span><span style="line-height:1.8;font-family:'宋体';">的磁盘空间。除了</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">映射文件，再不需要其它安装，因此只需几分钟时间，您就可以拥有一个可以使用的数据持久层了。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">其次，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">不会影响到既有的应用程序或数据库的设计。因此，如果您有一个小型应用程序，已经有了部分实现，甚至已经发布了，都可以使用</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">对持久层进行重构。因为</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">的简单，它不会使您的程序结构过于复杂，这一点</span><span style="line-height:1.8;">O/RM</span><span style="line-height:1.8;font-family:'宋体';">工具或代码生成器未必能够保证，因为它们总是基于对应用程序或数据库所作的某种假设。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">最后，如果您已经经历过一段时间的软件开发，那么应该同意，小的软件系统成长为大的系统几乎是不可避免的。所有成功的软件都有着成长的趋势。值得庆幸的是，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">也适合于大型软件系统，它可以满足企业级应用程序的需要。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.2.2&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">在大型的，企业级系统中使用</span><span style="line-height:1.8;">iBATIS</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">是为企业级应用程序而设计的。首先要说的是，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">在此领域相比于其它解决方案拥有诸多优势。从大规模（</span><span style="line-height:1.8;">large-scale</span><span style="line-height:1.8;font-family:'宋体';">）的应用程序到企业级系统，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">的原创者都曾有机会参与过，这些系统通常涉及多个数据库，而他却都无法对其进行管理和控制。在第一章中我们讨论了各种类型的数据库，包括企业数据库，</span><span style="line-height:1.8;">proprietary</span><span style="line-height:1.8;font-family:'宋体';">数据库和遗留数据库。我们在编写</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">时很大程度上是为了能够处理这一类的数据库。最终，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">拥有大量特性，使得它很适合于企业级系统。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">首先的一点已在前面提到过，但是它如此重要，值得再次声明：</span><em><span style="line-height:1.8;">iBATIS</span></em><em><span style="line-height:1.8;font-family:'宋体';">不对您的数据库或对象模型作任何假设</span></em><span style="line-height:1.8;font-family:'宋体';">。不管这两种设计间是如何得不匹配，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">总会有效。此外，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">不对您的企业系统的架构作任何假设。不论您的数据库是按业务功能纵向划分，还是从技术上横向划分，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">都能够将它与您的</span><span style="line-height:1.8;">OO</span><span style="line-height:1.8;font-family:'宋体';">应用程序有效地整合起来。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">其次，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">可以有效地处理很大规模的数据。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">支持像</span><span style="line-height:1.8;">row handler</span><span style="line-height:1.8;font-family:'宋体';">这样的特性，可以对大量记录进行批处理。它还支持获取某个范围内的数据，这样我们可以仅仅获取当前必须的数据。如果您有</span><span style="line-height:1.8;">10000</span><span style="line-height:1.8;font-family:'宋体';">条记录，但是只需要第</span><span style="line-height:1.8;">500-600</span><span style="line-height:1.8;font-family:'宋体';">条记录，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">可以轻松实现。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">支持</span><span style="line-height:1.8;">driver hint</span><span style="line-height:1.8;font-family:'宋体';">，从而可以高效地完成这些操作。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">最后，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">允许将对象以多种方式映射至数据库。企业应用系统的功能以单一模式实现的情况是很少的。很多企业级系统需要在白天进行事务处理，而在夜间进行数据批处理操作。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">允许以多种方式映射，保证了每种业务处理都能以尽可能高效的方式进行。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">还支持多种访问策略。您可以选择都某些数据进行延迟加载，通过</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">来加载那些复杂属性，避免带来严重的性能问题。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">看到这里，您也许觉得这很像一个促销广告。那何不说说为什么需要</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">呢？我们将在</span><span style="line-height:1.8;">2.5</span><span style="line-height:1.8;font-family:'宋体';">节中做更详细的说明。为公平起见，我们会在稍后的</span><span style="line-height:1.8;">2.4</span><span style="line-height:1.8;font-family:'宋体';">节中讨论一些您不需要使用</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">的情况。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-weight:bold;"><span style="line-height:1.8;">2.3&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">为什么要使用</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">？</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.3.1&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">简单</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">是当前公认的最简单的持久层框架之一。简单是</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">团队设计目标的核心，其重要性几乎要超过其它任何方面。它的简单是通过它构建的基础来达到的：</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">和</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">对于</span><span style="line-height:1.8;">.NET</span><span style="line-height:1.8;font-family:'宋体';">程序员来说是简单的，因为它使用起来像</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">，只不过代码少了许多。几乎所有您对</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">的了解都适用于</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">，我们可以把</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">视作以</span><span style="line-height:1.8;">XML</span><span style="line-height:1.8;font-family:'宋体';">格式描述的</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">代码。前面说过，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">包含很多</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">所不具备的架构上的优点，我们会在后面讨论。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">对于数据库管理员和</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">开发人员来说也是简单的。几乎任何拥有</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">编程经验的开发人员都很容易理解</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">的配置文件。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.3.2&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">生产力</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">一个好框架要考虑的第一要旨是使开发人员更具生产力。通常框架会处理一些通用任务，减少重复性（</span><span style="line-height:1.8;">boilerplate</span><span style="line-height:1.8;font-family:'宋体';">）的编码，解决复杂的架构问题。在一项由意大利</span><span style="line-height:1.8;">Java</span><span style="line-height:1.8;font-family:'宋体';">用户组进行的案例研究（</span><span style="line-height:1.8;">http://www.jugsardegna.org/vqwiki/jsp/Wiki?IBatisCaseStudy</span><span style="line-height:1.8;font-family:'宋体';">）中，</span><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">Fabrizio Gianneschi</span><span style="line-height:1.8;font-family:'宋体';">发现</span><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">可以减少持久层的代码达</span><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">62</span><span style="line-height:1.8;font-family:'宋体';">％之多。</span><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">SQL</span><span style="line-height:1.8;font-family:'宋体';">依然需要手工编写，但如您先前所见，</span><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">SQL</span><span style="line-height:1.8;font-family:'宋体';">不是问题——不管您是使用</span><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">JDBC</span><span style="line-height:1.8;font-family:'宋体';">还是</span><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">译注：这项研究将一个项目由原来的</span><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">JDBC</span><span style="line-height:1.8;font-family:'宋体';">转换为</span><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">代码，得出了上述结论。但对于</span><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">是何结果就不得而知了，但相信也能减少大量代码。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'newbaskerville-roman', serif;">2.3.3&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">性能</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">性能这个主题能够引发框架作者、用户甚至商用软件商的争论。事实上，在较低层次上来看，任何框架都会存在或多或少的性能损失。一般地，比较一下手工编写的</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">和</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">，在一个</span><span style="line-height:1.8;">for</span><span style="line-height:1.8;font-family:'宋体';">循环中遍历一百万次，会发现</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">更具优势。幸运的是，在当今应用程序开发中，这并不是关键的性能点。更为重要的是，如何从数据库中获取数据，何时获取它，以及获取的频率。例如，从数据库中获取分页后的列表数据能显著地提升应用程序的性能，因为这样就避免了一次加载过多的数据。类似的，使用像延迟加载（</span><span style="line-height:1.8;">lazy load</span><span style="line-height:1.8;font-family:'宋体';">）这样的特性可以避免在给定的用例下加载不必要的数据。另一方面，如果我们确定需要加载复杂的对象属性，而这些属性来自于多个数据表，那么使用单条</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">来加载数据也可以极大地改善性能。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">提供了多种性能优化策略，我们将在后面讨论。现在，我们要知道，通常要以简单的方式来配置</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">，但它的性能会像</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">一样好，甚至更好。另一个需要考虑的地方是，并不是所有的</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">代码都能编写得很好。</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">是一个复杂的</span><span style="line-height:1.8;">API</span><span style="line-height:1.8;font-family:'宋体';">，要想正确使用需要注意很多地方。不幸的是，很多</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">代码编写的不好，导致其性能甚至不如</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.3.4&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">分离关注点</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">在典型的</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">代码中，有时会看到数据库资源如连接、结果集散布在程序各个层中。在一些糟糕的程序中，我们会看到数据库连接、语句出现在表现层。这实在是恶梦般的经历。在第一章中我们曾讨论过应用程序分层的重要性。我们看到了应用程序如何在较高层次上分层，持久层是如何处于中间层次的。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">提供了此种分层的支持，它会管理所有数据持久相关的资源，如数据库连接，语句和结果集等。它提供了数据库无关的接口和</span><span style="line-height:1.8;">API</span><span style="line-height:1.8;font-family:'宋体';">，帮助应用程序中的其它层能够与任何数据持久相关的资源保持独立。使用</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">，我们面对的是真正的对象，而不是任意的结果集。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">使保持良好的分层变成一件容易的事。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.3.5&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">分工</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">有的数据库管理员很是珍爱他们的数据库，以至于不愿意其它人为其编写</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">。还有的人很擅长编写</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">，其他人都希望由他们来写</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">。不管处于何种情况，我们总是应该好好利用团队成员的优势。如果团队里有人特别擅长编写</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">，而不太喜欢编写</span><span style="line-height:1.8;">C#</span><span style="line-height:1.8;font-family:'宋体';">代码，那就让他们尽情地写</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">吧。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">使之成为可能。因为</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">语句和应用程序代码分离得非常清楚，</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">开发人员可以按其固有的方式进行开发，而不用担心什么字符串的拼接。即使有开发人员同时开发</span><span style="line-height:1.8;">C#</span><span style="line-height:1.8;font-family:'宋体';">代码和</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">，如果</span><span style="line-height:1.8;">DBA</span><span style="line-height:1.8;font-family:'宋体';">想优化数据库的性能，只要说“让我看看</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">”。如果使用</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">就没这么简单了，因为</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">往往包含在一连串的字符串拼接中，或者是由遍历和条件动态动态生成。使用</span><span style="line-height:1.8;">O/RM</span><span style="line-height:1.8;font-family:'宋体';">会更糟糕，我们必须运行程序，然后在日志中输出语句，即使找到了，也不能做任何事情。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">使得任何人都可以自由地开发、查看、修改</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">语句。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.3.6&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">可移植性：</span><span style="line-height:1.8;">Java</span><span style="line-height:1.8;font-family:'宋体';">，</span><span style="line-height:1.8;">.NET</span><span style="line-height:1.8;font-family:'宋体';">以及其它</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">可移植性是很强的。这得益于其相对简单的设计，它可以实现于几乎任何语言和平台上。在编写本书的时候，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">支持三种最流行的开发平台：</span><span style="line-height:1.8;">Java</span><span style="line-height:1.8;font-family:'宋体';">，</span><span style="line-height:1.8;">Ruby</span><span style="line-height:1.8;font-family:'宋体';">和</span><span style="line-height:1.8;">C#</span><span style="line-height:1.8;font-family:'宋体';">。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">在当前配置文件还不是完全平台兼容的，但我们已有计划向这个目标靠近。更为重要的是，其<em>概念</em>和<em>方式</em>是可移植性很强的。这样我们所有应用程序的设计可以保持一致。对于语言和应用程序的类型来说，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">比任何其它框架支持得都多。如果在您的程序中一致性非常重要，那么</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">将是很好的选择。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.3.7&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">开源和可信度</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">前面我们说这一节是“促销广告”。事实上，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">是免费的，开源的软件。无论您使用与否，我们不会从中获得任何收益。您已经购买了这本书，这就是我们所“赚”的钱了。开源软件最大的优势之一是<em>可信</em>。我们没有任何理由扭曲事实或者欺骗您。坦率地说，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">不是所有问题的最佳解决方案。下面我们来点商用软件文档中绝少出现的内容，讨论一下何种情况下不必使用</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">，给出一些其它可行的方案。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-weight:bold;">2.4&nbsp;</span><span style="line-height:1.8;font-family:'宋体';font-weight:bold;">何时不用</span><span style="line-height:1.8;"><span style="line-height:1.8;font-weight:bold;">iBATIS</span></span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">每一种框架都建立在规则和约束之上。较低层次的框架如</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">提供了灵活、完整的特性，却更难使用。较高层次的框架如</span><span style="line-height:1.8;">O/RM</span><span style="line-height:1.8;font-family:'宋体';">工具非常易用，减少了很多工作量，但它们建立更多的假设和约束之上，使得它们不能应用于更多的应用程序。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">是一个中等层次的框架。它较</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">要高，又比</span><span style="line-height:1.8;">O/RM</span><span style="line-height:1.8;font-family:'宋体';">工具要低。这样</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">实际上处于一个独特的位置，它有自己适用的范围。在前面几节中，我们讨论了</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">为何可用于各种类型的应用程序，包括小型的，富客户端的，大型的，企业级的以及</span><span style="line-height:1.8;">Web</span><span style="line-height:1.8;font-family:'宋体';">应用程序——还有其它处于中间层次的应用程序。那么何时</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">不适合使用呢？下面几个小节中我们会详细描述这样的几种情况，也会推荐一些可选的方案。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.4.1&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">如果您拥有完全的控制权</span><span style="line-height:1.8;">…</span><span style="line-height:1.8;font-family:'宋体';">直至永远</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">如果您获得保证，可以完全地控制应用程序和数据库的设计，那您实在是太幸运了。不过这在企业环境或核心竞争力不在软件开发方面的业务中并不多见。但是，如果您在一家软件公司工作，开发受保护的产品，并对其有着完全的控制权，那么可能就是这种情况。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">如果您拥有完全的控制权，那么就有足够的理由使用</span><span style="line-height:1.8;">O/RM</span><span style="line-height:1.8;font-family:'宋体';">工具，如</span><span style="line-height:1.8;">NHibernate</span><span style="line-height:1.8;font-family:'宋体';">。您可以充分利用</span><span style="line-height:1.8;">O/RM</span><span style="line-height:1.8;font-family:'宋体';">带来的设计上的好处和开发效率的提高。这样也许和一个企业数据库组或要集成的遗留系统不存在任何冲突。此外，数据库可能和应用程序部署在一起，这样的数据库属于应用程序数据库（见第</span><span style="line-height:1.8;">1</span><span style="line-height:1.8;font-family:'宋体';">章）。使用</span><span style="line-height:1.8;">Hibernate</span><span style="line-height:1.8;font-family:'宋体';">的项目的一个好例子是</span><span style="line-height:1.8;">Atlassian</span><span style="line-height:1.8;font-family:'宋体';">的</span><span style="line-height:1.8;">JIRA</span><span style="line-height:1.8;font-family:'宋体';">。他们提供了问题跟踪软件作为产品，他们对其有完全的控制。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">一定要考虑应用程序未来会有何变化。如果有可能失去对数据库的控制权，那么就该仔细考虑它对您的持久层策略带来的影响。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.4.2&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">如果您的程序中</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">完全是动态生成的</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">如果您的程序的核心功能是</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">的动态生成，那么</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">是错误的选择。</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">有着很强大的动态</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">特性，支持高级查询，甚至是一些动态的更新功能。但如果程序中的每条语句都是动态生成的，那么您最好还是使用原生的</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">，或者构建自己的框架。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">的强大很大程度上体现在允许开发人员自由地<strong>手工编写</strong></span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">，直接操作</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">。如果大部分</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">都是动态生成的，那么这个优势无疑就丧失掉了。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.4.3&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">如果您不是使用关系型数据库</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">当前已经有可用于非关系型数据库的</span><span style="line-height:1.8;">ADO.NET Provider</span><span style="line-height:1.8;font-family:'宋体';">了，如针对文本文件的，</span><span style="line-height:1.8;">MS Excel</span><span style="line-height:1.8;font-family:'宋体';">的，</span><span style="line-height:1.8;">XML</span><span style="line-height:1.8;font-family:'宋体';">的，还有其它类型的数据存储。尽管已经有人成功地将其应用在</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">中，对于大多数用户，我们还是不推荐这样使用。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">不会对您的环境做出很多假设。但它仍然希望您使用的是一款真正的关系型数据库，同时支持事务和相对标准的</span><span style="line-height:1.8;">SQL</span><span style="line-height:1.8;font-family:'宋体';">及存储过程。即使是一些知名的数据库也会有不支持关系型数据库关键特性的情况。</span><span style="line-height:1.8;">MySQL</span><span style="line-height:1.8;font-family:'宋体';">的早期版本不支持事务，因此</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">用起来就不太好。好在现在的</span><span style="line-height:1.8;">MySQL</span><span style="line-height:1.8;font-family:'宋体';">已经支持事务，还提供了不错的</span><span style="line-height:1.8;">ADO.NET Provider</span><span style="line-height:1.8;font-family:'宋体';">。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">译注：看看</span><span style="line-height:1.8;"><span style="line-height:1.8;font-family:'宋体';"><span style="line-height:1.8;"><a href="http://www.connectionstrings.com/" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;">这里</a></span></span></span><span style="line-height:1.8;font-family:'宋体';">，</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">支持多少类型的数据存储。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">如果您不是使用真正的关系型数据库，我们建议您使用原生的</span><span style="line-height:1.8;">ADO.NET</span><span style="line-height:1.8;font-family:'宋体';">甚至是更低层次的文件</span><span style="line-height:1.8;">I/O API</span><span style="line-height:1.8;font-family:'宋体';">。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">2.4.4&nbsp;</span><span style="line-height:1.8;font-family:'宋体';">如果</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">不能奏效</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">社区的需求在不断增加，所以有很多特性正在开发过程中。但是</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">有自己的方向和设计宗旨，这有时可能会发生冲突。人们在开发过程中可能会做一些惊人的事情，在有些情况下，</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">不能奏效，因为需求太过复杂。尽管我们可以添加功能来满足这些需求，却会带来极大的复杂性或者超出了</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">框架的范围之外。最终，我们决定不去改变框架。为满足这些需求，我们会设法提供可插入（</span><span style="line-height:1.8;">pluggable</span><span style="line-height:1.8;font-family:'宋体';">）的接口，这样您就可以扩展</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">来满足几乎任何需要。有时情况很简单，它就是不能使用。这时，最好去选择更好的解决方案，而不是对</span><span style="line-height:1.8;">iBATIS</span><span style="line-height:1.8;font-family:'宋体';">（任何框架都是如此）勉为其难。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">关于</span><span style="line-height:1.8;">Why</span><span style="line-height:1.8;font-family:'宋体';">和</span><span style="line-height:1.8;">Why not</span><span style="line-height:1.8;font-family:'宋体';">就到此为止吧，下一次我们来看一个简单的例子。</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;font-family:'宋体';">译注：这一部分就是不停地为iBATIS美言，像我很喜欢它的，都有点不好意思了。客观地说，iBATIS很不错，适用的程序类型很广泛，但这也导致了它在某些时候不如一些更“专一”的框架好用。据我所知，在Java社区，iBATIS的使用率比起Hibernate来还是有不小的差距。它的SQL是它的灵活和强大之处，维护起来却是个问题。但我感觉如果你要使用ADO.NET，一般情况下iBATIS会给你带来不小的帮助。可以看看Petshop里面的数据持久层，它维护起来要比iBATIS难很多。<br></span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">下载<a href="http://files.cnblogs.com/anderslly/IBatisInActionCh02.zip" rel="nofollow" style="text-decoration:none;color:rgb(61,129,238);border-bottom-width:1px;border-bottom-style:dashed;">本文相关代码</a>。&nbsp;<br></span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;">第一次想这么严格地翻译一些东西，很多地方比较生硬，大家有何建议，请提一下，帮我改进下 :)</span></p> 
   <p align="left" style="line-height:1.8;font-size:13px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;"><span style="line-height:1.8;"><br></span></p> 
   <p align="left" style="line-height:1.8;"><span style="line-height:1.8;"><font color="#333333"><span style="font-size:13px;">本文转自一个程序员的自省博客园博客，原文链接：http://www.cnblogs.com/anderslly/archive/2007/08/19/ibatisinactionch021.html，如需转载请自行联系原作者。</span></font><br></span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
