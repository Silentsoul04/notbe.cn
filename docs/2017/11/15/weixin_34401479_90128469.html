<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>【solr这四个主题】大约VelocityResponseWriter « NotBeCN</title>
  <meta name="description" content="             一个、大约Velocity基本配置    &nbsp; &nbsp; 在Solr在，可以以多种方式返回搜索结果，作为一个简单的文字回复（XML、JSON、CSV等待），能够返回velocity。js等格式。而VelocityResponseWriter就是用于将返回velocity类型文...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/15/weixin_34401479_90128469.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">【solr这四个主题】大约VelocityResponseWriter</h1>
    <p class="post-meta">Nov 15, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:24px;">一个、大约Velocity基本配置</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; 在Solr在，可以以多种方式返回搜索结果，作为一个简单的文字回复（XML、JSON、CSV等待），能够返回velocity。js等格式。而VelocityResponseWriter就是用于将返回velocity类型文本，以便直接用于结果呈现。</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp;在Solr提供的example，当中的一个RequestHandler--/browse。使用了VelocityResponseWriter。</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">其配置例如以下：</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp;&nbsp;</p> 
   <pre><code class="language-html">  &lt;requestHandler name="/browse" class="solr.SearchHandler"&gt;
     &lt;lst name="defaults"&gt;
       &lt;str name="echoParams"&gt;explicit&lt;/str&gt;

       &lt;!-- VelocityResponseWriter settings --&gt;
       &lt;str name="wt"&gt;velocity&lt;/str&gt;
       &lt;str name="v.template"&gt;browse&lt;/str&gt;
       &lt;str name="v.layout"&gt;layout&lt;/str&gt;
       &lt;str name="title"&gt;Solritas_test&lt;/str&gt;

       &lt;!-- Query settings --&gt;
       &lt;str name="defType"&gt;edismax&lt;/str&gt;
       &lt;str name="qf"&gt;
          text^0.5 features^1.0 name^1.2 sku^1.5 id^10.0 manu^1.1 cat^1.4
          title^10.0 description^5.0 keywords^5.0 author^2.0 resourcename^1.0
       &lt;/str&gt;
       &lt;str name="df"&gt;text&lt;/str&gt;
       &lt;str name="mm"&gt;100%&lt;/str&gt;
       &lt;str name="q.alt"&gt;*:*&lt;/str&gt;
       &lt;str name="rows"&gt;10&lt;/str&gt;
       &lt;str name="fl"&gt;*,score&lt;/str&gt;

       &lt;str name="mlt.qf"&gt;
         text^0.5 features^1.0 name^1.2 sku^1.5 id^10.0 manu^1.1 cat^1.4
         title^10.0 description^5.0 keywords^5.0 author^2.0 resourcename^1.0
       &lt;/str&gt;
       &lt;str name="mlt.fl"&gt;text,features,name,sku,id,manu,cat,title,description,keywords,author,resourcename&lt;/str&gt;
       &lt;int name="mlt.count"&gt;3&lt;/int&gt;

       &lt;!-- Faceting defaults --&gt;
       &lt;str name="facet"&gt;on&lt;/str&gt;
       &lt;str name="facet.field"&gt;cat&lt;/str&gt;
       &lt;str name="facet.field"&gt;manu_exact&lt;/str&gt;
       &lt;str name="facet.field"&gt;content_type&lt;/str&gt;
       &lt;str name="facet.field"&gt;author_s&lt;/str&gt;
       &lt;str name="facet.query"&gt;ipod&lt;/str&gt;
       &lt;str name="facet.query"&gt;GB&lt;/str&gt;
       &lt;str name="facet.mincount"&gt;1&lt;/str&gt;
       &lt;str name="facet.pivot"&gt;cat,inStock&lt;/str&gt;
       &lt;str name="facet.range.other"&gt;after&lt;/str&gt;
       &lt;str name="facet.range"&gt;price&lt;/str&gt;
       &lt;int name="f.price.facet.range.start"&gt;0&lt;/int&gt;
       &lt;int name="f.price.facet.range.end"&gt;600&lt;/int&gt;
       &lt;int name="f.price.facet.range.gap"&gt;50&lt;/int&gt;
       &lt;str name="facet.range"&gt;popularity&lt;/str&gt;
       &lt;int name="f.popularity.facet.range.start"&gt;0&lt;/int&gt;
       &lt;int name="f.popularity.facet.range.end"&gt;10&lt;/int&gt;
       &lt;int name="f.popularity.facet.range.gap"&gt;3&lt;/int&gt;
       &lt;str name="facet.range"&gt;manufacturedate_dt&lt;/str&gt;
       &lt;str name="f.manufacturedate_dt.facet.range.start"&gt;NOW/YEAR-10YEARS&lt;/str&gt;
       &lt;str name="f.manufacturedate_dt.facet.range.end"&gt;NOW&lt;/str&gt;
       &lt;str name="f.manufacturedate_dt.facet.range.gap"&gt;+1YEAR&lt;/str&gt;
       &lt;str name="f.manufacturedate_dt.facet.range.other"&gt;before&lt;/str&gt;
       &lt;str name="f.manufacturedate_dt.facet.range.other"&gt;after&lt;/str&gt;

       &lt;!-- Highlighting defaults --&gt;
       &lt;str name="hl"&gt;on&lt;/str&gt;
       &lt;str name="hl.fl"&gt;content features title name&lt;/str&gt;
       &lt;str name="hl.encoder"&gt;html&lt;/str&gt;
       &lt;str name="hl.simple.pre"&gt;&lt;b&gt;&lt;/str&gt;
       &lt;str name="hl.simple.post"&gt;&lt;/b&gt;&lt;/str&gt;
       &lt;str name="f.title.hl.fragsize"&gt;0&lt;/str&gt;
       &lt;str name="f.title.hl.alternateField"&gt;title&lt;/str&gt;
       &lt;str name="f.name.hl.fragsize"&gt;0&lt;/str&gt;
       &lt;str name="f.name.hl.alternateField"&gt;name&lt;/str&gt;
       &lt;str name="f.content.hl.snippets"&gt;3&lt;/str&gt;
       &lt;str name="f.content.hl.fragsize"&gt;200&lt;/str&gt;
       &lt;str name="f.content.hl.alternateField"&gt;content&lt;/str&gt;
       &lt;str name="f.content.hl.maxAlternateFieldLength"&gt;750&lt;/str&gt;

       &lt;!-- Spell checking defaults --&gt;
       &lt;str name="spellcheck"&gt;on&lt;/str&gt;
       &lt;str name="spellcheck.extendedResults"&gt;false&lt;/str&gt;
       &lt;str name="spellcheck.count"&gt;5&lt;/str&gt;
       &lt;str name="spellcheck.alternativeTermCount"&gt;2&lt;/str&gt;
       &lt;str name="spellcheck.maxResultsForSuggest"&gt;5&lt;/str&gt;
       &lt;str name="spellcheck.collate"&gt;true&lt;/str&gt;
       &lt;str name="spellcheck.collateExtendedResults"&gt;true&lt;/str&gt;
       &lt;str name="spellcheck.maxCollationTries"&gt;5&lt;/str&gt;
       &lt;str name="spellcheck.maxCollations"&gt;3&lt;/str&gt;
     &lt;/lst&gt;

     &lt;!-- append spellchecking to our list of components --&gt;
     &lt;arr name="last-components"&gt;
       &lt;str&gt;spellcheck&lt;/str&gt;
     &lt;/arr&gt;
  &lt;/requestHandler&gt;</code></pre> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">关于velocity这个writer的定义例如以下：</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-html">  &lt;!--
     Custom response writers can be declared as needed...
    --&gt;
    &lt;queryResponseWriter name="velocity" class="solr.VelocityResponseWriter" startup="lazy"/&gt;</code></pre> 
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">处理一个流程的过程例如以下：</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    1、依据请求url查找相关的配置
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    请求的url为：
    <a href="http://localhost:8983/solr/browse" rel="nofollow" style="color:rgb(0,68,170);border-bottom:1px dotted rgb(51,51,51);font-family:sans-serif;font-size:16px;">http://localhost:8983/solr/browse</a> 
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    则在solrConfig.xml中查找 &nbsp;/browse的配置，能够得出上述所看到的的结果。
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    <br>
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    2、当中有关velocity的内容例如以下：
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';"> 
    <pre><code class="language-html">  &lt;requestHandler name="/browse" class="solr.SearchHandler"&gt;
     &lt;lst name="defaults"&gt;
       &lt;str name="echoParams"&gt;explicit&lt;/str&gt;
       &lt;!-- VelocityResponseWriter settings --&gt;
       &lt;str name="wt"&gt;velocity&lt;/str&gt;
       &lt;str name="v.template"&gt;browse&lt;/str&gt;
       &lt;str name="v.layout"&gt;layout&lt;/str&gt;
       &lt;str name="title"&gt;Solritas_test&lt;/str&gt;</code></pre> 
    <br>
    <span style="line-height:1.8;">从上述定义中開始分别查找显示层的内容(vm文件)与处理类的内容(wt的实现类。 </span>
    <p></p> 
    <p>)</p> 
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    <br>
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    3、定位显示内容模板
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    依据v.template属性。定义到文件browse.vm，注意在配置中省略了后缀名vm。
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    因为存在v.layout属性，因此。此属性的值将作为模板，而
    <span style="line-height:1.8;">v.template中的内容将作为$content的内容。 </span>
    <p></p> 
    <p></p> 
   </div> 
   <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"> 
    <ul style="font-family:sans-serif;font-size:16px;">
     <li style="list-style:disc;"> <p>v.layout: Template name that wraps main template (v.template). Main template renders to a $content that can be used in layout template.</p> </li>
    </ul>
    <div>
     <span style="line-height:1.8;font-family:sans-serif;">layout.vm的内容例如以下：</span>
    </div> 
    <div> 
     <span style="line-height:1.8;font-family:sans-serif;"></span>
     <pre><code class="language-html">#**
 *  Overall HTML page layout
 *#

&lt;html&gt;
&lt;head&gt;
  #parse("head.vm")
&lt;/head&gt;
  &lt;body&gt;
    &lt;div id="admin"&gt;&lt;a href="#url_root/#/#core_name"&gt;Solr Admin&lt;/a&gt;&lt;/div&gt;
    &lt;div id="header"&gt;
      #parse("header.vm")
    &lt;/div&gt;
    &lt;div id="tabs"&gt;
      #parse("tabs.vm")
    &lt;/div&gt;
    &lt;div id="content"&gt;
      $content
    &lt;/div&gt;
    &lt;div id="footer"&gt;
      #parse("footer.vm")
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre> 
    </div> 
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    <br>
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    4、定位ResponseWriter&nbsp;
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    &nbsp;从第2步的结果知道，使用的velocity。然后查找这个wt的定义。能够得到
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    &nbsp; &nbsp; &lt;queryResponseWriter name="velocity" class="solr.VelocityResponseWriter" startup="lazy"/&gt;
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    即VelocityResponseWriter实现类，其定义例如以下：
   </div> 
   <pre><code class="language-java">public class VelocityResponseWriter
extends Object
implements QueryResponseWriter</code></pre> 
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';">
    <span style="line-height:1.8;">与Solr返回Velocity相关的类仅仅有4个：</span>
   </div> 
   <div style="color:rgb(51,51,51);font-size:14px;font-family:'微软雅黑';"> 
    <ul style="color:rgb(53,56,51);font-family:Arial, Helvetica, sans-serif;font-size:12px;">
     <li style="list-style:disc;"><a title="class in org.apache.solr.response" href="http://lucene.apache.org/solr/4_9_0/solr-velocity/org/apache/solr/response/PageTool.html" rel="nofollow" style="color:rgb(76,107,135);border-bottom:1px dotted rgb(51,51,51);">PageTool</a></li> 
     <li style="list-style:disc;"><a title="class in org.apache.solr.response" href="http://lucene.apache.org/solr/4_9_0/solr-velocity/org/apache/solr/response/SolrParamResourceLoader.html" rel="nofollow" style="color:rgb(76,107,135);border-bottom:1px dotted rgb(51,51,51);">SolrParamResourceLoader</a></li> 
     <li style="list-style:disc;"><a title="class in org.apache.solr.response" href="http://lucene.apache.org/solr/4_9_0/solr-velocity/org/apache/solr/response/SolrVelocityResourceLoader.html" rel="nofollow" style="color:rgb(76,107,135);border-bottom:1px dotted rgb(51,51,51);">SolrVelocityResourceLoader</a></li> 
     <li style="list-style:disc;"><a title="class in org.apache.solr.response" href="http://lucene.apache.org/solr/4_9_0/solr-velocity/org/apache/solr/response/VelocityResponseWriter.html" rel="nofollow" style="color:rgb(76,107,135);border-bottom:1px dotted rgb(51,51,51);">VelocityResponseWriter</a></li> 
    </ul>
   </div> 
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">下面是关于VelocityResponseWriter的官方说明：http://wiki.apache.org/solr/VelocityResponseWriter</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <h1 style="line-height:1.5;font-size:28px;font-family:sans-serif;">Introduction</h1> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">VelocityResponseWriter (aka&nbsp;<a href="http://wiki.apache.org/solr/Solritas" rel="nofollow" style="color:rgb(0,68,170);border:0px;">Solritas</a>) enables Solr to respond with content generated from&nbsp;<a class="http" href="http://velocity.apache.org/" rel="nofollow" style="color:rgb(0,68,170);border:0px;">Velocity</a>&nbsp;templates. Along with technologies like SolrJS, this makes Solr itself capable of driving sophisticated search interfaces without the need for an intermediate application server between the browser and Solr.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">See&nbsp;<a class="https" href="https://issues.apache.org/jira/browse/SOLR-620" rel="nofollow" style="color:rgb(0,68,170);border:0px;">SOLR-620</a>&nbsp;for more information.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></p> 
   <div class="table-of-contents" style="color:rgb(51,51,51);border:1px solid rgb(187,187,187);font-size:13px;font-family:sans-serif;"> 
    <p style="margin-left:auto;font-weight:bold;letter-spacing:.075em;">Contents</p> 
    <ol>
     <li style="list-style:decimal;"><a href="http://wiki.apache.org/solr/VelocityResponseWriter#Introduction" rel="nofollow" style="color:rgb(0,68,170);border:0px;">Introduction</a></li> 
     <li style="list-style:decimal;"> <a href="http://wiki.apache.org/solr/VelocityResponseWriter#Instructions_to_use.2C_Solr_1.4.2B-" rel="nofollow" style="color:rgb(0,68,170);border:0px;">Instructions to use, Solr 1.4+</a> 
      <ol>
       <li style="list-style:decimal;"> <a href="http://wiki.apache.org/solr/VelocityResponseWriter#Sample_Usage" rel="nofollow" style="color:rgb(0,68,170);border:0px;">Sample Usage</a> 
        <ol>
         <li style="list-style:decimal;"><a href="http://wiki.apache.org/solr/VelocityResponseWriter#Using_the_VelocityResponseWriter_in_Solr_Core" rel="nofollow" style="color:rgb(0,68,170);border:0px;">Using the VelocityResponseWriter in Solr Core</a></li>
        </ol></li>
      </ol></li> 
     <li style="list-style:decimal;"> <a href="http://wiki.apache.org/solr/VelocityResponseWriter#Instructions_to_use.2C_Solr_4.0.2B-" rel="nofollow" style="color:rgb(0,68,170);border:0px;">Instructions to use, Solr 4.0+</a> 
      <ol>
       <li style="list-style:decimal;"><a href="http://wiki.apache.org/solr/VelocityResponseWriter#Sample_Usage-1" rel="nofollow" style="color:rgb(0,68,170);border:0px;">Sample Usage</a></li>
      </ol></li> 
     <li style="list-style:decimal;"><a href="http://wiki.apache.org/solr/VelocityResponseWriter#Options_.28All_Versions.29" rel="nofollow" style="color:rgb(0,68,170);border:0px;">Options (All Versions)</a></li> 
     <li style="list-style:decimal;"><a href="http://wiki.apache.org/solr/VelocityResponseWriter#Velocity_Context" rel="nofollow" style="color:rgb(0,68,170);border:0px;">Velocity Context</a></li> 
     <li style="list-style:decimal;"><a href="http://wiki.apache.org/solr/VelocityResponseWriter#TODO" rel="nofollow" style="color:rgb(0,68,170);border:0px;">TODO</a></li> 
    </ol>
   </div> 
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span>
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></p> 
   <h1 style="line-height:1.5;font-size:28px;font-family:sans-serif;">Instructions to use, Solr 1.4+</h1> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">These steps will get you up and running for the examples below:<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:disc;">Download and install Solr 1.4.x<span class="anchor" style="line-height:1.8;"></span> </li> 
    <li style="list-style:disc;">Fire up Solr: cd example; java -Dsolr.solr.home=../contrib/velocity/src/main/solr/ -jar start.jar<span class="anchor" style="line-height:1.8;"></span> </li> 
    <li style="list-style:disc;">Index sample docs: cd example/exampledocs; java -jar post.jar *.xml<span class="anchor" style="line-height:1.8;"></span> </li> 
    <li style="list-style:disc;">Hit the examples below...<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></p> 
   <h2 style="line-height:1.5;font-size:21px;font-family:sans-serif;">Sample Usage</h2> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"><a class="http" href="http://localhost:8983/solr/itas" rel="nofollow" style="color:rgb(0,68,170);border:0px;">http://localhost:8983/solr/itas</a><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:none;">Renders browse.vm from conf/velocity. Faceted navigation included.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li>
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"><a class="http" href="http://localhost:8983/solr/itas?%3C/p%3E%3Cp%3Ev.template.header=Custom%20Header" rel="nofollow" style="color:rgb(0,68,170);border:0px;">http://localhost:8983/solr/itas?v.template.header=Custom%20Header</a><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:none;">Renders browse.vm, but overrides the header.vm from conf/velocity with the specified value.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li>
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"><a class="http" href="http://localhost:8983/solr/itas?%3C/p%3E%3Cp%3EdebugQuery=true" rel="nofollow" style="color:rgb(0,68,170);border:0px;">http://localhost:8983/solr/itas?debugQuery=true</a><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:none;">Renders browse.vm, adding in explanation views per hit, and a Velocity context dump at the end.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li>
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></p> 
   <h3 style="font-size:16px;line-height:1.5;font-family:sans-serif;">Using the VelocityResponseWriter in Solr Core</h3> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">The VelocityResponseWriter is still a contrib component in Solr 1.4.x. In order to use it with the core distributions the following steps need to be followed:<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">The following jars need to be copied from contrib/velocity/src/main/solr/lib/ to $SOLR_HOME/lib:<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:disc;">apache-solr-velocity-1.4-dev.jar<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li class="gap" style="list-style:disc;">velocity-1.6.1.jar<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li class="gap" style="list-style:disc;">velocity-tools-2.0-beta3.jar<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li class="gap" style="list-style:disc;">commons-beanutils-1.7.0.jar<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li class="gap" style="list-style:disc;">commons-collections-3.2.1.jar<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">The VelocityResponseWriter uses a more recent version of the commons lang jar than the current version of Solr core, so the jar commons-lang-2.4.jar from .../contrib/velocity/src/main/solr/lib/ should replace $SOLR_HOME/lib/commons-lang-2.1.jar<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">Add some configuration for this&nbsp;<a class="nonexistent" href="http://wiki.apache.org/solr/ResponseWriter" rel="nofollow" style="color:rgb(102,102,102);border:0px;">ResponseWriter</a>&nbsp;to solrconfig.xml like this:<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <pre><span class="anchor" style="line-height:1.8;"></span>    &lt;queryResponseWriter name="velocity" class="org.apache.solr.request.VelocityResponseWriter"/&gt;</pre> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">Set up a&nbsp;<a class="nonexistent" href="http://wiki.apache.org/solr/RequestHandler" rel="nofollow" style="color:rgb(102,102,102);border:0px;">RequestHandler</a>&nbsp;in solrconfig.xml:<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <pre><span class="anchor" style="line-height:1.8;"></span>  &lt;requestHandler name="/itas" class="solr.SearchHandler"&gt;
<span class="anchor" style="line-height:1.8;"></span>     &lt;lst name="defaults"&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="v.template"&gt;browse&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="v.properties"&gt;velocity.properties&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="v.contentType"&gt;text/html;charset=UTF-8&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="title"&gt;Solritas&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="wt"&gt;velocity&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="defType"&gt;dismax&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="q.alt"&gt;*:*&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="rows"&gt;10&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="fl"&gt;*,score&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="facet"&gt;on&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="facet.field"&gt;title&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="facet.mincount"&gt;1&lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;str name="qf"&gt;
<span class="anchor" style="line-height:1.8;"></span>          text^0.5 title^1.5
<span class="anchor" style="line-height:1.8;"></span>       &lt;/str&gt;
<span class="anchor" style="line-height:1.8;"></span>     &lt;/lst&gt;
<span class="anchor" style="line-height:1.8;"></span>     &lt;!--&lt;lst name="invariants"&gt;--&gt;
<span class="anchor" style="line-height:1.8;"></span>       &lt;!--&lt;str name="v.base_dir"&gt;/solr/contrib/velocity/src/main/templates&lt;/str&gt;--&gt;
<span class="anchor" style="line-height:1.8;"></span>     &lt;!--&lt;/lst&gt;--&gt;
<span class="anchor" style="line-height:1.8;"></span>  &lt;/requestHandler&gt;</pre> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">Copy the .../contrib/velocity/src/main/solr/conf/velocity directory to $SOLR_HOME/conf/. This directory contains the Velocity templates that will be needed by the VelocityResponseWriter, and also a style sheet, main.css. The templates and style sheet can be edited to customize the display.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></p> 
   <h1 style="line-height:1.5;font-size:28px;font-family:sans-serif;">Instructions to use, Solr 4.0+</h1> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">These steps will get you up and running for the examples below:<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:disc;"> <p>Check out Solr trunk: svn co&nbsp;<a class="http" href="http://svn.apache.org/viewvc/lucene/dev/branches/branch_4x/" rel="nofollow" style="color:rgb(0,68,170);border:0px;">http://svn.apache.org/viewvc/lucene/dev/branches/branch_4x/</a><span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;">Build Solr: ant clean example<span class="anchor" style="line-height:1.8;"></span> </li> 
    <li style="list-style:disc;">Fire up Solr: cd example; java -jar start.jar<span class="anchor" style="line-height:1.8;"></span> </li> 
    <li style="list-style:disc;">Index sample docs: cd example/exampledocs; java -jar post.jar *.xml<span class="anchor" style="line-height:1.8;"></span> </li> 
    <li style="list-style:disc;">Hit the examples below...<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></p> 
   <h2 style="line-height:1.5;font-size:21px;font-family:sans-serif;">Sample Usage</h2> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"><a class="http" href="http://localhost:8983/solr/browse" rel="nofollow" style="color:rgb(0,68,170);border:0px;">http://localhost:8983/solr/browse</a><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:none;">Renders browse.vm from conf/velocity. Faceted navigation included.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li>
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"><a class="http" href="http://localhost:8983/solr/browse?v.template.header=Custom%20Header" rel="nofollow" style="color:rgb(0,68,170);border:0px;">http://localhost:8983/solr/browse?v.template.header=Custom%20Header</a><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:none;">Renders browse.vm, but overrides the header.vm from conf/velocity with the specified value.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li>
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"><a class="http" href="http://localhost:8983/solr/browse?debugQuery=true" rel="nofollow" style="color:rgb(0,68,170);border:0px;">http://localhost:8983/solr/browse?debugQuery=true</a><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:none;">Renders browse.vm, adding in explanation views per hit, and a Velocity context dump at the end.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li>
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></p> 
   <h1 style="line-height:1.5;font-size:28px;font-family:sans-serif;">Options (All Versions)</h1> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:disc;"> <p>v.template: template name to use, without the .vm suffix. If not specified, "default"[.vm] will be used.<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>v.template.&lt;name&gt;: overrides a file system template<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>debugQuery: if true, default view displays explanations for each hit and additional debugging information in the footer.<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>v.json: Escapes and wraps Velocity generated response with v.json parameter as a&nbsp;<a href="http://wiki.apache.org/solr/JavaScript" rel="nofollow" style="color:rgb(0,68,170);border:0px;">JavaScript</a>&nbsp;function.<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>v.layout: Template name that wraps main template (v.template). Main template renders to a $content that can be used in layout template.<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>v.base_dir: overwrites default template load path (conf/velocity/).<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>v.properties: specifies a Velocity properties file to be applied, found using the Solr resource loader mechanism. If not specified, no .properties file is loaded. Example: v.properties=velocity.properties where velocity.properties can be found using Solr's resource loader mechanism, for example in the conf/ directory (not conf/velocity which is for templates only). The .properties file could also be located inside a JAR in the lib/ directory, or other locations.<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>v.contentType: sets the value of the HTTP response's Content-Type header (in case (x)html pages should be UTF-8 (instead of ISO-8859-1) encoded, make sure you set this option to&nbsp;text/xml;charset=UTF-8&nbsp;(for XHTML) and&nbsp;text/html;charset=UTF-8&nbsp;(for HTML), respectively)<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> </li> 
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></p> 
   <h1 style="line-height:1.5;font-size:28px;font-family:sans-serif;">Velocity Context</h1> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:disc;"> <p>esc: a Velocity&nbsp;<a class="http" href="http://velocity.apache.org/tools/releases/1.4/generic/EscapeTool.html" rel="nofollow" style="color:rgb(0,68,170);border:0px;">EscapeTool</a>&nbsp;instance<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>date: a Velocity&nbsp;<a class="http" href="http://velocity.apache.org/tools/releases/1.4/javadoc/org/apache/velocity/tools/generic/ComparisonDateTool.html" rel="nofollow" style="color:rgb(0,68,170);border:0px;">ComparisonDateTool</a>&nbsp;instance<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>list: a Velocity&nbsp;<a class="http" href="http://velocity.apache.org/tools/releases/1.4/javadoc/org/apache/velocity/tools/generic/ListTool.html" rel="nofollow" style="color:rgb(0,68,170);border:0px;">ListTool</a>&nbsp;instance<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>math: a Velocity&nbsp;<a class="http" href="http://velocity.apache.org/tools/releases/1.4/generic/MathTool.html" rel="nofollow" style="color:rgb(0,68,170);border:0px;">MathTool</a>&nbsp;instance<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>number: a Velocity&nbsp;<a class="http" href="http://velocity.apache.org/tools/releases/1.4/javadoc/org/apache/velocity/tools/generic/NumberTool.html" rel="nofollow" style="color:rgb(0,68,170);border:0px;">NumberTool</a>&nbsp;instance<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>page: a&nbsp;<a class="http" href="http://svn.apache.org/viewvc/lucene/dev/trunk/solr/contrib/velocity/src/main/java/org/apache/solr/request/PageTool.java?%3C/p%3E%3Cp%3Eview=markup" rel="nofollow" style="color:rgb(0,68,170);border:0px;">PageTool</a>&nbsp;instance. page only is added to the context when response is a&nbsp;<a class="nonexistent" href="http://wiki.apache.org/solr/QueryResponse" rel="nofollow" style="color:rgb(102,102,102);border:0px;">QueryResponse</a>.<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>request: a&nbsp;<a class="http" href="http://lucene.apache.org/solr/api/org/apache/solr/request/SolrQueryRequest.html" rel="nofollow" style="color:rgb(0,68,170);border:0px;">SolrQueryRequest</a><span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>response: a&nbsp;<a class="http" href="http://lucene.apache.org/solr/api/org/apache/solr/client/solrj/response/QueryResponse.html" rel="nofollow" style="color:rgb(0,68,170);border:0px;">QueryResponse</a>&nbsp;most of the time, but in some cases where&nbsp;<a class="nonexistent" href="http://wiki.apache.org/solr/QueryResponse" rel="nofollow" style="color:rgb(102,102,102);border:0px;">QueryResponse</a>&nbsp;doesn't like the request handlers output (<a href="http://wiki.apache.org/solr/AnalysisRequestHandler" rel="nofollow" style="color:rgb(0,68,170);border:0px;">AnalysisRequestHandler</a>, for example, causes a&nbsp;<a class="nonexistent" href="http://wiki.apache.org/solr/ClassCastException" rel="nofollow" style="color:rgb(102,102,102);border:0px;">ClassCastException</a>&nbsp;parsing "response") the response will be a&nbsp;<a class="nonexistent" href="http://wiki.apache.org/solr/SolrResponseBase" rel="nofollow" style="color:rgb(102,102,102);border:0px;">SolrResponseBase</a>&nbsp;object.<span class="anchor" style="line-height:1.8;"></span></p> </li> 
    <li style="list-style:disc;"> <p>sort: a Velocity&nbsp;<a class="http" href="http://velocity.apache.org/tools/releases/1.4/javadoc/org/apache/velocity/tools/generic/SortTool.html" rel="nofollow" style="color:rgb(0,68,170);border:0px;">SortTool</a>&nbsp;instance<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span></p> </li> 
   </ul>
   <p style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></p> 
   <h1 style="line-height:1.5;font-size:28px;font-family:sans-serif;">TODO</h1> 
   <span class="anchor" style="line-height:1.8;color:rgb(51,51,51);font-family:sans-serif;font-size:16px;"></span>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <ul style="color:rgb(51,51,51);font-family:sans-serif;font-size:16px;">
    <li style="list-style:disc;">Ajax suggest<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li class="gap" style="list-style:disc;">Integrate/adapt to SolrJS<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li class="gap" style="list-style:disc;">Tie in SIMILE Timeline and SIMILE Exhibit<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li class="gap" style="list-style:disc;">Add links in default footer to this wiki page, the Solr request as XML format, and SOLR-620<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li class="gap" style="list-style:disc;">Fix multi-valued fields issue, and fl parameter usage.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li class="gap" style="list-style:disc;">Work on "dist" target so this works easily with a nightly build.<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li class="gap" style="list-style:disc;">Make Velocity tools and engine configuration pluggable<span class="anchor" style="line-height:1.8;"></span><span class="anchor" style="line-height:1.8;"></span> </li> 
    <li style="list-style:disc;"> </li>
   </ul>
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:24px;">二、Velocity文件定位过程</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">1、依据上述分析，首先定位layout.xml</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-html">&lt;html&gt;
&lt;head&gt;
  #parse("head.vm")
&lt;/head&gt;
  &lt;body&gt;
    &lt;div id="admin"&gt;&lt;a href="#url_root/#/#core_name"&gt;Solr Admin&lt;/a&gt;&lt;/div&gt;
    &lt;div id="header"&gt;
      #parse("header.vm")
    &lt;/div&gt;
    &lt;div id="tabs"&gt;
      #parse("tabs.vm")
    &lt;/div&gt;
    &lt;div id="content"&gt;
      $content
    &lt;/div&gt;
    &lt;div id="footer"&gt;
      #parse("footer.vm")
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre> 
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">2、当中content的内容即为browse.vm</span> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-html">&lt;div class="pagination"&gt;
  #parse("pagination_top.vm")
&lt;/div&gt;

## Show Error Message, if any
&lt;div class="error"&gt;
  #parse("error.vm")
&lt;/div&gt;

## Render Results, actual matching docs
&lt;div class="results"&gt;
  #parse("results_list.vm")
&lt;/div&gt;

&lt;div class="pagination"&gt;
  #parse("pagination_bottom.vm")
&lt;/div&gt;</code></pre> 
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">3、browse.vm中最基本的搜索结果为results_list.vm</span> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-html">#**
 *  Render the main Results List
 *#

## Usually displayed inside &lt;div class="results"&gt;

#if($response.response.get('grouped'))

  #foreach($grouping in $response.response.get('grouped'))
    #parse("hit_grouped.vm")
  #end

#else

  #foreach($doc in $response.results)
    #parse("hit.vm")
    ## Can get an extremely simple view of the doc
    ## which might be nicer for debugging
    ##parse("hit_plain.vm")
  #end

#end
</code></pre> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">普通情况下使用hit.vm作呈现，它对页面作了一些美工。</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">在某些情况下，如debug的时候。就使用hit_plain.vm进行呈现。此时将全部的属性呈现出来。</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">二者的对照效果例如以下：</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20140722153807542?%3C/p%3E%3Cp%3Ewatermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvamVkaWFlbF9sdQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" style="border:0px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">4、先查看hit_plain.vm</span> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-html">#**
 *  An extremely plain / debug version of hit.vm
 *#

&lt;table&gt;
  ## For each field
  #foreach( $fieldName in $doc.fieldNames )
    ## For each value
    #foreach( $value in $doc.getFieldValues($fieldName) )
      &lt;tr&gt;
        ## Field Name
        &lt;th align="right" valign="top"&gt;
          #if( $foreach.count == 1 )
            $fieldName:
          #end
        &lt;/th&gt;
        ## Field Value(s)
        &lt;td align="left" valign="top"&gt;
          $esc.html($value) &lt;br/&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    #end     ## end for each value
  #end       ## end for each field
&lt;/table&gt;
&lt;hr/&gt;</code></pre> 
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">就是将属性名与属性值呈现出来。</span> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">5、再看看hit.vm</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-html">#**
 *  Called for each matching document but then
 *  calls one of product_doc, join_doc or richtext_doc
 *  depending on which fields the doc has
 *#

#set($docId = $doc.getFieldValue('id'))

&lt;div class="result-document"&gt;

  ## Has a "name" field ?
  #if($doc.getFieldValue('name'))
    #parse("product_doc.vm")

  ## Has a "compName_s" field ?
  #elseif($doc.getFieldValue('compName_s'))
    #parse("join_doc.vm")

  ## Fallback to richtext_doc
  #else
    #parse("richtext_doc.vm")

  #end

&lt;/div&gt;</code></pre> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">6、能够直接看richtest_doc.vm</span>
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <pre><code class="language-html">#**
 *  Render a complex document in the results list
 *#

## Load Mime-Type List and Mapping
#parse('mime_type_lists.vm')
## Sets:
## * supportedMimeTypes, AKA supportedtypes
## * mimeExtensionsMap, AKA extMap

## Title
#if($doc.getFieldValue('title'))
  #set($title = $esc.html($doc.getFirstValue('title')))
#else
  #set($title = "["+$doc.getFieldValue('id')+"]")
#end

## URL
#if($doc.getFieldValue('url'))
  #set($url = $doc.getFieldValue('url'))
#elseif($doc.getFieldValue('resourcename'))
  #set($url = "file:///$doc.getFieldValue('resourcename')")
#else
  #set($url = "$doc.getFieldValue('id')")
#end

## Sort out Mime-Type
#set($ct = $list.get($doc.getFirstValue('content_type').split(";"),0))
#set($filename = $doc.getFieldValue('resourcename'))
#set($filetype = false)
#set($filetype = $mimeExtensionsMap.get($ct))

## TODO: falling back to file extension is convenient,
## except when you don't have an icon for that extension
## example "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
## document with a .docx extension.
## It'd be nice to fall back to an "unknown" or the existing "file" type
## We sort of do this below, but only if the filename has no extension
## (anything after the last dot).

#if(!$filetype)
  #set($filetype = $filename.substring($filename.lastIndexOf(".")).substring(1))
#end

## #if(!$filetype)
##   #set($filetype = "file")
## #end
## #if(!$supportedMimeTypes.contains($filetype))
##   #set($filetype = "file")
## #end

## Row 1: Icon and Title and mlt link
&lt;div class="result-title"&gt;
  ## Icon
  ## Small file type icons from http://www.splitbrain.org/projects/file_icons (public domain)
  &lt;img src="#{url_root}/img/filetypes/${filetype}.png" align="center"&gt;

  ## Title, hyperlinked
  &lt;a href="${url}" target="_blank"&gt;
    &lt;b&gt;$title&lt;/b&gt;&lt;/a&gt;

  ## Link for MLT / More Like This / Find Similar
  &lt;span class="mlt"&gt;
    #if($params.getBool('mlt', false) == false)
      &lt;a href="#lensNoQ&amp;q=id:%22$docId%22&amp;mlt=true"&gt;
        More Like This&lt;/a&gt;
    #end
  &lt;/span&gt;

&lt;/div&gt;

## Row 2?: ID / URL
&lt;div&gt;
  #Id: #field('id')
  ##自己改动
  ##Time: #field('tstamp')
&lt;/div&gt;

## Resource Name
&lt;div&gt;
  #if($doc.getFieldValue('resourcename'))
    Resource name: $filename 
  #elseif($url)
    URL: $url
  #end
  #if($ct)
    ($ct)
  #end
&lt;/div&gt;

## Author
#if($doc.getFieldValue('author'))
  &lt;div&gt;
    Author: #field('author')
  &lt;/div&gt;
#end

## Last_Modified Date
#if($doc.getFieldValue('last_modified'))
  &lt;div&gt;
    last-modified:
    #field('last_modified')
  &lt;/div&gt;
#end

## Main content of doc
&lt;div class="result-body"&gt;
  #field('content')
&lt;/div&gt;

## Display Similar Documents / MLT = More Like This
&lt;div class="mlt"&gt;
  #set($mlt = $mltResults.get($docId))
  #set($mltOn = $params.getBool('mlt'))
  #if($mltOn == true)
    &lt;div class="field-name"&gt;
      Similar Items
    &lt;/div&gt;
  #end
  ## If has MLT enabled An Entries to show
  #if ($mltOn &amp;&amp; $mlt &amp;&amp; $mlt.size() &gt; 0)
    &lt;ul&gt;
      #foreach($mltHit in $mlt)
        #set($mltId = $mltHit.getFieldValue('id'))
        &lt;li&gt;
          &lt;div&gt;
            &lt;a href="#url_for_home?q=id:$mltId"&gt;
              $mltId&lt;/a&gt;
          &lt;/div&gt;
          &lt;div&gt;
            &lt;span class="field-name"&gt;
              Title:
            &lt;/span&gt;
            $mltHit.getFieldValue('title')
          &lt;/div&gt;
          &lt;div&gt;
            &lt;span class="field-name"&gt;
              Author:
            &lt;/span&gt;
            $mltHit.getFieldValue('author')
            &lt;span class="field-name"&gt;
              Description:
            &lt;/span&gt;
            $mltHit.getFieldValue('description')
          &lt;/div&gt;
        &lt;/li&gt;
      #end    ## end for each mltHit in $mlt
    &lt;/ul&gt;
  ## Else MLT Enabled but no mlt results for this query
  #elseif($mltOn &amp;&amp; $mlt.size() == 0)
    &lt;div&gt;No Similar Items Found&lt;/div&gt;
  #end
&lt;/div&gt;  ## div class=mlt

#parse('debug.vm')
</code></pre> 
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">因为本文件是example自带的呈现文件，其属性也依照自带的schemal.xml定义，并不适用于nutch的schema。</span> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">因此，若要改变呈现的内容，能够直接改动此文件。如将</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-html">## Row 2?
</code></pre> 
   <p></p> 
   <p>: ID / URL &lt;div&gt; #Id: #field('id') &lt;/div&gt;</p> 
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">改为：</span> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-html">## Row 2?: ID / URL
&lt;div&gt;
  ##自己改动
  #Time: #field('tstamp')
&lt;/div&gt;</code></pre> 
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">则在页面不再显示id，而是显示时间。</span>
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><br><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <div> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:12px;">版权声明：本文博客原创文章，博客，未经同意，不得转载。</p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:12px;"><br></p> 
    <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:12px;"><br></p> 
    <p><font color="#333333"><span style="font-size:12px;">本文转自mfrbuaa博客园博客，原文链接：http://www.cnblogs.com/mfrbuaa/p/4740590.html，如需转载请自行联系原作者</span></font></p> 
    <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     <br>
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
