<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SharpDX之Direct2D教程II——加载位图文件和保存位图文件 « NotBeCN</title>
  <meta name="description" content="             本系列文章目录：    SharpDX之Direct2D教程I——简单示例和Color（颜色）    &nbsp;    绘制位图是绘制操作的不可缺少的一部分。在Direct2D中绘制位图，必须先利用WIC组件将位图加载到内存中，再绘制到RenderTarget中去    &nbsp; ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/15/weixin_34038652_90135629.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">SharpDX之Direct2D教程II——加载位图文件和保存位图文件</h1>
    <p class="post-meta">Nov 15, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">本系列文章目录：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><a href="http://www.cnblogs.com/grenet/p/3329567.html" rel="nofollow" style="color:rgb(7,93,179);">SharpDX之Direct2D教程I——简单示例和Color（颜色）</a></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">绘制位图是绘制操作的不可缺少的一部分。在Direct2D中绘制位图，必须先利用WIC组件将位图加载到内存中，再绘制到RenderTarget中去</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">在SharpDX中绘制位图，分成两个部分：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">利用WIC在SharpDX中加载位图，生成Bitmap对象</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">利用RenderTarget对象的DrawBitmap方法把Bitmap对象绘制到RenderTarget中去</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>利用WIC在SharpDX中加载位图文件</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">利用WIC在SharpDX中绘制位图文件的核心内容就是把位图文件转换为Bitmap对象。它的操作过程如下：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">1、创建WIC的ImagingFactory类。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">2、根据位图文件创建BitmapDecoder对象（实际上调用系统解码器解析位图文件）。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BitmapDecoder对象有1个属性和1个函数</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FrameCount属性：只读属性，说明该位图对象包含的帧数。一般gif文件能包含多个帧，其余格式的一般只有1个帧</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetFrame函数：返回指定帧对象。参数index是整形，说明是第几帧（从0开始）。返回的是BitmapFrameDecode对象</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">3、利用BitmapDecoder对象的GetFrame函数，返回指定帧的BitmapFrameDecode对象。（参数index一般是0，返回第1帧）</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">一般情况下，到此就可以了。但是，位图格式有很多，你可能不是很确定你的位图格式是否兼容SharpDX的Bitmap对象。因此，比较好的做法是继续下面的步骤，将位图格式转换为兼容SharpDX的Bitmap对象</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">4、创建FormatConverter对象。该对象负责进行格式转换。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">5、调用FormatConverter对象的Initialize方法，进行格式转换。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">6、最后，利用Bitmap对象的FromWicBitmap函数将之前的FormatConverter对象转换为SharpDX的Bitmap对象</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">和Windows API Code Pack 1.1中的Direct2D略有不同的是，BitmapFrameDecode对象和FormatConverter对象都继承BitmapSource对象，省去了一个转换的过程</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">下面是代码</p> 
   <div style="font-size:15px;font-family:verdana;">
    &nbsp;&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Protected</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;LoadBitmap(Render&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RenderTarget</span>, File&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>, FrameIndex&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;Decoder&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapDecoder</span>(_ImagingFactory, File, DX.IO.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">NativeFileAccess</span>.Read, WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">DecodeOptions</span>.CacheOnLoad)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;FrameIndex &gt; Decoder.FrameCount - 1&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">OrElse</span>&nbsp;FrameIndex &lt; 0&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;FrameIndex = 0&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;Source&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapFrameDecode</span>&nbsp;= Decoder.GetFrame(FrameIndex)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;Converter&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">FormatConverter</span>(_ImagingFactory)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Converter.Initialize(Source, WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PixelFormat</span>.Format32bppPBGRA)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>.FromWicBitmap(Render, Converter)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <br>
   </div> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>利用RenderTarget对象的DrawBitmap方法把Bitmap对象绘制到RenderTarget中去</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">下面是DrawBitmap方法的原型定义：</p> 
   <div style="font-size:15px;font-family:verdana;">
    &nbsp;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;DrawBitmap(bitmap&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>, destinationRectangle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;DX.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RectangleF</span>, opacity&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Single</span>, interpolationMode&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapInterpolationMode</span>, sourceRectangle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;DX.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RectangleF</span>)&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;DrawBitmap(bitmap&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>, opacity&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Single</span>, interpolationMode&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapInterpolationMode</span>)&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;DrawBitmap(bitmap&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>, destinationRectangle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;DX.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RectangleF</span>, opacity&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Single</span>, interpolationMode&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapInterpolationMode</span>)&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;DrawBitmap(bitmap&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>, opacity&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Single</span>, interpolationMode&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapInterpolationMode</span>, sourceRectangle&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;DX.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RectangleF</span>)
   </div> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">参数的意义如下：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">bitmap：要绘制的Bitmap对象</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">destinationRectangle：绘制在RenderTarget对象上的目标范围。缺省是在RenderTarget对象的左上角，宽高是Bitmap对象的宽高</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">opacity：不透明度</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">interpolationMode：图像缩放时的插值算法，是个枚举</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">sourceRectangle：要绘制的源目标范围。缺省是Bitmap对象的整个范围</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">下面是示例代码</p> 
   <div style="font-size:15px;font-family:verdana;">
    &nbsp;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsSharpDXLoadBitmap</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Inherits</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsSharpDXSampleBase</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Protected</span>&nbsp;_ImagingFactory&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">ImagingFactory</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Shadows</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;CreateDeviceResource(Target&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Control</span>)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">MyBase</span>.CreateDeviceResource(Target)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _ImagingFactory =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">ImagingFactory</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;LoadBitmap(File&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;FrameIndex&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 0)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;LoadBitmap(_RenderTarget, File, FrameIndex)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Protected</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;LoadBitmap(Render&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RenderTarget</span>, File&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>, FrameIndex&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;Decoder&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapDecoder</span>(_ImagingFactory, File, DX.IO.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">NativeFileAccess</span>.Read, WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">DecodeOptions</span>.CacheOnLoad)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;FrameIndex &gt; Decoder.FrameCount - 1&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">OrElse</span>&nbsp;FrameIndex &lt; 0&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;FrameIndex = 0&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;Source&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapFrameDecode</span>&nbsp;= Decoder.GetFrame(FrameIndex)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;Converter&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">FormatConverter</span>(_ImagingFactory)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Converter.Initialize(Source, WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PixelFormat</span>.Format32bppPBGRA)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>.FromWicBitmap(Render, Converter)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Shadows</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;Render()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">With</span>&nbsp;_RenderTarget&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .BeginDraw()&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Clear(DX.Color.Honeydew.ToColor4)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;B&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;D2D.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>&nbsp;= LoadBitmap(
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"216.png"</span>)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .DrawBitmap(B, 1, SharpDX.Direct2D1.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapInterpolationMode</span>.NearestNeighbor,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;DX.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RectangleF</span>(0, 0, 260, 260))&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .EndDraw()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">With</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;
    <br>
    <br>
   </div> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>利用WIC保存图片</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">WIC既能负责图片的解码，也能负责图片的编码。我们也可以利用WIC编码图片。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">在调试的时候出了问题，先看看下面两段代码</p> 
   <div style="font-size:15px;font-family:verdana;">
    &nbsp;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Class1</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Shared</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;Test()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;wicFactory&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">ImagingFactory</span>&nbsp;=&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">ImagingFactory</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;F&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;=&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"333.png"</span>&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">File</span>.Exists(F))&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">File</span>.Delete(F)&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;spStream&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">WICStream</span>&nbsp;=&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">WICStream</span>(wicFactory, F,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">NativeFileAccess</span>.Write)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;spBitmapEncoder&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PngBitmapEncoder</span>&nbsp;=&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PngBitmapEncoder</span>(wicFactory)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; spBitmapEncoder.Initialize(spStream)&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span> 
   </div> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">上面的代码是用VB2010写的，仅仅写到PngBitmapEncoder对象的Initialize方法。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">再看看下面这段代码，用的是C# 2010写的</p> 
   <div style="font-size:15px;font-family:verdana;">
    &nbsp;&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">class</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Class1</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp; {&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">public</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">static</span>&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">void</span>&nbsp;test()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">ImagingFactory</span>&nbsp; wicFactory =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">ImagingFactory</span>();&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">string</span>&nbsp;F =&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"333.png"</span>;&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">if</span>&nbsp;(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">File</span>.Exists(F))&nbsp;&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">File</span>.Delete(F);&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">WICStream</span>&nbsp; stream =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">WICStream</span>(wicFactory, F,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">NativeFileAccess</span>.Write);&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PngBitmapEncoder</span>&nbsp; encoder =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PngBitmapEncoder</span>(wicFactory);&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encoder.Initialize(stream);&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;
    <br> &nbsp;&nbsp;&nbsp; }
   </div> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">可以看出，两段代码没什么不同（仅仅是语法上的不同而已），但是VB2010的代码在执行到Initialize时总是报错（内部错误），而C#2010在执行到Initialize方法很顺利的完成了。两段代码引用的是同一个动态库SharpDX的2.5.0的库。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">我解释不出是什么原因，只能归结于SharpDX自身的原因了。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>不过，我发现一个问题，写在这儿，给大家一个参考，也许谁能给出解决方案。（或者是我的设置有问题？）</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>在VB2010中，PngBitmapEncoder类的初始方法只能看到两个，New(Object)和New(IntPtr)</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>在C#2010中，PngBitmapEncoder类的初始方法能看到六个，除了上面的两个，还多了很多</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>打开SharpDX.Direct2D1.xml中也看到PngBitmapEncoder对象的初始方法有六个</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong><span style="line-height:1.5;color:rgb(255,0,0);">难道SharpDX真的不能很好的运用于VB2010中么？</span></strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>最后贴一段SharpDX中自带示例中的WIC保存图片的代码</strong></p> 
   <div style="font-size:15px;font-family:verdana;">
    &nbsp;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">using</span>&nbsp;System;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">using</span>&nbsp;System.IO;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">using</span>&nbsp;SharpDX;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">using</span>&nbsp;SharpDX.Direct2D1;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">using</span>&nbsp;SharpDX.DXGI;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">using</span>&nbsp;SharpDX.IO;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">using</span>&nbsp;SharpDX.WIC;&nbsp;
    <br>
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">using</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">AlphaMode</span>&nbsp;= SharpDX.Direct2D1.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">AlphaMode</span>;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">using</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>&nbsp;= SharpDX.WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>;&nbsp;
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">using</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PixelFormat</span>&nbsp;= SharpDX.Direct2D1.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PixelFormat</span>;&nbsp;
    <br>
    <br>
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">namespace</span>&nbsp;RenderToWicApp&nbsp;
    <br> {&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">internal</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">static</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">class</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Program</span>&nbsp;
    <br> &nbsp;&nbsp;&nbsp; {&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">private</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">static</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">void</span>&nbsp;Main()&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;wicFactory =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">ImagingFactory</span>();&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;d2dFactory =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;SharpDX.Direct2D1.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Factory</span>();&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">string</span>&nbsp;filename =&nbsp;
    <span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"output.png"</span>;&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">const</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">int</span>&nbsp;width = 512;&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">const</span>&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">int</span>&nbsp;height = 512;&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;rectangleGeometry =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RoundedRectangleGeometry</span>(d2dFactory,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RoundedRectangle</span>() { RadiusX = 32, RadiusY = 32, Rect =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RectangleF</span>(128, 128, width - 128 * 2, height-128 * 2) });&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;wicBitmap =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>(wicFactory, width, height, SharpDX.WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PixelFormat</span>.Format32bppBGR,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapCreateCacheOption</span>.CacheOnLoad);&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;renderTargetProperties =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RenderTargetProperties</span>(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RenderTargetType</span>.Default,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PixelFormat</span>(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Format</span>.Unknown,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">AlphaMode</span>.Unknown), 0, 0,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">RenderTargetUsage</span>.None,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">FeatureLevel</span>.Level_DEFAULT);&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;d2dRenderTarget =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">WicRenderTarget</span>(d2dFactory, wicBitmap, renderTargetProperties);&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;solidColorBrush =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">SolidColorBrush</span>(d2dRenderTarget,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Color</span>.White);&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d2dRenderTarget.BeginDraw();&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d2dRenderTarget.Clear(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Color</span>.Black);&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d2dRenderTarget.FillGeometry(rectangleGeometry, solidColorBrush,&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">null</span>);&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d2dRenderTarget.EndDraw();&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">if</span>&nbsp;(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">File</span>.Exists(filename))&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">File</span>.Delete(filename);&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;stream =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">WICStream</span>(wicFactory, filename,&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">NativeFileAccess</span>.Write);&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;encoder =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PngBitmapEncoder</span>(wicFactory);&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encoder.Initialize(stream);&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;bitmapFrameEncode =&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">BitmapFrameEncode</span>(encoder);&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bitmapFrameEncode.Initialize();&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bitmapFrameEncode.SetSize(width, height);&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;pixelFormatGuid = SharpDX.WIC.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">PixelFormat</span>.FormatDontCare;&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bitmapFrameEncode.SetPixelFormat(
    <span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ref</span>&nbsp;pixelFormatGuid);&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bitmapFrameEncode.WriteSource(wicBitmap);&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bitmapFrameEncode.Commit();&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encoder.Commit();&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bitmapFrameEncode.Dispose();&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; encoder.Dispose();&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stream.Dispose();&nbsp;
    <br>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Diagnostics.
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Process</span>.Start(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Path</span>.GetFullPath(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Path</span>.Combine(
    <span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Environment</span>.CurrentDirectory,filename)));&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;
    <br> &nbsp;&nbsp;&nbsp; }&nbsp;
    <br> }
   </div> 
   <div style="font-size:15px;font-family:verdana;">
    <br>
   </div> 
   <div style="font-size:15px;font-family:verdana;"> 
    <div>
     &nbsp; &nbsp; 本文转自万仓一黍博客园博客，原文链接：http://www.cnblogs.com/grenet/p/3330440.html，如需转载请自行联系原作者
    </div> 
    <div>
     <br>
    </div> 
   </div> 
   <div style="font-size:15px;font-family:verdana;">
    <br>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
