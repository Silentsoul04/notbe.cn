<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Spread for Windows Forms高级主题(7)---自定义打印的外观 « NotBeCN</title>
  <meta name="description" content="             表单打印的多个部分都可以进行自定义，大多数的自定义选项存在于PrintInfo对象中。大多数打印选项是在PrintInfo对象上进行设置，并在表单级别上应用。当你执行打印操作时，你将一个特定的表单发送给使用这些设置的打印机。如果你想为不同的表单使用不同的打印设置，那么你可能需要重置Pri...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/15/1557728622995.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Spread for Windows Forms高级主题(7)---自定义打印的外观</h1>
    <p class="post-meta">Nov 15, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">表单打印的多个部分都可以进行自定义，大多数的自定义选项存在于PrintInfo对象中。大多数打印选项是在PrintInfo对象上进行设置，并在表单级别上应用。当你执行打印操作时，你将一个特定的表单发送给使用这些设置的打印机。如果你想为不同的表单使用不同的打印设置，那么你可能需要重置PrintInfo对象，然后在表单打印的间隔内做必要的修改。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><strong>深入理解打印选项</strong></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">你可以通过设置PrintInfo对象的 属性，并将表单的PrintInfo属性值设置为该对象，来自定义打印设置。PrintInfo对象提供了以下属性用来自定义打印：</p> 
   <table border="0" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;border-collapse:collapse;color:rgb(51,51,51);">
    <tbody>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p><b>属性</b></p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p><b>描述</b></p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>AbortMessage</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置退出对话框显示的信息。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>BestFitCols</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置列宽是否为满足打印最长字符串的宽度而调整。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>BestFitRows</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置行高是否为满足打印最高字符串的高度而调整。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>Centering</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置打印输出是否居中。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>Colors</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置可在自定义页眉或页脚文本中使用的颜色列表。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>ColStart和 ColEnd</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>用来打印表单的一部分。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>FirstPageNumber</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置打印在首页上的页码。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>Footer</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>为打印页面提供页脚。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>Header</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>为打印的页面提供页眉。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>Images</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置可在自定义页眉或页脚中使用的图片列表。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>JobName</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置打印作业的名称。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>Margin</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置打印的页面空白。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>Opacity</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置打印表单时所使用的不透明度； 它可以用来首先打印一个水印，然后再打印表单的内容。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>Orientation</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置打印时的页面方向。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>PageStart和 PageEnd</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>用来打印一个页面区域。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>PageOrder</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置页面打印的顺序。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>PaperSize</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置所使用的纸张大小。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>PaperSource</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置所使用的纸张来源。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>Preview</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>用来提供打印预览。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>Printer</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置用来打印的打印机名称。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>PrintNotes</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置是否打印单元格注释。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>PrintShapes</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置是否打印浮动对象。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>PrintType</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置需要打印的内容。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>RepeatColStart和 RepeatColEnd</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置是否在每一个页面上打印相同的列集。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>RepeatRowStart 和 RepeatRowEnd</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置是否在每一个页面上打印相同的行集。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>RowStart和 RowEnd</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>用来打印表单的一部分。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>ShowBorder</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置是否在表单的四周打印边界。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>ShowColor</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置是否打印在屏幕上出现的颜色。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>ShowColumnHeader 和 ShowRowHeader</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置是否打印列标题和行标题。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>ShowGrid</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置是否打印表单的网格线。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>ShowPrintDialog</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置打印前是否显示打印对话框。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>ShowShadows</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置是否打印标题阴影。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>SmartPrintPagesTall</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置打印的页高。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>SmartPrintPagesWide</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置打印的页宽。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>SmartPrintRules</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>用来设置打印优化的规则。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>UseMax</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置是否只打印包含数据的行。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>UseSmartPrint</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>用来开启打印优化的规则。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>ZoomFactor</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>获取或设置打印页面时使用的缩放因子。</p> </td> 
     </tr>
    </tbody>
   </table>
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">示例代码创建了一个PrintInfo对象，并设置属性指定不打印网格线或行标题，并且只打印包含数据的单元格。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">&nbsp;</p> 
   <pre>
</pre> 
   <ol style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(20,107,0);color:rgb(92,92,92);">
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="comment" style="border:none;color:rgb(0,130,0);">//创建PrintInfo对象并设置属性。&nbsp;</span><span style="border:none;">&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">FarPoint.Win.Spread.PrintInfo&nbsp;printset&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;FarPoint.Win.Spread.PrintInfo();&nbsp;&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.ShowGrid&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">false</span><span style="border:none;">;&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.ShowRowHeader&nbsp;=&nbsp;FarPoint.Win.Spread.PrintHeader.Hide;&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.UseMax&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">true</span><span style="border:none;">;&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="comment" style="border:none;color:rgb(0,130,0);">//为第一个表单设置PrintInfo属性。&nbsp;fpSpread1.Sheets[0].PrintInfo&nbsp;=&nbsp;printset;&nbsp;</span><span style="border:none;">&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="comment" style="border:none;color:rgb(0,130,0);">//打印表单。&nbsp;</span><span style="border:none;">&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">fpSpread1.PrintSheet(0);&nbsp;</span></li> 
   </ol>
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">&nbsp;</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><strong>自定义打印作业设置</strong></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">如果你没有指定其他打印机的话，表单会使用你的Windows系统环境中当前的默认打印机进行打印。你可以在任意支持Windows的打印机上打印表单。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">你可以自定义的打印作业设置项包括打印机、纸张来源、以及纸张大小。相对应的，可以设置PrintInfo对象中的Printer，PaperSource，或PaperSize属性。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">下面的示例代码从一个复选框中选择了纸张来源，并在打印所有表单前设置了纸张的大小。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">&nbsp;</p> 
   <pre>
</pre> 
   <ol style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(20,107,0);color:rgb(92,92,92);">
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">private</span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">void</span><span style="border:none;">&nbsp;Form1_Load(</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">object</span><span style="border:none;">&nbsp;sender,&nbsp;System.EventArgs&nbsp;e)&nbsp;{&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">int</span><span style="border:none;">&nbsp;i;&nbsp;&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">System.Drawing.Printing.PrinterSettings&nbsp;ps&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;System.Drawing.Printing.PrinterSettings();&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">for</span><span style="border:none;">&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&amp;lt;=&nbsp;ps.PaperSources.Count&nbsp;-&nbsp;1;&nbsp;i++)&nbsp;&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">{&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">comboBox1.Items.Add(ps.PaperSources[i].SourceName);&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">}&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">comboBox1.Text&nbsp;=&nbsp;ps.PaperSources[0].SourceName;&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">}&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">private</span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">void</span><span style="border:none;">&nbsp;button1_Click(</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">object</span><span style="border:none;">&nbsp;sender,&nbsp;System.EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">{&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">FarPoint.Win.Spread.PrintInfo&nbsp;pi&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;FarPoint.Win.Spread.PrintInfo();&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">System.Drawing.Printing.PrinterSettings&nbsp;ps&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;System.Drawing.Printing.PrinterSettings();&nbsp;&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">pi.PaperSize&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;System.Drawing.Printing.PaperSize(</span><span class="string" style="border:none;color:#0000FF;">"Letter"</span><span style="border:none;">,&nbsp;600,&nbsp;300);&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">pi.PaperSource&nbsp;=&nbsp;ps.PaperSources[comboBox1.SelectedIndex];&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">fpSpread1.Sheets[0].PrintInfo&nbsp;=&nbsp;pi;&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">fpSpread1.PrintSheet(-1);&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">}&nbsp;</span></li> 
   </ol>
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><strong>自定义打印页眉或页脚</strong></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">你可以在打印页面上显示页眉和页脚。使用PrintInfo类的 Header属性和 Footer属性，可能包含特殊的控制指令，你可以指定文本和变量，如页数，也可以指定字体的设置。与字体相关的指令以"f"开头。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">下面的表中列出了可插入到页眉和页脚中的控制指令。</p> 
   <table border="0" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;border-collapse:collapse;color:rgb(51,51,51);">
    <tbody>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p><b>控制字符</b></p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p><b>完整的命令</b></p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p><b>打印页面的页眉或页脚的行为</b><b></b></p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>插入正斜杠字符(/)</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/c</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/c</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>调整项目居中</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/cl</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/cl"n"</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>设置文本的字体颜色，使用以0为基准的颜色索引，n，在引号中（n可以是0或更大）； 请参考Colors属性。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/dl</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/dl</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>使用长格式，插入日期</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/ds</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/ds</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>使用短格式，插入日期</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/f</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/f"n"</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>重新调用先前保存的字体设置（查看表中的/fs），使用以0为基准的索引，n，在引号中（n可以是0或更大）。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fb</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fb0</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>关闭加粗字体类型</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);">&nbsp;</td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fb1</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>打开加粗字体类型</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fi</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fi0</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>关闭斜体字体类型</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);">&nbsp;</td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fi1</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>打开斜体字体类型</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fk</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fk0</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>关闭删除线</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);">&nbsp;</td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fk1</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>打开删除线</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fn</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fn"name"</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>使用引号中字体的名称，设置字体的名称。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fs</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fs"n"</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>保存字体设置以便重复使用，使用以0为基准的字体设置索引，n，在引号中（查看表中的/f）</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fu</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fu0</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>关闭下划线</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);">&nbsp;</td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fu1</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>打开下划线</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fz</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/fz"n"</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>设置字体的大小</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/g</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/g"n"</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>插入一张图形（图片），以0为基准的图片索引，n，在引号中（n可以为0或更大） 请参考Images属性。</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/l</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/l</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>左对齐该项目（这是字母l或L，与Left等价）</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/n</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/n</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>插入一个新行</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/p</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/p</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>插入页码</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/pc</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/pc</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>插入页数（打印作业中的总页面数）</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/r</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/r</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>右对齐该项目</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/tl</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/tl</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>使用长格式插入时间</p> </td> 
     </tr>
     <tr>
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/ts</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>/ts</p> </td> 
      <td valign="top" style="border:1px solid rgb(221,221,221);"> <p>使用短格式插入时间</p> </td> 
     </tr>
    </tbody>
   </table>
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">如果你使用了多个控制字符，不要在字符之间留空格。字符可以为小写或大写格式； 为了简单起见，显示在这里的所有命令和示例都使用小写格式。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">打印表单(运行PrintSheet 方法)前定义页眉和页脚(设置 Header 和 Footer 属性)。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">如果颜色已经在Colors属性中进行了预定义，那么你可以从颜色列表中为文本指定一个颜色。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">如果图片已经在Images属性中进行了预定义，你可以指定一个图片。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">你可以添加文本包括页数和总的打印页数。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">你可以保存页眉或页脚中的字体设置，以便重复使用。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">这个是下面代码运行的结果。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><a href="http://powertoolsteam.blog.51cto.com/attachment/201108/22/2369428_1313982013lmLM.png" rel="nofollow" style="color:rgb(66,133,244);"><img title="image" alt="image" width="585" height="323" src="http://powertoolsteam.blog.51cto.com/attachment/201108/22/2369428_131398201484lj.png" style="border-top:0px none;border-right:none;border-bottom:0px none;border-left:0px none;"></a></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">下面的示例代码打印带有指定页眉和页脚文本的表单：</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">&nbsp;</p> 
   <pre>
</pre> 
   <ol style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(20,107,0);color:rgb(92,92,92);">
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="comment" style="border:none;color:rgb(0,130,0);">//创建PrintInfo对象并设置属性。&nbsp;</span><span style="border:none;">&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">FarPoint.Win.Spread.PrintInfo&nbsp;printset&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;FarPoint.Win.Spread.PrintInfo();&nbsp;&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.Colors&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;Color[]&nbsp;{Color.Green,&nbsp;Color.Yellow,&nbsp;Color.Gold,&nbsp;Color.Indigo,&nbsp;Color.Brown};&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.Images&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;Image[]&nbsp;{Image.FromFile(</span><span class="string" style="border:none;color:#0000FF;">"C:\\images\\point.jpg"</span><span style="border:none;">),&nbsp;Image.FromFile(</span><span class="string" style="border:none;color:#0000FF;">"C:\\images\\logo.gif"</span><span style="border:none;">),&nbsp;Image.FromFile(</span><span class="string" style="border:none;color:#0000FF;">"C:\\images\\icon.jpg"</span><span style="border:none;">)};&nbsp;&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.Header&nbsp;=&nbsp;<span class="string" style="border:none;color:#0000FF;">""</span><span style="border:none;">/fn\</span><span class="string" style="border:none;color:#0000FF;">"Book&nbsp;Antiqua\"&nbsp;/fz\"14\"&nbsp;Print&nbsp;job&nbsp;for&nbsp;FarPoint&nbsp;Inc./n&nbsp;"</span><span style="border:none;">;&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.Footer&nbsp;=&nbsp;<span class="string" style="border:none;color:#0000FF;">"/g\"1\"/r/cl\"4\"This&nbsp;is&nbsp;page&nbsp;/p&nbsp;of&nbsp;/pc"</span><span style="border:none;">;&nbsp;&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="comment" style="border:none;color:rgb(0,130,0);">//为第一个表单设置PrintInfo属性。&nbsp;fpSpread1.Sheets[0].PrintInfo&nbsp;=&nbsp;printset;&nbsp;</span><span style="border:none;">&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="comment" style="border:none;color:rgb(0,130,0);">//打印表单。&nbsp;</span><span style="border:none;">&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">fpSpread1.PrintSheet(0);&nbsp;</span></li> 
   </ol>
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><strong>在打印页面上循环打印行或列</strong></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">你可以指定出现在每一个打印页顶部的行或左边的列。使用PrintInfo对象的RepeatRowStart，RepeatRowEnd，RepeatColStart，和RepeatColEnd属性。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">下面的示例代码设置了循环选项，并使用了预览对话框。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">&nbsp;</p> 
   <pre>
</pre> 
   <ol style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(20,107,0);color:rgb(92,92,92);">
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span style="border:none;">FarPoint.Win.Spread.PrintInfo&nbsp;printset&nbsp;=&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;FarPoint.Win.Spread.PrintInfo();&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.RepeatColStart&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.RepeatColEnd&nbsp;=&nbsp;2;&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.RepeatRowStart&nbsp;=&nbsp;0;&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.RepeatRowEnd&nbsp;=&nbsp;2;&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">printset.Preview&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">true</span><span style="border:none;">;&nbsp;&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">fpSpread1.Sheets[0].PrintInfo&nbsp;=&nbsp;printset;&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">fpSpread1.PrintSheet(0);&nbsp;</span></li> 
   </ol>
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><strong>添加分页符</strong></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">你可以在指定的行或列前添加强制分页符。分页符不会在屏幕上显示，但是在打印表单时会强制分页。列的分页符位于指定列的左边。行的分页符位于指定行的上方。要添加或设置分页符，使用SetRowPageBreak 和SetColumnPageBreak方法。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">你也可以检索到表单中位于分页符后的下一行或列。要查看已经设置的分页符，使用GetRowPageBreaks方法返回行分页符的数量，使用GetColumnPageBreaks方法返回列分页符的数量。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">你可以使用GetPrintPageCount方法 计算表单的打印页数。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">下面的示例代码设置了行分页符，并为行分页符返回了总行数。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">&nbsp;</p> 
   <pre>
</pre> 
   <ol style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(20,107,0);color:rgb(92,92,92);">
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="comment" style="border:none;color:rgb(0,130,0);">//为窗体的Load事件添加如下代码。&nbsp;</span><span style="border:none;">&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">FarPoint.Win.Spread.PrintInfo&nbsp;pi&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;FarPoint.Win.Spread.PrintInfo();&nbsp;&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">pi.UseMax&nbsp;=<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">false</span><span style="border:none;">;&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">fpSpread1.Sheets[0].PrintInfo&nbsp;=&nbsp;pi;&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">fpSpread1.Sheets[0].SetRowPageBreak(5,<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">true</span><span style="border:none;">);&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="comment" style="border:none;color:rgb(0,130,0);">//为按钮的Click事件添加如下代码。&nbsp;</span><span style="border:none;">&nbsp;</span></span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">int</span><span style="border:none;">&nbsp;[]i;&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">i&nbsp;=&nbsp;fpSpread1.GetRowPageBreaks(0);&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">foreach</span><span style="border:none;">&nbsp;(</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">object</span><span style="border:none;">&nbsp;o&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">in</span><span style="border:none;">&nbsp;i)&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">{&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">listBox1.Items.Add(o);&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">}&nbsp;</span></li> 
   </ol>
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><strong>为打印页面添加水印</strong></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">在打印表单时，你可以打印一张背景图片或水印。打印时，触发PrintBackground事件，然后在该事件中指定背景图片，并使用PrintInfo.Opacity属性设置不透明度； 打印表单时，如果不透明度最高（透明度最低），则没有水印；而如果不透明度低（透明度高）时，则会显示水印。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">下面的代码示例展示了如何打印水印。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">&nbsp;</p> 
   <pre>
</pre> 
   <ol style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;border-top:none;border-right:none;border-bottom:none;border-left:3px solid rgb(20,107,0);color:rgb(92,92,92);">
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">private</span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">void</span><span style="border:none;">&nbsp;fpSpread1_PrintBackground(</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">object</span><span style="border:none;">&nbsp;sender,&nbsp;FarPoint.Win.Spread.PrintBackgroundEventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">{&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">FarPoint.Win.Picture&nbsp;pic&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;FarPoint.Win.Picture(System.Drawing.Image.FromFile(</span><span class="string" style="border:none;color:#0000FF;">"C:\\Spread70\\Samples\\Files\\cover.jpg"</span><span style="border:none;">),&nbsp;FarPoint.Win.RenderStyle.Normal);&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">pic.AlignHorz&nbsp;=&nbsp;FarPoint.Win.HorizontalAlignment.Left;&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">pic.AlignVert&nbsp;=&nbsp;FarPoint.Win.VerticalAlignment.Top;&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">pic.Paint(e.Graphics,&nbsp;e.SheetRectangle);&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">}&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">private</span><span style="border:none;">&nbsp;</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">void</span><span style="border:none;">&nbsp;button1_Click(</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">object</span><span style="border:none;">&nbsp;sender,&nbsp;System.EventArgs&nbsp;e)&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">{&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">FarPoint.Win.Spread.PrintInfo&nbsp;pi&nbsp;=&nbsp;<span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;">new</span><span style="border:none;">&nbsp;FarPoint.Win.Spread.PrintInfo();&nbsp;&nbsp;</span></span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">pi.Opacity&nbsp;=&nbsp;100;&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">fpSpread1.ActiveSheet.PrintInfo&nbsp;=&nbsp;pi;&nbsp;&nbsp;</span></li> 
    <li style="border:none;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">fpSpread1.PrintSheet(0);&nbsp;&nbsp;</span></li> 
    <li class="alt" style="border:none;color:inherit;line-height:1.3em;list-style-position:outside;"><span style="border:none;color:#000000;">}&nbsp;</span></li> 
   </ol>
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">&nbsp;</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p><font color="#333333">本文转自 powertoolsteam 51CTO博客，原文链接：http://blog.51cto.com/powertoolsteam/645955，如需转载请自行联系原作者</font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
