<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>理解Docker（4）：Docker 容器使用 cgroups 限制资源使用 « NotBeCN</title>
  <meta name="description" content="             本系列文章将介绍Docker的有关知识：    （1）Docker 安装及基本用法    （2）Docker 镜像    （3）Docker 容器的隔离性 - 使用 Linux namespace 隔离容器的运行环境    （4）Docker 容器的隔离性 - 使用 cgroups 限制...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/15/weixin_34090643_90128290.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">理解Docker（4）：Docker 容器使用 cgroups 限制资源使用</h1>
    <p class="post-meta">Nov 15, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">本系列文章将介绍Docker的有关知识：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（1）<a href="http://www.cnblogs.com/sammyliu/p/5875470.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Docker 安装及基本用法</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（2）<a href="http://www.cnblogs.com/sammyliu/p/5877964.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Docker 镜像</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（3）<a href="http://www.cnblogs.com/sammyliu/p/5878973.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Docker 容器的隔离性 - 使用 Linux namespace 隔离容器的运行环境</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（4）<a href="http://www.cnblogs.com/sammyliu/p/5886833.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Docker 容器的隔离性 - 使用 cgroups 限制容器使用的资源</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（5）<a href="http://www.cnblogs.com/sammyliu/p/5894191.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Docker 网络</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp; &nbsp; 上一篇文章将到 Docker 容器使用 linux namespace 来隔离其运行环境，使得容器中的进程看起来就像爱一个独立环境中运行一样。但是，光有运行环境隔离还不够，因为这些进程还是可以不受限制地使用系统资源，比如网络、磁盘、CPU以及内存 等。关于其目的，一方面，是为了防止它占用了太多的资源而影响到其它进程；另一方面，在系统资源耗尽的时候，linux 内核会触发 OOM，这会让一些被杀掉的进程成了无辜的替死鬼。因此，为了让容器中的进程更加可控，Docker 使用 Linux cgroups 来限制容器中的进程允许使用的系统资源。&nbsp;</p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">1. 基础知识：Linux control groups&nbsp;</h2> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.1 概念</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp; Linux Cgroup 可​​​让​​​您​​​为​​​系​​​统​​​中​​​所​​​运​​​行​​​任​​​务​​​（进​​​程​​​）的​​​用​​​户​​​定​​​义​​​组​​​群​​​分​​​配​​​资​​​源​​​ — 比​​​如​​​ CPU 时​​​间​​​、​​​系​​​统​​​内​​​存​​​、​​​网​​​络​​​带​​​宽​​​或​​​者​​​这​​​些​​​资​​​源​​​的​​​组​​​合​​​。​​​您​​​可​​​以​​​监​​​控​​​您​​​配​​​置​​​的​​​ cgroup，拒​​​绝​​​ cgroup 访​​​问​​​某​​​些​​​资​​​源​​​，甚​​​至​​​在​​​运​​​行​​​的​​​系​​​统​​​中​​​动​​​态​​​配​​​置​​​您​​​的​​​ cgroup。所以，可以将 controll groups 理解为 controller （system resource） （for） （process）groups，也就是是说它以一组进程为目标进行系统资源分配和控制。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><span style="line-height:1.5;">&nbsp; 它主要提供了如下功能：&nbsp;</span></p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"> <strong>Resource limitation</strong>: 限制资源使用，比如内存使用上限以及文件系统的缓存限制。</li> 
    <li style="list-style-type:disc;"> <strong>Prioritization</strong>: 优先级控制，比如：CPU利用和磁盘IO吞吐。</li> 
    <li style="list-style-type:disc;"> <strong>Accounting</strong>: 一些审计或一些统计，主要目的是为了计费。</li> 
    <li style="list-style-type:disc;"> <strong>Control</strong>: 挂起进程，恢复执行进程。</li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">使​​​用​​​ cgroup，系​​​统​​​管​​​理​​​员​​​可​​​更​​​具​​​体​​​地​​​控​​​制​​​对​​​系​​​统​​​资​​​源​​​的​​​分​​​配​​​、​​​优​​​先​​​顺​​​序​​​、​​​拒​​​绝​​​、​​​管​​​理​​​和​​​监​​​控​​​。​​​可​​​更​​​好​​​地​​​根​​​据​​​任​​​务​​​和​​​用​​​户​​​分​​​配​​​硬​​​件​​​资​​​源​​​，提​​​高​​​总​​​体​​​效​​​率​​​。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">在实践中，系统管理员一般会利用CGroup做下面这些事（有点像为某个虚拟机分配资源似的）：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">隔离一个进程集合（比如：nginx的所有进程），并限制他们所消费的资源，比如绑定CPU的核。</li> 
    <li style="list-style-type:disc;">为这组进程分配其足够使用的内存</li> 
    <li style="list-style-type:disc;">为这组进程分配相应的网络带宽和磁盘存储限制</li> 
    <li style="list-style-type:disc;">限制访问某些设备（通过设置设备的白名单）</li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><span style="line-height:1.5;font-size:14px;">Linux 系统中，一切皆文件。Linux 也将 cgroups 实现成了文件系统，方便用户使用。在我的 Ubuntu 14.04 测试环境中：</span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@devstack:/home/sammy# <span style="color:rgb(0,0,255);line-height:1.5;">mount -</span><span style="line-height:1.5;"><span style="color:rgb(0,0,255);line-height:1.5;">t cgroup</span>
cgroup on </span>/sys/fs/cgroup/<span style="line-height:1.5;">cpuset type cgroup (rw,relatime,cpuset)
cgroup on </span>/sys/fs/cgroup/<span style="line-height:1.5;">cpu type cgroup (rw,relatime,cpu)
systemd on </span>/sys/fs/cgroup/systemd type cgroup (rw,noexec,nosuid,nodev,none,name=<span style="line-height:1.5;">systemd)<br>
root@devstack:</span>/home/sammy# <span style="color:rgb(0,0,255);line-height:1.5;">lssubsys -</span><span style="line-height:1.5;"><span style="color:rgb(0,0,255);line-height:1.5;">m</span>
cpuset </span>/sys/fs/cgroup/<span style="line-height:1.5;">cpuset
cpu </span>/sys/fs/cgroup/<span style="line-height:1.5;">cpu
cpuacct </span>/sys/fs/cgroup/<span style="line-height:1.5;">cpuacct
memory </span>/sys/fs/cgroup/<span style="line-height:1.5;">memory
devices </span>/sys/fs/cgroup/<span style="line-height:1.5;">devices
freezer </span>/sys/fs/cgroup/<span style="line-height:1.5;">freezer
blkio </span>/sys/fs/cgroup/<span style="line-height:1.5;">blkio
perf_event </span>/sys/fs/cgroup/<span style="line-height:1.5;">perf_event
hugetlb </span>/sys/fs/cgroup/<span style="line-height:1.5;">hugetlb<br></span><span style="line-height:1.5;">root@devstack:</span>/home/sammy# <span style="color:rgb(0,0,255);line-height:1.5;">ls /sys/fs/cgroup/ -</span><span style="line-height:1.5;"><span style="color:rgb(0,0,255);line-height:1.5;">l</span>
total </span><span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">
drwxr</span>-xr-x <span style="color:rgb(128,0,128);line-height:1.5;">3</span> root root <span style="color:rgb(128,0,128);line-height:1.5;">0</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span><span style="line-height:1.5;"> blkio
drwxr</span>-xr-x <span style="color:rgb(128,0,128);line-height:1.5;">3</span> root root <span style="color:rgb(128,0,128);line-height:1.5;">0</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span><span style="line-height:1.5;"> cpu
drwxr</span>-xr-x <span style="color:rgb(128,0,128);line-height:1.5;">3</span> root root <span style="color:rgb(128,0,128);line-height:1.5;">0</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span><span style="line-height:1.5;"> cpuacct
drwxr</span>-xr-x <span style="color:rgb(128,0,128);line-height:1.5;">3</span> root root <span style="color:rgb(128,0,128);line-height:1.5;">0</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span><span style="line-height:1.5;"> cpuset
drwxr</span>-xr-x <span style="color:rgb(128,0,128);line-height:1.5;">3</span> root root <span style="color:rgb(128,0,128);line-height:1.5;">0</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span><span style="line-height:1.5;"> devices
drwxr</span>-xr-x <span style="color:rgb(128,0,128);line-height:1.5;">3</span> root root <span style="color:rgb(128,0,128);line-height:1.5;">0</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span><span style="line-height:1.5;"> freezer
drwxr</span>-xr-x <span style="color:rgb(128,0,128);line-height:1.5;">3</span> root root <span style="color:rgb(128,0,128);line-height:1.5;">0</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span><span style="line-height:1.5;"> hugetlb
drwxr</span>-xr-x <span style="color:rgb(128,0,128);line-height:1.5;">3</span> root root <span style="color:rgb(128,0,128);line-height:1.5;">0</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span><span style="line-height:1.5;"> memory
drwxr</span>-xr-x <span style="color:rgb(128,0,128);line-height:1.5;">3</span> root root <span style="color:rgb(128,0,128);line-height:1.5;">0</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span><span style="line-height:1.5;"> perf_event
drwxr</span>-xr-x <span style="color:rgb(128,0,128);line-height:1.5;">3</span> root root <span style="color:rgb(128,0,128);line-height:1.5;">0</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span> systemd</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">我们看到 /sys/fs/cgroup 目录中有若干个子目录，我们可以认为这些都是受 cgroups 控制的资源以及这些资源的信息。</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">blkio — 这​​​个​​​子​​​系​​​统​​​为​​​块​​​设​​​备​​​设​​​定​​​输​​​入​​​/输​​​出​​​限​​​制​​​，比​​​如​​​物​​​理​​​设​​​备​​​（磁​​​盘​​​，固​​​态​​​硬​​​盘​​​，USB 等​​​等​​​）。</li> 
    <li style="list-style-type:disc;">cpu — 这​​​个​​​子​​​系​​​统​​​使​​​用​​​调​​​度​​​程​​​序​​​提​​​供​​​对​​​ CPU 的​​​ cgroup 任​​​务​​​访​​​问​​​。​​​</li> 
    <li style="list-style-type:disc;">cpuacct — 这​​​个​​​子​​​系​​​统​​​自​​​动​​​生​​​成​​​ cgroup 中​​​任​​​务​​​所​​​使​​​用​​​的​​​ CPU 报​​​告​​​。​​​</li> 
    <li style="list-style-type:disc;">cpuset — 这​​​个​​​子​​​系​​​统​​​为​​​ cgroup 中​​​的​​​任​​​务​​​分​​​配​​​独​​​立​​​ CPU（在​​​多​​​核​​​系​​​统​​​）和​​​内​​​存​​​节​​​点​​​。​​​</li> 
    <li style="list-style-type:disc;">devices — 这​​​个​​​子​​​系​​​统​​​可​​​允​​​许​​​或​​​者​​​拒​​​绝​​​ cgroup 中​​​的​​​任​​​务​​​访​​​问​​​设​​​备​​​。​​​</li> 
    <li style="list-style-type:disc;">freezer — 这​​​个​​​子​​​系​​​统​​​挂​​​起​​​或​​​者​​​恢​​​复​​​ cgroup 中​​​的​​​任​​​务​​​。​​​</li> 
    <li style="list-style-type:disc;">memory — 这​​​个​​​子​​​系​​​统​​​设​​​定​​​ cgroup 中​​​任​​​务​​​使​​​用​​​的​​​内​​​存​​​限​​​制​​​，并​​​自​​​动​​​生​​​成​​​​​内​​​存​​​资​​​源使用​​​报​​​告​​​。​​​</li> 
    <li style="list-style-type:disc;">net_cls — 这​​​个​​​子​​​系​​​统​​​使​​​用​​​等​​​级​​​识​​​别​​​符​​​（classid）标​​​记​​​网​​​络​​​数​​​据​​​包​​​，可​​​允​​​许​​​ Linux 流​​​量​​​控​​​制​​​程​​​序​​​（tc）识​​​别​​​从​​​具​​​体​​​ cgroup 中​​​生​​​成​​​的​​​数​​​据​​​包​​​。​​​</li> 
    <li style="list-style-type:disc;">net_prio — 这个子系统用来设计网络流量的优先级</li> 
    <li style="list-style-type:disc;">hugetlb — 这个子系统主要针对于HugeTLB系统进行限制，这是一个大页文件系统。</li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">默认的话，在 Ubuntu 系统中，你可能看不到 net_cls 和 net_prio 目录，它们需要你手工做 mount：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@devstack:/sys/fs/<span style="line-height:1.5;">cgroup# modprobe cls_cgroup
root@devstack:</span>/sys/fs/<span style="line-height:1.5;">cgroup# mkdir net_cls
root@devstack:</span>/sys/fs/cgroup# mount -t cgroup -<span style="line-height:1.5;">o net_cls none net_cls
</span><span style="line-height:1.5;">
root@devstack:</span>/sys/fs/<span style="line-height:1.5;">cgroup# modprobe netprio_cgroup
root@devstack:</span>/sys/fs/<span style="line-height:1.5;">cgroup# mkdir net_prio
root@devstack:</span>/sys/fs/cgroup# mount -t cgroup -<span style="line-height:1.5;">o net_prio none net_prio
</span><span style="line-height:1.5;">
root@devstack:</span>/sys/fs/cgroup# ls net_prio/<span style="line-height:1.5;">cgroup.clone_children  cgroup.procs          net_prio.ifpriomap  notify_on_release  tasks
cgroup.event_control   cgroup.sane_behavior  net_prio.prioidx    release_agent
</span><span style="line-height:1.5;">root@devstack:</span>/sys/fs/cgroup# ls net_cls/<span style="line-height:1.5;">
cgroup.clone_children  cgroup.event_control  cgroup.procs  cgroup.sane_behavior  net_cls.classid  notify_on_release  release_agent  tasks</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.2 实验</h3> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">1.2.1 通过 cgroups 限制进程的 CPU</h4> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">写一段最简单的 C 程序：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">int</span> main(<span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;">)
{
    </span><span style="color:rgb(0,0,255);line-height:1.5;">int</span> i = <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">;
    </span><span style="color:rgb(0,0,255);line-height:1.5;">for</span>(;;) i++<span style="line-height:1.5;">;
    </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">;
}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">编译，运行，发现它占用的 CPU 几乎到了 100%：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre>top - <span style="color:rgb(128,0,128);line-height:1.5;">22</span>:<span style="color:rgb(128,0,128);line-height:1.5;">43</span>:<span style="color:rgb(128,0,128);line-height:1.5;">02</span> up  <span style="color:rgb(128,0,128);line-height:1.5;">1</span>:<span style="color:rgb(128,0,128);line-height:1.5;">14</span>,  <span style="color:rgb(128,0,128);line-height:1.5;">3</span> users,  load average: <span style="color:rgb(128,0,128);line-height:1.5;">0.24</span>, <span style="color:rgb(128,0,128);line-height:1.5;">0.06</span>, <span style="color:rgb(128,0,128);line-height:1.5;">0.06</span><span style="line-height:1.5;">  PID USER      PR  NI    VIRT    RES    SHR S </span>%CPU %MEM     TIME+<span style="line-height:1.5;"> COMMAND
 </span><span style="color:rgb(128,0,128);line-height:1.5;">2304</span> root      <span style="color:rgb(128,0,128);line-height:1.5;">20</span>   <span style="color:rgb(128,0,128);line-height:1.5;">0</span>    <span style="color:rgb(128,0,128);line-height:1.5;">4188</span>    <span style="color:rgb(128,0,128);line-height:1.5;">356</span>    <span style="color:rgb(128,0,128);line-height:1.5;">276</span> R <span style="color:rgb(0,0,255);line-height:1.5;">99.6</span>  <span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>   <span style="color:rgb(128,0,128);line-height:1.5;">0</span>:<span style="color:rgb(128,0,128);line-height:1.5;">11.77</span><span style="line-height:1.5;"> hello<br></span></pre>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">接下来我们做如下操作：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@devstack:/home/sammy/c# mkdir /sys/fs/cgroup/cpu/<span style="line-height:1.5;">hello
root@devstack:</span>/home/sammy/c# cd /sys/fs/cgroup/cpu/<span style="line-height:1.5;">hello
root@devstack:</span>/sys/fs/cgroup/cpu/<span style="line-height:1.5;">hello# ls
cgroup.clone_children  cgroup.procs       cpu.cfs_quota_us  cpu.stat           tasks
cgroup.event_control   cpu.cfs_period_us  cpu.shares        notify_on_release
</span><span style="line-height:1.5;">root@devstack:</span>/sys/fs/cgroup/cpu/<span style="line-height:1.5;">hello# cat cpu.cfs_quota_us
</span>-<span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">
root@devstack:</span>/sys/fs/cgroup/cpu/hello# echo <span style="color:rgb(128,0,128);line-height:1.5;">20000</span> &gt;<span style="line-height:1.5;"> cpu.cfs_quota_us
root@devstack:</span>/sys/fs/cgroup/cpu/<span style="line-height:1.5;">hello# cat cpu.cfs_quota_us
</span><span style="color:rgb(128,0,128);line-height:1.5;">20000</span><span style="line-height:1.5;">
root@devstack:</span>/sys/fs/cgroup/cpu/hello# echo <span style="color:rgb(128,0,128);line-height:1.5;">2428</span> &gt; tasks</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">然后再来看看这个进程的 CPU 占用情况：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre> PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+<span style="line-height:1.5;"> COMMAND
 </span><span style="color:rgb(128,0,128);line-height:1.5;">2428</span> root      <span style="color:rgb(128,0,128);line-height:1.5;">20</span>   <span style="color:rgb(128,0,128);line-height:1.5;">0</span>    <span style="color:rgb(128,0,128);line-height:1.5;">4188</span>    <span style="color:rgb(128,0,128);line-height:1.5;">356</span>    <span style="color:rgb(128,0,128);line-height:1.5;">276</span> R <span style="color:rgb(51,102,255);line-height:1.5;">19.9</span>  <span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>   <span style="color:rgb(128,0,128);line-height:1.5;">0</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46.03</span> hello</pre>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">它占用的 CPU 几乎就是 20%，也就是我们预设的阈值。这说明我们通过上面的步骤，成功地将这个进程运行所占用的 CPU 资源限制在某个阈值之内了。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">如果此时再启动另一个 hello 进程并将其 id 加入 tasks 文件，则两个进程会共享设定的 CPU 限制：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre>  PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+<span style="line-height:1.5;"> COMMAND
 </span><span style="color:rgb(128,0,128);line-height:1.5;">2428</span> root      <span style="color:rgb(128,0,128);line-height:1.5;">20</span>   <span style="color:rgb(128,0,128);line-height:1.5;">0</span>    <span style="color:rgb(128,0,128);line-height:1.5;">4188</span>    <span style="color:rgb(128,0,128);line-height:1.5;">356</span>    <span style="color:rgb(128,0,128);line-height:1.5;">276</span> R <span style="color:rgb(51,102,255);line-height:1.5;">10.0</span>  <span style="color:rgb(128,0,128);line-height:1.5;">0.0</span> <span style="color:rgb(128,0,128);line-height:1.5;">285</span>:<span style="color:rgb(128,0,128);line-height:1.5;">39.54</span><span style="line-height:1.5;"> hello
</span><span style="color:rgb(128,0,128);line-height:1.5;">12526</span> root      <span style="color:rgb(128,0,128);line-height:1.5;">20</span>   <span style="color:rgb(128,0,128);line-height:1.5;">0</span>    <span style="color:rgb(128,0,128);line-height:1.5;">4188</span>    <span style="color:rgb(128,0,128);line-height:1.5;">356</span>    <span style="color:rgb(128,0,128);line-height:1.5;">276</span> R <span style="color:rgb(51,102,255);line-height:1.5;">10.0</span>  <span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>   <span style="color:rgb(128,0,128);line-height:1.5;">0</span>:<span style="color:rgb(128,0,128);line-height:1.5;">25.09</span> hello</pre>
   </div> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">1.2.2 通过 cgroups 限制进程的 Memory</h4> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">同样地，我们针对它占用的内存做如下操作：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@devstack:/sys/fs/cgroup/<span style="line-height:1.5;">memory# mkdir hello
root@devstack:</span>/sys/fs/cgroup/memory# cd hello/<span style="line-height:1.5;">
root@devstack:</span>/sys/fs/cgroup/memory/<span style="line-height:1.5;">hello# cat memory.limit_in_bytes
</span><span style="color:rgb(128,0,128);line-height:1.5;">18446744073709551615</span><span style="line-height:1.5;">
root@devstack:</span>/sys/fs/cgroup/memory/hello# echo 64k &gt;<span style="line-height:1.5;"> memory.limit_in_bytes
root@devstack:</span>/sys/fs/cgroup/memory/hello# echo <span style="color:rgb(128,0,128);line-height:1.5;">2428</span> &gt;<span style="line-height:1.5;"> tasks
root@devstack:</span>/sys/fs/cgroup/memory/hello#</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">上面的步骤会把进程 2428 说占用的内存阈值设置为 64K。超过的话，它会被杀掉。</p> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">1.2.3 限制进程的 I/O</h4> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">运行命令：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre>sudo dd <span style="color:rgb(0,0,255);line-height:1.5;">if</span>=/dev/sda1 of=/dev/<span style="color:rgb(0,0,255);line-height:1.5;">null</span></pre>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">通过 iotop 命令看 IO （此时磁盘在快速转动），此时其写速度为 242M/s：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre> TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&gt;<span style="line-height:1.5;">    COMMAND
 </span><span style="color:rgb(128,0,128);line-height:1.5;">2555</span> be/<span style="color:rgb(128,0,128);line-height:1.5;">4</span> root      <span style="color:rgb(128,0,128);line-height:1.5;">242.60</span> M/s    <span style="color:rgb(128,0,128);line-height:1.5;">0.00</span> B/s  <span style="color:rgb(128,0,128);line-height:1.5;">0.00</span> % <span style="color:rgb(128,0,128);line-height:1.5;">61.66</span> % dd <span style="color:rgb(0,0,255);line-height:1.5;">if</span>=/dev/sda1 of=/dev/<span style="color:rgb(0,0,255);line-height:1.5;">null</span></pre>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">接着做下面的操作：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@devstack:/home/sammy# mkdir /sys/fs/cgroup/blkio/<span style="line-height:1.5;">io
root@devstack:</span>/home/sammy# cd /sys/fs/cgroup/blkio/<span style="line-height:1.5;">io</span><span style="line-height:1.5;">
root@devstack:</span>/sys/fs/cgroup/blkio/io# ls -l /dev/<span style="line-height:1.5;">sda1
brw</span>-rw---- <span style="color:rgb(128,0,128);line-height:1.5;">1</span> root disk <span style="color:rgb(128,0,128);line-height:1.5;">8</span>, <span style="color:rgb(128,0,128);line-height:1.5;">1</span> Sep <span style="color:rgb(128,0,128);line-height:1.5;">18</span> <span style="color:rgb(128,0,128);line-height:1.5;">21</span>:<span style="color:rgb(128,0,128);line-height:1.5;">46</span> /dev/<span style="line-height:1.5;">sda1
</span><span style="line-height:1.5;">root@devstack:</span>/sys/fs/cgroup/blkio/io# echo <span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">8:0 1048576</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>  &gt; /sys/fs/cgroup/blkio/io/<span style="line-height:1.5;">blkio.throttle.read_bps_device
root@devstack:</span>/sys/fs/cgroup/blkio/io# echo <span style="color:rgb(128,0,128);line-height:1.5;">2725</span> &gt; /sys/fs/cgroup/blkio/io/tasks</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">结果，这个进程的IO 速度就被限制在 1Mb/s 之内了：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre> TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&gt;<span style="line-height:1.5;">    COMMAND
 </span><span style="color:rgb(128,0,128);line-height:1.5;">2555</span> be/<span style="color:rgb(128,0,128);line-height:1.5;">4</span> root      <span style="color:rgb(51,102,255);line-height:1.5;">990.44 K/s</span>    <span style="color:rgb(128,0,128);line-height:1.5;">0.00</span> B/s  <span style="color:rgb(128,0,128);line-height:1.5;">0.00</span> % <span style="color:rgb(128,0,128);line-height:1.5;">96.29</span> % dd <span style="color:rgb(0,0,255);line-height:1.5;">if</span>=/dev/sda1 of=/dev/<span style="color:rgb(0,0,255);line-height:1.5;">null</span></pre>
   </div> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.3 术语</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">cgroups 的术语包括：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"> <strong>任务（Tasks）</strong>：就是系统的一个进程。</li> 
    <li style="list-style-type:disc;"> <strong>控制组（Control Group）</strong>：一组按照某种标准划分的进程，比如官方文档中的Professor和Student，或是WWW和System之类的，其表示了某进程组。Cgroups中的资源控制都是以控制组为单位实现。一个进程可以加入到某个控制组。而资源的限制是定义在这个组上，就像上面示例中我用的 hello 一样。简单点说，cgroup的呈现就是一个目录带一系列的可配置文件。</li> 
    <li style="list-style-type:disc;"> <strong>层级（Hierarchy）</strong>：控制组可以组织成hierarchical的形式，既一颗控制组的树（目录结构）。控制组树上的子节点继承父结点的属性。简单点说，hierarchy就是在一个或多个子系统上的cgroups目录树。</li> 
    <li style="list-style-type:disc;"> <strong>子系统（Subsystem）</strong>：一个子系统就是一个资源控制器，比如CPU子系统就是控制CPU时间分配的一个控制器。子系统必须附加到一个层级上才能起作用，一个子系统附加到某个层级以后，这个层级上的所有控制族群都受到这个子系统的控制。Cgroup的子系统可以有很多，也在不断增加中。</li> 
   </ul>
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">2. Docker 对 cgroups 的使用</h2> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">2.1 默认情况</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">默认情况下，Docker 启动一个容器后，会在 /sys/fs/cgroup 目录下的各个资源目录下生成以容器 ID 为名字的目录（group），比如：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre>/sys/fs/cgroup/cpu/docker/03dd196f415276375f754d51ce29b418b170bd92d88c5e420d6901c32f93dc14</pre>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">此时&nbsp;cpu.cfs_quota_us 的内容为 -1，表示默认情况下并没有限制容器的 CPU 使用。在容器被 stopped 后，该目录被删除。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">运行命令&nbsp;docker run -d --name web41 --cpu-quota 25000 --cpu-period 100 --cpu-shares 30 training/webapp python app.py 启动一个新的容器，结果：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@devstack:/sys/fs/cgroup/cpu/docker/<span style="line-height:1.5;">06bd180cd340f8288c18e8f0e01ade66d066058dd053ef46161eb682ab69ec24# cat cpu.cfs_quota_us
</span><span style="color:rgb(128,0,128);line-height:1.5;">25000</span><span style="line-height:1.5;">
root@devstack:</span>/sys/fs/cgroup/cpu/docker/<span style="line-height:1.5;">06bd180cd340f8288c18e8f0e01ade66d066058dd053ef46161eb682ab69ec24# cat tasks
</span><span style="color:rgb(128,0,128);line-height:1.5;">3704</span><span style="line-height:1.5;">
root@devstack:</span>/sys/fs/cgroup/cpu/docker/<span style="line-height:1.5;">06bd180cd340f8288c18e8f0e01ade66d066058dd053ef46161eb682ab69ec24# cat cpu.cfs_period_us
</span><span style="color:rgb(128,0,128);line-height:1.5;">2000</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">Docker 会将容器中的进程的 ID 加入到各个资源对应的 tasks 文件中。表示 Docker 也是以上面的机制来使用 cgroups 对容器的 CPU 使用进行限制。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">相似地，可以通过 docker run 中 mem 相关的参数对容器的内存使用进行限制：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>      --cpuset-mems <span style="color:rgb(0,0,255);line-height:1.5;">string</span>          MEMs <span style="color:rgb(0,0,255);line-height:1.5;">in</span> which to allow execution (<span style="color:rgb(128,0,128);line-height:1.5;">0</span>-<span style="color:rgb(128,0,128);line-height:1.5;">3</span>, <span style="color:rgb(128,0,128);line-height:1.5;">0</span>,<span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">)
      </span>--kernel-memory <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">        Kernel memory limit
  </span>-m, --memory <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">               Memory limit
      </span>--memory-reservation <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">   Memory soft limit
      </span>--memory-swap <span style="color:rgb(0,0,255);line-height:1.5;">string</span>          Swap limit equal to memory plus swap: <span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">-1</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="line-height:1.5;"> to enable unlimited swap
      </span>--memory-swappiness <span style="color:rgb(0,0,255);line-height:1.5;">int</span>       Tune container memory swappiness (<span style="color:rgb(128,0,128);line-height:1.5;">0</span> to <span style="color:rgb(128,0,128);line-height:1.5;">100</span>) (<span style="color:rgb(0,0,255);line-height:1.5;">default</span> -<span style="color:rgb(128,0,128);line-height:1.5;">1</span>)</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">比如&nbsp;&nbsp;docker run -d --name web42 --blkio-weight 100 --memory 10M --cpu-quota 25000 --cpu-period 2000 --cpu-shares 30 training/webapp python app.py：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <pre>root@devstack:/sys/fs/cgroup/memory/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410# cat memory.limit_in_bytes
</span><span style="color:rgb(128,0,128);line-height:1.5;">10485760<br></span></pre> 
    <p style="line-height:1.5;">&nbsp; root@devstack:/sys/fs/cgroup/blkio/docker/ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410# cat blkio.weight<br> &nbsp; 100</p> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">目前 docker 已经几乎支持了所有的 cgroups 资源，可以限制容器对包括 network，device，cpu 和 memory 在内的资源的使用，比如：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@devstack:/sys/fs/cgroup# find -<span style="line-height:1.5;">iname ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">net_prio</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">net_cls</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">systemd</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">hugetlb</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">perf_event</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">blkio</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">freezer</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">devices</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">memory</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">cpuacct</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">cpu</span>/docker/<span style="line-height:1.5;">ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410
.</span>/<span style="color:rgb(0,0,255);line-height:1.5;">cpuset</span>/docker/ec8d850ebbabaf24df572cb5acd89a6e7a953fe5aa5d3c6a69c4532f92b57410</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">&nbsp;2.2 net_cls&nbsp;</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp; &nbsp;net_cls 和 tc 一起使用可用于限制进程发出的网络包所使用的网络带宽。当使用 cgroups network controll net_cls 后，指定进程发出的所有网络包都会被加一个 tag，然后就可以使用其他工具比如 iptables 或者 traffic controller （TC）来根据网络包上的 tag 进行流量控制。关于 TC 的文档，网上很多，这里不再赘述，只是用一个简单的例子来加以说明。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp; 关于 classid，它的格式是&nbsp;0xAAAABBBB，其中，AAAA 是十六进制的主ID（major number），BBBB 是十六进制的次ID（minor number）。因此，0X10001 表示 10：1，而&nbsp;0x00010001 表示 1：！。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp; （1）首先在host 的网卡 eth0 上做如下设置：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <p style="line-height:1.5;">tc qdisc del dev eth0 root &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#删除已有的规则<br> tc qdisc add dev eth0 root handle 10: htb default 12 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br> tc class add dev eth0 parent 10: classid 10:1 htb rate 1500kbit ceil 1500kbit burst 10k &nbsp; &nbsp; &nbsp; &nbsp; #限速<br> tc filter add dev eth0 protocol ip parent 10:0 prio 1 u32 match ip protocol 1 0xff flowid 10:1 &nbsp;#只处理 ping 参数的网络包</p> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><span style="line-height:1.5;">其结果是：</span></p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">在网卡 eth0 上创建了一个 HTB root 队列，hangle 10： 表示队列句柄也就是major number 为 10</li> 
    <li style="list-style-type:disc;">创建一个分类 10：1，限制它的出发网络带宽为 80 kbit （千比特每秒）</li> 
    <li style="list-style-type:disc;">创建一个分类器，将 eth0 上 IP IMCP 协议 的 major ID 为 10 的 prio 为 1 的网络流量都分类到 10：1 类别</li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（2）启动容器</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">容器启动后，其 init 进程在host 上的 PID 就被加入到 tasks 文件中了：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre>root@devstack:/sys/fs/cgroup/net_cls/docker/ff8d9715b7e11a5a69446ff1e3fde3770078e32a7d8f7c1cb35d51c75768fe33# ps -ef | grep <span style="color:rgb(128,0,128);line-height:1.5;">10047</span>
<span style="color:rgb(128,0,128);line-height:1.5;">231072</span>   <span style="color:rgb(128,0,128);line-height:1.5;">10047</span> <span style="color:rgb(128,0,128);line-height:1.5;">10013</span>  <span style="color:rgb(128,0,128);line-height:1.5;">1</span> <span style="color:rgb(128,0,128);line-height:1.5;">07</span>:<span style="color:rgb(128,0,128);line-height:1.5;">08</span> ?        <span style="color:rgb(128,0,128);line-height:1.5;">00</span>:<span style="color:rgb(128,0,128);line-height:1.5;">00</span>:<span style="color:rgb(128,0,128);line-height:1.5;">00</span> python app.py</pre>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">设置 net_cls classid：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre>echo <span style="color:rgb(128,0,128);line-height:1.5;">0x100001</span> &gt; net_cls.classid</pre>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">再在容器启动一个 ping 进程，其 ID 也被加入到 tasks 文件中了。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（3）查看tc&nbsp;情况：&nbsp;tc -s -d class show dev eth0</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <p style="line-height:1.5;">Every 2.0s: tc -s class ls dev eth0 Wed Sep 21 04:07:56 2016</p> 
    <p style="line-height:1.5;">class htb 10:1 root prio 0 rate 1500Kbit ceil 1500Kbit burst 10Kb cburst 1599b<br> Sent 17836 bytes 182 pkt (dropped 0, overlimits 0 requeues 0)<br> rate 0bit 0pps backlog 0b 0p requeues 0<br> lended: 182 borrowed: 0 giants: 0<br> tokens: 845161 ctokens: 125161</p> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">我们可以看到 tc 已经在处理 ping 进程产生的数据包了。再来看一下 net_cls 和 ts 合作的限速效果：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre><span style="color:rgb(128,0,128);line-height:1.5;">10488</span> bytes <span style="color:rgb(0,0,255);line-height:1.5;">from</span> <span style="color:rgb(128,0,128);line-height:1.5;">192.168</span>.<span style="color:rgb(128,0,128);line-height:1.5;">1.1</span>: icmp_seq=<span style="color:rgb(128,0,128);line-height:1.5;">35</span> ttl=<span style="color:rgb(128,0,128);line-height:1.5;">63</span> time=<span style="color:rgb(128,0,128);line-height:1.5;">12.7</span><span style="line-height:1.5;"> ms
</span><span style="color:rgb(128,0,128);line-height:1.5;">10488</span> bytes <span style="color:rgb(0,0,255);line-height:1.5;">from</span> <span style="color:rgb(128,0,128);line-height:1.5;">192.168</span>.<span style="color:rgb(128,0,128);line-height:1.5;">1.1</span>: icmp_seq=<span style="color:rgb(128,0,128);line-height:1.5;">36</span> ttl=<span style="color:rgb(128,0,128);line-height:1.5;">63</span> time=<span style="color:rgb(51,102,255);line-height:1.5;">15.2</span><span style="line-height:1.5;"> ms
</span><span style="color:rgb(128,0,128);line-height:1.5;">10488</span> bytes <span style="color:rgb(0,0,255);line-height:1.5;">from</span> <span style="color:rgb(128,0,128);line-height:1.5;">192.168</span>.<span style="color:rgb(128,0,128);line-height:1.5;">1.1</span>: icmp_seq=<span style="color:rgb(128,0,128);line-height:1.5;">37</span> ttl=<span style="color:rgb(128,0,128);line-height:1.5;">63</span> time=<span style="color:rgb(51,102,255);line-height:1.5;">4805</span><span style="line-height:1.5;"> ms
</span><span style="color:rgb(128,0,128);line-height:1.5;">10488</span> bytes <span style="color:rgb(0,0,255);line-height:1.5;">from</span> <span style="color:rgb(128,0,128);line-height:1.5;">192.168</span>.<span style="color:rgb(128,0,128);line-height:1.5;">1.1</span>: icmp_seq=<span style="color:rgb(128,0,128);line-height:1.5;">38</span> ttl=<span style="color:rgb(128,0,128);line-height:1.5;">63</span> time=<span style="color:rgb(128,0,128);line-height:1.5;">9543</span><span style="line-height:1.5;"> ms</span><span style="color:rgb(128,0,128);line-height:1.5;"><br></span></pre>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">其中：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">后两条说使用的 tc class 规则是&nbsp;tc class add dev eth0 parent 10: classid 10:1 htb rate 1500kbit ceil&nbsp;<span style="line-height:1.5;color:rgb(51,102,255);">15kbit</span>&nbsp;burst 10k</li> 
    <li style="list-style-type:disc;">前两条所使用的 tc class 规则是&nbsp;tc class add dev eth0 parent 10: classid 10:1 htb rate 1500kbit ceil&nbsp;<span style="line-height:1.5;color:rgb(51,102,255);">10Mbit</span>&nbsp;burst 10k<span style="line-height:1.5;">&nbsp;</span> </li> 
   </ul>
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">3. Docker run 命令中 cgroups 相关命令&nbsp;</h2> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><strong><span style="line-height:1.5;">block IO: </span></strong>--blkio-weight value          Block IO (relative weight), between <span style="color:rgb(128,0,128);line-height:1.5;">10</span> and <span style="color:rgb(128,0,128);line-height:1.5;">1000</span>
      --blkio-weight-device value   Block IO weight (relative device weight) (<span style="color:rgb(0,0,255);line-height:1.5;">default</span><span style="line-height:1.5;"> [])
      </span>--cgroup-parent <span style="color:rgb(0,0,255);line-height:1.5;">string</span>        Optional parent cgroup <span style="color:rgb(0,0,255);line-height:1.5;">for</span><span style="line-height:1.5;"> the container
<strong>CPU: </strong></span>--cpu-percent <span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">             CPU percent (Windows only)
      </span>--cpu-period <span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">              Limit CPU CFS (Completely Fair Scheduler) period
      </span>--cpu-quota <span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">               Limit CPU CFS (Completely Fair Scheduler) quota
  </span>-c, --cpu-shares <span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">              CPU shares (relative weight)
      </span>--cpuset-cpus <span style="color:rgb(0,0,255);line-height:1.5;">string</span>          CPUs <span style="color:rgb(0,0,255);line-height:1.5;">in</span> which to allow execution (<span style="color:rgb(128,0,128);line-height:1.5;">0</span>-<span style="color:rgb(128,0,128);line-height:1.5;">3</span>, <span style="color:rgb(128,0,128);line-height:1.5;">0</span>,<span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">)
      </span>--cpuset-mems <span style="color:rgb(0,0,255);line-height:1.5;">string</span>          MEMs <span style="color:rgb(0,0,255);line-height:1.5;">in</span> which to allow execution (<span style="color:rgb(128,0,128);line-height:1.5;">0</span>-<span style="color:rgb(128,0,128);line-height:1.5;">3</span>, <span style="color:rgb(128,0,128);line-height:1.5;">0</span>,<span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">)
<strong>Device: </strong></span>--device value                Add a host device to the container (<span style="color:rgb(0,0,255);line-height:1.5;">default</span><span style="line-height:1.5;"> [])
      </span>--device-read-bps value       Limit read rate (bytes per second) <span style="color:rgb(0,0,255);line-height:1.5;">from</span> a device (<span style="color:rgb(0,0,255);line-height:1.5;">default</span><span style="line-height:1.5;"> [])
      </span>--device-read-iops value      Limit read rate (IO per second) <span style="color:rgb(0,0,255);line-height:1.5;">from</span> a device (<span style="color:rgb(0,0,255);line-height:1.5;">default</span><span style="line-height:1.5;"> [])
      </span>--device-write-bps value      Limit write rate (bytes per second) to a device (<span style="color:rgb(0,0,255);line-height:1.5;">default</span><span style="line-height:1.5;"> [])
      </span>--device-write-iops value     Limit write rate (IO per second) to a device (<span style="color:rgb(0,0,255);line-height:1.5;">default</span><span style="line-height:1.5;"> [])
<strong>Memory: </strong></span>--kernel-memory <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">        Kernel memory limit
  </span>-m, --memory <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">               Memory limit
      </span>--memory-reservation <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">   Memory soft limit
      </span>--memory-swap <span style="color:rgb(0,0,255);line-height:1.5;">string</span>          Swap limit equal to memory plus swap: <span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">-1</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="line-height:1.5;"> to enable unlimited swap
      </span>--memory-swappiness <span style="color:rgb(0,0,255);line-height:1.5;">int</span>       Tune container memory swappiness (<span style="color:rgb(128,0,128);line-height:1.5;">0</span> to <span style="color:rgb(128,0,128);line-height:1.5;">100</span>) (<span style="color:rgb(0,0,255);line-height:1.5;">default</span> -<span style="color:rgb(128,0,128);line-height:1.5;">1</span>)</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">一些说明：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">1. cgroup 只能限制 CPU 的使用，而不能保证CPU的使用。也就是说， 使用&nbsp;cpuset-cpus，可以让容器在指定的CPU或者核上运行，但是不能确保它独占这些CPU；cpu-shares 是个相对值，只有在CPU不够用的时候才其作用。也就是说，当CPU够用的时候，每个容器会分到足够的CPU；不够用的时候，会按照指定的比重在多个容器之间分配CPU。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">2. 对内存来说，cgroups 可以限制容器最多使用的内存。使用 -m 参数可以设置最多可以使用的内存。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">参考链接：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"><a href="http://coolshell.cn/articles/17049.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Docker基础技术：Linux CGroup</a></li> 
    <li style="list-style-type:disc;"><a href="http://blog.csdn.net/qinyushuang/article/details/46611709" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">http://blog.csdn.net/qinyushuang/article/details/46611709</a></li> 
    <li style="list-style-type:disc;"><a href="http://www.funtoo.org/Traffic_Control" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">http://www.funtoo.org/Traffic_Control</a></li> 
    <li style="list-style-type:disc;"><a href="https://docs.docker.com/engine/admin/resource_constraints/" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">https://docs.docker.com/engine/admin/resource_constraints/</a></li> 
   </ul>
   <div>
    <font color="#4b4b4b"><span style="font-size:15px;"><br></span></font>
   </div> 
   <div> 
    <font color="#4b4b4b"><span style="font-size:15px;">&nbsp; &nbsp; 本文转自SammyLiu博客园博客，原文链接：http://www.cnblogs.com/sammyliu/p/5886833.html</span></font>
    <span style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
