<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>一小时学会C# 6 « NotBeCN</title>
  <meta name="description" content="                  c# 6已经出来有一段时间了，今天我们就详细地看一下这些新的特性。        一、字符串插值 （String Interpolation）    C# 6之前我们拼接字符串时需要这样     var Name = "Jack"; var results = "Hello" ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/09/weixin_33862514_90129132.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">一小时学会C# 6</h1>
    <p class="post-meta">Nov 9, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <blockquote style="border:2px solid rgb(239,239,239);color:rgb(102,102,102);font-size:13px;font-family:Georgia, 'Times New Roman', Times, sans-serif;background:rgb(255,255,255) url(&quot;images/bq.gif&quot;) no-repeat 0% 0%;"> 
    <p style="line-height:1.8;">c# 6已经出来有一段时间了，今天我们就详细地看一下这些新的特性。</p> 
   </blockquote> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">一、字符串插值 （String Interpolation）</h2> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">C# 6之前我们拼接字符串时需要这样</p> 
   <pre><code class="hljs swift" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"> <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> <span class="hljs-type" style="color:rgb(163,21,21);">Name</span> = <span class="hljs-string" style="color:rgb(163,21,21);">"Jack"</span>;
 <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> results = <span class="hljs-string" style="color:rgb(163,21,21);">"Hello"</span> + <span class="hljs-type" style="color:rgb(163,21,21);">Name</span>;</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">或者</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"> <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> Name = <span class="hljs-string" style="color:rgb(163,21,21);">"Jack"</span>;
 <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> results = <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span>.Format(<span class="hljs-string" style="color:rgb(163,21,21);">"Hello {0}"</span>, Name);</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">但是C#6里我们就可以使用新的字符串插值特性</p> 
   <pre><code class="hljs swift" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">  <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> <span class="hljs-type" style="color:rgb(163,21,21);">Name</span> = <span class="hljs-string" style="color:rgb(163,21,21);">"Jack"</span>;
  <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> results = $<span class="hljs-string" style="color:rgb(163,21,21);">"Hello {Name}"</span>;</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">上面只是一个简单的例子，想想如果有多个值要替换的话，用C#6的这个新特性，代码就会大大减小，而且可读性比起之前大大增强</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"> Person p = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> Person {FirstName = <span class="hljs-string" style="color:rgb(163,21,21);">"Jack"</span>, LastName = <span class="hljs-string" style="color:rgb(163,21,21);">"Wang"</span>, Age = <span class="hljs-number">100</span>};
 <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> results = <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span>.Format(<span class="hljs-string" style="color:rgb(163,21,21);">"First Name: {0} LastName: {1} Age: { 2} "</span>, p.FirstName, p.LastName, p.Age);</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">有了字符串插值后:</p> 
   <pre><code class="hljs swift" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"> <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> results = $<span class="hljs-string" style="color:rgb(163,21,21);">"First Name: {p.FirstName} LastName: {p.LastName} Age: {p.Age}"</span>;</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">字符串插值不光是可以插简单的字符串，还可以直接插入代码</p> 
   <pre><code class="hljs swift" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-type" style="color:rgb(163,21,21);">Console</span>.<span class="hljs-type" style="color:rgb(163,21,21);">WriteLine</span>($<span class="hljs-string" style="color:rgb(163,21,21);">"Jack is saying { new Tools().SayHello() }"</span>);

 <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> info = $<span class="hljs-string" style="color:rgb(163,21,21);">"Your discount is {await GetDiscount()}"</span>;</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">那么如何处理多语言呢？</p> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">我们可以使用 IFormattable</p> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">下面的代码如何实现多语言？</p> 
   <pre><code class="hljs nginx" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"> <span class="hljs-attribute" style="color:rgb(163,21,21);">Double</span> remain = <span class="hljs-number">2000</span>.<span class="hljs-number">5</span>; 
 <span class="hljs-attribute" style="color:rgb(163,21,21);">var</span> results= $<span class="hljs-string" style="color:rgb(163,21,21);">"your money is {remain:C}"</span>;  

<span class="hljs-comment" style="color:#008000;"># 输出 your money is $2,000.50</span></code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">使用IFormattable 多语言</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">void</span> <span class="hljs-title" style="color:rgb(163,21,21);">Main</span>(<span class="hljs-params"><span class="hljs-keyword" style="color:rgb(0,0,255);">string</span>[] args</span>) </span>{

        Double remain = <span class="hljs-number">2000.5</span>; 

       <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> results= ChineseText($<span class="hljs-string" style="color:rgb(163,21,21);">"your money is {remain:C}"</span>);

        Console.WriteLine(results);
        Console.Read();
    }

    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span> <span class="hljs-title" style="color:rgb(163,21,21);">ChineseText</span>(<span class="hljs-params">IFormattable formattable</span>) </span>{
        <span class="hljs-keyword" style="color:rgb(0,0,255);">return</span> formattable.ToString(<span class="hljs-keyword" style="color:rgb(0,0,255);">null</span>, <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> CultureInfo(<span class="hljs-string" style="color:rgb(163,21,21);">"zh-cn"</span>));
    }
}

<span class="hljs-meta" style="color:rgb(43,145,175);"># 输出 your money is ￥2,000.50</span></code></pre> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">二、空操作符 ( ?. )</h2> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">C# 6添加了一个 ?. 操作符，当一个对象或者属性职为空时直接返回null, 就不再继续执行后面的代码，在之前我们的代码里经常出现 NullException, 所以我们就需要加很多Null的判断，比如</p> 
   <pre><code class="hljs cmake" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"> <span class="hljs-keyword" style="color:rgb(0,0,255);">if</span> (user != null &amp;&amp; user.<span class="hljs-keyword" style="color:rgb(0,0,255);">Project</span> != null &amp;&amp; user.<span class="hljs-keyword" style="color:rgb(0,0,255);">Project</span>.Tasks != null &amp;&amp; user.<span class="hljs-keyword" style="color:rgb(0,0,255);">Project</span>.Tasks.Count &gt; <span class="hljs-number">0</span>)
 {
   Console.WriteLine(user.<span class="hljs-keyword" style="color:rgb(0,0,255);">Project</span>.Tasks.First().Name);
 }</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">现在我们可以不用写 IF 直接写成如下这样</p> 
   <pre><code class="hljs css" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-selector-tag" style="color:rgb(0,0,255);">Console</span><span class="hljs-selector-class">.WriteLine</span>(<span class="hljs-selector-tag" style="color:rgb(0,0,255);">user</span>?<span class="hljs-selector-class">.Project</span>?<span class="hljs-selector-class">.Tasks</span>?<span class="hljs-selector-class">.First</span>()?<span class="hljs-selector-class">.Name</span>);</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">这个?. 特性不光是可以用于取值，也可以用于方法调用，如果对象为空将不进行任何操作，下面的代码不会报错，也不会有任何输出。</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">void</span> <span class="hljs-title" style="color:rgb(163,21,21);">Main</span>(<span class="hljs-params"><span class="hljs-keyword" style="color:rgb(0,0,255);">string</span>[] args</span>) </span>{
        User user = <span class="hljs-keyword" style="color:rgb(0,0,255);">null</span>;
        user?.SayHello();
        Console.Read();
    }
}

<span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">User</span>
{
    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">void</span> <span class="hljs-title" style="color:rgb(163,21,21);">SayHello</span>(<span class="hljs-params"></span>) </span>{
        Console.WriteLine(<span class="hljs-string" style="color:rgb(163,21,21);">"Ha Ha"</span>);
    }
}</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">还可以用于数组的索引器</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">void</span> <span class="hljs-title" style="color:rgb(163,21,21);">Main</span>(<span class="hljs-params"><span class="hljs-keyword" style="color:rgb(0,0,255);">string</span>[] args</span>) </span>{
        User[] users = <span class="hljs-keyword" style="color:rgb(0,0,255);">null</span>;

        List&lt;User&gt; listUsers = <span class="hljs-keyword" style="color:rgb(0,0,255);">null</span>;

        <span class="hljs-comment" style="color:#008000;">// Console.WriteLine(users[1]?.Name); // 报错</span>
        <span class="hljs-comment" style="color:#008000;">// Console.WriteLine(listUsers[1]?.Name); //报错</span>

        Console.WriteLine(users?[<span class="hljs-number">1</span>].Name); <span class="hljs-comment" style="color:#008000;">// 正常</span>
        Console.WriteLine(listUsers?[<span class="hljs-number">1</span>].Name); <span class="hljs-comment" style="color:#008000;">// 正常</span>

        Console.ReadLine();
    }
}</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>注意： 上面的代码虽然可以让我们少些很多代码，而且也减少了空异常，但是我们却需要小心使用，因为有的时候我们确实是需要抛出空异常，那么使用这个特性反而隐藏了Bug</strong></p> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">三、 NameOf</h2> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">过去，我们有很多的地方需要些硬字符串，导致重构比较困难，而且一旦敲错字母很难察觉出来，比如</p> 
   <pre><code class="hljs cpp" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">if</span> (role == <span class="hljs-string" style="color:rgb(163,21,21);">"admin"</span>)
{
}</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">WPF 也经常有这样的代码</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span> Name
{
  <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span> { <span class="hljs-keyword" style="color:rgb(0,0,255);">return</span> name; }
  <span class="hljs-keyword" style="color:rgb(0,0,255);">set</span>
  {
      name= <span class="hljs-keyword" style="color:rgb(0,0,255);">value</span>;
      RaisePropertyChanged(<span class="hljs-string" style="color:rgb(163,21,21);">"Name"</span>);
  }
}</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">现在有了C#6 NameOf后，我们可以这样</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span> Name
{
  <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span> { <span class="hljs-keyword" style="color:rgb(0,0,255);">return</span> name; }
  <span class="hljs-keyword" style="color:rgb(0,0,255);">set</span>
  {
      name= <span class="hljs-keyword" style="color:rgb(0,0,255);">value</span>;
      RaisePropertyChanged(NameOf(Name));
  }
}

  <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">void</span> <span class="hljs-title" style="color:rgb(163,21,21);">Main</span>(<span class="hljs-params"><span class="hljs-keyword" style="color:rgb(0,0,255);">string</span>[] args</span>) </span>{
        Console.WriteLine(nameof(User.Name)); <span class="hljs-comment" style="color:#008000;">// output: Name</span>
        Console.WriteLine(nameof(System.Linq)); <span class="hljs-comment" style="color:#008000;">// output: Linq</span>
        Console.WriteLine(nameof(List&lt;User&gt;)); <span class="hljs-comment" style="color:#008000;">// output: List</span>
        Console.ReadLine();
    }</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><strong>注意： NameOf只会返回Member的字符串，如果前面有对象或者命名空间，NameOf只会返回 . 的最后一部分, 另外NameOf有很多情况是不支持的，比如方法，关键字，对象的实例以及字符串和表达式</strong></p> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">四、在Catch和Finally里使用Await</h2> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">在之前的版本里，C#开发团队认为在Catch和Finally里使用Await是不可能，而现在他们在C#6里实现了它。</p> 
   <pre><code class="hljs javascript" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">      Resource res = <span class="hljs-literal" style="color:rgb(163,21,21);">null</span>;
        <span class="hljs-keyword" style="color:rgb(0,0,255);">try</span>
        {
            res = <span class="hljs-keyword" style="color:rgb(0,0,255);">await</span> Resource.OpenAsync(); <span class="hljs-comment" style="color:#008000;">// You could always do this.&nbsp;&nbsp;</span>
        }
        <span class="hljs-keyword" style="color:rgb(0,0,255);">catch</span> (ResourceException e)
        {
            <span class="hljs-keyword" style="color:rgb(0,0,255);">await</span>&nbsp;Resource.LogAsync(res, e); <span class="hljs-comment" style="color:#008000;">// Now you can do this …&nbsp;</span>
        }&nbsp;
        <span class="hljs-keyword" style="color:rgb(0,0,255);">finally</span>
        {
            <span class="hljs-keyword" style="color:rgb(0,0,255);">if</span> (res != <span class="hljs-literal" style="color:rgb(163,21,21);">null</span>)&nbsp;<span class="hljs-keyword" style="color:rgb(0,0,255);">await</span>&nbsp;res.CloseAsync(); <span class="hljs-comment" style="color:#008000;">// … and this.</span>
        }</code></pre> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">五、表达式方法体</h2> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">一句话的方法体可以直接写成箭头函数，而不再需要大括号</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">Program</span>
 {
    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">private</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span> <span class="hljs-title" style="color:rgb(163,21,21);">SayHello</span>(<span class="hljs-params"></span>) </span>=&gt; <span class="hljs-string" style="color:rgb(163,21,21);">"Hello World"</span>;
    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">private</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span> <span class="hljs-title" style="color:rgb(163,21,21);">JackSayHello</span>(<span class="hljs-params"></span>) </span>=&gt; $<span class="hljs-string" style="color:rgb(163,21,21);">"Jack {SayHello()}"</span>;

    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">void</span> <span class="hljs-title" style="color:rgb(163,21,21);">Main</span>(<span class="hljs-params"><span class="hljs-keyword" style="color:rgb(0,0,255);">string</span>[] args</span>) </span>{
        Console.WriteLine(SayHello());
        Console.WriteLine(JackSayHello());
        
        Console.ReadLine();
    }
}</code></pre> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">六、自动属性初始化器</h2> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">之前我们需要赋初始化值，一般需要这样</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">Person</span>
{
    <span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">int</span> Age { <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span>; <span class="hljs-keyword" style="color:rgb(0,0,255);">set</span>; }

    <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-title" style="color:rgb(163,21,21);">Person</span>(<span class="hljs-params"></span>) </span>{
        Age = <span class="hljs-number">100</span>;
    }
}</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">但是C# 6的新特性里我们这样赋值</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">Person</span>
{
    <span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">int</span> Age { <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span>; <span class="hljs-keyword" style="color:rgb(0,0,255);">set</span>; } = <span class="hljs-number">100</span>;
}</code></pre> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">七、只读自动属性</h2> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">C# 1里我们可以这样实现只读属性</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">Person</span>
{
    <span class="hljs-keyword" style="color:rgb(0,0,255);">private</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">int</span> age=<span class="hljs-number">100</span>;

    <span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">int</span> Age
    {
        <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span> { <span class="hljs-keyword" style="color:rgb(0,0,255);">return</span> age; }
    }
}</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">但是当我们有自动属性时，我们没办法实行只读属性，因为自动属性不支持readonly关键字，所以我们只能缩小访问权限</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">Person</span>
{
    <span class="hljs-keyword" style="color:rgb(0,0,255);">public</span>  <span class="hljs-keyword" style="color:rgb(0,0,255);">int</span> Age { <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span>; <span class="hljs-keyword" style="color:rgb(0,0,255);">private</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">set</span>; }
   
}</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">但是 C#6里我们可以实现readonly的自动属性了</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">Person</span>
{
    <span class="hljs-keyword" style="color:rgb(0,0,255);">public</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">int</span> Age { <span class="hljs-keyword" style="color:rgb(0,0,255);">get</span>; } = <span class="hljs-number">100</span>;
}</code></pre> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">八、异常过滤器 Exception Filter</h2> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);">   <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">void</span> <span class="hljs-title" style="color:rgb(163,21,21);">Main</span>(<span class="hljs-params"><span class="hljs-keyword" style="color:rgb(0,0,255);">string</span>[] args</span>) </span>{

        <span class="hljs-keyword" style="color:rgb(0,0,255);">try</span>
        {
            <span class="hljs-keyword" style="color:rgb(0,0,255);">throw</span>  <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> ArgumentException(<span class="hljs-string" style="color:rgb(163,21,21);">"Age"</span>);
        }
        <span class="hljs-keyword" style="color:rgb(0,0,255);">catch</span> (ArgumentException argumentException) <span class="hljs-keyword" style="color:rgb(0,0,255);">when</span>( argumentException.Message.Equals(<span class="hljs-string" style="color:rgb(163,21,21);">"Name"</span>))
        {
            <span class="hljs-keyword" style="color:rgb(0,0,255);">throw</span>  <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> ArgumentException(<span class="hljs-string" style="color:rgb(163,21,21);">"Name Exception"</span>);

        }

        <span class="hljs-keyword" style="color:rgb(0,0,255);">catch</span> (ArgumentException argumentException) <span class="hljs-keyword" style="color:rgb(0,0,255);">when</span>( argumentException.Message.Equals(<span class="hljs-string" style="color:rgb(163,21,21);">"Age"</span>))
        {
            <span class="hljs-keyword" style="color:rgb(0,0,255);">throw</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> Exception(<span class="hljs-string" style="color:rgb(163,21,21);">"not handle"</span>);
            
        }
        <span class="hljs-keyword" style="color:rgb(0,0,255);">catch</span>  (Exception e)
        {
            
            <span class="hljs-keyword" style="color:rgb(0,0,255);">throw</span>;
        }
    }</code></pre> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">在之前，一种异常只能被Catch一次，现在有了Filter后可以对相同的异常进行过滤，至于有什么用，那就是见仁见智了，我觉得上面的例子，定义两个具体的异常 NameArgumentException 和AgeArgumentException代码更易读。</p> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">九、 Index 初始化器</h2> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">这个主要是用在Dictionary上，至于有什么用，我目前没感觉到有一点用处，谁能知道很好的使用场景，欢迎补充:</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"> <span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> names = <span class="hljs-keyword" style="color:rgb(0,0,255);">new</span> Dictionary&lt;<span class="hljs-keyword" style="color:rgb(0,0,255);">int</span>, <span class="hljs-keyword" style="color:rgb(0,0,255);">string</span>&gt;
        {
            [<span class="hljs-number">1</span>] = <span class="hljs-string" style="color:rgb(163,21,21);">"Jack"</span>,
            [<span class="hljs-number">2</span>] = <span class="hljs-string" style="color:rgb(163,21,21);">"Alex"</span>,
            [<span class="hljs-number">3</span>] = <span class="hljs-string" style="color:rgb(163,21,21);">"Eric"</span>,
            [<span class="hljs-number">4</span>] = <span class="hljs-string" style="color:rgb(163,21,21);">"Jo"</span>
        };

        <span class="hljs-keyword" style="color:rgb(0,0,255);">foreach</span> (<span class="hljs-keyword" style="color:rgb(0,0,255);">var</span> item <span class="hljs-keyword" style="color:rgb(0,0,255);">in</span> names)
        {
            Console.WriteLine($<span class="hljs-string" style="color:rgb(163,21,21);">"{item.Key} = {item.Value}"</span>);
        }</code></pre> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">十、using 静态类的方法可以使用 static using</h2> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">这个功能在我看来，同样是很没有用的功能，也为去掉前缀有的时候我们不知道这个是来自哪里的，而且如果有一个同名方法不知道具体用哪个，当然经证实是使用类本身的覆盖，但是容易搞混不是吗？</p> 
   <pre><code class="hljs cs" style="vertical-align:middle;color:rgb(0,0,0);line-height:1.5;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-keyword" style="color:rgb(0,0,255);">using</span> System;
<span class="hljs-keyword" style="color:rgb(0,0,255);">using</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> System.Math;
<span class="hljs-keyword" style="color:rgb(0,0,255);">namespace</span> <span class="hljs-title" style="color:rgb(163,21,21);">CSharp6NewFeatures</span>
 {
  <span class="hljs-keyword" style="color:rgb(0,0,255);">class</span> <span class="hljs-title" style="color:rgb(163,21,21);">Program</span>
  {
      <span class="hljs-function"><span class="hljs-keyword" style="color:rgb(0,0,255);">static</span> <span class="hljs-keyword" style="color:rgb(0,0,255);">void</span> <span class="hljs-title" style="color:rgb(163,21,21);">Main</span>(<span class="hljs-params"><span class="hljs-keyword" style="color:rgb(0,0,255);">string</span>[] args</span>) </span>{
        Console.WriteLine(Log10(<span class="hljs-number">5</span>)+PI);
    }
  }
}</code></pre> 
   <h2 style="font-size:21px;letter-spacing:-1px;line-height:1.5;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;background-image:none;background-position:0% 100%;background-repeat:repeat-x;">总结</h2> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">上面一到八我认为都是比较有用的新特性，后面的几个我觉得用处不大，当然如果找到合适的使用场景应该有用，欢迎大家补充。</p> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">最后，祝大家编程愉快。</p> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">本文转自敏捷的水博客园博客，原文链接http://www.cnblogs.com/cnblogsfans/p/5086292.html如需转载请自行联系原作者</p> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;"><br></p> 
   <p style="line-height:25.2px;color:rgb(51,51,51);font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;">王德水</p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
