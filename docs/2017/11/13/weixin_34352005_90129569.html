<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>在VS中利用BackgroundWorker类来实现“仿线程池” « NotBeCN</title>
  <meta name="description" content="             在VS编程中，一般遇到比较耗时的操作的时候（例如：从网络上下载文档，文件的IO操作等），如果采用一般的做法，主线程会一直等待操作完成，会遇到界面假死的问题。故在此情况下，合理的做法是采用异步操作和多线程操作。异步操作可以在另开一个线程执行耗时的操作，在主线程上是不等返回，直接操作下一步，...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/13/weixin_34352005_90129569.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">在VS中利用BackgroundWorker类来实现“仿线程池”</h1>
    <p class="post-meta">Nov 13, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">在</span><span style="line-height:1.5;font-size:12pt;">VS</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">编程中，一般遇到比较耗时的操作的时候（例如：从网络上下载文档，文件的</span><span style="line-height:1.5;font-size:12pt;">IO</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">操作等），如果采用一般的做法，主线程会一直等待操作完成，会遇到界面假死的问题。故在此情况下，合理的做法是采用异步操作和多线程操作。异步操作可以在另开一个线程执行耗时的操作，在主线程上是不等返回，直接操作下一步，从而解决了界面假死的情况。不过，由于异步操作是新开了一个线程，在新开的线程里操作界面元素的时候（例如：在下载文档时显示进度，修改界面上的进度条的数值），会抛出一个线程安全的异常。为了解决这个问题，</span><span style="line-height:1.5;font-size:12pt;">VS</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">提供了</span><span style="line-height:1.5;font-size:12pt;">BackgroundWorker</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">类，通过内部封装，提供了一个异步操作，同时又能解决线程安全的问题。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">BackgroundWorker</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">类提供了二个方法和三个事件来实现异步操作的线程安全的问题。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">首先是<font><span style="line-height:1.5;font-size:12pt;">RunWorkerAsync</span></font></span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">方法，告诉系统现在要新开一个线程来执行一个异步操作。该方法会引发</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">DoWork</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">事件，在</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">DoWork</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">事件内，执行一个耗时的操作。此时，该事件中的代码是执行在另一个线程中。如果在该事件中，尝试操作主界面上的元素的时候，立马抛出一个线程安全的异常。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">那该如何操作主界面的元素呢？在</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">DoWork</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">事件中调用</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">ReportProgress</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">方法，引发</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">ProgressChanged</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">事件，并通过</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">userState</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">参数把参数传递过去。</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">Progresschanged</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">事件是和主界面在一个线程里。在该事件里，根据传递来的参数操作主界面上的元素就不会有线程安全的问题。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">在执行完</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">DoWork</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">事件中的代码后，会调用</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">RunWorkerCompleted</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">事件，通知主线程，异步操作已经完成。同样该事件也是和主界面在同一个线程里，也同样能操作主界面的元素而不会引发线程安全的异常。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">如果现在有一个任务是下载</span><span style="line-height:1.5;font-size:12pt;">200</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">个网页。该如何操作？一个接着一个下载，利用类可以解决界面假死和线程安全的问题。不过效率也太低了一点。如果利用多线程同时下载</span><span style="line-height:1.5;font-size:12pt;">200</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">个网页，那么可能超过系统的负担，造成效率的低下。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">“线程池”的概念应运而生。在线程池里准备好一定数量的线程，例如</span><span style="line-height:1.5;font-size:12pt;">50</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">个线程。以上面的例子，</span><span style="line-height:1.5;font-size:12pt;">200</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">个下载网页任务。由于只有</span><span style="line-height:1.5;font-size:12pt;">50</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">个线程。那么</span><span style="line-height:1.5;font-size:12pt;">50</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">个下载网页任务先执行，剩下的</span><span style="line-height:1.5;font-size:12pt;">150</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">个下载网页任务先暂时挂起。等到某一个线程执行完任务后，再执行挂起的任务。直到所有的任务都完成。“线程池”的好处是严格控制线程的数量，不给系统造成太大的负担。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">根据“线程池”的思想。自己编写了一个类。类的全部代码附在本文的最后。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">接下来，阐述一下该类的具体实现。类的名称为</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">clsWorkPool</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">首先，</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">clsWorkPool</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">类定义一个委托，该委托来完成“工作”。该类只负责“线程池”的实现与调度，不实现具体的工作。故用委托比较合适。委托的定义如下：</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-family:'宋体';"><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Public Delegate Function</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;WorkDelegate(</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">ByVal</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;Param&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As Object</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">)&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As Object</span></span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-family:'宋体';"></span>&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">类</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">clsWorkPool</span><span style="line-height:1.5;font-size:12pt;font-family:'宋体';">的构造函数代码如下</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-family:'宋体';"><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Public Sub New</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">(</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">ByVal</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;ThreadCount&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As Integer)</span></span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　_ThreadCount = ThreadCount</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">　　　　ReDim</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;_BgWorker(ThreadCount - 1)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Dim</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;I&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As Integer</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">For</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;I = 0&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">To</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;ThreadCount - 1</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　_BgWorker(I) =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">New</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;BackgroundWorker</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">AddHandler</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;_BgWorker(I).DoWork,&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">AddressOf</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;RunWorkerStart</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">AddHandler</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;_BgWorker(I).RunWorkerCompleted,&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">AddressOf</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;RunWorkerCompleted</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Next</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　_Work =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">New</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;Queue(</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Of</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;clsWork)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　_ID = 0</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"><span style="line-height:1.5;font-size:12pt;">　　　　</span>_HadComplete=0</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　_ThreadLock =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">New Object</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">End Sub</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">根据传递进来的参数</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">_ThreadCount</span><span style="line-height:1.5;font-size:12pt;">，来创立“线程池”——</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">BackgroundWorker</span><span style="line-height:1.5;font-size:12pt;">类的数组。该数组内的数量决定了线程池中线程的数量。</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">_Work</span><span style="line-height:1.5;font-size:12pt;">是一个队列对象，将暂时不能执行的任务，挂起到队列中，等到有空闲的线程的时候再执行。</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">_ThreadLock</span><span style="line-height:1.5;font-size:12pt;">是一个线程安全锁。防止多线程操作，修改参数，互相影响。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">类</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">clsWorkPool</span><span style="line-height:1.5;font-size:12pt;">的添加任务的代码</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Public Function</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;DoWork(</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">ByVal</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;Work&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;WorkDelegate,&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">ByVal</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;Param&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As Object</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">)&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As Integer</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">SyncLock</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;_ThreadLock</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Dim</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;I&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As Integer</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">, J&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As Boolean</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　_ID += 1</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　J =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">False</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Dim</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;tWork As&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">New</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;clsWork(Work, Param, _ID)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">For</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;I = 0&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">To</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;_ThreadCount - 1</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">If</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;_BgWorker(I).IsBusy =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">False</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Then</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　　　　　RaiseWorkStart(_BgWorker(I), tWork)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　　　　　J =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">True</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Exit For</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">End If</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Next</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">If</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;J =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">False</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Then</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　　　_Work.Enqueue(tWork)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">RaiseEvent</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;WorkSuspend(</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Me</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">,&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">New</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;WorkStartSuspendEventArgs(_ID))</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">End If</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　DoWork = _ID</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">End SyncLock</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">End Function</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">由于牵涉到多线程异步操作，故在代码的开始和结束添加线程锁。首先，根据传递进来的参数，生成一个包含任务各种参数的一个类</span><font><span style="line-height:1.5;font-size:12pt;">clsWork</span></font><span style="line-height:1.5;font-size:12pt;">。然后遍历线程池，看有没有空闲的线程。如果有空闲的线程，调用</span><font><span style="line-height:1.5;font-size:12pt;">RaiseWorkStart(_BgWorker(I), tWork)</span></font><span style="line-height:1.5;font-size:12pt;">方法，通过空闲的线程来完成任务。在</span><font><span style="line-height:1.5;font-size:12pt;">RaiseWorkStart(_BgWorker(I), tWork)方法中，有两句话，一是调用BackgroundWorker类的实例Work的RunWorkerAsync方法，启用辅助线程完成工作；一是引发WorkStart事件，通知主线程该工作已经启动。如果没有空闲的线程，则将该任务添加到队列_Work中，等待空闲的线程，并引发WorkSuspend事件，通知主线程该工作暂时挂起。</span></font></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">在调用Work的RunWorkerAsync方法之后，会引发Work的DoWork的事件，即下面的RunWorkerStart方法，通过调用clsWork类的Work委托的Invoke方法，来完成该任务，并将返回值写回。</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Private Sub</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;RunWorkerStart(</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">ByVal</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;sender&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As Object</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">,&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">ByVal</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;e&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;DoWorkEventArgs)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Dim</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;T&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;clsWork =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">CType</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">(e.Argument, clsWork)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　e.Result =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">New</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;clsResult(T.ID, T.Work.Invoke(T.Param))</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">End Sub</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">在执行完上面的函数，会引发Work的RunWorkerCompleted事件，即下面的RunWorkerCompleted方法。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Private Sub</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;RunWorkerCompleted(</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">ByVal</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;sender&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As Object</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">,&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">ByVal</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;e&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;RunWorkerCompletedEventArgs)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">SyncLock</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;_ThreadLock</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Dim</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;T&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;clsResult =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">CType</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">(e.Result, clsResult)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">RaiseEvent</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;WorkComplete(</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Me</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">,&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">New</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;WorkCompleteEventArgs(T.ID, T.Result))</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"><span style="line-height:1.5;font-size:12pt;">　　　　　　</span>_HadComplete += 1</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">If</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;_Work.Count &gt; 0&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Then</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Dim</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;tW&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">As</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;BackgroundWorker =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">CType</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">(sender, BackgroundWorker)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">If</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;tW.IsBusy =&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">False Then&nbsp;</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">RaiseWorkStart(tW, _Work.Dequeue)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Else</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">If</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;_HadComplete &gt;= _ID&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Then&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">RaiseEvent</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;AllWorkComplete(</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">Me</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">,&nbsp;</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">New</span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;EventArgs)</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">End If</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">End SyncLock</span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;"></span><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">　　</span><span style="line-height:1.5;font-size:12pt;color:rgb(0,0,255);font-family:Verdana;">End Sub</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">首先引发WorkComplete事件，告诉主线程，该任务已经完成。将完成的任务数加1。同时，检查挂起的任务数，若还有挂起的任务，则调用RaiseWorkStart方法，重新启动队列中的一个新的任务。若没有挂起的任务，则检查完成的任务数，任务数达到一定的数量，则说明所有的任务都完成了，则引发AllWorkComplete事件。告知主线程，所有的任务都已经完成。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">下面举一个例子，来展示该类的实际效果</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">在Form上，放一个ListBox和Button。代码如下</span></p> 
   <div style="font-size:12pt;font-family:Verdana;"> 
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;Form1
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">WithEvents</span>&nbsp;_Pool&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;clsWorkPool
    <br>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;Button1_Click(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;System.Object,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;e&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;System.EventArgs)&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Handles</span>&nbsp;Button1.Click
    <br> _Pool =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;clsWorkPool(5)
    <br>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;I&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>, J&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">For</span>&nbsp;I = 2008&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">To</span>&nbsp;2011
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">For</span>&nbsp;J = 1&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">To</span>&nbsp;12
    <br> _Pool.DoWork(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">AddressOf</span>&nbsp;GetWebString, I &amp;&nbsp;
    <span class="cf13" style="color:rgb(128,0,0);line-height:1.5;">"-"</span>&nbsp;&amp; J)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Next</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Next</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;GetWebString(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Url&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>)&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;_Web&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;Net.WebClient
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;_UrlParam()&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;=&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(Url,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">String</span>).Split(
    <span class="cf13" style="color:rgb(128,0,0);line-height:1.5;">"-"</span>)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;_Url&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;=&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">String</span>.Format(
    <span class="cf13" style="color:rgb(128,0,0);line-height:1.5;">"http://www.istartedsomething.com/bingimages/?m={0}&amp;y={1}"</span>, _UrlParam(0), _UrlParam(1))
    <br>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;str&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;IO.Stream
    <br>
    <br> str = _Web.OpenRead(_Url)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;read&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;IO.StreamReader(str, System.Text.Encoding.GetEncoding(
    <span class="cf13" style="color:rgb(128,0,0);line-height:1.5;">"GB2312"</span>))
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;Text&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;= read.ReadToEnd()
    <br>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;Url
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Function</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;AddListText(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Text&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">String</span>)
    <br> ListBox1.Items.Add(Text)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;_Pool_AllWorkComplete(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;E&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;System.EventArgs)&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Handles</span>&nbsp;_Pool.AllWorkComplete
    <br> AddListText(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">String</span>.Format(
    <span class="cf13" style="color:rgb(128,0,0);line-height:1.5;">"All Work Complete!!!"</span>))
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;_Pool_WorkComplete(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;E&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WorkCompleteEventArgs)&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Handles</span>&nbsp;_Pool.WorkComplete
    <br> AddListText(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">String</span>.Format(
    <span class="cf13" style="color:rgb(128,0,0);line-height:1.5;">"Work {0} is Complete,The result is {1}"</span>, E.ID, E.Result.ToString))
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;_Pool_WorkStart(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;E&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WorkStartSuspendEventArgs)&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Handles</span>&nbsp;_Pool.WorkStart
    <br> AddListText(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">String</span>.Format(
    <span class="cf13" style="color:rgb(128,0,0);line-height:1.5;">"Work {0} is Start"</span>, E.ID))
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;_Pool_WorkSuspend(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;E&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WorkStartSuspendEventArgs)&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Handles</span>&nbsp;_Pool.WorkSuspend
    <br> AddListText(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">String</span>.Format(
    <span class="cf13" style="color:rgb(128,0,0);line-height:1.5;">"Work {0} is Suspend"</span>, E.ID))
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span> 
   </div> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">&nbsp;</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">在按下Button1之后，先初始化线程池中5个线程。然后添加了48个下载网页任务，每个任务调用GetWebString函数，该函数符合Work的委托。由于只有5个线程，故有43个线程被挂起，直到有任务完成后，再执行挂起的任务。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">下面，贴二张截图</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;"><img height="384" alt="" src="https://images.cnblogs.com/cnblogs_com/grenet/G-1.JPG" width="484" style="border:0px;"></span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;"><img height="384" alt="" src="https://images.cnblogs.com/cnblogs_com/grenet/G-2.JPG" width="484" style="border:0px;"></span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">通过修改线程池的线程数，发现，在不同的线程数下，效果不完全一样。线程为1的时候，此时只有一个辅助线程，和单线程无异，完成48个任务一共耗时88.6秒。线程数为20的时候，效果比较好，完成48个任务一共耗时26.2秒。线程数为50的时候，此时，所有的任务都没有挂起，直接运行。完成这些任务，一共耗时44.1秒，反而不如20个线程的时候，可见，在下载的任务的时候时，线程数不宜过多。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;">还有一点说明的是，在例子中，48个任务执行的是同一种任务——调用的同一个函数。实际情况是可以调用不同任务——调用不同的函数，只要这些函数满足同一种委托。</span></p> 
   <p style="line-height:1.5;font-size:15px;text-indent:21pt;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;font-size:12pt;font-family:Verdana;">附：“线程池”的全部代码。代码格式修正于2012年1月6日</span></p> 
   <div style="font-size:12pt;font-family:Verdana;"> 
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Imports</span>&nbsp;System.ComponentModel
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;clsWorkPool
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Delegate</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;WorkDelegate(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Param&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>)&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;clsWork
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;Work&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WorkDelegate
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;Param&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;ID&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Work&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WorkDelegate,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Param&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;ID&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Work = Work
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Param = Param
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.ID = ID
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;clsResult
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;Result&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;ID&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;ID&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Result&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.ID = ID
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Result = Result
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;_ThreadCount&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;_BgWorker()&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;BackgroundWorker
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;_ID&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;_HadComplete&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;_Work&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;Queue(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;clsWork)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;_ThreadLock&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Event</span>&nbsp;WorkStart(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;E&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WorkStartSuspendEventArgs)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Event</span>&nbsp;WorkComplete(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;E&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WorkCompleteEventArgs)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Event</span>&nbsp;WorkSuspend(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;E&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WorkStartSuspendEventArgs)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Event</span>&nbsp;AllWorkComplete(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;E&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;EventArgs)
    <br>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>()
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.New(50)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;ThreadCount&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)
    <br> _ThreadCount = ThreadCount
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ReDim</span>&nbsp;_BgWorker(ThreadCount - 1)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;I&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">For</span>&nbsp;I = 0&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">To</span>&nbsp;ThreadCount - 1
    <br> _BgWorker(I) =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;BackgroundWorker
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">AddHandler</span>&nbsp;_BgWorker(I).DoWork,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">AddressOf</span>&nbsp;RunWorkerStart
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">AddHandler</span>&nbsp;_BgWorker(I).RunWorkerCompleted,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">AddressOf</span>&nbsp;RunWorkerCompleted
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Next</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　_Work =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;Queue(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;clsWork)
    <br> _ID = 0
    <br> _HadComplete = 0
    <br> _ThreadLock =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;DoWork(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Work&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;WorkDelegate,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Param&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>)&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">SyncLock</span>&nbsp;_ThreadLock
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;I&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>, J&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Boolean</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　_ID += 1
    <br> J =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">False</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tWork&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;clsWork(Work, Param, _ID)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">For</span>&nbsp;I = 0&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">To</span>&nbsp;_ThreadCount - 1
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_BgWorker(I).IsBusy =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">False</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Then</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　　　　　RaiseWorkStart(_BgWorker(I), tWork)
    <br> J =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">True</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Exit</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">For</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">If</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Next</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;J =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">False</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Then</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　　　_Work.Enqueue(tWork)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">RaiseEvent</span>&nbsp;WorkSuspend(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WorkStartSuspendEventArgs(_ID))
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">If</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　DoWork = _ID
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">SyncLock</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Function</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;RaiseWorkStart(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Worker&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;BackgroundWorker,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Work&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;clsWork)
    <br> Worker.RunWorkerAsync(Work)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">RaiseEvent</span>&nbsp;WorkStart(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WorkStartSuspendEventArgs(Work.ID))
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;RunWorkerStart(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;e&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;DoWorkEventArgs)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;T&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;clsWork =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(e.Argument, clsWork)
    <br> e.Result =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;clsResult(T.ID, T.Work.Invoke(T.Param))
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;RunWorkerCompleted(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;sender&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;e&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;RunWorkerCompletedEventArgs)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">SyncLock</span>&nbsp;_ThreadLock
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;T&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;clsResult =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(e.Result, clsResult)
    <br>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">RaiseEvent</span>&nbsp;WorkComplete(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;WorkCompleteEventArgs(T.ID, T.Result))
    <br> _HadComplete += 1
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Work.Count &gt; 0&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Then</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tW&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;BackgroundWorker =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">CType</span>(sender, BackgroundWorker)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;tW.IsBusy =&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">False Then</span>&nbsp;RaiseWorkStart(tW, _Work.Dequeue)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Else</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_HadComplete &gt;= _ID&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">RaiseEvent</span>&nbsp;AllWorkComplete(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;EventArgs)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">If</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">SyncLock</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;WorkStartSuspendEventArgs
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Inherits</span>&nbsp;EventArgs
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;ID&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;ID&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.ID = ID
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;WorkCompleteEventArgs
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Inherits</span>&nbsp;EventArgs
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;ID&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;Result&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"></span>　　
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">New</span>(
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;ID&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>,&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">ByVal</span>&nbsp;Result&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Object</span>)
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.ID = ID
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Result = Result
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>
    <br>
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;">Class</span> 
   </div> 
   <div style="font-size:12pt;font-family:Verdana;">
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"><br></span>
   </div> 
   <div> 
    <span class="cf2" style="line-height:1.5;"><font color="#0000ff">&nbsp; &nbsp; 本文转自万仓一黍博客园博客，原文链接：</font></span>
    <font color="#0000ff">http://www.cnblogs.com/grenet/archive/2011/12/21/2289014.html</font>
    <span style="color:rgb(0,0,255);font-family:Verdana;">，如需转载请自行联系原作者</span> 
   </div> 
   <div style="font-size:12pt;font-family:Verdana;">
    <span class="cf2" style="color:rgb(0,0,255);line-height:1.5;"><br></span>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
