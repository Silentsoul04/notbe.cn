<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>KVM 介绍（5）：libvirt 介绍 [ Libvrit for KVM/QEMU ] « NotBeCN</title>
  <meta name="description" content="             &nbsp;学习 KVM 的系列文章：&nbsp;        （1）介绍和安装     （2）CPU 和 内存虚拟化     （3）I/O QEMU 全虚拟化和准虚拟化（Para-virtulizaiton）     （4）I/O PCI/PCIe设备直接分配和 SR-IOV    ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/13/weixin_33695082_90131686.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">KVM 介绍（5）：libvirt 介绍 [ Libvrit for KVM/QEMU ]</h1>
    <p class="post-meta">Nov 13, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;学习 KVM 的系列文章：&nbsp;</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"><a href="http://www.cnblogs.com/sammyliu/p/4543110.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">（1）介绍和安装</a></li> 
    <li style="list-style-type:disc;"><a href="http://www.cnblogs.com/sammyliu/p/4543597.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">（2）CPU 和 内存虚拟化</a></li> 
    <li style="list-style-type:disc;"><a href="http://www.cnblogs.com/sammyliu/p/4543657.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">（3）I/O QEMU 全虚拟化和准虚拟化（Para-virtulizaiton）</a></li> 
    <li style="list-style-type:disc;"><a href="http://www.cnblogs.com/sammyliu/p/4548194.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">（4）I/O PCI/PCIe设备直接分配和 SR-IOV</a></li> 
    <li style="list-style-type:disc;"><a href="http://www.cnblogs.com/sammyliu/p/4558638.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">（5）libvirt 介绍</a></li> 
    <li style="list-style-type:disc;"><a href="http://www.cnblogs.com/sammyliu/p/4568188.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">（6）Nova 通过 libvirt 管理 QEMU/KVM 虚机</a></li> 
    <li style="list-style-type:disc;"><a href="http://www.cnblogs.com/sammyliu/p/4468757.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">（7）快照 （snapshot）</a></li> 
    <li style="list-style-type:disc;"><a href="http://www.cnblogs.com/sammyliu/p/4572287.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">（8）迁移 （migration）</a></li> 
   </ul>
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">1. Libvirt 是什么</h2> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">为什么需要Libvirt？</p> 
   <ol style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">
    <li style="list-style-type:decimal;">Hypervisor 比如 qemu-kvm 的命令行虚拟机管理工具参数众多，难于使用。</li> 
    <li style="list-style-type:decimal;">Hypervisor 种类众多，没有统一的编程接口来管理它们，这对云环境来说非常重要。</li> 
    <li style="list-style-type:decimal;">没有统一的方式来方便地定义虚拟机相关的各种可管理对象。</li> 
   </ol>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">Libvirt提供了什么？</p> 
   <ol style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">
    <li style="list-style-type:decimal;">它提供统一、稳定、开放的源代码的应用程序接口（API）、守护进程 （libvirtd）和和一个默认命令行管理工具（virsh）。</li> 
    <li style="list-style-type:decimal;">它提供了对虚拟化客户机和它的虚拟化设备、网络和存储的管理。</li> 
    <li style="list-style-type:decimal;">它提供了一套较为稳定的C语言应用程序接口。目前，在其他一些流行的编程语言中也提供了对libvirt的绑定，在Python、Perl、Java、Ruby、PHP、OCaml等高级编程语言中已经有libvirt的程序库可以直接使用。</li> 
    <li style="list-style-type:decimal;">它对多种不同的 Hypervisor 的支持是通过一种基于驱动程序的架构来实现的。libvirt 对不同的 Hypervisor 提供了不同的驱动，包括 Xen 的驱动，对QEMU/KVM 有 QEMU 驱动，VMware 驱动等。在 libvirt 源代码中，可以很容易找到 qemu_driver.c、xen_driver.c、xenapi_driver.c、vmware_driver.c、vbox_driver.c 这样的驱动程序源代码文件。</li> 
    <li style="list-style-type:decimal;">它作为中间适配层，让底层 Hypervisor 对上层用户空间的管理工具是可以做到完全透明的，因为 libvirt 屏蔽了底层各种 Hypervisor 的细节，为上层管理工具提供了一个统一的、较稳定的接口（API）。</li> 
    <li style="list-style-type:decimal;">它使用 XML 来定义各种虚拟机相关的受管理对象。</li> 
   </ol>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;&nbsp; &nbsp; 目前，libvirt 已经成为使用最为广泛的对各种虚拟机进行管理的工具和应用程序接口（API），而且一些常用的虚拟机管理工具（如virsh、virt-install、virt-manager等）和云计算框架平台（如OpenStack、OpenNebula、Eucalyptus等）都在底层使用libvirt的应用程序接口。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><img src="https://images0.cnblogs.com/blog2015/697113/201506/071624557079917.jpg" alt="" width="241" height="461" style="border:0px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img src="https://images0.cnblogs.com/blog2015/697113/201506/071645364104026.jpg" alt="" width="537" height="371" style="border:0px;">&nbsp;(SLE 11)</p> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.1 Libvirt C API</h3> 
   <div style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"> 
    <h4 style="font-size:14px;">1.1.1 Libvirti API 所管理的主要对象</h4> 
    <div>
     &nbsp;
    </div> 
    <div> 
     <table border="1" style="border:1px solid #C0C0C0;border-collapse:collapse;">
      <tbody>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">对象</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">解释</td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Domain （域）</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">指运行在由Hypervisor提供的虚拟机器上的一个操作系统实例（常常是指一个虚拟机）或者用来启动虚机的配置。</td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Hypervisor</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">一个虚拟化主机的软件层</td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Node （主机）</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">一台物理服务器。</td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Storage pool （存储池）</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">一组存储媒介的集合，比如物理硬盘驱动器。一个存储池被划分为小的容器称作卷。卷会被分给一个或者多个虚机。</td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Volume （卷）</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">一个从存储池分配的存储空间。一个卷会被分给一个或者多个域，常常成为域里的虚拟硬盘。</td> 
       </tr>
      </tbody>
     </table>
    </div> 
    <div>
     &nbsp;
    </div> 
    <h4 style="font-size:14px;">1.1.2 对象的管理模型</h4> 
    <div> 
     <table border="1" style="border:1px solid #C0C0C0;border-collapse:collapse;">
      <tbody>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">对象名称</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">对象</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Python 类</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">描述</td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Connect</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">与 Hypervisor的连接</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
         <div>
          <span style="line-height:1.5;color:rgb(1,1,1);font-family:'Times New Roman';font-size:small;"><strong>virConnectPtr</strong></span>
         </div> </td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">在调用任何 API 去管理一个本地或者远端的Hypervisor前，必须建立和这个Hypervisor的连接。</td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Domain</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Guest domain</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
         <div>
          <span style="line-height:1.5;color:rgb(1,1,1);font-family:'Times New Roman';font-size:small;"><strong>virDomainPtr</strong></span>
         </div> </td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">用于列举和管理已有的虚机，或者创建新的虚机。唯一标识：ID,Name，UUID。一个域可能是暂时性的或者持久性的。暂时性的域只能在它运行期间被管理。持久性的域在主机上保存了它的配置。</td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Virtual Network</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">虚拟网络</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
         <div>
          <span style="line-height:1.5;color:rgb(1,1,1);font-family:'Times New Roman';font-size:small;"><strong>virNetworkPtr</strong></span>
         </div> </td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">用于管理虚机的网络设备。唯一标识：Name，UUID。一个虚拟网络可能是暂时性的或者持久性的。每个主机上安装libvirt后，它都有一个默认的网络设备“default”。它向该主机上运行的虚机提供DHCP服务，以及通过NAT连接到主机上。</td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Storage Pool</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">存储池</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
         <div>
          <span style="line-height:1.5;color:rgb(1,1,1);font-family:'Times New Roman';font-size:small;"><strong>virStoragePoolPtr</strong></span>
         </div> </td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">用于管理虚拟机内的所有存储，包括 local disk, logical volume group, iSCSI target, FibreChannel HBA and local/network file system。唯一标识：Name，UUID。一个存储池可能是暂时性的或者持久性的。Pool 的 type 可以是&nbsp;&nbsp;<code>dir</code>,&nbsp;<code>fs</code>,&nbsp;<code>netfs</code>,&nbsp;<code>disk</code>,&nbsp;<code>iscsi</code>,&nbsp;<code>logical</code>,&nbsp;<code>scsi</code>,<code>mpath</code>,&nbsp;<code>rbd</code>,&nbsp;<code>sheepdog</code>,&nbsp;<code>gluster 或者</code>&nbsp;<code>zfs。</code> </td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Storage Volume&nbsp;&nbsp;</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">存储卷</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
         <div>
          <span style="line-height:1.5;color:rgb(1,1,1);font-family:'Times New Roman';font-size:small;"><strong>virStorageVolPtr</strong></span>
         </div> </td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">用于管理一个存储池内的存储块，包括一个池内分配的块、磁盘分区、逻辑卷、SCSI/iSCSI Lun，或者一个本地或者网络文件系统内的文件等。唯一标识：Name，Key，Path。</td> 
       </tr>
       <tr>
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Host device&nbsp;</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">主机设备</td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
         <div>
          <span style="line-height:1.5;color:rgb(1,1,1);font-family:'Times New Roman';font-size:small;"><strong>virNodeDevPtr</strong></span>
         </div> </td> 
        <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">用于管理主机上的物理硬件设备，包括&nbsp;the physical USB or PCI devices and logical devices these provide, such as a NIC, disk, disk 
         <div>
          <span style="line-height:1.5;color:rgb(1,1,1);font-family:'Times New Roman';font-size:small;">controller, sound card, etc。唯一标识：Name。</span>
         </div> </td> 
       </tr>
      </tbody>
     </table>
    </div> 
    <div>
     &nbsp;
    </div> 
    <h4 style="font-size:14px;">1.1.3 API 的简单分类</h4> 
    <p style="line-height:1.5;">Libvirt API 就是对各种对象的各种操作，包括基本的增、删、改、查操作和其它操作。</p> 
    <div> 
     <div> 
      <table border="1" style="border:1px solid #C0C0C0;border-collapse:collapse;">
       <tbody>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">对象</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">增</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">删</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">改</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">查</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">其它</td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Connect</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectOpen<br> virConnectOpenAuth<br> virConnectOpenReadOnly</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectClose</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectSetKeepAlive</td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Strorage pool</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStoragePoolBuild<br> virStoragePoolCreate<br> virStoragePoolCreateXML<br> virStoragePoolDefineXML</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStoragePoolDelete<br> virStoragePoolDestroy<br> virStoragePoolFree<br> virStoragePoolUndefine</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStoragePoolRefresh<br> virStoragePoolSetAutostart</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectFindStoragePoolSources<br> virConnectListAllStoragePools<br> virConnectListDefinedStoragePools<br> virConnectListStoragePools<br> virConnectNumOfDefinedStoragePools<br> virConnectNumOfStoragePools<br><br> virStoragePoolGetInfo/Name/UUID/UUIDString/XMLDesc<br> &nbsp;virStoragePoolIsActive/Persistent<br> virStoragePoolLookupByName/UUID/UUIDString/Volume<br> virStoragePoolRef</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStoragePoolGetAutostart<br> virStoragePoolGetConnect<br><br> virStoragePoolNumOfVolumes<br>
          <div>
           virStoragePoolListAllVolumes
          </div> 
          <div>
           virStoragePoolListVolumes
          </div> </td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Storage volume</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStorageVolCreateXML<br> virStorageVolCreateXMLFrom</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStorageVolDelete<br> virStorageVolFree</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStorageVolResize<br> virStorageVolUpload<br> virStorageVolWipe<br> virStorageVolWipePattern</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStorageVolGetConnect/Info/Key/Name/Path/XMLDesc<br> &nbsp;virStorageVolLookupByKey/Name/Path<br> virStorageVolRef</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStorageVolDownload</td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Network</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virNetworkCreate<br> virNetworkCreateXML<br> virNetworkDefineXML</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virNetworkDestroy<br> virNetworkFree<br> virNetworkUndefine</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virNetworkSetAutostart<br> virNetworkUpdate</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectListAllNetworks<br> virConnectListDefinedNetworks<br> virConnectListNetworks<br> virConnectNumOfDefinedNetworks<br> virConnectNumOfNetworks<br><br> virNetworkGetBridgeName/DHCPLeases/Name/UUID/UUIDString/XMLDesc<br> virNetworkIsActive/Persistent<br> &nbsp;virNetworkLookupByName/UUID/UUIDString<br> virNetworkGetAutostart<br>
          <div>
           virNetworkGetConnect
          </div> </td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectNetworkEventDeregisterAny<br> virConnectNetworkEventGenericCallback<br> virNetworkDHCPLeaseFree</td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Domain snapshot</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainSnapshotCreateXML</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainSnapshotDelete<br> virDomainSnapshotFree</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainRevertToSnapshot</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainHasCurrentSnapshot<br> virDomainListAllSnapshots<br> virDomainSnapshotCurrent<br> virDomainSnapshotGetConnect/Domain/Name/Parent/XMLDesc<br> virDomainSnapshotHasMetadata<br> virDomainSnapshotIsCurrent<br> virDomainSnapshotListAllChildren<br> virDomainSnapshotListChildrenNames<br> virDomainSnapshotListNames<br> virDomainSnapshotLookupByName<br> virDomainSnapshotNum<br> virDomainSnapshotNumChildren<br> virDomainSnapshotRef</td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Host</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <br><br></td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virInitialize<br> virNodeSetMemoryParameters<br> virNodeSuspendForDuration</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectBaselineCPU<br> virConnectCompareCPU<br> virConnectGetCPUModelNames/Capabilities/Hostname/LibVersion/MaxVcpus/Sysinfo/Type/URI/Version<br> virConnectIsAlive<br> virConnectIsEncrypted<br> virConnectIsSecure<br> virGetVersion<br> virNodeGetCPUMap/CPUStats&nbsp;/CellsFreeMemory/FreeMemory/Info/MemoryParameters/MemoryStats&nbsp;/<br> &nbsp;virNodeGetSecurityModel</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virTypedParamsAddBoolean<br> virTypedParamsAddDouble<br> virTypedParamsAddFromString<br> virTypedParamsAddInt<br> virTypedParamsAddLLong<br> virTypedParamsAddString<br> virTypedParamsAddUInt<br> virTypedParamsAddULLong<br> virTypedParamsClear<br> virTypedParamsFree<br> virTypedParamsGet<br><br><br></td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Interface</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virInterfaceCreate<br> virInterfaceDefineXML<br><br></td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virInterfaceDestroy<br> virInterfaceFree<br> virInterfaceUndefine</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virInterfaceChangeBegin<br> virInterfaceChangeCommit<br> virInterfaceChangeRollback<br><br></td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectListAllInterfaces<br> virConnectListDefinedInterfaces<br> virConnectListInterfaces<br> virConnectNumOfDefinedInterfaces<br> virConnectNumOfInterfaces<br> virInterfaceGetConnect<br> virInterfaceGetMACString<br> virInterfaceGetName<br> virInterfaceGetXMLDesc<br> virInterfaceIsActive<br> virInterfaceLookupByMACString<br> virInterfaceLookupByName<br> virInterfaceRef<br><br></td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Net Filter</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virNWFilterDefineXML<br><br></td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virNWFilterFree<br> virNWFilterUndefine</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectListAllNWFilters<br> virConnectListNWFilters<br> virConnectNumOfNWFilters<br> virNWFilterGetName<br> virNWFilterGetUUID<br> virNWFilterGetUUIDString<br> virNWFilterGetXMLDesc<br> virNWFilterLookupByName<br> virNWFilterLookupByUUID<br> virNWFilterLookupByUUIDString<br> virNWFilterRef</td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Domain Event</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectDomainEventDeregister<br> virConnectDomainEventDeregisterAny<br> virConnectDomainEventDeviceAddedCallback<br> virConnectDomainEventDeviceRemovedCallback</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectDomainEventAgentLifecycleCallback<br> virConnectDomainEventBalloonChangeCallback<br> virConnectDomainEventBlockJobCallback<br> virConnectDomainEventCallback<br> virConnectDomainEventDiskChangeCallback<br> virConnectDomainEventGenericCallback<br> virConnectDomainEventGraphicsCallback<br> virConnectDomainEventIOErrorCallback<br> virConnectDomainEventIOErrorReasonCallback<br> virConnectDomainEventPMSuspendCallback<br> virConnectDomainEventPMSuspendDiskCallback<br><br></td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Domain</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainCreate<br> virDomainCreateLinux<br> virDomainCreateWithFiles<br> virDomainCreateWithFlags<br> virDomainCreateXML<br> virDomainCreateXMLWithFiles<br> virDomainDefineXML<br> virDomainDefineXMLFlags<br><br></td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainDestroy<br> virDomainDestroyFlags<br><br> virDomainFree<br> virDomainUndefine<br> virDomainUndefineFlags<br> virDomainUpdateDeviceFlags</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainAbortJob<br> virDomainAddIOThread<br>
          <div>
           virDomainDelIOThread
          </div> virDomainAttachDevice<br> virDomainAttachDeviceFlags<br> virDomainDetachDevice<br> virDomainDetachDeviceFlags<br><br> virDomainBlockCommit<br> virDomainBlockCopy<br> virDomainBlockJobAbort<br> virDomainBlockJobSetSpeed<br> virDomainBlockPeek<br> virDomainBlockPull<br> virDomainBlockRebase<br> virDomainBlockResize<br><br> virDomainCoreDump<br> virDomainCoreDumpWithFormat<br><br> virDomainFSFreeze<br> virDomainFSInfoFree<br> virDomainFSThaw<br> virDomainFSTrim<br> virDomainInjectNMI<br><br> virDomainInterfaceFree<br><br> virDomainManagedSave<br> virDomainManagedSaveRemove<br><br> virDomainMigrate<br> virDomainMigrate2<br> virDomainMigrate3<br><br> virDomainMigrateSetCompressionCache<br> virDomainMigrateSetMaxDowntime<br> virDomainMigrateSetMaxSpeed<br> virDomainMigrateToURI<br> virDomainMigrateToURI2<br> virDomainMigrateToURI3<br><br> virDomainOpenChannel<br> virDomainOpenConsole<br> virDomainOpenGraphics<br> virDomainOpenGraphicsFD<br> virDomainPMSuspendForDuration<br><br> virDomainPMWakeup<br><br> virDomainReboot<br> virDomainReset<br> virDomainRestore<br> virDomainRestoreFlags<br> virDomainResume<br> virDomainSave<br> virDomainSaveFlags<br> virDomainSaveImageDefineXML<br> virDomainScreenshot<br> virDomainSendKey<br> virDomainSendProcessSignal<br>
          <div>
           virDomainShutdown
           <br> virDomainShutdownFlags
           <br> virDomainSuspend
          </div> virDomainSetAutostart<br> virDomainSetBlkioParameters<br> virDomainSetBlockIoTune<br> virDomainSetInterfaceParameters<br> virDomainSetMaxMemory<br> virDomainSetMemory<br> virDomainSetMemoryFlags<br> virDomainSetMemoryParameters<br> virDomainSetMemoryStatsPeriod<br> virDomainSetMetadata<br> virDomainSetNumaParameters<br> virDomainSetSchedulerParameters<br> virDomainSetSchedulerParametersFlags<br> virDomainSetTime<br> virDomainSetUserPassword<br> virDomainSetVcpus<br> virDomainSetVcpusFlags</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectGetAllDomainStats<br> virConnectGetDomainCapabilities<br> virConnectListAllDomains<br> virConnectListDefinedDomains<br> virConnectListDomains<br> virConnectNumOfDefinedDomains<br> virConnectNumOfDomains<br><br> virDomainBlockStats<br> virDomainBlockStatsFlags<br><br> virDomainGetAutostart<br> virDomainGetBlkioParameters<br> virDomainGetBlockInfo<br> virDomainGetBlockIoTune<br> virDomainGetBlockJobInfo<br> virDomainGetCPUStats<br> virDomainGetConnect<br> virDomainGetControlInfo<br> virDomainGetDiskErrors<br> virDomainGetEmulatorPinInfo<br><br> virDomainGetFSInfo<br> virDomainGetHostname<br> virDomainGetID<br> virDomainGetIOThreadInfo<br> virDomainGetInfo<br><br> virDomainGetInterfaceParameters<br> virDomainGetJobInfo<br> virDomainGetJobStats<br> virDomainGetMaxMemory<br> virDomainGetMaxVcpus<br> virDomainGetMemoryParameters<br> virDomainGetMetadata<br> virDomainGetName<br><br> virDomainGetNumaParameters<br> virDomainGetOSType<br> virDomainGetSchedulerParameters<br> virDomainGetSchedulerParametersFlags<br> virDomainGetSchedulerType<br><br> virDomainGetSecurityLabel<br> virDomainGetSecurityLabelList<br> virDomainGetState<br> virDomainGetTime<br> virDomainGetUUID<br> virDomainGetUUIDString<br> virDomainGetVcpuPinInfo<br> virDomainGetVcpus<br> virDomainGetVcpusFlags<br><br> virDomainGetXMLDesc<br> virDomainHasManagedSaveImage<br> virDomainIOThreadInfoFree<br><br> virDomainInterfaceAddresses<br> virDomainInterfaceStats<br><br> virDomainIsActive<br> virDomainIsPersistent<br> virDomainIsUpdated<br> virDomainListGetStats<br><br> virDomainLookupByID<br> virDomainLookupByName<br> virDomainLookupByUUID<br> virDomainLookupByUUIDString<br><br> virDomainMemoryPeek<br> virDomainMemoryStats<br><br> virDomainMigrateGetCompressionCache<br> virDomainMigrateGetMaxSpeed<br><br> virDomainPinEmulator ?<br> virDomainPinIOThread<br> virDomainPinVcpu<br> virDomainPinVcpuFlags<br><br> virDomainSaveImageGetXMLDesc<br> virDomainStatsRecordListFree</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectDomainXMLFromNative<br> virConnectDomainXMLToNative<br><br></td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Secret</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virSecretDefineXML</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virSecretFree<br> virSecretUndefine</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virSecretSetValue</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virConnectListAllSecrets<br> virConnectListSecrets<br> virConnectNumOfSecrets<br> virSecretGetConnect/UUID/UUIDString/UsageID/UsageType/Value/XMLDesc<br> virSecretLookupByUUID/UUIDString/Usage<br> virSecretRef<br><br></td> 
        </tr>
        <tr>
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Stream</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStreamNew</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStreamFree</td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStreamFinish<br>
          <div>
           virStreamAbort
          </div> 
          <div>
           virStreamRecv
          </div> 
          <div>
           virStreamRecvAll
          </div> 
          <div>
           virStreamSend
          </div> 
          <div>
           virStreamSendAll
          </div> </td> 
         <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virStreamSinkFunc<br> virStreamSourceFunc</td> 
        </tr>
       </tbody>
      </table>
     </div> 
     <div> 
      <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.2 Libvirt XML 定义</h3> 
      <p style="line-height:1.5;">Libvirt 使用 XML 来定义各种对象，其中，与 OpenStack Nova 关系比较密切的有：</p> 
      <div> 
       <table border="1" style="border:1px solid #C0C0C0;border-collapse:collapse;">
        <tbody>
         <tr>
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">disk （磁盘）</td> 
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">任何磁盘设备，包括软盘（floppy）、硬盘（hard disk）、光驱（cdrom）或者半虚拟化驱动都使用 &lt;disk&gt; 元素来定义。 方式：<pre>&lt;disk type='**' device='**'&gt;。其中：</pre> 
           <ul style="list-style:none;">
            <li style="list-style-type:disc;">”type“ 用来指定device source 的类型："file", "block", "dir", "network", 或者 "volume"。具体的 source &nbsp;由 &lt;source&gt; 标签定义。</li> 
            <li style="list-style-type:disc;">”device“ 用来指定 device target 的类型："floppy", "disk", "cdrom", and "lun", 默认为 "disk" 。具体的 target 由 &lt;target&gt; 标签定义。</li> 
           </ul><br> （1）”volume“ 类型的 disk<br>
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';">
            <pre>    &lt;disk type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">volume</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> device=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">disk</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
      &lt;driver name=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">qemu</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">raw</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;source pool=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">blk-pool0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> volume=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">blk-pool0-vol0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;target dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">hdk</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> bus=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">ide</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;/disk&gt;</pre>
           </div> （2）”file“ 类型的 disk<br>
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';">
            <pre>    &lt;disk type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">file</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> snapshot=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">external</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
      &lt;driver name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">tap</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">aio</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> cache=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">default</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>/&gt;
      &lt;source file=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">/var/lib/xen/images/fv0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> startupPolicy=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">optional</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> /&gt;
      &lt;target dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">hda</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> bus=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">ide</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;/disk&gt;</pre>
           </div> （3）”block“ 类型的 disk<br>
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';">
            <pre>   &lt;disk type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">block</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> device=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">cdrom</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
      &lt;driver name=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">qemu</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">raw</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;target dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">hdd</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> bus=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">ide</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> tray=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">open</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;<span style="color:rgb(0,0,255);line-height:1.5;">readonly</span>/&gt;
    &lt;/disk&gt;</pre>
           </div> （4）”network“ 类型的 disk<br>
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre> &lt;disk type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">network</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> device=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">cdrom</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
      &lt;driver name=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">qemu</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">raw</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;source protocol=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">http</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">url_path</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
        &lt;host name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">hostname</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> port=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">80</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>/&gt;
      &lt;/source&gt;
      &lt;target dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">hde</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> bus=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">ide</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> tray=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">open</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;<span style="color:rgb(0,0,255);line-height:1.5;">readonly</span>/&gt;
    &lt;/disk&gt;<span style="line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:10px;">&nbsp;</span></pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> </td> 
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
         </tr>
         <tr>
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Host device assignment （主机设备分配）<br><br></td> 
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre>   &lt;hostdev mode=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">subsystem</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">usb</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt; <span style="color:rgb(0,0,255);line-height:1.5;">#USB 设备直接分配</span>
      &lt;source startupPolicy=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">optional</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
        &lt;vendor id=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0x1234</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
        &lt;product id=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0xbeef</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;/source&gt;
      &lt;boot order=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">2</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;/hostdev&gt;
    &lt;hostdev mode=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">subsystem</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">pci</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> managed=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">yes</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt; <span style="color:rgb(0,0,255);line-height:1.5;">#PCI 设备直接分配</span>
      &lt;source&gt;
        &lt;address domain=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0x0000</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> bus=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0x06</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> slot=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0x02</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> function=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0x0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;/source&gt;
      &lt;boot order=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">1</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;rom bar=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">on</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> file=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">/etc/fake/boot.bin</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;/hostdev&gt;</pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> </td> 
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
         </tr>
         <tr>
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Network interface (网卡)</td> 
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <pre>有几种 interface 类型：</pre> <pre>（1）type = ‘network’ 定义一个连接 Virtual network 的 interface</pre> 
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre>&lt;devices&gt;
    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">network</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
      &lt;source network=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">default</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt; <span style="color:rgb(0,0,255);line-height:1.5;">#虚拟网络的名称为 ‘default’</span>
    &lt;/<span style="color:rgb(0,0,255);line-height:1.5;">interface</span>&gt;<span style="line-height:1.5;">
    ...
    </span>&lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">network</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
      &lt;source network=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">default</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> portgroup=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">engineering</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;target dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">vnet7</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;mac address=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">00:11:22:33:44:55</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>/&gt;
      &lt;virtualport&gt;
        &lt;parameters instanceid=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">09b11c53-8b5c-4eeb-8f00-d84eaa0aaa4f</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;/virtualport&gt;

    &lt;/<span style="color:rgb(0,0,255);line-height:1.5;">interface</span>&gt;
  &lt;/devices&gt;</pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> <pre><span style="line-height:1.5;">#virsh：attach-interface --domain d-2 --type network --source isolatednet1 --mac 52:53:00:4b:75:6f --config</span></pre> <pre><span style="line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">（2</span><span style="line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">）type=‘birdge’ 定义一个 </span>Bridge to LAN（桥接到物理网络）的interface：前提是主机上存在一个 bridge，该 bridge 已经连到物理LAN。</pre> 
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre>    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">bridge</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt; <span style="color:rgb(0,0,255);line-height:1.5;">#连接到 br0</span>
      &lt;source bridge=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">br0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;/<span style="color:rgb(0,0,255);line-height:1.5;">interface</span>&gt;
    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">bridge</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt; <span style="color:rgb(0,0,255);line-height:1.5;">#连接到br1</span>
      &lt;source bridge=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">br1</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;target dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">vnet7</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;mac address=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">00:11:22:33:44:55</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>/&gt;
    &lt;/<span style="color:rgb(0,0,255);line-height:1.5;">interface</span>&gt;
    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">bridge</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt; <span style="color:rgb(0,0,255);line-height:1.5;">#连接到 Open vSwithc bridge ovsbr</span>
      &lt;source bridge=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">ovsbr</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;virtualport type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">openvswitch</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
        &lt;parameters profileid=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">menial</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> interfaceid=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">09b11c53-8b5c-4eeb-8f00-d84eaa0aaa4f</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;/virtualport&gt;
    &lt;/<span style="color:rgb(0,0,255);line-height:1.5;">interface</span>&gt;</pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> <pre>#virsh：attach-interface --domain d-2 --type bridge --source virbr0 --mac 52:22:33:44:55:66 --config</pre> <pre>（3）type=‘ethernet’ 定义一个使用指定脚本连接到 LAN 的 interface</pre> 
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre>&lt;devices&gt;
    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">ethernet</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
      &lt;target dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">vnet7</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;script path=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">/etc/qemu-ifup-mynet</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;/<span style="color:rgb(0,0,255);line-height:1.5;">interface</span>&gt;
  &lt;/devices&gt;</pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> <pre><span style="line-height:1.5;">（4）type=‘direct’ 定义一个直接连到物理网卡（</span>Direct attachment to physical interface）的 interface：需要 Linux macvtap 驱动支持</pre> 
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';">
            <pre>    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">direct</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> trustGuestRxFilters=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">no</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
      &lt;source dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">eth0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> mode=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">vepa</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;/<span style="color:rgb(0,0,255);line-height:1.5;">interface</span>&gt;</pre>
           </div> <pre>（5）type=‘hostdev’ 定义一个由主机PCI 网卡直接分配（PCI Passthrough）的 interface： 分配主机上的网卡给虚机</pre> 
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre>&lt;devices&gt;
    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">hostdev</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> managed=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">yes</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
      &lt;driver name=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">vfio</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;source&gt;
        &lt;address type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">pci</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> domain=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0x0000</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> bus=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0x00</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> slot=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0x07</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> function=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0x0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;/source&gt;
      &lt;mac address=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">52:54:00:6d:90:02</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;virtualport type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">802.1Qbh</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
        &lt;parameters profileid=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">finance</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
      &lt;/virtualport&gt;
    &lt;/<span style="color:rgb(0,0,255);line-height:1.5;">interface</span>&gt;
  &lt;/devices&gt;</pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> </td> 
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
         </tr>
         <tr>
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">network （网络）</td> 
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <pre>&lt;bridge name="virbr0" stp="on" delay="5" macTableManager="libvirt"/&gt;
&lt;domain name="example.com" localOnly="no"/&gt;
&lt;forward mode="nat" dev="eth0"/&gt;
</pre> <p style="line-height:1.5;"><span style="line-height:1.5;font-family:Consolas, Monaco, 'Bitstream Vera Sans Mono', 'Courier New', courier, monospace;">1. bridge：定义一个用于构造该虚拟网络的网桥。</span>&nbsp;</p> <p style="line-height:1.5;"><span style="line-height:1.5;font-family:Consolas, Monaco, 'Bitstream Vera Sans Mono', 'Courier New', courier, monospace;">2. domain：定义 DHCP server 的 DNS domain。</span></p> <p style="line-height:1.5;"><span style="line-height:1.5;font-family:Consolas, Monaco, 'Bitstream Vera Sans Mono', 'Courier New', courier, monospace;">3. forward： 定义虚拟网络直接连到物理 LAN 的方式. ”mode“指转发模式。</span></p> <p style="line-height:1.5;">&nbsp;<span style="line-height:1.5;font-family:Consolas, Monaco, 'Bitstream Vera Sans Mono', 'Courier New', courier, monospace;">(1) mode=‘nat’：所有连接到该虚拟网络的虚拟的网络都会经过物理机器的网卡，并转换成物理网卡的地址。</span></p> 
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre>&lt;network&gt;
        &lt;name&gt;<span style="color:rgb(0,0,255);line-height:1.5;">default</span>&lt;/name&gt;
        &lt;bridge name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">virbr0</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
        &lt;forward mode=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">nat</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>/&gt;
        &lt;ip address=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">192.168.122.1</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> netmask=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">255.255.255.0</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
          &lt;dhcp&gt;
            &lt;range start=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">192.168.122.2</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> end=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">192.168.122.254</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
          &lt;/dhcp&gt;
        &lt;/ip&gt;
        &lt;ip family=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">ipv6</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> address=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">2001:db8:ca2:2::1</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> prefix=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">64</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
      &lt;/network&gt;</pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> <p style="line-height:1.5;"><span style="line-height:1.5;font-family:Consolas, Monaco, 'Bitstream Vera Sans Mono', 'Courier New', courier, monospace;">也可以指定公共的IP地址和端口号。</span></p> 
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';">
            <pre>&lt;forward mode=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">nat</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;&lt;nat&gt;&lt;address start=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">1.2.3.4</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> end=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">1.2.3.10</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt; &lt;/nat&gt; &lt;/forward&gt;
&lt;forward mode=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">nat</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;&lt;nat&gt;&lt;port start=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">500</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> end=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">1000</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;&lt;/nat&gt;&lt;/forward&gt;</pre>
           </div> (2) mode=‘route’：类似于 NAT，但是不使用NAT，而是使用routing table。<span style="line-height:1.5;font-size:small;">&nbsp;&nbsp;</span><br>
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre>      &lt;network&gt;
        &lt;name&gt;local&lt;/name&gt;
        &lt;bridge name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">virbr1</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
        &lt;forward mode=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">route</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> dev=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">eth1</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>/&gt;
        &lt;ip address=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">192.168.122.1</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> netmask=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">255.255.255.0</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>&gt;
          &lt;dhcp&gt;
            &lt;range start=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">192.168.122.2</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> end=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">192.168.122.254</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
          &lt;/dhcp&gt;
        &lt;/ip&gt;
        &lt;ip family=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">ipv6</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> address=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">2001:db8:ca2:2::1</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> prefix=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">64</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> /&gt;
      &lt;/network&gt;</pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> (3) mode=‘bridge’：使用不受libvirt管理的bridge，比如主机上已有的bridge；open vswitch bridge；使用&nbsp;macvtap's "bridge"&nbsp;<span style="line-height:1.5;font-family:Consolas, Monaco, 'Bitstream Vera Sans Mono', 'Courier New', courier, monospace;">&nbsp;模式</span><br>
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';">
            <pre>      &lt;network&gt;
        &lt;name&gt;host-bridge&lt;/name&gt;
        &lt;forward mode=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">bridge</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>/&gt;
        &lt;bridge name=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">br0</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>/&gt;
      &lt;/network&gt;</pre>
           </div> (4) mode=‘passthrough’：使用<span style="line-height:1.5;font-family:Consolas, Monaco, 'Bitstream Vera Sans Mono', 'Courier New', courier, monospace;">&nbsp;</span>a macvtap "direct" connection in "passthrough" mode 指定主机上的特定网卡用于虚拟网络&nbsp;&nbsp;&nbsp;<br>
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre> &lt;forward mode=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">passthrough</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">eth10</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">eth11</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">eth12</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">eth13</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;<span style="color:rgb(0,0,255);line-height:1.5;">interface</span> dev=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">eth14</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
  &lt;/forward&gt;</pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> <span style="line-height:1.5;font-family:Consolas, Monaco, 'Bitstream Vera Sans Mono', 'Courier New', courier, monospace;"><span style="line-height:1.5;font-size:small;">(5) mode=‘hostdev’：直接分配主机上的网络设备。</span></span> 
           <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';"> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
            <pre>&lt;forward mode=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">hostdev</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> managed=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">yes</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>&gt;
    &lt;driver name=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">vfio</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;address type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">pci</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> domain=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> bus=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">4</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> slot=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> function=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">1</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;address type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">pci</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> domain=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> bus=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">4</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> slot=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> function=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">2</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
    &lt;address type=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">pci</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> domain=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> bus=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">4</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> slot=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">0</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span> function=<span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">3</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>/&gt;
  &lt;/forward&gt;</pre> 
            <div class="cnblogs_code_toolbar">
             <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
            </div> 
           </div> </td> 
          <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
         </tr>
        </tbody>
       </table>
      </div> 
     </div> 
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">详细的 XML 定义说明在&nbsp;<a href="https://libvirt.org/format.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">https://libvirt.org/format.html</a>。</p> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.3 Libvirt API 的实现</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">libvirt API 的实现是在各个 Hypervisor driver 和 Storage dirver 内。Hypervisor 驱动包括：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"> <strong><a href="https://libvirt.org/drvlxc.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">LXC</a></strong>&nbsp;- Linux Containers</li> 
    <li style="list-style-type:disc;"><strong><a href="https://libvirt.org/drvopenvz.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">OpenVZ</a></strong></li> 
    <li style="list-style-type:disc;"><strong><a href="https://libvirt.org/drvqemu.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">QEMU</a></strong></li> 
    <li style="list-style-type:disc;"> <strong><a href="https://libvirt.org/drvtest.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Test</a></strong>&nbsp;- Used for testing</li> 
    <li style="list-style-type:disc;"> <strong><a href="https://libvirt.org/drvuml.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">UML</a></strong>&nbsp;- User Mode Linux</li> 
    <li style="list-style-type:disc;"><strong><a href="https://libvirt.org/drvvbox.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">VirtualBox</a></strong></li> 
    <li style="list-style-type:disc;"><strong><a href="https://libvirt.org/drvesx.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">VMware ESX</a></strong></li> 
    <li style="list-style-type:disc;"><strong><a href="https://libvirt.org/drvvmware.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">VMware Workstation/Player</a></strong></li> 
    <li style="list-style-type:disc;"><strong><a href="https://libvirt.org/drvxen.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Xen</a></strong></li> 
    <li style="list-style-type:disc;"><strong><a href="https://libvirt.org/drvhyperv.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Microsoft Hyper-V</a></strong></li> 
    <li style="list-style-type:disc;"><strong><a href="https://libvirt.org/drvphyp.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">IBM PowerVM (phyp)</a></strong></li> 
    <li style="list-style-type:disc;"><strong><a href="https://libvirt.org/drvparallels.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Parallels</a></strong></li> 
    <li style="list-style-type:disc;"> <strong><a href="https://libvirt.org/drvbhyve.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Bhyve</a></strong>&nbsp;- The BSD Hypervisor</li> 
   </ul>
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.4 Libvirt 的 Python 绑定</h3> 
   <div style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"> 
    <div>
     python-libvirt 包含 Libvirt 的 Python 语言绑定。安装 libvirt 时，默认会安装 python-libvirt 。&nbsp;来源：&nbsp;
     <a href="https://libvirt.org/python.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">https://libvirt.org/python.html</a>&nbsp;&nbsp;
     <a href="https://pypi.python.org/pypi/libvirt-python" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">https://pypi.python.org/pypi/libvirt-python</a>&nbsp;
    </div> 
    <div>
     &nbsp;
    </div> 
    <div>
     Python API 和 C API 之间几乎是一对一的映射关系，比如：
    </div> 
    <div> 
     <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
      <div class="cnblogs_code_toolbar">
       <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
      </div> 
      <pre><span style="line-height:1.5;">#C API
</span><span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;"> virConnectNumOfDomains (virConnectPtr conn);
</span><span style="color:rgb(0,0,255);line-height:1.5;">int</span> virDomainSetMaxMemory (virDomainPtr domain, unsigned <span style="color:rgb(0,0,255);line-height:1.5;">long</span> memory);<br><br>
#Python API<br><code>virConnect::numOfDomains(self)<br></code><code>virDomain::setMaxMemory(self, memory)</code></pre> 
      <div class="cnblogs_code_toolbar">
       <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
      </div> 
     </div> 
     <p style="line-height:1.5;">&nbsp;因此，libvirt 官网并没有提供详细的 python API 描述。</p> 
    </div> 
   </div> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">2. QEMU/KVM libvirt 驱动</h2> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">2.1 架构</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><img src="https://images0.cnblogs.com/blog2015/697113/201506/071728434418679.jpg" alt="" style="border:0px;">&nbsp;</p> 
   <div class="O1" style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">
    •Libvirtd 是一个 daemon 进程，可以被本地的virsh调用，也可以被远程的virsh调用
   </div> 
   <div class="O1" style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">
    •Libvirtd 调用 qemu-kvm 操作KVM 虚拟机
   </div> 
   <div class="O1" style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">
    &nbsp;
   </div> 
   <div class="O1" style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"> 
    <a href="http://wiki.libvirt.org/page/QEMUSwitchToLibvirt" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">这里</a>有一个 virsh 命令、Libvirt C API、 QEMU driver 方法 和 QEMU Monitor 命令的对照表（部分）：
   </div> 
   <div class="O1" style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"> 
    <table style="border:1px solid #C0C0C0;border-collapse:collapse;">
     <tbody>
      <tr>
       <th style="border:1px solid #C0C0C0;border-collapse:collapse;">virsh command</th> 
       <th style="border:1px solid #C0C0C0;border-collapse:collapse;">Public API</th> 
       <th style="border:1px solid #C0C0C0;border-collapse:collapse;">QEMU driver function</th> 
       <th style="border:1px solid #C0C0C0;border-collapse:collapse;">Monitor command</th> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh create XMLFILE</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainCreateXML()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainCreate()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">info cpus, cont, change vnc password, balloon (all indirectly)</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh suspend GUEST</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainSuspend()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainSuspend()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">stop</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh resume GUEST</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainResume()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainResume()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">cont</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh shutdown GUEST</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainShutdown()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainShutdown()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">system_powerdown</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh setmem GUEST MEM-KB</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainSetMemory()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainSetMemory()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">balloon (indirectly)</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh dominfo GUEST</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainGetInfo()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainGetInfo()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">info balloon (indirectly)</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh save GUEST FILENAME</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainSave()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainSave()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">stop, migrate exec</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh restore FILENAME</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainRestore()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainRestore()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">cont</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh dumpxml GUEST</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainDumpXML()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainDumpXML()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">info balloon (indirectly)</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh attach-device GUEST XMLFILE</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainAttachDevice()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainAttachDevice()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">change, eject, usb_add, pci_add (all indirectly)</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh detach-device GUEST XMLFILE</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainDetachDevice()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainDetachDevice()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">pci_del (indirectly)</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh migrate GUEST DEST-URI</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainMigrate()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainMigratePerform()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">stop, migrate_set_speed, migrate, cont</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virsh domblkstat GUEST</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainBlockStats()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainBlockStats()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">info blockstats</td> 
      </tr>
      <tr>
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">-</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">virDomainBlockPeek()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">qemudDomainMemoryPeek()</td> 
       <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">memsave</td> 
      </tr>
     </tbody>
    </table>
   </div> 
   <div class="O1" style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">
    &nbsp;
   </div> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">2.2 安装</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">有三种方式来安装 libvirt：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（1）下载 libvirt 的源代码，然后编译和安装</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（2）从各 Linux 的发行版中直接安装，比如 Ubuntu 上运行 apt-get install libvirt-bin</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（3）从 git 上克隆 libvirt 的代码，然后编译和安装</p> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">2.3 libvirt log</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><a href="https://libvirt.org/logging.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">这篇文章</a>&nbsp;描述了 livbirt log。设置所有日志的方法是在 /etc/libvirt/libvirtd.conf&nbsp;中添加下面的配置然后重启 libvirt：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre>log_filters=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">1:libvirt 1:util 1:qemu</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">
log_outputs</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">1:file:/var/log/libvirt/libvirtd.log</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span></pre>
   </div> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">3 使用 libvirt 编程来管理 KVM 虚机的实例</h2> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;这里只描述基本的过程。具体的过程，下一篇文章会具体分析 Nova 中 libvirt 的使用。</p> 
   <ol style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">
    <li style="list-style-type:decimal;">定义虚机的基本配置，包括 vCPU、内存、磁盘或者cdrom以及启动顺序，生成 xml 配置，调用&nbsp;virDomainCreateXML API 启动一个虚机</li> 
    <li style="list-style-type:decimal;">使用 Domain 相关的 API 来管理虚机的生命周期。我的<a href="http://www.cnblogs.com/sammyliu/p/4486712.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">这篇文章</a>有虚机生命周期的详细介绍。</li> 
    <li style="list-style-type:decimal;">添加磁盘：定义一个 disk 的 xml 配置，使用&nbsp;virDomainAttachDevice API 将它挂载到虚机上。如果不是本地的源磁盘，需要提前准备好。</li> 
    <li style="list-style-type:decimal;">添加interface：使用 Network API 定义一个虚拟网络（需要提前准备好物理网络），然后定义一个 interface 的 XML 配置，使用&nbsp;virDomainAttachDevice API 将它加到虚机。</li> 
    <li style="list-style-type:decimal;"><span style="line-height:1.5;">按照需要，重复2、3、4步骤。&nbsp;</span></li> 
   </ol>
   <div style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">
    &nbsp;
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><br></p> 
   <p style="line-height:1.5;"><font color="#4b4b4b"><span style="font-size:15px;">&nbsp; &nbsp; 本文转自SammyLiu博客园博客，原文链接：http://www.cnblogs.com/sammyliu/p/4558638.html</span></font><span style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span></p> 
   <div>
    <br>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
