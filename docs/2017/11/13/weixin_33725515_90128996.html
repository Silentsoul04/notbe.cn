<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>反射之动态创建对象 « NotBeCN</title>
  <meta name="description" content="             前言    C#有关反射的话题已经是个老生常谈的话题，也许园友一看这标题都不屑去看了，但是既然拿出来讲必有讲之道理，当然，不喜勿喷，高手请绕道！直入话题。    讨论    &nbsp;定义一个Person类代码如下                        1    public ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/13/weixin_33725515_90128996.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">反射之动态创建对象</h1>
    <p class="post-meta">Nov 13, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <h1 style="font-size:28px;line-height:1.5;font-family:'Helvetica Neue', Arial;">前言</h1> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">C#有关反射的话题已经是个老生常谈的话题，也许园友一看这标题都不屑去看了，但是既然拿出来讲必有讲之道理，当然，不喜勿喷，高手请绕道！直入话题。</p> 
   <h1 style="font-size:28px;line-height:1.5;font-family:'Helvetica Neue', Arial;">讨论</h1> 
   <h2 style="color:rgb(255,255,255);line-height:1.5;font-size:21px;font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);">&nbsp;定义一个Person类代码如下</h2> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span>    <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> Person
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 3</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;summary&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span><span style="color:rgb(0,128,0);line-height:1.5;"> 年龄
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;/summary&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">int</span> Age { <span style="color:rgb(0,0,255);line-height:1.5;">get</span>; <span style="color:rgb(0,0,255);line-height:1.5;">set</span><span style="line-height:1.5;">; }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 8</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 9</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;summary&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;">10</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span><span style="color:rgb(0,128,0);line-height:1.5;"> 姓名
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;/summary&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;">12</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">string</span> Name { <span style="color:rgb(0,0,255);line-height:1.5;">get</span>; <span style="color:rgb(0,0,255);line-height:1.5;">set</span><span style="line-height:1.5;">; }
</span><span style="color:rgb(0,128,128);line-height:1.5;">13</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">14</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;summary&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;">15</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span><span style="color:rgb(0,128,0);line-height:1.5;"> 性别
</span><span style="color:rgb(0,128,128);line-height:1.5;">16</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;/summary&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;">17</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">bool</span> Gender { <span style="color:rgb(0,0,255);line-height:1.5;">get</span>; <span style="color:rgb(0,0,255);line-height:1.5;">set</span><span style="line-height:1.5;">; }
</span><span style="color:rgb(0,128,128);line-height:1.5;">18</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">19</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">20</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;summary&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;">21</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span><span style="color:rgb(0,128,0);line-height:1.5;"> 求两个数的和
</span><span style="color:rgb(0,128,128);line-height:1.5;">22</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;/summary&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;">23</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;param name="num1"&gt;&lt;/param&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;">24</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;param name="num2"&gt;&lt;/param&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;">25</span>         <span style="color:rgb(128,128,128);line-height:1.5;">///</span> <span style="color:rgb(128,128,128);line-height:1.5;">&lt;returns&gt;&lt;/returns&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5;">26</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">int</span> Add(<span style="color:rgb(0,0,255);line-height:1.5;">int</span> num1,<span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;"> num2)
</span><span style="color:rgb(0,128,128);line-height:1.5;">27</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">28</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span> num1 +<span style="line-height:1.5;"> num2;
</span><span style="color:rgb(0,128,128);line-height:1.5;">29</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">30</span>     }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">那么现在怎么动态获取该对象并打印该对象？啊，用反射动态获取呗，ok,实现如下！</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">1</span>             Type person = <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span><span style="line-height:1.5;">(Person);
</span><span style="color:rgb(0,128,128);line-height:1.5;">2</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">3</span>             Person t = (Person)Activator.CreateInstance(person) <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> Person;
</span><span style="color:rgb(0,128,128);line-height:1.5;">4</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">5</span>             Console.WriteLine(t.ToString());</pre>
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">完全没错，在黑框框中运行输出入下：</p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;"><img src="https://images0.cnblogs.com/blog2015/589642/201507/271613575311000.png" alt="" style="border:0px;"></p> 
   <h2 style="color:rgb(255,255,255);line-height:1.5;font-size:21px;font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);">接下来小小改动一下，在Person类中添加一个构造函数</h2> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">1</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> Person(<span style="color:rgb(0,0,255);line-height:1.5;">string</span> age, <span style="color:rgb(0,0,255);line-height:1.5;">string</span> name, <span style="color:rgb(0,0,255);line-height:1.5;">bool</span><span style="line-height:1.5;"> gender)
</span><span style="color:rgb(0,128,128);line-height:1.5;">2</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">3</span>             <span style="color:rgb(0,0,255);line-height:1.5;">this</span>.Age =<span style="line-height:1.5;"> age;
</span><span style="color:rgb(0,128,128);line-height:1.5;">4</span>             <span style="color:rgb(0,0,255);line-height:1.5;">this</span>.Name =<span style="line-height:1.5;"> name;
</span><span style="color:rgb(0,128,128);line-height:1.5;">5</span>             <span style="color:rgb(0,0,255);line-height:1.5;">this</span>.Gender =<span style="line-height:1.5;"> gender;
</span><span style="color:rgb(0,128,128);line-height:1.5;">6</span>         }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">此时我们再来运行看看！！什么鬼，怎么出现错误了？？？</p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;"><img src="https://images0.cnblogs.com/blog2015/589642/201507/271616539855626.png" alt="" style="border:0px;"></p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">吓我一跳，平常来个未将对象设置到对象的实例那是见怪不怪了，出现这个容我想想，无参构造函数似乎暗示着什么，突然醒悟对象不都默认有个无参的构造函数吗，啊，shit，原来是因为我定义了一个有参数的构造函数，用Activator.CreateInstance动态创建对象调用的无参构造函数啊，紧接着我将鼠标放在该方法跟前，都告诉我了写着&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">使用指定类型的默认构造函数来创建该类型的实例</span>&nbsp;，知道错误所在了，关键是怎么去解决，要是类中写了有参数的构造函数，现在想要反射来动态创建对象岂不是不能够了吗？继续想，记得在javascript中虽然不能够像C#实现重载，当然js也不存在重载，但是可以根据<strong style="font-size:16px;line-height:normal;">arguments.length</strong>来近似于实现所谓的重载，这里同样可不可以根据构造函数的个数来实现呢？有了这个想法就开干，当看到这个<strong style="font-size:16px;line-height:normal;">GetConstructors</strong>方法心底就舒坦起来了，经过反复查看其方法改造控制台后的代码如下：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">1</span>             <span style="color:rgb(0,0,255);line-height:1.5;">var</span> length = <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">2</span>             Person p = <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">3</span>             Type person = <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span><span style="line-height:1.5;">(Person);
</span><span style="color:rgb(0,128,128);line-height:1.5;">4</span>             <span style="color:rgb(0,0,255);line-height:1.5;">var</span> gc =<span style="line-height:1.5;"> person.GetConstructors();
</span><span style="color:rgb(0,128,128);line-height:1.5;">5</span>             <span style="color:rgb(0,0,255);line-height:1.5;">foreach</span> (<span style="color:rgb(0,0,255);line-height:1.5;">var</span> c <span style="color:rgb(0,0,255);line-height:1.5;">in</span><span style="line-height:1.5;"> gc)
</span><span style="color:rgb(0,128,128);line-height:1.5;">6</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">7</span>                 length =<span style="line-height:1.5;"> c.GetParameters().Length;
</span><span style="color:rgb(0,128,128);line-height:1.5;">8</span>             }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">&nbsp;现在获取到了构造函数的长度即可以根据参数的个数来进行创建对象，离解决问题更进一步了，这时我想到如果我参数个数相同，怎么知道我是调用哪个构造函数呢？对，根据参数的类型，所以现在问题上升到怎么确定我要传递参数的类型呢？看看构造函数的属性&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">&nbsp;ConstructorInfo</span>&nbsp;中有没有什么方法可以定义参数类型，皇天不负有心人&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">GetConstructor</span>&nbsp;方法参数中 有个<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">Type</span>&nbsp;这就是参数的类型了，然后利用&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">Invoke</span>&nbsp;委托对构造函数传入参数获取对象，如下：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span>             ConstructorInfo Constructor = <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>             <span style="color:rgb(0,0,255);line-height:1.5;">switch</span><span style="line-height:1.5;"> (length)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">case</span> <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>                     Constructor = person.GetConstructor(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> Type[<span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">]);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>                     p = Constructor.Invoke(<span style="color:rgb(0,0,255);line-height:1.5;">null</span>) <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> Person;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">break</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">case</span> <span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>                     Constructor = person.GetConstructor(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> Type[<span style="color:rgb(128,0,128);line-height:1.5;">1</span>] { <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">) });
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span>                     p = Constructor.Invoke(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span>[<span style="color:rgb(128,0,128);line-height:1.5;">1</span>] { <span style="color:rgb(128,0,128);line-height:1.5;">1</span> }) <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> Person;
</span><span style="color:rgb(0,128,128);line-height:1.5;">12</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">break</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">13</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">case</span> <span style="color:rgb(128,0,128);line-height:1.5;">2</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">14</span>                     Constructor = person.GetConstructor(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> Type[<span style="color:rgb(128,0,128);line-height:1.5;">2</span>] { <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">int</span>), <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">) });
</span><span style="color:rgb(0,128,128);line-height:1.5;">15</span>                     p = Constructor.Invoke(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span>[<span style="color:rgb(128,0,128);line-height:1.5;">2</span>] { <span style="color:rgb(128,0,128);line-height:1.5;">1</span>, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">嘿嘿</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span> }) <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> Person;
</span><span style="color:rgb(0,128,128);line-height:1.5;">16</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">break</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">17</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">case</span> <span style="color:rgb(128,0,128);line-height:1.5;">3</span><span style="line-height:1.5;">:     
</span><span style="color:rgb(0,128,128);line-height:1.5;">18</span>                     Constructor = person.GetConstructor(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> Type[<span style="color:rgb(128,0,128);line-height:1.5;">3</span>] { <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">int</span>), <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">string</span>), <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">bool</span><span style="line-height:1.5;">) });
</span><span style="color:rgb(0,128,128);line-height:1.5;">19</span>                     p = Constructor.Invoke(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span>[<span style="color:rgb(128,0,128);line-height:1.5;">3</span>] { <span style="color:rgb(128,0,128);line-height:1.5;">1</span>, <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">嘿嘿</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, <span style="color:rgb(0,0,255);line-height:1.5;">false</span> }) <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> Person;
</span><span style="color:rgb(0,128,128);line-height:1.5;">20</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">break</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">21</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">default</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">22</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">break</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">23</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">24</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">25</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">Person t = (Person)Activator.CreateInstance(person) as Person;</span>
<span style="color:rgb(0,128,128);line-height:1.5;">26</span>             Console.WriteLine(p.ToString());</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">&nbsp;</p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">&nbsp;同样得到上述结果打印出：反射之动态创建对象.Person，ok，终于解决了，完美！</p> 
   <h1 style="font-size:28px;line-height:1.5;font-family:'Helvetica Neue', Arial;">拓展</h1> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">在上述过程中用到委托Invoke再传入参数到其中，鉴于此对于反射，参考代码改善建议利用dynamic关键字简化反射实现。下面用例子说明，利用反射计算Person类中方法计算两个数的和。利用反射立马能够写出</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">1</span>     Person dy = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> Person();
</span><span style="color:rgb(0,128,128);line-height:1.5;">2</span>     <span style="color:rgb(0,0,255);line-height:1.5;">var</span> p= <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(Person).GetMethod(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Add</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">3</span>     Convert.ToInt32(p.Invoke(dy, <span style="color:rgb(0,0,255);line-height:1.5;">new</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span>[] { <span style="color:rgb(128,0,128);line-height:1.5;">30</span>, <span style="color:rgb(128,0,128);line-height:1.5;">40</span> });)</pre>
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">如果利用&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">dynamic</span>&nbsp;关键字能够更加精简而且更加优美&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">1</span>      dynamic dy = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> Person(); 
</span><span style="color:rgb(0,128,128);line-height:1.5;">2</span>      dy.Add(<span style="color:rgb(128,0,128);line-height:1.5;">30</span>, <span style="color:rgb(128,0,128);line-height:1.5;">40</span>); </pre>
   </div> 
   <h1 style="font-size:28px;line-height:1.5;font-family:'Helvetica Neue', Arial;">总结&nbsp;</h1> 
   <h2 style="color:rgb(255,255,255);line-height:1.5;font-size:21px;font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);">　　（1）利用反射动态创建对象两种方法</h2> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">　　　　【1】利用Activator.CreateInstance，前提是调用对象的默认无参构造函数</p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">　　　　【2】利用构造器来动态创建对象</p> 
   <h2 style="color:rgb(255,255,255);line-height:1.5;font-size:21px;font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);">　　（2）利用dynamic关键字来简化反射实现</h2> 
   <h1 style="font-size:28px;line-height:1.5;font-family:'Helvetica Neue', Arial;">补充1</h1> 
   <h2 style="color:rgb(255,255,255);line-height:1.5;font-size:21px;font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(111,168,51);">&nbsp;用构造器将其进行封装为如下，其中用时需要手动添加参数类型以及参数默认值</h2> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span>       <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> T GetEntity&lt;T&gt;() <span style="color:rgb(0,0,255);line-height:1.5;">where</span> T : <span style="color:rgb(0,0,255);line-height:1.5;">class</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 2</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>             T entity = <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>             <span style="color:rgb(0,0,255);line-height:1.5;">var</span> length = <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>             Type t = <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span><span style="line-height:1.5;">(T);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>             <span style="color:rgb(0,0,255);line-height:1.5;">var</span> gc =<span style="line-height:1.5;"> t.GetConstructors();
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>             <span style="color:rgb(0,0,255);line-height:1.5;">foreach</span> (<span style="color:rgb(0,0,255);line-height:1.5;">var</span> c <span style="color:rgb(0,0,255);line-height:1.5;">in</span><span style="line-height:1.5;"> gc)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>                 length =<span style="line-height:1.5;"> c.GetParameters().Length;
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">12</span>             ConstructorInfo Constructor = <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">13</span>            
<span style="color:rgb(0,128,128);line-height:1.5;">14</span>             <span style="color:rgb(0,0,255);line-height:1.5;">switch</span><span style="line-height:1.5;"> (length)
</span><span style="color:rgb(0,128,128);line-height:1.5;">15</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">16</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">case</span> <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">17</span>                     Constructor = t.GetConstructor(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> Type[<span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">]);
</span><span style="color:rgb(0,128,128);line-height:1.5;">18</span>                     entity = Constructor.Invoke(<span style="color:rgb(0,0,255);line-height:1.5;">null</span>) <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> T;
</span><span style="color:rgb(0,128,128);line-height:1.5;">19</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">break</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">20</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">case</span> <span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">21</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">22</span>                     Constructor = t.GetConstructor(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> Type[<span style="color:rgb(128,0,128);line-height:1.5;">1</span>] { <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">int</span><span style="line-height:1.5;">) });
</span><span style="color:rgb(0,128,128);line-height:1.5;">23</span>                     entity = Constructor.Invoke(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span>[<span style="color:rgb(128,0,128);line-height:1.5;">1</span>] { <span style="color:rgb(128,0,128);line-height:1.5;">0</span> }) <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> T;
</span><span style="color:rgb(0,128,128);line-height:1.5;">24</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">break</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">25</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">case</span> <span style="color:rgb(128,0,128);line-height:1.5;">2</span><span style="line-height:1.5;">:          
</span><span style="color:rgb(0,128,128);line-height:1.5;">26</span>                     Constructor = t.GetConstructor(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> Type[<span style="color:rgb(128,0,128);line-height:1.5;">2</span>] { <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">int</span>), <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">) });
</span><span style="color:rgb(0,128,128);line-height:1.5;">27</span>                     entity = Constructor.Invoke(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span>[<span style="color:rgb(128,0,128);line-height:1.5;">2</span>] { <span style="color:rgb(128,0,128);line-height:1.5;">0</span>, <span style="color:rgb(0,0,255);line-height:1.5;">null</span> }) <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> T;
</span><span style="color:rgb(0,128,128);line-height:1.5;">28</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">break</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">29</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">case</span> <span style="color:rgb(128,0,128);line-height:1.5;">3</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">30</span>                     Constructor = t.GetConstructor(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> Type[<span style="color:rgb(128,0,128);line-height:1.5;">3</span>] { <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">int</span>), <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">string</span>), <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(<span style="color:rgb(0,0,255);line-height:1.5;">bool</span><span style="line-height:1.5;">) });
</span><span style="color:rgb(0,128,128);line-height:1.5;">31</span>                     entity = Constructor.Invoke(<span style="color:rgb(0,0,255);line-height:1.5;">new</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span>[<span style="color:rgb(128,0,128);line-height:1.5;">3</span>] { <span style="color:rgb(128,0,128);line-height:1.5;">0</span>, <span style="color:rgb(0,0,255);line-height:1.5;">null</span>, <span style="color:rgb(0,0,255);line-height:1.5;">false</span> }) <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> T;
</span><span style="color:rgb(0,128,128);line-height:1.5;">32</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">break</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">33</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">default</span><span style="line-height:1.5;">:
</span><span style="color:rgb(0,128,128);line-height:1.5;">34</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">break</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">35</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">36</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">37</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> entity;
</span><span style="color:rgb(0,128,128);line-height:1.5;">38</span>         }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h1 style="font-size:28px;line-height:1.5;font-family:'Helvetica Neue', Arial;">&nbsp;补充2</h1> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">上述提到用&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">dynamic</span>&nbsp;来简化反射的实现，对于园友提出&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">对于反射无法获取到class是什么</span>&nbsp;，像&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">dynamic dy =&nbsp;<span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;">Person(); Person dy</span>=&nbsp;<span style="color:rgb(0,0,255);line-height:1.5;">new</span>&nbsp;Person() ;</span>&nbsp;似乎是一样的，那还不如直接实例化调用其方法即可，一想确实是这样，经过再次研究觉得用dynamic只是更加便捷而且代码更加精简，就像用lamda简化而省去了用委托或者匿名方法一样！下面就以一个实例来说明不得不用反射来实现，还用上面的Person类，现在继续添加一个&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">OtherPerson</span>&nbsp;类：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">1</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> OtherPerson
</span><span style="color:rgb(0,128,128);line-height:1.5;">2</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;">3</span>         <span style="color:rgb(0,0,255);line-height:1.5;">private</span> <span style="color:rgb(0,0,255);line-height:1.5;">int</span> OtherAge { <span style="color:rgb(0,0,255);line-height:1.5;">get</span>; <span style="color:rgb(0,0,255);line-height:1.5;">set</span><span style="line-height:1.5;">; }
</span><span style="color:rgb(0,128,128);line-height:1.5;">4</span>     }</pre>
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">然后在Person类中添加一个返回值为OtherPerson的私有方法&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">GetOtherPerson</span>&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">1</span>        <span style="color:rgb(0,0,255);line-height:1.5;">private</span><span style="line-height:1.5;"> OtherPerson GetOtherPerson()
</span><span style="color:rgb(0,128,128);line-height:1.5;">2</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">3</span>             OtherPerson op = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> OtherPerson();
</span><span style="color:rgb(0,128,128);line-height:1.5;">4</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> op;
</span><span style="color:rgb(0,128,128);line-height:1.5;">5</span>         }</pre>
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">现在想调用&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">GetOtherPerson</span>&nbsp;方法获取&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">OtherPerson</span>&nbsp;类中的私有字段&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">OtherAge&nbsp;</span>&nbsp;，别告诉我直接实例化Person对象，再调用，因为是私有现在无法实现，所以马上想到的是通过反射来实现获取这个方法再同样实现获取私有字段</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">1</span>             Person p1 = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> Person();
</span><span style="color:rgb(0,128,128);line-height:1.5;">2</span>             <span style="color:rgb(0,0,255);line-height:1.5;">var</span> p = <span style="color:rgb(0,0,255);line-height:1.5;">typeof</span>(Person).InvokeMember(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">GetOtherPerson</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, BindingFlags.Instance | BindingFlags.InvokeMethod | BindingFlags.NonPublic, <span style="color:rgb(0,0,255);line-height:1.5;">null</span>, p1, <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">3</span>             <span style="color:rgb(0,0,255);line-height:1.5;">var</span> propInfo = p.GetType().GetProperty(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">OtherAge</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span>, BindingFlags.Instance |<span style="line-height:1.5;"> BindingFlags.NonPublic);
</span><span style="color:rgb(0,128,128);line-height:1.5;">4</span>             <span style="color:rgb(0,0,255);line-height:1.5;">var</span> age = (<span style="color:rgb(0,0,255);line-height:1.5;">int</span>)propInfo.GetValue(p, <span style="color:rgb(0,0,255);line-height:1.5;">null</span>);</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">一大片代码看起来是不是很恶心，接下来我们将代码进行改进，使其便捷化，上述提到用dynamic来实现，所以就来吧！</p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">&nbsp;<span style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;age = ((dynamic)p1).GetOtherPerson().OtherAge;</span>&nbsp;就一行代码是不是很简单，再次说明了dynamic的优美和简洁，so &nbsp;perfect!那我们运行下看看吧,oh，往往在你最得意的时候结果就会给你当头一棒，出错了！如下</p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;"><img src="https://images0.cnblogs.com/blog2015/589642/201507/281555197501503.png" alt="" style="border:0px;"></p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">这保护的级别有点忒高，那必须攻破你的堡垒！弄了一下午最终还是google给出了一位前辈已经这么做过的解决方案！重写了dynamic的基类DynamicObject,接着就写了它的扩展方法，代码如下：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">  1</span>    <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> PrivateReflectionDynamicObject : DynamicObject
</span><span style="color:rgb(0,128,128);line-height:1.5;">  2</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;">  3</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">  4</span>         <span style="color:rgb(0,0,255);line-height:1.5;">private</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> IDictionary&lt;Type, IDictionary&lt;<span style="color:rgb(0,0,255);line-height:1.5;">string</span>, IProperty&gt;&gt; _propertiesOnType = <span style="color:rgb(0,0,255);line-height:1.5;">new</span> ConcurrentDictionary&lt;Type, IDictionary&lt;<span style="color:rgb(0,0,255);line-height:1.5;">string</span>, IProperty&gt;&gt;<span style="line-height:1.5;">();
</span><span style="color:rgb(0,128,128);line-height:1.5;">  5</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">  6</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Simple abstraction to make field and property access consistent</span>
<span style="color:rgb(0,128,128);line-height:1.5;">  7</span>         <span style="color:rgb(0,0,255);line-height:1.5;">interface</span><span style="line-height:1.5;"> IProperty
</span><span style="color:rgb(0,128,128);line-height:1.5;">  8</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">  9</span>             <span style="color:rgb(0,0,255);line-height:1.5;">string</span> Name { <span style="color:rgb(0,0,255);line-height:1.5;">get</span><span style="line-height:1.5;">; }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 10</span>             <span style="color:rgb(0,0,255);line-height:1.5;">object</span> GetValue(<span style="color:rgb(0,0,255);line-height:1.5;">object</span> obj, <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">[] index);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 11</span>             <span style="color:rgb(0,0,255);line-height:1.5;">void</span> SetValue(<span style="color:rgb(0,0,255);line-height:1.5;">object</span> obj, <span style="color:rgb(0,0,255);line-height:1.5;">object</span> val, <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">[] index);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 12</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 13</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 14</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> IProperty implementation over a PropertyInfo</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 15</span>         <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> Property : IProperty
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 16</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 17</span>             <span style="color:rgb(0,0,255);line-height:1.5;">internal</span> PropertyInfo PropertyInfo { <span style="color:rgb(0,0,255);line-height:1.5;">get</span>; <span style="color:rgb(0,0,255);line-height:1.5;">set</span><span style="line-height:1.5;">; }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 18</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 19</span>             <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;"> IProperty.Name
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 20</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 21</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">get</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 22</span> <span style="line-height:1.5;">                {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 23</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> PropertyInfo.Name;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 24</span> <span style="line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 25</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 26</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 27</span>             <span style="color:rgb(0,0,255);line-height:1.5;">object</span> IProperty.GetValue(<span style="color:rgb(0,0,255);line-height:1.5;">object</span> obj, <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">[] index)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 28</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 29</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> PropertyInfo.GetValue(obj, index);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 30</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 31</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 32</span>             <span style="color:rgb(0,0,255);line-height:1.5;">void</span> IProperty.SetValue(<span style="color:rgb(0,0,255);line-height:1.5;">object</span> obj, <span style="color:rgb(0,0,255);line-height:1.5;">object</span> val, <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">[] index)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 33</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 34</span> <span style="line-height:1.5;">                PropertyInfo.SetValue(obj, val, index);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 35</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 36</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 37</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 38</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> IProperty implementation over a FieldInfo</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 39</span>         <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> Field : IProperty
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 40</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 41</span>             <span style="color:rgb(0,0,255);line-height:1.5;">internal</span> FieldInfo FieldInfo { <span style="color:rgb(0,0,255);line-height:1.5;">get</span>; <span style="color:rgb(0,0,255);line-height:1.5;">set</span><span style="line-height:1.5;">; }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 42</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 43</span>             <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;"> IProperty.Name
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 44</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 45</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">get</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 46</span> <span style="line-height:1.5;">                {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 47</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> FieldInfo.Name;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 48</span> <span style="line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 49</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 50</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 51</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 52</span>             <span style="color:rgb(0,0,255);line-height:1.5;">object</span> IProperty.GetValue(<span style="color:rgb(0,0,255);line-height:1.5;">object</span> obj, <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">[] index)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 53</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 54</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> FieldInfo.GetValue(obj);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 55</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 56</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 57</span>             <span style="color:rgb(0,0,255);line-height:1.5;">void</span> IProperty.SetValue(<span style="color:rgb(0,0,255);line-height:1.5;">object</span> obj, <span style="color:rgb(0,0,255);line-height:1.5;">object</span> val, <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">[] index)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 58</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 59</span> <span style="line-height:1.5;">                FieldInfo.SetValue(obj, val);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 60</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 61</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 62</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 63</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 64</span>         <span style="color:rgb(0,0,255);line-height:1.5;">private</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span> RealObject { <span style="color:rgb(0,0,255);line-height:1.5;">get</span>; <span style="color:rgb(0,0,255);line-height:1.5;">set</span><span style="line-height:1.5;">; }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 65</span>         <span style="color:rgb(0,0,255);line-height:1.5;">private</span> <span style="color:rgb(0,0,255);line-height:1.5;">const</span> BindingFlags bindingFlags = BindingFlags.Instance | BindingFlags.Public |<span style="line-height:1.5;"> BindingFlags.NonPublic;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 66</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 67</span>         <span style="color:rgb(0,0,255);line-height:1.5;">internal</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span> WrapObjectIfNeeded(<span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;"> o)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 68</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 69</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Don't wrap primitive types, which don't have many interesting internal APIs</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 70</span>             <span style="color:rgb(0,0,255);line-height:1.5;">if</span> (o == <span style="color:rgb(0,0,255);line-height:1.5;">null</span> || o.GetType().IsPrimitive || o <span style="color:rgb(0,0,255);line-height:1.5;">is</span> <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;">)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 71</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> o;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 72</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 73</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">new</span> PrivateReflectionDynamicObject() { RealObject =<span style="line-height:1.5;"> o };
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 74</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 75</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 76</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">override</span> <span style="color:rgb(0,0,255);line-height:1.5;">bool</span> TryGetMember(GetMemberBinder binder, <span style="color:rgb(0,0,255);line-height:1.5;">out</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;"> result)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 77</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 78</span>             IProperty prop =<span style="line-height:1.5;"> GetProperty(binder.Name);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 79</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 80</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Get the property value</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 81</span>             result = prop.GetValue(RealObject, index: <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 82</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 83</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Wrap the sub object if necessary. This allows nested anonymous objects to work.</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 84</span>             result =<span style="line-height:1.5;"> WrapObjectIfNeeded(result);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 85</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 86</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 87</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 88</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 89</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">override</span> <span style="color:rgb(0,0,255);line-height:1.5;">bool</span> TrySetMember(SetMemberBinder binder, <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;"> value)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 90</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 91</span>             IProperty prop =<span style="line-height:1.5;"> GetProperty(binder.Name);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 92</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 93</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Set the property value</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 94</span>             prop.SetValue(RealObject, value, index: <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 95</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 96</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 97</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 98</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 99</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">override</span> <span style="color:rgb(0,0,255);line-height:1.5;">bool</span> TryGetIndex(GetIndexBinder binder, <span style="color:rgb(0,0,255);line-height:1.5;">object</span>[] indexes, <span style="color:rgb(0,0,255);line-height:1.5;">out</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;"> result)
</span><span style="color:rgb(0,128,128);line-height:1.5;">100</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">101</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> The indexed property is always named "Item" in C#</span>
<span style="color:rgb(0,128,128);line-height:1.5;">102</span>             IProperty prop =<span style="line-height:1.5;"> GetIndexProperty();
</span><span style="color:rgb(0,128,128);line-height:1.5;">103</span>             result =<span style="line-height:1.5;"> prop.GetValue(RealObject, indexes);
</span><span style="color:rgb(0,128,128);line-height:1.5;">104</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">105</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Wrap the sub object if necessary. This allows nested anonymous objects to work.</span>
<span style="color:rgb(0,128,128);line-height:1.5;">106</span>             result =<span style="line-height:1.5;"> WrapObjectIfNeeded(result);
</span><span style="color:rgb(0,128,128);line-height:1.5;">107</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">108</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">109</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">110</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">111</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">override</span> <span style="color:rgb(0,0,255);line-height:1.5;">bool</span> TrySetIndex(SetIndexBinder binder, <span style="color:rgb(0,0,255);line-height:1.5;">object</span>[] indexes, <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;"> value)
</span><span style="color:rgb(0,128,128);line-height:1.5;">112</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">113</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> The indexed property is always named "Item" in C#</span>
<span style="color:rgb(0,128,128);line-height:1.5;">114</span>             IProperty prop =<span style="line-height:1.5;"> GetIndexProperty();
</span><span style="color:rgb(0,128,128);line-height:1.5;">115</span> <span style="line-height:1.5;">            prop.SetValue(RealObject, value, indexes);
</span><span style="color:rgb(0,128,128);line-height:1.5;">116</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">117</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">118</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">119</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Called when a method is called</span>
<span style="color:rgb(0,128,128);line-height:1.5;">120</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">override</span> <span style="color:rgb(0,0,255);line-height:1.5;">bool</span> TryInvokeMember(InvokeMemberBinder binder, <span style="color:rgb(0,0,255);line-height:1.5;">object</span>[] args, <span style="color:rgb(0,0,255);line-height:1.5;">out</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;"> result)
</span><span style="color:rgb(0,128,128);line-height:1.5;">121</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">122</span>             result =<span style="line-height:1.5;"> InvokeMemberOnType(RealObject.GetType(), RealObject, binder.Name, args);
</span><span style="color:rgb(0,128,128);line-height:1.5;">123</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">124</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Wrap the sub object if necessary. This allows nested anonymous objects to work.</span>
<span style="color:rgb(0,128,128);line-height:1.5;">125</span>             result =<span style="line-height:1.5;"> WrapObjectIfNeeded(result);
</span><span style="color:rgb(0,128,128);line-height:1.5;">126</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">127</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">128</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">129</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">130</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">override</span> <span style="color:rgb(0,0,255);line-height:1.5;">bool</span> TryConvert(ConvertBinder binder, <span style="color:rgb(0,0,255);line-height:1.5;">out</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;"> result)
</span><span style="color:rgb(0,128,128);line-height:1.5;">131</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">132</span>             result =<span style="line-height:1.5;"> Convert.ChangeType(RealObject, binder.Type);
</span><span style="color:rgb(0,128,128);line-height:1.5;">133</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">134</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">135</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">136</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">override</span> <span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;"> ToString()
</span><span style="color:rgb(0,128,128);line-height:1.5;">137</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">138</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> RealObject.ToString();
</span><span style="color:rgb(0,128,128);line-height:1.5;">139</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">140</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">141</span>         <span style="color:rgb(0,0,255);line-height:1.5;">private</span><span style="line-height:1.5;"> IProperty GetIndexProperty()
</span><span style="color:rgb(0,128,128);line-height:1.5;">142</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">143</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> The index property is always named "Item" in C#</span>
<span style="color:rgb(0,128,128);line-height:1.5;">144</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span> GetProperty(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">Item</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">145</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">146</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">147</span>         <span style="color:rgb(0,0,255);line-height:1.5;">private</span> IProperty GetProperty(<span style="color:rgb(0,0,255);line-height:1.5;">string</span><span style="line-height:1.5;"> propertyName)
</span><span style="color:rgb(0,128,128);line-height:1.5;">148</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">149</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">150</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Get the list of properties and fields for this type</span>
<span style="color:rgb(0,128,128);line-height:1.5;">151</span>             IDictionary&lt;<span style="color:rgb(0,0,255);line-height:1.5;">string</span>, IProperty&gt; typeProperties =<span style="line-height:1.5;"> GetTypeProperties(RealObject.GetType());
</span><span style="color:rgb(0,128,128);line-height:1.5;">152</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">153</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Look for the one we want</span>
<span style="color:rgb(0,128,128);line-height:1.5;">154</span> <span style="line-height:1.5;">            IProperty property;
</span><span style="color:rgb(0,128,128);line-height:1.5;">155</span>             <span style="color:rgb(0,0,255);line-height:1.5;">if</span> (typeProperties.TryGetValue(propertyName, <span style="color:rgb(0,0,255);line-height:1.5;">out</span><span style="line-height:1.5;"> property))
</span><span style="color:rgb(0,128,128);line-height:1.5;">156</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">157</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> property;
</span><span style="color:rgb(0,128,128);line-height:1.5;">158</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">159</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">160</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> The property doesn't exist
</span><span style="color:rgb(0,128,128);line-height:1.5;">161</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">162</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Get a list of supported properties and fields and show them as part of the exception message
</span><span style="color:rgb(0,128,128);line-height:1.5;">163</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> For fields, skip the auto property backing fields (which name start with &lt;)</span>
<span style="color:rgb(0,128,128);line-height:1.5;">164</span>             <span style="color:rgb(0,0,255);line-height:1.5;">var</span> propNames = typeProperties.Keys.Where(name =&gt; name[<span style="color:rgb(128,0,128);line-height:1.5;">0</span>] != <span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>).OrderBy(name =&gt;<span style="line-height:1.5;"> name);
</span><span style="color:rgb(0,128,128);line-height:1.5;">165</span>             <span style="color:rgb(0,0,255);line-height:1.5;">throw</span> <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> ArgumentException(
</span><span style="color:rgb(0,128,128);line-height:1.5;">166</span> <span style="line-height:1.5;">                String.Format(
</span><span style="color:rgb(0,128,128);line-height:1.5;">167</span>                 <span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">The property {0} doesn't exist on type {1}. Supported properties are: {2}</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">,
</span><span style="color:rgb(0,128,128);line-height:1.5;">168</span>                 propertyName, RealObject.GetType(), String.Join(<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">, </span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">, propNames)));
</span><span style="color:rgb(0,128,128);line-height:1.5;">169</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">170</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">171</span>         <span style="color:rgb(0,0,255);line-height:1.5;">private</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> IDictionary&lt;<span style="color:rgb(0,0,255);line-height:1.5;">string</span>, IProperty&gt;<span style="line-height:1.5;"> GetTypeProperties(Type type)
</span><span style="color:rgb(0,128,128);line-height:1.5;">172</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">173</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> First, check if we already have it cached</span>
<span style="color:rgb(0,128,128);line-height:1.5;">174</span>             IDictionary&lt;<span style="color:rgb(0,0,255);line-height:1.5;">string</span>, IProperty&gt;<span style="line-height:1.5;"> typeProperties;
</span><span style="color:rgb(0,128,128);line-height:1.5;">175</span>             <span style="color:rgb(0,0,255);line-height:1.5;">if</span> (_propertiesOnType.TryGetValue(type, <span style="color:rgb(0,0,255);line-height:1.5;">out</span><span style="line-height:1.5;"> typeProperties))
</span><span style="color:rgb(0,128,128);line-height:1.5;">176</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">177</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> typeProperties;
</span><span style="color:rgb(0,128,128);line-height:1.5;">178</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">179</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">180</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Not cache, so we need to build it</span>
<span style="color:rgb(0,128,128);line-height:1.5;">181</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">182</span>             typeProperties = <span style="color:rgb(0,0,255);line-height:1.5;">new</span> ConcurrentDictionary&lt;<span style="color:rgb(0,0,255);line-height:1.5;">string</span>, IProperty&gt;<span style="line-height:1.5;">();
</span><span style="color:rgb(0,128,128);line-height:1.5;">183</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">184</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> First, add all the properties</span>
<span style="color:rgb(0,128,128);line-height:1.5;">185</span>             <span style="color:rgb(0,0,255);line-height:1.5;">foreach</span> (PropertyInfo prop <span style="color:rgb(0,0,255);line-height:1.5;">in</span> type.GetProperties(bindingFlags).Where(p =&gt; p.DeclaringType ==<span style="line-height:1.5;"> type))
</span><span style="color:rgb(0,128,128);line-height:1.5;">186</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">187</span>                 typeProperties[prop.Name] = <span style="color:rgb(0,0,255);line-height:1.5;">new</span> Property() { PropertyInfo =<span style="line-height:1.5;"> prop };
</span><span style="color:rgb(0,128,128);line-height:1.5;">188</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">189</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">190</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Now, add all the fields</span>
<span style="color:rgb(0,128,128);line-height:1.5;">191</span>             <span style="color:rgb(0,0,255);line-height:1.5;">foreach</span> (FieldInfo field <span style="color:rgb(0,0,255);line-height:1.5;">in</span> type.GetFields(bindingFlags).Where(p =&gt; p.DeclaringType ==<span style="line-height:1.5;"> type))
</span><span style="color:rgb(0,128,128);line-height:1.5;">192</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">193</span>                 typeProperties[field.Name] = <span style="color:rgb(0,0,255);line-height:1.5;">new</span> Field() { FieldInfo =<span style="line-height:1.5;"> field };
</span><span style="color:rgb(0,128,128);line-height:1.5;">194</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">195</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">196</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Finally, recurse on the base class to add its fields</span>
<span style="color:rgb(0,128,128);line-height:1.5;">197</span>             <span style="color:rgb(0,0,255);line-height:1.5;">if</span> (type.BaseType != <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">)
</span><span style="color:rgb(0,128,128);line-height:1.5;">198</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">199</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">foreach</span> (IProperty prop <span style="color:rgb(0,0,255);line-height:1.5;">in</span><span style="line-height:1.5;"> GetTypeProperties(type.BaseType).Values)
</span><span style="color:rgb(0,128,128);line-height:1.5;">200</span> <span style="line-height:1.5;">                {
</span><span style="color:rgb(0,128,128);line-height:1.5;">201</span>                     typeProperties[prop.Name] =<span style="line-height:1.5;"> prop;
</span><span style="color:rgb(0,128,128);line-height:1.5;">202</span> <span style="line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);line-height:1.5;">203</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">204</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">205</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Cache it for next time</span>
<span style="color:rgb(0,128,128);line-height:1.5;">206</span>             _propertiesOnType[type] =<span style="line-height:1.5;"> typeProperties;
</span><span style="color:rgb(0,128,128);line-height:1.5;">207</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">208</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> typeProperties;
</span><span style="color:rgb(0,128,128);line-height:1.5;">209</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">210</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">211</span>         <span style="color:rgb(0,0,255);line-height:1.5;">private</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span> InvokeMemberOnType(Type type, <span style="color:rgb(0,0,255);line-height:1.5;">object</span> target, <span style="color:rgb(0,0,255);line-height:1.5;">string</span> name, <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;">[] args)
</span><span style="color:rgb(0,128,128);line-height:1.5;">212</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">213</span>             <span style="color:rgb(0,0,255);line-height:1.5;">try</span>
<span style="color:rgb(0,128,128);line-height:1.5;">214</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">215</span>                 <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> Try to incoke the method</span>
<span style="color:rgb(0,128,128);line-height:1.5;">216</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> type.InvokeMember(
</span><span style="color:rgb(0,128,128);line-height:1.5;">217</span> <span style="line-height:1.5;">                    name,
</span><span style="color:rgb(0,128,128);line-height:1.5;">218</span>                     BindingFlags.InvokeMethod |<span style="line-height:1.5;"> bindingFlags,
</span><span style="color:rgb(0,128,128);line-height:1.5;">219</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">,
</span><span style="color:rgb(0,128,128);line-height:1.5;">220</span> <span style="line-height:1.5;">                    target,
</span><span style="color:rgb(0,128,128);line-height:1.5;">221</span> <span style="line-height:1.5;">                    args);
</span><span style="color:rgb(0,128,128);line-height:1.5;">222</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">223</span>             <span style="color:rgb(0,0,255);line-height:1.5;">catch</span><span style="line-height:1.5;"> (MissingMethodException)
</span><span style="color:rgb(0,128,128);line-height:1.5;">224</span> <span style="line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);line-height:1.5;">225</span>                 <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> If we couldn't find the method, try on the base class</span>
<span style="color:rgb(0,128,128);line-height:1.5;">226</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">if</span> (type.BaseType != <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">)
</span><span style="color:rgb(0,128,128);line-height:1.5;">227</span> <span style="line-height:1.5;">                {
</span><span style="color:rgb(0,128,128);line-height:1.5;">228</span>                     <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> InvokeMemberOnType(type.BaseType, target, name, args);
</span><span style="color:rgb(0,128,128);line-height:1.5;">229</span> <span style="line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);line-height:1.5;">230</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">231</span>                 <span style="color:rgb(0,0,255);line-height:1.5;">throw</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;">232</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">233</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">234</span>     }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">扩展方法如下</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;">1</span>    <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> PrivateReflectionDynamicObjectExtensions
</span><span style="color:rgb(0,128,128);line-height:1.5;">2</span> <span style="line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);line-height:1.5;">3</span>         <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> dynamic AsDynamic(<span style="color:rgb(0,0,255);line-height:1.5;">this</span> <span style="color:rgb(0,0,255);line-height:1.5;">object</span><span style="line-height:1.5;"> o)
</span><span style="color:rgb(0,128,128);line-height:1.5;">4</span> <span style="line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);line-height:1.5;">5</span>             <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> PrivateReflectionDynamicObject.WrapObjectIfNeeded(o);
</span><span style="color:rgb(0,128,128);line-height:1.5;">6</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">7</span>     }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(45,161,45);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;">最后调用拓展方法&nbsp;<span class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;">&nbsp;<span style="color:rgb(0,0,255);line-height:1.5;">var</span>&nbsp;age = p1.AsDynamic().GetOtherPerson().OtherAge;</span>&nbsp;成功！所以有时候使用dynamic使得代码变得更加优美而用反射代码繁多而且显得非常臃肿，通过再一次学习dynamic，对此也深信不疑！</p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;"><br></p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;"><br></p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;"><br></p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;"><br></p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;"><br></p> 
   <p style="color:rgb(17,17,17);font-family:'Helvetica Neue', Arial;font-size:13px;line-height:23.4px;"><br></p> 
   <p><font color="#111111"><span style="font-size:13px;line-height:23.4px;">本文转自Jeffcky博客园博客，原文链接：http://www.cnblogs.com/CreateMyself/p/4680229.html，如需转载请自行联系原作者</span></font></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
