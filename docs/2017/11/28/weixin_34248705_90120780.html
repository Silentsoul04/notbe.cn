<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Hadoop MapReduce编程 API入门系列之挖掘气象数据版本2（十） « NotBeCN</title>
  <meta name="description" content="             　这篇博文，包括了，实际生产开发非常重要的，单元测试和调试代码。这里不多赘述，直接送上代码。    &nbsp;    MRUnit 框架    MRUnit是Cloudera公司专为Hadoop MapReduce写的单元测试框架，API非常简洁实用。MRUnit针对不同测试对象使用不...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/28/weixin_34248705_90120780.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Hadoop MapReduce编程 API入门系列之挖掘气象数据版本2（十）</h1>
    <p class="post-meta">Nov 28, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　这篇博文，包括了，实际生产开发非常重要的，单元测试和调试代码。这里不多赘述，直接送上代码。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h4 style="font-size:14px;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;">MRUnit 框架</h4> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>MRUnit</strong><strong>是</strong><strong>Cloudera</strong><strong>公司专为</strong><strong>Hadoop MapReduce</strong><strong>写的单元测试框架</strong>，API非常简洁实用。MRUnit针对不同测试对象使用不同的Driver：</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>Map</strong>Driver：针对单独的Map测试</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>&nbsp;Reduce</strong>Driver：针对单独的Reduce测试</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>&nbsp;&nbsp;&nbsp;MapReduce</strong>Driver：将map和reduce串起来测试</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>PipelineMapReduce</strong>Driver：将多个MapReduce对串志来测试</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212123048183-2145555028.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;　　记得，将这个jar包，放到工程项目里。我这里是在工程项目的根目录下的lib下。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong>代码版本2</strong></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212122230745-67468566.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212122311136-807031740.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp; 编写TemperatureMapperTest.java的代码。&nbsp; 编译，出现以下，则说明无误。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;<img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212123408448-533397627.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp; 在test()方法中，withInput的key/value参数分别为偏移量和一行气象数据，其类型要与TemperatureMapper的输入类型一致即为LongWritable和Text。 withOutput的key/value参数分别是我们期望输出的new Text("03103")和new IntWritable(200)，我们要达到的测试效果就是我们的期望输出结果与 TemperatureMapper 的实际输出结果一致。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp;测试方法为 test() 方法，左边的对话框里显示"Runs：1/1，Errors：0，Failures：0"，说明 Mapper 测试成功了。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212122322995-866894441.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; 创建TemperatureReduceTest.java，来对Reduce进行测试。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp;在test()方法中，withInput的key/value参数分别为new Text(key)和List类型的集合values。withOutput 的key/value参数分别是我们所期望输出的new Text(key)和new IntWritable(150)，我们要达到的测试效果就是我们的期望输出结果与TemperatureReducer实际输出结果一致。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;编写TemperatureReduceTest.java的代码。&nbsp; 编译，出现以下，则说明无误。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212123558464-2127599916.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reducer 端的单元测试，鼠标放在 TemperatureReduceTest 类上右击，选择 Run As ——&gt; JUnit test，运行结果如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">测试方法为 test() 方法，左边的对话框里显示"Runs：1/1，Errors：0，Failures：0"，说明 Reducer 测试成功了。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212122333089-967037096.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;MapReduce 单元测试</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;把 Mapper 和 Reducer 集成起来的测试案例代码如下。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp; 创建TemperatureTest.java，来进行测试。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;在 test() 方法中，withInput添加了两行测试数据line和line2，withOutput 的key/value参数分别为我们期望的输出结果new Text("03103")和new IntWritable(150)。我们要达到的测试效果就是我们期望的输出结果与Temperature实际的输出结果一致。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; 编写TemperatureTest.java的代码。 编译，出现以下，则说明无误。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212123722558-111517480.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reducer 端的单元测试，鼠标放在 TemperatureTest.java类上右击，选择 Run As ——&gt; JUnit test，运行结果如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp; 测试方法为 test() 方法，左边的对话框里显示"Runs：1/1，Errors：0，Failures：0"，说明 MapReduce 测试成功了。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212122349214-32685165.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212122358104-801624788.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212122413792-1138251122.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212122427104-1059156354.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong><span style="color:rgb(0,0,255);">Temperature.java代码</span></strong></span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.TemperatureTest;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileSplit;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configured;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.FileSystem;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 13</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 14</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 15</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 16</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Job;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 17</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 18</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 19</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 20</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileSplit;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 21</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 22</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.util.Tool;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 23</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.util.ToolRunner;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 24</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 25</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 26</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/*</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 27</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Hadoop内置的数据类型:
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 28</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    BooleanWritable:标准布尔型数值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 29</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    ByteWritable:单字节数值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 30</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    DoubleWritable:双字节数值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 31</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    FloatWritable:浮点数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 32</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    IntWritable:整型数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 33</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    LongWritable:长整型数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 34</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    Text:使用UTF8格式存储的文本
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 35</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    NullWritable:当&lt;key, value&gt;中的key或value为空时使用
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 36</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 37</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 38</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 39</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 40</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 统计美国每个气象站30年来的平均气温
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 41</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 1、编写map()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 42</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 2、编写reduce()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 43</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 3、编写run()执行方法，负责运行MapReduce作业
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 44</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 4、在main()方法中运行程序
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 45</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 46</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * </span><span style="color:rgb(128,128,128);font-size:12px;line-height:1.5;">@author</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> zhouls
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 47</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> *
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 48</span>  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 49</span>                         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">继承Configured类，实现Tool接口</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 50</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> Temperature <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Configured <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">implements</span><span style="font-size:12px;line-height:1.5;"> Tool{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 51</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> TemperatureMapper <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Mapper&lt;LongWritable, Text, Text, IntWritable&gt;<span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 52</span>                                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输入的key,输入的value,输出的key,输出的value
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 53</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输入的LongWritable键是某一行起始位置相对于文件起始位置的偏移量，不过我们不需要这个信息，所以将其忽略。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 54</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 55</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        在这种情况下，我们将气象站id按 Text 对象进行读/写（因为我们把气象站id当作键），将气温值封装在 IntWritale 类型中。只有气温数据不缺失，这些数据才会被写入输出记录中。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 56</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 57</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 58</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        map 函数的功能仅限于提取气象站和气温信息</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 59</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 60</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 61</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">         * @function Mapper 解析气象站数据
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 62</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">         * @input key=偏移量  value=气象站数据
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 63</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">         * @output key=weatherStationId value=temperature
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 64</span>          <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 65</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> map(LongWritable key, Text value, Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 66</span>                                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">map()函数还提供了context实例，用于键值对的输出  或者说 map() 方法还提供了 Context 实例用于输出内容的写入
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 67</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 68</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                                就本示例来说，输入键是一个长整数偏移量，输入值是一行文本，输出键是气象站id，输出值是气温（整数）。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 69</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                同时context作为了map和reduce执行中各个函数的一个桥梁，这个设计和Java web中的session对象、application对象很相似
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 70</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 71</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 72</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第一步，我们将每行气象站数据转换为每行的String类型</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 73</span>             String line = value.toString(); <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">每行气象数据
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 74</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            values是1980 12 01 00    78   -17 10237   180    21     1     0     0
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 75</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            line是"1980 12 01 00    78   -17 10237   180    21     1     0     0"
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 76</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 77</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 78</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第二步：提取气温值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 79</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> temperature = Integer.parseInt(line.substring(14, 19).trim());<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">每小时气温值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 80</span>                                  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">需要转换为整形，截取第14位到19位，从第0位开始，trim()的功能是去掉首尾空格。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 81</span>                                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">substring()方法截取我们业务需要的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 82</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 83</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            substring(start, stop)其内容是从 start 处到 stop-1 处的所有字符，其长度为 stop 减 start。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 84</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 85</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            如Hello world!    若是substring(3,7)        则是lo w
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 86</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 87</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                                Integer.parseInt() 返回的是一个int的值。在这里， 给temperature
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 88</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 89</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">             new Integer.valueof()返回的是Integer的对象。 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 90</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">             Integer.parseInt() 返回的是一个int的值。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 91</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">             new Integer.valueof().intValue();返回的也是一个int的值。 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 92</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 93</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 94</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 95</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 96</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 97</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            1980 12 01 00    78   -17 10237   180    21     1     0     0
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 98</span>                             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">78是气温值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 99</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">100</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            temperature是78
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">101</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">102</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            30yr_03103.dat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">103</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            30yr_03812.dat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">104</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            30yr_03813.dat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">105</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            30yr_03816.dat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">106</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            30yr_03820.dat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">107</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            30yr_03822.dat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">108</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            30yr_03856.dat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">109</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            30yr_03860.dat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">110</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            30yr_03870.dat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">111</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            30yr_03872.dat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">112</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">113</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">114</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (0，1985 07 31 02   200    94 10137   220    26     1     0 -9999)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">115</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (62，1985 07 31 03   172    94 10142   240     0     0     0 -9999)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">116</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (124，1985 07 31 04   156    83 10148   260    10     0     0 -9999)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">117</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (186，1985 07 31 05   133    78 -9999   250     0 -9999     0 -9999)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">118</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (248，1985 07 31 06   122    72 -9999    90     0 -9999     0     0)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">119</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (310，1985 07 31 07   117    67 -9999    60     0 -9999     0 -9999)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">120</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (371，1985 07 31 08   111    61 -9999    90     0 -9999     0 -9999)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">121</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (434，1985 07 31 09   111    61 -9999    60     5 -9999     0 -9999)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">122</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (497，1985 07 31 10   106    67 -9999    80     0 -9999     0 -9999)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">123</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (560，1985 07 31 11   100    56 -9999    50     5 -9999     0 -9999)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">124</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">125</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            (03103,[200,172,156,133,122,117,111,111,106,100])
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">126</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">127</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            根据自己业务需要 ， map 函数的功能仅限于提取气象站和气温信息
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">128</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">129</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">130</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            1998        #year
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">131</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            03            #month
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">132</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            09            #day
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">133</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            17            #hour
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">134</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            11            #temperature            感兴趣
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">135</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            -100        #dew
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">136</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            10237        #pressure
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">137</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            60            #wind_direction    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">138</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            72            #wind_speed
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">139</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            0            #sky_condition    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">140</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            0            #rain_1h 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">141</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            -9999        #rain_6h</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">142</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">143</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">144</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (temperature != -9999){<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">过滤无效数据    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">145</span>                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第三步：提取气象站编号
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">146</span>                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">获取输入分片</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">147</span>                 FileSplit fileSplit = (FileSplit) context.getInputSplit();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">提取问加你输入分片，并转换类型
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">148</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                    即由InputSplit   -&gt;   FileSplit
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">149</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">150</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                context.getInputSplit()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">151</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                (FileSplit) context.getInputSplit()这是强制转换
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">152</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                fileSplit的值是file:/D:/Code/MyEclipseJavaCode/myMapReduce/data/temperature/30yr_03870.dat:0+16357956
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">153</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                即，读的是30yr_03870.dat这个文件
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">154</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">155</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">156</span>                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">然后通过文件名称提取气象站编号</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">157</span>                 String weatherStationId = fileSplit.getPath().getName().substring(5, 10);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过文件名称提取气象站id
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">158</span>                         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">首先通过文件分片fileSplit来获取文件路径，然后再获取文件名字，然后截取第5位到第10位就可以得到气象站 编号
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">159</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        fileSplit.getPath()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">160</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        fileSplit.getPath().getName()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">161</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">162</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                30yr_03870.dat   我们只需获取03870就是气象站编号
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">163</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">164</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        fileSplit.getPath().getName().substring(5, 10)   </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">从0开始，即第5个开始截取，到第10个为止，第10个没有拿到，所以为03870
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">165</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                weatherStationId是03870</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">166</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">167</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">168</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">169</span>                 context.write(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text(weatherStationId), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IntWritable(temperature));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">写入weatherStationId是k2,temperature是v2
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">170</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                context.write(weatherStationId,temperature);等价    ，但是若是直接这样写会出错，因为，    weatherStationId是String类型，注意与Text类型还是有区别的！        
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">171</span>                         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">气象站编号，气温值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">172</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">173</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">174</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">175</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">176</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">177</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">178</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> TemperatureReducer <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Reducer&lt; Text, IntWritable, Text, IntWritable&gt;<span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">179</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> IntWritable result = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IntWritable();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存取结果
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">180</span>                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">因为气温是IntWritable类型                       </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">181</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> reduce(Text key, Iterable&lt;IntWritable&gt; values,Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException{ 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">182</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            Iterable&lt;IntWritable&gt; values是iterable（迭代器）变量
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">183</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">184</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">185</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            Iterable&lt;IntWritable&gt; values和IntWritable values这样有什么区别？
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">186</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            前者是iterable（迭代器）变量，后者是intwriteable（int的封装）变量
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">187</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">188</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">189</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            Iterable&lt;IntWritable&gt; values
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">190</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            迭代器，valuses是 iterable（迭代器）变量，类型是IntWritable
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">191</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">192</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">193</span>                         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reduce输出的key,key的集合，context的实例
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">194</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第一步：统计相同气象站的所有气温</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">195</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> sum = 0<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">196</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> count = 0<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">197</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> (IntWritable val : values) <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">星型for循环来循环同一个气象站的所有气温值，即将values的值一一传给IntWritable val 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">198</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                IntWritable val是IntWritable（int的封装）变量</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">199</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">200</span>             {<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对所有气温值累加</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">201</span>             sum += val.get();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">去val里拿一个值，就sum下
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">202</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">203</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            val.get()去拿值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">204</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">205</span>                 count++<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">206</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">207</span>             result.set(sum / count);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设为v3
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">208</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            result.set(sum / count)去设置，将sum / count的值，设给result
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">209</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            sum是21299119   count是258616  =  82.3580869  </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">210</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">211</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">212</span>             context.write(key,result);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">写入key是k3,result是v3</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">213</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">214</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">215</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">216</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">217</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">218</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> run(String[] args) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> Exception{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">219</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> TODO Auto-generated method stub
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">220</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第一步：读取配置文件</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">221</span>         Configuration conf = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Configuration();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">程序里，只需写这么一句话，就会加载到hadoop的配置文件了
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">222</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Configuration类代表作业的配置，该类会加载mapred-site.xml、hdfs-site.xml、core-site.xml等配置文件。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">223</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">224</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                new Configuration()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">225</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">226</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第二步:输出路径存在就先删除</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">227</span>         Path mypath = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(args[1]);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义输出路径的Path对象，mypath
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">228</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">229</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">230</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        new Path(args[1])将args[1]的值，给mypath</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">231</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">232</span>         FileSystem hdfs = mypath.getFileSystem(conf);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">程序里，只需写这么一句话，就可以获取到文件系统了。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">233</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">FileSystem里面包括很多系统，不局限于hdfs，是因为，程序读到conf，哦，原来是hadoop集群啊。这时，才认知到是hdfs</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">234</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">235</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (hdfs.isDirectory(mypath))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">如果输出路径存在</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">236</span> <span style="font-size:12px;line-height:1.5;">        {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">237</span>             hdfs.delete(mypath, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">则就删除</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">238</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">239</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第三步：构建job对象</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">240</span>         Job job = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Job(conf, "temperature");<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">新建一个任务,job名字是tempreature
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">241</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">242</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        new Job(conf, "temperature")有这么个构造方法</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">243</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">244</span>         job.setJarByClass(Temperature.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 设置主类
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">245</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过job对象来设置主类Temperature.class
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">246</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">247</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第四步：指定数据的输入路径和输出路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">248</span>         FileInputFormat.addInputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(args[0]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 输入路径,args[0]</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">249</span>         FileOutputFormat.setOutputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(args[1]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 输出路径,args[1]
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">250</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">251</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第五步：指定Mapper和Reducer</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">252</span>         job.setMapperClass(TemperatureMapper.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> Mapper</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">253</span>         job.setReducerClass(TemperatureReducer.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> Reducer
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">254</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">255</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第六步：设置map函数和reducer函数的输出类型</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">256</span>         job.setOutputKeyClass(Text.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">257</span>         job.setOutputValueClass(IntWritable.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">258</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">259</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第七步：提交作业</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">260</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> job.waitForCompletion(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span>)?0:1;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">提交任务</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">261</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">262</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">263</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">264</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">265</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">     * @function main 方法
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">266</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">     * </span><span style="color:rgb(128,128,128);font-size:12px;line-height:1.5;">@param</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> args
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">267</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">     * </span><span style="color:rgb(128,128,128);font-size:12px;line-height:1.5;">@throws</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> Exception
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">268</span>      <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">269</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> main(String[] args) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> Exception {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">270</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第一步
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">271</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        String[] args0 = 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">272</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">273</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            "hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">djt002:9000/inputData/temperature/",
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">274</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                    "hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">djt002:9000/outData/temperature/"
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">275</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            };</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">276</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">277</span>         String[] args0 = {"./data/temperature/","./out/temperature/"<span style="font-size:12px;line-height:1.5;">};
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">278</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">279</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        args0是输入路径和输出路径的属组
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">280</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">281</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第二步</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">282</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> ec = ToolRunner.run(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Configuration(), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Temperature(), args0);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">283</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">284</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        ToolRunner.run(new Configuration(), new Temperature(), args0)有这么一个构造方法
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">285</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">286</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第一个参数是读取配置文件，第二个参数是主类Temperature，第三个参数是输入路径和输出路径的属组</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">287</span> <span style="font-size:12px;line-height:1.5;">        System.exit(ec);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">288</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">289</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">290</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">291</span>     </pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;color:rgb(0,0,255);"><strong>&nbsp;TemperatureMapperTest.java</strong></span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.TemperatureTest;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mrunit.mapreduce.MapDriver;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.junit.Before;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.junit.Test;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * Mapper 端的单元测试，这里用MRUnit框架，需要使用mrunit-hadoop.jar
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span>  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span> @SuppressWarnings("all")<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">告诉编译器忽略指定的警告，不用在编译完成后出现警告信息</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> TemperatureMapperTest{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Mapper mapper;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义一个Mapper对象，是mapper</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> MapDriver driver;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义一个MapDriver对象，是driver，因为是要MapDriver去做！</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span>     @Before<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">@Before是在所拦截单元测试方法执行之前执行一段逻辑，读艾特Before</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> init(){<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">初始化方法init</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span>         mapper = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Temperature.TemperatureMapper();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">实例化一个Temperature中的TemperatureMapper对象</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span>         driver = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> MapDriver(mapper);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">实例化MapDriver对象</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span>     @Test<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">@Test是测试方法提示符，一般与@Before组合使用</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> test() <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">因为测试的是Map
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输入一行测试数据</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">33</span>         String line = "1985 07 31 02   200    94 10137   220    26     1     0 -9999"<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">34</span>         driver.withInput(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> LongWritable(), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text(line))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">withInput方法是第一行输入       跟TemperatureMapper输入类型一致</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">35</span>               .withOutput(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text("03103"), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IntWritable(200))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">withOutput方法是输出    跟TemperatureMapper输出类型一致</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">36</span>               .runTest();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">runTest方法是调用运行方法</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">37</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">38</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong><span style="color:rgb(0,0,255);">&nbsp;TemperatureReduceTest.java代码</span></strong></span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.TemperatureTest;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.ArrayList;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.List;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mrunit.mapreduce.ReduceDriver;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.junit.Before;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.junit.Test;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * Reducer 单元测试，这里用MRUnit框架，需要使用mrunit-hadoop.jar
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span>  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span> @SuppressWarnings("all")<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">告诉编译器忽略指定的警告，不用在编译完成后出现警告信息</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> TemperatureReduceTest{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Reducer reducer;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义一个Reducer对象，是   reducer</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> ReduceDriver driver;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义一个ReduceDriver对象，是driver，因为是要ReduceDriver去做！</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span>     @Before<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">@Before是在所拦截单元测试方法执行之前执行一段逻辑，读艾特Before</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> init(){<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">初始化方法init</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span>         reducer = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Temperature.TemperatureReducer();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">实例化一个Temperature中的TemperatureReducer对象</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span>         driver = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> ReduceDriver(reducer);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">实例化ReduceDriver对象</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span>     @Test<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">@Test是测试方法提示符，一般与@Before搭配使用</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> test() <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span> IOException{<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">为了模拟在reduer端单元测试，所以需如下 </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span>         String key = "03103";<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">声明一个key值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span>         List values = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> ArrayList();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span>         values.add(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IntWritable(200));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">添加第一个value值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">33</span>         values.add(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IntWritable(100));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">添加第二个value值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">34</span>         driver.withInput(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text(key), values)<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">withInput方法是第一行输入        跟TemperatureReducer输入类型一致</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">35</span>               .withOutput(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text(key), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IntWritable(150))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">withOutput方法是输出        跟TemperatureReducer输出类型一致</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">36</span>               .runTest();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">runTest方法是调用运行方法</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">37</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">38</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong><span style="color:rgb(0,0,255);">TemperatureTest.java代码</span></strong></span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.TemperatureTest;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mrunit.mapreduce.MapReduceDriver;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.junit.Before;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.junit.Test;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * Mapper 和 Reducer 集成起来测试，这里用MRUnit框架
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span>  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span> @SuppressWarnings("all"<span style="font-size:12px;line-height:1.5;">)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> TemperatureTest {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Mapper mapper;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义一个Mapper对象</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Reducer reducer;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义一个Reducer对象    </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> MapReduceDriver driver;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义一个MapReduceDriver对象是driver，因为是对map和reducer联合起来测试，所以需要MapReduceDriver去做！</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span>     @Before<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">@Before是在所拦截单元测试方法执行之前执行一段逻辑，读艾特Before</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> init(){ <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">初始化方法init</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span>         mapper = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Temperature.TemperatureMapper();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">实例化一个Temperature中的TemperatureMapper对象</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span>         reducer = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Temperature.TemperatureReducer();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">实例化一个Temperature中的TemperatureReducer对象</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span>         driver = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> MapReduceDriver(mapper, reducer);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">实例化MapReduceDriver对象</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span>     @Test<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">@Test是测试方法提示符 </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> test() <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> RuntimeException, IOException{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输入两行行测试数据</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">33</span>         String line = "1985 07 31 02   200    94 10137   220    26     1     0 -9999"<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">34</span>         String line2 = "1985 07 31 11   100    56 -9999    50     5 -9999     0 -9999"<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">35</span>         driver.withInput(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> LongWritable(), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text(line))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">withInput方法是第一行输入     跟TemperatureMapper输入类型一致</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">36</span>               .withInput(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> LongWritable(), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text(line2))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第二行输入</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">37</span>               .withOutput(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text("03103"), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IntWritable(150))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">withOutput方法是输出    跟TemperatureReducer输出类型一致</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">38</span>               .runTest();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">runTest方法是调用运行方法</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">39</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">40</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212122621886-1342189679.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212122630261-263958023.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p><font><span style="font-size:14px;">本文转自大数据躺过的坑博客园博客，原文链接：http://www.cnblogs.com/zlslch/p/6164003.html，如需转载请自行联系原作者</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
