<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>使用 Visual Studio 2005 Team System 进行单元测试并生成用于 Unit Test Framework 的源代码... « NotBeCN</title>
  <meta name="description" content="                                  适用于：      Microsoft Visual Studio 2005 Team System Beta 2      Team Architect &amp; Team Test Editions      Microsoft Visua...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/26/weixin_34342578_90126721.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">使用 Visual Studio 2005 Team System 进行单元测试并生成用于 Unit Test Framework 的源代码...</h1>
    <p class="post-meta">Nov 26, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div>
    <br>
   </div> 
   <div> 
    <div class="ancestorLinks" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     适用于：
     <br> Microsoft Visual Studio 2005 Team System Beta 2
     <br> Team Architect &amp; Team Test Editions
     <br> Microsoft Visual C# 2005
    </div> 
    <div class="overview" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"> 
     <p style="font-size:13px;line-height:1.5;"><b>摘要：</b>&nbsp;Scott 详细介绍自动化单元测试的基本内容，以及由 Microsoft Visual Studio 2005 Team System 提供的 Unit Test Framework 中包含的代码生成引擎。</p> 
    </div> 
    <img title="" height="6" alt="*" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/3squares.gif" width="30" style="border:0px;">
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></div> 
    <h5 style="font-size:12px;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">本页内容</h5> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EZAA" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="简介" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_down.gif" width="7" style="border:0px;"></a></td> 
       <td class="onThisPage" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EZAA" rel="nofollow" style="color:#000080;text-decoration:none;">简介</a></td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EYAA" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="重新思考单元测试" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_down.gif" width="7" style="border:0px;"></a></td> 
       <td class="onThisPage" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EYAA" rel="nofollow" style="color:#000080;text-decoration:none;">重新思考单元测试</a></td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EXAA" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="输入自动化单元测试" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_down.gif" width="7" style="border:0px;"></a></td> 
       <td class="onThisPage" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EXAA" rel="nofollow" style="color:#000080;text-decoration:none;">输入自动化单元测试</a></td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EUAA" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="为什么生成代码？" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_down.gif" width="7" style="border:0px;"></a></td> 
       <td class="onThisPage" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EUAA" rel="nofollow" style="color:#000080;text-decoration:none;">为什么生成代码？</a></td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#ERAA" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="让我们生成一些代码吧！" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_down.gif" width="7" style="border:0px;"></a></td> 
       <td class="onThisPage" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#ERAA" rel="nofollow" style="color:#000080;text-decoration:none;">让我们生成一些代码吧！</a></td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EOAA" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="生成了什么？" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_down.gif" width="7" style="border:0px;"></a></td> 
       <td class="onThisPage" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EOAA" rel="nofollow" style="color:#000080;text-decoration:none;">生成了什么？</a></td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#ELAA" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="生成后：我现在需要做什么？" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_down.gif" width="7" style="border:0px;"></a></td> 
       <td class="onThisPage" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#ELAA" rel="nofollow" style="color:#000080;text-decoration:none;">生成后：我现在需要做什么？</a></td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EIAA" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="重新生成单元测试代码" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_down.gif" width="7" style="border:0px;"></a></td> 
       <td class="onThisPage" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EIAA" rel="nofollow" style="color:#000080;text-decoration:none;">重新生成单元测试代码</a></td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EFAA" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="自动化单元测试建议" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_down.gif" width="7" style="border:0px;"></a></td> 
       <td class="onThisPage" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EFAA" rel="nofollow" style="color:#000080;text-decoration:none;">自动化单元测试建议</a></td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EEAA" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="小结" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_down.gif" width="7" style="border:0px;"></a></td> 
       <td class="onThisPage" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#EEAA" rel="nofollow" style="color:#000080;text-decoration:none;">小结</a></td> 
      </tr>
     </tbody>
    </table>
    <a name="EZAA" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></a>
    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></span> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">简介</h2> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">随着业务的革新和发展，运行它们的系统也需要进行更新。随业务的发展、革新以及与合作伙伴、客户和供应商的结合，这些系统将在复杂性方面持续扩增。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">这种复杂性迫使 IT 的领导者们在开发过程中（即，在实现<i>之前</i>）确保质量。有一种方法可使开发人员减少进入 QA 环节的故障数量，即，针对自定义代码严格执行自动化单元测试。在开发过程中强制使用自动化单元测试可为团队成员提供有关如何使用自定义代码的示例（这些示例易于使用并自行记录）。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">使用结构化、自动化单元测试面临的挑战之一是完成这些任务所需的代码总数。（测试代码需要使用大量代码！）代码生成的概念（简单定义为“创建软件的软件”）正随着时间的快速推移而逐渐深入到团队 IT 开发之中。有些人认为代码生成有助于缩短“推向市场”策略的时间，强制内部标准/协定，并促进开发过程。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">Microsoft 认识到这一需要后提供了一个功能丰富、带有下一代开发平台 Visual Studio 2005 Team System (VSTS) 的代码生成引擎。本文提供针对单元测试代码生成的循序渐进的指导，并深入探讨如何在用例中使用。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"> 
     <a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="返回页首" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_up.gif" width="7" style="border:0px;"></a>
     <a class="topOfPage" href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;">返回页首</a> 
    </div> 
    <a name="EYAA" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></a>
    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></span> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">重新思考单元测试</h2> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">请考虑以下情况：您负责为公司生成下一代系统，同时您是较大的开发团队中的一员。您是 UI 开发人员，负责尽可能多地创建 Microsoft ASP.NET/Microsoft WinForms。您依赖“中间层”团队完成其中间层组件 — 这些组件用于执行数据库 CRUD (Create-Retrieve-Update-Delete) 以及与该系统中每个实体相关的业务规则。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">经过几周的 UI 开发，您完成了窗体并且收到了中间层开发人员打算向您提交其类库的消息。表 1 提供一段对话示例，说明我们大多数人在开发过程中都会遇到的一些事情。</p> 
    <table class="dataTable" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <thead>
      <tr>
       <td class="tableHeader" colspan="2" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">表 1. UI 开发人员和中间层开发人员间的示例对话</td>
      </tr>
     </thead>
     <tbody>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>中间层：</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">“这些对象随时供您使用 — 为此，只需获取 OurSystemBL.dll 的最新版本。”</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>UI</b><b>：</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">“谢谢。您有供我们查看文档吗？”</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>中间层：</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">“哈哈！是的，当然有！我们花了很多时间编写它！请查看 Design Document — 噢，请等一等，它还没有完成……（不久之后即可完成！）”</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>UI</b><b>：</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">“您使用 XML 文档了吗？”</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>中间层：</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">“在构造函数中，但许多方法都不使用。”</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>UI</b><b>：</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">“显示如何创建、执行并删除对象的示例代码，怎么样？”</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>中间层：</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">“我已经附加了一个示例 WinForms 应用程序（从我的工作区），它应该能够提供一些您所需的内容……，虽然它不在 Microsoft Visual SourceSafe 中。”</p> </td> 
      </tr>
     </tbody>
    </table>
    <div class="dataTableBottomMargin" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></div> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">在考虑如何进行这样<i>有趣的</i>&nbsp;项目之后，您打定了主意，决定检验中间层的单元测试套件。在深入钻研该代码之后，您注意到该窗体有两个未标记的文本框，以及三个标记为&nbsp;<b>button1</b>、<b>button2</b>&nbsp;和&nbsp;<b>button3</b>&nbsp;的按钮（幸运的话，它们将排列在窗体上）。接下来，在查看与这些按钮相关的事件之后，您认识到这些代码都未经注释，并且数据变量都被命名为 x、y、z。如果幸运，您还会注意到&nbsp;<b>button1</b>&nbsp;和&nbsp;<b>button2</b>&nbsp;执行该对象的&nbsp;<b>Save()</b>&nbsp;方法，而&nbsp;<b>button3</b>&nbsp;执行&nbsp;<b>Delete()</b>&nbsp;方法。执行时，您会接收到很多 System.Exception 错误，这是因为遗漏了很多配置设置。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">这显然是一个特例，我希望多数开发团队不要进行这一试验，下面让我们看一下该方案中“单元测试”遇到的问题：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">这种形式的单元测试代码不是结构化的：代码充斥到按钮单击事件中并且难以编译。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">这种形式的单元测试代码记录得不太好。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">这种形式的单元测试并不基于“已知”为好或坏的数据 — 它完全依赖于输入到那些未标记的文本框的内容。</p> 
        <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;">
         <tbody>
          <tr>
           <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
           <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">单元测试代码不能自动重复，它基于输入的代码。</p> </td> 
          </tr>
          <tr>
           <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
           <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">单元测试代码覆盖是未知的 — 用数据指示实际测试的代码量。</p> </td> 
          </tr>
         </tbody>
        </table></td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">实现的详细信息不易于在团队成员间进行传播。</p> </td> 
      </tr>
     </tbody>
    </table>
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"> 
     <a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="返回页首" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_up.gif" width="7" style="border:0px;"></a>
     <a class="topOfPage" href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;">返回页首</a> 
    </div> 
    <a name="EXAA" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></a>
    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></span> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">输入自动化单元测试</h2> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">xUnit 框架在 1998 年作为 eXtreme 编程的核心概念引入。它提出了一个有效的机制，有助于开发人员将结构化、有效且自动的单元测试添加常规开发活动中。从那以后，该框架演化为针对自动化单元测试框架的实际标准。</p> 
    <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">创建自动化单元测试的用例</h3> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">简单说，自动化单元测试是：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">结构化的。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">自行记录的。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">自动且可重复的。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">基于已知数据。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">旨在测试积极和消极操作。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">非常适合跨不同计算机的测试实现。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">配置、实现和执行的示例。</p> </td> 
      </tr>
     </tbody>
    </table>
    <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">xUnit 框架元素</h3> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">表 2 分析 xUnit 框架以及对应于 Visual Studio 2005 Team System 的 Unit Testing Framework 等价物的基本概念。</p> 
    <table class="dataTable" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <thead>
      <tr>
       <td class="tableHeader" colspan="3" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">表 2. 相应的 xUnit 框架和 VSTS Unit Testing Framework 概念</td>
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">xUnit 框架概念</td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">VS 2005 等价物（参见下面的属性）</td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;">描述</td> 
      </tr>
     </thead>
     <tbody>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">测试</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">TestMethod</p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">简单说，这些是您的测试。测试预期结果的逻辑，并报告未取得结果（如果有）。请将它看作您的“方法”。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">测试装置</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">TestClass</p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">针对大量测试的一个逻辑分组。请将它看作您的“类”。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">测试套件</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">测试列表 **</p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">针对大量测试装置的一个逻辑分组。请将它看作您的“类库”。</p> <p style="font-size:13px;line-height:1.5;"><b>注不需要一个属性。</b></p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">测试运行器</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">VS 2005 VSTS Unit Testing Framework</p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">GUI/Console 应用程序负责发现、执行和报告测试结果。Visual Studio 2005 Team System 将作为本文的测试运行器。</p> </td> 
      </tr>
     </tbody>
    </table>
    <div class="dataTableBottomMargin" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></div> 
    <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">测试装置示例</h3> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">请考虑以下针对&nbsp;<b>BankAccount</b>&nbsp;类的类关系图，以及一个示例测试装置 (BankAccountTests.cs)。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;width:169px;"> 
     <img height="221" alt="" src="http://www.microsoft.com/china/msdn/library/langtool/vsts/art/unittests_fig01.gif" width="169" style="border:0px;">
     <br>
     <p style="font-size:13px;line-height:1.5;"><b>图</b><b>&nbsp;1. BankAccount&nbsp;</b><b>类</b></p> 
     <div class="figureRule"></div> 
    </div> 
    <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">示例测试装置： BankAccountTests.cs</h3> 
    <pre class="codeSample">using BankAccountDemo.Business;
using Microsoft.VisualStudio.QualityTools.UnitTesting.Framework;
namespace BankAccountDemo.Business.Tests
{
    [TestClass()]
    public class BankAccountTest
    {
        [TestInitialize()]
        public void Initialize()    {
        }
        [TestCleanup()]
        public void Cleanup()   {
        }
        [TestMethod()]
        public void ConstructorTest()   {
            float currentBalance = 500; 
            BankAccount target = new BankAccount(currentBalance);
            Assert.AreEqual(currentBalance, target.CurrentBalance, 
                "Balances are not equal upon creation");
        }
        [TestMethod()]
        public void DepositMoneyTest()  {
            float currentBalance = 500; 
            BankAccount target = new BankAccount(currentBalance);
            float depositAmount = 10; 
            target.DepositMoney(depositAmount);
            Assert.IsTrue( (currentBalance + depositAmount) &gt;  
                            target.CurrentBalance, 
               "Deposit not applied correctly");
        }
        [TestMethod()]
        public void MakePaymentTest()   {
            float currentBalance = 500; 
            BankAccount target = new BankAccount(currentBalance);
            float paymentAmount = 250; 
            target.MakePayment(paymentAmount);
            Assert.IsTrue(currentBalance - paymentAmount == 
              target.CurrentBalance, 
                "Payment not applied correctly");
        }
    }
}
</pre> 
    <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">主单元测试概念 == 断言</h3> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">用于该形式单元测试的主要概念是，自动化单元测试是基于“断言”的，即可定义为“事实或您相信为事实的内容”。从逻辑角度看，请考虑该语句“when I do {x}, I expect {y} as a result”。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">这可以轻松地翻译为代码，方法是使用 Microsoft.VisualStudio.QualityTools.UnitTesting.Framework 命名空间中可用的三个“断言”类中的任一个：<b>Assert</b>、<b>StringAssert</b>&nbsp;和&nbsp;<b>CollectionAssert</b>。主类&nbsp;<b>Assert</b>&nbsp;提供用于测试基础条件语句的断言。<b>StringAssert</b>&nbsp;类自定义了在使用字符串变量时有用的断言。同样，<b>CollectionAssert</b>&nbsp;类包括在使用对象集合时有用的断言方法。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">表 3 显示可用于当前版本 Unit Testing Framework 的断言。</p> 
    <table class="dataTable" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <thead>
      <tr>
       <td class="tableHeader" colspan="3" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">表 3. VSTS Unit Testing Framework 断言</td>
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">断言类</td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">StringAssert 类</td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;">CollectionAssert 类</td> 
      </tr>
     </thead>
     <tbody>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="codeSample">AreEqual() 
AreNotEqual() 
AreNotSame() 
AreSame() 
EqualsTests() 
Fail() 
GetHashCodeTests() 
Inconclusive() 
IsFalse() 
IsInstanceOfType() 
IsNotInstanceOfType() 
IsNotNull() 
IsNull() 
IsTrue()
</pre></td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"><pre class="codeSample">Contains() 
DoesNotMatch() 
EndsWith() 
Matches() 
StartsWith()
</pre></td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"><pre class="codeSample">AllItemsAreInstancesOfType() 
AllItemsAreNotNull() 
AllItemsAreUnique() 
AreEqual() 
AreEquivalent() 
AreNotEqual()
AreNotEquivalent()
Contains()
DoesNotContain() 
IsNotSubsetOf()
IsSubsetOf()
</pre></td> 
      </tr>
     </tbody>
    </table>
    <div class="dataTableBottomMargin" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></div> 
    <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">这些自动化单元测试用什么运行？</h3> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;"><b>正如前面提到的，</b>xUnit 框架将“测试运行器”的概念定义为应用程序负责：(a) 执行单元测试；(b) 报告测试结果。对于本文，包含 Visual Studio 2005 Team System (VSTS) 的 Unit Testing 引擎作为我们的“测试运行器”。图 2 表示&nbsp;<b>BankAccountTests.cs</b>&nbsp;类的执行结果。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;width:483px;"> 
     <img height="201" alt="" src="http://www.microsoft.com/china/msdn/library/langtool/vsts/art/unittests_fig02.gif" width="483" style="border:0px;">
     <br>
     <p style="font-size:13px;line-height:1.5;"><b>图</b><b>&nbsp;2.&nbsp;</b><b>测试结果窗格：单元测试执行结果</b></p> 
     <div class="figureRule"></div> 
    </div> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">Microsoft Visual Studio 2005 使用源项目的代码模型动态填充该视图。它基于该源代码中的自定义属性动态发现有关该测试套件的信息。表 4 表示最常见的单元测试属性（以及执行的次序）。</p> 
    <table class="dataTable" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <thead>
      <tr>
       <td class="tableHeader" colspan="2" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">表 4. 常见单元测试属性</td>
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">属性</td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;">描述</td> 
      </tr>
     </thead>
     <tbody>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>TestClass()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">该属性表示一个测试装置。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>TestMethod()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">该属性表示一个测试用例。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>AssemblyInitialize()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">在执行为执行选择的第一个&nbsp;<b>TestClass()</b>&nbsp;中的第一个&nbsp;<b>TestMethod()</b>&nbsp;之前，执行带有该属性的方法。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>ClassInitialize()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">带有该属性的方法在执行第一个测试之前调用。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>TestInitialize()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">带有该属性的方法在执行每个&nbsp;<b>TestMethod()</b>&nbsp;之前调用。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>TestCleanup()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">带有该属性的方法在执行每个&nbsp;<b>TestMethod()</b>&nbsp;之后调用。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>ClassCleanup()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">带有该属性的方法在执行 ALL 测试之后调用。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>AssemblyCleanup()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">在执行为执行选择的第一个&nbsp;<b>TestClass()</b>&nbsp;中的第一个&nbsp;<b>TestMethod()</b>&nbsp;之后，执行带有该属性的方法。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>Description()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">提供关于给定&nbsp;<b>TestMethod()</b>&nbsp;的描述。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>Ignore()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">由于某种原因忽略&nbsp;<b>TestMethod()</b>&nbsp;或&nbsp;<b>TestClass()</b>。</p> </td> 
      </tr>
      <tr>
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>ExpectedException()</b></p> </td> 
       <td style="font-size:12px;border-width:1px;border-style:solid;border-color:#C0C0C0 #C0C0C0 #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">当测试特定异常时，如果使用该属性指定的异常不是从实现代码引发，则测试不会失败。</p> </td> 
      </tr>
     </tbody>
    </table>
    <div class="dataTableBottomMargin" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></div> 
    <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">我编写什么类型的测试？</h3> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">一个方法及其相关测试之间很难有一对一关系。编写自动化单元测试需要开发人员“进行全面思考”，并了解关于对象的所有内容 — 它将如何消耗、使用、处理，以及在任何情况下如何起到积极、消极、非决定性作用。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">例如，请考虑一个用于针对数据库中 Customer 项执行 CRUD（创建、检索、更新、删除）功能的典型对象方法。对于该对象的&nbsp;<b>Load()</b>&nbsp;方法，要针对以下方案编写测试：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>构造函数测试</b>&nbsp;— 确保对象正确加载，带有正确的信息。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>PositiveLoadScalarTest</b>&nbsp;— 测试数据库中一个 Customer 的成功加载。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>NegativeLoadScalarTest</b>&nbsp;— 测试一个 Customer 的失败加载，即该 Customer 不在数据库中。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>PositiveLoadTest</b>&nbsp;— 基于已知数据测试 Customer 的成功加载。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>NegativeLoadTest</b>&nbsp;— 测试数据库中不存在的 Customer 的失败加载。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>NegativeValidationTest</b>&nbsp;— 确保验证逻辑正确工作。</p> </td> 
      </tr>
     </tbody>
    </table>
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">这些只是自动化单元测试套件许多用法中的一部分。我曾经听说一个小团队使用单元测试查看针对其组件的已知安全攻击。从宏观的角度来看，单元测试应该明确保证组件的正常使用。具有丰富的测试集将使团队确信您已经准确实现了既定的目标：编写有效的软件。无论自信源自哪里 — 这就是您需要编写的测试。</p> 
    <h4 style="font-size:14px;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">您测试什么？</h4> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">从本质上看，这些自动化单元测试非常低级。它们旨在测试下至构造函数、方法调用的对象，甚至是对象上的属性。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">关于“公共对私有”的主题在单元测试派系中引发了许多争论。许多人认为单元测试只应该测试对象的公共接口。其他人认为应该测试每个调用 — 包括内部私有方法。VSTS 支持两个单元测试级别。VSTS 通过使用私有访问器或包装类支持私有测试，后者提供基于“私有”方法和属性生成单元测试的功能。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"> 
     <a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="返回页首" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_up.gif" width="7" style="border:0px;"></a>
     <a class="topOfPage" href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;">返回页首</a> 
    </div> 
    <a name="EUAA" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></a>
    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></span> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">为什么生成代码？</h2> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">阅读上面的列表后，您可能会想起前面项目的单个对象，并思考：“如果我用“这些”对象进行该操作，就需要编写大量代码！”请考虑开发人员仍编写“单元测试”代码的事实 — 只在不同的窗体（例如，前面提到的 WinForms 示例）上进行。此外，具有可自行记录、可重用的实现示例带来的好处远大于生成更多代码所带来的麻烦。最后，在单元测试中设计更多的环节已证明可以减少质量保证环节中的故障。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">正如前面所提到的，代码生成是“软件创建软件”的过程。基于可重复的过程创建代码是理想的。例如，一些使用代码生成的较好示例包括：脚本数据、创建表示实体及其在储存库（数据库 CRUD）中存在的对象，或者创建适用于数据维护的 UI 控件。使用代码生成的好处包括：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>节省时间</b>&nbsp;— 为什么花几小时/天/周创建一些在几秒/分钟内就可以创建的内容？</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>强制标准</b><b>/</b><b>约定</b><b></b>— 对于强制您的标准和命名约定而言，没有什么比消除开发中的人员因素并依赖基于“您的”规则的可重复过程更好的了。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>测试私有方法的功能</b>&nbsp;— 正如本文前面提到的，Unit Testing Framework 提供使用“私有访问器”类测试私有方法的功能。该代码生成引擎创建与这些访问器类相关的所有“基础代码”。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>获取现有组件的信息</b>&nbsp;— 搜索另一个开发人员的组件吗？基于这些组件生成代码可能提供关于该实现以及该对象接口的简明示例。此外，进行设计并在编码之前“清除”其对象的公共接口（例如，通过使用 VS 2005 类设计器）的开发人员将极大地受益于代码生成引擎。</p> </td> 
      </tr>
     </tbody>
    </table>
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">正如您所预期的，自动化单元测试属于“优秀代码生成候选者”。在现有组件中指出一些内容并针对这些自动单元测试生成初始代码难道不是很理想吗？而且不只是保留单元测试框架，还会围绕对象的公共接口生成实现示例吗？将来的 Visual Studio 2005 Team System 用户将拥有该功能以及更多功能！</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"> 
     <a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="返回页首" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_up.gif" width="7" style="border:0px;"></a>
     <a class="topOfPage" href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;">返回页首</a> 
    </div> 
    <a name="ERAA" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></a>
    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></span> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">让我们生成一些代码吧！</h2> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">本例中，我们将生成本文前面提到的&nbsp;<b>BankAccount</b>&nbsp;类的代码。本文的这一部分旨在为您介绍代码生成过程，并重点介绍所提供的功能以及从 VSTS 使用 Unit Testing 引擎的好处。</p> 
    <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">第 1 步：创建您的实现代码</h3> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">首先，我们创建一个将用作应用程序的业务层的类库项目。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">要在 VS 2005 中创建该库：</p> 
    <table class="numberedList" border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listNumber" align="right" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">1.</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">启动 Visual Studio 2005 Beta 2。</p> </td> 
      </tr>
      <tr>
       <td class="listNumber" align="right" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">2.</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">单击&nbsp;<b>File</b>&nbsp;|&nbsp;<b>New</b>&nbsp;|&nbsp;<b>Project</b>。</p> </td> 
      </tr>
      <tr>
       <td class="listNumber" align="right" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">3.</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">选择您选定的语言&nbsp;<b>Windows</b>，并选择&nbsp;<b>Class Library</b>&nbsp;项目模板。</p> </td> 
      </tr>
      <tr>
       <td class="listNumber" align="right" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">4.</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">将&nbsp;<b>Name</b>&nbsp;和&nbsp;<b>Solution Name</b>&nbsp;设置为&nbsp;<b>BankAccountDemo.Business</b>，选择一个位置，并单击&nbsp;<b>OK</b>&nbsp;来创建该类库。</p> </td> 
      </tr>
     </tbody>
    </table>
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">VS 2005 创建该类后，下一个任务就是创建针对您的项目设计的&nbsp;<b>BankAccount</b>&nbsp;类。为此，需要执行以下操作：</p> 
    <table class="numberedList" border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listNumber" align="right" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">1.</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">在解决方案资源管理器中单击右键，并单击&nbsp;<b>Delete</b>，从项目中移除该文件并将其从硬盘中删除。</p> </td> 
      </tr>
      <tr>
       <td class="listNumber" align="right" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">2.</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">右键单击&nbsp;<b>BankAccountDemo.Business</b>&nbsp;项目，然后单击&nbsp;<b>Add</b>，之后单击&nbsp;<b>Class</b>。</p> </td> 
      </tr>
      <tr>
       <td class="listNumber" align="right" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">3.</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">选择文件名&nbsp;<b>BankAccount.cs</b>，并单击&nbsp;<b>Add</b>&nbsp;创建类文件。</p> </td> 
      </tr>
      <tr>
       <td class="listNumber" align="right" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">4.</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">针对 BankAccount.cs 文件对代码进行以下更改。</p> </td> 
      </tr>
     </tbody>
    </table>
    <pre class="codeSample">using System;
using System.Collections.Generic;
using System.Text;

namespace BankAccountDemo.Business
{
    public class BankAccount
    {
        // Properties
        private float _currentBalance;

        public float CurrentBalance
        {
            get { return _currentBalance; }
        }

        // Constructors
        public BankAccount(float initialBalance)
        {
            this._currentBalance = initialBalance;
        }

        // Methods
        public void DepositMoney(float depositAmount)
        {
            this._currentBalance += depositAmount;
        }

        public void MakePayment(float paymentAmount)
        {
            this._currentBalance -= paymentAmount;
        }
    }

}
</pre> 
    <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">第 2 步：生成您的初始单元测试代码</h3> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">由于 Unit Testing 引擎内置于 Visual Studio 2005 Team System，因此生成代码比以前更容易。除了生成单元测试结构之外，它将生成特定于实例的信息，例如，对象创建、类型化参数和方法执行。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">VS 2005 提供在任何类结构级别生成单元测试代码的功能，这些级别包括命名空间、类、方法、属性、构造函数，等等。可通过右键单击这些代码元素并单击&nbsp;<b>Generate test(s)</b>（图 3）进行此操作。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;width:383px;"> 
     <img height="324" alt="" src="http://www.microsoft.com/china/msdn/library/langtool/vsts/art/unittests_fig03.gif" width="383" style="border:0px;">
     <br>
     <p style="font-size:13px;line-height:1.5;"><b>图</b><b>&nbsp;3. Generate test(s)&nbsp;</b><b>方法</b></p> 
     <div class="figureRule"></div> 
    </div> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">因此，要开始代码生成过程，请执行以下步骤：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">右键单击该类名&nbsp;<b>BankAccount</b>&nbsp;并单击&nbsp;<b>Create Tests</b>。</p> </td> 
      </tr>
     </tbody>
    </table>
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">现在，应该为您提供&nbsp;<b>Generate Unit Tests</b>&nbsp;对话框（如图 4 所示）。该对话框及其组件提供对该过程中生成的代码进行自定义的功能。让我们看一下所有这些元素。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;width:450px;"> 
     <img height="332" alt="" src="http://www.microsoft.com/china/msdn/library/langtool/vsts/art/Unittests_fig04S.gif" width="450" style="border:0px;">
     <br>
     <p style="font-size:13px;line-height:1.5;"><b>图</b><b>&nbsp;4.&nbsp;</b><b>生成</b><b>&nbsp;Unit Tests&nbsp;</b><b>对话框</b></p> 
     <div class="figureRule"></div> 
    </div> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;"><b>Current selection:</b>&nbsp;树视图允许导航自定义类及其元素。VS 2005 使用反射填充该树视图，并在右键单击以及单击&nbsp;<b>Create Tests</b>&nbsp;的位置自动选择组件。图 3 中，由于我在类级别进行了此操作，因此该对话框自动选择用于代码生成的所有类元素。如果选择在单个级别（即，构造函数、属性或方法）进行生成，则只选择那些元素。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;"><b>Filter</b>&nbsp;选项（位于右上角）提供修改树视图（图 5）中所示结果的功能，包括显示非公共项、基类型以及“只属于我的代码”。如果使用的是大型解决方案，或者感觉显示私有的内部结构会弄乱选择窗口，那么这对您很有益处。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;width:290px;"> 
     <img height="138" alt="" src="http://www.microsoft.com/china/msdn/library/langtool/vsts/art/unittests_fig05.gif" width="290" style="border:0px;">
     <br>
     <p style="font-size:13px;line-height:1.5;"><b>图</b><b>&nbsp;5.&nbsp;</b><b>筛选选择结果</b></p> 
     <div class="figureRule"></div> 
    </div> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">下一个是&nbsp;<b>Output project</b>&nbsp;对话框（位于&nbsp;<b>Current selection:</b>&nbsp;树视图下）。该列表框允许您针对生成的测试装置选择目的项目（图 6）。如果您的解决方案包含以前创建的测试项目，则将包含该测试项目以供选择。由于这是我们首次访问该对话框，因此可以选择&nbsp;<b>Create a new&nbsp;</b>…<b>&nbsp;Test Project</b>&nbsp;选项。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;width:450px;"> 
     <img height="67" alt="" src="http://www.microsoft.com/china/msdn/library/langtool/vsts/art/Unittests_fig06S.gif" width="450" style="border:0px;">
     <br>
     <p style="font-size:13px;line-height:1.5;"><b>图</b><b>&nbsp;6.&nbsp;</b><b>输出项目选择</b></p> 
     <div class="figureRule"></div> 
    </div> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">要继续我们的过程，请执行以下操作：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">基于您选择的语言选择&nbsp;<b>Create a new {0} Test Project</b>。</p> </td> 
      </tr>
     </tbody>
    </table>
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">最后，该对话框提供通过&nbsp;<b>Settings</b>&nbsp;按钮（位于左下角）自定义代码生成过程的功能。单击该按钮将加载&nbsp;<b>Test Generation Settings</b>&nbsp;对话框，如图 7 所示。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;width:315px;"> 
     <img height="336" alt="" src="http://www.microsoft.com/china/msdn/library/langtool/vsts/art/unittests_fig07.gif" width="315" style="border:0px;">
     <br>
     <p style="font-size:13px;line-height:1.5;"><b>图</b><b>&nbsp;7. Test Generation Settings&nbsp;</b><b>对话框</b></p> 
     <div class="figureRule"></div> 
    </div> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">该对话框允许您进行以下更改：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">更改命名约定，它们用于生成针对文件、类（测试装置）和方法（测试）的名称。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">打开/关闭使所有测试结果在默认情况下为 Inconclusive 的功能。选择该选项将在每个生成的&nbsp;<b>Test()</b>&nbsp;方法中包含以下占位符语句。</p> <pre class="codeSample">Assert.Inconclusive("TODO: Implement code to verify target");
</pre> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">打开/关闭启用生成警告的功能 — 即，如果在代码生成过程中出现任何警告，都要进行报告。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">在全局范围内限制所有类型。该设置通知代码生成引擎将一个全局限定符（在 Microsoft Visual C# 2005 中是&nbsp;<b>global::</b>）添加到变量声明中。当在多个命名空间中具有名称相似的对象时，请使用该设置。否则，代码生成引擎将创建逻辑来创建该对象，但是编译器不能确定创建哪个类，因此会产生错误。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">启用/禁用针对已具有测试的项生成测试的功能。下面我们将讨论关于后续代码生成尝试的主题。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">启用/禁用文档注释。这允许您在使用每个&nbsp;<b>Test()</b>&nbsp;方法时禁用 XML 文档的创建</p> </td> 
      </tr>
     </tbody>
    </table>
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">要完成我们的配置并生成单元测试代码（以及更多），请执行以下操作：</p> 
    <table class="numberedList" border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listNumber" align="right" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">1.</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">单击&nbsp;<b>OK</b>&nbsp;按钮开始代码生成过程。</p> </td> 
      </tr>
      <tr>
       <td class="listNumber" align="right" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">2.</p> </td> 
       <td style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">输入名称&nbsp;<b>BankAccountDemo.Business.Test</b>&nbsp;作为新项目名，并单击&nbsp;<b>Create</b>&nbsp;按钮完成该过程。</p> </td> 
      </tr>
     </tbody>
    </table>
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">VS 2005 将显示一个进度栏，提供代码生成过程中的状态。该过程将在几秒钟内完成，您可以看到一个名为&nbsp;<b>BankAccountTest.cs</b>&nbsp;的类。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"> 
     <a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="返回页首" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_up.gif" width="7" style="border:0px;"></a>
     <a class="topOfPage" href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;">返回页首</a> 
    </div> 
    <a name="EOAA" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></a>
    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></span> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">生成了什么？</h2> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">在我们对该测试装置进行特别查看之前，让我们看一下在代码生成过程中创建了什么。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">首先，它创建了 Test Class Library 项目 BankAccountDemo.Business.Test。请注意该项目如何包含对实现类&nbsp;<b>BankAccountDemo.Business</b>（您从其中生成代码）和&nbsp;<b>Microsoft.VisualStudio.QualityTools.UnitTestFramework</b>&nbsp;类库的引用。在查看该类的内容时，您将注意到以下文件：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>AuthoringTests.txt</b>&nbsp;— 这是一些信息性的内容，定义如何使用单元测试（打开、查看、运行、查看结果、更改测试的运行方式），以及 VSTS 中包含的不同测试类型的定义。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>ManualTest1.mht</b>&nbsp;— 这是 VSTS 中使用的手动测试套件，用于执行测试并报告结果。手动测试是 VSTS 支持的一个附加测试类型。有关更多信息，请参阅 MSDN 资源库的“手动测试”主题。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>UnitTest1.cs</b>&nbsp;— 这是一个引用类，它只提供一个基单元测试（包括 TestClass、TestInitialize、TestCleanup 和 TestMethod 的定义）。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>BankAccountTest.cs</b>&nbsp;— 这是特定于程序集生成的单元测试代码。让我们仔细看看该代码，它是代码生成过程中最重要的部分。</p> </td> 
      </tr>
     </tbody>
    </table>
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">由 Unit Testing 引擎生成的类包括以下组件：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>Using</b>/<b>imports</b>&nbsp;语句，用于引用的程序集。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>TestClass()</b>&nbsp;定义，用于包含该测试的类 (<b>BankAccountTestFixture</b>)。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">一个私有访问器和用于 TestContext 的公共属性。它由单元测试运行器（即 VSTS Unit Test Framework）使用，以便提供关于当前测试运行的信息以及用于该运行的功能。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>TestInitialize()</b>&nbsp;和&nbsp;<b>TestCleanup()</b>&nbsp;方法。这些方法常用于获取和释放测试所需的任何对象。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>TestMethod()</b>，用于每个选定的方法。</p> </td> 
      </tr>
     </tbody>
    </table>
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">让我们仔细看一下&nbsp;<b>DepositMoneyTest()</b>，它负责确保当前的平衡能反映原始数量与累计数量的总和。</p> 
    <pre class="codeSample">/// 
///A test case for DepositMoney (float)
///
[TestMethod()]
public void DepositMoneyTest()
{
float initialBalance = 0; // TODO: Initialize to an appropriate value
BankAccount target = new BankAccount(initialBalance);
float depositAmt = 0; // TODO: Initialize to an appropriate value
target.DepositMoney(depositAmt);
Assert.Inconclusive("A method that does not return a value" +
   "cannot be verified.");
}
</pre> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">请注意该生成引擎除创建一个 stub&nbsp;<b>TestMethod()</b>&nbsp;对象外，是如何进行其他操作的。它创建了适用于接口的示例单元测试，包括：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>BankAccount</b>&nbsp;对象的分配和结构（测试的对象主题）</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">本地变量的创建和默认分配，这些变量表示作为该测试主题的方法/构造函数所需的参数。</p> 
        <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;">
         <tbody>
          <tr>
           <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
           <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">TODO 注释，提醒开发人员适当地分配参数变量。</p> </td> 
          </tr>
         </tbody>
        </table></td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">如果测试基于一个源对象方法调用，则生成的代码将包含对该方法（带有用于这些参数的局部变量）的调用。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">初始&nbsp;<b>Assert()</b>&nbsp;方法调用，基于该方法的返回值。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;"><b>Assert.Inconclusive()</b>&nbsp;方法调用，作为完成测试代码的提示程序。非确定性测试将在&nbsp;<b>Test Results</b>&nbsp;对话框中显示为失败。</p> </td> 
      </tr>
     </tbody>
    </table>
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"> 
     <a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="返回页首" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_up.gif" width="7" style="border:0px;"></a>
     <a class="topOfPage" href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;">返回页首</a> 
    </div> 
    <a name="ELAA" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></a>
    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></span> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">生成后：我现在需要做什么？</h2> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">考虑要完成相同的操作可以不必做哪些事情，则通常可以认识到代码生成的好处。在我们的示例中，我们不必：</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">创建单元测试项目。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">设置项目引用。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">添加适当的测试类（一个或多个）。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">生成主干 Unit Test Framework 类和属性。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">创建单个测试方法。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">创建特定于接口的逻辑。</p> </td> 
      </tr>
     </tbody>
    </table>
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">由于代码生成过程创建了特定于对象接口的示例单元测试，因此我们接近于初始测试的完成阶段了。通常情况下，只需“填充空白”并完成断言（一个或多个），方法是将“已知的数据值”分配给属性变量并创建适当的&nbsp;<b>Assert()</b>&nbsp;方法。显然，这不是针对所有测试的示例，特别是对具有多个断言的复杂测试而言。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">只需几秒钟的时间（使用相对较少的击键），您就能够将生成的单元测试代码转换为这些实际的测试。</p> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">例如，请考虑我们以如下方式开始。</p> 
    <pre class="codeSample">[TestMethod()]
public void DepositMoneyTest()
{
float initialBalance = 0; // TODO: Initialize to an appropriate value
BankAccount target = new BankAccount(initialBalance);
float depositAmt = 0; // TODO: Initialize to an appropriate value
target.DepositMoney(depositAmt);
Assert.Inconclusive("A method that does not return a value " + 
  "cannot be verified.");
}
</pre> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">我们能够完成相对容易且具有有限击键的测试（更改部分用黑体表示）。</p> 
    <pre class="codeSample">[TestMethod()]
public void DepositMoneyTest()  {
float currentBalance = 500; 
BankAccount target = new BankAccount(currentBalance);
float depositAmt = 10; 
target.DepositMoney(depositAmt);
Assert.AreEqual(currentBalance + depositAmt, target.CurrentBalance, 
                  "Deposit Test: Deposit not applied correctly");
}
</pre> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"> 
     <a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="返回页首" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_up.gif" width="7" style="border:0px;"></a>
     <a class="topOfPage" href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;">返回页首</a> 
    </div> 
    <a name="EIAA" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></a>
    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></span> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">重新生成单元测试代码</h2> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">好消息是，代码生成过程不会让您重写以前生成（和修改）的单元测试。使用 Visual Studio 2005 Team System 的 Beta 2 版本，代码生成选项提供一个启用/禁用创建已存在测试的复选框。如果选择它，而且该过程找到了一个具有相同名称的现有测试，则该过程将忽略该测试方法，并创建后续测试，从而将一个数字附加到该方法名的末尾。这通常在对象中使用重载的方法或构造函数时发生，或者当单击&nbsp;<b>Generate</b>&nbsp;按钮而不取消选定现有测试时发生。</p> 
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"> 
     <a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="返回页首" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_up.gif" width="7" style="border:0px;"></a>
     <a class="topOfPage" href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;">返回页首</a> 
    </div> 
    <a name="EFAA" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></a>
    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></span> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">自动化单元测试建议</h2> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">虽然本节可以独立成文，但这里只是一些您在创建单元测试时可以采纳的基本建议。</p> 
    <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;">
     <tbody>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">设计彼此独立的单元测试，其中它们可以独立运行（由于可以通过测试 UI 随意选择或取消选定它们）。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">不要只进行正面测试。请确保代码能够响应任何方案，包括发生意外时（资源不可用，数据库只读等）。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">把自己当作一个 QA 人员，想象成一个测试人员，而不仅仅是一个开发人员。您花在设计单元测试上的时间将有助于减少日后解决故障所用的时间。请注意对象的几个小细节：数据如何在对象之间传输？谁使用它们？销毁对象容易吗？如果我“进行此操作”，将会发生什么？</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">跳出您自己的思维模式。尽可能多地对测试进行头脑风暴。当您完成时，回头查看您可能漏掉的内容。来自团队成员的请求反馈 — 例如，他们创建了什么其他类型的测试？其他人可能提供一个对熟悉自己代码的开发人员而言非常困难的观点。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">代码覆盖。使用 VSTS 代码覆盖规范提供有关每个测试运行中实际执行多少代码的信息（代码的行数，占所有代码的百分比）。如果编码完成，并且通过了所有测试，但代码覆盖显示只执行了该逻辑的一小部分，那么您的测试真的成功了吗？高代码覆盖不一定意味着您具有一个完整的“测试”集，而未覆盖的代码通常非常适用于一个新的测试用例。</p> </td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">当生成单元测试时，要帮助其他人了解您的代码：</p> 
        <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;">
         <tbody>
          <tr>
           <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
           <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">使用一个项目结构，该结构映射所测试程序集的结构。</p> <p style="font-size:13px;line-height:1.5;">每个程序集有一个相关的测试程序集。</p> <p style="font-size:13px;line-height:1.5;">每个类有一个相关的测试类。</p> <p style="font-size:13px;line-height:1.5;">在各自的测试方法中包含每个方法名（即，<b>Load()</b>&nbsp;将有&nbsp;<b>PositiveLoadTest()</b>、<b>NegativeLoadTest()</b>、<b>PositiveScalarLoadTest()</b>&nbsp;等的测试方法）。</p> </td> 
          </tr>
          <tr>
           <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
           <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">使用一致的命名协定，包括对象的属性和方法名。</p> </td> 
          </tr>
         </tbody>
        </table></td> 
      </tr>
      <tr>
       <td class="listBullet" valign="top" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;">•</td> 
       <td class="listItem" style="font-size:12px;border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="font-size:13px;line-height:1.5;">此外，当其他所有测试都失败时，请进行调试。自动化单元测试应该有助于减少您用在调试器上的时间。但是，如果测试结果和代码覆盖无法提供测试失败的原因，那么您大可不必担心调试单元测试。从 Beta 2 版的 Visual Studio 2005 Team System 开始，开发人员可以使用 Test Manager 中的&nbsp;<b>Debug checked tests</b>&nbsp;选项调试他们的单元测试程序集。</p> </td> 
      </tr>
     </tbody>
    </table>
    <div style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"> 
     <a href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;"><img height="9" alt="返回页首" src="http://www.microsoft.com/library/gallery/templates/MNP2.Common/images/arrow_px_up.gif" width="7" style="border:0px;"></a>
     <a class="topOfPage" href="http://www.microsoft.com/china/msdn/library/langtool/vsts/UTFwVS05TmSys.mspx#top" rel="nofollow" style="color:#000080;text-decoration:none;">返回页首</a> 
    </div> 
    <a name="EEAA" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></a>
    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:13px;"></span> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">小结</h2> 
    <p style="font-size:13px;line-height:1.5;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">自动化单元测试为开发环节提供了一个结构化、自行纪录、高度便携且可重复的过程。如果在搜索现有程序集，或者如果开发环境需要在开始开发之前进行完整的设计，则请考虑使用内置到 Microsoft Visual Studio 2005 Team System 中的代码生成引擎。Visual Studio 2005 Team System 的单元测试代码生成功能可以为您节省宝贵的时间，而且有助于强制团队的开发标准和约定。通过生成用于自动化单元测试的基本内容，包括生成带有对象创建的测试方法、参数变量和基断言类，您应该能够顺利地在您的开发方法论中采用自动化单元测试。</p> 
    <p style="line-height:1.5;"><font><span style="font-size:13.3333px;"><br></span></font></p> 
    <p style="line-height:1.5;"><font><span style="font-size:13.3333px;"><br></span></font></p> 
    <p style="line-height:1.5;"><font><span style="font-size:13.3333px;"><br></span></font></p> 
    <p style="line-height:1.5;"><font><span style="font-size:13.3333px;">本文转自高海东博客园博客，原文链接：http://www.cnblogs.com/ghd258/archive/2005/12/01/288400.html，如需转载请自行联系原作者</span></font></p> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
