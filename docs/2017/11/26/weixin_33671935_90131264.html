<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Dojo入门：增强的Ajax功能 « NotBeCN</title>
  <meta name="description" content="                             随着Web技术的发展，RIA似乎已经成了主流，Ajax也随之成了不可或缺的部分。Ajax是异步的javascript和Xml，虽然现在很多交互的数据格式都不再严格的采用XML，但这种异步的操作却越来越流行了。目前主流的JS工具包都包含了Ajax的功能，do...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/26/weixin_33671935_90131264.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Dojo入门：增强的Ajax功能</h1>
    <p class="post-meta">Nov 26, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div>
    <br>
   </div> 
   <div> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">随着Web技术的发展，RIA似乎已经成了主流，Ajax也随之成了不可或缺的部分。Ajax是异步的javascript和Xml，虽然现在很多交互的数据格式都不再严格的采用XML，但这种异步的操作却越来越流行了。目前主流的JS工具包都包含了Ajax的功能，dojo也有自己的Ajax框架XHR。</p> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">XHR框架</h2> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">XHR框架是dojo对ajax支持的一组方法，允许想服务器端发出get、post、put、delete请求，这些方法包括：</p> 
    <ul style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">
     <li style="list-style:disc;">xhrGet</li> 
     <li style="list-style:disc;">xhrPost</li> 
     <li style="list-style:disc;">xhrPut</li> 
     <li style="list-style:disc;">xhrDelete</li> 
    </ul>
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">所有这些函数都遵守相同的语法：接受一个属性配置对象作为参数。在这些对象中您可以定义您想要发出的 Ajax 请求的各个方面。再一次说明，这些选项在所有 XHR 函数中都是一样的。</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">比较常用的选项：</p> 
    <ul style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">
     <li style="list-style:disc;">url：这是 HTTP 请求的 URL。它必须和发出这一请求的页面有同样的域和端口组合。</li> 
     <li style="list-style:disc;">handleAs：允许您定义响应的处理格式，默认是 text，但是，json、javascript、xml、还有一些其他选项也可用。在本节后面您将看到一个创建 Ajax 请求的示例，使用一个处理 JSON 响应格式的回调函数。</li> 
     <li style="list-style:disc;">form：&lt;form&gt; 元素的一个引用或者字符串 ID 表示。form 中每个字段的值将被同请求一起作为请求体发送。</li> 
     <li style="list-style:disc;">content：一个对象，包含您想要传递给请求体中资源的参数。如果两者都提供，这个对象将与从 form 属性中获取的值混合在一起。</li> 
     <li style="list-style:disc;">load：当 Ajax 请求返回一个成功响应消息时，执行此函数。响应数据和请求对象作为参数被传递到这个函数。</li> 
     <li style="list-style:disc;">error：如果 Ajax 请求出现问题，该函数将被调用。如果在 Ajax 请求中定义的 URL 无效、请求超时或者发生其他 HTTP 错误，这将会出现。错误消息和请求对象被作为参数传递。</li> 
     <li style="list-style:disc;">handle：该函数允许您将加载和错误回调函数合并到一个函数中（如果您确实不关心请求结果是成功或是出现错误，这将非常有用）。</li> 
    </ul>
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">这几种类型的请求对于构建一个REST风格的框架很有用，用xhrGet查看数据，xhrPost修改数据，xhrPut创建数据，xhrDelete删除数据，每一种类型的请求对应一种服务器端具体的操作。</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">&nbsp;</p> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">使用iframe进行文件上传</h2> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">XHR对于普通的Web请求具有很强的可操作性，但是对于像异步的上传文件等操作显得比较棘手，不过没关系，dojo已经为我们想到了这些。</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">dojo通过使用iframe的方式实现了这种高级的数据传输。笔者曾经使用jquery实现过一个通过iframe异步上传文件的程序，其原理是将文件的提交的target设置为iframe，这样在提交时，页面不会刷新，只有当服务器返回时，才会更新iframe中的内容。这种操作会有进度条，但整个页面不会刷新，虽然不是完全的无刷新，但用其实现文件上传绝对的有用。</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">dojo.io.iframe 是如何工作的呢？除了 XHR 对象之外还有什么方法可以实现表单的异步提交？其实这一切都很简单，dojo.io.iframe 首先会创建一个隐藏的 iframe 并插入到父页面的最后，然后设置此 iframe 的 src 属性为dojo-module-path/resources/blank.html（dojo-module-path 指 dojo 包所在的目录），iframe 页面的 onload 事件的处理函数被设置为父窗体的回调函数。接下来就是在 iframe 页面中发送请求，并接收服务器的响应。当 iframe 接收到服务器的反馈并加载完之后，父窗体的回调函数即被调用。</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">&nbsp;</p> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">JSONP：跨域的数据访问</h2> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">XHR 框架中的函数功能强大，使用方便。但是 XHR 框架的函数有一问题就是不能跨域访问，浏览器不允许 XHR 对象访问其他域的站点。</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">JSONP（JSONP Padding）就是为了解决跨域访问而产生的：</p> 
    <ul style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">
     <li style="list-style:disc;">通过&lt;javascript&gt;&lt;/javascript&gt;标签访问封装JSON数据的地址</li> 
     <li style="list-style:disc;">将要返回的数据封装为JSON对象</li> 
     <li style="list-style:disc;">数据返回给浏览器，并被自动执行</li> 
    </ul>
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">这便是JSONP执行的基本流程，但是想要确定数据是否加载完成并不容易，通常的做法是设置一个回调方法，这个方法的名称被作为请求参数的一部分发送给服务器，服务器在将数据封装完整后，生成回调方法执行的代码，并将这些信息全部返回给客户端，当客户端执行返回数据时，回调方法也会被随之调用。</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">&nbsp;</p> 
    <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">总结</h2> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">本文介绍了 Dojo 中三种浏览器与服务器交互的方式，这三种方式各有优缺点，但是在使用方式却出奇的一致； xhr 框架的函数，dojo.io.iframe、dojo.io.script 对象的函数使用的 JSON 对象参数也极其相似，而且浅显易懂。 Dojo 设计者的这一良好设计极大的减轻了开发人员的学习负担，作为框架开发人员应该了解这一理念。</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">下表是对这三种方式从三个方面进行了比较：</p> 
    <table class="data-table-1" border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">
     <tbody>
      <tr>
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><strong>支持的 HTTP 请求类型</strong></td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><strong>期望的输出</strong></td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><strong>跨域访问</strong></td> 
      </tr>
      <tr>
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><strong>XHR</strong></td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;">Get, post, delete, put</td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;">text, json, xml, javascript …</td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;">N</td> 
      </tr>
      <tr>
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><strong>iframe</strong></td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;">Get, post</td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;">html</td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;">N</td> 
      </tr>
      <tr>
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><strong>script</strong></td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;">Get</td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;">javascript</td> 
       <td style="border:1px solid #C0C0C0;border-collapse:collapse;">Y</td> 
      </tr>
     </tbody>
    </table>
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">&nbsp;</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">综上所述，使用上述三种方法时需要遵循一条简单的原则：传送文件则 iframe，跨域访问则使用动态脚本，其余则选 XHR 框架。</p> 
    <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:13.3333px;">&nbsp;</p> 
    <p><font color="#333333"><span style="font-size:13.3333px;"><br></span></font></p> 
    <p><font color="#333333"><span style="font-size:13.3333px;"><br></span></font></p> 
    <p><font color="#333333"><span style="font-size:13.3333px;"><br></span></font></p> 
    <p><font color="#333333"><span style="font-size:13.3333px;">本文转自齐师傅博客园博客，原文链接：http://www.cnblogs.com/youring2/archive/2012/06/10/2544418.html，如需转载请自行联系原作者</span></font></p> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
