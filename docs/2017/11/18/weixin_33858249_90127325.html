<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>理解 OpenStack + Ceph （8）: 基本的 Ceph 性能测试工具和方法 « NotBeCN</title>
  <meta name="description" content="             本系列文章会深入研究 Ceph 以及 Ceph 和 OpenStack 的集成：    （1）安装和部署    （2）Ceph RBD 接口和工具    （3）Ceph 物理和逻辑结构    （4）Ceph 的基础数据结构    （5）Ceph 与 OpenStack 集成的实现    ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/18/weixin_33858249_90127325.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">理解 OpenStack + Ceph （8）: 基本的 Ceph 性能测试工具和方法</h1>
    <p class="post-meta">Nov 18, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">本系列文章会深入研究 Ceph 以及 Ceph 和 OpenStack 的集成：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（1）<a href="http://www.cnblogs.com/sammyliu/p/4804037.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">安装和部署</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（2）<a href="http://www.cnblogs.com/sammyliu/p/4838139.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Ceph RBD 接口和工具</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（3）<a href="http://www.cnblogs.com/sammyliu/p/4836014.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Ceph 物理和逻辑结构</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（4）<a href="http://www.cnblogs.com/sammyliu/p/4843812.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Ceph 的基础数据结构</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（5）<a href="http://www.cnblogs.com/sammyliu/p/4838138.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Ceph 与 OpenStack 集成的实现</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（6）<a href="http://www.cnblogs.com/sammyliu/p/5066895.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">QEMU-KVM 和 Ceph RBD 的 缓存机制总结</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（7）<a href="http://www.cnblogs.com/sammyliu/p/5555218.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Ceph 的基本操作和常见故障排除方法</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（8）<a href="http://www.cnblogs.com/sammyliu/p/5557666.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">基本的性能测试工具和方法</a></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">继续学以致用，学习下基本的Ceph性能测试工具和方法。</p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">0. 测试环境</h2> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">同&nbsp;<a href="http://www.cnblogs.com/sammyliu/p/5555218.html%20" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Ceph 的基本操作和常见故障排除方法</a>&nbsp;一文中的测试环境。</p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">1. 测试准备</h2> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.1 磁盘读写性能</h3> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">1.1.1 单个 OSD 磁盘写性能，大概 165MB/s。</h4> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre>root@ceph1:~# echo <span style="color:rgb(128,0,128);line-height:1.5;">3</span> &gt; /proc/sys/vm/<span style="line-height:1.5;">drop_caches
root@ceph1:</span>~# dd <span style="color:rgb(0,0,255);line-height:1.5;">if</span>=/dev/zero of=/<span style="color:rgb(0,0,255);line-height:1.5;">var</span>/lib/ceph/osd/ceph-<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/deleteme bs=1G count=<span style="color:rgb(128,0,128);line-height:1.5;">1</span> oflag=<span style="line-height:1.5;">direct</span></pre>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">测试发现，其结果变化非常大，有时候上 75，有时是150.</p> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">1.1.2 两个OSD同时写性能，大概 18 MB/s。怎么差距那么大呢？几乎是单个磁盘的 1/10 了。</h4> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre>root@ceph1:~# <span style="color:rgb(0,0,255);line-height:1.5;">for</span> i <span style="color:rgb(0,0,255);line-height:1.5;">in</span> `mount | grep osd | awk <span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">{print $3}</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>`; <span style="color:rgb(0,0,255);line-height:1.5;">do</span> (dd <span style="color:rgb(0,0,255);line-height:1.5;">if</span>=/dev/zero of=$i/deleteme bs=1G count=<span style="color:rgb(128,0,128);line-height:1.5;">1</span> oflag=direct &amp;<span style="line-height:1.5;">) ; done</span></pre>
   </div> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">1.1.4 单个 OSD 磁盘读性能，大概 460 MB/s。</h4> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre>root@ceph1:~# dd <span style="color:rgb(0,0,255);line-height:1.5;">if</span>=/<span style="color:rgb(0,0,255);line-height:1.5;">var</span>/lib/ceph/osd/ceph-<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/deleteme of=/dev/<span style="color:rgb(0,0,255);line-height:1.5;">null</span> bs=2G count=<span style="color:rgb(128,0,128);line-height:1.5;">1</span> iflag=<span style="line-height:1.5;">direct</span><span style="color:rgb(128,0,128);line-height:1.5;"><br></span></pre>
   </div> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;"><span style="line-height:1.5;">1.1.5 两个 OSD 同时读性能，大概 130 MB/s。</span></h4> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';">
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">for</span> i <span style="color:rgb(0,0,255);line-height:1.5;">in</span> `mount | grep osd | awk <span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">{print $3}</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span>`; <span style="color:rgb(0,0,255);line-height:1.5;">do</span> (dd <span style="color:rgb(0,0,255);line-height:1.5;">if</span>=$i/deleteme of=/dev/<span style="color:rgb(0,0,255);line-height:1.5;">null</span> bs=1G count=<span style="color:rgb(128,0,128);line-height:1.5;">1</span> iflag=direct &amp;); done</pre>
   </div> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.2 网络性能</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">在 ceph1上运行&nbsp;iperf -s -p 6900，在 ceph2 上运行&nbsp;iperf -c ceph1 -p 6900，反复多次，两节点之间的带宽大约在&nbsp;1 Gbits/sec = 128 MB/s。</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@ceph2:~# iperf -c ceph1 -p <span style="color:rgb(128,0,128);line-height:1.5;">6900</span>
------------------------------------------------------------<span style="line-height:1.5;">
Client connecting to ceph1, TCP port </span><span style="color:rgb(128,0,128);line-height:1.5;">6900</span><span style="line-height:1.5;">
TCP window size: </span><span style="color:rgb(128,0,128);line-height:1.5;">85.0</span> KByte (<span style="color:rgb(0,0,255);line-height:1.5;">default</span><span style="line-height:1.5;">)
</span>------------------------------------------------------------<span style="line-height:1.5;">
[  </span><span style="color:rgb(128,0,128);line-height:1.5;">3</span>] local <span style="color:rgb(128,0,128);line-height:1.5;">192.168</span>.<span style="color:rgb(128,0,128);line-height:1.5;">56.103</span> port <span style="color:rgb(128,0,128);line-height:1.5;">41773</span> connected with <span style="color:rgb(128,0,128);line-height:1.5;">192.168</span>.<span style="color:rgb(128,0,128);line-height:1.5;">56.102</span> port <span style="color:rgb(128,0,128);line-height:1.5;">6900</span><span style="line-height:1.5;">
[ ID] Interval       Transfer     Bandwidth
[  </span><span style="color:rgb(128,0,128);line-height:1.5;">3</span>]  <span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>-<span style="color:rgb(128,0,128);line-height:1.5;">10.0</span> sec  <span style="color:rgb(128,0,128);line-height:1.5;">1.25</span> GBytes  <span style="color:rgb(128,0,128);line-height:1.5;">1.08</span> Gbits/sec</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">2. Ceph 性能测试</h2> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">2.1 RADOS 性能测试：使用 Ceph 自带的 rados bench 工具</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">该工具的语法为：rados bench -p &lt;pool_name&gt; &lt;seconds&gt; &lt;write|seq|rand&gt; -b &lt;block size&gt; -t --no-cleanup</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">pool_name：测试所针对的存储池</li> 
    <li style="list-style-type:disc;">seconds：测试所持续的秒数</li> 
    <li style="list-style-type:disc;">&lt;write|seq|rand&gt;：操作模式，write：写，seq：顺序读；rand：随机读</li> 
    <li style="list-style-type:disc;">-b：block size，即块大小，默认为 4M</li> 
    <li style="list-style-type:disc;">-t：读/写并行数，默认为 16</li> 
    <li style="list-style-type:disc;">--no-cleanup 表示测试完成后不删除测试用数据。在做读测试之前，需要使用该参数来运行一遍写测试来产生测试数据，在全部测试结束后可以运行&nbsp;rados -p &lt;pool_name&gt;&nbsp;cleanup 来清理所有测试数据。</li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">写：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@ceph1:~# rados bench -p rbd <span style="color:rgb(128,0,128);line-height:1.5;">10</span> write --no-<span style="line-height:1.5;">cleanup
 Maintaining </span><span style="color:rgb(128,0,128);line-height:1.5;">16</span> concurrent writes of <span style="color:rgb(128,0,128);line-height:1.5;">4194304</span> bytes <span style="color:rgb(0,0,255);line-height:1.5;">for</span> up to <span style="color:rgb(128,0,128);line-height:1.5;">10</span> seconds or <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;"> objects
 Object prefix: benchmark_data_ceph1_12884
   sec Cur ops   started  finished  avg MB</span>/s  cur MB/<span style="line-height:1.5;">s  last lat   avg lat
     </span><span style="color:rgb(128,0,128);line-height:1.5;">0</span>       <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         -         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>
     <span style="color:rgb(128,0,128);line-height:1.5;">1</span>      <span style="color:rgb(128,0,128);line-height:1.5;">16</span>        <span style="color:rgb(128,0,128);line-height:1.5;">16</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         -         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>
...
    <span style="color:rgb(128,0,128);line-height:1.5;">12</span>      <span style="color:rgb(128,0,128);line-height:1.5;">15</span>        <span style="color:rgb(128,0,128);line-height:1.5;">75</span>        <span style="color:rgb(128,0,128);line-height:1.5;">60</span>   <span style="color:rgb(128,0,128);line-height:1.5;">19.9671</span>         <span style="color:rgb(128,0,128);line-height:1.5;">4</span>   <span style="color:rgb(128,0,128);line-height:1.5;">3.05943</span>   <span style="color:rgb(128,0,128);line-height:1.5;">2.46556</span><span style="line-height:1.5;">
 Total time run:         </span><span style="color:rgb(128,0,128);line-height:1.5;">12.135344</span><span style="line-height:1.5;">
Total writes made:      </span><span style="color:rgb(128,0,128);line-height:1.5;">75</span><span style="line-height:1.5;">
Write size:             </span><span style="color:rgb(128,0,128);line-height:1.5;">4194304</span><span style="color:rgb(0,0,255);line-height:1.5;">
Bandwidth (MB/sec):     24.721</span><span style="line-height:1.5;">

Stddev Bandwidth:       </span><span style="color:rgb(128,0,128);line-height:1.5;">13.5647</span><span style="line-height:1.5;">
Max bandwidth (MB</span>/sec): <span style="color:rgb(128,0,128);line-height:1.5;">36</span><span style="line-height:1.5;">
Min bandwidth (MB</span>/sec): <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="color:rgb(0,0,255);line-height:1.5;">
Average Latency:        2.57614</span><span style="line-height:1.5;">
Stddev Latency:         </span><span style="color:rgb(128,0,128);line-height:1.5;">0.781915</span><span style="line-height:1.5;">
Max latency:            </span><span style="color:rgb(128,0,128);line-height:1.5;">4.50816</span><span style="line-height:1.5;">
Min latency:            </span><span style="color:rgb(128,0,128);line-height:1.5;">1.04075</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">顺序读：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@ceph1:~# rados bench -p rbd <span style="color:rgb(128,0,128);line-height:1.5;">10</span><span style="line-height:1.5;"> seq
   sec Cur ops   started  finished  avg MB</span>/s  cur MB/<span style="line-height:1.5;">s  last lat   avg lat
     </span><span style="color:rgb(128,0,128);line-height:1.5;">0</span>      <span style="color:rgb(128,0,128);line-height:1.5;">16</span>        <span style="color:rgb(128,0,128);line-height:1.5;">16</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         -         <span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">
 Total time run:        </span><span style="color:rgb(128,0,128);line-height:1.5;">0.601027</span><span style="line-height:1.5;">
Total reads made:     </span><span style="color:rgb(128,0,128);line-height:1.5;">75</span><span style="line-height:1.5;">
Read size:            </span><span style="color:rgb(128,0,128);line-height:1.5;">4194304</span><span style="color:rgb(0,0,255);line-height:1.5;">
Bandwidth (MB/sec):    499.146</span><span style="line-height:1.5;">

Average Latency:       </span><span style="color:rgb(128,0,128);line-height:1.5;">0.123632</span><span style="line-height:1.5;">
Max latency:           </span><span style="color:rgb(128,0,128);line-height:1.5;">0.209325</span><span style="line-height:1.5;">
Min latency:           </span><span style="color:rgb(128,0,128);line-height:1.5;">0.030446</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">随机读：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@ceph1:~# rados bench -p rbd <span style="color:rgb(128,0,128);line-height:1.5;">10</span><span style="line-height:1.5;"> rand
   sec Cur ops   started  finished  avg MB</span>/s  cur MB/<span style="line-height:1.5;">s  last lat   avg lat
     </span><span style="color:rgb(128,0,128);line-height:1.5;">0</span>       <span style="color:rgb(128,0,128);line-height:1.5;">3</span>         <span style="color:rgb(128,0,128);line-height:1.5;">3</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>         -         <span style="color:rgb(128,0,128);line-height:1.5;">0</span>
     <span style="color:rgb(128,0,128);line-height:1.5;">1</span>      <span style="color:rgb(128,0,128);line-height:1.5;">16</span>       <span style="color:rgb(128,0,128);line-height:1.5;">138</span>       <span style="color:rgb(128,0,128);line-height:1.5;">122</span>   <span style="color:rgb(128,0,128);line-height:1.5;">477.298</span>       <span style="color:rgb(128,0,128);line-height:1.5;">488</span>   <span style="color:rgb(128,0,128);line-height:1.5;">0.01702</span>  <span style="color:rgb(128,0,128);line-height:1.5;">0.116519</span>
...
    <span style="color:rgb(128,0,128);line-height:1.5;">10</span>      <span style="color:rgb(128,0,128);line-height:1.5;">16</span>      <span style="color:rgb(128,0,128);line-height:1.5;">1242</span>      <span style="color:rgb(128,0,128);line-height:1.5;">1226</span>   <span style="color:rgb(128,0,128);line-height:1.5;">488.681</span>       <span style="color:rgb(128,0,128);line-height:1.5;">448</span>  <span style="color:rgb(128,0,128);line-height:1.5;">0.108589</span>  <span style="color:rgb(128,0,128);line-height:1.5;">0.129214</span><span style="line-height:1.5;">
 Total time run:        </span><span style="color:rgb(128,0,128);line-height:1.5;">10.092985</span><span style="line-height:1.5;">
Total reads made:     </span><span style="color:rgb(128,0,128);line-height:1.5;">1242</span><span style="line-height:1.5;">
Read size:            </span><span style="color:rgb(128,0,128);line-height:1.5;">4194304</span><span style="color:rgb(0,0,255);line-height:1.5;">
Bandwidth (MB/sec):    492.223

Average Latency:       0.129631</span><span style="line-height:1.5;">
Max latency:           </span><span style="color:rgb(128,0,128);line-height:1.5;">0.297213</span><span style="line-height:1.5;">
Min latency:           </span><span style="color:rgb(128,0,128);line-height:1.5;">0.007133</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">2.2 RADOS 性能测试：使用 rados load-gen 工具</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">该工具的语法为：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre># rados -p rbd load-<span style="line-height:1.5;">gen 
</span></pre> 
    <p style="line-height:1.5;">--num-objects &nbsp; &nbsp; 初始生成测试用的对象数，默认 200<br> --min-object-size 测试对象的最小大小，默认 1KB，单位byte&nbsp;<br> --max-object-size 测试对象的最大大小，默认 5GB，单位byte</p> 
    <p style="line-height:1.5;">--min-op-len &nbsp; &nbsp; &nbsp;压测IO的最小大小，默认 1KB，单位byte<br> --max-op-len &nbsp; &nbsp; &nbsp;压测IO的最大大小，默认 2MB，单位byte<br> --max-ops &nbsp; &nbsp; &nbsp; &nbsp; 一次提交的最大IO数，相当于iodepth<br> --target-throughput 一次提交IO的历史累计吞吐量上限，默认 5MB/s，单位B/s<br> --max-backlog &nbsp; &nbsp; 一次提交IO的吞吐量上限，默认10MB/s，单位B/s<br> --read-percent &nbsp; &nbsp;读写混合中读的比例，默认80，范围[0, 100]</p> 
    <p style="line-height:1.5;">--run-length &nbsp; &nbsp; &nbsp;运行的时间，默认60s，单位秒</p> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">在 ceph1上运行 rados -p pool100 load-gen --read-percent 0 --min-object-size 1073741824 --max-object-size 1073741824 --max-ops 1 --read-percent 0 --min-op-len 4194304 --max-op-len 4194304 --target-throughput 1073741824 --max_backlog 1073741824&nbsp;的结果为：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <p style="line-height:1.5;">WRITE : oid=obj-y0UPAZyRQNhnabq off=929764660 len=4194304<br> op 19 completed, throughput=16MB/sec<br> WRITE : oid=obj-nPcOZAc4ebBcnyN off=143211384 len=4194304<br> op 20 completed, throughput=20MB/sec<br> WRITE : oid=obj-sWGUAzzASPjCcwF off=343875215 len=4194304<br> op 21 completed, throughput=24MB/sec<br> WRITE : oid=obj-79r25fxxSMgVm11 off=383617425 len=4194304<br> op 22 completed, throughput=28MB/sec</p> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">该命令的含义是：在 1G 的对象上，以 iodepth = 1 顺序写入 block size 为 4M 的总量为 1G 的数据。其平均结果大概在 24MB/s，基本和 rados bench 的结果相当。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">在 client 上，同样的配置，顺序写的BW大概在 20MB/s，顺序读的 BW 大概在 100 MB/s。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><span style="line-height:1.5;">可见，与 rados bench 相比，rados load-gen 的特点是可以产生混合类型的测试负载，而 rados bench 只能产生一种类型的负载。但是 load-gen 只能输出吞吐量，只合适做类似于 4M 这样的大block size 数据测试，输出还不包括延迟。</span></p> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">2.3 使用 rbd bench-write 进行块设备写性能测试</h3> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">2.3.1 客户端准备&nbsp;</h4> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp; &nbsp;在执行如下命令来准备 Ceph 客户端：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@client:/<span style="color:rgb(0,0,255);line-height:1.5;">var</span># rbd create bd2 --size <span style="color:rgb(128,0,128);line-height:1.5;">1024</span><span style="line-height:1.5;">
root@client:</span>/<span style="color:rgb(0,0,255);line-height:1.5;">var</span># rbd info --<span style="line-height:1.5;">image bd2
rbd image </span><span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="color:rgb(128,0,0);line-height:1.5;">bd2</span><span style="color:rgb(128,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">:
        size </span><span style="color:rgb(128,0,128);line-height:1.5;">1024</span> MB <span style="color:rgb(0,0,255);line-height:1.5;">in</span> <span style="color:rgb(128,0,128);line-height:1.5;">256</span><span style="line-height:1.5;"> objects
        order </span><span style="color:rgb(128,0,128);line-height:1.5;">22</span> (<span style="color:rgb(128,0,128);line-height:1.5;">4096</span><span style="line-height:1.5;"> kB objects)
        block_name_prefix: rb.</span><span style="color:rgb(128,0,128);line-height:1.5;">0.3841</span><span style="line-height:1.5;">.74b0dc51
        format: </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">
root@client:</span>/<span style="color:rgb(0,0,255);line-height:1.5;">var</span><span style="line-height:1.5;"># rbd map bd2
root@client:</span>/<span style="color:rgb(0,0,255);line-height:1.5;">var</span><span style="line-height:1.5;"># rbd showmapped
id pool  image snap device
</span><span style="color:rgb(128,0,128);line-height:1.5;">1</span>  pool1 bd1   -    /dev/<span style="line-height:1.5;">rbd1
</span><span style="color:rgb(128,0,128);line-height:1.5;">2</span>  rbd   bd2   -    /dev/<span style="line-height:1.5;">rbd2
root@client:</span>/<span style="color:rgb(0,0,255);line-height:1.5;">var</span># mkfs.xfs /dev/<span style="line-height:1.5;">rbd2
log stripe unit (</span><span style="color:rgb(128,0,128);line-height:1.5;">4194304</span> bytes) <span style="color:rgb(0,0,255);line-height:1.5;">is</span> too large (maximum <span style="color:rgb(0,0,255);line-height:1.5;">is</span><span style="line-height:1.5;"> 256KiB)
log stripe unit adjusted to 32KiB
meta</span>-data=/dev/rbd2              isize=<span style="color:rgb(128,0,128);line-height:1.5;">256</span>    agcount=<span style="color:rgb(128,0,128);line-height:1.5;">9</span>, agsize=<span style="color:rgb(128,0,128);line-height:1.5;">31744</span><span style="line-height:1.5;"> blks
         </span>=                       sectsz=<span style="color:rgb(128,0,128);line-height:1.5;">512</span>   attr=<span style="color:rgb(128,0,128);line-height:1.5;">2</span>, projid32bit=<span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">
data     </span>=                       bsize=<span style="color:rgb(128,0,128);line-height:1.5;">4096</span>   blocks=<span style="color:rgb(128,0,128);line-height:1.5;">262144</span>, imaxpct=<span style="color:rgb(128,0,128);line-height:1.5;">25</span>
         =                       sunit=<span style="color:rgb(128,0,128);line-height:1.5;">1024</span>   swidth=<span style="color:rgb(128,0,128);line-height:1.5;">1024</span><span style="line-height:1.5;"> blks
naming   </span>=version <span style="color:rgb(128,0,128);line-height:1.5;">2</span>              bsize=<span style="color:rgb(128,0,128);line-height:1.5;">4096</span>   ascii-ci=<span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">
log      </span>=<span style="color:rgb(0,0,255);line-height:1.5;">internal</span> log           bsize=<span style="color:rgb(128,0,128);line-height:1.5;">4096</span>   blocks=<span style="color:rgb(128,0,128);line-height:1.5;">2560</span>, version=<span style="color:rgb(128,0,128);line-height:1.5;">2</span>
         =                       sectsz=<span style="color:rgb(128,0,128);line-height:1.5;">512</span>   sunit=<span style="color:rgb(128,0,128);line-height:1.5;">8</span> blks, lazy-count=<span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">
realtime </span>=none                   extsz=<span style="color:rgb(128,0,128);line-height:1.5;">4096</span>   blocks=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, rtextents=<span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">
root@client:</span>/<span style="color:rgb(0,0,255);line-height:1.5;">var</span># mkdir -p /mnt/ceph-<span style="line-height:1.5;">bd2
root@client:</span>/<span style="color:rgb(0,0,255);line-height:1.5;">var</span># mount /dev/rbd2 /mnt/ceph-bd2/<span style="line-height:1.5;">
root@client:</span>/<span style="color:rgb(0,0,255);line-height:1.5;">var</span># df -h /mnt/ceph-bd2/<span style="line-height:1.5;">
Filesystem      Size  Used Avail Use</span>%<span style="line-height:1.5;"> Mounted on
</span>/dev/rbd2      1014M   33M  982M   <span style="color:rgb(128,0,128);line-height:1.5;">4</span>% /mnt/ceph-bd2</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">2.3.2 测试</h4> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">rbd bench-write 的语法为：rbd bench-write &lt;RBD image name&gt;，可以带如下参数：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">--io-size：单位 byte，默认 4096 bytes = 4K</li> 
    <li style="list-style-type:disc;">--io-threads：线程数，默认 16</li> 
    <li style="list-style-type:disc;">--io-total：总写入字节，单位为字节，默认 1024M</li> 
    <li style="list-style-type:disc;">--io-pattern &lt;seq|rand&gt;：写模式，默认为 seq 即顺序写</li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;分别在集群 OSD 节点上和客户端上做测试：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（1）在 OSD 节点上做测试</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@ceph1:~# rbd bench-write bd2 --io-total <span style="color:rgb(128,0,128);line-height:1.5;">171997300</span><span style="line-height:1.5;">
bench</span>-write  io_size <span style="color:rgb(128,0,128);line-height:1.5;">4096</span> io_threads <span style="color:rgb(128,0,128);line-height:1.5;">16</span> bytes <span style="color:rgb(128,0,128);line-height:1.5;">171997300</span><span style="line-height:1.5;"> pattern seq
  SEC       OPS   OPS</span>/SEC   BYTES/<span style="line-height:1.5;">SEC
    </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span>       <span style="color:rgb(128,0,128);line-height:1.5;">280</span>    <span style="color:rgb(128,0,128);line-height:1.5;">273.19</span>  <span style="color:rgb(128,0,128);line-height:1.5;">2237969.65</span>
    <span style="color:rgb(128,0,128);line-height:1.5;">2</span>       <span style="color:rgb(128,0,128);line-height:1.5;">574</span>    <span style="color:rgb(128,0,128);line-height:1.5;">286.84</span>  <span style="color:rgb(128,0,128);line-height:1.5;">2349818.65</span><span style="line-height:1.5;">
...
   </span><span style="color:rgb(128,0,128);line-height:1.5;">71</span>     <span style="color:rgb(128,0,128);line-height:1.5;">20456</span>    <span style="color:rgb(128,0,128);line-height:1.5;">288.00</span>  <span style="color:rgb(128,0,128);line-height:1.5;">2358395.28</span>
   <span style="color:rgb(128,0,128);line-height:1.5;">72</span>     <span style="color:rgb(128,0,128);line-height:1.5;">20763</span>    <span style="color:rgb(128,0,128);line-height:1.5;">288.29</span>  <span style="color:rgb(128,0,128);line-height:1.5;">2360852.64</span><span style="line-height:1.5;">
elapsed:    </span><span style="color:rgb(128,0,128);line-height:1.5;">72</span>  ops:    <span style="color:rgb(128,0,128);line-height:1.5;">21011</span>  ops/sec:   <span style="color:rgb(128,0,128);line-height:1.5;">288.75</span>  bytes/sec: <span style="color:rgb(128,0,128);line-height:1.5;">2363740.27</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><span style="line-height:1.5;">此时，块大小为 4k，IOPS 为 289，BW 为 2.36 MB/s （怎么 BW 是 block_size * IOPS 的两倍呢？）。</span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><span style="line-height:1.5;">（2）在客户端上做测试</span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@client:/home/s1# rbd bench-write pool.host/image.ph2  --io-total <span style="color:rgb(128,0,128);line-height:1.5;">1719973000</span> --io-size <span style="color:rgb(128,0,128);line-height:1.5;">4096000</span><span style="line-height:1.5;">
bench</span>-write  io_size <span style="color:rgb(128,0,128);line-height:1.5;">4096000</span> io_threads <span style="color:rgb(128,0,128);line-height:1.5;">16</span> bytes <span style="color:rgb(128,0,128);line-height:1.5;">1719973000</span><span style="line-height:1.5;"> pattern seq
  SEC       OPS   OPS</span>/SEC   BYTES/<span style="line-height:1.5;">SEC
    </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span>         <span style="color:rgb(128,0,128);line-height:1.5;">5</span>      <span style="color:rgb(128,0,128);line-height:1.5;">3.41</span>  <span style="color:rgb(128,0,128);line-height:1.5;">27937685.86</span>
    <span style="color:rgb(128,0,128);line-height:1.5;">2</span>        <span style="color:rgb(128,0,128);line-height:1.5;">19</span>      <span style="color:rgb(128,0,128);line-height:1.5;">9.04</span>  <span style="color:rgb(128,0,128);line-height:1.5;">68193147.96</span>
    <span style="color:rgb(128,0,128);line-height:1.5;">3</span>        <span style="color:rgb(128,0,128);line-height:1.5;">28</span>      <span style="color:rgb(128,0,128);line-height:1.5;">8.34</span>  <span style="color:rgb(128,0,128);line-height:1.5;">62237889.75</span>
    <span style="color:rgb(128,0,128);line-height:1.5;">5</span>        <span style="color:rgb(128,0,128);line-height:1.5;">36</span>      <span style="color:rgb(128,0,128);line-height:1.5;">6.29</span>  <span style="color:rgb(128,0,128);line-height:1.5;">46538807.31</span><span style="line-height:1.5;">
...
   </span><span style="color:rgb(128,0,128);line-height:1.5;">39</span>       <span style="color:rgb(128,0,128);line-height:1.5;">232</span>      <span style="color:rgb(128,0,128);line-height:1.5;">5.86</span>  <span style="color:rgb(128,0,128);line-height:1.5;">40792216.64</span>
   <span style="color:rgb(128,0,128);line-height:1.5;">40</span>       <span style="color:rgb(128,0,128);line-height:1.5;">235</span>      <span style="color:rgb(128,0,128);line-height:1.5;">5.85</span>  <span style="color:rgb(128,0,128);line-height:1.5;">40666942.19</span><span style="line-height:1.5;">
elapsed:    </span><span style="color:rgb(128,0,128);line-height:1.5;">41</span>  ops:      <span style="color:rgb(128,0,128);line-height:1.5;">253</span>  ops/sec:     <span style="color:rgb(128,0,128);line-height:1.5;">6.06</span>  bytes/sec: <span style="color:rgb(128,0,128);line-height:1.5;">41238190.87</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">此时 block size 为 4M，IOPS 为 6， BW 为 41.24 MB/s。</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@client:/home/s1# rbd bench-write pool.host/image.ph2  --io-total <span style="color:rgb(128,0,128);line-height:1.5;">1719973000</span><span style="line-height:1.5;">
bench</span>-write  io_size <span style="color:rgb(128,0,128);line-height:1.5;">4096</span> io_threads <span style="color:rgb(128,0,128);line-height:1.5;">16</span> bytes <span style="color:rgb(128,0,128);line-height:1.5;">1719973000</span><span style="line-height:1.5;"> pattern seq
  SEC       OPS   OPS</span>/SEC   BYTES/<span style="line-height:1.5;">SEC
    </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span>       <span style="color:rgb(128,0,128);line-height:1.5;">331</span>    <span style="color:rgb(128,0,128);line-height:1.5;">329.52</span>  <span style="color:rgb(128,0,128);line-height:1.5;">2585220.17</span>
    <span style="color:rgb(128,0,128);line-height:1.5;">2</span>       <span style="color:rgb(128,0,128);line-height:1.5;">660</span>    <span style="color:rgb(128,0,128);line-height:1.5;">329.57</span>  <span style="color:rgb(128,0,128);line-height:1.5;">2521925.67</span>
    <span style="color:rgb(128,0,128);line-height:1.5;">3</span>      <span style="color:rgb(128,0,128);line-height:1.5;">1004</span>    <span style="color:rgb(128,0,128);line-height:1.5;">333.17</span>  <span style="color:rgb(128,0,128);line-height:1.5;">2426190.82</span>
    <span style="color:rgb(128,0,128);line-height:1.5;">4</span>      <span style="color:rgb(128,0,128);line-height:1.5;">1331</span>    <span style="color:rgb(128,0,128);line-height:1.5;">332.26</span>  <span style="color:rgb(128,0,128);line-height:1.5;">2392607.58</span>
    <span style="color:rgb(128,0,128);line-height:1.5;">5</span>      <span style="color:rgb(128,0,128);line-height:1.5;">1646</span>    <span style="color:rgb(128,0,128);line-height:1.5;">328.68</span>  <span style="color:rgb(128,0,128);line-height:1.5;">2322829.13</span>
    <span style="color:rgb(128,0,128);line-height:1.5;">6</span>      <span style="color:rgb(128,0,128);line-height:1.5;">1986</span>    <span style="color:rgb(128,0,128);line-height:1.5;">330.88</span>  <span style="color:rgb(128,0,128);line-height:1.5;">2316098.66</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">此时 block size 为 4K，IOPS 为 330 左右， BW 为 24 MB/s 左右。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">备注：从&nbsp;<a href="http://www.spinics.net/lists/ceph-users/msg24647.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">rbd bench-write vs dd performance confusion</a>&nbsp;中看起来，rados bench-write 似乎有bug。我所使用的Ceph 是0.80.11&nbsp;版本，可能补丁还没有合进来。</p> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">2.4 使用 &nbsp;fio +rbd ioengine</h3> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">2.4.1 环境准备</h4> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">运行&nbsp;apt-get install fio 来安装 fio 工具。创建 fio 配置文件：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@client:/home/<span style="line-height:1.5;">s1# cat write.fio
[write</span>-<span style="line-height:1.5;">4M]
description</span>=<span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">write test with block size of 4M</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">
ioengine</span>=<span style="line-height:1.5;">rbd
clientname</span>=<span style="line-height:1.5;">admin
pool</span>=<span style="line-height:1.5;">rbd
rbdname</span>=<span style="line-height:1.5;">bd2
iodepth</span>=<span style="color:rgb(128,0,128);line-height:1.5;">32</span><span style="line-height:1.5;">
runtime</span>=<span style="color:rgb(128,0,128);line-height:1.5;">120</span><span style="line-height:1.5;">
rw</span>=<span style="line-height:1.5;">write #write 表示顺序写，randwrite 表示随机写，read 表示顺序读，randread 表示随机读
bs</span>=4M</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">运行 fio 命令，但是出错：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@client:/home/<span style="line-height:1.5;">s1# fio write.fio
fio: engine rbd not loadable
fio: failed to load engine rbd
Bad option </span>&lt;clientname=admin&gt;<span style="line-height:1.5;">
Bad option </span>&lt;pool=rbd&gt;<span style="line-height:1.5;">
Bad option </span>&lt;rbdname=bd2&gt;<span style="line-height:1.5;">
fio: job write</span>-<span style="line-height:1.5;">4M dropped
fio: file:ioengines.c:</span><span style="color:rgb(128,0,128);line-height:1.5;">99</span>, func=dlopen, error=rbd: cannot open shared <span style="color:rgb(0,0,255);line-height:1.5;">object</span> file: No such file or directory</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">其原因是因为没有安装 fio librbd IO 引擎，因此当前 fio 无法支持 rbd ioengine：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@client:/home/s1# fio --<span style="line-height:1.5;">enghelp
Available IO engines:
        cpuio
        mmap
        sync
        psync
        vsync
        pvsync
        </span><span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">
        net
        netsplice
        libaio
        rdma
        posixaio
        falloc
        e4defrag
        splice
        sg
        binject</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">在运行 apt-get install librbd-dev&nbsp;命令安装 librbd 后，fio 还是报同样的错误。参考网上资料，下载 fio 代码重新编译 fio：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>$ git clone git:<span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">git.kernel.dk/fio.git</span>
<span style="line-height:1.5;">$ cd fio
$ .</span>/<span style="line-height:1.5;">configure
[...]
Rados Block Device engine     yes
[...]
$ make</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">此时 fio 的 ioengine 列表中也有 rbd 了。fio 使用 rbd IO 引擎后，它会读取 ceph.conf 中的配置去连接 Ceph 集群。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">下面是 fio 命令和结果：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@client:/home/s1/fio# ./fio ../<span style="line-height:1.5;">write.fio
write</span>-4M: (g=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>): rw=write, bs=4M-4M/4M-4M/4M-4M, ioengine=rbd, iodepth=<span style="color:rgb(128,0,128);line-height:1.5;">32</span><span style="line-height:1.5;">
fio</span>-<span style="color:rgb(128,0,128);line-height:1.5;">2.11</span>-<span style="color:rgb(128,0,128);line-height:1.5;">12</span>-<span style="line-height:1.5;">g82e6
Starting </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;"> process
rbd engine: RBD version: </span><span style="color:rgb(128,0,128);line-height:1.5;">0.1</span>.<span style="color:rgb(128,0,128);line-height:1.5;">8</span><span style="line-height:1.5;">
Jobs: </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span> (f=<span style="color:rgb(128,0,128);line-height:1.5;">1</span>): [W(<span style="color:rgb(128,0,128);line-height:1.5;">1</span>)] [<span style="color:rgb(128,0,128);line-height:1.5;">100.0</span>% done] [0KB/<span style="color:rgb(128,0,128);line-height:1.5;">128</span>.0MB/0KB /s] [<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/<span style="color:rgb(128,0,128);line-height:1.5;">32</span>/<span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;"> iops] [eta 00m:00s]
write</span>-4M: (groupid=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, jobs=<span style="color:rgb(128,0,128);line-height:1.5;">1</span>): err= <span style="color:rgb(128,0,128);line-height:1.5;">0</span>: pid=<span style="color:rgb(128,0,128);line-height:1.5;">19190</span>: Sat Jun  <span style="color:rgb(128,0,128);line-height:1.5;">4</span> <span style="color:rgb(128,0,128);line-height:1.5;">22</span>:<span style="color:rgb(128,0,128);line-height:1.5;">30</span>:<span style="color:rgb(128,0,128);line-height:1.5;">00</span> <span style="color:rgb(128,0,128);line-height:1.5;">2016</span><span style="line-height:1.5;">
  Description  : [</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">write test with block size of 4M</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">]
  <span style="color:rgb(0,0,255);line-height:1.5;">write: io</span></span><span style="color:rgb(0,0,255);line-height:1.5;">=1024.0MB, bw=17397KB/s, iops=4, runt=</span><span style="line-height:1.5;"><span style="color:rgb(0,0,255);line-height:1.5;"> 60275msec</span>
    slat (usec): min</span>=<span style="color:rgb(128,0,128);line-height:1.5;">129</span>, max=<span style="color:rgb(128,0,128);line-height:1.5;">54100</span>, avg=<span style="color:rgb(128,0,128);line-height:1.5;">1489.10</span>, stdev=<span style="color:rgb(128,0,128);line-height:1.5;">4907.83</span><span style="line-height:1.5;">
    clat (msec): min</span>=<span style="color:rgb(128,0,128);line-height:1.5;">969</span>, max=<span style="color:rgb(128,0,128);line-height:1.5;">15690</span>, avg=<span style="color:rgb(128,0,128);line-height:1.5;">7399.86</span>, stdev=<span style="color:rgb(128,0,128);line-height:1.5;">1328.55</span><span style="line-height:1.5;">
     lat (msec): min</span>=<span style="color:rgb(128,0,128);line-height:1.5;">969</span>, max=<span style="color:rgb(128,0,128);line-height:1.5;">15696</span>, avg=<span style="color:rgb(128,0,128);line-height:1.5;">7401.35</span>, stdev=<span style="color:rgb(128,0,128);line-height:1.5;">1328.67</span><span style="line-height:1.5;">
    clat percentiles (msec):
     </span>|  <span style="color:rgb(128,0,128);line-height:1.5;">1</span>.00th=[  <span style="color:rgb(128,0,128);line-height:1.5;">971</span>],  <span style="color:rgb(128,0,128);line-height:1.5;">5</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">6325</span>], <span style="color:rgb(128,0,128);line-height:1.5;">10</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">6325</span>], <span style="color:rgb(128,0,128);line-height:1.5;">20</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">6521</span><span style="line-height:1.5;">],
     </span>| <span style="color:rgb(128,0,128);line-height:1.5;">30</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">6718</span>], <span style="color:rgb(128,0,128);line-height:1.5;">40</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">7439</span>], <span style="color:rgb(128,0,128);line-height:1.5;">50</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">7439</span>], <span style="color:rgb(128,0,128);line-height:1.5;">60</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">7635</span><span style="line-height:1.5;">],
     </span>| <span style="color:rgb(128,0,128);line-height:1.5;">70</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">7832</span>], <span style="color:rgb(128,0,128);line-height:1.5;">80</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">8291</span>], <span style="color:rgb(128,0,128);line-height:1.5;">90</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">8356</span>], <span style="color:rgb(128,0,128);line-height:1.5;">95</span>.00th=[ <span style="color:rgb(128,0,128);line-height:1.5;">8356</span><span style="line-height:1.5;">],
     </span>| <span style="color:rgb(128,0,128);line-height:1.5;">99</span>.00th=[<span style="color:rgb(128,0,128);line-height:1.5;">14615</span>], <span style="color:rgb(128,0,128);line-height:1.5;">99</span>.50th=[<span style="color:rgb(128,0,128);line-height:1.5;">15664</span>], <span style="color:rgb(128,0,128);line-height:1.5;">99</span>.90th=[<span style="color:rgb(128,0,128);line-height:1.5;">15664</span>], <span style="color:rgb(128,0,128);line-height:1.5;">99</span>.95th=[<span style="color:rgb(128,0,128);line-height:1.5;">15664</span><span style="line-height:1.5;">],
     </span>| <span style="color:rgb(128,0,128);line-height:1.5;">99</span>.99th=[<span style="color:rgb(128,0,128);line-height:1.5;">15664</span><span style="line-height:1.5;">]
    bw (KB  </span>/s): min=<span style="color:rgb(128,0,128);line-height:1.5;">245760</span>, max=<span style="color:rgb(128,0,128);line-height:1.5;">262669</span>, per=<span style="color:rgb(128,0,128);line-height:1.5;">100.00</span>%, avg=<span style="color:rgb(128,0,128);line-height:1.5;">259334.50</span>, stdev=<span style="color:rgb(128,0,128);line-height:1.5;">6250.72</span><span style="line-height:1.5;">
    lat (msec) : </span><span style="color:rgb(128,0,128);line-height:1.5;">1000</span>=<span style="color:rgb(128,0,128);line-height:1.5;">1.17</span>%, &gt;=<span style="color:rgb(128,0,128);line-height:1.5;">2000</span>=<span style="color:rgb(128,0,128);line-height:1.5;">98.83</span>%<span style="line-height:1.5;">
  cpu          : usr</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.24</span>%, sys=<span style="color:rgb(128,0,128);line-height:1.5;">0.03</span>%, ctx=<span style="color:rgb(128,0,128);line-height:1.5;">50</span>, majf=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, minf=<span style="color:rgb(128,0,128);line-height:1.5;">8</span><span style="line-height:1.5;">
  IO depths    : </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span>=<span style="color:rgb(128,0,128);line-height:1.5;">2.3</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">2</span>=<span style="color:rgb(128,0,128);line-height:1.5;">5.5</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">4</span>=<span style="color:rgb(128,0,128);line-height:1.5;">12.5</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">8</span>=<span style="color:rgb(128,0,128);line-height:1.5;">25.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">16</span>=<span style="color:rgb(128,0,128);line-height:1.5;">50.4</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">32</span>=<span style="color:rgb(128,0,128);line-height:1.5;">4.3</span>%, &gt;=<span style="color:rgb(128,0,128);line-height:1.5;">64</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%<span style="line-height:1.5;">
     submit    : </span><span style="color:rgb(128,0,128);line-height:1.5;">0</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">4</span>=<span style="color:rgb(128,0,128);line-height:1.5;">100.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">8</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">16</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">32</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">64</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, &gt;=<span style="color:rgb(128,0,128);line-height:1.5;">64</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%<span style="line-height:1.5;">
     complete  : </span><span style="color:rgb(128,0,128);line-height:1.5;">0</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">4</span>=<span style="color:rgb(128,0,128);line-height:1.5;">97.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">8</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">16</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">32</span>=<span style="color:rgb(128,0,128);line-height:1.5;">3.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">64</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, &gt;=<span style="color:rgb(128,0,128);line-height:1.5;">64</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%<span style="line-height:1.5;">
     issued    : total</span>=r=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/w=<span style="color:rgb(128,0,128);line-height:1.5;">256</span>/d=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, <span style="color:rgb(136,136,136);line-height:1.5;">short</span>=r=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/w=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/d=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, drop=r=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/w=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/d=<span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">
     latency   : target</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, window=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, percentile=<span style="color:rgb(128,0,128);line-height:1.5;">100.00</span>%, depth=<span style="color:rgb(128,0,128);line-height:1.5;">32</span><span style="line-height:1.5;">

Run status group </span><span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;"> (all jobs):
  WRITE: io</span>=<span style="color:rgb(128,0,128);line-height:1.5;">1024</span>.0MB, aggrb=17396KB/s, minb=17396KB/s, maxb=17396KB/s, mint=60275msec, maxt=<span style="line-height:1.5;">60275msec

Disk stats (read</span>/<span style="line-height:1.5;">write):
  sda: ios</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/<span style="color:rgb(128,0,128);line-height:1.5;">162</span>, merge=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/<span style="color:rgb(128,0,128);line-height:1.5;">123</span>, ticks=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/<span style="color:rgb(128,0,128);line-height:1.5;">19472</span>, in_queue=<span style="color:rgb(128,0,128);line-height:1.5;">19472</span>, util=<span style="color:rgb(128,0,128);line-height:1.5;">6.18</span>%</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">如果 iodepth = 1 的话，结果是：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-size:15px;font-family:'Courier New';"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>root@client:/home/s1# fio/<span style="line-height:1.5;">fio write.fio.dep1
write</span>-4M: (g=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>): rw=write, bs=4M-4M/4M-4M/4M-4M, ioengine=rbd, iodepth=<span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">
fio</span>-<span style="color:rgb(128,0,128);line-height:1.5;">2.11</span>-<span style="color:rgb(128,0,128);line-height:1.5;">12</span>-<span style="line-height:1.5;">g82e6
Starting </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;"> process
rbd engine: RBD version: </span><span style="color:rgb(128,0,128);line-height:1.5;">0.1</span>.<span style="color:rgb(128,0,128);line-height:1.5;">8</span><span style="line-height:1.5;">
Jobs: </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span> (f=<span style="color:rgb(128,0,128);line-height:1.5;">1</span>): [W(<span style="color:rgb(128,0,128);line-height:1.5;">1</span>)] [<span style="color:rgb(128,0,128);line-height:1.5;">100.0</span>% done] [0KB/8192KB/0KB /s] [<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/<span style="color:rgb(128,0,128);line-height:1.5;">2</span>/<span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;"> iops] [eta 00m:00s]
write</span>-4M: (groupid=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, jobs=<span style="color:rgb(128,0,128);line-height:1.5;">1</span>): err= <span style="color:rgb(128,0,128);line-height:1.5;">0</span>: pid=<span style="color:rgb(128,0,128);line-height:1.5;">19250</span>: Sat Jun  <span style="color:rgb(128,0,128);line-height:1.5;">4</span> <span style="color:rgb(128,0,128);line-height:1.5;">22</span>:<span style="color:rgb(128,0,128);line-height:1.5;">33</span>:<span style="color:rgb(128,0,128);line-height:1.5;">11</span> <span style="color:rgb(128,0,128);line-height:1.5;">2016</span><span style="line-height:1.5;">
  Description  : [</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="color:rgb(128,0,0);line-height:1.5;">write test with block size of 4M</span><span style="color:rgb(128,0,0);line-height:1.5;">"</span><span style="line-height:1.5;">]
  <span style="color:rgb(0,0,255);line-height:1.5;">write: io</span></span><span style="color:rgb(0,0,255);line-height:1.5;">=1024.0MB, bw=20640KB/s, iops=5, runt= 50802msec</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;font-size:12px;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">2.5 使用 fio + libaio 进行测试</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">libaio 是&nbsp;Linux native asynchronous I/O。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">几种测试模式：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">随机写：fio/fio -filename=/mnt/ceph-rbd2 -direct=1 -iodepth 1 -thread -rw=<span style="line-height:1.5;color:rgb(0,0,255);">randwrite&nbsp;</span>-ioengine=libaio -bs=4M -size=1G -numjobs=1 -runtime=120 -group_reporting -name=read-libaio</li>
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;这些参数的含义是：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:none;"> 
     <ul style="list-style:none;font-size:12px;">
      <li style="list-style-type:disc;">filename：表示待测试的设备名称。</li> 
      <li style="list-style-type:disc;">iodepth：&nbsp;libaio 会用这个 iodepth 值来调用 io_setup 准备个可以一次提交 iodepth 个 IO 的上下文，同时申请个io请求队列用于保持IO。</li> 
      <li style="list-style-type:disc;">iodepth_batch：在压测进行的时候，系统会生成特定的IO请求，往io请求队列里面扔，当队列里面的IO个数达到 iodepth_batch 值的时候，</li> 
      <li style="list-style-type:disc;">iodepth_batch_complete 和 iodepth_low：&nbsp;调用 io_submit 批次提交请求，然后开始调用 io_getevents 开始收割已经完成的IO。 每次收割多少呢？由于收割的时候，超时时间设置为0，所以有多少已完成就算多少，最多可以收割 iodepth_batch_complete 值个。随着收割，IO队列里面的IO数就少了，那么需要补充新的IO。 什么时候补充呢？当IO数目降到 iodepth_low 值的时候，就重新填充，保证 OS 可以看到至少 iodepth_low 数目的io在电梯口排队着。</li> 
     </ul></li>
   </ul>
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"> 
     <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);color:rgb(0,0,0);font-family:'Courier New';font-size:12px;"> 
      <div class="cnblogs_code_toolbar">
       <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
      </div> 
      <pre>root@client:/home/s1# fio/fio -filename=/mnt/ceph-rbd2 -direct=<span style="color:rgb(128,0,128);line-height:1.5;">1</span> -iodepth <span style="color:rgb(128,0,128);line-height:1.5;">1</span> -thread -rw=randwrite -ioengine=libaio -bs=4M -size=1G -numjobs=<span style="color:rgb(128,0,128);line-height:1.5;">1</span> -runtime=<span style="color:rgb(128,0,128);line-height:1.5;">120</span> -group_reporting -name=read-libaio read-libaio: (g=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>): rw=randwrite, bs=4M-4M/4M-4M/4M-4M, ioengine=libaio, iodepth=<span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">
fio</span>-<span style="color:rgb(128,0,128);line-height:1.5;">2.11</span>-<span style="color:rgb(128,0,128);line-height:1.5;">12</span>-<span style="line-height:1.5;">g82e6
Starting </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;"> thread
Jobs: </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span> (f=<span style="color:rgb(128,0,128);line-height:1.5;">1</span>): [w(<span style="color:rgb(128,0,128);line-height:1.5;">1</span>)] [<span style="color:rgb(128,0,128);line-height:1.5;">100.0</span>% done] [0KB/94302KB/0KB /s] [<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/<span style="color:rgb(128,0,128);line-height:1.5;">23</span>/<span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;"> iops] [eta 00m:00s]
read</span>-libaio: (groupid=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, jobs=<span style="color:rgb(128,0,128);line-height:1.5;">1</span>): err= <span style="color:rgb(128,0,128);line-height:1.5;">0</span>: pid=<span style="color:rgb(128,0,128);line-height:1.5;">20256</span>: Sun Jun  <span style="color:rgb(128,0,128);line-height:1.5;">5</span> <span style="color:rgb(128,0,128);line-height:1.5;">10</span>:<span style="color:rgb(128,0,128);line-height:1.5;">00</span>:<span style="color:rgb(128,0,128);line-height:1.5;">55</span> <span style="color:rgb(128,0,128);line-height:1.5;">2016</span><span style="color:rgb(0,0,255);line-height:1.5;">
  write: io=1024.0MB, bw=102510KB/s, iops=25, runt=</span><span style="line-height:1.5;"><span style="color:rgb(0,0,255);line-height:1.5;"> 10229msec</span>
    slat (usec): min</span>=<span style="color:rgb(128,0,128);line-height:1.5;">342</span>, max=<span style="color:rgb(128,0,128);line-height:1.5;">5202</span>, avg=<span style="color:rgb(128,0,128);line-height:1.5;">1768.90</span>, stdev=<span style="color:rgb(128,0,128);line-height:1.5;">1176.00</span><span style="line-height:1.5;">
    clat (usec): min</span>=<span style="color:rgb(128,0,128);line-height:1.5;">332</span>, max=<span style="color:rgb(128,0,128);line-height:1.5;">165391</span>, avg=<span style="color:rgb(128,0,128);line-height:1.5;">38165.11</span>, stdev=<span style="color:rgb(128,0,128);line-height:1.5;">27987.64</span><span style="line-height:1.5;">
     lat (msec): min</span>=<span style="color:rgb(128,0,128);line-height:1.5;">3</span>, max=<span style="color:rgb(128,0,128);line-height:1.5;">167</span>, avg=<span style="color:rgb(128,0,128);line-height:1.5;">39.94</span>, stdev=<span style="color:rgb(128,0,128);line-height:1.5;">28.00</span><span style="line-height:1.5;">
    clat percentiles (msec):
     </span>|  <span style="color:rgb(128,0,128);line-height:1.5;">1</span>.00th=[    <span style="color:rgb(128,0,128);line-height:1.5;">8</span>],  <span style="color:rgb(128,0,128);line-height:1.5;">5</span>.00th=[   <span style="color:rgb(128,0,128);line-height:1.5;">18</span>], <span style="color:rgb(128,0,128);line-height:1.5;">10</span>.00th=[   <span style="color:rgb(128,0,128);line-height:1.5;">19</span>], <span style="color:rgb(128,0,128);line-height:1.5;">20</span>.00th=[   <span style="color:rgb(128,0,128);line-height:1.5;">20</span><span style="line-height:1.5;">],
     </span>| <span style="color:rgb(128,0,128);line-height:1.5;">30</span>.00th=[   <span style="color:rgb(128,0,128);line-height:1.5;">22</span>], <span style="color:rgb(128,0,128);line-height:1.5;">40</span>.00th=[   <span style="color:rgb(128,0,128);line-height:1.5;">25</span>], <span style="color:rgb(128,0,128);line-height:1.5;">50</span>.00th=[   <span style="color:rgb(128,0,128);line-height:1.5;">29</span>], <span style="color:rgb(128,0,128);line-height:1.5;">60</span>.00th=[   <span style="color:rgb(128,0,128);line-height:1.5;">31</span><span style="line-height:1.5;">],
     </span>| <span style="color:rgb(128,0,128);line-height:1.5;">70</span>.00th=[   <span style="color:rgb(128,0,128);line-height:1.5;">36</span>], <span style="color:rgb(128,0,128);line-height:1.5;">80</span>.00th=[   <span style="color:rgb(128,0,128);line-height:1.5;">47</span>], <span style="color:rgb(128,0,128);line-height:1.5;">90</span>.00th=[   <span style="color:rgb(128,0,128);line-height:1.5;">83</span>], <span style="color:rgb(128,0,128);line-height:1.5;">95</span>.00th=[  <span style="color:rgb(128,0,128);line-height:1.5;">105</span><span style="line-height:1.5;">],
     </span>| <span style="color:rgb(128,0,128);line-height:1.5;">99</span>.00th=[  <span style="color:rgb(128,0,128);line-height:1.5;">123</span>], <span style="color:rgb(128,0,128);line-height:1.5;">99</span>.50th=[  <span style="color:rgb(128,0,128);line-height:1.5;">131</span>], <span style="color:rgb(128,0,128);line-height:1.5;">99</span>.90th=[  <span style="color:rgb(128,0,128);line-height:1.5;">165</span>], <span style="color:rgb(128,0,128);line-height:1.5;">99</span>.95th=[  <span style="color:rgb(128,0,128);line-height:1.5;">165</span><span style="line-height:1.5;">],
     </span>| <span style="color:rgb(128,0,128);line-height:1.5;">99</span>.99th=[  <span style="color:rgb(128,0,128);line-height:1.5;">165</span><span style="line-height:1.5;">]
    bw (KB  </span>/s): min=<span style="color:rgb(128,0,128);line-height:1.5;">32702</span>, max=<span style="color:rgb(128,0,128);line-height:1.5;">172032</span>, per=<span style="color:rgb(128,0,128);line-height:1.5;">97.55</span>%, avg=<span style="color:rgb(128,0,128);line-height:1.5;">99999.10</span>, stdev=<span style="color:rgb(128,0,128);line-height:1.5;">36075.23</span><span style="line-height:1.5;">
    lat (usec) : </span><span style="color:rgb(128,0,128);line-height:1.5;">500</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.39</span>%<span style="line-height:1.5;">
    lat (msec) : </span><span style="color:rgb(128,0,128);line-height:1.5;">4</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.39</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">10</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.39</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">20</span>=<span style="color:rgb(128,0,128);line-height:1.5;">21.48</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">50</span>=<span style="color:rgb(128,0,128);line-height:1.5;">57.81</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">100</span>=<span style="color:rgb(128,0,128);line-height:1.5;">14.45</span>%<span style="line-height:1.5;">
    lat (msec) : </span><span style="color:rgb(128,0,128);line-height:1.5;">250</span>=<span style="color:rgb(128,0,128);line-height:1.5;">5.08</span>%<span style="line-height:1.5;">
  cpu          : usr</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.62</span>%, sys=<span style="color:rgb(128,0,128);line-height:1.5;">3.65</span>%, ctx=<span style="color:rgb(128,0,128);line-height:1.5;">316</span>, majf=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, minf=<span style="color:rgb(128,0,128);line-height:1.5;">9</span><span style="line-height:1.5;">
  IO depths    : </span><span style="color:rgb(128,0,128);line-height:1.5;">1</span>=<span style="color:rgb(128,0,128);line-height:1.5;">100.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">2</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">4</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">8</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">16</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">32</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, &gt;=<span style="color:rgb(128,0,128);line-height:1.5;">64</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%<span style="line-height:1.5;">
     submit    : </span><span style="color:rgb(128,0,128);line-height:1.5;">0</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">4</span>=<span style="color:rgb(128,0,128);line-height:1.5;">100.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">8</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">16</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">32</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">64</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, &gt;=<span style="color:rgb(128,0,128);line-height:1.5;">64</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%<span style="line-height:1.5;">
     complete  : </span><span style="color:rgb(128,0,128);line-height:1.5;">0</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">4</span>=<span style="color:rgb(128,0,128);line-height:1.5;">100.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">8</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">16</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">32</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, <span style="color:rgb(128,0,128);line-height:1.5;">64</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%, &gt;=<span style="color:rgb(128,0,128);line-height:1.5;">64</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0.0</span>%<span style="line-height:1.5;">
     issued    : total</span>=r=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/w=<span style="color:rgb(128,0,128);line-height:1.5;">256</span>/d=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, <span style="color:rgb(0,0,255);line-height:1.5;">short</span>=r=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/w=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/d=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, drop=r=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/w=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/d=<span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;">
     latency   : target</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, window=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>, percentile=<span style="color:rgb(128,0,128);line-height:1.5;">100.00</span>%, depth=<span style="color:rgb(128,0,128);line-height:1.5;">1</span><span style="line-height:1.5;">

Run status group </span><span style="color:rgb(128,0,128);line-height:1.5;">0</span><span style="line-height:1.5;"> (all jobs):
  WRITE: io</span>=<span style="color:rgb(128,0,128);line-height:1.5;">1024</span>.0MB, aggrb=102510KB/s, minb=102510KB/s, maxb=102510KB/s, mint=10229msec, maxt=<span style="line-height:1.5;">10229msec

Disk stats (read</span>/<span style="line-height:1.5;">write):
  sda: ios</span>=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/<span style="color:rgb(128,0,128);line-height:1.5;">1927</span>, merge=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/<span style="color:rgb(128,0,128);line-height:1.5;">1</span>, ticks=<span style="color:rgb(128,0,128);line-height:1.5;">0</span>/<span style="color:rgb(128,0,128);line-height:1.5;">30276</span>, in_queue=<span style="color:rgb(128,0,128);line-height:1.5;">30420</span>, util=<span style="color:rgb(128,0,128);line-height:1.5;">98.71</span>%</pre> 
      <div class="cnblogs_code_toolbar">
       <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(26,139,200);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
      </div> 
     </div> </li>
   </ul>
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">随机读：fio/fio -filename=/mnt/ceph-rbd2 -direct=1 -iodepth 1 -thread -rw=<span style="line-height:1.5;color:rgb(0,0,255);">randread</span>&nbsp;-ioengine=libaio -bs=4M -size=1G -numjobs=1 -runtime=120 -group_reporting -name=read-libaio</li> 
    <li style="list-style-type:disc;">顺序写：fio/fio -filename=/mnt/ceph-rbd2 -direct=1 -iodepth 1 -thread -rw=<span style="line-height:1.5;color:rgb(0,0,255);">write</span>&nbsp;-ioengine=libaio -bs=4M -size=1G -numjobs=1 -runtime=120 -group_reporting -name=read-libaio</li> 
    <li style="list-style-type:disc;">随机写：fio/fio -filename=/mnt/ceph-rbd2 -direct=1 -iodepth 1 -thread -rw=<span style="line-height:1.5;color:rgb(0,0,255);">randwrite</span>&nbsp;-ioengine=libaio -bs=4M -size=1G -numjobs=1 -runtime=120 -group_reporting -name=read-libaio</li> 
   </ul>
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">3. 总结</h2> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">3.1 测试工具小结</h3> 
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">
    <tbody>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>工具</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>用途</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>语法</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>说明</strong></td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">dd</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">磁盘读写性能测试</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;dd if=/dev/zero of=/root/testfile bs=1G count=1 oflag=direct/dsync/sync</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;<a href="https://www.thomas-krenn.com/en/wiki/Linux_I/O_Performance_Tests_using_dd" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">https://www.thomas-krenn.com/en/wiki/Linux_I/O_Performance_Tests_using_dd</a> </td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">iperf</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">网络带宽性能测试</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;<a href="https://iperf.fr/" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">https://iperf.fr/</a> </td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">rados bench</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">RADOS 性能测试工具</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">rados bench -p &lt;pool_name&gt; &lt;seconds&gt; &lt;write|seq|rand&gt; -b &lt;block size&gt; -t --no-cleanup</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <ul style="list-style:none;">
        <li style="list-style-type:disc;">Ceph 自带的 RADOS 性能测试工具</li>
       </ul></td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">rados load-gen</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">RADOS 性能测试工具</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><pre># rados -p rbd load-<span style="line-height:1.5;">gen
--num-objects   <span style="line-height:1.5;"> #产生的对象数目 --min-object-<span style="line-height:1.5;">size #最小对象大小 --max-object-<span style="line-height:1.5;">size #最大对象大小 --max-ops #<span style="line-height:1.5;">最大操作数目 --min-op-<span style="line-height:1.5;">len #最小操作长度 --max-op-<span style="line-height:1.5;">len #最大操作长度 --read-percent <span style="line-height:1.5;">#读操作的百分比 --target-throughput <span style="line-height:1.5;">#目标吞吐量，单位 MB --run-length #运行时长，单位秒</span></span></span></span></span></span></span></span></span></pre></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">&nbsp;</p> 
       <ul style="list-style:none;">
        <li style="list-style-type:disc;">Ceph 自带的 rados 性能测试工具</li> 
        <li style="list-style-type:disc;">可在集群内产生指定类型的负载</li> 
        <li style="list-style-type:disc;">比 rados bench 功能丰富，能指定更多的参数</li> 
       </ul></td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">rbd bench-write</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">ceph 自带的 rbd 性能测试工具</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">&nbsp;rbd bench-write &lt;RBD image name&gt;</p> 
       <ul style="list-style:none;">
        <li style="list-style-type:disc;">--io-size：单位 byte，默认 4M</li> 
        <li style="list-style-type:disc;">--io-threads：线程数，默认 16</li> 
        <li style="list-style-type:disc;">--io-total：总写入字节，默认 1024M</li> 
        <li style="list-style-type:disc;">--io-pattern &lt;seq|rand&gt;：写模式，默认为 seq 即顺序写</li> 
       </ul></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <ul style="list-style:none;">
        <li style="list-style-type:disc;">&nbsp;只能对块设备做写测试</li>
       </ul></td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">fio + rbd ioengine</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">fio 结合 rbd IO 引擎的性能测试工具</td> 
      <td rowspan="2" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;参考 fio --help&nbsp;</td> 
      <td rowspan="2" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <ul style="list-style:none;">
        <li style="list-style-type:disc;">Linux 平台上做 IO 性能测试的瑞士军刀</li> 
        <li style="list-style-type:disc;">可以对使用内核内 rbd 和用户空间 librados 进行比较</li> 
        <li style="list-style-type:disc;">标准规则 - 顺序和随机&nbsp;IO</li> 
        <li style="list-style-type:disc;">块大小 - 4k，16k，64k，256k</li> 
        <li style="list-style-type:disc;">模式 - 读和写</li> 
        <li style="list-style-type:disc;">支持混合模式</li> 
       </ul></td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">fio + libaio</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">fio 结合 linux aio 的 rbd 性能测试</td> 
     </tr>
    </tbody>
   </table>
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">3.2 测试结果比较</h3> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"> <span style="line-height:1.5;">所使用的命令：</span> 
     <ul style="list-style:none;font-size:12px;">
      <li style="list-style-type:disc;">rbd bench-write pool.host/image.ph2 &nbsp;--io-total 1719973000 --io-size 4096000 --io-threads 1&nbsp;--io-pattern rand/seq</li> 
      <li style="list-style-type:disc;">rados -p pool.host bench 20 write -t 1 --no-cleanup</li> 
      <li style="list-style-type:disc;">rados -p pool100 load-gen --read-percent 0 --min-object-size 1073741824 --max-object-size 1073741824 --max-ops 1 --read-percent 0/100 --min-op-len 4194304 --max-op-len 4194304 --target-throughput 1073741824 --max_backlog 1073741824</li> 
      <li style="list-style-type:disc;">ceph tell osd.0 bench</li> 
      <li style="list-style-type:disc;">fio/fio -filename=/dev/rbd4 -direct=1 -iodepth 1 -thread -rw=write/read/randwrite/randread&nbsp;-ioengine=libaio -bs=4M -size=1G -numjobs=1 -runtime=120 -group_reporting -name=read-libaio</li> 
     </ul></li> 
    <li style="list-style-type:disc;">结果（<span style="line-height:1.5;text-decoration:underline;color:rgb(0,0,0);"><span style="line-height:1.5;">仅在作者的测试环境的客户端节点上运行以上命令的输出</span></span>）：</li> 
   </ul>
   <table border="0" style="border:1px solid #C0C0C0;border-collapse:collapse;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">
    <tbody>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>操作</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>dd 一个 OSD</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>dd 两个 OSD</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>rados load-gen</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>rados bench</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>rbd bench-write&nbsp;</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>ceph tell osd.0 bench</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>&nbsp;fio + rbd</strong></td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"><strong>fio + libaio&nbsp;</strong></td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">顺序写</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">165</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">18</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">18</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">18</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">74 MB/s （IOPS 9）</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">40 MB/s</p> </td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">21 （iops 5）&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">18（iops 4）</td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">随机写</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">67.8 MB/s （IOPS 8）</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">19 （iops 4）</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">16（iops 4）</td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">顺序读</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">460</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">130</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">100</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">109</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">N/A</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">111（iops 27）</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">111（iops 27）</td> 
     </tr>
     <tr>
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">随机读</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">112</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">N/A</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">115（iops 28）</td> 
      <td style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">128（iops 31）</td> 
     </tr>
    </tbody>
   </table>
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"> <span style="line-height:1.5;">&nbsp;简单结论（<span style="line-height:1.5;color:rgb(0,0,0);"><span style="line-height:1.5;text-decoration:underline;"><span style="line-height:1.5;">由于环境、测试方法和数据有限，这些结论</span></span><span style="line-height:1.5;text-decoration:underline;"><span style="line-height:1.5;">不一定正确，有些只是猜测，需要进一步研究，仅供参考</span></span></span>）：</span>
     <ul style="list-style:none;font-size:12px;">
      <li style="list-style-type:disc;"><span style="line-height:1.5;">rados bench 和在两个 OSD 上同时做 dd 的性能差不多。</span></li> 
      <li style="list-style-type:disc;"><span style="line-height:1.5;">fio + rbd 和 fio + libaio 的结果差不多，相比之下 fio + rbd 还要好一点点。</span></li> 
      <li style="list-style-type:disc;"><span style="line-height:1.5;">fio 顺序写和读的 BW 和两个 OSD 同时写和读的 BW 差不多。</span></li> 
      <li style="list-style-type:disc;"><span style="line-height:1.5;">fio 顺序写的 BW 差不多是 单个 OSD 的 bench 的一半 （因为我的 pool 的 size 为 2）。</span></li> 
      <li style="list-style-type:disc;">rados load-gen，rodos bench 和 fio rbd/libaio 的结果都差不多，可见都可以信任，只是每一种都有其特长，选择合适你的测试应用场景的某个即可。&nbsp;</li> 
      <li style="list-style-type:disc;"><span style="line-height:1.5;">rdb bench-write 的值明显偏高，原因未知，也许存在 bug，详情可参考&nbsp;<a href="http://www.spinics.net/lists/ceph-users/msg24647.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">rbd bench-write vs dd performance confusion</a>，选择时需慎重。</span></li> 
     </ul></li> 
   </ul>
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">3.3 影响Ceph集群性能的因素</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><img src="https://images2017.cnblogs.com/blog/697113/201712/697113-20171216220648218-68222603.png" alt="" style="border:0px;"></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><span style="line-height:1.5;color:rgb(0,0,0);"><strong>注意：作者会保持对本文不断更新。</strong></span></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">&nbsp;</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">参考链接：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"><a href="http://tracker.ceph.com/projects/ceph/wiki/Benchmark_Ceph_Cluster_Performance" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">http://tracker.ceph.com/projects/ceph/wiki/Benchmark_Ceph_Cluster_Performance</a></li> 
    <li style="list-style-type:disc;"><a href="http://telekomcloud.github.io/ceph/2014/02/26/ceph-performance-analysis_fio_rbd.html" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">Ceph Performance Analysis: fio and RBD</a></li> 
    <li style="list-style-type:disc;"><a href="http://www.quts.me/page2/" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">http://www.quts.me/page2/</a></li> 
    <li style="list-style-type:disc;"><a href="http://events.linuxfoundation.org/sites/events/files/slides/Vault-2015.pdf" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">http://events.linuxfoundation.org/sites/events/files/slides/Vault-2015.pdf</a></li> 
    <li style="list-style-type:disc;"><a href="http://www.mellanox.com/blog/2016/02/making-ceph-faster-lessons-from-performance-testing/" rel="nofollow" style="color:rgb(26,139,200);text-decoration:none;">http://www.mellanox.com/blog/2016/02/making-ceph-faster-lessons-from-performance-testing/</a></li> 
   </ul>
   <div>
    <font color="#4b4b4b"><span style="font-size:15px;"><br></span></font>
   </div> 
   <div>
    <font color="#4b4b4b"><span style="font-size:15px;"><br></span></font>
   </div> 
   <div> 
    <font color="#4b4b4b"><span style="font-size:15px;">&nbsp; &nbsp; 本文转自SammyLiu博客园博客，原文链接：http://www.cnblogs.com/sammyliu/p/5557666.html</span></font>
    <span style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
