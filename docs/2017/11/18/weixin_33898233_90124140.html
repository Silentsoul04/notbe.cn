<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>探索 OpenStack 之（10）：深入镜像服务Glance « NotBeCN</title>
  <meta name="description" content="             本篇博文来探讨下镜像服务Glance。    0. &nbsp;基本概念    0.1 基本功能    Glance提供REST API来支持以下镜像操作：        查询     注册     上传     获取     删除     访问权限管理       0.2 Glance...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/18/weixin_33898233_90124140.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">探索 OpenStack 之（10）：深入镜像服务Glance</h1>
    <p class="post-meta">Nov 18, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">本篇博文来探讨下镜像服务Glance。</p> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">0. &nbsp;基本概念</h2> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">0.1 基本功能</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">Glance提供REST API来支持以下镜像操作：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">查询</li> 
    <li style="list-style-type:disc;">注册</li> 
    <li style="list-style-type:disc;">上传</li> 
    <li style="list-style-type:disc;">获取</li> 
    <li style="list-style-type:disc;">删除</li> 
    <li style="list-style-type:disc;">访问权限管理</li> 
   </ul>
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">0.2 Glance REST API的版本V1和V2</h3> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">0.2.1功能差别</h4> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">Glance有两个版本的REST API V1 和 V2，两者之间还是有蛮大的不同：</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（1）. V1只提供了基本的image和member操作功能：镜像创建、删除、下载、列表、详细信息查询、更新，以及镜像tenant成员的创建、删除和列表。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（2）. V2除了支持V1的所有功能外，主要是增加了如下功能：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">镜像 location 的添加、删除和修改等操作</li> 
    <li style="list-style-type:disc;">metadata &nbsp;namespace 操作</li> 
    <li style="list-style-type:disc;">image tag 操作</li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">（3）.V1 和V2对 image store 的支持是相同的。</p> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">0.2.2 实现差别</h4> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">V1的实现上，有glance-api和glance-registry两个WSGI 服务，都提供REST API，只不过glance-API的REST API对外使用，glance-registry的API只由glance-api使用。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><img src="https://images0.cnblogs.com/blog/697113/201501/252153344411874.jpg" alt="" style="border:0px;"></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">而 V2在实现上，把 glance-registry 的功能合并到了 glance-api 中，减少了一个中间环节。</p> 
   <h4 style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">0.2.3 使用差别</h4> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">目前，Glance Cli和Horizon默认还是使用V1版本的API。究其原因，</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">一方面，似乎网上有看到说法说V2的性能没有V1好，我们也能看到使用V2的API的时候，需要多次调用REST API；</li> 
    <li style="list-style-type:disc;">另一方面，我认为V2里面新添加的功能似乎也不是镜像管理的必须功能，所以暂时没怎么被使用也是情理之中。</li> 
   </ul>
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">0.3 image 的数据存放</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">image 的元数据 通过glance-registry 存放在 db 中； image 的chunk 数据 通过 glance-store 存放在各种 backend store 中，并从中获取。</p> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">0.4 image 的访问权限</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">image 的 访问权限分为：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">public 公共的：可以被所有的 tenant 使用。</li> 
    <li style="list-style-type:disc;"><span style="line-height:1.5;">private 私有的/项目的：只能被 image owner 所在的 tenant 使用。</span></li> 
    <li style="list-style-type:disc;">shared 共享的：一个非共有的image 可以 共享给另外的 tenant，可通过member-* 操作来实现。</li> 
    <li style="list-style-type:disc;">protected 受保护的：protected 的 image 不能被删除。</li> 
   </ul>
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">0.5 image 的各种状态</h3> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">queued：没有上传 image 数据，只有db 中的元数据。</li> 
    <li style="list-style-type:disc;">saving：正在上传 image data</li> 
    <li style="list-style-type:disc;">active：正常状态</li> 
    <li style="list-style-type:disc;">deleted/pending_delete： 已删除/等待删除</li> 
    <li style="list-style-type:disc;">killed：image 元数据不正确，等待被删除。</li> 
   </ul>
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">状态图：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"> <p style="line-height:1.5;">'queued' =&gt; ('saving', 'active', 'deleted')<br> 'saving' =&gt; ('active', 'killed', 'deleted', 'queued')<br> 'active' =&gt; ('queued', 'pending_delete', 'deleted')<br> 'killed' =&gt; ('deleted')<br> 'pending_delete' =&gt; ('deleted')<br> 'deleted' =&gt; ()</p> </li>
   </ul>
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">1. V1版本的代码实现</h2> 
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.1 代码模块</h3> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">从上图也可以看出，Glance V1主要是三个模块：</p> 
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;"> 
     <div>
      glance/common/
     </div> 
     <div>
      &nbsp; &nbsp;wsgi.py -- WSGI server,开启glance-(api|registry)服务，接受请求，比如GET /images/bb8838d5-06b5-4f7e-b6ef-87c908f04cc7 HTTP/1.1
     </div> </li> 
    <li style="list-style-type:disc;">glance-api：提供对外REST API，同时调用glance-registry进行数据库操作，以及调用glance-store进行store操作 
     <ul style="list-style:none;font-size:12px;">
      <li style="list-style-type:disc;"> 
       <div>
        images.py -- 实现image-* 操作
       </div> 
       <div>
        memebers.py --实现 member-* 操作
       </div> 
       <div>
        router.py --&nbsp;将WSGI 收到的 HTTP 操作映射到 glance-api 模块的 Controller 类的方法.
       </div> </li>
     </ul></li> 
    <li style="list-style-type:disc;"> <span style="line-height:1.5;">glance-registry：向 glance-api 提供元数据数据库操作&nbsp;</span><span style="line-height:1.5;">REST API，默认在端口9191监听。 主要文件：</span> 
     <ul style="list-style:none;font-size:12px;">
      <li style="list-style-type:disc;"> 
       <div>
        client/v1/
       </div> 
       <div> 
        <div>
         &nbsp; &nbsp; &nbsp; &nbsp; api.py -- registry API 入口，调用client.py中的函数
        </div> 
        <div>
         &nbsp; &nbsp; &nbsp; &nbsp; client.py --调用 images.py 和 members.py 中的function
        </div> 
       </div> 
       <div>
        api/v1/
       </div> 
       <div>
        &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; images.py -- 调用 glance/db/sqlalchemy/api.py 实现&nbsp;images 数据库相关操作
       </div> 
       <div>
        &nbsp; &nbsp; &nbsp; &nbsp; memebers.py --调用&nbsp;glance/db/sqlalchemy/api.py 实现&nbsp;members数据库表的相关操作
       </div> 
       <div> 
        <div>
         glance/db/sqlalchemy/
        </div> 
        <div>
         &nbsp; &nbsp;api.py -- db操作api入口
        </div> 
        <div>
         &nbsp; &nbsp;models.py -- 数据库表模型，每个表对应一个类
        </div> 
       </div> </li>
     </ul></li> 
   </ul>
   <ul style="list-style:none;font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">
    <li style="list-style-type:disc;">glance-store：这部分代码不是在 glance github 代码项目中，不理解为什么不是在一起，cinder也是类似的架构，但是cinder的所有代码都是在一个github项目中。 
     <ul style="list-style:none;font-size:12px;">
      <li style="list-style-type:disc;">glance-store 向&nbsp;glance-api&nbsp;提供文件 backend.py 作为 store 操作的统一入口。主要函数包括： 
       <ul style="list-style:none;">
        <li style="list-style-type:disc;">create_stores：调用store.configure_add，glance-api服务启动的时候根据用户配置调用该函数来注册各个store</li> 
        <li style="list-style-type:disc;">get_from_backend：调用store.get，从store中获取data chunks</li> 
        <li style="list-style-type:disc;">get_size_from_backend：调用store.get_size，从store中获取image size</li> 
        <li style="list-style-type:disc;">delete_from_backend：调用store.delete，从store中删除image data</li> 
        <li style="list-style-type:disc;">store_add_to_backend：调用store.add，添加image到store</li> 
        <li style="list-style-type:disc;">set_acls：调用store.set_acls，设置image的读写权限</li> 
       </ul></li> 
      <li style="list-style-type:disc;">glance-store 提供一个需要各个 store vendor 实现的基类Store，定义了几个需要实现的操作： 
       <ul style="list-style:none;">
        <li style="list-style-type:disc;"><span style="line-height:1.5;">configure_add：根据用户配置来配置该 backend store</span></li> 
        <li style="list-style-type:disc;"><span style="line-height:1.5;">get：获取 image chunk data</span></li> 
        <li style="list-style-type:disc;"><span style="line-height:1.5;">get_size：获取image大小</span></li> 
        <li style="list-style-type:disc;"><span style="line-height:1.5;">add： 添加 image 到store中</span></li> 
        <li style="list-style-type:disc;"><span style="line-height:1.5;">delete： 从 store 中删除 image chunk data</span></li> 
        <li style="list-style-type:disc;"><span style="line-height:1.5;">set_acls： 设置 image 的读写权限</span></li> 
       </ul></li> 
      <li style="list-style-type:disc;"> <span style="line-height:1.5;">目前支持的 backend store 见上图。各backend store所支持的功能差别很大，比如</span> 
       <ul style="list-style:none;">
        <li style="list-style-type:disc;"><span style="line-height:1.5;">cinder.py 只实现了方法&nbsp;get_size，因为目前的 Glance 不支持 upload image &nbsp;到 Cinder volume 中。</span></li> 
        <li style="list-style-type:disc;"><span style="line-height:1.5;">http.py 只实现了 get 和 get_size， 因此只能从http store download image 和查询 image size。</span></li> 
        <li style="list-style-type:disc;"><span style="line-height:1.5;">swift.py 的实现可以说是最全的，filesystem 次之。</span></li> 
       </ul></li> 
      <li style="list-style-type:disc;"> <span style="line-height:1.5;">image 存在于不同store 中时不同的 Location url 格式</span> 
       <ul style="list-style:none;">
        <li style="list-style-type:disc;">cinder://volume-id</li> 
        <li style="list-style-type:disc;">https://user:pass@example.com:80/images/some-id<br> http://images.oracle.com/123456<br> swift://example.com/container/obj-id<br> swift://user:account:pass@authurl.com/container/obj-id<br> wift+http://user:account:pass@authurl.com/container/obj-id<br> s3://accesskey:secretkey@s3.amazonaws.com/bucket/key-id &nbsp; &nbsp; &nbsp;&nbsp;<br> file:///var/lib/glance/images/1<br> s3+https://accesskey:secretkey@s3.amazonaws.com/bucket/key-id</li> 
       </ul></li> 
      <li style="list-style-type:disc;">使用 backend store 
       <ul style="list-style:none;">
        <li style="list-style-type:disc;">默认使用的 store 由配置文件&nbsp;<span style="line-height:1.5;">glance-api.conf 的配置项&nbsp;</span><span style="line-height:1.5;">default_store=&lt;STORE&gt; 指定</span> </li> 
        <li style="list-style-type:disc;"> <span style="line-height:1.5;"><span style="line-height:1.5;">可以使用的 stores 有配置文件&nbsp;glance-api.conf&nbsp;的配置项&nbsp;</span></span><span style="line-height:1.5;">stores=&lt;STORES&gt; 指定</span> </li> 
        <li style="list-style-type:disc;"><span style="line-height:1.5;">在Glance Cli image-create 中可使用参数 --store 指定目标backend store</span></li> 
       </ul></li> 
     </ul></li>
   </ul>
   <h3 style="font-size:16px;color:rgb(102,102,102);background-image:none;background-repeat:no-repeat;font-family:Verdana;line-height:1.5;">1.2 操作流程</h3> 
   <div style="color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"> 
    <table border="1" style="border:1px solid #C0C0C0;border-collapse:collapse;">
     <thead>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Glance Cli</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">glanceclient SDK调用的REST API</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">Glance 内部函数<br>
        <div>
         &nbsp;
        </div> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;Gance 内部函数的具体实现</td> 
      </tr>
     </thead>
     <tbody>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">image-create</p> <p style="line-height:1.5;">创建image</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         POST /images
        </div> 
        <div>
         &nbsp;
        </div> 
        <div>
         &nbsp;
        </div> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/images.py
        </div> 
        <div>
         &nbsp;
        </div> def create(self, req, image_meta, image_data):<br><br>
        <div>
         Adds a new image to Glance
        </div> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;"><strong>1. api/v1/images.py: _reserve.</strong></p> <p style="line-height:1.5;">添加image 元数据到db，获取 image id，设置 image 状态为&nbsp;queued。</p> <p style="line-height:1.5;">1.1. registry/client/v1/client.py:&nbsp; &nbsp;def add_image(self, image_metadata)</p> <p style="line-height:1.5;">1.2. registry/api/v1/images.py:&nbsp;def create(self, req, body)</p> <p style="line-height:1.5;">1.3. db/sqlalchemy/api.py: &nbsp; image_create<br><br><br><strong>2.&nbsp;api/v1/images.py:&nbsp;_handle_source</strong></p> <p style="line-height:1.5;">处理 image data，根据image data 来源分为三种情况：</p> <p style="line-height:1.5;"><span style="line-height:1.5;text-decoration:underline;">2.1 如果 image_data // 如果直接传入了 image data</span><br><br> 2.1.1 def _upload(self, req, image_meta):</p> <p style="line-height:1.5;">将image data 存入指定的 backend store。注意Content-Type 必须为 application/octet-stream。</p> <p style="line-height:1.5;">2.1.1.1 registry.update_image_metadata //&nbsp;设置 image 状态 为 saving</p> <p style="line-height:1.5;">2.1.1.2&nbsp;upload_utils.upload_data_to_store //&nbsp;<br> check_quota //检查用户quota<br> store_api.store_add_to_backend //调用 backend.py 的方法<br> store.add //调用 backend store 实现的方法<br> filesystems.py.&nbsp;def add //如果是filesystem的话，将 image chunk data 写入到一个以 image id 为文件名的文件<br><br> 2.1.2&nbsp;def _activate //调用 glance-registry 设置 image 状态为 active<br><br><span style="line-height:1.5;text-decoration:underline;">2.2 如果是 copy_from，则异步执行上面2.1.1 ~ 2.1.2</span><br><br><span style="line-height:1.5;text-decoration:underline;">2.3 如果是指定 location的话，</span></p> <p style="line-height:1.5;">2.3.1 从location 指定的backend store 中获取 image size</p> <p style="line-height:1.5;">2.3.2 设置 image 状态 为 active</p> </td> 
      </tr>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">image-update</p> <p style="line-height:1.5;">修改image metadata属性或者数据</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         PUT /images/&lt;ID&gt;
        </div> 
        <div>
         &nbsp;
        </div> 
        <div>
         &nbsp;
        </div> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/images.py
        </div> 
        <div>
         &nbsp;
        </div> <p style="line-height:1.5;">def update(self, req, id, image_meta, image_data)</p> <p style="line-height:1.5;"><br> Updates an existing image with the registry</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">注意：</p> <p style="line-height:1.5;">（1）只允许使用&nbsp;Location|Copy-From 来 修改状态为&nbsp;queued 的 image</p> <p style="line-height:1.5;">（2）可修改image 访问权限属性，以及元数据。</p> <p style="line-height:1.5;">&nbsp;</p> <p style="line-height:1.5;">1. 修改 image 访问权限，调用&nbsp;registry.get_image_members，再调用&nbsp;store.set_acls 方法，但是它<a>只有swift支持。</a></p> <p style="line-height:1.5;">2. 修改image 元数据，调用&nbsp;registry.update_image_metadata 方法</p> <p style="line-height:1.5;">3. 上传 image data，调用&nbsp;self._handle_source，见上面 #2.<br><br></p> </td> 
      </tr>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">image-delete</p> <p style="line-height:1.5;">根据image id 删除 指定image</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">DELETE /images/&lt;ID&gt;</p> <p style="line-height:1.5;">&nbsp;</p> <p style="line-height:1.5;">&nbsp;</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/images.py
        </div> 
        <div>
         &nbsp;
        </div> <p style="line-height:1.5;">def delete(self, req, id)</p> <p style="line-height:1.5;"><br> Deletes the image and all its chunks from the Glance</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">1. 调用 registry.get_image_metadata，获取 image 元数据</p> <p style="line-height:1.5;"><br> 2. 检查 image 是否可以被删除，比如是否是 protected等</p> <p style="line-height:1.5;"><br> 3. 调用 registry.update_image_metadata 设置状态为 deleted 或者&nbsp;pending_delete</p> <p style="line-height:1.5;">4. 调用 upload_utils.initiate_deletion 开始 删除操作</p> <p style="line-height:1.5;">4.1 调用<a>backend.py 的del</a>ete_from_backend 方法，它会调用&nbsp;store.delete ，如果image存放在文件系统中的话，调用os.unlink(fn) 方法 删除文件。</p> <p style="line-height:1.5;">4.2&nbsp;db_api.get_api().image_location_delete // 设置表image_locations的id和image_id对应item的 deleted，status，updated_at，deleted_at</p> <p style="line-height:1.5;"><br> 5. 调用 registry.delete_image_metadata 删除 image 元数据&nbsp;</p> <p style="line-height:1.5;">5.1 registry/images.py: def delete(self, req, id)</p> <p style="line-height:1.5;">5.1.1 db/sqlalchemy/api.py: _image_locations_delete_all //Delete all image entries in db table&nbsp;image_locations for the given image id</p> <p style="line-height:1.5;">5.1.2&nbsp;db/sqlalchemy/api.py:&nbsp;_image_child_entry_delete_all //Deletes all the &nbsp;entries in db table image_properties&nbsp;for the given image id</p> 
        <div>
         5.1.3&nbsp;db/sqlalchemy/api.py:&nbsp;_image_child_entry_delete_all //Deletes all the entries in db table image_members&nbsp;for the given image id
        </div> 
        <div>
         &nbsp;
        </div> 
        <div>
         5.1.4&nbsp;db/sqlalchemy/api.py:&nbsp;_image_child_entry_delete_all //Deletes all the entries in db table image_tags for the given image id
        </div> </td> 
      </tr>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">image-list</p> <p style="line-height:1.5;">获取image列表</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         GET /images -- Returns a set of brief metadata about images
        </div> 
        <div>
         &nbsp;
        </div> 
        <div>
         &nbsp;
        </div> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/images.py
        </div> 
        <div>
         &nbsp;
        </div> <p style="line-height:1.5;">def index(self, req)</p> <p style="line-height:1.5;"><br> Returns the following information for all public, available images:</p> 
        <ul style="list-style:none;">
         <li style="list-style-type:disc;">id -- The opaque image identifier</li> 
         <li style="list-style-type:disc;">name -- The name of the image</li> 
         <li style="list-style-type:disc;">disk_format -- The disk image format</li> 
         <li style="list-style-type:disc;">container_format -- The "container" format of the image</li> 
         <li style="list-style-type:disc;">checksum -- MD5 checksum of the image data</li> 
         <li style="list-style-type:disc;"><span style="line-height:1.5;font-size:10px;">size -- Size of image data in bytes</span></li> 
        </ul><p style="line-height:1.5;">比如：</p> <p style="line-height:1.5;">{<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "name3",<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "container_format": null,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "disk_format": null,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "checksum": null,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "1e7b0a5a-7b78-4673-8d56-3abff7b491ae",<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "size": 12336128<br> }</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">调用 registry.get_images_list ，从 db 中获取 image 元数据</td> 
      </tr>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;获取所有image的详细信息</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">GET /images/detail -- Returns a set of detailed metadata about&nbsp; images</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/images.py
        </div> 
        <div>
         &nbsp;
        </div> def detail(self, req)<br><br> Returns detailed information for all available images。比如：<br> {<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "status": "queued",<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "deleted_at": null,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "name": "name3",<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "deleted": false,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "container_format": null,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "created_at": "2015-01-21T23:05:54",<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "disk_format": null,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "updated_at": "2015-01-21T23:05:54",<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "min_disk": 0,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "protected": false,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "1e7b0a5a-7b78-4673-8d56-3abff7b491ae",<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "min_ram": 0,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "checksum": null,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "owner": "fa2046aaead44a698de8268f94759fc1",<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "is_public": false,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "virtual_size": null,<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "properties": {},<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "size": 12336128<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">直接从 db 中获取 image 的各项数据。</p> <p style="line-height:1.5;">1. 调用 registry.get_images_detail<br> 1.1 调用 registry/api/v1/images.py 中的 def detail<br> 1.1.1 调用 db/sqlalchemy/api.py 中的 image_get_all</p> </td> 
      </tr>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">glance image-show</p> <p style="line-height:1.5;">根据image id显示指定image的元数据</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">HEAD /images/&lt;ID&gt; -- Return metadata about an image with id &lt;ID&gt;</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/images.py
        </div> 
        <div>
         &nbsp;
        </div> <p style="line-height:1.5;">def meta(self, req, id)</p> <p style="line-height:1.5;"><br> Returns metadata about an image in the HTTP headers of the response object</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">从 db 中获取 image 部分元数据</p> <p style="line-height:1.5;">1. 调用 self.get_image_meta_or_404(self, request, image_id)<br> 1.1 调用&nbsp;registry.get_image_metadata<br> 1.1.1&nbsp;调用&nbsp;db_api.image_get<br><br></p> </td> 
      </tr>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">image-download</p> <p style="line-height:1.5;">&nbsp;</p> <p style="line-height:1.5;">下载image</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         GET /images/&lt;ID&gt;&nbsp;
        </div> 
        <div>
         -- Return image data for image with id &lt;ID&gt;
        </div> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/images.py
        </div> 
        <div>
         &nbsp;
        </div> <p style="line-height:1.5;">def show(self, req, id)</p> <p style="line-height:1.5;"><br> Returns an iterator that can be used to retrieve an image's&nbsp;&nbsp;data along with the image metadata</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         调用 glance-store 方法返回 image data。
        </div> 
        <div>
         &nbsp;
        </div> 
        <div>
         1. 调用 r
         <span style="line-height:1.5;font-size:10px;">egistry.get_image_metadata，再调用&nbsp;</span>self.db_api.image_get 来获取 image 元数据
        </div> 
        <div>
         &nbsp;
        </div> 
        <div>
         2. 调用 self._get_from_store 获取 image 数据
        </div> 
        <div>
         &nbsp;
        </div> 
        <div>
         2.1 调用 glance_store.location.get_location_from_uri， 从 image uri 中获取 location
        </div> 
        <div>
         2.2 调用 backend.py 的 get_store_from_uri， 获取所用的 store
        </div> 
        <div>
         2.3 调用 store.get 获取 image data
        </div> 
        <div>
         &nbsp;
        </div> </td> 
      </tr>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">member-list --image-id</p> <p style="line-height:1.5;">获取可访问指定image的tenant成员列表</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">GET&nbsp;/images/{image_id}/members</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/members.py
        </div> 
        <div>
         &nbsp;
        </div> <p style="line-height:1.5;">def index(self, req, image_id)</p> <p style="line-height:1.5;"><br> Return a list of dictionaries indicating the members of the&nbsp;&nbsp;image, i.e., those tenants the image is shared with</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">通过 glance-registry 执行 数据库操作。</p> <p style="line-height:1.5;">1.1&nbsp;registry.get_image_members</p> <p style="line-height:1.5;">1.1.1&nbsp;registry/api/v1/members.py:&nbsp;def index</p> <p style="line-height:1.5;">1.1.1.1db/sqlalchemy/api.py:&nbsp;image_get</p> <p style="line-height:1.5;">1.1.1.2db/sqlalchemy/api.py:&nbsp;image_member_find</p> </td> 
      </tr>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">member-list --tenant-id</p> <p style="line-height:1.5;">获取指定tenant的可访问image列表</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">GET&nbsp;/shared-images/{id}</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/members.py
        </div> 
        <div>
         &nbsp;
        </div> <p style="line-height:1.5;">def index_shared_images(self, req, id)</p> <p style="line-height:1.5;"><br> Retrieves list of image memberships for the given member.</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">通过 glance-registry 执行 数据库操作。</p> <p style="line-height:1.5;">1.1&nbsp;registry.get_member_images</p> <p style="line-height:1.5;">1.1.1&nbsp;registry/api/v1/members.py:&nbsp;def index_shared_images</p> <p style="line-height:1.5;">1.1.1.1&nbsp;db/sqlalchemy/api.py:&nbsp;image_member_find</p> </td> 
      </tr>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">member-create</p> <p style="line-height:1.5;">向指定image添加指定tenant可访问成员</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">PUT&nbsp;/images/{image_id}/members/{id}</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/members.py
        </div> 
        <div>
         &nbsp;
        </div> def update(self, req, image_id, id, body=None)<br> Adds a membership to the image, or updates an existing one.</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">通过 glance-registry 执行 数据库操作。</p> <p style="line-height:1.5;">1.1&nbsp;registry.add_member</p> <p style="line-height:1.5;">1.1.1 registry/api/v1/members.py: def delete</p> 
        <div>
         1.1.1.1 db/sqlalchemy/api.py:&nbsp;image_update
        </div> </td> 
      </tr>
      <tr>
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">member-delete</p> <p style="line-height:1.5;">删除指定image的指定可访问tenant成员</p> </td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;">DELETE&nbsp;/images/{image_id}/members/{id}</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> 
        <div>
         glance/api/v1/members.py
        </div> 
        <div>
         &nbsp;
        </div> def delete(self, req, image_id, id) //Removes a membership from the image</td> 
       <td valign="top" style="font-size:12px;color:rgb(69,69,69);border:1px solid #C0C0C0;border-collapse:collapse;"> <p style="line-height:1.5;">通过 glance-registry 执行 数据库操作。</p> <p style="line-height:1.5;">1.1&nbsp;registry.delete_member</p> <p style="line-height:1.5;">1.1.1 registry/api/v1/members.py: def delete</p> <p style="line-height:1.5;">1.1.1.1db/sqlalchemy/api.py:&nbsp;image_get</p> <p style="line-height:1.5;">1.1.1.2 db/sqlalchemy/api.py: image_member_find</p> <p style="line-height:1.5;">1.1.1.3&nbsp;db/sqlalchemy/api.py:&nbsp;image_member_delete</p> </td> 
      </tr>
     </tbody>
    </table>
   </div> 
   <h2 style="font-size:21px;line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">&nbsp;2 小结</h2> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;">Glance 的原理和实现相比较其它组件较简单、直接。V2 REST API 内容有不少增加，还需要进一步的研究。</p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><br></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><br></p> 
   <p style="line-height:1.5;"><font color="#4b4b4b"><span style="font-size:15px;">&nbsp; &nbsp;本文转自SammyLiu博客园博客，原文链接：http://www.cnblogs.com/sammyliu/p/4249151.html</span></font><span style="font-size:15px;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span></p> 
   <div>
    <br>
   </div> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><br></p> 
   <p style="line-height:1.5;color:rgb(75,75,75);font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;font-size:15px;"><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
