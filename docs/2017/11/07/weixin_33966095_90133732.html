<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>深入了解STL中set与hash_set，hash表基础 « NotBeCN</title>
  <meta name="description" content="             一，set和hash_set简介    在STL中，set是以红黑树（RB-Tree）作为底层数据结构的，hash_set是以哈希表（Hash table）作为底层数据结构的。set可以在时间复杂度为O（logN）的情况下插入，删除和查找数据。hash_set操作的时间度则比较复杂，取决...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/07/weixin_33966095_90133732.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">深入了解STL中set与hash_set，hash表基础</h1>
    <p class="post-meta">Nov 7, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>一，set和hash_set简介</strong></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">在STL中，set是以红黑树（RB-Tree）作为底层数据结构的，hash_set是以哈希表（Hash table）作为底层数据结构的。set可以在时间复杂度为O（logN）的情况下插入，删除和查找数据。hash_set操作的时间度则比较复杂，取决于哈希函数和哈希表的负载情况。</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/323808/201602/323808-20160201094549210-915525166.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>二，SET使用范例（hash_set类似）</strong></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> #include &lt;<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>&gt;
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> #include &lt;ctime&gt;
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> #include &lt;cstdio&gt;
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">using</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">namespace</span><span style="font-size:12px;line-height:1.5;"> std;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span><span style="font-size:12px;line-height:1.5;"> main()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">const</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> MAXN = <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">15</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span><span style="font-size:12px;line-height:1.5;"> a[MAXN];
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span><span style="font-size:12px;line-height:1.5;"> i;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="font-size:12px;line-height:1.5;">    srand(time(NULL));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> (i = <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>; i &lt; MAXN; ++<span style="font-size:12px;line-height:1.5;">i)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span>         a[i] = rand() % (MAXN * <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>&lt;<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span>&gt;<span style="font-size:12px;line-height:1.5;"> iset;   
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>&lt;<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span>&gt;<span style="font-size:12px;line-height:1.5;">::iterator pos; 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">插入数据 insert()有三种重载</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span>     iset.insert(a, a +<span style="font-size:12px;line-height:1.5;"> MAXN);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">当前集合中个数 最大容纳数据量</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">当前集合中个数: %d     最大容纳数据量: %d\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, iset.size(), iset.max_size());
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">依次输出</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">依次输出集合中所有元素-------\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> (pos = iset.begin(); pos != iset.end(); ++<span style="font-size:12px;line-height:1.5;">pos)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span>         printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">%d </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, *<span style="font-size:12px;line-height:1.5;">pos);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span>     putchar(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">查找</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> findNum =<span style="font-size:12px;line-height:1.5;"> MAXN;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">查找 %d是否存在-----------------------\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, findNum);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">33</span>     pos =<span style="font-size:12px;line-height:1.5;"> iset.find(findNum);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">34</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (pos !=<span style="font-size:12px;line-height:1.5;"> iset.end())
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">35</span>         printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">%d 存在\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, findNum);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">36</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">else</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">37</span>         printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">%d 不存在\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, findNum);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">38</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">39</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">在最后位置插入数据，如果给定的位置不正确，会重新找个正确的位置并返回该位置</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">40</span>     pos  = iset.insert(--iset.end(), MAXN * <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span><span style="font-size:12px;line-height:1.5;">); 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">41</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">已经插入%d\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, *<span style="font-size:12px;line-height:1.5;">pos);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">42</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">43</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">删除</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">44</span> <span style="font-size:12px;line-height:1.5;">    iset.erase(MAXN);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">45</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">已经删除%d\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, MAXN);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">46</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">47</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">依次输出</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">48</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">依次输出集合中所有元素-------\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">49</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> (pos = iset.begin(); pos != iset.end(); ++<span style="font-size:12px;line-height:1.5;">pos)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">50</span>         printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">%d </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, *<span style="font-size:12px;line-height:1.5;">pos);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">51</span>     putchar(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">52</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">53</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">运行结果</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/323808/201602/323808-20160201095134038-1084420149.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>三，SET与HASH_SET性能对比</strong></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> #include &lt;<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>&gt;
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> #include &lt;hash_set&gt;
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> #include &lt;iostream&gt;
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> #include &lt;ctime&gt;
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> #include &lt;cstdio&gt;
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> #include &lt;cstdlib&gt;
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">using</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">namespace</span><span style="font-size:12px;line-height:1.5;"> std;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">using</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">namespace</span> stdext;  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">hash_set
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> MAXN个数据 MAXQUERY次查询</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">const</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> MAXN = <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">10000</span>, MAXQUERY = <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">5000000</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span><span style="font-size:12px;line-height:1.5;"> a[MAXN], query[MAXQUERY];
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> PrintfContainertElapseTime(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">char</span> *pszContainerName, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">char</span> *pszOperator, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">long</span><span style="font-size:12px;line-height:1.5;"> lElapsetime)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">%s 的%s操作 用时 %d毫秒\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, pszContainerName, pszOperator, lElapsetime);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span><span style="font-size:12px;line-height:1.5;"> main()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">set VS hash_set 性能测试 数据容量 %d个 查询次数 %d次\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, MAXN, MAXQUERY);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">const</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> MAXNUM = MAXN * <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">4</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">const</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> MAXQUERYNUM = MAXN * <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">4</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">容器中数据范围 [0, %d) 查询数据范围[0, %d)\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, MAXNUM, MAXQUERYNUM);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">随机生成在[0, MAXNUM)范围内的MAXN个数</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span><span style="font-size:12px;line-height:1.5;"> i;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span> <span style="font-size:12px;line-height:1.5;">    srand(time(NULL));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> (i = <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>; i &lt; MAXN; ++<span style="font-size:12px;line-height:1.5;">i)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span>         a[i] = (rand() * rand()) %<span style="font-size:12px;line-height:1.5;"> MAXNUM;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">随机生成在[0, MAXQUERYNUM)范围内的MAXQUERY个数</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span> <span style="font-size:12px;line-height:1.5;">    srand(time(NULL));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">33</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> (i = <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>; i &lt; MAXQUERY; ++<span style="font-size:12px;line-height:1.5;">i)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">34</span>         query[i] = (rand() * rand()) %<span style="font-size:12px;line-height:1.5;"> MAXQUERYNUM;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">35</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">36</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>&lt;<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span>&gt;<span style="font-size:12px;line-height:1.5;">       nset;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">37</span>     hash_set&lt;<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span>&gt;<span style="font-size:12px;line-height:1.5;"> nhashset;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">38</span> <span style="font-size:12px;line-height:1.5;">    clock_t  clockBegin, clockEnd;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">39</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">40</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">41</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">insert</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">42</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">-----插入数据-----------\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">43</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">44</span>     clockBegin =<span style="font-size:12px;line-height:1.5;"> clock();  
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">45</span>     nset.insert(a, a +<span style="font-size:12px;line-height:1.5;"> MAXN); 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">46</span>     clockEnd =<span style="font-size:12px;line-height:1.5;"> clock();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">47</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">set中有数据%d个\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, nset.size());
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">48</span>     PrintfContainertElapseTime(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">set</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">insert</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, clockEnd -<span style="font-size:12px;line-height:1.5;"> clockBegin);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">49</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">50</span>     clockBegin =<span style="font-size:12px;line-height:1.5;"> clock();  
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">51</span>     nhashset.insert(a, a +<span style="font-size:12px;line-height:1.5;"> MAXN); 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">52</span>     clockEnd =<span style="font-size:12px;line-height:1.5;"> clock();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">53</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">hash_set中有数据%d个\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, nhashset.size());
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">54</span>     PrintfContainertElapseTime(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">hase_set</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">insert</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, clockEnd -<span style="font-size:12px;line-height:1.5;"> clockBegin);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">55</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">56</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">57</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">find</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">58</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">-----查询数据-----------\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">59</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">60</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span><span style="font-size:12px;line-height:1.5;"> nFindSucceedCount, nFindFailedCount; 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">61</span>     nFindSucceedCount = nFindFailedCount = <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">62</span>     clockBegin =<span style="font-size:12px;line-height:1.5;"> clock(); 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">63</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> (i = <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>; i &lt; MAXQUERY; ++<span style="font-size:12px;line-height:1.5;">i)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">64</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (nset.find(query[i]) !=<span style="font-size:12px;line-height:1.5;"> nset.end())
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">65</span>             ++<span style="font-size:12px;line-height:1.5;">nFindSucceedCount;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">66</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">else</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">67</span>             ++<span style="font-size:12px;line-height:1.5;">nFindFailedCount;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">68</span>     clockEnd =<span style="font-size:12px;line-height:1.5;"> clock();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">69</span>     PrintfContainertElapseTime(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">set</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">find</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, clockEnd -<span style="font-size:12px;line-height:1.5;"> clockBegin);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">70</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">查询成功次数： %d    查询失败次数： %d\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, nFindSucceedCount, nFindFailedCount);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">71</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">72</span>     nFindSucceedCount = nFindFailedCount = <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">73</span>     clockBegin =<span style="font-size:12px;line-height:1.5;"> clock();  
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">74</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> (i = <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>; i &lt; MAXQUERY; ++<span style="font-size:12px;line-height:1.5;">i)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">75</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (nhashset.find(query[i]) !=<span style="font-size:12px;line-height:1.5;"> nhashset.end())
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">76</span>             ++<span style="font-size:12px;line-height:1.5;">nFindSucceedCount;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">77</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">else</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">78</span>             ++<span style="font-size:12px;line-height:1.5;">nFindFailedCount;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">79</span>     clockEnd =<span style="font-size:12px;line-height:1.5;"> clock();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">80</span>     PrintfContainertElapseTime(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">hash_set</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">find</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, clockEnd -<span style="font-size:12px;line-height:1.5;"> clockBegin);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">81</span>     printf(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">查询成功次数： %d    查询失败次数： %d\n</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">, nFindSucceedCount, nFindFailedCount);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">82</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">83</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">运行结果如下：</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/323808/201602/323808-20160201095738960-996043585.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">由于查询的失败次数太多，这次将查询范围变小使用再测试下：</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/323808/201602/323808-20160201095806194-1362889845.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">由于结点过多，80多万个结点，set的红黑树树高约为19(2^19=524288，2^20=1048576)，查询起来还是比较费时的。hash_set在时间性能上比set要好一些，并且如果查询成功的几率比较大的话，hash_set会有更好的表现。</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="line-height:1.5;">四，深入分析hash_set</span></strong></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>1. hash table</strong></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;hash_set的底层数据结构是哈希表，因此要深入了解hash_set，必须先分析哈希表。&nbsp;hash表的出现主要是为了对内存中数据的快速、随机的访问。它主要有三个关键点：Hash表的大小、Hash函数、冲突的解决。哈希表是根据关键码值(Key-Value)而直接进行访问的数据结构，它用哈希函数处理数据得到关键码值，关键码值对应表中一个特定位置再由应该位置来访问记录，这样可以在时间复杂性度为O(1)内访问到数据。但是很有可能出现多个数据经哈希函数处理后得到同一个关键码——这就产生了冲突，解决冲突的方法也有很多，各大数据结构教材及考研辅导书上都会介绍大把方法。这里采用最方便最有效的一种——链地址法，当有冲突发生时将具同一关键码的数据组成一个链表。下图展示了链地址法的使用：</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/323808/201602/323808-20160202101626460-75083552.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="line-height:1.5;">2. 关于Hash表的大小</span></strong></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.5;">　　Hash表的大小一般是定长的，如果太大，则浪费空间，如果太小，冲突发生的概率变大，体现不出效率。所以，选择合适的Hash表的大小是Hash表性能的关键。</span></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　对于Hash表大小的选择通常会考虑两点：</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　第一，确保Hash表的大小是一个素数。常识告诉我们，当除以一个素数时，会产生最分散的余数，可能最糟糕的除法是除以2的倍数，因为这只会屏蔽被除数中的位。由于我们通常使用表的大小对hash函数的结果进行模运算，如果表的大小是一个素数，就可以获得最佳的结果。</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　第二，创建大小合理的hash表。这就涉及到hash表的一个概念：装填因子。设装填因子为a，则：</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;text-align:center;">a=表中记录数/hash表表长</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　通常，我们关注的是使hash表的平均查找长度最小，而平均查找长度是装填因子的函数，而不是表长n的函数。a的取值越小，产生冲突的机会就越小，但如果a取值过小，则会造成较大的空间浪费，通常，只要a的取值合适，hash表的平均查找长度就是一个常数，即hash表的平均查找长度为O(1)。</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　当然，根据不同的数据量，会有不同的哈希表的大小。<span style="color:rgb(255,0,0);">对于数据量时多时少的应用，最好的设计是使用动态可变尺寸的哈希表，那么如果你发现哈希表尺寸太小了，比如其中的元素是哈希表尺寸的2倍时，我们就需要扩大哈希表尺寸，一般是扩大一倍。</span><br> 下面是哈希表尺寸大小的可能取值（素数，后边是前边的2倍左右）：<br> 17, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;37, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;79, &nbsp; &nbsp; &nbsp; &nbsp;163, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;331, &nbsp;&nbsp;673, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1361, &nbsp; &nbsp; &nbsp; &nbsp;2729, &nbsp; &nbsp; &nbsp; 5471, &nbsp; &nbsp; &nbsp; &nbsp; 10949, &nbsp;21911, &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;43853, &nbsp; &nbsp; &nbsp;87719, &nbsp; &nbsp; &nbsp;175447, &nbsp; &nbsp; &nbsp;350899,701819, &nbsp; &nbsp; &nbsp; &nbsp; 1403641, &nbsp; &nbsp;2807303, &nbsp; &nbsp; 5614657, 11229331,&nbsp;22458671, &nbsp; &nbsp; &nbsp; 44917381, &nbsp; &nbsp;89834777, &nbsp; &nbsp;179669557, &nbsp; 359339171, &nbsp;718678369, &nbsp; &nbsp; &nbsp;1437356741, &nbsp;2147483647</p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　那么C++的STL中hash_set是如何实现动态增加哈希表长度的呢？</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　首先来看看VS2008中hash_set是如何实现动态的增加表的大小，hash_set是在hash_set.h中声明的，在hash_set.h中可以发现hash_set是继承_Hash类的，hash_set本身并没有太多的代码，只是对_Hash作了进一步的封装，这种做法在STL中非常常见，如stack栈和queue单向队列都是以deque双向队列作底层数据结构再加一层封装。</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">_Hash类的定义和实现都在xhash.h类中，微软对_Hash类的第一句注释如下——</p> 
   <p align="left" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:rgb(255,0,0);">hash table -- list with vector of iterators for quick access。</span></p> 
   <p align="left" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　这说明_Hash实际上就是由vector和list组成哈希表。再阅读下代码可以发现_Hash类增加空间由_Grow()函数完成，<strong>当空间不足时就倍增（或者近2被的素数），并且表中原有数据都要重新计算hash值以确定新的位置。也就是重新申请一个更大的空间，同时将原来hash_set中的值逐个放到新的hash_set中。</strong></p> 
   <p style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>3. 哈希函数</strong></p> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    实际工作中需视不同的情况采用不同的哈希函数，通常考虑的因素有：
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    · 计算哈希函数所需时间
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    · 关键字的长度
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    · 哈希表的大小
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    · 关键字的分布情况
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    · 记录的查找频率
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    1.&nbsp;直接寻址法：取关键字或关键字的某个线性函数值为散列地址。即H(key)=key或H(key) = a·key + b，其中a和b为常数（这种散列函数叫做自身函数）。若其中H(key）中已经有值了，就往下一个找，直到H(key）中没有值了，就放进去。
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    2. 数字分析法：分析一组数据，比如一组员工的出生年月日，这时我们发现出生年月日的前几位数字大体相同，这样的话，出现冲突的几率就会很大，但是我们发现年月日的后几位表示月份和具体日期的数字差别很大，如果用后面的数字来构成散列地址，则冲突的几率会明显降低。因此数字分析法就是找出数字的规律，尽可能利用这些数据来构造冲突几率较低的散列地址。
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    3. 平方取中法：当无法确定关键字中哪几位分布较均匀时，可以先求出关键字的平方值，然后按需要取平方值的中间几位作为哈希地址。这是因为：平方后中间几位和关键字中每一位都相关，故不同关键字会以较高的概率产生不同的哈希地址。
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    例：我们把英文字母在字母表中的位置序号作为该英文字母的内部编码。例如K的内部编码为11，E的内部编码为05，Y的内部编码为25，A的内部编码为01, B的内部编码为02。由此组成关键字“KEYA”的内部代码为11052501，同理我们可以得到关键字“KYAB”、“AKEY”、“BKEY”的内部编码。之后对关键字进行平方运算后，取出第7到第9位作为该关键字哈希地址，如下图所示
   </div> 
   <table class="table-view log-set-param" style="border-collapse:collapse;border-spacing:0px;border:1px solid #C0C0C0;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        关键字
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        内部编码
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        内部编码的平方值
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        H(k)关键字的哈希地址
       </div> </td> 
     </tr>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        KEYA
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        11050201
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        122157778355001
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        778
       </div> </td> 
     </tr>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        KYAB
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        11250102
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        126564795010404
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        795
       </div> </td> 
     </tr>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        AKEY
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        01110525
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        001233265775625
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        265
       </div> </td> 
     </tr>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        BKEY
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        02110525
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        004454315775625
       </div> </td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"> 
       <div class="para">
        315
       </div> </td> 
     </tr>
    </tbody>
   </table>
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    &nbsp;
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    4. 折叠法：将关键字分割成位数相同的几部分，最后一部分位数可以不同，然后取这几部分的叠加和（去除进位）作为散列地址。数位叠加可以有移位叠加和间界叠加两种方法。移位叠加是将分割后的每一部分的最低位对齐，然后相加；间界叠加是从一端向另一端沿分割界来回折叠，然后对齐相加。
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    5. 随机数法：选择一随机函数，取关键字的随机值作为散列地址，通常用于关键字长度不同的场合。
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    6. 除留余数法：取关键字被某个不大于散列表表长m的数p除后所得的余数为散列地址。即 H(key) = key MOD p,p&lt;=m。不仅可以对关键字直接取模，也可在折叠、平方取中等运算之后取模。对p的选择很重要，一般取素数或m，若p选的不好，容易产生同义词。
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    &nbsp;
   </div> 
   <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <strong>4. 冲突处理方法</strong>
   </div> 
   <div class="para"> 
    <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     1.&nbsp;开放寻址法：Hi=(H(key) + di) MOD m,i=1,2，…，k(k&lt;=m-1），其中H(key）为散列函数，m为散列表长，di为增量序列，可有下列三种取法：
    </div> 
    <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     　　1.1. di=1,2,3，…，m-1，称线性探测再散列；
    </div> 
    <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     　　1.2. di=1^2,-1^2,2^2,-2^2，±⑶^2，…，±(k)^2,(k&lt;=m/2）称二次探测再散列；
    </div> 
    <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     　　1.3. di=伪随机数序列，称伪随机探测再散列。
    </div> 
    <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     2. 再散列法：Hi=RHi(key),i=1,2，…，k RHi均是不同的散列函数，即在同义词产生地址冲突时计算另一个散列函数地址，直到冲突不再发生，这种方法不易产生“聚集”，但增加了计算时间。
    </div> 
    <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     3. 链地址法（拉链法）
    </div> 
    <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     4. 建立一个公共溢出区
    </div> 
    <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     <br>
    </div> 
    <div class="para" style="color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     <br>
    </div> 
    <div class="para"> 
     <font color="#333333"><span style="font-size:14px;">本文转自ZH奶酪博客园博客，原文链接：http://www.cnblogs.com/CheeseZH/p/5176970.html，如需转载请自行联系原作者</span></font>
     <br>
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
