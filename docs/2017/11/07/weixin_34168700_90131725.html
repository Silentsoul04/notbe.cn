<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>深度学习笔记之使用Faster-Rcnn进行目标检测 （实践篇） « NotBeCN</title>
  <meta name="description" content="             实验    　　我使用的代码是Python版本的Faster Rcnn，官方也有Matlab版本的,链接如下:    py-faster-rcnn(python)    faster-rcnn(matlab)    &nbsp;    &nbsp;    环境配置    　　按照官方的R...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/07/weixin_34168700_90131725.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">深度学习笔记之使用Faster-Rcnn进行目标检测 （实践篇）</h1>
    <p class="post-meta">Nov 7, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <h1 style="font-size:28px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">实验</h1> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　我使用的代码是<a class="replace_word" title="Python知识库" href="http://lib.csdn.net/base/python" rel="nofollow" style="color:rgb(223,52,52);font-weight:bold;">Python</a>版本的<code>Faster Rcnn</code>，官方也有<code>Matlab</code>版本的,链接如下:</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><a href="https://github.com/rbgirshick/py-faster-rcnn" rel="nofollow" style="color:#000000;">py-faster-rcnn(python)</a></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><a href="https://github.com/ShaoqingRen/faster_rcnn" rel="nofollow" style="color:#000000;">faster-rcnn(matlab)</a></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</h2> 
   <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">环境配置</h2> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　按照官方的<code>README</code>进行配置就好,不过在这之前大家还是看下硬件要求吧</p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);line-height:1.6;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <blockquote style="background:none;border:2px solid rgb(239,239,239);line-height:1.6;"> 
     <ul>
      <li style="list-style:disc;"> <p>For training smaller networks (ZF, VGG_CNN_M_1024) a good GPU (e.g., Titan, K20, K40, …) with at least 3G of memory suffices</p> </li> 
      <li style="list-style:disc;"> <p>For training Fast R-CNN with VGG16, you’ll need a K40 (~11G of memory)</p> </li> 
      <li style="list-style:disc;"> <p>For training the end-to-end version of Faster R-CNN with VGG16, 3G of GPU memory is sufficient (using CUDNN)</p> </li> 
     </ul>
    </blockquote>
   </blockquote> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="color:rgb(0,0,255);">我的是环境是Ubuntu 14.04 + Titan X(12GB) + cuda 7.0 + cudnn V3。</span></strong></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:14pt;"><strong>1&nbsp;<code>Caffe</code>环境配置</strong></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　Caffe环境需要python layer的支持,在你的Caffe的<code>Makefile.config</code>中去掉以下的注释</p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);line-height:1.6;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <blockquote style="background:none;border:2px solid rgb(239,239,239);line-height:1.6;"> 
     <ul>
      <li style="list-style:disc;">WITH_PYTHON_LAYER := 1</li> 
      <li style="list-style:disc;">USE_CUDNN := 1</li> 
     </ul>
    </blockquote>
   </blockquote> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:14pt;"><strong>2 安装python库依赖</strong></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>cython</code>,<code>python-<a class="replace_word" title="OpenCV知识库" href="http://lib.csdn.net/base/opencv" rel="nofollow" style="color:rgb(223,52,52);font-weight:bold;">OpenCV</a></code>和<code>easydict</code></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="font-size:12px;line-height:1.5;">pip install cython
pip install python</span>-<span style="font-size:12px;line-height:1.5;">opencv
pip install easydict</span></pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="font-size:14pt;">3 克隆<code>py-faster-rcnn</code>源代码</span></strong></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre>git clone --recursive https:<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">github.com/rbgirshick/py-faster-rcnn.git</span></pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="font-size:14pt;">4 编译<code>cython</code>模块</span></strong></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre>cd $FRCN_ROOT/<span style="font-size:12px;line-height:1.5;">lib
make </span></pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="font-size:14pt;">5 编译<code>Caffe</code>和<code>pycaffe</code></span></strong></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre>cd $FRCN_ROOT/caffe-fast-<span style="font-size:12px;line-height:1.5;">rcnn
make </span>-j8 &amp;&amp; make pycaffe</pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>-j8</strong>的选项是进行多核编译，可以加速编译过程，推荐使用</p> 
   <pre class="prettyprint"><code class="language-bash hljs has-numbering" style="line-height:1.8;vertical-align:middle;font-family:'Courier New', sans-serif;font-size:12px;border:1px solid rgb(204,204,204);"><span class="hljs-built_in" style="color:rgb(0,0,255);">&nbsp;</span></code></pre> 
   <ul class="pre-numbering" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <li style="list-style:disc;"></li>
   </ul>
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">数据集</h2> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　参考<code>VOC2007</code>的数据集格式，主要包括三个部分:</p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);line-height:1.6;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <blockquote style="background:none;border:2px solid rgb(239,239,239);line-height:1.6;"> 
     <ul>
      <li style="list-style:disc;"> <p>JPEGImages</p> </li> 
      <li style="list-style:disc;"> <p>Annotations</p> </li> 
      <li style="list-style:disc;"> <p>ImageSets/Main</p> </li> 
     </ul>
    </blockquote>
   </blockquote> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　JPEGImages</code>&nbsp;—&gt; 存放你用来训练的原始图像</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　Annotations</code>&nbsp;—&gt; 存放原始图像中的Object的坐标信息，XML格式</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　ImageSets/Main</code>&nbsp;—&gt; 指定用来train，trainval，val和test的图片的编号</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　这部分非常重要，数据集做不好直接导致代码出现异常，无法运行，或者出现奇怪的错误，我也是掉进了很多坑，爬上来之后才写的这篇博客，希望大家不要趟我趟过的浑水！每一个部分我都会细说的！</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</h3> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">JPEGImages</h3> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　这个没什么，直接把你的图片放入就可以了，但是有三点注意:</p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);line-height:1.6;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <blockquote style="background:none;border:2px solid rgb(239,239,239);line-height:1.6;"> 
     <ul>
      <li style="list-style:disc;"> <p>编号要以6为数字命名，例如000034.jpg</p> </li> 
      <li style="list-style:disc;"> <p>图片要是JPEG/JPG格式的，PNG之类的需要自己转换下</p> </li> 
      <li style="list-style:disc;"> <p><strong>图片的长宽比(width/height)要在0.462-6.828之间</strong>，就是太过<code>瘦长</code>的图片不要</p> </li> 
     </ul>
    </blockquote>
   </blockquote> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　0.462-6.828是我自己实验得出来的，就我的数据集而言是这个比例，总之长宽比太大或者太小的，你要注意将其剔除，否则可能会出现下面我实验时候出的错:</p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);line-height:1.6;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <blockquote style="background:none;border:2px solid rgb(239,239,239);line-height:1.6;"> 
     <p>Traceback (most recent call last):&nbsp;<br> File “/usr/lib/python2.7/multiprocessing/process.py”, line 258, in _bootstrap&nbsp;<br> self.run()&nbsp;<br> File “/usr/lib/python2.7/multiprocessing/process.py”, line 114, in run&nbsp;<br> self._target(*self._args, **self._kwargs)&nbsp;<br> File “./tools/train_faster_rcnn_alt_opt.py”, line 130, in train_rpn&nbsp;<br> max_iters=max_iters)&nbsp;<br> File “/home/work-station/zx/py-faster-rcnn/tools/../lib/fast_rcnn/train.py”, line 160, in train_net&nbsp;<br> model_paths = sw.train_model(max_iters)&nbsp;<br> File “/home/work-station/zx/py-faster-rcnn/tools/../lib/fast_rcnn/train.py”, line 101, in train_model&nbsp;<br> self.solver.step(1)&nbsp;<br> File “/home/work-station/zx/py-faster-rcnn/tools/../lib/rpn/anchor_target_layer.py”, line 137, in forward&nbsp;<br> gt_argmax_overlaps = overlaps.argmax(axis=0)&nbsp;<br> ValueError: attempt to get argmax of an empty sequence</p> 
    </blockquote>
   </blockquote> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　Google给出的原因是&nbsp;<strong>Because the ratio of images width and heights is too small or large</strong>，这个非常重要。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">Annotations</h3> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　faster rcnn</code>训练需要图像的<code>bounding box</code>信息作为监督(ground truth),所以你需要将你的所有可能的object使用框标注，并写上坐标，最终是一个XML格式的文件，<strong>一个训练图片对应Annotations下的一个同名的XML文件</strong></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　参考官方VOC的Annotations的格式:</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>&lt;annotation&gt;
    &lt;folder&gt;VOC2007&lt;/folder&gt;<span style="font-size:12px;line-height:1.5;"> #数据集文件夹
    </span>&lt;filename&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">000105</span>.jpg&lt;/filename&gt;<span style="font-size:12px;line-height:1.5;"> #图片的name
    </span>&lt;source&gt;<span style="font-size:12px;line-height:1.5;"> #注释信息，无所谓有无
        </span>&lt;database&gt;The VOC2007 Database&lt;/database&gt;
        &lt;annotation&gt;PASCAL VOC2007&lt;/annotation&gt;
        &lt;image&gt;flickr&lt;/image&gt;
        &lt;flickrid&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">321862192</span>&lt;/flickrid&gt;
    &lt;/source&gt;
    &lt;owner&gt;<span style="font-size:12px;line-height:1.5;"> #注释信息，无所谓有无
        </span>&lt;flickrid&gt;Eric T. Johnson&lt;/flickrid&gt;
        &lt;name&gt;?&lt;/name&gt;
    &lt;/owner&gt;
    &lt;size&gt;<span style="font-size:12px;line-height:1.5;"> #图片大小
        </span>&lt;width&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">500</span>&lt;/width&gt;
        &lt;height&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">333</span>&lt;/height&gt;
        &lt;depth&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">3</span>&lt;/depth&gt;
    &lt;/size&gt;
    &lt;segmented&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>&lt;/segmented&gt;
    &lt;<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">object</span>&gt;<span style="font-size:12px;line-height:1.5;"> #多少个框就有多少个object标签
        </span>&lt;name&gt;boat&lt;/name&gt;<span style="font-size:12px;line-height:1.5;"> #bounding box中的object的class name
        </span>&lt;pose&gt;Frontal&lt;/pose&gt;
        &lt;truncated&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span>&lt;/truncated&gt;
        &lt;difficult&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>&lt;/difficult&gt;
        &lt;bndbox&gt;
            &lt;xmin&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">22</span>&lt;/xmin&gt;<span style="font-size:12px;line-height:1.5;"> #框的坐标
            </span>&lt;ymin&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span>&lt;/ymin&gt;
            &lt;xmax&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">320</span>&lt;/xmax&gt;
            &lt;ymax&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">314</span>&lt;/ymax&gt;
        &lt;/bndbox&gt;
    &lt;/<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">object</span>&gt;
    &lt;<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">object</span>&gt;
        &lt;name&gt;person&lt;/name&gt;
        &lt;pose&gt;Frontal&lt;/pose&gt;
        &lt;truncated&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span>&lt;/truncated&gt;
        &lt;difficult&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>&lt;/difficult&gt;
        &lt;bndbox&gt;
            &lt;xmin&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">202</span>&lt;/xmin&gt;
            &lt;ymin&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">71</span>&lt;/ymin&gt;
            &lt;xmax&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">295</span>&lt;/xmax&gt;
            &lt;ymax&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">215</span>&lt;/ymax&gt;
        &lt;/bndbox&gt;
    &lt;/<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">object</span>&gt;
    &lt;<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">object</span>&gt;
        &lt;name&gt;person&lt;/name&gt;
        &lt;pose&gt;Frontal&lt;/pose&gt;
        &lt;truncated&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span>&lt;/truncated&gt;
        &lt;difficult&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>&lt;/difficult&gt;
        &lt;bndbox&gt;
            &lt;xmin&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">170</span>&lt;/xmin&gt;
            &lt;ymin&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">107</span>&lt;/ymin&gt;
            &lt;xmax&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">239</span>&lt;/xmax&gt;
            &lt;ymax&gt;<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">206</span>&lt;/ymax&gt;
        &lt;/bndbox&gt;
    &lt;/<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">object</span>&gt;
&lt;/annotation&gt;</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　这里有一个非常好用的工具<a href="https://github.com/tzutalin/labelImg" rel="nofollow" style="color:#000000;">VOC框图工具</a>，可以自动帮你生成需要的XML格式，实际中发现格式基本无误，只有小的地方需要改动下，大家对比下就知道怎么改了，我是在<a class="replace_word" title="Linux知识库" href="http://lib.csdn.net/base/linux" rel="nofollow" style="color:rgb(223,52,52);font-weight:bold;">Linux</a>下借助<code>sed</code>修改的，这个不难<code class="hljs xml has-numbering"></code></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">Imagesets/Main</h3> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　因为VOC的数据集可以做很多的CV任务，比如Object detection, Semantic segementation, Edge detection等，所以Imageset下有几个子文件夹(Layout, Main, Segementation)，我们只要修改下Main下的文件就可以了(<code>train.txt</code>,&nbsp;<code>trainval.txt</code>,&nbsp;<code>val.txt</code>,&nbsp;<code>test.txt</code>)，里面写上你想要进行任务的图片的编号</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　将上述你的<strong>数据集放在<code>py-faster-rcnn/data/VOCdevkit2007/VOC2007</code>下面</strong>，替换原始VOC2007的<code>JPEGIMages</code>,<code>Imagesets</code>,<code>Annotations</code></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">原始VOC2007下载地址:&nbsp;<a href="http://pjreddie.com/projects/pascal-voc-dataset-mirror/" rel="nofollow" style="color:#000000;">VOC20007数据集</a></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">代码修改</h2> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">　　工程目录介绍</h3> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);line-height:1.6;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <blockquote style="background:none;border:2px solid rgb(239,239,239);line-height:1.6;"> 
     <ul>
      <li style="list-style:disc;"> <p>caffe-fast-rcnn —&gt; caffe框架</p> </li> 
      <li style="list-style:disc;"> <p>data —&gt; 存放数据，以及读取文件的cache</p> </li> 
      <li style="list-style:disc;"> <p>experiments —&gt;存放配置文件以及运行的log文件,配置文件</p> </li> 
      <li style="list-style:disc;"> <p>lib —&gt; python接口</p> </li> 
      <li style="list-style:disc;"> <p>models —&gt; 三种模型, ZF(S)/VGG1024(M)/VGG16(L)</p> </li> 
      <li style="list-style:disc;"> <p>output —&gt; 输出的model存放的位置，不训练此文件夹没有</p> </li> 
      <li style="list-style:disc;"> <p>tools —&gt; 训练和<a class="replace_word" title="软件测试知识库" href="http://lib.csdn.net/base/softwaretest" rel="nofollow" style="color:rgb(223,52,52);font-weight:bold;">测试</a>的python文件</p> </li> 
     </ul>
    </blockquote>
   </blockquote> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">修改源文件</h3> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>faster rcnn</code>有两种各种训练方式:</p> 
   <blockquote style="background:rgb(255,255,255) none;border:2px solid rgb(239,239,239);line-height:1.6;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <blockquote style="background:none;border:2px solid rgb(239,239,239);line-height:1.6;"> 
     <ul>
      <li style="list-style:disc;"> <p>Alternative training(alt-opt)</p> </li> 
      <li style="list-style:disc;"> <p>Approximate joint training(end-to-end)</p> </li> 
     </ul>
    </blockquote>
   </blockquote> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　推荐使用第二种，因为第二种使用的显存更小，而且训练会更快，同时准确率差不多，两种方式需要修改的代码是不一样的，同时faster rcnn提供了三种训练模型，小型的<code>ZF</code>model，中型的<code>VGG_CNN_M_1024</code>和大型的<code>VGG16</code>,论文中说VGG16效果比其他两个好，但是同时占用更大的GPU显存(~11GB)</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　我使用的是VGG model + alternative training，需要检测的类别只有一类，加上背景所以总共是两类(background + captcha)</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　py-faster-rcnn/models/pascal_voc/VGG16/faster_rcnn_alt_opt/stage1_fast_rcnn_train.pt</code></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">layer {  
  name: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">data</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">Python</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">data</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">rois</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">labels</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">bbox_targets</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">bbox_inside_weights</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">bbox_outside_weights</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  python_param {  
    module: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">roi_data_layer.layer</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
    layer: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">RoIDataLayer</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
    param_str: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'num_classes': 2</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span> #按训练集类别改，该值为类别数+<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span><span style="font-size:12px;line-height:1.5;">  
  }  
}  </span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">layer {  
  name: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">cls_score</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">InnerProduct</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  bottom: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">fc7</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">cls_score</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  param { 
  lr_mult: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1.0</span><span style="font-size:12px;line-height:1.5;">
  }  
  param {
  lr_mult: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2.0</span><span style="font-size:12px;line-height:1.5;"> 
  }  
  inner_product_param {  
    num_output: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span> #按训练集类别改，该值为类别数+<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span><span style="font-size:12px;line-height:1.5;">  
    weight_filler {  
      type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">gaussian</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
      std: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0.01</span><span style="font-size:12px;line-height:1.5;">  
    }  
    bias_filler {  
      type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">constant</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
      value: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">  
    }  
  }  
}  </span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">layer {  
  name: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">bbox_pred</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">InnerProduct</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  bottom: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">fc7</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">bbox_pred</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  param { 
  lr_mult: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1.0</span><span style="font-size:12px;line-height:1.5;"> 
  }  
  param { 
  lr_mult: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2.0</span><span style="font-size:12px;line-height:1.5;"> 
  }  
  inner_product_param {  
    num_output: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">8</span> #按训练集类别改，该值为（类别数+<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span>）*<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">4</span><span style="font-size:12px;line-height:1.5;">，四个顶点坐标  
    weight_filler {  
      type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">gaussian</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
      std: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0.001</span><span style="font-size:12px;line-height:1.5;">  
    }  
    bias_filler {  
      type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">constant</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
      value: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">  
    }  
  }  
}  </span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　py-faster-rcnn/models/pascal_voc/VGG16/faster_rcnn_alt_opt/stage1_rpn_train.pt</code></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">layer {  
  name: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">input-data</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">Python</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">data</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">im_info</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">gt_boxes</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  python_param {  
    module: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">roi_data_layer.layer</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
    layer: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">RoIDataLayer</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
    param_str: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'num_classes': 2</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span> #按训练集类别改，该值为类别数+<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span><span style="font-size:12px;line-height:1.5;">  
  }  
}  </span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　py-faster-rcnn/models/pascal_voc/VGG16/faster_rcnn_alt_opt/stage2_fast_rcnn_train.pt</code></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">layer {  
  name: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">data</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">Python</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">data</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">rois</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">labels</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">bbox_targets</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">bbox_inside_weights</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">bbox_outside_weights</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  python_param {  
    module: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">roi_data_layer.layer</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
    layer: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">RoIDataLayer</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
    param_str: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'num_classes': 2</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span> #按训练集类别改，该值为类别数+<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span><span style="font-size:12px;line-height:1.5;">  
  }  
}  </span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">layer {  
  name: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">cls_score</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">InnerProduct</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  bottom: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">fc7</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">cls_score</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  param { 
  lr_mult: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1.0</span><span style="font-size:12px;line-height:1.5;"> 
  }  
  param { 
  lr_mult: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2.0</span><span style="font-size:12px;line-height:1.5;"> 
  }  
  inner_product_param {  
    num_output: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span> #按训练集类别改，该值为类别数+<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span><span style="font-size:12px;line-height:1.5;">  
    weight_filler {  
      type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">gaussian</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
      std: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0.01</span><span style="font-size:12px;line-height:1.5;">  
    }  
    bias_filler {  
      type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">constant</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
      value: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">  
    }  
  }  
}  </span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">layer {  
  name: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">bbox_pred</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">InnerProduct</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  bottom: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">fc7</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">bbox_pred</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  param { 
  lr_mult: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1.0</span><span style="font-size:12px;line-height:1.5;">
  }  
  param { 
  lr_mult: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2.0</span><span style="font-size:12px;line-height:1.5;"> 
  }  
  inner_product_param {  
    num_output: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">8</span> #按训练集类别改，该值为（类别数+<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span>）*<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">4</span><span style="font-size:12px;line-height:1.5;">,四个顶点坐标  
    weight_filler {  
      type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">gaussian</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
      std: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0.001</span><span style="font-size:12px;line-height:1.5;">  
    }  
    bias_filler {  
      type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">constant</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
      value: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">  
    }  
  }  
}  </span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　py-faster-rcnn/models/pascal_voc/VGG16/faster_rcnn_alt_opt/stage2_rpn_train.pt</code></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">layer {  
  name: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">input-data</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">Python</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">data</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">im_info</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">gt_boxes</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
  python_param {  
    module: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">roi_data_layer.layer</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
    layer: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">RoIDataLayer</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">  
    param_str: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'num_classes': 2</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span> #按训练集类别改，该值为类别数+<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span><span style="font-size:12px;line-height:1.5;">  
  }  
}  </span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　py-faster-rcnn/models/pascal_voc/VGG16/faster_rcnn_alt_opt/faster_rcnn_test.pt</code></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">layer {  
  name: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">cls_score</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">InnerProduct</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  bottom: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">fc7</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">cls_score</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  inner_product_param {  
    num_output: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span> #按训练集类别改，该值为类别数+<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span><span style="font-size:12px;line-height:1.5;">  
  }  
}  </span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　py-faster-rcnn/models/pascal_voc/VGG16/faster_rcnn_alt_opt/faster_rcnn_test.pt</code></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">layer {  
  name: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">cls_score</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  type: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">InnerProduct</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  bottom: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">fc7</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  top: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">cls_score</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">  
  inner_product_param {  
    num_output: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span> #按训练集类别改，该值为类别数+<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span><span style="font-size:12px;line-height:1.5;">  
  }  
}  </span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　py-faster-rcnn/lib/datasets/pascal_voc.py</code></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> pascal_voc(imdb):  
    def __init__(self, image_set, year, devkit_path</span>=<span style="font-size:12px;line-height:1.5;">None):  
        imdb.__init__(self, </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">voc_</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span> + year + <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">_</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span> +<span style="font-size:12px;line-height:1.5;"> image_set)  
        self._year </span>=<span style="font-size:12px;line-height:1.5;"> year  
        self._image_set </span>=<span style="font-size:12px;line-height:1.5;"> image_set  
        self._devkit_path </span>= self._get_default_path() <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> devkit_path <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">is</span><span style="font-size:12px;line-height:1.5;"> None \  
                            </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">else</span><span style="font-size:12px;line-height:1.5;"> devkit_path  
        self._data_path </span>= os.path.join(self._devkit_path, <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">VOC</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span> +<span style="font-size:12px;line-height:1.5;"> self._year)  
        self._classes </span>= (<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">__background__</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span>, # always index <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">  
                         captcha</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;"> # 有几个类别此处就写几个，我是两个</span>
                      )  </pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　line 212</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre>cls = self._class_to_ind[obj.find(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">name</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span>).text.lower().strip()]  </pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　如果你的标签含有大写字母，可能会出现KeyError的错误，所以建议全部使用小写字母</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　py-faster-rcnn/lib/datasets/imdb.py</code></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　将append_flipped_images函数改为如下形式:</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">def append_flipped_images(self):  
        num_images </span>=<span style="font-size:12px;line-height:1.5;"> self.num_images  
        widths </span>= [PIL.Image.open(self.image_path_at(i)).size[<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">]  
                  </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> i <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">in</span><span style="font-size:12px;line-height:1.5;"> xrange(num_images)]  
        </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> i <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">in</span><span style="font-size:12px;line-height:1.5;"> xrange(num_images):  
            boxes </span>= self.roidb[i][<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">boxes</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">].copy()  
            oldx1 </span>= boxes[:, <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">].copy()  
            oldx2 </span>= boxes[:, <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span><span style="font-size:12px;line-height:1.5;">].copy()  
            boxes[:, </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>] = widths[i] - oldx2 - <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span><span style="font-size:12px;line-height:1.5;">  
            print boxes[:, </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">]  
            boxes[:, </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span>] = widths[i] - oldx1 - <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span><span style="font-size:12px;line-height:1.5;">  
            print boxes[:, </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">]  
            assert (boxes[:, </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span>] &gt;= boxes[:, <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">]).all()  
            entry </span>= {<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">boxes</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;"> : boxes,  
                     </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">gt_overlaps</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span> : self.roidb[i][<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">gt_overlaps</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">],  
                     </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">gt_classes</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span> : self.roidb[i][<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">gt_classes</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">],  
                     </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">flipped</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;"> : True}  
            self.roidb.append(entry)  
        self._image_index </span>= self._image_index * <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span>  </pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　到此代码修改就搞定了</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">训练</h2> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　训练前还需要注意几个地方</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">1 cache问题</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　假如你之前训练了官方的VOC2007的数据集或其他的数据集，是会产生cache的问题的，建议在重新训练新的数据之前将其删除</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">(1)&nbsp;<code>py-faster-rcnn/output</code>&nbsp;<br> (2)&nbsp;<code>py-faster-rcnn/data/cache</code></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">2 训练参数</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code>　　py-faster-rcnn/models/pascal_voc/VGG16/faster_rcnn_alt_opt/stage_fast_rcnn_solver*.pt</code></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre>base_lr: <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0.001</span><span style="font-size:12px;line-height:1.5;">
lr_policy: </span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">step</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="font-size:12px;line-height:1.5;">
step_size: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">30000</span><span style="font-size:12px;line-height:1.5;">
display: </span><span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">20</span><span style="font-size:12px;line-height:1.5;">
....</span></pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　迭代次数在文件<code>py-faster-rcnn/tools/train_faster_rcnn_alt_opt.py</code>中进行修改</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">line 80</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre>max_iters = [<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">80000</span>, <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">40000</span>, <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">80000</span>, <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">40000</span>]</pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　分别对应rpn第1阶段，fast rcnn第1阶段，rpn第2阶段，fast rcnn第2阶段的迭代次数，自己修改即可，不过注意这里的值不要小于上面的solver里面的step_size的大小，大家自己修改吧。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">开始训练:</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre>cd py-faster-<span style="font-size:12px;line-height:1.5;">rcnn
.</span>/experiments/scripts/faster_rcnn_alt_opt.sh <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span> VGG16 pascal_voc </pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　指明使用第一块GPU(0),模型是VGG16,训练数据是pascal_voc(voc2007)，没问题的话应该可以迭代训练了</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h2 style="font-size:21px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;">结果</h2> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">训练完毕，得到我们的训练模型，我们就可以使用它来进行我们的object detection了，具体是:&nbsp;<br> 1 将<code>py-faster-rcnn/output/faster_rcnn_alt_opt/voc_2007_trainval/VGG16_faster_rcnn_final.caffemodel</code>，拷贝到<code>py-faster-rcnn/data/faster_rcnn_models</code>下</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">2 将你需要进行test的images放在<code>py-faster-rcnn/data/demo</code>下</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">3 修改<code>py-faster-rcnn/tools/demo.py</code>文件</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code><br> CLASSES = ('_background_', 'captcha') #参考你自己的类别写&nbsp;<br></code></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><code><br> NETS = {'vgg16': ('VGG16',&nbsp;<br> 'VGG16_faster_rcnn_final.caffemodel'), #改成你训练得到的model的name&nbsp;<br> 'zf': ('ZF',&nbsp;<br> 'ZF_faster_rcnn_final.caffemodel')&nbsp;<br> }</code></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre>im_names = [<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">1559.jpg</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span>,<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">1564.jpg</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">'</span>]  # 改成自己的test image的name</pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">上几张我的检测结果吧</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img title="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20160728104020897" alt="1" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img title="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20160728104039459" alt="2" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img title="" src="https://uzshare.com/_p?https://img-blog.csdn.net/20160728104103928" alt="3" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p><font><span style="font-size:14px;">本文转自大数据躺过的坑博客园博客，原文链接：http://www.cnblogs.com/zlslch/p/6973242.html，如需转载请自行联系原作者</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
