<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>浅谈 Java XML 底层解析方式 « NotBeCN</title>
  <meta name="description" content="             &nbsp; &nbsp;XML 使用DTD(document type definition)文档类型来标记数据和定义数据，格式统一且跨平台和语言，已成为业界公认的标准。    &nbsp; &nbsp;目前 XML 描述数据龙头老大的地位渐渐受到 Json 威胁。经手项目中，模块/系...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/22/weixin_34327761_90129041.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">浅谈 Java XML 底层解析方式</h1>
    <p class="post-meta">Nov 22, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;XML 使用DTD(document type definition)文档类型来标记数据和定义数据，格式统一且跨平台和语言，已成为业界公认的标准。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;目前 XML 描述数据龙头老大的地位渐渐受到 Json 威胁。</span><span style="line-height:1.8;font-size:15px;">经手项目中，模块/系统之间交互数据方式有 XML 也有 Json，说不上孰好孰坏。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;XML 规整/有业界标准/很容易和其他外部的系统进行交互，Json 简单/灵活/占带宽比小。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;仁者见仁智者见智，项目推进中描述数据方式需要根据具体场景拿捏。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">这篇博客主要描述目前 Java 中比较主流的 XML 解析底层方式，给需要这方面项目实践的同学一些参考。</span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">Demo 项目 git 地址：<a href="https://git.oschina.net/LanboEx/xml-parse-demo.git" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"><span style="line-height:1.8;">https://git.oschina.net/LanboEx/xml-parse-demo.git</span></a></span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;"><img src="https://images2015.cnblogs.com/blog/362169/201705/362169-20170515191015682-1649633268.png" alt="" style="border:0px;"></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp;</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Sax/Satx/Dom 由国外开源社区或组织贡献，Sun 重新组织起名 JAXP 自JDK 1.6 起陆续将他们添加进去。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Xmlpull在 JDK 中没有看到它的身影，如果需要使用它，你需要添加额外的类库。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Jdom/Dom4j/Xstream... 是基于这些底层解析方式重新组织封装的开源类库，提供简洁的 API，有机会再写一篇博客描述。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Dom4j 是基于 JAXP&nbsp;解析方式，性能优异、功能强大、极易使用的优秀开源类库。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Jdom 如果你细看内部代码，其实也是基于 JAXP 但具体包结构被重新组织，</span><span style="line-height:1.8;font-size:15px;">&nbsp;API 大量使用了 Collections 类，在性能上被 dm4j 压了好几个档次。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp;&nbsp;<span style="line-height:1.8;">&nbsp;<span style="line-height:1.8;">实例 Demo 中需要解析的 xml 文件如下，中规中矩不简单，也不复杂，示例业务场景都能将节点的值解析出来，组成业务实体对象。</span></span></span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <span style="font-size:15px;line-height:1.8;"><img class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" style="border:0px;vertical-align:middle;"></span>&nbsp;
    <span class="cnblogs_code_collapse" style="border-width:1px;border-style:solid;border-color:#808080;font-size:15px;line-height:1.8;">Demo.xml</span> 
   </div> 
   <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;text-align:right;"> 
    <a href="http://www.cnblogs.com/java-class/p/6857863.html#_labelTop" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">回到顶部</a>
    <a name="_label0" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a> 
   </div> 
   <h3 style="font-size:16px;line-height:1.5;font-family:verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.8;font-size:15px;">1.&nbsp;基于树或基于对象模型</span></h3> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;官方 W3C 标准,以层次结构组织的节点或信息片断的集合。允许在树中寻找特定信息,分析该结构通常需要加载整个文档和构造层次结构。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;最早的一种解析模型，加载整个文档意味着在大文件 XMl 会遇到性能瓶颈。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Dom 解析代码示例：</span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:15px;line-height:1.8;">        DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();<span style="line-height:1.8;color:rgb(0,128,0);font-size:12px;">//</span><span style="line-height:1.8;color:rgb(0,128,0);font-size:12px;">得到Dom解析器的工厂实例</span>
        DocumentBuilder dbBuilder = dbFactory.newDocumentBuilder();<span style="line-height:1.8;color:rgb(0,128,0);font-size:12px;">//</span><span style="line-height:1.8;color:rgb(0,128,0);font-size:12px;">从Dom工厂中获得Dom解析器</span>
        Document doc = dbBuilder.parse(Thread.currentThread().getContextClassLoader().getResource("demo.xml"<span style="line-height:1.8;font-size:12px;">).getPath()); NodeList nList </span>= doc.getElementsByTagName("studentGridlb"<span style="line-height:1.8;font-size:12px;">); List</span>&lt;StudentGridlb&gt; studentGridlbList = <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> ArrayList&lt;&gt;<span style="line-height:1.8;font-size:12px;">(); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">for</span> (<span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">int</span> i = 0; i &lt; nList.getLength(); i++<span style="line-height:1.8;font-size:12px;">) { StudentGridlb studentGridlb </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span><span style="line-height:1.8;font-size:12px;"> StudentGridlb(); NodeList childNodes </span>=<span style="line-height:1.8;font-size:12px;"> nList.item(i).getChildNodes(); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">for</span> (<span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">int</span> k = 0; k &lt; childNodes.getLength(); k++<span style="line-height:1.8;font-size:12px;">) { </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (childNodes.item(k) <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">instanceof</span><span style="line-height:1.8;font-size:12px;"> Element) { Element element </span>=<span style="line-height:1.8;font-size:12px;"> (Element) childNodes.item(k); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> ("stu_id"<span style="line-height:1.8;font-size:12px;">.equals(element.getNodeName())) { studentGridlb.setStu_id(element.getTextContent()); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> ("stu_name"<span style="line-height:1.8;font-size:12px;">.equals(element.getNodeName())) { studentGridlb.setStu_name(element.getTextContent()); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> ("stu_age"<span style="line-height:1.8;font-size:12px;">.equals(element.getNodeName())) { studentGridlb.setStu_age(Integer.parseInt(element.getTextContent())); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> ("stu_birthday"<span style="line-height:1.8;font-size:12px;">.equals(element.getNodeName())) { DateFormat format </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> SimpleDateFormat("yyyy-MM-dd"<span style="line-height:1.8;font-size:12px;">); studentGridlb.setStu_birthday(format.parse(element.getTextContent())); } } } studentGridlbList.add(studentGridlb); }</span></span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp;&nbsp;<span style="line-height:1.8;">&nbsp;<span style="line-height:1.8;">Dom 解析方式有个最大的优点可以在任何时候在树中上下导航，获取和操作任意部分的数据。</span></span></span></p> 
   <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;text-align:right;"> 
    <a href="http://www.cnblogs.com/java-class/p/6857863.html#_labelTop" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">回到顶部</a>
    <a name="_label1" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a> 
   </div> 
   <h3 style="font-size:16px;line-height:1.5;font-family:verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.8;font-size:15px;">2. 流事件分析中推模型</span></h3> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;靠事件驱动的模型，当它每发现一个节点就引发一个事件，需要编写这些事件的处理程序。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;这样的做法很麻烦，而且不灵活，主流的分析方式有 Xmlpull和 JAXP 中的 Sax。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Xmlpulldemo (引入 xmlpull.jar &nbsp;xpp3_min.jar]):</span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:15px;line-height:1.8;">        XmlPullParserFactory pullParserFactory =<span style="line-height:1.8;font-size:12px;"> XmlPullParserFactory.newInstance(); XmlPullParser pullParser </span>= pullParserFactory.newPullParser();<span style="line-height:1.8;color:rgb(0,128,0);font-size:12px;">//</span><span style="line-height:1.8;color:rgb(0,128,0);font-size:12px;">获取XmlPullParser的实例</span>
        pullParser.setInput(Thread.currentThread().getContextClassLoader().getResourceAsStream("demo.xml"), "UTF-8"<span style="line-height:1.8;font-size:12px;">); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">int</span> event =<span style="line-height:1.8;font-size:12px;"> pullParser.getEventType(); List</span>&lt;StudentGridlb&gt; studentGridlbList = <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> ArrayList&lt;&gt;<span style="line-height:1.8;font-size:12px;">(); StudentGridlb studentGridlb </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span><span style="line-height:1.8;font-size:12px;"> StudentGridlb(); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">while</span> (event !=<span style="line-height:1.8;font-size:12px;"> XmlPullParser.END_DOCUMENT) { String nodeName </span>=<span style="line-height:1.8;font-size:12px;"> pullParser.getName(); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">switch</span><span style="line-height:1.8;font-size:12px;"> (event) { </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">case</span><span style="line-height:1.8;font-size:12px;"> XmlPullParser.START_DOCUMENT: System.out.println(</span>"Xmlpull解析 xml 开始:"<span style="line-height:1.8;font-size:12px;">); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">break</span><span style="line-height:1.8;font-size:12px;">; </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">case</span><span style="line-height:1.8;font-size:12px;"> XmlPullParser.START_TAG: </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> ("stu_id"<span style="line-height:1.8;font-size:12px;">.equals(nodeName)) { studentGridlb.setStu_id(pullParser.nextText()); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> ("stu_name"<span style="line-height:1.8;font-size:12px;">.equals(nodeName)) { studentGridlb.setStu_name(pullParser.nextText()); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> ("stu_age"<span style="line-height:1.8;font-size:12px;">.equals(nodeName)) { studentGridlb.setStu_age(Integer.parseInt(pullParser.nextText())); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> ("stu_birthday"<span style="line-height:1.8;font-size:12px;">.equals(nodeName)) { DateFormat format </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> SimpleDateFormat("yyyy-MM-dd"<span style="line-height:1.8;font-size:12px;">); studentGridlb.setStu_birthday(format.parse(pullParser.nextText())); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">break</span><span style="line-height:1.8;font-size:12px;">; </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">case</span><span style="line-height:1.8;font-size:12px;"> XmlPullParser.END_TAG: </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> ("studentGridlb"<span style="line-height:1.8;font-size:12px;">.equals(nodeName)) { studentGridlbList.add(studentGridlb); studentGridlb </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span><span style="line-height:1.8;font-size:12px;"> StudentGridlb(); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">break</span><span style="line-height:1.8;font-size:12px;">; } event </span>=<span style="line-height:1.8;font-size:12px;"> pullParser.next(); }</span></span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Xmlpull为接口层，xpp3_min 为实现层，其实可以引入另外自带接口层 xpp3 版本。</span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:15px;line-height:1.8;"><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;"> &lt;</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">dependency</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>
            <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">groupId</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>xmlpull<span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;/</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">groupId</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>
            <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">artifactId</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>xmlpull<span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;/</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">artifactId</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>
            <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">version</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>1.1.3.1<span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;/</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">version</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>
        <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;/</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">dependency</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>

        <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">dependency</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>
            <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">groupId</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>xpp3<span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;/</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">groupId</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>
            <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">artifactId</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>xpp3_min<span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;/</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">artifactId</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>
            <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">version</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>1.1.4c<span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;/</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">version</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span>
        <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&lt;/</span><span style="line-height:1.8;color:rgb(128,0,0);font-size:12px;">dependency</span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">&gt;</span></span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Sax demo:</span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:15px;line-height:1.8;">        SaxParserFactory SaxParserFactory = SaxParserFactory.newInstance(); <span style="line-height:1.8;color:rgb(0,128,0);font-size:12px;">//</span><span style="line-height:1.8;color:rgb(0,128,0);font-size:12px;">获取Sax分析器的工厂实例，专门负责创建SaxParser分析器</span>
        SaxParser SaxParser =<span style="line-height:1.8;font-size:12px;"> SaxParserFactory.newSaxParser(); InputStream inputStream </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> FileInputStream(<span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> File(Thread.currentThread().getContextClassLoader().getResource("demo.xml"<span style="line-height:1.8;font-size:12px;">).getPath())); SaxHandler xmlSaxHandler </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span><span style="line-height:1.8;font-size:12px;"> SaxHandler(); SaxParser.parse(inputStream, xmlSaxHandler);</span></span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Sax 解析时还需要单独编写时间响应 Handler ，和集合排序时实现的Comparator 类似。&nbsp;</span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <span style="font-size:15px;line-height:1.8;"><img class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" style="border:0px;vertical-align:middle;"></span>&nbsp;
    <span class="cnblogs_code_collapse" style="border-width:1px;border-style:solid;border-color:#808080;font-size:15px;line-height:1.8;">SaxHandler</span> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">推模式不需要等待所有数据都被处理，分析就能立即开始；</span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">只在读取数据时检查数据，不需要保存在内存中;</span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">可以在某个条件得到满足时停止解析，不必解析整个文档；</span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">效率和性能较高，能解析大于系统内存的文档;</span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">当然缺点也很突出例如需要自己负责TAG的处理逻辑（例如维护父/子关系等），使用麻烦；</span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">单向导航，很难同时访问同一文档的不同部分数据，不支持 XPath;</span></span></p> 
   <div style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;text-align:right;"> 
    <a href="http://www.cnblogs.com/java-class/p/6857863.html#_labelTop" rel="nofollow" style="text-decoration:none;color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">回到顶部</a>
    <a name="_label2" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a> 
   </div> 
   <h3 style="font-size:16px;line-height:1.5;font-family:verdana, Arial, Helvetica, sans-serif;"><span style="line-height:1.8;font-size:15px;">3. 流事件分析中的拉模型</span></h3> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; 在遍历文档时，把感兴趣的部分从读取器中拉出，不需要引发事件，允许我们选择性地处理节点；</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; 大大提高了灵活性，以及整体效率，拉模式中比较常见 stax，stax 提供了两套 API 共使用。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; stax demo(基于光标的方式解析XML):</span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:15px;line-height:1.8;">        InputStream stream = <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> FileInputStream(Thread.currentThread().getContextClassLoader().getResource("demo.xml"<span style="line-height:1.8;font-size:12px;">).getPath()); XMLInputFactory factory </span>=<span style="line-height:1.8;font-size:12px;"> XMLInputFactory.newInstance(); XMLStreamReader parser </span>=<span style="line-height:1.8;font-size:12px;"> factory.createXMLStreamReader(stream); List</span>&lt;StudentGridlb&gt; studentGridlbList = <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> ArrayList&lt;&gt;<span style="line-height:1.8;font-size:12px;">(); StudentGridlb studentGridlb </span>=  <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">null</span><span style="line-height:1.8;font-size:12px;">;<br></span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">while</span><span style="line-height:1.8;font-size:12px;"> (parser.hasNext()) { </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">int</span> event =<span style="line-height:1.8;font-size:12px;"> parser.next(); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (event ==<span style="line-height:1.8;font-size:12px;"> XMLStreamConstants.START_DOCUMENT) { System.out.println(</span>"stax 解析xml 开始....."<span style="line-height:1.8;font-size:12px;">); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (event ==<span style="line-height:1.8;font-size:12px;"> XMLStreamConstants.START_ELEMENT) { </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (parser.getLocalName().equals("stu_id"<span style="line-height:1.8;font-size:12px;">)) { studentGridlb </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span><span style="line-height:1.8;font-size:12px;"> StudentGridlb(); studentGridlb.setStu_id(parser.getElementText()); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">else</span> <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (parser.getLocalName().equals("stu_name"<span style="line-height:1.8;font-size:12px;">)) { studentGridlb.setStu_name(parser.getElementText()); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">else</span> <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (parser.getLocalName().equals("stu_age"<span style="line-height:1.8;font-size:12px;">)) { studentGridlb.setStu_age(Integer.parseInt(parser.getElementText())); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">else</span> <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (parser.getLocalName().equals("stu_birthday"<span style="line-height:1.8;font-size:12px;">)) { DateFormat format </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> SimpleDateFormat("yyyy-MM-dd"<span style="line-height:1.8;font-size:12px;">); studentGridlb.setStu_birthday(format.parse(parser.getElementText())); } } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (event ==<span style="line-height:1.8;font-size:12px;"> XMLStreamConstants.END_ELEMENT) { </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (parser.getLocalName().equals("studentGridlb"<span style="line-height:1.8;font-size:12px;">)) { studentGridlbList.add(studentGridlb); } } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (event ==<span style="line-height:1.8;font-size:12px;"> XMLStreamConstants.END_DOCUMENT) { System.out.println(</span>"stax 解析xml 结束....."<span style="line-height:1.8;font-size:12px;">); } } parser.close();</span></span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; stax demo(基于迭代方式解析XML):</span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:15px;line-height:1.8;">        XMLInputFactory xmlInputFactory =<span style="line-height:1.8;font-size:12px;"> XMLInputFactory.newInstance(); XMLEventReader xmlEventReader </span>= xmlInputFactory.createXMLEventReader(Thread.currentThread().getContextClassLoader().getResourceAsStream("demo.xml"<span style="line-height:1.8;font-size:12px;">)); List</span>&lt;StudentGridlb&gt; studentGridlbList = <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> ArrayList&lt;&gt;<span style="line-height:1.8;font-size:12px;">(); StudentGridlb studentGridlb </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">null</span><span style="line-height:1.8;font-size:12px;">; </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">while</span><span style="line-height:1.8;font-size:12px;"> (xmlEventReader.hasNext()) { XMLEvent event </span>=<span style="line-height:1.8;font-size:12px;"> xmlEventReader.nextEvent(); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span><span style="line-height:1.8;font-size:12px;"> (event.isStartElement()) { String name </span>=<span style="line-height:1.8;font-size:12px;"> event.asStartElement().getName().toString(); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (name.equals("stu_id"<span style="line-height:1.8;font-size:12px;">)) { studentGridlb </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span><span style="line-height:1.8;font-size:12px;"> StudentGridlb(); studentGridlb.setStu_id(xmlEventReader.getElementText()); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">else</span> <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (name.equals("stu_name"<span style="line-height:1.8;font-size:12px;">)) { studentGridlb.setStu_name(xmlEventReader.getElementText()); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">else</span> <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (name.equals("stu_age"<span style="line-height:1.8;font-size:12px;">)) { studentGridlb.setStu_age(Integer.parseInt(xmlEventReader.getElementText())); } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">else</span> <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (name.equals("stu_birthday"<span style="line-height:1.8;font-size:12px;">)) { DateFormat format </span>= <span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">new</span> SimpleDateFormat("yyyy-MM-dd"<span style="line-height:1.8;font-size:12px;">); studentGridlb.setStu_birthday(format.parse(xmlEventReader.getElementText())); } } </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span><span style="line-height:1.8;font-size:12px;"> (event.isEndElement()) { String name </span>=<span style="line-height:1.8;font-size:12px;"> event.asEndElement().getName().toString(); </span><span style="line-height:1.8;color:rgb(0,0,255);font-size:12px;">if</span> (name.equals("studentGridlb"<span style="line-height:1.8;font-size:12px;">)) { studentGridlbList.add(studentGridlb); } } } xmlEventReader.close();</span></span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.8;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp;&nbsp;<span style="line-height:1.8;">&nbsp;<span style="line-height:1.8;">基于指针的 stax API,这种方式尽管效率高，但没有提供 XML 结构的抽象，因此是一种低层 API。</span></span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">stax 基于迭代器的 API 是一种面向对象的方式，这也是它与基于指针的 API 的最大区别。</span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">基于迭代器的 API 只需要确定解析事件的类型，然后利用其方法获得属于该事件对象的信息。</span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;<span style="line-height:1.8;">通过将事件转变为对象，让应用程序可以用面向对象的方式处理，有利于模块化和不同组件之间的代码重用。</span></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;Ok,这篇博客对 java 底层解析 xml 方式做了点总结。其实在实际项目中，上述几种方式解析 xml 编写起来都很费事。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;都会引入封装起来的稳定开源库，如 Dom4j/Jdom/Xstream.....，这些类库屏蔽了底层复杂的部分，呈现给我们简洁明了的 API;</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;">&nbsp; &nbsp;但如果公司业务复杂程度已经远远超出了开源类库的提供的范畴，不妨自己依赖底层解析技术自己造轮子。</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-size:15px;"><br></span></p> 
   <p><span style="line-height:1.8;"><font color="#333333"><span style="font-size:15px;">本文转自Orson博客园博客，原文链接：http://www.cnblogs.com/java-class/p/6857863.html，如需转载请自行联系原作者</span></font><br></span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
