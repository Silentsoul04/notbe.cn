<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Win7和WinXP共享的设置问题二则——共享打印机和FTP « NotBeCN</title>
  <meta name="description" content="             　　时至今日，一个小型的局域网中的操作系统，Win7和WinXP共存的现象已经是很普遍的了（就像当时WinXP和Win98曾经共存了一段时间一样）。那么在Win7和WinXP之间的设置资源共享就得费一番周折了。本人今日碰到二则事例，在网上查了很多资料后，很多都是言语寥寥，不能解决实际问题...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/22/weixin_33873846_90129421.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Win7和WinXP共享的设置问题二则——共享打印机和FTP</h1>
    <p class="post-meta">Nov 22, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　时至今日，一个小型的局域网中的操作系统，Win7和WinXP共存的现象已经是很普遍的了（就像当时WinXP和Win98曾经共存了一段时间一样）。那么在Win7和WinXP之间的设置资源共享就得费一番周折了。本人今日碰到二则事例，在网上查了很多资料后，很多都是言语寥寥，不能解决实际问题。在仔细的搜索一番后，找到两个帖子，都顺利的解决了我的问题。在这儿，着文以记之。也是给更多的人一个参考。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　<strong>一、Win7访问WinXP的共享打印机</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>　　</strong>在许多的网上的帖子上说，一个是开放GUEST帐号，一个是通过添加网络端口的打印机。这两个，我都试过，前一个，丝毫不起作用，Win7能看到WinXP的机器，但看不到其共享的打印机。后一个，虽然顺利添加了WinXP的打印机，但是打印的文件却都是空白纸，更新了打印机驱动也没有效果。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　解决方案“<a href="http://apps.hi.baidu.com/share/detail/16063072" rel="nofollow" style="color:rgb(7,93,179);">http://apps.hi.baidu.com/share/detail/16063072</a>”</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　现在将解决步骤贴于下方，供大家参考</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　Win7机器方：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　1、开启的服务<br> 右键点击我的电脑或计算机—管理----服务和应用程序，打开服务<br> 或者用WIN+R打开运行---输入services.msc回车，打开服务设置</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　　　开启以下服务：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　　　　　Server&nbsp;<br> Workstation<br> Computer Browser<br> DHCP Client<br> Remote Procedure Call<br> Remote Procedure Call (RPC) Locator<br> DNS Client<br> Function Discovery Resource Publication<br> UPnP Device Host<br> SSDP Discovery<br> TIP/IP NetBIOSHelper</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　2、Win7和WinXP两台机器要在一个工作组里</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　3、开启网络共享和文件共享</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　　　在“针对不同的网络配置文件更改共享选项”下勾选“启用网络发现”和“启用文件和打印机共享”</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　　　在“允许程序通过Windows防火墙通信”下勾选“网络发现”和“文件和打印机共享”。并且“家庭/工作(专用)”和“公用”都勾选</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　4、Win7中应该启用Guest帐号</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　WinXP机器方：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　1、首先要启用“文件和打印机共享”</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　　　注意：在“本地连接 属性”下“Microsoft的网络的文件和打印机共享”下的“协议”中的“network monitor driver协议”也要安装</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　2、开始-运行-services.msc- 启动“server服务”。<br> 3、组策略设置:&nbsp;<br> 开始菜单运行-secpol.msc -安全设置-本地策略<br> 用户权利指派- “拒绝从网络访问这台计算机”属性,删除里面的“所有用户组”。重点是删除“Guest”帐号。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　　　安全选项：&nbsp;<br> 网络访问：不允许SAM 帐户的匿名枚举，属性给“停用”。<br> 网络访问：不允许 SAM 帐户和共享的匿名枚举，属性给“停用”。<br> 网络访问：本地帐户的共享和安全模型，属性改为“经典 - 本地用户以自己的身份验证”。<br> 4、用户管理---启动guest用户&nbsp;<br> 5、重启WinXP电脑。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　　　笔者按照上述的方法做了一遍之后，Win7成功的在网络共享里发现WinXP的共享打印机，双击，按照提示安装打印机驱动，成功的将网络打印机设为默认的打印机。并且可以正常的使用。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　<strong>二、Win7的不关闭防火墙下的FTP设置</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　网络上介绍的Win7下的FTP设置，最后都会来一句，如果不能正常访问，把“Win7的防火墙”关闭。的确在关闭Win7的防火墙之后，其余的电脑都能正常访问FTP了。而一旦开启了Win7的防火墙，就无法正常的访问FTP了。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　问题出在防火墙处。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　一般的文章中介绍，在“允许程序通过Windows防火墙通信”中勾选“FTP服务器”，就能使FTP通过防火墙。但经过实际使用来看，这是不行的。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　在“<a href="http://www.downcc.com/tech/info/672245.html" rel="nofollow" style="color:rgb(7,93,179);">http://www.downcc.com/tech/info/672245.html</a>”中提到了解决办法。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　就是在“允许程序通过Windows防火墙通信”中不仅仅要勾选“FTP服务器”，还要添加“inetinfo.exe”。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　首先找到这个文件</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　通过笔者的本地搜索，在本机上的位置上有两个，分别是</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　C:\Windows\winsxs\x86_microsoft-windows-iis-metabase_31bf3856ad364e35_6.1.7600.16385_none_39084df88346b717\inetinfo.exe</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　C:\Windows\winsxs\x86_microsoft-windows-iis-metabase_31bf3856ad364e35_6.1.7601.17514_none_3b3961c080353ab1\inetinfo.exe</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　在“允许程序通过Windows防火墙通信”下点击“允许运行另一程序”下点击“浏览”，找到上面的两个程序，点“打开”即可。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　会发现在“允许的程序和功能”中已经有了“Internet Information Services”并且打上了勾。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　在如上的操作后，在开启Win7的防火墙之后，其他的机器也能正常的访问FTP了。其实Win7的FTP就是IIS下的一个子功能，所以也必须使IIS通过防火墙。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">　　上述的两个问题，都是在众多网页中寻觅出来的正解并且经过验证可行的。着文以记之。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><br></p> 
   <p style="line-height:1.5;"><font><span style="font-size:15px;">&nbsp; &nbsp; 本文转自万仓一黍博客园博客，原文链接：http://www.cnblogs.com/grenet/archive/2011/06/09/2075987.html</span></font><span style="font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
