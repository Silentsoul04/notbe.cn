<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Android4.0设置接口变更摘要（四） « NotBeCN</title>
  <meta name="description" content="             为了与你之前，你已经设置了共享Tab风格和Item实现圆角。希望能给有须要的朋友一点点帮助，今天再和大家分享一下用ViewPager实现设置分页，小米和OPPO就是这种设置，先来看看效果图：    &nbsp;    为了帮助大家更清晰的理解，我单独拿出一个小样例。有须要的朋友能够下载下...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/22/weixin_34272308_90119365.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Android4.0设置接口变更摘要（四）</h1>
    <p class="post-meta">Nov 22, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-family:'Comic Sans MS';">为了与你之前，你已经设置了共享Tab风格和Item实现圆角。</span><span style="line-height:1.8;font-family:'Comic Sans MS';">希望能给有须要的朋友一点点帮助，今天再和大家分享一下用ViewPager实现设置分页，</span><span style="line-height:1.8;font-family:'Comic Sans MS';">小米和OPPO就是这种设置，先来看看效果图：</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-family:'Comic Sans MS';"><img src="https://uzshare.com/_p?https://img-blog.csdn.net/20140611190801656?%3C/p%3E%3Cp%3Ewatermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2F5X3BpbmdfbGk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="" height="640" width="360" style="border:0px;">&nbsp;<img src="https://uzshare.com/_p?https://img-blog.csdn.net/20140611190806328?%3C/p%3E%3Cp%3Ewatermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2F5X3BpbmdfbGk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="" height="640" width="360" style="border:0px;"><br></span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><font><font><font><font><font><font><font><font><span style="line-height:1.8;font-size:14px;"><span style="line-height:1.8;"><span style="line-height:1.8;"><span style="line-height:1.8;"><span style="line-height:1.8;">为了帮助大家更清晰的理解，<span style="line-height:1.8;">我</span>单独拿出一个小样例。有须要的朋友能够下载下来看看：</span></span></span></span></span></font></font></font></font></font></font></font></font></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><font><font><font><font><font><font><span style="line-height:1.8;font-size:14px;"><span style="line-height:1.8;"><span style="line-height:1.8;"><span style="line-height:1.8;"><span style="line-height:1.8;"><span style="line-height:1.8;"><a href="http://git.oschina.net/way/SettingTab/tree/master" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">http://git.oschina.net/way/SettingTab/tree/master</a></span></span></span></span></span></span></font></font></font></font></font></font></p> 
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><font>事实上要实现这种风格并不难<font>。<font><span style="line-height:1.8;font-size:14px;">仅仅要</span>能比較深入的理解PreferenceActivity.java就能够了。</font></font></font></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><font><font><font>我们都知道Settings.<font>java<font>是继承自PreferenceActivity.java，所用的布局<span style="line-height:1.8;font-size:14px;">文件layout也是父类的，并且<span style="line-height:1.8;">他的二级界面都是Fragment。都是依赖他这个Activity<span style="line-height:1.8;">。假设<span style="line-height:1.8;">在onCreate函数中通过setC<span style="line-height:1.8;">ontentView<span style="line-height:1.8;">()</span></span></span>改变Settings<span style="line-height:1.8;">.java的布局。岂不<span style="line-height:1.8;">是也会影响他的二级界面？</span></span></span>相信非常多遇到困难的朋友就是<span style="line-height:1.8;">这个原因。</span></span></span></font></font></font></font></font></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><font><font><font><font><font><font><font><font>答案<font>是否定的<font>。非常明显，我们<font>仅仅须要在显示Settings的第一个界面<font>的时候才setC<font>ontentView<font>()。也就是说在<font>onCre<font>ate里面推断一下<span style="line-height:1.8;font-size:14px;">：</span>&nbsp;if (this.getClass().equals(Settings.class))，为什么<font>是这样呢？我们能够滚动到<span style="line-height:1.8;font-size:14px;">Settings.java文件末尾，会发现。事实上二级菜单都是一些Fragment。可是它们也有虚拟的类名的<span style="line-height:1.8;">，都是S<span style="line-height:1.8;">ettings的<span style="line-height:1.8;">内部</span>类，所以，进到二级菜单就<span style="line-height:1.8;">不满足<span style="line-height:1.8;">这个<span style="line-height:1.8;">条件了。</span></span></span></span></span></span></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><font><font><font><font><font><font><font><font><font><font><font><font><font><font><font><font><font>例如以下所看到的：</font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></font></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-java">		if (this.getClass().equals(Settings.class)) {
			setContentView(R.layout.tab_settings);
			mTabCursor = (ImageView) findViewById(R.id.tab_cursor);
			ViewPager viewPager = (ViewPager) findViewById(R.id.pager);
			viewPager.setAdapter(new ViewPagerAdapter(getFragmentManager()));
			viewPager.setOnPageChangeListener(mPageChangeListener);
			mViewPager = viewPager;

			mTabGeneral = (TextView) findViewById(R.id.tab_general);
			mTabDisplay = (TextView) findViewById(R.id.tab_display);
			mTabGeneral.setOnClickListener(mTabOnClickListener);
			mTabDisplay.setOnClickListener(mTabOnClickListener);
			mTabGeneral.setTextColor(COLOR_SELECTED);
			mTabGeneral.setTextSize(TEXT_SIZE_SELECTED);
		}</code></pre> 
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">相信，看完上面这段代码，遇到困难的朋友应该会豁然开朗。以下都能够不用继续看下去了。</span> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><font><font><font><font><span style="line-height:1.8;font-size:14px;"><span style="line-height:1.8;"><span style="line-height:1.8;"><span style="line-height:1.8;">只是为了<span style="line-height:1.8;">善始善终，我<span style="line-height:1.8;">会</span>继续贴下去。</span></span></span></span></span></font></font></font></font></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><font><font><font><font><font><font><font><font>接下来。我们看看tab_settings.xml的布局，由于PreferenceActivity的特性<font>，布局中必需要有一个id为android:id/list<font>的ListView，<font>由于全部的xml文件夹下的preference解析出来都<font>是显示在上面<span style="line-height:1.8;font-size:14px;">，尽管我们改变了布局。但<span style="line-height:1.8;">还<span style="line-height:1.8;">是不能改变<span style="line-height:1.8;">他的代码嘛！就弄一个高度宽<span style="line-height:1.8;">度为0的ListView骗一下它就能够了<span style="line-height:1.8;">，呵呵</span></span></span></span></span></span></font></font></font></font></font></font></font></font></font></font></font></font>：</p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-html">&lt;FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    &gt;
    &lt;ListView
        android:id="@android:id/list"
        android:layout_width="0dp"
        android:layout_height="0dp"
        android:visibility="gone"/&gt;
    &lt;LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" &gt;
        &lt;FrameLayout 
           android:layout_width="match_parent"
           android:layout_height="@dimen/tab_height"
           android:background="@drawable/tab_background" &gt;
    &lt;ImageView 
                android:id="@+id/tab_cursor"
                android:layout_width="@dimen/tab_width"
                android:layout_height="@dimen/tab_height"
                android:background="@drawable/tab_cursor"/&gt;
            &lt;LinearLayout
                android:layout_width="match_parent"
                android:layout_height="@dimen/tab_height"&gt;
                &lt;TextView
                    android:id="@+id/tab_general"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:layout_gravity="center_vertical"
                    android:gravity="center"
                    android:text="@string/tab_general"
                    android:singleLine="true"
                    android:textSize="@dimen/tab_text_size" /&gt;
                &lt;TextView
                    android:id="@+id/tab_display"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:gravity="center"
                    android:layout_gravity="center_vertical"
                    android:text="@string/tab_display"
                    android:singleLine="true"
                    android:textSize="@dimen/tab_text_size" /&gt;
            &lt;/LinearLayout&gt;  
        &lt;/FrameLayout&gt;

        &lt;android.support.v4.view.ViewPager
            android:id="@+id/pager"
            android:layout_width="match_parent"
            android:layout_height="match_parent" /&gt;
    &lt;/LinearLayout&gt;

&lt;/FrameLayout&gt;</code></pre> 
   <br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;">
   <span style="line-height:1.8;color:rgb(51,51,51);font-size:14px;font-family:'Comic Sans MS';">接下来便是普通ViewPager的使用了。我这里就不多说了。</span> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.8;font-family:'Comic Sans MS';">以下把整个Settings.java的源码分享一下：</span></p> 
   <p style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <pre><code class="language-java">/*
 * Copyright (C) 2008 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.android.settings;
import android.app.ActionBar;
import android.app.ActivityManager;
import android.app.Fragment;
import android.app.FragmentManager;

import com.android.internal.util.ArrayUtils;
import com.android.settings.accounts.AccountSyncSettings;
import com.android.settings.accounts.AuthenticatorHelper;
import com.android.settings.accounts.ManageAccountsSettings;
import com.android.settings.applications.ManageApplications;
import com.android.settings.bluetooth.BluetoothEnabler;
import com.android.settings.deviceinfo.Memory;
import com.android.settings.fuelgauge.PowerUsageSummary;
import com.android.settings.inputmethod.UserDictionaryAddWordFragment;
import com.android.settings.wifi.WifiEnabler;
import com.android.settings.wristwatch.WristwatchEnabler;

import static com.sprd.android.config.OptConfig.LC_RAM_SUPPORT;
import android.accounts.Account;
import android.accounts.AccountManager;
import android.accounts.OnAccountsUpdateListener;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.pm.ActivityInfo;
import android.content.pm.PackageManager;
import android.content.pm.PackageManager.NameNotFoundException;
import android.graphics.drawable.Drawable;
import android.os.Bundle;
import android.os.INetworkManagementService;
import android.os.RemoteException;
import android.os.ServiceManager;
import android.os.UserId;
import android.os.SystemProperties;
import android.os.TopwiseProp;
import android.preference.Preference;
import android.preference.PreferenceActivity;
import android.preference.PreferenceActivity.Header;
import android.preference.PreferenceFragment;
import android.support.v13.app.FragmentPagerAdapter;
import android.support.v4.view.ViewPager;
import android.support.v4.view.ViewPager.OnPageChangeListener;
import android.telephony.TelephonyManager;
import android.text.TextUtils;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.Window;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.BaseAdapter;
import android.widget.Button;
import android.widget.CompoundButton;
import android.widget.ImageView;
import android.widget.ListAdapter;
import android.widget.Switch;
import android.widget.TextView;

import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.HashMap;
import java.util.List;

/**
 * Top-level settings activity to handle single pane and double pane UI layout.
 */
public class Settings extends PreferenceActivity
        implements ButtonBarHandler, OnAccountsUpdateListener {

    private static final String LOG_TAG = "Settings";

    private static final String META_DATA_KEY_HEADER_ID =
        "com.android.settings.TOP_LEVEL_HEADER_ID";
    private static final String META_DATA_KEY_FRAGMENT_CLASS =
        "com.android.settings.FRAGMENT_CLASS";
    private static final String META_DATA_KEY_PARENT_TITLE =
        "com.android.settings.PARENT_FRAGMENT_TITLE";
    private static final String META_DATA_KEY_PARENT_FRAGMENT_CLASS =
        "com.android.settings.PARENT_FRAGMENT_CLASS";

    private static final String EXTRA_CLEAR_UI_OPTIONS = "settings:remove_ui_options";

    private static final String SAVE_KEY_CURRENT_HEADER = "com.android.settings.CURRENT_HEADER";
    private static final String SAVE_KEY_PARENT_HEADER = "com.android.settings.PARENT_HEADER";
    //fix bug 210641 the text of "backup and reset" not appropriate ,when os did not support backup on 2013.9.4 start
    private static final String GSETTINGS_PROVIDER = "com.google.settings";
    //fix bug 210641 the text of "backup and reset" not appropriate ,when os did not support backup on 2013.9.4 send
    public static boolean UNIVERSEUI_SUPPORT = SystemProperties.getBoolean("universe_ui_support",false);
    public static final boolean CU_SUPPORT = SystemProperties.get("ro.operator").equals("cucc");

    private String mFragmentClass;
    private int mTopLevelHeaderId;
    private Header mFirstHeader;
    private Header mCurrentHeader;
    private Header mParentHeader;
    private boolean mInLocalHeaderSwitch;

    // Show only these settings for restricted users
    private int[] SETTINGS_FOR_RESTRICTED = {
            R.id.wifi_settings,
            R.id.bluetooth_settings,
            R.id.sound_settings,
            R.id.display_settings,
            R.id.security_settings,
            R.id.account_settings,
            R.id.about_settings
    };

    private boolean mEnableUserManagement = false;

    // TODO: Update Call Settings based on airplane mode state.

    protected HashMap&lt;Integer, Integer&gt; mHeaderIndexMap = new HashMap&lt;Integer, Integer&gt;();

    private AuthenticatorHelper mAuthenticatorHelper;
    private Header mLastHeader;
    private boolean mListeningToAccountUpdates;
    private boolean  mBluetoothEnable;
    private boolean  mVoiceCapable;

	// Start by luqiang, topwise, 2014.2.27 [wristwatch config]
	//private boolean mIsOpenWristwatchCfg = TopwiseProp.getDefaultSettingBoolean("topwise_open_wristwatch");
	private boolean mIsOpenWristwatchCfg = TopwiseProp.getDefaultSettingBoolean("topwise_wristwatch_unlock");
	// End by luqiang, topwise, 2014.2.27 [wristwatch config]

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        mBluetoothEnable = (SystemProperties.getInt("ro.tablet.bluetooth.enable", 1) != 0);
        mBluetoothEnable = (SystemProperties.getInt("ro.tablet.bluetooth.enable", 1) != 0);
        mVoiceCapable = getResources().getBoolean(com.android.internal.R.bool.config_voice_capable);
        if (getIntent().getBooleanExtra(EXTRA_CLEAR_UI_OPTIONS, false)) {
            getWindow().setUiOptions(0);
        }

        if (android.provider.Settings.Secure.getInt(getContentResolver(), "multiuser_enabled", -1)
                &gt; 0) {
            mEnableUserManagement = true;
        }

        mAuthenticatorHelper = new AuthenticatorHelper();
        mAuthenticatorHelper.updateAuthDescriptions(this);
        mAuthenticatorHelper.onAccountsUpdated(this, null);

        getMetaData();
        mInLocalHeaderSwitch = true;
        //add by daiwei for tab
        if (getClass().getName().equals("com.android.settings.Settings")) {
        	setTheme(android.R.style.Theme_Holo_Light_NoActionBar);
        }
        //end by daiwei
        super.onCreate(savedInstanceState);
        mInLocalHeaderSwitch = false;

        //For LowCost case, define the list selector by itself
        if (LC_RAM_SUPPORT)
        	getListView().setSelector(R.drawable.list_selector_holo_dark);

        if (!onIsHidingHeaders() &amp;&amp; onIsMultiPane()) {
            highlightHeader(mTopLevelHeaderId);
            // Force the title so that it doesn't get overridden by a direct launch of
            // a specific settings screen.
            setTitle(R.string.settings_label);
        }

        // Retrieve any saved state
        if (savedInstanceState != null) {
            mCurrentHeader = savedInstanceState.getParcelable(SAVE_KEY_CURRENT_HEADER);
            mParentHeader = savedInstanceState.getParcelable(SAVE_KEY_PARENT_HEADER);
        }

        // If the current header was saved, switch to it
        if (savedInstanceState != null &amp;&amp; mCurrentHeader != null) {
            //switchToHeaderLocal(mCurrentHeader);
            showBreadCrumbs(mCurrentHeader.title, null);
        }

        if (mParentHeader != null) {
            setParentTitle(mParentHeader.title, null, new OnClickListener() {
                public void onClick(View v) {
                    switchToParent(mParentHeader.fragment);
                }
            });
        }

        // Override up navigation for multi-pane, since we handle it in the fragment breadcrumbs
        if (onIsMultiPane()) {
            getActionBar().setDisplayHomeAsUpEnabled(false);
            getActionBar().setHomeButtonEnabled(false);
        }
        
        //add by daiwei for tab setting
        if (getClass().getName().equals("com.android.settings.Settings")) {
        	setContentView(R.layout.tab_settings);
    		mTabCursor = (ImageView)findViewById(R.id.tab_cursor);
    		ViewPager viewPager = (ViewPager)findViewById(R.id.pager);
    		viewPager.setAdapter(new ViewPagerAdapter(getFragmentManager()));
    		viewPager.setOnPageChangeListener(mPageChangeListener);
    		mViewPager = viewPager;
    		
    		View tab_general = findViewById(R.id.tab_general);
    		View tab_display = findViewById(R.id.tab_display);
    		tab_general.setOnClickListener(mTabOnClickListener);
    		tab_display.setOnClickListener(mTabOnClickListener);
    		mTabGeneral = (TextView)tab_general;
    		mTabDisplay = (TextView)tab_display;
    		mTabGeneral.setTextColor(COLOR_SELECTED);
    		mTabGeneral.setTextSize(TEXT_SIZE_SELECTED);
        }
        //end by daiwei
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);

        // Save the current fragment, if it is the same as originally launched
        if (mCurrentHeader != null) {
            outState.putParcelable(SAVE_KEY_CURRENT_HEADER, mCurrentHeader);
        }
        if (mParentHeader != null) {
            outState.putParcelable(SAVE_KEY_PARENT_HEADER, mParentHeader);
        }
    }

    @Override
    public void onResume() {
        super.onResume();

        ListAdapter listAdapter = getListAdapter();
        if (listAdapter instanceof HeaderAdapter) {
            ((HeaderAdapter) listAdapter).resume();
        }
        invalidateHeaders();
        setActionBarStyle();//add by liweiping 20140210 for bug 173
    }
    
    //start by liweiping 20140210 for bug 173
    /* Set ActionBar with popup function */
    protected void setActionBarStyle() {
        ActionBar actionBar = getActionBar();
        if (actionBar == null){
            return;
        }
        if ( this.toString().contains("SubSettings") ) {
            actionBar.setDisplayOptions(ActionBar.DISPLAY_HOME_AS_UP, ActionBar.DISPLAY_HOME_AS_UP);
            actionBar.setDisplayHomeAsUpEnabled(true);
        }
        else {
            actionBar.setDisplayOptions(ActionBar.DISPLAY_HOME_AS_UP
                    ^ ActionBar.DISPLAY_HOME_AS_UP
                    , ActionBar.DISPLAY_HOME_AS_UP);
            actionBar.setDisplayHomeAsUpEnabled(false);
        }
    }
    //end by liweiping 20140210 

    @Override
    public void onPause() {
        super.onPause();

        ListAdapter listAdapter = getListAdapter();
        if (listAdapter instanceof HeaderAdapter) {
            ((HeaderAdapter) listAdapter).pause();
        }
    }

    private String getRunningActivityName() {
        ActivityManager activityManager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
        return activityManager != null ? activityManager.getRunningTasks(1).get(0).topActivity
                .getClassName() : null;
    }

    // fix bug 185285 to avoid jump out of Settings when Locale changed on 20130819 begin
    /*@Override
    public void onBackPressed() {
        if (!moveTaskToBack(false)) {
            super.onBackPressed();
        }
    }*/
    // fix bug 185285 to avoid jump out of Settings when Locale changed on 20130819 end

    @Override
    public void onDestroy() {
        super.onDestroy();
        if (mListeningToAccountUpdates) {
            AccountManager.get(this).removeOnAccountsUpdatedListener(this);
        }
    }

    private void switchToHeaderLocal(Header header) {
        mInLocalHeaderSwitch = true;
        switchToHeader(header);
        mInLocalHeaderSwitch = false;
    }

    @Override
    public void switchToHeader(Header header) {
        if (!mInLocalHeaderSwitch) {
            mCurrentHeader = null;
            mParentHeader = null;
        }
        super.switchToHeader(header);
    }

    /**
     * Switch to parent fragment and store the grand parent's info
     * @param className name of the activity wrapper for the parent fragment.
     */
    private void switchToParent(String className) {
        final ComponentName cn = new ComponentName(this, className);
        try {
            final PackageManager pm = getPackageManager();
            final ActivityInfo parentInfo = pm.getActivityInfo(cn, PackageManager.GET_META_DATA);

            if (parentInfo != null &amp;&amp; parentInfo.metaData != null) {
                String fragmentClass = parentInfo.metaData.getString(META_DATA_KEY_FRAGMENT_CLASS);
                CharSequence fragmentTitle = parentInfo.loadLabel(pm);
                Header parentHeader = new Header();
                parentHeader.fragment = fragmentClass;
                parentHeader.title = fragmentTitle;
                mCurrentHeader = parentHeader;

                switchToHeaderLocal(parentHeader);
                highlightHeader(mTopLevelHeaderId);

                mParentHeader = new Header();
                mParentHeader.fragment
                        = parentInfo.metaData.getString(META_DATA_KEY_PARENT_FRAGMENT_CLASS);
                mParentHeader.title = parentInfo.metaData.getString(META_DATA_KEY_PARENT_TITLE);
            }
        } catch (NameNotFoundException nnfe) {
            Log.w(LOG_TAG, "Could not find parent activity : " + className);
        }
    }

    @Override
    public void onNewIntent(Intent intent) {
        super.onNewIntent(intent);

        // If it is not launched from history, then reset to top-level
        if ((intent.getFlags() &amp; Intent.FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY) == 0
                &amp;&amp; mFirstHeader != null &amp;&amp; !onIsHidingHeaders() &amp;&amp; onIsMultiPane()) {
            switchToHeaderLocal(mFirstHeader);
        }
    }

    private void highlightHeader(int id) {
        if (id != 0) {
            Integer index = mHeaderIndexMap.get(id);
            if (index != null) {
                getListView().setItemChecked(index, true);
                getListView().smoothScrollToPosition(index);
            }
        }
    }

    @Override
    public Intent getIntent() {
        Intent superIntent = super.getIntent();
        String startingFragment = getStartingFragmentClass(superIntent);
        // This is called from super.onCreate, isMultiPane() is not yet reliable
        // Do not use onIsHidingHeaders either, which relies itself on this method
        if (startingFragment != null &amp;&amp; !onIsMultiPane()) {
            Intent modIntent = new Intent(superIntent);
            modIntent.putExtra(EXTRA_SHOW_FRAGMENT, startingFragment);
            Bundle args = superIntent.getExtras();
            if (args != null) {
                args = new Bundle(args);
            } else {
                args = new Bundle();
            }
            args.putParcelable("intent", superIntent);
            modIntent.putExtra(EXTRA_SHOW_FRAGMENT_ARGUMENTS, superIntent.getExtras());
            return modIntent;
        }
        return superIntent;
    }

    /**
     * Checks if the component name in the intent is different from the Settings class and
     * returns the class name to load as a fragment.
     */
    protected String getStartingFragmentClass(Intent intent) {
        if (mFragmentClass != null) return mFragmentClass;

        String intentClass = intent.getComponent().getClassName();
        if (intentClass.equals(getClass().getName())) return null;

        if ("com.android.settings.ManageApplications".equals(intentClass)
                || "com.android.settings.RunningServices".equals(intentClass)
                || "com.android.settings.applications.StorageUse".equals(intentClass)) {
            // Old names of manage apps.
            intentClass = com.android.settings.applications.ManageApplications.class.getName();
        }

        return intentClass;
    }

    /**
     * Override initial header when an activity-alias is causing Settings to be launched
     * for a specific fragment encoded in the android:name parameter.
     */
    @Override
    public Header onGetInitialHeader() {
        String fragmentClass = getStartingFragmentClass(super.getIntent());
        if (fragmentClass != null) {
            Header header = new Header();
            header.fragment = fragmentClass;
            header.title = getTitle();
            header.fragmentArguments = getIntent().getExtras();
            mCurrentHeader = header;
            return header;
        }

        return mFirstHeader;
    }

    @Override
    public Intent onBuildStartFragmentIntent(String fragmentName, Bundle args,
            int titleRes, int shortTitleRes) {
        Intent intent = super.onBuildStartFragmentIntent(fragmentName, args,
                titleRes, shortTitleRes);

        // some fragments want to avoid split actionbar
        if (DataUsageSummary.class.getName().equals(fragmentName) ||
                PowerUsageSummary.class.getName().equals(fragmentName) ||
                AccountSyncSettings.class.getName().equals(fragmentName) ||
                UserDictionarySettings.class.getName().equals(fragmentName) ||
                Memory.class.getName().equals(fragmentName) ||
                ManageApplications.class.getName().equals(fragmentName) ||
                WirelessSettings.class.getName().equals(fragmentName) ||
                SoundSettings.class.getName().equals(fragmentName) ||
                PrivacySettings.class.getName().equals(fragmentName) ||
                // SPRD: Modify 20130830 Spreadst of Bug 207441 clipboard can not be called
                UserDictionaryAddWordFragment.class.getName().equals(fragmentName) ||
                ManageAccountsSettings.class.getName().equals(fragmentName)) {
            intent.putExtra(EXTRA_CLEAR_UI_OPTIONS, true);
        }
        //fix bug 226565 select englisg in userdictoryaddwors, rotate, the language change to chinses on 20131012 begin
        intent.setClass(this, SubSettings.class);
        /* 
        // fix bug 194403 to make the activity execute onCreate() method when orientation changed on 20130802 begin
        Log.i(LOG_TAG,"fragmentName = " + fragmentName);
        if (UserDictionaryAddWordFragment.class.getName().equals(fragmentName)) {
            intent.setClass(this, LanguageSubSettings.class);
        } else {
            intent.setClass(this, SubSettings.class);
        }
        // fix bug 194403 to make the activity execute onCreate() method when orientation changed on 20130802 end
        */
        // fix bug 226565 select englisg in userdictoryaddwors, rotate, the language change to chinses on 20131012 end
        return intent;
    }

    /**
     * Populate the activity with the top-level headers.
     */
    @Override
    public void onBuildHeaders(List&lt;Header&gt; headers) {
        if(UNIVERSEUI_SUPPORT){
            loadHeadersFromResource(R.xml.settings_headers_uui, headers);
        }else{
            loadHeadersFromResource(R.xml.settings_headers, headers);
        }

        updateHeaderList(headers);
    }

    private void updateHeaderList(List&lt;Header&gt; target) {
        int i = 0;
        boolean IsSupVoice = Settings.this.getResources().getBoolean(com.android.internal.R.bool.
config_voice_capable);
        while (i &lt; target.size()) {
            Header header = target.get(i);
            // Ids are integers, so downcasting
            int id = (int) header.id;
            if (id == R.id.dock_settings) {
                if (!needsDockSettings())
                    target.remove(header);
            } else if (id == R.id.operator_settings || id == R.id.manufacturer_settings) {
                Utils.updateHeaderToSpecificActivityFromMetaDataOrRemove(this, target, header);
            } else if (id == R.id.wifi_settings) {
                // Remove WiFi Settings if WiFi service is not available.
                // Start by changyan 2014.01.02
                //if (!getPackageManager().hasSystemFeature(PackageManager.FEATURE_WIFI)) {
                if (!SystemProperties.getBoolean("ro.device.support.wifi", true)) {                    
                //End by changyan 
                    target.remove(header);
                }
            } else if (id == R.id.bluetooth_settings) {
                //Start by changyan 2014.01.03
                // Remove Bluetooth Settings if Bluetooth service is not available.
                //if ((!getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH))
                //        || (!mBluetoothEnable)) {
                if (!SystemProperties.getBoolean("ro.device.support.bt", true)) {
                //End by changyan   
                    target.remove(header);
                }
            } else if (id == R.id.data_usage_settings) {
                // Remove data usage when kernel module not enabled
                final INetworkManagementService netManager = INetworkManagementService.Stub
                        .asInterface(ServiceManager.getService(Context.NETWORKMANAGEMENT_SERVICE));
                // fix bug 182580 to delete the data usage item of settings on 20130717 begin
                boolean support_cmcc = SystemProperties.get("ro.operator").equals("cmcc");
                try {
                    if (!netManager.isBandwidthControlEnabled() || support_cmcc) {
                        target.remove(header);
                    }
                } catch (RemoteException e) {
                    // ignored
                }
                // fix bug 182580 to delete the data usage item of settings on 20130717 end
            } else if (id == R.id.account_settings) {
                int headerIndex = i + 1;
                i = insertAccountsHeaders(target, headerIndex);
            } else if (id == R.id.user_settings) {
                if (!mEnableUserManagement
                        || !UserId.MU_ENABLED || UserId.myUserId() != 0
                        || !getResources().getBoolean(R.bool.enable_user_management)
                        || Utils.isMonkeyRunning()) {
                    target.remove(header);
                }
            } else if (id == R.id.dual_sim_settings) {
                if (!TelephonyManager.isMultiSim() || (!mVoiceCapable)) {
                    target.remove(header);
                }
            } else if (id == R.id.network_preference_settings) {
                if (!CU_SUPPORT) {
                    target.remove(header);
                }
            }
            else if (id == R.id.sound_settings &amp;&amp; IsSupVoice)
            {
                target.remove(header);
            }
            else if (id == R.id.audio_profiles &amp;&amp; !IsSupVoice)
            {
                target.remove(header);
            }

			// Start by luqiang, topwise, 2014.2.27 [wristwatch config]
			else if (id == R.id.wristwatch_settings &amp;&amp; false == mIsOpenWristwatchCfg) {
				target.remove(header);
			}
			// End by luqiang, topwise, 2014.2.27 [wristwatch config]

            if (UserId.MU_ENABLED &amp;&amp; UserId.myUserId() != 0
                    &amp;&amp; !ArrayUtils.contains(SETTINGS_FOR_RESTRICTED, id)) {
                target.remove(header);
            }

            // Increment if the current one wasn't removed by the Utils code.
            if (target.get(i) == header) {
                // Hold on to the first header, when we need to reset to the top-level
                if (mFirstHeader == null &amp;&amp;
                        HeaderAdapter.getHeaderType(header) != HeaderAdapter.HEADER_TYPE_CATEGORY) {
                    mFirstHeader = header;
                }
                mHeaderIndexMap.put(id, i);
                i++;
            }
        }
    }

    private int insertAccountsHeaders(List&lt;Header&gt; target, int headerIndex) {
        String[] accountTypes = mAuthenticatorHelper.getEnabledAccountTypes();
        List&lt;Header&gt; accountHeaders = new ArrayList&lt;Header&gt;(accountTypes.length);
        for (String accountType : accountTypes) {
	    if (accountType.startsWith("sprd")) {
		continue;
	    }
            CharSequence label = mAuthenticatorHelper.getLabelForType(this, accountType);
            if (label == null) {
                continue;
            }

            Account[] accounts = AccountManager.get(this).getAccountsByType(accountType);
            boolean skipToAccount = accounts.length == 1
                    &amp;&amp; !mAuthenticatorHelper.hasAccountPreferences(accountType);
            Header accHeader = new Header();
            accHeader.title = label;
            if (accHeader.extras == null) {
                accHeader.extras = new Bundle();
            }
            if (skipToAccount) {
                accHeader.breadCrumbTitleRes = R.string.account_sync_settings_title;
                accHeader.breadCrumbShortTitleRes = R.string.account_sync_settings_title;
                accHeader.fragment = AccountSyncSettings.class.getName();
                accHeader.fragmentArguments = new Bundle();
                // Need this for the icon
                accHeader.extras.putString(ManageAccountsSettings.KEY_ACCOUNT_TYPE, accountType);
                accHeader.extras.putParcelable(AccountSyncSettings.ACCOUNT_KEY, accounts[0]);
                accHeader.fragmentArguments.putParcelable(AccountSyncSettings.ACCOUNT_KEY,
                        accounts[0]);
            } else {
                accHeader.breadCrumbTitle = label;
                accHeader.breadCrumbShortTitle = label;
                accHeader.fragment = ManageAccountsSettings.class.getName();
                accHeader.fragmentArguments = new Bundle();
                accHeader.extras.putString(ManageAccountsSettings.KEY_ACCOUNT_TYPE, accountType);
                accHeader.fragmentArguments.putString(ManageAccountsSettings.KEY_ACCOUNT_TYPE,
                        accountType);
                if (!isMultiPane()) {
                    accHeader.fragmentArguments.putString(ManageAccountsSettings.KEY_ACCOUNT_LABEL,
                            label.toString());
                }
            }
            accountHeaders.add(accHeader);
        }

        // Sort by label
        Collections.sort(accountHeaders, new Comparator&lt;Header&gt;() {
            @Override
            public int compare(Header h1, Header h2) {
                return h1.title.toString().compareTo(h2.title.toString());
            }
        });

        for (Header header : accountHeaders) {
            target.add(headerIndex++, header);
        }
        if (!mListeningToAccountUpdates) {
            AccountManager.get(this).addOnAccountsUpdatedListener(this, null, true);
            mListeningToAccountUpdates = true;
        }
        return headerIndex;
    }

    private boolean needsDockSettings() {
        return getResources().getBoolean(R.bool.has_dock_settings);
    }

    private void getMetaData() {
        try {
            ActivityInfo ai = getPackageManager().getActivityInfo(getComponentName(),
                    PackageManager.GET_META_DATA);
            if (ai == null || ai.metaData == null) return;
            mTopLevelHeaderId = ai.metaData.getInt(META_DATA_KEY_HEADER_ID);
            mFragmentClass = ai.metaData.getString(META_DATA_KEY_FRAGMENT_CLASS);

            // Check if it has a parent specified and create a Header object
            final int parentHeaderTitleRes = ai.metaData.getInt(META_DATA_KEY_PARENT_TITLE);
            String parentFragmentClass = ai.metaData.getString(META_DATA_KEY_PARENT_FRAGMENT_CLASS);
            if (parentFragmentClass != null) {
                mParentHeader = new Header();
                mParentHeader.fragment = parentFragmentClass;
                if (parentHeaderTitleRes != 0) {
                    mParentHeader.title = getResources().getString(parentHeaderTitleRes);
                }
            }
        } catch (NameNotFoundException nnfe) {
            // No recovery
        }
    }

    @Override
    public boolean hasNextButton() {
        return super.hasNextButton();
    }

    @Override
    public Button getNextButton() {
        return super.getNextButton();
    }

    private static class HeaderAdapter extends ArrayAdapter&lt;Header&gt; {
        static final int HEADER_TYPE_CATEGORY = 0;
        static final int HEADER_TYPE_NORMAL = 1;
        static final int HEADER_TYPE_SWITCH = 2;
        private static final int HEADER_TYPE_COUNT = HEADER_TYPE_SWITCH + 1;

		// Start by luqiang, topwise, 2014.2.27 [wristwatch config]
		private final WristwatchEnabler mWristwatchEnabler;
		// End by luqiang, topwise, 2014.2.27 [wristwatch config]

		private final WifiEnabler mWifiEnabler;
        private final BluetoothEnabler mBluetoothEnabler;
        private AuthenticatorHelper mAuthHelper;

        private static class HeaderViewHolder {
            ImageView icon;
            TextView title;
            TextView summary;
            Switch switch_;
        }

        private LayoutInflater mInflater;

        static int getHeaderType(Header header) {
            if (header.fragment == null &amp;&amp; header.intent == null) {
                return HEADER_TYPE_CATEGORY;
		// Start by luqiang, topwise, 2014.2.27 [wristwatch config]
            } else if (header.id == R.id.wifi_settings || header.id == R.id.bluetooth_settings || header.id == R.id.wristwatch_settings) {
		// End by luqiang, topwise, 2014.2.27 [wristwatch config]
                return HEADER_TYPE_SWITCH;
            } else {
                return HEADER_TYPE_NORMAL;
            }
        }

        @Override
        public int getItemViewType(int position) {
            Header header = getItem(position);
            return getHeaderType(header);
        }

        @Override
        public boolean areAllItemsEnabled() {
            return false; // because of categories
        }

        @Override
        public boolean isEnabled(int position) {
            return getItemViewType(position) != HEADER_TYPE_CATEGORY;
        }

        @Override
        public int getViewTypeCount() {
            return HEADER_TYPE_COUNT;
        }

        @Override
        public boolean hasStableIds() {
            return true;
        }

        public HeaderAdapter(Context context, List&lt;Header&gt; objects,
                AuthenticatorHelper authenticatorHelper) {
            super(context, 0, objects);

            mAuthHelper = authenticatorHelper;
            mInflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

            // Temp Switches provided as placeholder until the adapter replaces these with actual
            // Switches inflated from their layouts. Must be done before adapter is set in super
            mWifiEnabler = new WifiEnabler(context, new Switch(context));
            mBluetoothEnabler = new BluetoothEnabler(context, new Switch(context));
			// Start by luqiang, topwise, 2014.2.27 [wristwatch config]
			mWristwatchEnabler = new WristwatchEnabler(context, new Switch(context));
			// End by luqiang, topwise, 2014.2.27 [wristwatch config]
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            HeaderViewHolder holder;
            Header header = getItem(position);
            int headerType = getHeaderType(header);
            View view = null;

            if (convertView == null) {
                holder = new HeaderViewHolder();
                switch (headerType) {
                    case HEADER_TYPE_CATEGORY:
                        view = new TextView(getContext(), null,
                                android.R.attr.listSeparatorTextViewStyle);
                        holder.title = (TextView) view;
                        break;

                    case HEADER_TYPE_SWITCH:
                        view = mInflater.inflate(R.layout.preference_header_switch_item, parent,
                                false);
                        holder.icon = (ImageView) view.findViewById(R.id.icon);
                        holder.title = (TextView)
                                view.findViewById(com.android.internal.R.id.title);
                        holder.summary = (TextView)
                                view.findViewById(com.android.internal.R.id.summary);
                        holder.switch_ = (Switch) view.findViewById(R.id.switchWidget);
                        break;

                    case HEADER_TYPE_NORMAL:
                        view = mInflater.inflate(
                                R.layout.preference_header_item, parent,
                                false);
                        holder.icon = (ImageView) view.findViewById(R.id.icon);
                        holder.title = (TextView)
                                view.findViewById(com.android.internal.R.id.title);
                        holder.summary = (TextView)
                                view.findViewById(com.android.internal.R.id.summary);
                        break;
                }
                view.setTag(holder);
            } else {
                view = convertView;
                holder = (HeaderViewHolder) view.getTag();
            }

            // All view fields must be updated every time, because the view may be recycled
            switch (headerType) {
                case HEADER_TYPE_CATEGORY:
                    holder.title.setText(header.getTitle(getContext().getResources()));
                    break;

                case HEADER_TYPE_SWITCH:
                    // Would need a different treatment if the main menu had more switches
                    if (header.id == R.id.wifi_settings) {
                        mWifiEnabler.setSwitch(holder.switch_);
				// Start by luqiang, topwise, 2014.2.27 [wristwatch config]
				} else if (header.id == R.id.wristwatch_settings) {
					mWristwatchEnabler.setSwitch(holder.switch_);
				// End by luqiang, topwise, 2014.2.27 [wristwatch config]
                    } else {
                        mBluetoothEnabler.setSwitch(holder.switch_);
                    }
                    // No break, fall through on purpose to update common fields

                    //$FALL-THROUGH$
                case HEADER_TYPE_NORMAL:
                    if (header.extras != null
                            &amp;&amp; header.extras.containsKey(ManageAccountsSettings.KEY_ACCOUNT_TYPE)) {
                        String accType = header.extras.getString(
                                ManageAccountsSettings.KEY_ACCOUNT_TYPE);
                        ViewGroup.LayoutParams lp = holder.icon.getLayoutParams();
                        lp.width = getContext().getResources().getDimensionPixelSize(
                                R.dimen.header_icon_width);
                        lp.height = lp.width;
                        holder.icon.setLayoutParams(lp);
                        Drawable icon = mAuthHelper.getDrawableForType(getContext(), accType);
                        holder.icon.setImageDrawable(icon);
                    } else {
                        holder.icon.setImageResource(header.iconRes);
                    }
                    holder.title.setText(header.getTitle(getContext().getResources()));
                    //fix bug 210641 the text of "backup and reset" not appropriate ,when os did not support backup on 2013.9.4 start
                    if(header.id == R.id.privacy_settings) {
                        if (getContext().getPackageManager().resolveContentProvider(GSETTINGS_PROVIDER, 0) == null) {
                            holder.title.setText(getContext().getResources().getText(R.string.privacy_settings));
                        }
                    }
                    //fix bug 210641 the text of "backup and reset" not appropriate ,when os did not support backup on 2013.9.4 end
                    CharSequence summary = header.getSummary(getContext().getResources());
                    if (!TextUtils.isEmpty(summary)) {
                        holder.summary.setVisibility(View.VISIBLE);
                        holder.summary.setText(summary);
                    } else {
                        holder.summary.setVisibility(View.GONE);
                    }
                    break;
            }

            return view;
        }

        public void resume() {
            mWifiEnabler.resume();
            mBluetoothEnabler.resume();
			// Start by luqiang, topwise, 2014.2.27 [wristwatch config]
            mWristwatchEnabler.resume();
			// End by luqiang, topwise, 2014.2.27 [wristwatch config]
        }

        public void pause() {
            mWifiEnabler.pause();
            mBluetoothEnabler.pause();
			// Start by luqiang, topwise, 2014.2.27 [wristwatch config]
            mWristwatchEnabler.pause();
			// End by luqiang, topwise, 2014.2.27 [wristwatch config]
        }
    }

    @Override
    public void onHeaderClick(Header header, int position) {
        boolean revert = false;
        if (header.id == R.id.account_add) {
            revert = true;
        }
//start,added by topwise hehuadong in 2014.01.16
    	if (TopwiseProp.getDefaultSettingString("default_customize_about_device")!=null){
    		if (header != null &amp;&amp; header.fragment != null &amp;&amp; header.fragment.equals("com.android.settings.DeviceInfoSettings")){
    			header.fragment="com.android.settings.AboutDeviceSettings";
    		}
    	}
//end,added by topwise hehuadong in 2014.01.16
        super.onHeaderClick(header, position);

        if (revert &amp;&amp; mLastHeader != null) {
            // fix bug 200478 to avoid list scroll when account_add item selected on 20130810 begin
            //highlightHeader((int) mLastHeader.id);
            // fix bug 200478 to avoid list scroll when account_add item selected on 20130810 end
        } else {
            mLastHeader = header;
        }
    }

    @Override
    public boolean onPreferenceStartFragment(PreferenceFragment caller, Preference pref) {
        // Override the fragment title for Wallpaper settings
        int titleRes = pref.getTitleRes();
        if (pref.getFragment().equals(WallpaperTypeSettings.class.getName())) {
            titleRes = R.string.wallpaper_settings_fragment_title;
        }
        startPreferencePanel(pref.getFragment(), pref.getExtras(), titleRes, pref.getTitle(),
                null, 0);
        return true;
    }

    public boolean shouldUpRecreateTask(Intent targetIntent) {
        return super.shouldUpRecreateTask(new Intent(this, Settings.class));
    }

    @Override
    public void setListAdapter(ListAdapter adapter) {
        if (adapter == null) {
            super.setListAdapter(null);
        } else {
            super.setListAdapter(new HeaderAdapter(this, getHeaders(), mAuthenticatorHelper));
        }
    }

    @Override
    public void onAccountsUpdated(Account[] accounts) {
        mAuthenticatorHelper.onAccountsUpdated(this, accounts);
        invalidateHeaders();
    }
    
    //add by daiwei for tab settings
    static final int COLOR_SELECTED = 0xff0b984c;
    static final int COLOR_UNSELECTED = 0xff000000;
    static final int TEXT_SIZE_SELECTED = 18;
    static final int TEXT_SIZE_UNSELECTED = 16;
	private ImageView mTabCursor = null;
	private ViewPager mViewPager = null;
	private TextView mTabGeneral = null;
	private TextView mTabDisplay = null;
	
    private OnPageChangeListener mPageChangeListener = new OnPageChangeListener() {
		@Override
		public void onPageScrollStateChanged(int state) {
			if (state == ViewPager.SCROLL_STATE_IDLE) {
				mTabCursor.setX(mViewPager.getCurrentItem() * mTabCursor.getWidth());
			}
		}

		@Override
		public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {
			if (positionOffset == 0.0f) return;			
			mTabCursor.setX(positionOffset * mTabCursor.getWidth());
		}

		@Override
		public void onPageSelected(int position) {
			if (0 == position) {
				mTabGeneral.setTextColor(COLOR_SELECTED);
				mTabGeneral.setTextSize(TEXT_SIZE_SELECTED);
				mTabDisplay.setTextColor(COLOR_UNSELECTED);
				mTabDisplay.setTextSize(TEXT_SIZE_UNSELECTED);
			} else if (1 == position) {
				mTabGeneral.setTextColor(COLOR_UNSELECTED);
				mTabGeneral.setTextSize(TEXT_SIZE_UNSELECTED);
				mTabDisplay.setTextColor(COLOR_SELECTED);
				mTabDisplay.setTextSize(TEXT_SIZE_SELECTED);
			}
		}
    	
    };
    
    public class ViewPagerAdapter extends FragmentPagerAdapter {
        public ViewPagerAdapter(FragmentManager fm) {
            super(fm);
        }

		@Override
		public Fragment getItem(int position) {
			switch(position) {
			case 0:
				return new SettingsFragment();
				
			case 1:
				return new DisplaySettings();
			}
			return null;
		}

		@Override
		public int getCount() {
			return 2;
		}
    }
    
    private OnClickListener mTabOnClickListener = new OnClickListener() {
		
		@Override
		public void onClick(View v) {
			if (v.getId() == R.id.tab_general) {
				mViewPager.setCurrentItem(0);
			} else if (v.getId() == R.id.tab_display) {
				mViewPager.setCurrentItem(1);
			}
		}
	};
    //end by daiwei

    /*
     * Settings subclasses for launching independently.
     */
    public static class BluetoothSettingsActivity extends Settings { /* empty */ }
    public static class WirelessSettingsActivity extends Settings { /* empty */ }
    public static class TetherSettingsActivity extends Settings { /* empty */ }
    public static class VpnSettingsActivity extends Settings { /* empty */ }
    public static class DateTimeSettingsActivity extends Settings { /* empty */ }
    public static class StorageSettingsActivity extends Settings { /* empty */ }
    public static class WifiSettingsActivity extends Settings { /* empty */ }
    public static class WifiP2pSettingsActivity extends Settings { /* empty */ }
    public static class InputMethodAndLanguageSettingsActivity extends Settings { /* empty */ }
    public static class KeyboardLayoutPickerActivity extends Settings { /* empty */ }
    public static class InputMethodAndSubtypeEnablerActivity extends Settings { /* empty */ }
    public static class SpellCheckersSettingsActivity extends Settings { /* empty */ }
    public static class LocalePickerActivity extends Settings { /* empty */ }
    public static class UserDictionarySettingsActivity extends Settings { /* empty */ }
    public static class SoundSettingsActivity extends Settings { /* empty */ }
    public static class DisplaySettingsActivity extends Settings { /* empty */ }
    public static class DeviceInfoSettingsActivity extends Settings { /* empty */ }
    public static class ApplicationSettingsActivity extends Settings { /* empty */ }
    public static class ManageApplicationsActivity extends Settings { /* empty */ }
    public static class StorageUseActivity extends Settings { /* empty */ }
    public static class DevelopmentSettingsActivity extends Settings { /* empty */ }
    public static class AccessibilitySettingsActivity extends Settings { /* empty */ }
    public static class SecuritySettingsActivity extends Settings { /* empty */ }
    public static class LocationSettingsActivity extends Settings { /* empty */ }
    public static class PrivacySettingsActivity extends Settings { /* empty */ }
    public static class DockSettingsActivity extends Settings { /* empty */ }
    public static class RunningServicesActivity extends Settings { /* empty */ }
    public static class ManageAccountsSettingsActivity extends Settings { /* empty */ }
    public static class PowerUsageSummaryActivity extends Settings { /* empty */ }
    public static class AccountSyncSettingsActivity extends Settings { /* empty */ }
    public static class AccountSyncSettingsInAddAccountActivity extends Settings { /* empty */ }
    public static class CryptKeeperSettingsActivity extends Settings { /* empty */ }
    public static class DeviceAdminSettingsActivity extends Settings { /* empty */ }
    public static class DataUsageSummaryActivity extends Settings { /* empty */ }
    public static class AdvancedWifiSettingsActivity extends Settings { /* empty */ }
    public static class TextToSpeechSettingsActivity extends Settings { /* empty */ }
    public static class AndroidBeamSettingsActivity extends Settings { /* empty */ }
}
</code></pre> 
   <pre><code class="language-java"><br></code></pre> 
   <p><br style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></p> 
   <p><br></p> 
   <p><br></p> 
   <p><br></p> 
   <p><br></p> 
   <p><br></p> 
   <p><br></p> 
   <p><br></p> 
   <p>本文转自mfrbuaa博客园博客，原文链接：http://www.cnblogs.com/mfrbuaa/p/5032416.html，如需转载请自行联系原作者</p> 
   <div>
    <br>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
