<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>你真的会玩SQL吗？玩爆你的数据报表之存储过程编写（下） « NotBeCN</title>
  <meta name="description" content="                  你真的会玩SQL吗？系列目录     你真的会玩SQL吗？之逻辑查询处理阶段     你真的会玩SQL吗？和平大使 内连接、外连接     你真的会玩SQL吗？三范式、数据完整性     你真的会玩SQL吗？查询指定节点及其所有父节点的方法     你真的会玩SQL吗？让人晕头...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/17/weixin_33738982_90119048.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">你真的会玩SQL吗？玩爆你的数据报表之存储过程编写（下）</h1>
    <p class="post-meta">Nov 17, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body" style="font-family:'Helvetica Neue', Helvetica, Verdana, Arial, sans-serif;font-size:14px;line-height:23.8px;"> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><strong>你真的会玩SQL吗？系列目录</strong></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="homepage1_HomePageDays_DaysList_ctl02_DayList_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4914125.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？之逻辑查询处理阶段</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="homepage1_HomePageDays_DaysList_ctl01_DayList_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4915039.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？和平大使 内连接、外连接</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="homepage1_HomePageDays_DaysList_ctl00_DayList_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4914520.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？三范式、数据完整性</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a class="titlelink" href="http://www.cnblogs.com/zhangs1986/p/4076878.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？查询指定节点及其所有父节点的方法</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="homepage1_HomePageDays_DaysList_ctl09_DayList_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4914823.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？让人晕头转向的三值逻辑</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="homepage1_HomePageDays_DaysList_ctl08_DayList_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4915180.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？EXISTS和IN之间的区别</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="homepage1_HomePageDays_DaysList_ctl07_DayList_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4915126.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？无处不在的子查询</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="homepage1_HomePageDays_DaysList_ctl06_DayList_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4915228.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？Case也疯狂</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="homepage1_HomePageDays_DaysList_ctl05_DayList_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4917680.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？表表达式，排名函数</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="homepage1_HomePageDays_DaysList_ctl04_DayList_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4915124.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？简单的 数据修改</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="homepage1_HomePageDays_DaysList_ctl03_DayList_TitleUrl_0" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4915127.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？你所不知道的 数据聚合</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4942546.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？透视转换的艺术</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4915130.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？冷落的Top和Apply</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4917800.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？实用函数方法汇总</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;"><a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4917922.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？玩爆你的数据报表之存储过程编写（上）</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;">&nbsp; &nbsp; &nbsp;&nbsp;<a class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4972400.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？玩爆你的数据报表之存储过程编写（下）</a></p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;">&nbsp;</p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;">上一篇&nbsp;<a class="postTitle2" href="http://www.cnblogs.com/zhangs1986/p/4917922.html" rel="nofollow" style="color:rgb(33,117,155);">你真的会玩SQL吗？玩爆你的数据报表之存储过程编写（上）</a>&nbsp;已经讲到了列转行的数据。</p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;">对于留下的作业不知道有没有思路？</p> 
    <p style="border:0px;font-size:18.2px;width:686px;clear:both;font-weight:bold;line-height:1.5;">这里接下来讲怎么做：</p> 
    <p>从表#tempSaleDtl2<strong>行转列</strong>，按<strong>类型聚合</strong>&nbsp;求出每个产品每个类型(面积、金额……)的合计 放入表#tempSaleDtl3</p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span><span style="line-height:1.5;"> ProductGUID,type,typecode,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">9999-13</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-00</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-13</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-08</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-09</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-10</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-11</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">9999-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
<span style="color:rgb(0,0,255);line-height:1.5;">into</span><span style="line-height:1.5;"> #tempSaleDtl3
</span><span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #tempSaleDtl2
</span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID,type,typecode
</span><span style="color:rgb(0,0,255);line-height:1.5;">ORDER</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span> ProductGUID,typecode</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.5;">&nbsp;</span></p> 
    <p>来看看这里的数据与前一步的对应关系：</p> 
    <p><img src="https://images2015.cnblogs.com/blog/273387/201511/273387-20151117172343499-892887776.png" alt="" width="1102" height="593" style="border:0px;"></p> 
    <p>结果部分数据如图：</p> 
    <p><img src="https://images2015.cnblogs.com/blog/273387/201511/273387-20151117171506811-1896097408.png" alt="" width="1098" height="396" style="border:0px;"></p> 
    <p>其中列名为了显示方便，这里用了<strong>2011，可以将列名变了year-01</strong>……。</p> 
    <p>关于行转列的知识前系列也提过，不理解的请自觉前去复习。</p> 
    <p>小技巧是用到了<strong>MAX聚合</strong>，关于这点前面聚合的文章中有提到。整个的数据结构现在越来越趋近于最后的结果了，year~继续。</p> 
    <p>&nbsp;</p> 
    <p>来看看结果中还差什么？<strong>项目！</strong></p> 
    <p>这里用 “--”来代替数据：</p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">从Project表中加入项目数据select ProjectName as orderCode,ProjectGUID,ProjectName,</span>
        <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> Project 
    </span><span style="color:rgb(0,0,255);line-height:1.5;">where</span> ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="color:rgb(0,128,0);line-height:1.5;">@ProjectGUID</span></pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p>&nbsp;</p> 
    <p>还有<strong>产品</strong>：</p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,0,255);line-height:1.5;">select</span> Project.ProjectName<span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">.</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span>a.ProductCode <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> orderCode,a.ProductGUID,a.ProductName,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> #product a
    </span><span style="color:rgb(128,128,128);line-height:1.5;">left</span> <span style="color:rgb(128,128,128);line-height:1.5;">join</span> Project <span style="color:rgb(0,0,255);line-height:1.5;">on</span> a.ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span>Project.ProjectGUID</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.5;">&nbsp;</span></p> 
    <p>部分数据如图：</p> 
    <p><img src="https://images2015.cnblogs.com/blog/273387/201511/273387-20151117172855936-719817142.png" alt="" width="1158" height="315" style="border:0px;"></p> 
    <p>&nbsp;</p> 
    <p>最后从表#tempSaleDtl3 联接产品表#product 与项目表查询出最后的显示：</p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">从产品表和Project表、#tempSaleDtl3中加入类型行数据</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">select</span> c.ProjectName<span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">.</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span>b.ProductCode<span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">.</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span>a.typecode <span style="color:rgb(0,0,255);line-height:1.5;">as</span> orderCode,a.ProductGUID, a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">type</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">))
    </span><span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> #tempSaleDtl3 a
    </span><span style="color:rgb(128,128,128);line-height:1.5;">left</span> <span style="color:rgb(128,128,128);line-height:1.5;">join</span> #product b <span style="color:rgb(0,0,255);line-height:1.5;">on</span> a.ProductGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">b.ProductGUID
    </span><span style="color:rgb(128,128,128);line-height:1.5;">left</span> <span style="color:rgb(128,128,128);line-height:1.5;">join</span> Project c <span style="color:rgb(0,0,255);line-height:1.5;">on</span> b.ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span>c.ProjectGUID</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.5;">&nbsp;</span></p> 
    <p>以上三块数据加在一起，用<strong>union ALL</strong>，然后排个序就得到最开始效果图中的结果，再次来看看：</p> 
    <p><img src="https://images2015.cnblogs.com/blog/273387/201511/273387-20151110184620915-75776861.png" alt="" style="border:0px;"></p> 
    <p>其中注意orderCode，这里用到层级，前台显示时可以更方便显示层级关系。</p> 
    <p>最后完整的code:</p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">从Project表中加入项目数据</span>
<span style="color:rgb(0,0,255);line-height:1.5;">select</span> <span style="color:rgb(128,128,128);line-height:1.5;">*</span> <span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> (
    </span><span style="color:rgb(0,0,255);line-height:1.5;">select</span> ProjectName <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> orderCode,ProjectGUID,ProjectName,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> Project 
    </span><span style="color:rgb(0,0,255);line-height:1.5;">where</span> ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="color:rgb(0,128,0);line-height:1.5;">@ProjectGUID</span>

<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">--项目1    8FA659C8-3DA9-4330-B277-9B517E67606D    项目1    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --</span>

    <span style="color:rgb(0,0,255);line-height:1.5;">union</span> <span style="color:rgb(128,128,128);line-height:1.5;">all</span>
<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">从产品表和Project表中加入合计行数据</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">select</span> Project.ProjectName<span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">.</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span>a.ProductCode <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> orderCode,a.ProductGUID,a.ProductName,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> #product a
    </span><span style="color:rgb(128,128,128);line-height:1.5;">left</span> <span style="color:rgb(128,128,128);line-height:1.5;">join</span> Project <span style="color:rgb(0,0,255);line-height:1.5;">on</span> a.ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">Project.ProjectGUID

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">--项目1    8FA659C8-3DA9-4330-B277-9B517E67606D    项目1    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">--项目1.00    00000000-0000-0000-0000-000000000000    合计    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">--项目1.产品1    18908255-DB67-4EA3-A231-8BB39D5B748B    产品1    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">--项目1.产品2    EDB216A9-EBB8-4F2C-AE4E-0A989EC7A993    产品2    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">--项目1.产品3    7040241F-5A66-4F17-AACA-7CBE2FB3BCB9    产品3    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">--项目1.产品4    108778CD-47C0-4258-9CB6-1FBE90CDEBDA    产品4    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">--项目1.产品5    43F7B9BA-EF91-4A38-A048-090179F33C9B    产品5    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --</span>

    <span style="color:rgb(0,0,255);line-height:1.5;">union</span> <span style="color:rgb(128,128,128);line-height:1.5;">ALL</span>
    
    <span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">从产品表和Project表、#tempSaleDtl3中加入类型行数据</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">select</span> c.ProjectName<span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">.</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span>b.ProductCode<span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">.</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span>a.typecode <span style="color:rgb(0,0,255);line-height:1.5;">as</span> orderCode,a.ProductGUID, a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">type</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">))
    </span><span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> #tempSaleDtl3 a
    </span><span style="color:rgb(128,128,128);line-height:1.5;">left</span> <span style="color:rgb(128,128,128);line-height:1.5;">join</span> #product b <span style="color:rgb(0,0,255);line-height:1.5;">on</span> a.ProductGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">b.ProductGUID
    </span><span style="color:rgb(128,128,128);line-height:1.5;">left</span> <span style="color:rgb(128,128,128);line-height:1.5;">join</span> Project c <span style="color:rgb(0,0,255);line-height:1.5;">on</span> b.ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">c.ProjectGUID
) t1
</span><span style="color:rgb(0,0,255);line-height:1.5;">order</span> <span style="color:rgb(0,0,255);line-height:1.5;">by</span> orderCode</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p><span style="line-height:1.5;">&nbsp;</span></p> 
    <p>最重要的重要的！！最后不要忘了删除临时表：</p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
     <pre><span style="color:rgb(0,0,255);line-height:1.5;">drop</span> <span style="color:rgb(0,0,255);line-height:1.5;">table</span><span style="line-height:1.5;"> #product
</span><span style="color:rgb(0,0,255);line-height:1.5;">drop</span> <span style="color:rgb(0,0,255);line-height:1.5;">table</span><span style="line-height:1.5;"> #TempAllSaleDtl
</span><span style="color:rgb(0,0,255);line-height:1.5;">DROP</span> <span style="color:rgb(0,0,255);line-height:1.5;">TABLE</span><span style="line-height:1.5;"> #TempSaleDtl
</span><span style="color:rgb(0,0,255);line-height:1.5;">DROP</span> <span style="color:rgb(0,0,255);line-height:1.5;">TABLE</span><span style="line-height:1.5;"> #tempSaleDtl2
</span><span style="color:rgb(0,0,255);line-height:1.5;">DROP</span> <span style="color:rgb(0,0,255);line-height:1.5;">TABLE</span><span style="line-height:1.5;"> #tempSaleDtl3
</span><span style="color:rgb(0,0,255);line-height:1.5;">DROP</span> <span style="color:rgb(0,0,255);line-height:1.5;">TABLE</span> #ProductSaleArea</pre>
    </div> 
    <p>&nbsp;</p> 
    <p>至此&nbsp;数据报表系列已结束，以上也只是提供一下思路，再次提醒一下各位在作以上每一步数据处理时请用<strong>数据集合的思维</strong>来思考，可能对于一般人来说长篇幅的存储过程编写没有写过，文中涉及到的技巧和思路是值得借鉴的，其中不理解的可以回过头来将之前系列的各部分基础知识点复习一下，然后一步步将结果打印出来测试，在脑袋里留下个前一步的数据，然后再思考下一步的数据怎么处理。如果你能毫无鸭梨的完全写出来，那恭喜你，你已经进阶为小大师，将会迎娶白富美，走上人生巅峰……想想是不是有点小激动……</p> 
    <p>&nbsp;　　<strong>SQL类下载资源已放入公众号【一个码农的日常】 ，回复：数据库 即可，今后会不定期更新</strong></p> 
    <p>最终的SQL，其中两个参数 需要查询的项目ID&nbsp;@ProjectGUID和需要查询的年份&nbsp;@Year 可以由外部传入，可以自己写个存储过程，在这里就不演示了：　　</p> 
    <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,0,255);line-height:1.5;">DBCC</span><span style="line-height:1.5;"> DROPCLEANBUFFERS 
</span><span style="color:rgb(0,0,255);line-height:1.5;">DBCC</span><span style="line-height:1.5;"> FREEPROCCACHE 

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SET STATISTICS IO ON</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">SET STATISTICS TIME ON</span>


<span style="color:rgb(0,0,255);line-height:1.5;">DECLARE</span> <span style="color:rgb(0,128,0);line-height:1.5;">@ProjectGUID</span> <span style="color:rgb(0,0,255);line-height:1.5;">UNIQUEIDENTIFIER</span>
<span style="color:rgb(0,0,255);line-height:1.5;">SET</span> <span style="color:rgb(0,128,0);line-height:1.5;">@ProjectGUID</span><span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">8FA659C8-3DA9-4330-B277-9B517E67606D</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
<span style="color:rgb(0,0,255);line-height:1.5;">DECLARE</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span> <span style="color:rgb(0,0,255);line-height:1.5;">CHAR</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">4</span><span style="line-height:1.5;">)
</span><span style="color:rgb(0,0,255);line-height:1.5;">SET</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>

<span style="color:rgb(0,128,128);line-height:1.5;">/*</span><span style="color:rgb(0,128,128);line-height:1.5;">临时表说明
  #product：用项目过滤后，将“合计”作为一个产品的集合
  #TempAllSaleDtl：通过项目过滤后的销售明细，所有月的
  #ProductSaleArea：各个产品的总面积，用于计算比例
  #TempSaleDtl：通过日期过滤，且加工过后的销售明细，包括增加累积列，以前年度、以后年度、项目合计的记录
  #tempSaleDtl2：列转行后的数据集
  #tempSaleDtl3：行转列后的数据集
  
</span><span style="color:rgb(0,128,128);line-height:1.5;">*/</span>
<span style="color:rgb(0,0,255);line-height:1.5;">select</span> ProductGUID,ProductName,ProjectGUID,ProductCode <span style="color:rgb(0,0,255);line-height:1.5;">into</span> #product <span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;">(
    </span><span style="color:rgb(0,0,255);line-height:1.5;">select</span> ProductGUID,ProductName,ProjectGUID,ProductName <span style="color:rgb(0,0,255);line-height:1.5;">as</span> ProductCode <span style="color:rgb(0,0,255);line-height:1.5;">from</span> Product <span style="color:rgb(0,0,255);line-height:1.5;">where</span> ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="color:rgb(0,128,0);line-height:1.5;">@ProjectGUID</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">union</span> <span style="color:rgb(128,128,128);line-height:1.5;">all</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">select</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">00000000-0000-0000-0000-000000000000</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>,<span style="color:rgb(0,128,0);line-height:1.5;">@ProjectGUID</span>,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">00</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> ProductCode
) a

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #product</span>

<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">--查找项目所有产品的销售明细：#TempAllSaleDtl</span>
<span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span><span style="line-height:1.5;"> ProductGUID,YearMonth,SaleAmount,SaleArea,SaleNum,SalePrice
</span><span style="color:rgb(0,0,255);line-height:1.5;">INTO</span><span style="line-height:1.5;"> #TempAllSaleDtl 
</span><span style="color:rgb(0,0,255);line-height:1.5;">FROM</span> dbo.SaleDtl <span style="color:rgb(0,0,255);line-height:1.5;">WHERE</span> ProductGUID <span style="color:rgb(128,128,128);line-height:1.5;">IN</span><span style="line-height:1.5;"> (
    </span><span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> ProductGUID <span style="color:rgb(0,0,255);line-height:1.5;">FROM</span> dbo.Product <span style="color:rgb(0,0,255);line-height:1.5;">WHERE</span> ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="color:rgb(0,128,0);line-height:1.5;">@ProjectGUID</span><span style="line-height:1.5;"> 
)

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #TempAllSaleDtl</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID,YearMonth</span>


<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">根据现有数据统计，向#TempAllSaleDtl添加总合计记录</span>
<span style="color:rgb(0,0,255);line-height:1.5;">insert</span> <span style="color:rgb(0,0,255);line-height:1.5;">into</span><span style="line-height:1.5;"> #TempAllSaleDtl(ProductGUID,YearMonth,SaleAmount,SaleArea,SaleNum,SalePrice)
</span><span style="color:rgb(0,0,255);line-height:1.5;">select</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">00000000-0000-0000-0000-000000000000</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>,YearMonth,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleAmount),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleArea),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleNum),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleAmount)<span style="color:rgb(128,128,128);line-height:1.5;">/</span><span style="color:rgb(255,0,255);line-height:1.5;">SUM</span><span style="line-height:1.5;">(SaleArea) 
</span><span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> #TempAllSaleDtl
</span><span style="color:rgb(0,0,255);line-height:1.5;">group</span> <span style="color:rgb(0,0,255);line-height:1.5;">by</span><span style="line-height:1.5;"> YearMonth

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #TempAllSaleDtl</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID,YearMonth</span>

<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">查找某年的销售明细：#TempSaleDtl</span>
<span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span><span style="line-height:1.5;"> ProductGUID,YearMonth,SaleAmount,SaleArea,SaleNum,SalePrice,
    SalePrice </span><span style="color:rgb(0,0,255);line-height:1.5;">AS</span><span style="line-height:1.5;"> ljSaleArea,
    SalePrice </span><span style="color:rgb(0,0,255);line-height:1.5;">AS</span><span style="line-height:1.5;"> blSaleArea,
    SalePrice </span><span style="color:rgb(0,0,255);line-height:1.5;">AS</span><span style="line-height:1.5;"> ljSaleAmount
</span><span style="color:rgb(0,0,255);line-height:1.5;">INTO</span><span style="line-height:1.5;"> #TempSaleDtl 
</span><span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempAllSaleDtl 
</span><span style="color:rgb(0,0,255);line-height:1.5;">WHERE</span> <span style="color:rgb(128,128,128);line-height:1.5;">LEFT</span>(<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">YearMonth</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span>,<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">4</span>)<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="color:rgb(0,128,0);line-height:1.5;">@Year</span> 

<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #TempSaleDtl</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID,YearMonth</span>

<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">获取项目各个产品的总销售面积：#ProductSaleArea</span>
<span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> ProductGUID,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleArea) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> all_SaleArea <span style="color:rgb(0,0,255);line-height:1.5;">INTO</span><span style="line-height:1.5;"> #ProductSaleArea 
</span><span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempAllSaleDtl
</span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #ProductSaleArea</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID</span>

<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">添加2011合计列的记录(本年度的各产品的所有面积、金额、均价总合计)</span>
<span style="color:rgb(0,0,255);line-height:1.5;">insert</span> <span style="color:rgb(0,0,255);line-height:1.5;">into</span><span style="line-height:1.5;"> #TempSaleDtl(
    ProductGUID,YearMonth,SaleAmount,SaleArea,SaleNum,SalePrice,ljSaleArea, blSaleArea,ljSaleAmount)
</span><span style="color:rgb(0,0,255);line-height:1.5;">select</span> ProductGUID,<span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-13</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleAmount),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleArea),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleNum),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleAmount)<span style="color:rgb(128,128,128);line-height:1.5;">/</span><span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleArea),<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span>,<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span>,<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> 
<span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> #TempSaleDtl
</span><span style="color:rgb(0,0,255);line-height:1.5;">group</span> <span style="color:rgb(0,0,255);line-height:1.5;">by</span><span style="line-height:1.5;"> ProductGUID

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #TempSaleDtl</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID,YearMonth</span>

<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">以前年度列记录（本年度以前的各产品的所有面积、金额、均价总合计 操作与上一步类似）</span>
<span style="color:rgb(0,0,255);line-height:1.5;">insert</span> <span style="color:rgb(0,0,255);line-height:1.5;">into</span><span style="line-height:1.5;"> #TempSaleDtl(
    ProductGUID,YearMonth,SaleAmount,SaleArea,SaleNum,SalePrice,ljSaleArea, blSaleArea,ljSaleAmount)
</span><span style="color:rgb(0,0,255);line-height:1.5;">select</span> ProductGUID,<span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-00</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleAmount),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleArea),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleNum),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleAmount)<span style="color:rgb(128,128,128);line-height:1.5;">/</span><span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleArea),<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span>,<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span>,<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> 
<span style="color:rgb(0,0,255);line-height:1.5;">from</span> #TempAllSaleDtl <span style="color:rgb(0,0,255);line-height:1.5;">where</span> YearMonth <span style="color:rgb(128,128,128);line-height:1.5;">&lt;</span><span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-00</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
<span style="color:rgb(0,0,255);line-height:1.5;">group</span> <span style="color:rgb(0,0,255);line-height:1.5;">by</span><span style="line-height:1.5;"> ProductGUID

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #TempSaleDtl</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID,YearMonth</span>

<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">以后年度列记录（本年度以后的各产品的所有面积、金额、均价总合计 操作与上一步类似）</span>
<span style="color:rgb(0,0,255);line-height:1.5;">insert</span> <span style="color:rgb(0,0,255);line-height:1.5;">into</span><span style="line-height:1.5;"> #TempSaleDtl(
    ProductGUID,YearMonth,SaleAmount,SaleArea,SaleNum,SalePrice,ljSaleArea, blSaleArea,ljSaleAmount)
</span><span style="color:rgb(0,0,255);line-height:1.5;">select</span> ProductGUID,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">9999-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleAmount),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleArea),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleNum),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleAmount)<span style="color:rgb(128,128,128);line-height:1.5;">/</span><span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleArea),<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span>,<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span>,<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> 
<span style="color:rgb(0,0,255);line-height:1.5;">from</span> #TempAllSaleDtl <span style="color:rgb(0,0,255);line-height:1.5;">where</span> YearMonth <span style="color:rgb(128,128,128);line-height:1.5;">&gt;</span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>((<span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(<span style="color:rgb(0,128,0);line-height:1.5;">@Year</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">int</span>) <span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">1</span>) <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">CHAR</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">4</span>))<span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-00</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
<span style="color:rgb(0,0,255);line-height:1.5;">group</span> <span style="color:rgb(0,0,255);line-height:1.5;">by</span><span style="line-height:1.5;"> ProductGUID

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #TempSaleDtl</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID,YearMonth</span>



<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">项目合计列记录(各产品取所有的合计。与上面的区别在于没有添加 here YearMonth &gt;cast((cast(@Year as int) +1) as CHAR(4))+'-00')</span>
<span style="color:rgb(0,0,255);line-height:1.5;">insert</span> <span style="color:rgb(0,0,255);line-height:1.5;">into</span><span style="line-height:1.5;"> #TempSaleDtl(
    ProductGUID,YearMonth,SaleAmount,SaleArea,SaleNum,SalePrice,ljSaleArea, blSaleArea,ljSaleAmount)
</span><span style="color:rgb(0,0,255);line-height:1.5;">select</span> ProductGUID,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">9999-13</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleAmount),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleArea),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleNum),<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleAmount)<span style="color:rgb(128,128,128);line-height:1.5;">/</span><span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(SaleArea),<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span>,<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span>,<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> 
<span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> #TempAllSaleDtl
</span><span style="color:rgb(0,0,255);line-height:1.5;">group</span> <span style="color:rgb(0,0,255);line-height:1.5;">by</span><span style="line-height:1.5;"> ProductGUID

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #TempSaleDtl</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID,YearMonth</span>



<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">更新销售明细TempSaleDtl的累积销售面积、累积销售面积比例，累积销售金额</span>
<span style="color:rgb(0,0,255);line-height:1.5;">UPDATE</span> #TempSaleDtl <span style="color:rgb(0,0,255);line-height:1.5;">SET</span><span style="line-height:1.5;"> 
    ljSaleArea</span><span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">b.sum_SaleArea,
    ljSaleAmount</span><span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">b.sum_SaleAmount,
    blSaleArea</span><span style="color:rgb(128,128,128);line-height:1.5;">=</span>b.sum_SaleArea<span style="color:rgb(128,128,128);line-height:1.5;">/</span><span style="line-height:1.5;">c.all_SaleArea
</span><span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempSaleDtl
</span><span style="color:rgb(128,128,128);line-height:1.5;">left</span> <span style="color:rgb(128,128,128);line-height:1.5;">JOIN</span><span style="line-height:1.5;"> (
    </span><span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> n.ProductGUID,n.YearMonth,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(m.SaleArea) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> sum_SaleArea,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(m.SaleAmount) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span><span style="line-height:1.5;"> sum_SaleAmount 
    </span><span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempAllSaleDtl m
    </span><span style="color:rgb(0,0,255);line-height:1.5;">INNER</span> <span style="color:rgb(128,128,128);line-height:1.5;">JOIN</span> #TempSaleDtl n <span style="color:rgb(0,0,255);line-height:1.5;">ON</span> m.YearMonth<span style="color:rgb(128,128,128);line-height:1.5;">&lt;=</span>n.YearMonth <span style="color:rgb(128,128,128);line-height:1.5;">AND</span> m.ProductGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">n.ProductGUID
    </span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> n.ProductGUID,n.YearMonth 
) b </span><span style="color:rgb(0,0,255);line-height:1.5;">ON</span> #TempSaleDtl.ProductGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span>b.ProductGUID <span style="color:rgb(128,128,128);line-height:1.5;">AND</span> #TempSaleDtl.YearMonth<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">b.YearMonth
</span><span style="color:rgb(128,128,128);line-height:1.5;">LEFT</span> <span style="color:rgb(128,128,128);line-height:1.5;">JOIN</span> #ProductSaleArea c <span style="color:rgb(0,0,255);line-height:1.5;">ON</span> c.ProductGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">#TempSaleDtl.ProductGUID

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #TempSaleDtl</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID,YearMonth</span>


<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">列转行，转换后的表只有 产品、统计类型、日期，值4列；(每个产品对应的0-12、13 月对应的值)</span>
<span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> <span style="color:rgb(128,128,128);line-height:1.5;">*</span> <span style="color:rgb(0,0,255);line-height:1.5;">INTO</span> #tempSaleDtl2 <span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> (
    </span><span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> ProductGUID,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">销售套数</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> type,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> typecode,YearMonth,<span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(SaleNum) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> val <span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempSaleDtl
    </span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID,YearMonth
    </span><span style="color:rgb(0,0,255);line-height:1.5;">UNION</span> <span style="color:rgb(128,128,128);line-height:1.5;">ALL</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> ProductGUID,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">销售面积</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> type,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> typecode,YearMonth,<span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(SaleArea) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> val <span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempSaleDtl
    </span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID,YearMonth
    </span><span style="color:rgb(0,0,255);line-height:1.5;">UNION</span> <span style="color:rgb(128,128,128);line-height:1.5;">ALL</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> ProductGUID,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">销售均价</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> type,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> typecode,YearMonth,<span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(SalePrice) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> val <span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempSaleDtl
    </span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID,YearMonth
    </span><span style="color:rgb(0,0,255);line-height:1.5;">UNION</span> <span style="color:rgb(128,128,128);line-height:1.5;">ALL</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> ProductGUID,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">销售金额</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> type,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> typecode,YearMonth,<span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(SaleAmount) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> val <span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempSaleDtl
    </span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID,YearMonth
    </span><span style="color:rgb(0,0,255);line-height:1.5;">UNION</span> <span style="color:rgb(128,128,128);line-height:1.5;">ALL</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> ProductGUID,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">累计销售面积</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> type, <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> typecode,YearMonth,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(ljSaleArea) <span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempSaleDtl
    </span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID,YearMonth
    </span><span style="color:rgb(0,0,255);line-height:1.5;">UNION</span> <span style="color:rgb(128,128,128);line-height:1.5;">ALL</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> ProductGUID,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">累计销售面积比例</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> type, <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> typecode,YearMonth,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(blSaleArea) <span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempSaleDtl
    </span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID,YearMonth
    </span><span style="color:rgb(0,0,255);line-height:1.5;">UNION</span> <span style="color:rgb(128,128,128);line-height:1.5;">ALL</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span> ProductGUID,<span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">累计销售金额</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> type, <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> typecode,YearMonth,<span style="color:rgb(255,0,255);line-height:1.5;">SUM</span>(ljSaleAmount) <span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #TempSaleDtl
    </span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID,YearMonth
) t

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #tempSaleDtl2</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID,yearmonth</span>


<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">行转列，按日期聚合</span>
<span style="color:rgb(0,0,255);line-height:1.5;">SELECT</span><span style="line-height:1.5;"> ProductGUID,type,typecode,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">9999-13</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-00</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-13</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-08</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-09</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-10</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-11</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(0,128,0);line-height:1.5;">@Year</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
    </span><span style="color:rgb(255,0,255);line-height:1.5;">MAX</span>(<span style="color:rgb(255,0,255);line-height:1.5;">CASE</span> YearMonth <span style="color:rgb(0,0,255);line-height:1.5;">WHEN</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">9999-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">THEN</span> val <span style="color:rgb(0,0,255);line-height:1.5;">ELSE</span> <span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">0</span> <span style="color:rgb(0,0,255);line-height:1.5;">END</span>) <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
<span style="color:rgb(0,0,255);line-height:1.5;">into</span><span style="line-height:1.5;"> #tempSaleDtl3
</span><span style="color:rgb(0,0,255);line-height:1.5;">FROM</span><span style="line-height:1.5;"> #tempSaleDtl2
</span><span style="color:rgb(0,0,255);line-height:1.5;">GROUP</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID,type,typecode
</span><span style="color:rgb(0,0,255);line-height:1.5;">ORDER</span> <span style="color:rgb(0,0,255);line-height:1.5;">BY</span><span style="line-height:1.5;"> ProductGUID,typecode

</span><span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">SELECT * FROM #tempSaleDtl3</span><span style="color:rgb(0,128,128);line-height:1.5;">
--</span><span style="color:rgb(0,128,128);line-height:1.5;">ORDER BY ProductGUID,typecode</span>


<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">从Project表中加入项目数据</span>
<span style="color:rgb(0,0,255);line-height:1.5;">select</span> <span style="color:rgb(128,128,128);line-height:1.5;">*</span> <span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> (
    </span><span style="color:rgb(0,0,255);line-height:1.5;">select</span> ProjectName <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> orderCode,ProjectGUID,ProjectName,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> Project 
    </span><span style="color:rgb(0,0,255);line-height:1.5;">where</span> ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="color:rgb(0,128,0);line-height:1.5;">@ProjectGUID</span>

<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">--项目1    8FA659C8-3DA9-4330-B277-9B517E67606D    项目1    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --    --</span>

    <span style="color:rgb(0,0,255);line-height:1.5;">union</span> <span style="color:rgb(128,128,128);line-height:1.5;">all</span>
<span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">从产品表和Project表中加入合计行数据</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">select</span> Project.ProjectName<span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">.</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span>a.ProductCode <span style="color:rgb(0,0,255);line-height:1.5;">as</span><span style="line-height:1.5;"> orderCode,a.ProductGUID,a.ProductName,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">--</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span> <span style="color:rgb(0,0,255);line-height:1.5;">AS</span> <span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> #product a
    </span><span style="color:rgb(128,128,128);line-height:1.5;">left</span> <span style="color:rgb(128,128,128);line-height:1.5;">join</span> Project <span style="color:rgb(0,0,255);line-height:1.5;">on</span> a.ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">Project.ProjectGUID

    </span><span style="color:rgb(0,0,255);line-height:1.5;">union</span> <span style="color:rgb(128,128,128);line-height:1.5;">ALL</span>
    
    <span style="color:rgb(0,128,128);line-height:1.5;">--</span><span style="color:rgb(0,128,128);line-height:1.5;">从产品表和Project表、#tempSaleDtl3中加入类型行数据</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">select</span> c.ProjectName<span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">.</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span>b.ProductCode<span style="color:rgb(128,128,128);line-height:1.5;">+</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(255,0,0);line-height:1.5;">.</span><span style="color:rgb(255,0,0);line-height:1.5;">'</span><span style="color:rgb(128,128,128);line-height:1.5;">+</span>a.typecode <span style="color:rgb(0,0,255);line-height:1.5;">as</span> orderCode,a.ProductGUID, a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">type</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span><span style="line-height:1.5;">,
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">项目合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">以前年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011年合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-01</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-02</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-03</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-04</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-05</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-06</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-07</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-08</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-09</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-10</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-11</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">2011-12</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">)),
        </span><span style="color:rgb(255,0,255);line-height:1.5;">cast</span>(a.<span style="color:rgb(255,0,0);line-height:1.5;">[</span><span style="color:rgb(255,0,0);line-height:1.5;">以后年度合计</span><span style="color:rgb(255,0,0);line-height:1.5;">]</span> <span style="color:rgb(0,0,255);line-height:1.5;">as</span> <span style="color:rgb(0,0,255);line-height:1.5;">varchar</span>(<span style="color:rgb(128,0,0);font-weight:bold;line-height:1.5;">20</span><span style="line-height:1.5;">))
    </span><span style="color:rgb(0,0,255);line-height:1.5;">from</span><span style="line-height:1.5;"> #tempSaleDtl3 a
    </span><span style="color:rgb(128,128,128);line-height:1.5;">left</span> <span style="color:rgb(128,128,128);line-height:1.5;">join</span> #product b <span style="color:rgb(0,0,255);line-height:1.5;">on</span> a.ProductGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">b.ProductGUID
    </span><span style="color:rgb(128,128,128);line-height:1.5;">left</span> <span style="color:rgb(128,128,128);line-height:1.5;">join</span> Project c <span style="color:rgb(0,0,255);line-height:1.5;">on</span> b.ProjectGUID<span style="color:rgb(128,128,128);line-height:1.5;">=</span><span style="line-height:1.5;">c.ProjectGUID
) t1
</span><span style="color:rgb(0,0,255);line-height:1.5;">order</span> <span style="color:rgb(0,0,255);line-height:1.5;">by</span><span style="line-height:1.5;"> orderCode


</span><span style="color:rgb(0,0,255);line-height:1.5;">drop</span> <span style="color:rgb(0,0,255);line-height:1.5;">table</span><span style="line-height:1.5;"> #product
</span><span style="color:rgb(0,0,255);line-height:1.5;">drop</span> <span style="color:rgb(0,0,255);line-height:1.5;">table</span><span style="line-height:1.5;"> #TempAllSaleDtl
</span><span style="color:rgb(0,0,255);line-height:1.5;">DROP</span> <span style="color:rgb(0,0,255);line-height:1.5;">TABLE</span><span style="line-height:1.5;"> #TempSaleDtl
</span><span style="color:rgb(0,0,255);line-height:1.5;">DROP</span> <span style="color:rgb(0,0,255);line-height:1.5;">TABLE</span><span style="line-height:1.5;"> #tempSaleDtl2
</span><span style="color:rgb(0,0,255);line-height:1.5;">DROP</span> <span style="color:rgb(0,0,255);line-height:1.5;">TABLE</span><span style="line-height:1.5;"> #tempSaleDtl3
</span><span style="color:rgb(0,0,255);line-height:1.5;">DROP</span> <span style="color:rgb(0,0,255);line-height:1.5;">TABLE</span> #ProductSaleArea</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p>&nbsp;　　本文转自欢醉博客园博客，原文链接http://www.cnblogs.com/zhangs1986/p/4972400.html如需转载请自行联系原作者</p> 
    <p><br></p> 
    <p>欢醉</p> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
