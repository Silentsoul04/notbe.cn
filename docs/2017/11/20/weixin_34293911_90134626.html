<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>MVC系列——MVC源码学习：打造自己的MVC框架（四：了解神奇的视图引擎） « NotBeCN</title>
  <meta name="description" content="                  阅读目录          一、自定义ActionResult      二、ContentResult和JsonResult的实现       三、解析视图引擎原理              1、视图引擎原理解析        2、自定义视图引擎              四...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/20/weixin_34293911_90134626.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">MVC系列——MVC源码学习：打造自己的MVC框架（四：了解神奇的视图引擎）</h1>
    <p class="post-meta">Nov 20, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"> 
    <p style="font-size:18px;"><b>阅读目录</b></p> 
    <ul>
     <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label0" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">一、自定义ActionResult</a></li> 
     <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label1" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">二、ContentResult和JsonResult的实现</a></li> 
     <li> <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label2" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">三、解析视图引擎原理</a> 
      <ul>
       <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label2_0" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">1、视图引擎原理解析</a></li> 
       <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label2_1" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">2、自定义视图引擎</a></li> 
      </ul></li> 
     <li> <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label3" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">四、RazorEngine实现视图引擎</a> 
      <ul>
       <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label3_0" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">1、基础用法</a></li> 
       <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label3_1" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">2、作为视图引擎的实现</a></li> 
      </ul></li> 
     <li> <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label4" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">五、NVelocity实现视图引擎</a> 
      <ul>
       <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label4_0" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">1、定义ActionResult的实现类VelocityViewResult</a></li> 
       <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label4_1" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">2、在Controller.cs里面添加“快捷方法”</a></li> 
       <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label4_2" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">3、在具体的控制器里面调用</a></li> 
       <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label4_3" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">4、新建对应的视图</a></li> 
      </ul></li> 
     <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label5" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">六、VTemplate实现视图引擎</a></li> 
     <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_label6" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">七、总结</a></li> 
    </ul>
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">&nbsp;</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;line-height:24px;font-size:18px;"><b>正文</b></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">前言：通过之前的三篇介绍，我们基本上完成了从请求发出到路由匹配、再到控制器的激活，再到Action的执行这些个过程。今天还是趁热打铁，将我们的View也来完善下，也让整个系列相对完整，博主不希望烂尾。对于这个系列，通过学习源码，博主也学到了很多东西，在此还是把博主知道的先发出来，供大家参考。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">本文原创地址：<a href="http://www.cnblogs.com/landeanfen/p/6019719.html" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">http://www.cnblogs.com/landeanfen/p/6019719.html</a></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">MVC源码学习系列文章目录：</p> 
   <ul style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">
    <li><a href="http://www.cnblogs.com/landeanfen/p/5989092.html" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">MVC系列——MVC源码学习：打造自己的MVC框架（一）</a></li> 
    <li><a href="http://www.cnblogs.com/landeanfen/p/6000978.html" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">MVC系列——MVC源码学习：打造自己的MVC框架（二：附源码）</a></li> 
    <li><a href="http://www.cnblogs.com/landeanfen/p/6016394.html" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">MVC系列——MVC源码学习：打造自己的MVC框架（三：自定义路由规则）</a></li> 
    <li><a href="http://www.cnblogs.com/landeanfen/p/6019719.html" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">MVC系列——MVC源码学习：打造自己的MVC框架（四：自定义视图）</a></li> 
   </ul>
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label0" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h1 style="font-size:25px;line-height:31px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,0);">一、自定义ActionResult</h1> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">通过前三篇的介绍，我们已经实现了Action方法的执行，但是我们执行Action方法的时候都是在方法里面直接使用Response输出结果，这样写相当不爽，并且html等文本编辑实在太不方便，于是萌生了自己去实现View的想法，这个过程并不容易，但没办法，凡事都要敢于迈出第一步。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">在MVC里面，我们最常见的写法可能是这样：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">返回视图页面</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ActionResult Index()
{
      </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> View();  
}

</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">返回请求的数据</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> JsonResult Index()
{
    </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> Json(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> {}, JsonRequestBehavior.AllowGet);
}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">将JsonResult转到定义可以看到，其实JsonResult也是继承自ActionResult这个抽象类的，这么神奇的ActioResult，究竟是个什么东西呢。我们先仿照MVC里面的也定义一个自己的ActionResult抽象类。</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">namespace</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> Swift.MVC.MyRazor
{
    </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">abstract</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">class</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ActionResult
    {
        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">abstract</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">void</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ExecuteResult(SwiftRouteData routeData);
    }
}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">这个类很简单，就是一个抽象类，下面一个抽象方法，约束实现类必须要实现这个方法，究竟这个类有什么用？且看博主怎么一步一步去实现它。</p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label1" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h1 style="font-size:25px;line-height:31px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,0);">二、ContentResult和JsonResult的实现</h1> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">查看MVC源码可知，ActionResult的实现类有很多个，博主这里就挑几个最常用的来说说。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">在MVC里面，ContentResult常用来向当前请求输出文本内容信息，JsonResult常用来返回序列化过的json对象。我们分别来实现它们：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <img class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" style="border:0px;vertical-align:middle;">&nbsp;
    <span class="cnblogs_code_collapse" style="border:1px solid #808080;line-height:1.5;">ContentResult.cs</span> 
   </div> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <img class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" style="border:0px;vertical-align:middle;">&nbsp;
    <span class="cnblogs_code_collapse" style="border:1px solid #808080;line-height:1.5;">JsonResult.cs</span> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">代码不难理解，就是定义了当前Response的返回类型和编码方式等等。接下来看看如何使用他们，为了更加接近MVC的写法，我们在Controller基类里面也定义一系列的“<strong>快捷方法</strong>”，何为“快捷方法”，就是能够快速返回某个对象的方法，比如我们在Controller.cs里面增加如下几个方法：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>        <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">protected</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">virtual</span> ContentResult Content(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> content)
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> Content(content, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">null</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">);
        }

        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">protected</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">virtual</span> ContentResult Content(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span> content, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> contentType)
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> Content(content, contentType, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">null</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">);
        }

        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">protected</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">virtual</span> ContentResult Content(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span> content, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> contentType, Encoding contentEncoding)
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ContentResult()
            {
                Content </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> content,
                ContentType </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> contentType,
                ContentEncoding </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> contentEncoding
            };
        }
</span>
        <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">protected</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">virtual</span> JsonResult Json(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">object</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> data, JsonRequestBehavior jsonBehavior)
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> JsonResult()
            {
                Data </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> data,
                JsonRequestBehavior </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> jsonBehavior
            };
        }
</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">&nbsp;我们也按照MVC里面的写法，首先我们新建一个控制器MyViewController.cs，里面新增两个方法：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">namespace</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> MyTestMVC.Controllers
{
    </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">class</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> MyViewController:Controller
    {
        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ActionResult ContentIndex()
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> Content(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">Hello</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">text/html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">, System.Text.Encoding.Default);
        }

        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ActionResult JsonIndex()
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> lstUser = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> List&lt;User&gt;<span style="font-family:'Courier New';font-size:12px;line-height:1.5;">();
            lstUser.Add(</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> User() { Id = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">1</span>, UserName = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">Admin</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Age = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">20</span>, Address = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">北京</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Remark = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">超级管理员</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> });
            lstUser.Add(</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> User() { Id = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">2</span>, UserName = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">张三</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Age = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">37</span>, Address = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">湖南</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Remark = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">呵呵</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> });
            lstUser.Add(</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> User() { Id = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">3</span>, UserName = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">王五</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Age = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">32</span>, Address = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">广西</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Remark = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">呵呵</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> });
            lstUser.Add(</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> User() { Id = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">4</span>, UserName = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">韩梅梅</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Age = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">26</span>, Address = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">上海</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Remark = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">呵呵</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> });
            lstUser.Add(</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> User() { Id = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">5</span>, UserName = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">呵呵</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Age = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">18</span>, Address = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">广东</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Remark = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">呵呵</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> });
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> Json(lstUser, JsonRequestBehavior.AllowGet);
        }
    }
}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">看到这种用法，是不是似曾相识？注意，这里的ActionResult并不是MVC里面的，而是上文我们自定义的！没错，在原生的MVC里面，这些方法也是这般定义的，因为以上封装方法本身就是参考MVC的原理来实现的。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">看着以上代码，貌似大功告成，可以直接测试运行了。是不是这样呢？总感觉少点东西呢。。。调试发现，我们的Content()方法仅仅是返回了一个ContentResult对象，并没有做其他操作啊！按照上述定义思路，貌似应该调用ContentResult对象的ExecuteResult()方法才对，因为这个方法里面才是真正的向当前的响应流里面写入返回信息。那么这个ExecuteResult()方法究竟在哪里调用呢？这里，博主这样调用了一下！在Controller.cs这个控制器的基类里面，我们修改了Execute()方法的逻辑：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">　　public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">abstract</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">class</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> Controller:ControllerBase,IDisposable
    {
        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">override</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">void</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> Execute(SwiftRouteData routeData)
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">1.得到当前控制器的类型</span>
            Type type = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">this</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">.GetType();

            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">2.从路由表中取到当前请求的action名称</span>
            <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span> actionName = routeData.RouteValue[<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">action</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">].ToString();

            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">3.从路由表中取到当前请求的Url参数</span>
            <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">object</span> parameter = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">null</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">;
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">if</span> (routeData.RouteValue.ContainsKey(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">parameters</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">))
            {
                parameter </span>= routeData.RouteValue[<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">parameters</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">];
            }
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> paramTypes = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> List&lt;Type&gt;<span style="font-family:'Courier New';font-size:12px;line-height:1.5;">();
            List</span>&lt;<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">object</span>&gt; parameters = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> List&lt;<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">object</span>&gt;<span style="font-family:'Courier New';font-size:12px;line-height:1.5;">();
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">if</span> (parameter != <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">null</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">)
            {
                </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> dicParam = (Dictionary&lt;<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span>, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span>&gt;<span style="font-family:'Courier New';font-size:12px;line-height:1.5;">)parameter;
                </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">foreach</span> (<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> pair <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">in</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> dicParam)
                {
                    parameters.Add(pair.Value);
                    paramTypes.Add(pair.Value.GetType());
                }
            }

            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">4.通过action名称和对应的参数反射对应方法。
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">这里第二个参数可以不理会action字符串的大小写，第四个参数决定了当前请求的action的重载参数类型</span>
            System.Reflection.MethodInfo mi =<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> type.GetMethod(actionName,
                BindingFlags.Public </span>| BindingFlags.Instance | BindingFlags.IgnoreCase, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">null</span>, paramTypes.ToArray(), <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">null</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">);

            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">5.执行该Action方法</span>
            <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> actionResult = mi.Invoke(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">this</span>, parameters.ToArray()) <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">as</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ActionResult;

            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">6.得到action方法的返回值，并执行具体ActionResult的ExecuteResult()方法。</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;">            actionResult.ExecuteResult(routeData);
        }
    }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">在以上步骤5里面，执行对应的Action方法之后，取到返回值，这个返回值就是一个ActionResult实现类的实例，比如上文的ContentResult和JsonResult等，然后在步骤6里面调用具体的ExecuteResult()方法。这样应该就能解决我们上述问题！我们来看测试结果：</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161107145554608-1183872778.png" alt="" style="border:0px;"></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">&nbsp;</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161107145604264-1072557290.png" alt="" style="border:0px;"></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">这样，我们这个简单的ContentResult和JsonResult就大功告成了，纵观整个过程，ContentResult和JsonResult的实现思路是相对比较简单的，可以说就是对当前响应流的输出做了一些封装而已。</p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label2" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h1 style="font-size:25px;line-height:31px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,0);">三、解析视图引擎原理</h1> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">上面实现了ContentResult和JsonResult，都是针对具体的返回值类型来定义的。除此之外，在MVC里面我们还有一个使用最多的就是和页面html打交道的ViewResult。</p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label2_0" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h2 style="font-size:15px;line-height:23px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,149);">1、视图引擎原理解析</h2> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">1.1、如果没有视图引擎，当我们希望通过一个url去请求一个页面内容的时候，我们的实现思路首先应该就是直接在后台拼Html，然后将拼好的Html交给响应流输出。上面说过，这种做法太古老，开发效率低，不易排错，并且使得前后端不能分离。这一系列的问题也反映出视图引擎的重要性。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">1.2、最简单视图引擎的原理：<strong>根据博主的理解，用户通过一个Url去请求一个页面内容的时候，我们首先定义一个静态的html页面，html里面布局和逻辑先写好，然后通过请求的url去找到这个静态的html，读取静态html里面的文本，最后将读取到的文本交由Response输出给客户端。当然，这只是一个最基础的原理，没有涉及模板以及模板语法，我们一步一步来，先将基础原理搞懂，再说其他的。</strong></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">1.3、在开始接触.net里面视图引擎之前，博主希望根据自己的理解先自定义一个视图引擎。说做咱就做，下面就着手来试试。</p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label2_1" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h2 style="font-size:15px;line-height:23px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,149);">2、自定义视图引擎</h2> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">有了上面的原理做支撑，博主就来动手自己写一个最基础的视图引擎试试了。</p> 
   <h3 style="font-size:16px;line-height:24px;font-family:'微软雅黑', PTSans, Arial, sans-serif;">2.1、首先定义一个ViewResult去实现ActionResult</h3> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">namespace</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> Swift.MVC.MyRazor
{
    </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">class</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> MyViewResult : ActionResult
    {
        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">object</span> Data { <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">get</span>; <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">set</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">; }

        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">override</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">void</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ExecuteResult(Routing.SwiftRouteData routeData)
        {
            HttpResponse response </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> HttpContext.Current.Response;

            response.ContentType </span>= <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">text/html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">;

            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">取当前view页面的物理路径</span>
            <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> path = AppDomain.CurrentDomain.BaseDirectory + <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">Views/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span> + routeData.RouteValue[<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">controller</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>] + <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span> + routeData.RouteValue[<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">action</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>] + <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">.html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">;
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> templateData = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">.Empty;
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">using</span> (<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> fsRead = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> FileStream(path, FileMode.Open))
            {
                </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">int</span> fsLen = (<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">int</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">)fsRead.Length;
                </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">byte</span>[] heByte = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">byte</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">[fsLen];
                </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">int</span> r = fsRead.Read(heByte, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">0</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">, heByte.Length);
                templateData </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> System.Text.Encoding.UTF8.GetString(heByte);
            }
            response.Write(templateData);
        }
    }
}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h3 style="font-size:16px;line-height:24px;font-family:'微软雅黑', PTSans, Arial, sans-serif;">2.2、在Controller.cs里面定义“快捷方法”</h3> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">　　　　 protected</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">virtual</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> MyViewResult View()
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> MyViewResult();
        }

        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">protected</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">virtual</span> MyViewResult View(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">object</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> data)
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> MyViewResult()
            { 
                Data </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> data 
            };
        }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">然后在MyViewController.cs里面添加Action</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;">
    <pre>        <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ActionResult ViewIndex()
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> View();
        }</span></pre>
   </div> 
   <h3 style="font-size:16px;line-height:24px;font-family:'微软雅黑', PTSans, Arial, sans-serif;">2.3、添加视图ViewIndex</h3> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161107161454795-1678960249.png" alt="" style="border:0px;"></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;!</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,255);">DOCTYPE html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">html </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);">xmlns</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="http://www.w3.org/1999/xhtml"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">head</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">meta </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);">http-equiv</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="Content-Type"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);"> content</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="text/html; charset=utf-8"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">/&gt;</span>
    <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">title</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">title</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">head</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">body</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">
    My First View
</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">body</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">测试结果：</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161107161537842-68315371.png" alt="" style="border:0px;"></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><strong>当然，这只是为了理解视图引擎的工作原理而写的一个例子，实际中的视图引擎肯定要比这个复杂得多，至少得有模板吧，然后模板语法里面还得定义后端数据映射到html里面的规则，又得定义一套模板语法规则，其工作量不亚于一个开源项目，博主觉得就没有必要再深入研究这个自定义模板了，毕竟.net里面有许多现成并且还比较好用的模板。</strong></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><strong>关于.net下面的视图模板引擎，博主接触过的主要有RazorEngine、NVelocity、VTemplate等，下面博主依次介绍下他们各自的用法。</strong></p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label3" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h1 style="font-size:25px;line-height:31px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,0);">四、RazorEngine实现视图引擎</h1> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">关于.net里面的模板引擎，RazorEngine算是相对好用的，它是基于微软的Razor之上包装而成的一个可以独立使用的模板引擎。也就是说，保留了Razor的模板功能，但是使得Razor脱离于Asp.net MVC，能够在其它应用环境下使用，换句话说，你完全可以在你的控制台程序上面使用模板语法。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><strong>RazorEngine</strong>是一个独立的开源项目，项目的地址是<a title="https://github.com/Antaris/RazorEngine" href="https://github.com/Antaris/RazorEngine" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">https://github.com/Antaris/RazorEngine</a></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">关于RazorEngine的使用以及具体的语法，园子里面也是一搜一大把，这里博主就不展开细说，只是将一些用到的方法介绍下。</p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label3_0" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h2 style="font-size:15px;line-height:23px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,149);">1、基础用法</h2> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">要使用RazorEngine，首先必须要安装组件，我们使用Nuget。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161108091704608-1029100086.png" alt="" style="border:0px;"></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">安装完成之后就可以在我们的.net程序里面调用了。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">先来看一个最简单的。</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;">
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span> template = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">姓名： @Model.Name, 年龄：@Model.Age, 学校：@Model.School</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">;
</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> result = Razor.Parse(template, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> { Name = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">小明</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Age = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">16</span>, School = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">育才高中</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span> });</pre>
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">我猜你已经知道结果了吧，你猜的没错。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161108103734764-928389159.png" alt="" style="border:0px;"></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">是不是和MVC里面的cshtml页面的使用方式非常像~~它使用@Model这种作为占位符，动态去匹配字符串里面的位置，从而得到以上结果。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">除此之外，RazorEngine还提供了引擎的方式，如下。</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;">
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span> template = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">姓名： @Model.Name, 年龄：@Model.Age, 学校：@Model.School</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">;
</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> result = Engine.Razor.RunCompile(template, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">templateKey</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">null</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">, </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> { Name = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">小明</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Age = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">16</span>, School = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">育才高中</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span> });</pre>
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">结果类似：</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161108092827811-1691644307.png" alt="" style="border:0px;"></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">博主调试发现，第一次得到result的时候有点慢，查询官方文档才知道，第一次需要记录缓存，缓存的key是该方法的第二个参数“templateKey”，当第二次加载的时候基本上就飞快了。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">博主详细了解了下RunCompile()这个方法，它是IRazorEngineService类型的一个扩展方法，这里的四个参数都有它自己的作用：第一个是匹配的字符串；第二个是缓存的Key，上文已经说过；第三个是一个Type类型，表示第四个参数的类型，如果为null，那么第四个参数就为dynamic类型；第四个参数当然就是具体的实体了。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">综合上述Razor.Parse()和Engine.Razor.RunCompile()两种方式，按照官方的解释，第一种是原来的用法，当你使用它的时候会发现它会提示方法已经过时，官方主推的是第二种方式。博主好奇心重试了下两种方式的区别，发现第一次调用的时候两者耗时基本相似，刷新页面发现，Razor.Parse()每次调用都会耗时那么久，而RunCompile()方式进行了缓存，第一次耗时稍微多点，之后每次调用时间基本可以忽略不计。或许这就是官方主推第二种方式的原因吧。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">看到这里，有的小伙伴们就开始想了，既然这个模板这么方便，那么我们定义一个html，里面就按照上述template变量那么写，然后读取html内容，再用模板匹配html内容是不是就可以实现我们的模板要求了呢？没错，思路确实是这样，我们来试一把。</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;">
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> filepath = AppDomain.CurrentDomain.BaseDirectory + <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">Views\</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span> + routeData.RouteValue[<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">controller</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>] + <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">\\</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span> + routeData.RouteValue[<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">action</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>] + <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">.html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">;
</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> fileContent = Engine.Razor.RunCompile(File.ReadAllText(filepath), <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">templateKey2</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">null</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">, </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> { Name = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">小明</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Age = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">16</span>, School = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">育才高中</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span> });</pre>
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">然后对应的html内容如下：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;!</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,255);">DOCTYPE html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">html </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);">xmlns</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="http://www.w3.org/1999/xhtml"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">head</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">meta </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);">http-equiv</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="Content-Type"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);"> content</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="text/html; charset=utf-8"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">/&gt;</span>
    <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">title</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">title</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">head</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">body</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">
    姓名： @Model.Name, 年龄：@Model.Age, 学校：@Model.School
</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">body</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">得到结果</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161108105229842-821306511.png" alt="" style="border:0px;"></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">&nbsp;就是这么简单！</p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label3_1" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h2 style="font-size:15px;line-height:23px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,149);">2、作为视图引擎的实现</h2> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">&nbsp;有了上面的一些尝试作为基础，将RazorEngine作为我们框架的视图引擎就简单了。</p> 
   <h3 style="font-size:16px;line-height:24px;font-family:'微软雅黑', PTSans, Arial, sans-serif;">2.1、先定义一个ActionResult的实现类。由于缓存的key必须唯一，这里使用filepath作为缓存的Key，第一次加载缓存，之后访问该页面就很快了。</h3> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">namespace</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> Swift.MVC.MyRazor
{
    </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">class</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> RazorEngineViewResult:ActionResult
    {
        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">object</span> Data { <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">get</span>; <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">set</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">; }

        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">override</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">void</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ExecuteResult(Routing.SwiftRouteData routeData)
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> filepath = AppDomain.CurrentDomain.BaseDirectory + <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">@"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">Views\</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span> + routeData.RouteValue[<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">controller</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>] + <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">\\</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span> + routeData.RouteValue[<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">action</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>] + <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">.html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">;
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> fileContent = Engine.Razor.RunCompile(File.ReadAllText(filepath), filepath, <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">null</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">, Data);
            HttpResponse response </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> HttpContext.Current.Response;

            response.ContentType </span>= <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">text/html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">;
            response.Write(fileContent);
            
        }</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">
    }
}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h3 style="font-size:16px;line-height:24px;font-family:'微软雅黑', PTSans, Arial, sans-serif;">2.2、在Controller.cs里面定义“快捷方法”</h3> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>        <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">protected</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">virtual</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> RazorEngineViewResult RazorEngineView()
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> RazorEngineViewResult();
        }

        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">protected</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">virtual</span> RazorEngineViewResult RazorEngineView(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">object</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> data)
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> RazorEngineViewResult()
            {
                Data </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> data
            };
        }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h3 style="font-size:16px;line-height:24px;font-family:'微软雅黑', PTSans, Arial, sans-serif;">2.3、在具体的控制器里面调用</h3> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>    <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">class</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> MyViewController:Controller
    {
       </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ActionResult ViewIndex()
        {
</span>            <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> RazorEngineView(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> { Name = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">小明</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Age = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">16</span>, School = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">育才高中</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> });
        }
    }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <h3 style="font-size:16px;line-height:24px;font-family:'微软雅黑', PTSans, Arial, sans-serif;">2.4、对应的View页面。我们还是用html代替，当然如果你想要用cshtml的文件，只需要改下上述文件路径即可。</h3> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;!</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,255);">DOCTYPE html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">html </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);">xmlns</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="http://www.w3.org/1999/xhtml"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">head</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">meta </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);">http-equiv</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="Content-Type"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);"> content</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="text/html; charset=utf-8"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">/&gt;</span>
    <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">title</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">title</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">head</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">body</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">
    姓名： @Model.Name, 年龄：@Model.Age, 学校：@Model.School
</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">body</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">得到结果</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161108110655030-676921466.png" alt="" style="border:0px;"></p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label4" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h1 style="font-size:25px;line-height:31px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,0);">五、NVelocity实现视图引擎</h1> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">关于NVelocity模板引擎，博主简单从网上down了一个Helper文件。要使用它，首先还是得安装组件</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161108112157920-1738156371.png" alt="" style="border:0px;"></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">首先给出VelocityHelper</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <img class="code_img_closed" src="https://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" style="border:0px;vertical-align:middle;">&nbsp;
    <span class="cnblogs_code_collapse" style="border:1px solid #808080;line-height:1.5;">VelocityHelper.cs</span> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">关于Velocity模板的语法，也没啥好说的，直接在项目里面将他们搭起来试试。</p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label4_0" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h2 style="font-size:15px;line-height:23px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,149);">1、定义ActionResult的实现类VelocityViewResult</h2> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>    <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">class</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> VelocityViewResult:ActionResult
    {
        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">object</span> Data { <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">get</span>; <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">set</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">; }
        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">override</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">void</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ExecuteResult(Routing.SwiftRouteData routeData)
        {
　　　　　　  </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">这里必须是虚拟路径</span>
            <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">var</span> velocity = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> VelocityHelper(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span>.Format(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">~/Views/{0}/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, routeData.RouteValue[<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">controller</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">]));
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);"> 绑定实体model</span>
            velocity.Put(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">model</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">, Data);
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);">//</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,128,0);"> 显示具体html</span>
            HttpResponse response =<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> HttpContext.Current.Response;
            response.ContentType </span>= <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">text/html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">;
            velocity.Display(</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">string</span>.Format(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">{0}.cshtml</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, routeData.RouteValue[<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">action</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;">].ToString()));
        }
    }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label4_1" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h2 style="font-size:15px;line-height:23px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,149);">2、在Controller.cs里面添加“快捷方法”</h2> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>        <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">protected</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">virtual</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> VelocityViewResult VelocityView()
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> VelocityViewResult();
        }

        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">protected</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">virtual</span> VelocityViewResult VelocityView(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">object</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> data)
        {
            </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> VelocityViewResult()
            {
                Data </span>=<span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> data
            };
        }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label4_2" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h2 style="font-size:15px;line-height:23px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,149);">3、在具体的控制器里面调用</h2> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>    <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">class</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> MyViewController:Controller
    {       
        </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">public</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> ActionResult ViewIndex()
        {
</span>            <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">return</span> VelocityView(<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">new</span> { Name = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">小明</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span>, Age = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,128);">16</span>, School = <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">育才高中</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;"> });
        }
    }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label4_3" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h2 style="font-size:15px;line-height:23px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,149);">4、新建对应的视图</h2> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">上面我们在测试RazorEngine引擎的时候，使用的是html代替，这里我们改用cshtml后缀的模板文件<strong>ViewIndex.cshtml</strong></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);line-height:24px;font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;!</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,255);">DOCTYPE html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">head</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
    <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">meta </span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);">name</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="viewport"</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(255,0,0);"> content</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">="width=device-width"</span> <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">/&gt;</span>
    <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">title</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">title</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">head</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">body</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
    <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">div</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
        <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">h1</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>姓名： $model.Name<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">h1</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
        <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">h1</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>年龄：$model.Age<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">h1</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
        <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">h1</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>学校：$model.School<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">h1</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
    <span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">div</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">body</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span>
<span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&lt;/</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(128,0,0);">html</span><span style="font-family:'Courier New';font-size:12px;line-height:1.5;color:rgb(0,0,255);">&gt;</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(39,105,192);border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">这里就是和RazorEngine不一样的地方，不过很好理解，原来的@Model这里用$model代替了而已。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">测试结果</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><img src="https://images2015.cnblogs.com/blog/459756/201611/459756-20161108114700295-1663655848.png" alt="" style="border:0px;"></p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label5" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h1 style="font-size:25px;line-height:31px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,0);">六、VTemplate实现视图引擎</h1> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">VTemplate模板引擎简称VT，好几年前就听说过这么一个东西，但一直没研究它的语法，感觉写起来太麻烦，详情可以看看&nbsp;<a href="http://www.cnblogs.com/kingthy/archive/2009/08/17/net-vtemplate.html" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">这里</a>。这里也不想展开说明了，因为觉得原理通了，实现起来就是模板语法的不同了，大家如果有兴趣可以自己去实现一套VT版本的视图引擎。</p> 
   <div style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;text-align:right;"> 
    <a href="http://www.cnblogs.com/landeanfen/p/6019719.html#_labelTop" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">回到顶部</a>
    <a name="_label6" style="color:rgb(39,105,192);"></a> 
   </div> 
   <h1 style="font-size:25px;line-height:31px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;background:rgb(43,102,0);">七、总结</h1> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;">总结，又到了写总结的时间了，好紧张~~这一篇主要解析了下MVC里面View的原理以及使用模板引擎的实现，至此，我们自己的MVC基本功能都已经有了，此系列暂时告一段落吧。还是给出源码地址：<a href="https://github.com/landeanfen2/Swift.MVC" rel="nofollow" style="color:rgb(39,105,192);text-decoration:none;">源码下载</a>。</p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><strong>此系列文章，花了很多时间整理，但是也收到很多园友的打赏，在此感谢大家对博主的支持和厚爱。后续博主一定继续努力，将更好的干货带给大家！</strong></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><strong><br></strong></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><strong><br></strong></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><strong><br></strong></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><strong><br></strong></p> 
   <p style="font-family:'微软雅黑', PTSans, Arial, sans-serif;font-size:16px;line-height:24px;"><strong><br></strong></p> 
   <p><strong><font><span style="line-height:24px;">本文转自懒得安分博客园博客，原文链接：http://www.cnblogs.com/landeanfen/p/6019719.html，如需转载请自行联系原作者</span></font><br></strong></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
