<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Hadoop MapReduce编程 API入门系列之多个Job迭代式MapReduce运行（十二） « NotBeCN</title>
  <meta name="description" content="                                 &nbsp;               　　执行     2016-12-12 15:07:51,762 INFO [org.apache.hadoop.metrics.jvm.JvmMetrics] - Initializing JVM Met...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/20/weixin_33694620_90121003.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Hadoop MapReduce编程 API入门系列之多个Job迭代式MapReduce运行（十二）</h1>
    <p class="post-meta">Nov 20, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div class="blogpost-body"> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150621604-2023801062.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151422401-1775851816.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150551292-142724028.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;<img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150639042-107277210.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150649761-787183742.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150738323-1208428315.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　执行</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">2016-12-12 15:07:51,762 INFO [org.apache.hadoop.metrics.jvm.JvmMetrics] - Initializing JVM Metrics with processName=JobTracker, sessionId=<br> 2016-12-12 15:07:52,197 WARN [org.apache.hadoop.mapreduce.JobSubmitter] - Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.<br> 2016-12-12 15:07:52,199 WARN [org.apache.hadoop.mapreduce.JobSubmitter] - No job jar file set. User classes may not be found. See Job or Job#setJar(String).<br> 2016-12-12 15:07:52,216 INFO [org.apache.hadoop.mapreduce.lib.input.FileInputFormat] - Total input paths to process : 1<br> 2016-12-12 15:07:52,265 INFO [org.apache.hadoop.mapreduce.JobSubmitter] - number of splits:1<br> 2016-12-12 15:07:52,541 INFO [org.apache.hadoop.mapreduce.JobSubmitter] - Submitting tokens for job: job_local1414008937_0001<br> 2016-12-12 15:07:53,106 INFO [org.apache.hadoop.mapreduce.Job] - The url to track the job: http://localhost:8080/<br> 2016-12-12 15:07:53,107 INFO [org.apache.hadoop.mapreduce.Job] - Running job: job_local1414008937_0001<br> 2016-12-12 15:07:53,114 INFO [org.apache.hadoop.mapred.LocalJobRunner] - OutputCommitter set in config null<br> 2016-12-12 15:07:53,128 INFO [org.apache.hadoop.mapred.LocalJobRunner] - OutputCommitter is org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter<br> 2016-12-12 15:07:53,203 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Waiting for map tasks<br> 2016-12-12 15:07:53,216 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local1414008937_0001_m_000000_0<br> 2016-12-12 15:07:53,271 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:07:53,374 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@65f3724c<br> 2016-12-12 15:07:53,382 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/data/Weibodata.txt:0+174116<br> 2016-12-12 15:07:53,443 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 15:07:53,443 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 15:07:53,443 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 15:07:53,444 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 15:07:53,444 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 15:07:53,450 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> 2016-12-12 15:07:54,110 INFO [org.apache.hadoop.mapreduce.Job] - Job job_local1414008937_0001 running in uber mode : false<br> 2016-12-12 15:07:54,112 INFO [org.apache.hadoop.mapreduce.Job] - map 0% reduce 0%<br> 2016-12-12 15:07:55,068 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 15:07:55,068 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 15:07:55,068 INFO [org.apache.hadoop.mapred.MapTask] - Spilling map output<br> 2016-12-12 15:07:55,068 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufend = 747379; bufvoid = 104857600<br> 2016-12-12 15:07:55,068 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396(104857584); kvend = 26101152(104404608); length = 113245/6553600<br> count___________1065<br> 2016-12-12 15:07:55,674 INFO [org.apache.hadoop.mapred.MapTask] - Finished spill 0<br> 2016-12-12 15:07:55,685 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local1414008937_0001_m_000000_0 is done. And is in the process of committing<br> 2016-12-12 15:07:55,706 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map<br> 2016-12-12 15:07:55,706 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local1414008937_0001_m_000000_0' done.<br> 2016-12-12 15:07:55,706 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local1414008937_0001_m_000000_0<br> 2016-12-12 15:07:55,707 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map task executor complete.<br> 2016-12-12 15:07:55,714 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Waiting for reduce tasks<br> 2016-12-12 15:07:55,714 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local1414008937_0001_r_000000_0<br> 2016-12-12 15:07:55,727 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:07:55,754 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@24a11405<br> 2016-12-12 15:07:55,758 INFO [org.apache.hadoop.mapred.ReduceTask] - Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@12efdb85<br> 2016-12-12 15:07:55,776 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - MergerManager: memoryLimit=1327077760, maxSingleShuffleLimit=331769440, mergeThreshold=875871360, ioSortFactor=10, memToMemMergeOutputsThreshold=10<br> 2016-12-12 15:07:55,778 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - attempt_local1414008937_0001_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events<br> 2016-12-12 15:07:55,810 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#1 about to shuffle output of map attempt_local1414008937_0001_m_000000_0 decomp: 222260 len: 222264 to MEMORY<br> 2016-12-12 15:07:55,818 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 222260 bytes from map-output for attempt_local1414008937_0001_m_000000_0<br> 2016-12-12 15:07:55,863 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 222260, inMemoryMapOutputs.size() -&gt; 1, commitMemory -&gt; 0, usedMemory -&gt;222260<br> 2016-12-12 15:07:55,865 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - EventFetcher is interrupted.. Returning<br> 2016-12-12 15:07:55,866 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:55,867 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs<br> 2016-12-12 15:07:55,876 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 15:07:55,876 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 222236 bytes<br> 2016-12-12 15:07:55,952 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merged 1 segments, 222260 bytes to disk to satisfy reduce memory limit<br> 2016-12-12 15:07:55,953 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 1 files, 222264 bytes from disk<br> 2016-12-12 15:07:55,954 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 0 segments, 0 bytes from memory into reduce<br> 2016-12-12 15:07:55,955 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 15:07:55,987 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 222236 bytes<br> 2016-12-12 15:07:55,989 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:55,994 INFO [org.apache.hadoop.conf.Configuration.deprecation] - mapred.skip.on is deprecated. Instead, use mapreduce.job.skiprecords<br> 2016-12-12 15:07:56,124 INFO [org.apache.hadoop.mapreduce.Job] - map 100% reduce 0%<br> 2016-12-12 15:07:56,347 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local1414008937_0001_r_000000_0 is done. And is in the process of committing<br> 2016-12-12 15:07:56,349 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:56,349 INFO [org.apache.hadoop.mapred.Task] - Task attempt_local1414008937_0001_r_000000_0 is allowed to commit now<br> 2016-12-12 15:07:56,357 INFO [org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter] - Saved output of task 'attempt_local1414008937_0001_r_000000_0' to file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/_temporary/0/task_local1414008937_0001_r_000000<br> 2016-12-12 15:07:56,358 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce &gt; reduce<br> 2016-12-12 15:07:56,359 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local1414008937_0001_r_000000_0' done.<br> 2016-12-12 15:07:56,359 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local1414008937_0001_r_000000_0<br> 2016-12-12 15:07:56,359 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local1414008937_0001_r_000001_0<br> 2016-12-12 15:07:56,365 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:07:56,391 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@464d02ee<br> 2016-12-12 15:07:56,392 INFO [org.apache.hadoop.mapred.ReduceTask] - Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@69fb7b50<br> 2016-12-12 15:07:56,394 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - MergerManager: memoryLimit=1327077760, maxSingleShuffleLimit=331769440, mergeThreshold=875871360, ioSortFactor=10, memToMemMergeOutputsThreshold=10<br> 2016-12-12 15:07:56,395 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - attempt_local1414008937_0001_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events<br> 2016-12-12 15:07:56,399 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#2 about to shuffle output of map attempt_local1414008937_0001_m_000000_0 decomp: 226847 len: 226851 to MEMORY<br> 2016-12-12 15:07:56,401 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 226847 bytes from map-output for attempt_local1414008937_0001_m_000000_0<br> 2016-12-12 15:07:56,401 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 226847, inMemoryMapOutputs.size() -&gt; 1, commitMemory -&gt; 0, usedMemory -&gt;226847<br> 2016-12-12 15:07:56,402 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - EventFetcher is interrupted.. Returning<br> 2016-12-12 15:07:56,402 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:56,402 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs<br> 2016-12-12 15:07:56,407 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 15:07:56,407 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 226820 bytes<br> 2016-12-12 15:07:56,488 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merged 1 segments, 226847 bytes to disk to satisfy reduce memory limit<br> 2016-12-12 15:07:56,488 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 1 files, 226851 bytes from disk<br> 2016-12-12 15:07:56,489 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 0 segments, 0 bytes from memory into reduce<br> 2016-12-12 15:07:56,489 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 15:07:56,490 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 226820 bytes<br> 2016-12-12 15:07:56,491 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:56,581 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local1414008937_0001_r_000001_0 is done. And is in the process of committing<br> 2016-12-12 15:07:56,584 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:56,584 INFO [org.apache.hadoop.mapred.Task] - Task attempt_local1414008937_0001_r_000001_0 is allowed to commit now<br> 2016-12-12 15:07:56,591 INFO [org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter] - Saved output of task 'attempt_local1414008937_0001_r_000001_0' to file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/_temporary/0/task_local1414008937_0001_r_000001<br> 2016-12-12 15:07:56,593 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce &gt; reduce<br> 2016-12-12 15:07:56,593 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local1414008937_0001_r_000001_0' done.<br> 2016-12-12 15:07:56,593 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local1414008937_0001_r_000001_0<br> 2016-12-12 15:07:56,593 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local1414008937_0001_r_000002_0<br> 2016-12-12 15:07:56,596 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:07:56,640 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@36d0c62b<br> 2016-12-12 15:07:56,640 INFO [org.apache.hadoop.mapred.ReduceTask] - Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@44824d2a<br> 2016-12-12 15:07:56,641 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - MergerManager: memoryLimit=1327077760, maxSingleShuffleLimit=331769440, mergeThreshold=875871360, ioSortFactor=10, memToMemMergeOutputsThreshold=10<br> 2016-12-12 15:07:56,643 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - attempt_local1414008937_0001_r_000002_0 Thread started: EventFetcher for fetching Map Completion Events<br> 2016-12-12 15:07:56,648 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#3 about to shuffle output of map attempt_local1414008937_0001_m_000000_0 decomp: 224215 len: 224219 to MEMORY<br> 2016-12-12 15:07:56,650 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 224215 bytes from map-output for attempt_local1414008937_0001_m_000000_0<br> 2016-12-12 15:07:56,650 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 224215, inMemoryMapOutputs.size() -&gt; 1, commitMemory -&gt; 0, usedMemory -&gt;224215<br> 2016-12-12 15:07:56,651 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - EventFetcher is interrupted.. Returning<br> 2016-12-12 15:07:56,651 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:56,652 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs<br> 2016-12-12 15:07:56,658 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 15:07:56,658 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 224191 bytes<br> 2016-12-12 15:07:56,675 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merged 1 segments, 224215 bytes to disk to satisfy reduce memory limit<br> 2016-12-12 15:07:56,676 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 1 files, 224219 bytes from disk<br> 2016-12-12 15:07:56,676 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 0 segments, 0 bytes from memory into reduce<br> 2016-12-12 15:07:56,676 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 15:07:56,677 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 224191 bytes<br> 2016-12-12 15:07:56,678 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:56,711 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local1414008937_0001_r_000002_0 is done. And is in the process of committing<br> 2016-12-12 15:07:56,714 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:56,714 INFO [org.apache.hadoop.mapred.Task] - Task attempt_local1414008937_0001_r_000002_0 is allowed to commit now<br> 2016-12-12 15:07:56,725 INFO [org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter] - Saved output of task 'attempt_local1414008937_0001_r_000002_0' to file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/_temporary/0/task_local1414008937_0001_r_000002<br> 2016-12-12 15:07:56,726 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce &gt; reduce<br> 2016-12-12 15:07:56,727 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local1414008937_0001_r_000002_0' done.<br> 2016-12-12 15:07:56,727 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local1414008937_0001_r_000002_0<br> 2016-12-12 15:07:56,727 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local1414008937_0001_r_000003_0<br> 2016-12-12 15:07:56,729 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:07:56,749 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@42ed705f<br> 2016-12-12 15:07:56,750 INFO [org.apache.hadoop.mapred.ReduceTask] - Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@726c8f4c<br> 2016-12-12 15:07:56,751 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - MergerManager: memoryLimit=1327077760, maxSingleShuffleLimit=331769440, mergeThreshold=875871360, ioSortFactor=10, memToMemMergeOutputsThreshold=10<br> 2016-12-12 15:07:56,752 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - attempt_local1414008937_0001_r_000003_0 Thread started: EventFetcher for fetching Map Completion Events<br> 2016-12-12 15:07:56,757 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#4 about to shuffle output of map attempt_local1414008937_0001_m_000000_0 decomp: 14 len: 18 to MEMORY<br> 2016-12-12 15:07:56,758 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 14 bytes from map-output for attempt_local1414008937_0001_m_000000_0<br> 2016-12-12 15:07:56,758 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 14, inMemoryMapOutputs.size() -&gt; 1, commitMemory -&gt; 0, usedMemory -&gt;14<br> 2016-12-12 15:07:56,759 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - EventFetcher is interrupted.. Returning<br> 2016-12-12 15:07:56,759 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:56,759 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs<br> 2016-12-12 15:07:56,764 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 15:07:56,764 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 6 bytes<br> 2016-12-12 15:07:56,765 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merged 1 segments, 14 bytes to disk to satisfy reduce memory limit<br> 2016-12-12 15:07:56,765 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 1 files, 18 bytes from disk<br> 2016-12-12 15:07:56,765 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 0 segments, 0 bytes from memory into reduce<br> 2016-12-12 15:07:56,765 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 15:07:56,766 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 6 bytes<br> 2016-12-12 15:07:56,766 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> count___________1065<br> 2016-12-12 15:07:56,770 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local1414008937_0001_r_000003_0 is done. And is in the process of committing<br> 2016-12-12 15:07:56,771 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 15:07:56,771 INFO [org.apache.hadoop.mapred.Task] - Task attempt_local1414008937_0001_r_000003_0 is allowed to commit now<br> 2016-12-12 15:07:56,777 INFO [org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter] - Saved output of task 'attempt_local1414008937_0001_r_000003_0' to file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/_temporary/0/task_local1414008937_0001_r_000003<br> 2016-12-12 15:07:56,778 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce &gt; reduce<br> 2016-12-12 15:07:56,778 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local1414008937_0001_r_000003_0' done.<br> 2016-12-12 15:07:56,778 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local1414008937_0001_r_000003_0<br> 2016-12-12 15:07:56,779 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce task executor complete.<br> 2016-12-12 15:07:57,127 INFO [org.apache.hadoop.mapreduce.Job] - map 100% reduce 100%<br> 2016-12-12 15:07:57,137 INFO [org.apache.hadoop.mapreduce.Job] - Job job_local1414008937_0001 completed successfully<br> 2016-12-12 15:07:57,186 INFO [org.apache.hadoop.mapreduce.Job] - Counters: 33<br> File System Counters<br> FILE: Number of bytes read=4937350<br> FILE: Number of bytes written=8113860<br> FILE: Number of read operations=0<br> FILE: Number of large read operations=0<br> FILE: Number of write operations=0<br> Map-Reduce Framework<br> Map input records=1065<br> Map output records=28312<br> Map output bytes=747379<br> Map output materialized bytes=673352<br> Input split bytes=127<br> Combine input records=28312<br> Combine output records=23098<br> Reduce input groups=23098<br> Reduce shuffle bytes=673352<br> Reduce input records=23098<br> Reduce output records=23098<br> Spilled Records=46196<br> Shuffled Maps =4<br> Failed Shuffles=0<br> Merged Map outputs=4<br> GC time elapsed (ms)=165<br> CPU time spent (ms)=0<br> Physical memory (bytes) snapshot=0<br> Virtual memory (bytes) snapshot=0<br> Total committed heap usage (bytes)=1672478720<br> Shuffle Errors<br> BAD_ID=0<br> CONNECTION=0<br> IO_ERROR=0<br> WRONG_LENGTH=0<br> WRONG_MAP=0<br> WRONG_REDUCE=0<br> File Input Format Counters&nbsp;<br> Bytes Read=174116<br> File Output Format Counters&nbsp;<br> Bytes Written=585532</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;<img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150839964-1833398247.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150903636-1927725139.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150912058-766699261.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150925011-1358092634.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150933745-1207764529.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212150953073-2111736387.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151003292-1990650228.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151015776-1327000167.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　执行</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">2016-12-12 15:10:36,011 INFO [org.apache.hadoop.metrics.jvm.JvmMetrics] - Initializing JVM Metrics with processName=JobTracker, sessionId=<br> 2016-12-12 15:10:36,436 WARN [org.apache.hadoop.mapreduce.JobSubmitter] - Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.<br> 2016-12-12 15:10:36,438 WARN [org.apache.hadoop.mapreduce.JobSubmitter] - No job jar file set. User classes may not be found. See Job or Job#setJar(String).<br> 2016-12-12 15:10:36,892 INFO [org.apache.hadoop.mapreduce.lib.input.FileInputFormat] - Total input paths to process : 4<br> 2016-12-12 15:10:36,959 INFO [org.apache.hadoop.mapreduce.JobSubmitter] - number of splits:4<br> 2016-12-12 15:10:37,215 INFO [org.apache.hadoop.mapreduce.JobSubmitter] - Submitting tokens for job: job_local564512176_0001<br> 2016-12-12 15:10:37,668 INFO [org.apache.hadoop.mapreduce.Job] - The url to track the job: http://localhost:8080/<br> 2016-12-12 15:10:37,670 INFO [org.apache.hadoop.mapreduce.Job] - Running job: job_local564512176_0001<br> 2016-12-12 15:10:37,672 INFO [org.apache.hadoop.mapred.LocalJobRunner] - OutputCommitter set in config null<br> 2016-12-12 15:10:37,685 INFO [org.apache.hadoop.mapred.LocalJobRunner] - OutputCommitter is org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter<br> 2016-12-12 15:10:37,757 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Waiting for map tasks<br> 2016-12-12 15:10:37,759 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local564512176_0001_m_000000_0<br> 2016-12-12 15:10:37,822 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:10:37,854 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@12633e10<br> 2016-12-12 15:10:37,861 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/part-r-00001:0+195718<br> 2016-12-12 15:10:37,924 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 15:10:37,924 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 15:10:37,925 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 15:10:37,925 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 15:10:37,925 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 15:10:37,932 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> 2016-12-12 15:10:38,401 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 15:10:38,402 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 15:10:38,402 INFO [org.apache.hadoop.mapred.MapTask] - Spilling map output<br> 2016-12-12 15:10:38,402 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufend = 78968; bufvoid = 104857600<br> 2016-12-12 15:10:38,402 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396(104857584); kvend = 26183268(104733072); length = 31129/6553600<br> 2016-12-12 15:10:38,673 INFO [org.apache.hadoop.mapreduce.Job] - Job job_local564512176_0001 running in uber mode : false<br> 2016-12-12 15:10:38,676 INFO [org.apache.hadoop.mapreduce.Job] - map 0% reduce 0%<br> 2016-12-12 15:10:38,724 INFO [org.apache.hadoop.mapred.MapTask] - Finished spill 0<br> 2016-12-12 15:10:38,730 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local564512176_0001_m_000000_0 is done. And is in the process of committing<br> 2016-12-12 15:10:38,744 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map<br> 2016-12-12 15:10:38,744 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local564512176_0001_m_000000_0' done.<br> 2016-12-12 15:10:38,745 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local564512176_0001_m_000000_0<br> 2016-12-12 15:10:38,745 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local564512176_0001_m_000001_0<br> 2016-12-12 15:10:38,748 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:10:38,778 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@43aa735f<br> 2016-12-12 15:10:38,784 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/part-r-00002:0+193443<br> 2016-12-12 15:10:38,820 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 15:10:38,820 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 15:10:38,820 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 15:10:38,821 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 15:10:38,821 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 15:10:38,822 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> 2016-12-12 15:10:39,017 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 15:10:39,017 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 15:10:39,018 INFO [org.apache.hadoop.mapred.MapTask] - Spilling map output<br> 2016-12-12 15:10:39,018 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufend = 78027; bufvoid = 104857600<br> 2016-12-12 15:10:39,018 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396(104857584); kvend = 26183624(104734496); length = 30773/6553600<br> 2016-12-12 15:10:39,157 INFO [org.apache.hadoop.mapred.MapTask] - Finished spill 0<br> 2016-12-12 15:10:39,162 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local564512176_0001_m_000001_0 is done. And is in the process of committing<br> 2016-12-12 15:10:39,166 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map<br> 2016-12-12 15:10:39,166 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local564512176_0001_m_000001_0' done.<br> 2016-12-12 15:10:39,166 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local564512176_0001_m_000001_0<br> 2016-12-12 15:10:39,167 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local564512176_0001_m_000002_0<br> 2016-12-12 15:10:39,171 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:10:39,219 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@405f4f03<br> 2016-12-12 15:10:39,222 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/part-r-00000:0+191780<br> 2016-12-12 15:10:39,265 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 15:10:39,265 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 15:10:39,265 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 15:10:39,265 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 15:10:39,265 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 15:10:39,270 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> 2016-12-12 15:10:39,311 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 15:10:39,311 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 15:10:39,311 INFO [org.apache.hadoop.mapred.MapTask] - Spilling map output<br> 2016-12-12 15:10:39,311 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufend = 77478; bufvoid = 104857600<br> 2016-12-12 15:10:39,312 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396(104857584); kvend = 26183920(104735680); length = 30477/6553600<br> 2016-12-12 15:10:39,360 INFO [org.apache.hadoop.mapred.MapTask] - Finished spill 0<br> 2016-12-12 15:10:39,365 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local564512176_0001_m_000002_0 is done. And is in the process of committing<br> 2016-12-12 15:10:39,368 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map<br> 2016-12-12 15:10:39,369 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local564512176_0001_m_000002_0' done.<br> 2016-12-12 15:10:39,369 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local564512176_0001_m_000002_0<br> 2016-12-12 15:10:39,369 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local564512176_0001_m_000003_0<br> 2016-12-12 15:10:39,372 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:10:39,416 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@4e5497cb<br> 2016-12-12 15:10:39,419 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/part-r-00003:0+11<br> 2016-12-12 15:10:39,461 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 15:10:39,461 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 15:10:39,461 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 15:10:39,461 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 15:10:39,462 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 15:10:39,463 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> 2016-12-12 15:10:39,466 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 15:10:39,466 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 15:10:39,479 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local564512176_0001_m_000003_0 is done. And is in the process of committing<br> 2016-12-12 15:10:39,482 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map<br> 2016-12-12 15:10:39,482 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local564512176_0001_m_000003_0' done.<br> 2016-12-12 15:10:39,482 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local564512176_0001_m_000003_0<br> 2016-12-12 15:10:39,482 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map task executor complete.<br> 2016-12-12 15:10:39,487 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Waiting for reduce tasks<br> 2016-12-12 15:10:39,488 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local564512176_0001_r_000000_0<br> 2016-12-12 15:10:39,497 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:10:39,519 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@6d565f45<br> 2016-12-12 15:10:39,523 INFO [org.apache.hadoop.mapred.ReduceTask] - Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@1f719a8d<br> 2016-12-12 15:10:39,538 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - MergerManager: memoryLimit=1327077760, maxSingleShuffleLimit=331769440, mergeThreshold=875871360, ioSortFactor=10, memToMemMergeOutputsThreshold=10<br> 2016-12-12 15:10:39,541 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - attempt_local564512176_0001_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events<br> 2016-12-12 15:10:39,583 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#1 about to shuffle output of map attempt_local564512176_0001_m_000002_0 decomp: 37768 len: 37772 to MEMORY<br> 2016-12-12 15:10:39,589 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 37768 bytes from map-output for attempt_local564512176_0001_m_000002_0<br> 2016-12-12 15:10:39,638 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 37768, inMemoryMapOutputs.size() -&gt; 1, commitMemory -&gt; 0, usedMemory -&gt;37768<br> 2016-12-12 15:10:39,644 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#1 about to shuffle output of map attempt_local564512176_0001_m_000001_0 decomp: 37233 len: 37237 to MEMORY<br> 2016-12-12 15:10:39,646 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 37233 bytes from map-output for attempt_local564512176_0001_m_000001_0<br> 2016-12-12 15:10:39,647 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 37233, inMemoryMapOutputs.size() -&gt; 2, commitMemory -&gt; 37768, usedMemory -&gt;75001<br> 2016-12-12 15:10:39,652 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#1 about to shuffle output of map attempt_local564512176_0001_m_000000_0 decomp: 37343 len: 37347 to MEMORY<br> 2016-12-12 15:10:39,653 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 37343 bytes from map-output for attempt_local564512176_0001_m_000000_0<br> 2016-12-12 15:10:39,654 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 37343, inMemoryMapOutputs.size() -&gt; 3, commitMemory -&gt; 75001, usedMemory -&gt;112344<br> 2016-12-12 15:10:39,658 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#1 about to shuffle output of map attempt_local564512176_0001_m_000003_0 decomp: 2 len: 6 to MEMORY<br> 2016-12-12 15:10:39,659 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 2 bytes from map-output for attempt_local564512176_0001_m_000003_0<br> 2016-12-12 15:10:39,660 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 2, inMemoryMapOutputs.size() -&gt; 4, commitMemory -&gt; 112344, usedMemory -&gt;112346<br> 2016-12-12 15:10:39,660 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - EventFetcher is interrupted.. Returning<br> 2016-12-12 15:10:39,661 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 4 / 4 copied.<br> 2016-12-12 15:10:39,662 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - finalMerge called with 4 in-memory map-outputs and 0 on-disk map-outputs<br> 2016-12-12 15:10:39,673 INFO [org.apache.hadoop.mapred.Merger] - Merging 4 sorted segments<br> 2016-12-12 15:10:39,674 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 3 segments left of total size: 112332 bytes<br> 2016-12-12 15:10:39,678 INFO [org.apache.hadoop.mapreduce.Job] - map 100% reduce 0%<br> 2016-12-12 15:10:39,780 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merged 4 segments, 112346 bytes to disk to satisfy reduce memory limit<br> 2016-12-12 15:10:39,781 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 1 files, 112344 bytes from disk<br> 2016-12-12 15:10:39,783 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 0 segments, 0 bytes from memory into reduce<br> 2016-12-12 15:10:39,784 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 15:10:39,785 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 112336 bytes<br> 2016-12-12 15:10:39,785 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 4 / 4 copied.<br> 2016-12-12 15:10:39,792 INFO [org.apache.hadoop.conf.Configuration.deprecation] - mapred.skip.on is deprecated. Instead, use mapreduce.job.skiprecords<br> 2016-12-12 15:10:40,343 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local564512176_0001_r_000000_0 is done. And is in the process of committing<br> 2016-12-12 15:10:40,346 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 4 / 4 copied.<br> 2016-12-12 15:10:40,346 INFO [org.apache.hadoop.mapred.Task] - Task attempt_local564512176_0001_r_000000_0 is allowed to commit now<br> 2016-12-12 15:10:40,353 INFO [org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter] - Saved output of task 'attempt_local564512176_0001_r_000000_0' to file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo2/_temporary/0/task_local564512176_0001_r_000000<br> 2016-12-12 15:10:40,363 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce &gt; reduce<br> 2016-12-12 15:10:40,364 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local564512176_0001_r_000000_0' done.<br> 2016-12-12 15:10:40,364 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local564512176_0001_r_000000_0<br> 2016-12-12 15:10:40,364 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce task executor complete.<br> 2016-12-12 15:10:40,678 INFO [org.apache.hadoop.mapreduce.Job] - map 100% reduce 100%<br> 2016-12-12 15:10:40,678 INFO [org.apache.hadoop.mapreduce.Job] - Job job_local564512176_0001 completed successfully<br> 2016-12-12 15:10:40,701 INFO [org.apache.hadoop.mapreduce.Job] - Counters: 33<br> File System Counters<br> FILE: Number of bytes read=2579152<br> FILE: Number of bytes written=1581170<br> FILE: Number of read operations=0<br> FILE: Number of large read operations=0<br> FILE: Number of write operations=0<br> Map-Reduce Framework<br> Map input records=23098<br> Map output records=23097<br> Map output bytes=234473<br> Map output materialized bytes=112362<br> Input split bytes=528<br> Combine input records=23097<br> Combine output records=8774<br> Reduce input groups=5567<br> Reduce shuffle bytes=112362<br> Reduce input records=8774<br> Reduce output records=5567<br> Spilled Records=17548<br> Shuffled Maps =4<br> Failed Shuffles=0<br> Merged Map outputs=4<br> GC time elapsed (ms)=48<br> CPU time spent (ms)=0<br> Physical memory (bytes) snapshot=0<br> Virtual memory (bytes) snapshot=0<br> Total committed heap usage (bytes)=2114977792<br> Shuffle Errors<br> BAD_ID=0<br> CONNECTION=0<br> IO_ERROR=0<br> WRONG_LENGTH=0<br> WRONG_MAP=0<br> WRONG_REDUCE=0<br> File Input Format Counters&nbsp;<br> Bytes Read=585564<br> File Output Format Counters&nbsp;<br> Bytes Written=50762<br> 执行job成功</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151104401-1997470661.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151114370-2126103552.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151137011-2067134145.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151147089-1480518275.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151207792-633574231.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;　　执行</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">2016-12-12 15:12:33,225 INFO [org.apache.hadoop.metrics.jvm.JvmMetrics] - Initializing JVM Metrics with processName=JobTracker, sessionId=<br> 2016-12-12 15:12:33,823 WARN [org.apache.hadoop.mapreduce.JobSubmitter] - Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.<br> 2016-12-12 15:12:33,824 WARN [org.apache.hadoop.mapreduce.JobSubmitter] - No job jar file set. User classes may not be found. See Job or Job#setJar(String).<br> 2016-12-12 15:12:34,364 INFO [org.apache.hadoop.mapreduce.lib.input.FileInputFormat] - Total input paths to process : 4<br> 2016-12-12 15:12:34,410 INFO [org.apache.hadoop.mapreduce.JobSubmitter] - number of splits:4<br> 2016-12-12 15:12:34,729 INFO [org.apache.hadoop.mapreduce.JobSubmitter] - Submitting tokens for job: job_local671371338_0001<br> 2016-12-12 15:12:35,471 INFO [org.apache.hadoop.mapred.LocalDistributedCacheManager] - Creating symlink: \tmp\hadoop-Administrator\mapred\local\1481526755080\part-r-00003 &lt;- D:\Code\MyEclipseJavaCode\myMapReduce/part-r-00003<br> 2016-12-12 15:12:35,516 INFO [org.apache.hadoop.mapred.LocalDistributedCacheManager] - Localized file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/part-r-00003 as file:/tmp/hadoop-Administrator/mapred/local/1481526755080/part-r-00003<br> 2016-12-12 15:12:35,521 INFO [org.apache.hadoop.mapred.LocalDistributedCacheManager] - Creating symlink: \tmp\hadoop-Administrator\mapred\local\1481526755081\part-r-00000 &lt;- D:\Code\MyEclipseJavaCode\myMapReduce/part-r-00000<br> 2016-12-12 15:12:35,544 INFO [org.apache.hadoop.mapred.LocalDistributedCacheManager] - Localized file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo2/part-r-00000 as file:/tmp/hadoop-Administrator/mapred/local/1481526755081/part-r-00000<br> 2016-12-12 15:12:35,696 INFO [org.apache.hadoop.mapreduce.Job] - The url to track the job: http://localhost:8080/<br> 2016-12-12 15:12:35,697 INFO [org.apache.hadoop.mapreduce.Job] - Running job: job_local671371338_0001<br> 2016-12-12 15:12:35,703 INFO [org.apache.hadoop.mapred.LocalJobRunner] - OutputCommitter set in config null<br> 2016-12-12 15:12:35,715 INFO [org.apache.hadoop.mapred.LocalJobRunner] - OutputCommitter is org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter<br> 2016-12-12 15:12:35,772 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Waiting for map tasks<br> 2016-12-12 15:12:35,772 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local671371338_0001_m_000000_0<br> 2016-12-12 15:12:35,819 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:12:35,852 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@50b97c8b<br> 2016-12-12 15:12:35,858 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/part-r-00001:0+195718<br> 2016-12-12 15:12:35,926 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 15:12:35,926 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 15:12:35,926 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 15:12:35,926 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 15:12:35,927 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 15:12:35,938 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> ******************<br> 2016-12-12 15:12:36,701 INFO [org.apache.hadoop.mapreduce.Job] - Job job_local671371338_0001 running in uber mode : false<br> 2016-12-12 15:12:36,703 INFO [org.apache.hadoop.mapreduce.Job] - map 0% reduce 0%<br> 2016-12-12 15:12:36,965 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 15:12:36,966 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 15:12:36,966 INFO [org.apache.hadoop.mapred.MapTask] - Spilling map output<br> 2016-12-12 15:12:36,966 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufend = 239755; bufvoid = 104857600<br> 2016-12-12 15:12:36,966 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396(104857584); kvend = 26183268(104733072); length = 31129/6553600<br> 2016-12-12 15:12:37,135 INFO [org.apache.hadoop.mapred.MapTask] - Finished spill 0<br> 2016-12-12 15:12:37,141 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local671371338_0001_m_000000_0 is done. And is in the process of committing<br> 2016-12-12 15:12:37,153 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map<br> 2016-12-12 15:12:37,153 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local671371338_0001_m_000000_0' done.<br> 2016-12-12 15:12:37,154 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local671371338_0001_m_000000_0<br> 2016-12-12 15:12:37,154 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local671371338_0001_m_000001_0<br> 2016-12-12 15:12:37,156 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:12:37,191 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@70849e34<br> 2016-12-12 15:12:37,194 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/part-r-00002:0+193443<br> 2016-12-12 15:12:37,229 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 15:12:37,229 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 15:12:37,229 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 15:12:37,230 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 15:12:37,230 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 15:12:37,230 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> ******************<br> 2016-12-12 15:12:37,601 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 15:12:37,602 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 15:12:37,602 INFO [org.apache.hadoop.mapred.MapTask] - Spilling map output<br> 2016-12-12 15:12:37,602 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufend = 237126; bufvoid = 104857600<br> 2016-12-12 15:12:37,602 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396(104857584); kvend = 26183624(104734496); length = 30773/6553600<br> 2016-12-12 15:12:37,651 INFO [org.apache.hadoop.mapred.MapTask] - Finished spill 0<br> 2016-12-12 15:12:37,683 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local671371338_0001_m_000001_0 is done. And is in the process of committing<br> 2016-12-12 15:12:37,687 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map<br> 2016-12-12 15:12:37,687 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local671371338_0001_m_000001_0' done.<br> 2016-12-12 15:12:37,687 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local671371338_0001_m_000001_0<br> 2016-12-12 15:12:37,687 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local671371338_0001_m_000002_0<br> 2016-12-12 15:12:37,690 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:12:37,722 INFO [org.apache.hadoop.mapreduce.Job] - map 100% reduce 0%<br> 2016-12-12 15:12:37,810 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@544b0d4c<br> 2016-12-12 15:12:37,813 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/part-r-00000:0+191780<br> 2016-12-12 15:12:37,851 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 15:12:37,851 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 15:12:37,851 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 15:12:37,851 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 15:12:37,852 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 15:12:37,853 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> ******************<br> 2016-12-12 15:12:37,915 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 15:12:37,915 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 15:12:37,916 INFO [org.apache.hadoop.mapred.MapTask] - Spilling map output<br> 2016-12-12 15:12:37,916 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufend = 234731; bufvoid = 104857600<br> 2016-12-12 15:12:37,916 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396(104857584); kvend = 26183920(104735680); length = 30477/6553600<br> 2016-12-12 15:12:37,939 INFO [org.apache.hadoop.mapred.MapTask] - Finished spill 0<br> 2016-12-12 15:12:37,943 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local671371338_0001_m_000002_0 is done. And is in the process of committing<br> 2016-12-12 15:12:37,946 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map<br> 2016-12-12 15:12:37,946 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local671371338_0001_m_000002_0' done.<br> 2016-12-12 15:12:37,946 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local671371338_0001_m_000002_0<br> 2016-12-12 15:12:37,947 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local671371338_0001_m_000003_0<br> 2016-12-12 15:12:37,950 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:12:37,999 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@6c241f31<br> 2016-12-12 15:12:38,002 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo1/part-r-00003:0+11<br> 2016-12-12 15:12:38,046 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 15:12:38,046 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 15:12:38,046 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 15:12:38,046 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 15:12:38,046 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 15:12:38,047 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> ******************<br> 2016-12-12 15:12:38,050 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 15:12:38,050 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 15:12:38,060 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local671371338_0001_m_000003_0 is done. And is in the process of committing<br> 2016-12-12 15:12:38,063 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map<br> 2016-12-12 15:12:38,063 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local671371338_0001_m_000003_0' done.<br> 2016-12-12 15:12:38,064 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local671371338_0001_m_000003_0<br> 2016-12-12 15:12:38,064 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map task executor complete.<br> 2016-12-12 15:12:38,067 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Waiting for reduce tasks<br> 2016-12-12 15:12:38,067 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local671371338_0001_r_000000_0<br> 2016-12-12 15:12:38,079 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 15:12:38,104 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@777da320<br> 2016-12-12 15:12:38,116 INFO [org.apache.hadoop.mapred.ReduceTask] - Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@76a01b4b<br> 2016-12-12 15:12:38,133 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - MergerManager: memoryLimit=1327077760, maxSingleShuffleLimit=331769440, mergeThreshold=875871360, ioSortFactor=10, memToMemMergeOutputsThreshold=10<br> 2016-12-12 15:12:38,135 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - attempt_local671371338_0001_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events<br> 2016-12-12 15:12:38,165 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#1 about to shuffle output of map attempt_local671371338_0001_m_000001_0 decomp: 252516 len: 252520 to MEMORY<br> 2016-12-12 15:12:38,169 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 252516 bytes from map-output for attempt_local671371338_0001_m_000001_0<br> 2016-12-12 15:12:38,216 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 252516, inMemoryMapOutputs.size() -&gt; 1, commitMemory -&gt; 0, usedMemory -&gt;252516<br> 2016-12-12 15:12:38,221 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#1 about to shuffle output of map attempt_local671371338_0001_m_000002_0 decomp: 249973 len: 249977 to MEMORY<br> 2016-12-12 15:12:38,223 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 249973 bytes from map-output for attempt_local671371338_0001_m_000002_0<br> 2016-12-12 15:12:38,224 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 249973, inMemoryMapOutputs.size() -&gt; 2, commitMemory -&gt; 252516, usedMemory -&gt;502489<br> 2016-12-12 15:12:38,230 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#1 about to shuffle output of map attempt_local671371338_0001_m_000000_0 decomp: 255323 len: 255327 to MEMORY<br> 2016-12-12 15:12:38,233 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 255323 bytes from map-output for attempt_local671371338_0001_m_000000_0<br> 2016-12-12 15:12:38,233 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 255323, inMemoryMapOutputs.size() -&gt; 3, commitMemory -&gt; 502489, usedMemory -&gt;757812<br> 2016-12-12 15:12:38,235 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#1 about to shuffle output of map attempt_local671371338_0001_m_000003_0 decomp: 2 len: 6 to MEMORY<br> 2016-12-12 15:12:38,236 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 2 bytes from map-output for attempt_local671371338_0001_m_000003_0<br> 2016-12-12 15:12:38,236 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 2, inMemoryMapOutputs.size() -&gt; 4, commitMemory -&gt; 757812, usedMemory -&gt;757814<br> 2016-12-12 15:12:38,237 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - EventFetcher is interrupted.. Returning<br> 2016-12-12 15:12:38,238 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 4 / 4 copied.<br> 2016-12-12 15:12:38,238 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - finalMerge called with 4 in-memory map-outputs and 0 on-disk map-outputs<br> 2016-12-12 15:12:38,252 INFO [org.apache.hadoop.mapred.Merger] - Merging 4 sorted segments<br> 2016-12-12 15:12:38,253 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 3 segments left of total size: 757755 bytes<br> 2016-12-12 15:12:38,413 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merged 4 segments, 757814 bytes to disk to satisfy reduce memory limit<br> 2016-12-12 15:12:38,414 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 1 files, 757812 bytes from disk<br> 2016-12-12 15:12:38,415 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 0 segments, 0 bytes from memory into reduce<br> 2016-12-12 15:12:38,415 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 15:12:38,416 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 757789 bytes<br> 2016-12-12 15:12:38,433 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 4 / 4 copied.<br> 2016-12-12 15:12:38,439 INFO [org.apache.hadoop.conf.Configuration.deprecation] - mapred.skip.on is deprecated. Instead, use mapreduce.job.skiprecords<br> 2016-12-12 15:12:38,844 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local671371338_0001_r_000000_0 is done. And is in the process of committing<br> 2016-12-12 15:12:38,846 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 4 / 4 copied.<br> 2016-12-12 15:12:38,846 INFO [org.apache.hadoop.mapred.Task] - Task attempt_local671371338_0001_r_000000_0 is allowed to commit now<br> 2016-12-12 15:12:38,857 INFO [org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter] - Saved output of task 'attempt_local671371338_0001_r_000000_0' to file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/weibo3/_temporary/0/task_local671371338_0001_r_000000<br> 2016-12-12 15:12:38,861 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce &gt; reduce<br> 2016-12-12 15:12:38,861 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local671371338_0001_r_000000_0' done.<br> 2016-12-12 15:12:38,861 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local671371338_0001_r_000000_0<br> 2016-12-12 15:12:38,862 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce task executor complete.<br> 2016-12-12 15:12:39,724 INFO [org.apache.hadoop.mapreduce.Job] - map 100% reduce 100%<br> 2016-12-12 15:12:39,726 INFO [org.apache.hadoop.mapreduce.Job] - Job job_local671371338_0001 completed successfully<br> 2016-12-12 15:12:39,841 INFO [org.apache.hadoop.mapreduce.Job] - Counters: 33<br> File System Counters<br> FILE: Number of bytes read=4124093<br> FILE: Number of bytes written=5365498<br> FILE: Number of read operations=0<br> FILE: Number of large read operations=0<br> FILE: Number of write operations=0<br> Map-Reduce Framework<br> Map input records=23098<br> Map output records=23097<br> Map output bytes=711612<br> Map output materialized bytes=757830<br> Input split bytes=528<br> Combine input records=0<br> Combine output records=0<br> Reduce input groups=1065<br> Reduce shuffle bytes=757830<br> Reduce input records=23097<br> Reduce output records=1065<br> Spilled Records=46194<br> Shuffled Maps =4<br> Failed Shuffles=0<br> Merged Map outputs=4<br> GC time elapsed (ms)=30<br> CPU time spent (ms)=0<br> Physical memory (bytes) snapshot=0<br> Virtual memory (bytes) snapshot=0<br> Total committed heap usage (bytes)=2353528832<br> Shuffle Errors<br> BAD_ID=0<br> CONNECTION=0<br> IO_ERROR=0<br> WRONG_LENGTH=0<br> WRONG_MAP=0<br> WRONG_REDUCE=0<br> File Input Format Counters&nbsp;<br> Bytes Read=585564<br> File Output Format Counters&nbsp;<br> Bytes Written=340785<br> 执行job成功</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151302808-33658546.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;<img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151322370-352946198.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151334120-1854467368.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212151348245-1377958956.png" alt="" style="border:0px;"></p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="color:rgb(0,0,255);font-size:18pt;"><strong>代码</strong></span></p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.StringReader;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.wltea.analyzer.core.IKSegmenter;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.wltea.analyzer.core.Lexeme;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 第一个MR，计算TF和计算N(微博总数)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * </span><span style="color:rgb(128,128,128);font-size:12px;line-height:1.5;">@author</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> root
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> *
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span>  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> FirstMapper <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Mapper&lt;LongWritable, Text, Text, IntWritable&gt;<span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">protected</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> map(LongWritable key, Text value,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span> <span style="font-size:12px;line-height:1.5;">            Context context)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        3823890201582094    今天我约了豆浆，油条。约了电饭煲几小时后饭就自动煮好，还想约豆浆机，让我早晨多睡一小时，豆浆就自然好。起床就可以喝上香喷喷的豆浆了。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        3823890210294392    今天我约了豆浆，油条</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span>         String[]  v =value.toString().trim().split("\t"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(v.length&gt;=2<span style="font-size:12px;line-height:1.5;">){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span>         String id=v[0<span style="font-size:12px;line-height:1.5;">].trim();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span>         String content =v[1<span style="font-size:12px;line-height:1.5;">].trim();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span>         StringReader sr =<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> StringReader(content);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">content是新浪微博内容</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span>         IKSegmenter ikSegmenter =<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IKSegmenter(sr, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">33</span>         Lexeme word=<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">null</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">34</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">第一件事情，就是通过IK分词器（IKAnalyzer），把weibo2.txt里 的内容
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">35</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">这里，单独可以去网上找到IKAnalyzer2012_FF.jar。然后像我这样，放到lib下，必须要选中，然后Build Path  -&gt; Add Build Path</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">36</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">37</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">while</span>( (word=ikSegmenter.next()) !=<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">null</span><span style="font-size:12px;line-height:1.5;"> ){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">38</span>             String w= word.getLexemeText();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">w是词条</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">39</span>             context.write(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text(w+"_"+id), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IntWritable(1<span style="font-size:12px;line-height:1.5;">));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">40</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">41</span>         context.write(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text("count"), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IntWritable(1<span style="font-size:12px;line-height:1.5;">));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">42</span>         }<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">else</span><span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">43</span>             System.out.println(value.toString()+"-------------");<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">为什么要来----------，是因为方便统计TF，因为TF是某一篇微博词条的词频。</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">44</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">45</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">46</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">47</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">48</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">49</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Partitioner;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.partition.HashPartitioner;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 第一个MR自定义分区
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * </span><span style="color:rgb(128,128,128);font-size:12px;line-height:1.5;">@author</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> root
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> *
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span>  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> FirstPartition <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> HashPartitioner&lt;Text, IntWritable&gt;<span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> getPartition(Text key, IntWritable value, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span><span style="font-size:12px;line-height:1.5;"> reduceCount) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(key.equals(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text("count"<span style="font-size:12px;line-height:1.5;">)))
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> 3;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">总共拿4个reduce，其中拿1个reduce去输出微博总数，拿3个reduce去输出微博词频。</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">else</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">super</span>.getPartition(key, value, reduceCount-1<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * c1_001,2
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * c2_001,1
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * count,10000
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * </span><span style="color:rgb(128,128,128);font-size:12px;line-height:1.5;">@author</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> root
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> *
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span>  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> FirstReduce <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Reducer&lt;Text, IntWritable, Text, IntWritable&gt;<span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">protected</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> reduce(Text arg0, Iterable&lt;IntWritable&gt;<span style="font-size:12px;line-height:1.5;"> arg1,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span> <span style="font-size:12px;line-height:1.5;">            Context arg2)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> sum =0<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span><span style="font-size:12px;line-height:1.5;">( IntWritable i :arg1 ){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span>             sum= sum+<span style="font-size:12px;line-height:1.5;">i.get();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(arg0.equals(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text("count"<span style="font-size:12px;line-height:1.5;">))){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span>             System.out.println(arg0.toString() +"___________"+<span style="font-size:12px;line-height:1.5;">sum);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span>         arg2.write(arg0, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> IntWritable(sum));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.FileSystem;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapred.JobConf;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapred.TextInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Job;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> FirstJob {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> main(String[] args) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span>         Configuration config =<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Configuration();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        config.set("fs.defaultFS", "hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000");
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        config.set("yarn.resourcemanager.hostname", "HadoopMaster");</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">try</span><span style="font-size:12px;line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span>             FileSystem fs =<span style="font-size:12px;line-height:1.5;">FileSystem.get(config);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            JobConf job =new JobConf(config);</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span>             Job job =<span style="font-size:12px;line-height:1.5;">Job.getInstance(config);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span>             job.setJarByClass(FirstJob.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span>             job.setJobName("weibo1"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span>             job.setOutputKeyClass(Text.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">33</span>             job.setOutputValueClass(IntWritable.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">34</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            job.setMapperClass();</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">35</span>             job.setNumReduceTasks(4<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">36</span>             job.setPartitionerClass(FirstPartition.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">37</span>             job.setMapperClass(FirstMapper.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">38</span>             job.setCombinerClass(FirstReduce.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">39</span>             job.setReducerClass(FirstReduce.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">40</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">41</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>            
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">42</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            FileInputFormat.addInputPath(job, new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/Weibodata.txt"));</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">下有数据源，Weibodata.txt
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">43</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>            
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">44</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            Path path =new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/out/weibo1");</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">45</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">46</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">47</span>             FileInputFormat.addInputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path("./data/weibo/Weibodata.txt"));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">下有数据源，Weibodata.txt</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">48</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">49</span>             Path path =<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path("./out/weibo1"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">50</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">51</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">52</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">53</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            part-r-00000
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">54</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            part-r-00001
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">55</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            part-r-00002     拿3个reduce去输出微博词频。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">56</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            part-r-00003     最后这个是输出微博总数，</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">57</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span><span style="font-size:12px;line-height:1.5;">(fs.exists(path)){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">58</span>                 fs.delete(path, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">59</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">60</span> <span style="font-size:12px;line-height:1.5;">            FileOutputFormat.setOutputPath(job,path);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">61</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">62</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">boolean</span> f= job.waitForCompletion(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">63</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span><span style="font-size:12px;line-height:1.5;">(f){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">64</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">65</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">66</span>         } <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">catch</span><span style="font-size:12px;line-height:1.5;"> (Exception e) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">67</span> <span style="font-size:12px;line-height:1.5;">            e.printStackTrace();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">68</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">69</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">70</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.StringReader;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileSplit;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.wltea.analyzer.core.IKSegmenter;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.wltea.analyzer.core.Lexeme; 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">统计df：词在多少个微博中出现过。</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> TwoMapper <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Mapper&lt;LongWritable, Text, Text, IntWritable&gt;<span style="font-size:12px;line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">protected</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> map(LongWritable key, Text value, Context context)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">获取当前    mapper task的数据片段（split）</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>         FileSplit fs =<span style="font-size:12px;line-height:1.5;"> (FileSplit) context.getInputSplit();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (!fs.getPath().getName().contains("part-r-00003"<span style="font-size:12px;line-height:1.5;">)) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span>             String[] v = value.toString().trim().split("\t"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (v.length &gt;= 2<span style="font-size:12px;line-height:1.5;">) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span>                 String[] ss = v[0].split("_"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span>                 <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (ss.length &gt;= 2<span style="font-size:12px;line-height:1.5;">) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span>                     String w = ss[0<span style="font-size:12px;line-height:1.5;">];
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span>                     context.write(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text(w), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> IntWritable(1<span style="font-size:12px;line-height:1.5;">));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span> <span style="font-size:12px;line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span>             } <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">else</span><span style="font-size:12px;line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">33</span>                 System.out.println(value.toString() + "-------------"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">34</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">35</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">36</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">37</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">38</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> TwoReduce <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Reducer&lt;Text, IntWritable, Text, IntWritable&gt;<span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">protected</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> reduce(Text key, Iterable&lt;IntWritable&gt;<span style="font-size:12px;line-height:1.5;"> arg1,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> <span style="font-size:12px;line-height:1.5;">            Context context)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> sum =0<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span><span style="font-size:12px;line-height:1.5;">( IntWritable i :arg1 ){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span>             sum= sum+<span style="font-size:12px;line-height:1.5;">i.get();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>         context.write(key, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> IntWritable(sum));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapred.JobConf;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapred.TextInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Job;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> TwoJob {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> main(String[] args) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span>         Configuration config =<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Configuration();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        config.set("fs.defaultFS", "hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000");
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        config.set("yarn.resourcemanager.hostname", "HadoopMaster");</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">try</span><span style="font-size:12px;line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            JobConf job =new JobConf(config);</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span>             Job job =<span style="font-size:12px;line-height:1.5;">Job.getInstance(config);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span>             job.setJarByClass(TwoJob.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span>             job.setJobName("weibo2"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置map任务的输出key类型、value类型</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span>             job.setOutputKeyClass(Text.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span>             job.setOutputValueClass(IntWritable.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            job.setMapperClass();</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span>             job.setMapperClass(TwoMapper.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">33</span>             job.setCombinerClass(TwoReduce.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">34</span>             job.setReducerClass(TwoReduce.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">35</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">36</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">mr运行时的输入数据从hdfs的哪个目录中获取
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">37</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            FileInputFormat.addInputPath(job, new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/out/weibo1/"));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">38</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            FileOutputFormat.setOutputPath(job, new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/out/weibo2"));</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">39</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">40</span>             FileInputFormat.addInputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path("./out/weibo1/"<span style="font-size:12px;line-height:1.5;">));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">41</span>             FileOutputFormat.setOutputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path("./out/weibo2"<span style="font-size:12px;line-height:1.5;">));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">42</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">43</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">boolean</span> f= job.waitForCompletion(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">44</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span><span style="font-size:12px;line-height:1.5;">(f){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">45</span>                 System.out.println("执行job成功"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">46</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">47</span>         } <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">catch</span><span style="font-size:12px;line-height:1.5;"> (Exception e) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">48</span> <span style="font-size:12px;line-height:1.5;">            e.printStackTrace();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">49</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">50</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">51</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.BufferedReader;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.File;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.FileInputStream;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.FileReader;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.InputStreamReader;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.StringReader;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.net.URI;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.text.NumberFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 13</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.HashMap;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 14</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.Map;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 15</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 16</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 17</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.FileSystem;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 18</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 19</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 20</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 21</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 22</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 23</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileSplit;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 24</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.wltea.analyzer.core.IKSegmenter;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 25</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.wltea.analyzer.core.Lexeme;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 26</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 27</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 28</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 最后计算
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 29</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * </span><span style="color:rgb(128,128,128);font-size:12px;line-height:1.5;">@author</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> root
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 30</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> *
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 31</span>  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 32</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> LastMapper <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Mapper&lt;LongWritable, Text, Text, Text&gt;<span style="font-size:12px;line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 33</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放微博总数</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 34</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> Map&lt;String, Integer&gt; cmap = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">null</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 35</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放df</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 36</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> Map&lt;String, Integer&gt; df = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">null</span><span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 37</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 38</span>     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 在map方法执行之前</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 39</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">protected</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> setup(Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 40</span> <span style="font-size:12px;line-height:1.5;">            InterruptedException {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 41</span>         System.out.println("******************"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 42</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (cmap == <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">null</span> || cmap.size() == 0 || df == <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">null</span> || df.size() == 0<span style="font-size:12px;line-height:1.5;">) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 43</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 44</span>             URI[] ss =<span style="font-size:12px;line-height:1.5;"> context.getCacheFiles();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 45</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (ss != <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">null</span><span style="font-size:12px;line-height:1.5;">) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 46</span>                 <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span> (<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> i = 0; i &lt; ss.length; i++<span style="font-size:12px;line-height:1.5;">) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 47</span>                     URI uri =<span style="font-size:12px;line-height:1.5;"> ss[i];
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 48</span>                     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (uri.getPath().endsWith("part-r-00003")) {<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">微博总数</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 49</span>                         Path path =<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Path(uri.getPath());
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 50</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        FileSystem fs =FileSystem.get(context.getConfiguration());
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 51</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        fs.open(path);</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 52</span>                         BufferedReader br = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> BufferedReader(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> FileReader(path.getName()));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 53</span>                         String line =<span style="font-size:12px;line-height:1.5;"> br.readLine();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 54</span>                         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (line.startsWith("count"<span style="font-size:12px;line-height:1.5;">)) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 55</span>                             String[] ls = line.split("\t"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 56</span>                             cmap = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> HashMap&lt;String, Integer&gt;<span style="font-size:12px;line-height:1.5;">();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 57</span>                             cmap.put(ls[0], Integer.parseInt(ls[1<span style="font-size:12px;line-height:1.5;">].trim()));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 58</span> <span style="font-size:12px;line-height:1.5;">                        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 59</span> <span style="font-size:12px;line-height:1.5;">                        br.close();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 60</span>                     } <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">else</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (uri.getPath().endsWith("part-r-00000")) {<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">词条的DF</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 61</span>                         df = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> HashMap&lt;String, Integer&gt;<span style="font-size:12px;line-height:1.5;">();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 62</span>                         Path path =<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Path(uri.getPath());
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 63</span>                         BufferedReader br = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> BufferedReader(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> FileReader(path.getName()));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 64</span> <span style="font-size:12px;line-height:1.5;">                        String line;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 65</span>                         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">while</span> ((line = br.readLine()) != <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">null</span><span style="font-size:12px;line-height:1.5;">) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 66</span>                             String[] ls = line.split("\t"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 67</span>                             df.put(ls[0], Integer.parseInt(ls[1<span style="font-size:12px;line-height:1.5;">].trim()));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 68</span> <span style="font-size:12px;line-height:1.5;">                        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 69</span> <span style="font-size:12px;line-height:1.5;">                        br.close();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 70</span> <span style="font-size:12px;line-height:1.5;">                    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 71</span> <span style="font-size:12px;line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 72</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 73</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 74</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 75</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 76</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">protected</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> map(LongWritable key, Text value, Context context)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 77</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 78</span>         FileSplit fs =<span style="font-size:12px;line-height:1.5;"> (FileSplit) context.getInputSplit();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 79</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        System.out.println("--------------------");</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 80</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (!fs.getPath().getName().contains("part-r-00003"<span style="font-size:12px;line-height:1.5;">)) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 81</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 82</span>             String[] v = value.toString().trim().split("\t"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 83</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (v.length &gt;= 2<span style="font-size:12px;line-height:1.5;">) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 84</span>                 <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> tf =Integer.parseInt(v[1].trim());<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">tf值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 85</span>                 String[] ss = v[0].split("_"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 86</span>                 <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span> (ss.length &gt;= 2<span style="font-size:12px;line-height:1.5;">) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 87</span>                     String w = ss[0<span style="font-size:12px;line-height:1.5;">];
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 88</span>                     String id=ss[1<span style="font-size:12px;line-height:1.5;">];
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 89</span>                     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 90</span>                     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">double</span> s=tf * Math.log(cmap.get("count")/<span style="font-size:12px;line-height:1.5;">df.get(w));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 91</span>                     NumberFormat nf =<span style="font-size:12px;line-height:1.5;">NumberFormat.getInstance();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 92</span>                     nf.setMaximumFractionDigits(5<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 93</span>                     context.write(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text(id), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text(w+":"+<span style="font-size:12px;line-height:1.5;">nf.format(s)));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 94</span> <span style="font-size:12px;line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 95</span>             } <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">else</span><span style="font-size:12px;line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 96</span>                 System.out.println(value.toString() + "-------------"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 97</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 98</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 99</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">100</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> LastReduce <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Reducer&lt;Text, Text, Text, Text&gt;<span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">protected</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> reduce(Text key, Iterable&lt;Text&gt;<span style="font-size:12px;line-height:1.5;"> arg1,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> <span style="font-size:12px;line-height:1.5;">            Context context)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span>         StringBuffer sb =<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> StringBuffer();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span><span style="font-size:12px;line-height:1.5;">( Text i :arg1 ){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span>             sb.append(i.toString()+"\t"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span>         context.write(key, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Text(sb.toString()));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.filecache.DistributedCache;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.FileSystem;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.IntWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapred.JobConf;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapred.TextInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">14</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Job;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">15</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">16</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">17</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">18</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">19</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> LastJob {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">20</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> main(String[] args) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">21</span>         Configuration config =<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Configuration();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">22</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        config.set("fs.defaultFS", "hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000");
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">23</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        config.set("yarn.resourcemanager.hostname", "HadoopMaster");
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">24</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        config.set("mapred.jar", "C:\\Users\\Administrator\\Desktop\\weibo3.jar");</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">25</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">try</span><span style="font-size:12px;line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">26</span>             FileSystem fs =<span style="font-size:12px;line-height:1.5;">FileSystem.get(config);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">27</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            JobConf job =new JobConf(config);</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">28</span>             Job job =<span style="font-size:12px;line-height:1.5;">Job.getInstance(config);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">29</span>             job.setJarByClass(LastJob.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">30</span>             job.setJobName("weibo3"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">31</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">32</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            DistributedCache.addCacheFile(uri, conf);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">33</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">2.5
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">34</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">把微博总数加载到内存
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">35</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            job.addCacheFile(new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/out/weibo1/part-r-00003").toUri());
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">36</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>            <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">把df加载到内存
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">37</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            job.addCacheFile(new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/out/weibo2/part-r-00000").toUri());</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">38</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">39</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">40</span>             job.addCacheFile(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path("./out/weibo1/part-r-00003"<span style="font-size:12px;line-height:1.5;">).toUri());
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">41</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">把df加载到内存</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">42</span>             job.addCacheFile(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path("./out/weibo2/part-r-00000"<span style="font-size:12px;line-height:1.5;">).toUri());
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">43</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">44</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">45</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">46</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置map任务的输出key类型、value类型</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">47</span>             job.setOutputKeyClass(Text.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">48</span>             job.setOutputValueClass(Text.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">49</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            job.setMapperClass();</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">50</span>             job.setMapperClass(LastMapper.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">51</span>             job.setReducerClass(LastReduce.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">52</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">53</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">mr运行时的输入数据从hdfs的哪个目录中获取
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">54</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            FileInputFormat.addInputPath(job, new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/out/weibo1"));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">55</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            Path outpath =new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/out/weibo3/");</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">56</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">57</span>             FileInputFormat.addInputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path("./out/weibo1"<span style="font-size:12px;line-height:1.5;">));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">58</span>             Path outpath =<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path("./out/weibo3/"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">59</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">60</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">61</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span><span style="font-size:12px;line-height:1.5;">(fs.exists(outpath)){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">62</span>                 fs.delete(outpath, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">63</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">64</span> <span style="font-size:12px;line-height:1.5;">            FileOutputFormat.setOutputPath(job,outpath );
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">65</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">66</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">boolean</span> f= job.waitForCompletion(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">67</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span><span style="font-size:12px;line-height:1.5;">(f){
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">68</span>                 System.out.println("执行job成功"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">69</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">70</span>         } <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">catch</span><span style="font-size:12px;line-height:1.5;"> (Exception e) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">71</span> <span style="font-size:12px;line-height:1.5;">            e.printStackTrace();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">72</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">73</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">74</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div class="cnblogs_code" style="font-family:'Courier New';font-size:12px;border:1px solid rgb(204,204,204);"> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
     <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.weibo;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.text.NumberFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 4</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> Test {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 6</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 7</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> main(String[] args) {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 8</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">double</span> s=34 * Math.log(1056/5<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 9</span>         NumberFormat nf =<span style="font-size:12px;line-height:1.5;">NumberFormat.getInstance();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">10</span>         nf.setMaximumFractionDigits(5<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">11</span> <span style="font-size:12px;line-height:1.5;">        System.out.println(nf.format(s));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">12</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">13</span> }</pre> 
     <div class="cnblogs_code_toolbar">
      <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
     </div> 
    </div> 
    <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
    <div style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
     <br>
    </div> 
    <div> 
     <font><span style="font-size:14px;">本文转自大数据躺过的坑博客园博客，原文链接：http://www.cnblogs.com/zlslch/p/6164642.html，如需转载请自行联系原作者</span></font>
     <br>
    </div> 
   </div> 
   <div style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"></div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
