<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Hadoop MapReduce编程 API入门系列之join（二十六） « NotBeCN</title>
  <meta name="description" content="                     &nbsp;    &nbsp;    &nbsp;    天气记录数据库        &nbsp;    &nbsp;    &nbsp;    气象站数据库        &nbsp;    &nbsp;    &nbsp;    &nbsp;    气象站和天气记...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/14/weixin_34377065_90122287.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Hadoop MapReduce编程 API入门系列之join（二十六）</h1>
    <p class="post-meta">Nov 14, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212225453495-1013383491.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212225503245-785410671.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">天气记录数据库</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161213091322667-1238972730.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">气象站数据库</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161213091330214-1275842464.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">气象站和天气记录合并之后的示意图如下所示。</p> 
   <table class="table table-wuxia" style="border-collapse:collapse;border-spacing:0px;border:1px solid #C0C0C0;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">011990-99999</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">SIHCCAJAVRI</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">195005150700</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">0</td> 
     </tr>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">011990-99999</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">SIHCCAJAVRI</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">195005151200</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">22</td> 
     </tr>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">011990-99999</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">SIHCCAJAVRI</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">195005151800</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">-11</td> 
     </tr>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">012650-99999</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">TYNSET-HANSMOEN</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">194903241200</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">111</td> 
     </tr>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">012650-99999</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">TYNSET-HANSMOEN</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">194903241800</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">78</td> 
     </tr>
    </tbody>
   </table>
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp;连接操作的具体实现技术取决于数据集的规模及分区方式。如果一个数据集很大而另外一个集合很小，以至于可以分发到集群中的每一个节点之中， 则可以执行一个 MapReduce 作业，将各个气象站的天气记录放到一块，从而实现连接。mapper 或 reducer 根据各气象站 ID 从较小的数据集合中找到气象站元数据，从而完成气象站数据和天气记录数据的合并。&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp;连接操作如果由 mapper 执行，则称为 “map 端连接” ；如果由 reducer 执行，则称为 “reduce 端连接”。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp;如果两个数据集的规模均很大，以至于没有哪个数据集可以被完全复制到集群的每个节点，我们仍然可以使用 MapReduce 来进行连接，至于到底采用 map 端连接还是 reduce 端连接，则取决于数据的组织方式。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="font-size:18pt;">map 端连接</span></h3> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在两个大规模输入数据集之间的 map 端连接会在数据达到 map 函数之前就执行连接操作。为达到该目的，各 map 的输入数据必须先分区并且以特定方式排序。 各个输入数据集被划分成相同数量的分区，并且均按相同的键（连接键）排序。同一键的所有记录均会放在同一分区之中。听起来似乎要求非常严格，但这的确合乎 MapReduce 作业的输出。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map 端连接操作可以连接多个作业的输出，只要这些作业的 reducer 数量相同、键相同并且输出文件是不可切分的（例如，小于一个 HDFS 块，或 gzip 压缩）。 在上面讲的天气例子中，如果气象站文件以气象站ID部分排序，记录文件也以气象站 ID 部分排序，而且 reducer 的数量相同，则就满足了执行 map 端连接的前提条件。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;利用 org.apache.hadoop.mapreduce.join 包中的 CompositeInputFormat 类来运行一个 map 端连接。CompositeInputFormat 类的输入源和连接类型（内连接或外连接）可以通过一个连接表达式进行配置， 连接表达式的语法简单。详情与示例可参考包文档。此种方法不常用，了解即可，这里不再赘述。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="font-size:18pt;">reduce 端连接</span></h3> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由于 reduce 端连接并不要求输入数据集符合特定结构，因而 reduce端连接比 map 端连接更为常用。但是，由于两个数据集均需经过 MapReduce 的 shuffle 过程， 所以 reduce 端连接的效率往往要低一些。基本思路是 mapper 为各个记录标记源，并且使用连接键作为 map 输出键，使键相同的记录放在同一 reducer 中。 我们通过下面两种技术实现 reduce 端连接。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1、多输入</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;数据集的输入源往往有多种格式，因此可以使用 MultipleInputs 类来方便地解析和标注各个数据源。MultipleInputs 的用法，在输入格式课程已经详细介绍，这里就不再赘述。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2、二次排序</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如前所述，reducer 将两个数据源中选出键相同的记录并不介意这些记录是否已排好序。此外，为了更好地执行连接操作，先将某一个数据源传输到 reducer 会非常重要。 还以上面的天气数据连接为例，当天气记录发送到 reducer 的时候，与这些记录有相同键的气象站信息最好也已经放在 reducer ，使得 reducer 能够将气象站名称填到天气记录之中就马上输出。 虽然也可以不指定数据传输次序，并将待处理的记录缓存在内存之中，但应该尽量避免这种情况，因为其中任何一组的记录数量可能非常庞大，远远超出 reducer 的可用内存容量。 因此我们用到二次排序技术，对 map 阶段输出的每个键的值进行排序，实现这一效果。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们使用 TextPair 类构建组合键，包括气象站 ID 和 “标记”。在这里，“标记” 是一个虚拟的字段，其唯一目的是对记录排序，使气象站记录比天气记录先到达。一种简单的做法就是：对于气象站记录， “标记” 的值设为 0；对于天气记录，“标记” 的值设为1。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">JoinStationMapper&nbsp;<span style="font-size:18pt;"><strong>处理来自气象站数据</strong></span>，代码如下所示。</p> 
   <pre><code class="language-html">public class JoinStationMapper extends Mapper<span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-tag">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">LongWritable<span class="hljs-tag" style="color:rgb(0,0,255);">,<span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">Text<span class="hljs-tag" style="color:rgb(0,0,255);">,<span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">TextPair<span class="hljs-tag" style="color:rgb(0,0,255);">,<span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">Text<span class="hljs-tag" style="color:rgb(0,0,255);">&gt;{ protected void map(LongWritable key,Text value,Context context) throws IOException,InterruptedException{ String line = value.toString(); String[] arr = line.split("\\s+");//解析气象站数据 int length = arr.length; if(length==2){//满足这种数据格式 //key=气象站id value=气象站名称 context.write(new TextPair(arr[0],"0"),new Text(arr[1])); } } }</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; JoinRecordMapper&nbsp;<span style="font-size:18pt;"><strong>处理来自天气记录数据</strong></span>，代码如下所示。</p> 
   <pre><code class="language-html">public class JoinRecordMapper extends Mapper<span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-tag">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">LongWritable<span class="hljs-tag" style="color:rgb(0,0,255);">,<span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">Text<span class="hljs-tag" style="color:rgb(0,0,255);">,<span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">TextPair<span class="hljs-tag" style="color:rgb(0,0,255);">,<span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">Text<span class="hljs-tag" style="color:rgb(0,0,255);">&gt;{ protected void map(LongWritable key,Text value,Context context) throws IOException,InterruptedException{ String line = value.toString(); String[] arr = line.split("\\s+",2);//解析天气记录数据 int length = arr.length; if(length==2){ //key=气象站id value=天气记录数据 context.write(new TextPair(arr[0],"1"),new Text(arr[1])); } } }</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br><br><br><br><br></code></pre> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; 由于 TextPair 经过了二次排序，所以 reducer 会先接收到气象站数据。因此从中抽取气象站名称，并将其作为后续每条输出记录的一部分写到输出文件。JoinReducer 的代码如下所示。</p> 
   <pre><code class="language-html">public class JoinReducer extends Reducer<span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-tag">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">TextPair<span class="hljs-tag" style="color:rgb(0,0,255);">,<span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">Text<span class="hljs-tag" style="color:rgb(0,0,255);">,<span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">Text<span class="hljs-tag" style="color:rgb(0,0,255);">,<span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">Text<span class="hljs-tag" style="color:rgb(0,0,255);">&gt;{ protected void reduce(TextPair key, Iterable<span class="hljs-tag"><span class="hljs-tag">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">Text<span class="hljs-tag" style="color:rgb(0,0,255);">&gt; values,Context context) throws IOException,InterruptedException{ Iterator<span class="hljs-tag"><span class="hljs-tag">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">Text<span class="hljs-tag" style="color:rgb(0,0,255);">&gt; iter = values.iterator(); Text stationName = new Text(iter.next());//气象站名称 while(iter.hasNext()){ Text record = iter.next();//天气记录的每条数据 Text outValue = new Text(stationName.toString()+"\t"+record.toString()); context.write(key.getFirst(),outValue); } } }</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><br><br><br></code></pre> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp;上面 JoinReducer 里面的代码，假设天气记录的每个气象站 ID 恰巧与气象站数据集中的一条记录准确匹配。 如果该假设不成立，则需要泛化代码，使用另一个 TextPair 将标记放入值的对象中。reduce() 方法在处理天气记录之前，要能够区分哪些记录是气象站名称， 处理缺失或重复的记录。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp;下面我们定义作业的驱动类 JoinRecordWithStationName，在该类中，关键在于根据组合键的第一个字段（即气象站 ID）进行分区和分组，即使用一个自定义的 Partitioner 和 一个自定义的分组 comparator 作为TextPair 的嵌套类。JoinRecordWithStationName 类的代码如下所示。</p> 
   <pre><code class="language-html">public class JoinRecordWithStationName extends Configured implements Tool{
	public static class KeyPartitioner extends Partitioner<span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-tag">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">TextPair<span class="hljs-tag" style="color:rgb(0,0,255);">,<span class="hljs-attribute" style="color:rgb(163,21,21);"><span class="hljs-tag" style="color:rgb(0,0,255);"><span class="hljs-attribute" style="color:rgb(163,21,21);">Text<span class="hljs-tag" style="color:rgb(0,0,255);">&gt;{ @overwrite public int getPartition(TextPair key,Text value,int numPartitions){ return (key.getFirst().hashCode()&amp;Integer.MAX_VALUE) % numPartitions; } } @overwrite public int run(String[] args) throws Exception{ Configuration conf = new Configuration();// 读取配置文件 Job job = Job.getInstance();// 新建一个任务 job.setJarByClass(JoinRecordWithStationName.class);// 主类 Path recordInputPath = new Path(args[0]);//天气记录数据源 Path stationInputPath = new Path(args[1]);//气象站数据源 Path outputPath = new Path(args[2]);//输出路径 MultipleInputs.addInputPath(job,recordInputPath,TextInputFormat.class,JoinRecordMapper.class);//读取天气记录Mapper MultipleInputs.addInputPath(job,stationInputPath,TextInputFormat.class,JoinStationMapper.class);//读取气象站Mapper FileOutputFormat.setOutputPath(job,outputPath); job.setPartitionerClass(KeyPartitioner.class);//自定义分区 job.setGroupingComparatorClass(TextPair.FirstComparator.class);//自定义分组 job.setMapOutputKeyClass(TextPair.class); job.setReducerClass(JoinReducer.class);// Reducer job.setOutputKeyClass(Text.class); return job.waitForCompletion(true)?0:1; } public static void main(String[] args) throws Exception{ int exitCode = ToolRunner.run(new JoinRecordWithStationName(),args); System.exit(exitCode); } }</span></span></span></span></span></span></span></span></span></span><br><br></code></pre> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; 该样本数据上运行程序，获得以下输出结果。</p> 
   <pre><code class="language-html">011990-99999	SIHCCAJAVRI	195005150700	0
011990-99999	SIHCCAJAVRI	195005151200	22
011990-99999	SIHCCAJAVRI	195005151800	-11
012650-99999	TYNSET-HANSMOEN	194903241200	111
012650-99999	TYNSET-HANSMOEN	194903241800	78</code></pre> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="font-size:18pt;">分布式缓存</span></h3> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当 MapReduce 处理大型数据集间的 join 操作时，此时如果一个数据集很大而另外一个集合很小，以至于可以分发到集群中的每个节点之中。 这种情况下，我们就用到了 Hadoop 的分布式缓存机制，它能够在任务运行过程中及时地将文件和存档复制到任务节点以供使用。为了节约网络宽带，在每一个作业中， 各个文件通常只需要复制到一个节点一次。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;1、用法</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hadoop 命令行选项中，有三个命令可以实现文件复制分发到任务的各个节点。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1)用户可以使用 -files 选项指定待分发的文件，文件内包含以逗号隔开的 URL 列表。文件可以存放在本地文件系统、HDFS、或其它 Hadoop 可读文件系统之中。 如果尚未指定文件系统，则这些文件被默认是本地的。即使默认文件系统并非本地文件系统，这也是成立的。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2)用户可以使用 -archives 选项向自己的任务中复制存档文件，比如JAR 文件、ZIP 文件、tar 文件和 gzipped tar文件，这些文件会被解档到任务节点。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3)用户可以使用 -libjars 选项把 JAR 文件添加到 mapper 和 reducer 任务的类路径中。如果作业 JAR 文件并非包含很多库 JAR 文件，这点会很有用。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;2、工作机制</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当用户启动一个作业，Hadoop 会把由 -files、-archives、和 -libjars 等选项所指定的文件复制到分布式文件系统之中。接着，在任务运行之前， tasktracker 将文件从分布式文件系统复制到本地磁盘（缓存）使任务能够访问文件。此时，这些文件就被视为 “本地化” 了。从任务的角度来看， 这些文件就已经在那儿了，它并不关心这些文件是否来自 HDFS 。此外，有 -libjars 指定的文件会在任务启动前添加到任务的类路径（classpath）中。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;3、分布式缓存 API</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由于可以通过 Hadoop 命令行间接使用分布式缓存，大多数应用不需要使用分布式缓存 API。然而，一些应用程序需要用到分布式缓存的更高级的特性，这就需要直接使用 API 了。 API 包括两部分：将数据放到缓存中的方法，以及从缓存中读取数据的方法。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;　　1)首先掌握数据放到缓存中的方法，以下列举 Job 中可将数据放入到缓存中的相关方法：</p> 
   <pre><code class="language-html">public void addCacheFile(URI uri);
public void addCacheArchive(URI uri);//以上两组方法将文件或存档添加到分布式缓存
public void setCacheFiles(URI[] files);
public void setCacheArchives(URI[] archives);//以上两组方法将一次性向分布式缓存中添加一组文件或存档
public void addFileToClassPath(Path file);
public void addArchiveToClassPath(Path archive);//以上两组方法将文件或存档添加到 MapReduce 任务的类路径
public void createSymlink();<br><br>
&nbsp; &nbsp; &nbsp;在缓存中可以存放两类对象：文件（files）和存档（achives）。文件被直接放置在任务节点上，而存档则会被解档之后再将具体文件放置在任务节点上。<br><br><br></code></pre> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp;2)其次掌握在 map 或者 reduce 任务中，使用 API 从缓存中读取数据。</p> 
   <pre><code class="language-html">public Path[] getLocalCacheFiles() throws IOException;
public Path[] getLocalCacheArchives() throws IOException;
public Path[] getFileClassPaths();
public Path[] getArchiveClassPaths();</code></pre> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; 我们可以使用 getLocalCacheFiles()和getLocalCacheArchives()方法获取缓存中的文件或者存档的引用。 当处理存档时，将会返回一个包含解档文件的目的目录。相应的，用户可以通过 getFileClassPaths()和getArchivesClassPaths()方法获取被添加到任务的类路径下的文件和文档。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;下面我们仍然以前面的气象站数据和天气记录数据为例，使用分布式缓存 API，完成两个数据集的连接操作。完整的 MapReduce 程序如下所示。</p> 
   <pre><code class="language-html">import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.URI;
import java.util.Hashtable;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.conf.Configured;
import org.apache.hadoop.fs.FSDataInputStream;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mapreduce.Reducer;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
import org.apache.hadoop.util.Tool;
import org.apache.hadoop.util.ToolRunner;

public class JoinRecordWithStationName extends Configured implements Tool {

	public static class TemperatureMapper extends
			Mapper<span class="hljs-tag" style="color:rgb(0,0,255);">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);">LongWritable, <span class="hljs-attribute">Text, <span class="hljs-attribute">Text, <span class="hljs-attribute">Text&gt; { public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException { String[] arr = value.toString().split("\t", 2); if (arr.length == 2) { context.write(new Text(arr[0]), value); } } } public static class TemperatureReducer extends Reducer<span class="hljs-tag" style="color:rgb(0,0,255);">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);">Text, <span class="hljs-attribute">Text, <span class="hljs-attribute">Text, <span class="hljs-attribute">Text&gt; { private Hashtable<span class="hljs-tag" style="color:rgb(0,0,255);">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);">String, <span class="hljs-attribute">String&gt; table = new Hashtable<span class="hljs-tag" style="color:rgb(0,0,255);">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);">String, <span class="hljs-attribute">String&gt;();//定义Hashtable存放缓存数据 /** * 获取分布式缓存文件 */ protected void setup(Context context) throws IOException, InterruptedException { Path[] localPaths = (Path[]) context.getLocalCacheFiles();//返回本地文件路径 if (localPaths.length == 0) { throw new FileNotFoundException( "Distributed cache file not found."); } FileSystem fs = FileSystem.getLocal(context.getConfiguration());//获取本地 FileSystem 实例 FSDataInputStream in = null; in = fs.open(new Path(localPaths[0].toString()));// 打开输入流 BufferedReader br = new BufferedReader(new InputStreamReader(in));// 创建BufferedReader读取器 String infoAddr = null; while (null != (infoAddr = br.readLine())) {// 按行读取并解析气象站数据 String[] records = infoAddr.split("\t"); table.put(records[0], records[1]);//key为stationID，value为stationName } } public void reduce(Text key, Iterable<span class="hljs-tag" style="color:rgb(0,0,255);">&lt; <span class="hljs-attribute" style="color:rgb(163,21,21);">Text&gt; values, Context context) throws IOException, InterruptedException { String stationName = table.get(key.toString());//天气记录根据stationId 获取stationName for (Text value : values) { context.write(new Text(stationName), value); } } } @Override public int run(String[] args) throws Exception { // TODO Auto-generated method stub Configuration conf = new Configuration(); FileSystem hdfs = FileSystem.get(new URI( "hdfs://single.hadoop.dajiangtai.com:9000"), conf); Path out = new Path(args[1]); if (hdfs.isDirectory(out)) { hdfs.delete(out, true); } Job job = Job.getInstance();//获取一个job实例 job.setJarByClass(JoinRecordWithStationName.class); FileInputFormat.addInputPath(job, new org.apache.hadoop.fs.Path(args[0])); FileOutputFormat.setOutputPath(job, new org.apache.hadoop.fs.Path( args[1])); //添加分布式缓存文件 station.txt job.addCacheFile(new URI("hdfs://HadoopMaster:9000/middle/temperature/station.txt")); job.setMapperClass(TemperatureMapper.class); job.setReducerClass(TemperatureReducer.class); job.setOutputKeyClass(Text.class);// 输出key类型 job.setOutputValueClass(Text.class);// 输出value类型 return job.waitForCompletion(true)?0:1; } public static void main(String[] args) throws Exception { String[] arg = { "hdfs://HadoopMaster:9000/middle/temperature/records.txt", "hdfs://HadoopMaster:9000/middle/temperature/out/" }; int ec = ToolRunner.run(new Configuration(), new JoinRecordWithStationName(), arg); System.exit(ec); } }</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; &nbsp;添加分布式缓存文件相对简单，只需使用job.addCacheFile(new URI(cacheFilePath))方法添加缓存文件即可。需要注意的是，在获取获取缓存文件时，文件将以 “本地的” Path 对象的形式返回。为了读取文件，用户需要首先使用 getLocal()方法获得一个 Hadoop 本地 FileSystem 实例。本程序中，我们在 Reduce 的 setup() 方法中获取缓存文件。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以下是示例数据集的输出结果，达到我们预期的效果。</p> 
   <pre><code class="language-html">SIHCCAJAVRI	011990-99999	195005151800	-11
SIHCCAJAVRI	011990-99999	195005151200	22
SIHCCAJAVRI	011990-99999	195005150700	0
TRNSET-HANSMOEN	012650-99999	194903241800	78
TRNSET-HANSMOEN	012650-99999	194903241200	111<br><br></code></pre> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212225517354-169188995.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212225524495-1732819065.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212225531448-2058458414.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212225539917-1039131127.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212225548776-1148785853.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212225558151-1593551155.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212225606308-437964449.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212225613198-539212675.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong>&nbsp;得到结果</strong></span></p> 
   <pre><code class="language-html">SIHCCAJAVRI	011990-99999	195005151800	-11
SIHCCAJAVRI	011990-99999	195005151200	22
SIHCCAJAVRI	011990-99999	195005150700	0
TRNSET-HANSMOEN	012650-99999	194903241800	78
TRNSET-HANSMOEN	012650-99999	194903241200	111</code></pre> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong><span style="color:rgb(0,0,255);">&nbsp;代码版本1</span></strong></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.util.Set;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br> import java.io.*;<br> import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.io.WritableComparable;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class TextPair implements WritableComparable&lt;TextPair&gt;<br> {<br> private Text first; //Text 类型的实例变量first<br> private Text second;//Text 类型的实例变量second<br><br> public TextPair() //无参构造方法<br> {<br> set(new Text(),new Text());<br> }<br> public TextPair(String first,String second) // Sting类型参数的构造方法<br> {<br> set(new Text(first),new Text(second));<br> }<br> public TextPair(Text first,Text second) // Text类型参数的构造方法<br> {<br> set(first,second);<br> }<br> public void set(Text first,Text second) //set方法<br> {<br> this.first=first;<br> this.second=second;<br> }<br> public Text getFirst() //getFirst方法<br> {<br> return first;<br> }<br> public Text getSecond() //getSecond方法<br> {<br> return second;<br> }<br><br> //将对象转换为字节流并写入到输出流out中<br> public void write(DataOutput out) throws IOException //write方法<br> {<br> first.write(out);<br> second.write(out);<br> }<br><br> //从输入流in中读取字节流反序列化为对象<br> public void readFields(DataInput in) throws IOException //readFields方法<br> {<br> first.readFields(in);<br> second.readFields(in);<br> }<br><br> @Override<br> public int hashCode() //在mapreduce中，通过hashCode来选择reduce分区<br> {<br> return first.hashCode() *163+second.hashCode();<br> }<br><br> @Override<br> public boolean equals(Object o) //equals方法，这里是两个对象的内容之间比较<br> {<br> if (o instanceof TextPair)<br> {<br> TextPair tp=(TextPair) o;<br> return first.equals(tp.first) &amp;&amp; second.equals(tp.second);<br> }<br> return false;<br> }<br><br> @Override<br> public String toString() //toString方法<br> {<br> return first +"\t"+ second;<br> }<br> public int compareTo(TextPair o)<br> {<br> // TODO Auto-generated method stub<br> if(!first.equals(o.first))<br> {<br> return first.compareTo(o.first);<br> }<br> else if(!second.equals(o.second))<br> {<br> return second.compareTo(o.second);<br> }<br> return 0;<br> }<br></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">}</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.IOException;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br> import org.apache.hadoop.io.LongWritable;<br> import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.mapreduce.Mapper;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import zhouls.bigdata.myMapReduce.Join.TextPair;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class JoinStationMapper extends Mapper&lt;LongWritable,Text,TextPair,Text&gt;<br> {&nbsp;<br> protected void map(LongWritable key,Text value,Context context) throws IOException,InterruptedException<br> {<br> String line = value.toString();<br> String[] arr = line.split("\\s+");//解析气象站数据<br> int length = arr.length;<br> if(length==2)<br> {//满足这种数据格式<br> //key=气象站id value=气象站名称<br> System.out.println("station="+arr[0]+"0");<br> context.write(new TextPair(arr[0],"0"),new Text(arr[1]));<br> }<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.IOException;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.util.Iterator;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.mapreduce.Reducer;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class JoinReducer extends Reducer&lt; TextPair,Text,Text,Text&gt;<br> {<br> protected void reduce(TextPair key, Iterable&lt; Text&gt; values,Context context) throws IOException,InterruptedException<br> {<br> Iterator&lt; Text&gt; iter = values.iterator();<br> Text stationName = new Text(iter.next());//气象站名称<br> while(iter.hasNext()){<br> Text record = iter.next();//天气记录的每条数据<br> Text outValue = new Text(stationName.toString()+"\t"+record.toString());<br> context.write(key.getFirst(),outValue);<br> }<br> }&nbsp;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.IOException;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import org.apache.hadoop.io.LongWritable;<br> import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.mapreduce.Mapper;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class JoinRecordMapper extends Mapper&lt; LongWritable,Text,TextPair,Text&gt;<br> {&nbsp;<br> protected void map(LongWritable key,Text value,Context context) throws IOException,InterruptedException<br> {<br> String line = value.toString();<br> String[] arr = line.split("\\s+",2);//解析天气记录数据<br> int length = arr.length;<br> if(length==2){<br> //key=气象站id value=天气记录数据<br> context.write(new TextPair(arr[0],"1"),new Text(arr[1]));<br> }&nbsp;<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.BufferedReader;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.FileNotFoundException;<br> import java.io.IOException;<br> import java.io.InputStreamReader;<br> import java.net.URI;<br> import java.util.Hashtable;<br> import org.apache.hadoop.conf.Configuration;<br> import org.apache.hadoop.conf.Configured;<br> import org.apache.hadoop.fs.FSDataInputStream;<br> import org.apache.hadoop.fs.FileSystem;<br> import org.apache.hadoop.fs.Path;<br> import org.apache.hadoop.io.LongWritable;<br> import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.mapreduce.Job;<br> import org.apache.hadoop.mapreduce.Mapper;<br> import org.apache.hadoop.mapreduce.Reducer;<br> import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<br> import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<br> import org.apache.hadoop.util.Tool;<br> import org.apache.hadoop.util.ToolRunner;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class JoinRecordWithStationName extends Configured implements Tool&nbsp;<br> {<br> public static class TemperatureMapper extends Mapper&lt; LongWritable, Text, Text, Text&gt;<br> {<br> public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException&nbsp;<br> {<br> String[] arr = value.toString().split("\t", 2);<br> if (arr.length == 2)&nbsp;<br> {<br> context.write(new Text(arr[0]), value);<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">}<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public static class TemperatureReducer extends Reducer&lt; Text, Text, Text, Text&gt;&nbsp;<br> {<br> private Hashtable&lt; String, String&gt; table = new Hashtable&lt; String, String&gt;();//定义Hashtable存放缓存数据<br><br> /**<br> * 获取分布式缓存文件<br> */<br> protected void setup(Context context) throws IOException,<br> InterruptedException<br> {<br> Path[] localPaths = (Path[]) context.getLocalCacheFiles();//返回本地文件路径&nbsp;<br> if (localPaths.length == 0)&nbsp;<br> {<br> throw new FileNotFoundException("Distributed cache file not found.");<br> }<br> FileSystem fs = FileSystem.getLocal(context.getConfiguration());//获取本地 FileSystem 实例<br> FSDataInputStream in = null;<br><br> in = fs.open(new Path(localPaths[0].toString()));// 打开输入流<br> BufferedReader br = new BufferedReader(new InputStreamReader(in));// 创建BufferedReader读取器<br> String infoAddr = null;<br> while (null != (infoAddr = br.readLine()))<br> {// 按行读取并解析气象站数据<br> String[] records = infoAddr.split("\t");<br> table.put(records[0], records[1]);//key为stationID，value为stationName<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public void reduce(Text key, Iterable&lt; Text&gt; values, Context context)<br> throws IOException, InterruptedException&nbsp;<br> {<br> String stationName = table.get(key.toString());//天气记录根据stationId 获取stationName<br> for (Text value : values)<br> {<br> context.write(new Text(stationName), value);<br> }<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public int run(String[] args) throws Exception<br> {<br> // TODO Auto-generated method stub<br> Configuration conf = new Configuration();</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">// FileSystem hdfs = FileSystem.get(new URI("hdfs://HadoopMaster:9000"), conf);<br> // Path out = new Path(args[1]);<br> // if (hdfs.isDirectory(out))&nbsp;<br> // {<br> // hdfs.delete(out, true);<br> // }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Job job = Job.getInstance();//获取一个job实例<br> job.setJarByClass(JoinRecordWithStationName.class);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">// FileInputFormat.addInputPath(job,<br> // new org.apache.hadoop.fs.Path(args[0]));<br> // FileOutputFormat.setOutputPath(job, new org.apache.hadoop.fs.Path(args[1]));<br><br><br> FileInputFormat.addInputPath(job,<br> new org.apache.hadoop.fs.Path("./data/join/station.txt"));<br> FileOutputFormat.setOutputPath(job, new org.apache.hadoop.fs.Path("./out/join/"));<br><br> //添加分布式缓存文件 station.txt<br> // job.addCacheFile(new URI("hdfs://HadoopMaster:9000/join/station.txt"));<br> job.addCacheFile(new URI("./data/join/station.txt"));<br><br><br> job.setMapperClass(TemperatureMapper.class);<br> job.setReducerClass(TemperatureReducer.class);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">job.setOutputKeyClass(Text.class);// 输出key类型<br> job.setOutputValueClass(Text.class);// 输出value类型</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">return job.waitForCompletion(true)?0:1;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public static void main(String[] args) throws Exception&nbsp;<br> {<br> // String[] arg = {<br> // "hdfs://HadoopMaster:9000/join/records.txt",<br> // "hdfs://HadoopMaster:9000/join/out/" };<br> // <br> String[] arg = {<br> "./data/join/records.txt",<br> "./out/join/" };<br><br><br> int ec = ToolRunner.run(new Configuration(),new JoinRecordWithStationName(), arg);<br> System.exit(ec);<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class JoinRecordAndStationName<br> {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">/**<br> * @param args<br> */<br> public static void main(String[] args)&nbsp;<br> {<br> // TODO Auto-generated method stub</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">}</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">}</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong><span style="color:rgb(0,0,255);">代码版本2</span></strong></span>&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.util.Set;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br> import java.io.*;<br> import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.io.WritableComparable;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class TextPair implements WritableComparable&lt;TextPair&gt;<br> {<br> private Text first; //Text 类型的实例变量first<br> private Text second;//Text 类型的实例变量second<br><br> public TextPair() //无参构造方法<br> {<br> set(new Text(),new Text());<br> }<br> public TextPair(String first,String second) // Sting类型参数的构造方法<br> {<br> set(new Text(first),new Text(second));<br> }<br> public TextPair(Text first,Text second) // Text类型参数的构造方法<br> {<br> set(first,second);<br> }<br> public void set(Text first,Text second) //set方法<br> {<br> this.first=first;<br> this.second=second;<br> }<br> public Text getFirst() //getFirst方法<br> {<br> return first;<br> }<br> public Text getSecond() //getSecond方法<br> {<br> return second;<br> }<br><br> //将对象转换为字节流并写入到输出流out中<br> public void write(DataOutput out) throws IOException //write方法<br> {<br> first.write(out);<br> second.write(out);<br> }<br><br> //从输入流in中读取字节流反序列化为对象<br> public void readFields(DataInput in) throws IOException //readFields方法<br> {<br> first.readFields(in);<br> second.readFields(in);<br> }<br><br> @Override<br> public int hashCode() //在mapreduce中，通过hashCode来选择reduce分区<br> {<br> return first.hashCode() *163+second.hashCode();<br> }<br><br> @Override<br> public boolean equals(Object o) //equals方法，这里是两个对象的内容之间比较<br> {<br> if (o instanceof TextPair)<br> {<br> TextPair tp=(TextPair) o;<br> return first.equals(tp.first) &amp;&amp; second.equals(tp.second);<br> }<br> return false;<br> }<br><br> @Override<br> public String toString() //toString方法<br> {<br> return first +"\t"+ second;<br> }<br> public int compareTo(TextPair o)<br> {<br> // TODO Auto-generated method stub<br> if(!first.equals(o.first))<br> {<br> return first.compareTo(o.first);<br> }<br> else if(!second.equals(o.second))<br> {<br> return second.compareTo(o.second);<br> }<br> return 0;<br> }<br></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">}</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.IOException;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br> import org.apache.hadoop.io.LongWritable;<br> import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.mapreduce.Mapper;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import zhouls.bigdata.myMapReduce.Join.TextPair;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class JoinStationMapper extends Mapper&lt;LongWritable,Text,TextPair,Text&gt;<br> {&nbsp;<br> protected void map(LongWritable key,Text value,Context context) throws IOException,InterruptedException<br> {<br> String line = value.toString();<br> String[] arr = line.split("\\s+");//解析气象站数据<br> int length = arr.length;<br> if(length==2)<br> {//满足这种数据格式<br> //key=气象站id value=气象站名称<br> System.out.println("station="+arr[0]+"0");<br> context.write(new TextPair(arr[0],"0"),new Text(arr[1]));<br> }<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.IOException;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.util.Iterator;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.mapreduce.Reducer;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class JoinReducer extends Reducer&lt; TextPair,Text,Text,Text&gt;<br> {<br> protected void reduce(TextPair key, Iterable&lt; Text&gt; values,Context context) throws IOException,InterruptedException<br> {<br> Iterator&lt; Text&gt; iter = values.iterator();<br> Text stationName = new Text(iter.next());//气象站名称<br> while(iter.hasNext()){<br> Text record = iter.next();//天气记录的每条数据<br> Text outValue = new Text(stationName.toString()+"\t"+record.toString());<br> context.write(key.getFirst(),outValue);<br> }<br> }&nbsp;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.IOException;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import org.apache.hadoop.io.LongWritable;<br> import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.mapreduce.Mapper;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class JoinRecordMapper extends Mapper&lt; LongWritable,Text,TextPair,Text&gt;<br> {&nbsp;<br> protected void map(LongWritable key,Text value,Context context) throws IOException,InterruptedException<br> {<br> String line = value.toString();<br> String[] arr = line.split("\\s+",2);//解析天气记录数据<br> int length = arr.length;<br> if(length==2){<br> //key=气象站id value=天气记录数据<br> context.write(new TextPair(arr[0],"1"),new Text(arr[1]));<br> }&nbsp;<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">//版本2<br> package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.InputStream;<br> import org.apache.hadoop.util.Tool;<br> import java.io.OutputStream;<br> import java.util.Set;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import javax.lang.model.SourceVersion;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import org.apache.hadoop.conf.Configuration;<br> import org.apache.hadoop.conf.Configured;<br> import org.apache.hadoop.fs.FileSystem;<br> import org.apache.hadoop.fs.Path;<br> import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.io.WritableComparable;<br> import org.apache.hadoop.io.WritableComparator;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import org.apache.hadoop.mapreduce.Job;<br> import org.apache.hadoop.mapreduce.Partitioner;<br> import org.apache.hadoop.mapreduce.lib.input.MultipleInputs;<br> import org.apache.hadoop.mapreduce.lib.input.TextInputFormat;<br> import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<br> import org.apache.hadoop.util.ToolRunner;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class JoinRecordWithStationName extends Configured implements Tool<br> {<br> public static class KeyPartitioner extends Partitioner&lt; TextPair,Text&gt;<br> {<br><br> public int getPartition(TextPair key,Text value,int numPartitions)<br> {<br> return (key.getFirst().hashCode()&amp;Integer.MAX_VALUE) % numPartitions;<br> }<br> }<br><br> public static class GroupingComparator extends WritableComparator<br> {<br> protected GroupingComparator()<br> {<br> super(TextPair.class,true);<br> }<br> @Override<br> public int compare(WritableComparable w1,WritableComparable w2)<br> {<br> TextPair ip1=(TextPair) w1;<br> TextPair ip2=(TextPair) w2;<br> Text l=ip1.getFirst();<br> Text r=ip2.getFirst();<br> return l.compareTo(r);<br><br> }&nbsp;<br> }<br> public int run(String[] args) throws Exception<br> {<br> Configuration conf = new Configuration();// 读取配置文件<br><br> Path mypath=new Path(args[2]);<br> FileSystem hdfs=mypath.getFileSystem(conf);<br> if (hdfs.isDirectory(mypath))<br> {<br> hdfs.delete(mypath,true);<br> }<br><br> Job job = Job.getInstance(conf,"join");// 新建一个任务<br> job.setJarByClass(JoinRecordWithStationName.class);// 主类<br><br> Path recordInputPath = new Path(args[0]);//天气记录数据源，这里是牵扯到多路径输入和多路径输出的问题。默认是从args[0]开始<br> Path stationInputPath = new Path(args[1]);//气象站数据源<br> Path outputPath = new Path(args[2]);//输出路径<br><br> //若只有一个输入和一个输出，则输入是args[0]，输出是args[1]。<br> //若有两个输入和一个输出，则输入是args[0]和args[1]，输出是args[2]<br><br> MultipleInputs.addInputPath(job,recordInputPath,TextInputFormat.class,JoinRecordMapper.class);//读取天气记录Mapper<br> MultipleInputs.addInputPath(job,stationInputPath,TextInputFormat.class,JoinStationMapper.class);//读取气象站Mapper<br> FileOutputFormat.setOutputPath(job,outputPath);<br> job.setReducerClass(JoinReducer.class);// Reducer<br> job.setNumReduceTasks(2);<br><br> job.setPartitionerClass(KeyPartitioner.class);//自定义分区<br> job.setGroupingComparatorClass(GroupingComparator.class);//自定义分组<br><br> job.setMapOutputKeyClass(TextPair.class);<br> job.setMapOutputValueClass(Text.class);<br><br> job.setOutputKeyClass(Text.class);<br> job.setOutputValueClass(Text.class);<br><br> return job.waitForCompletion(true)?0:1;<br> }<br><br> public static void main(String[] args) throws Exception<br> {<br> String[] args0={"hdfs://HadoopMaster:9000/join/records.txt"<br> ,"hdfs://HadoopMaster:9000/join/station.txt"<br> ,"hdfs://HadoopMaster:9000/join/out"<br> };<br> int exitCode=ToolRunner.run( new JoinRecordWithStationName(), args0);<br> System.exit(exitCode);<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.Join;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class JoinRecordAndStationName<br> {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">/**<br> * @param args<br> */<br> public static void main(String[] args)&nbsp;<br> {<br> // TODO Auto-generated method stub</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">}</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">}</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p><font><span style="font-size:14px;">本文转自大数据躺过的坑博客园博客，原文链接：http://www.cnblogs.com/zlslch/p/6166343.html，如需转载请自行联系原作者</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
