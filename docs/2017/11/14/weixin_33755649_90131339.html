<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>利用Webbrowser类实现超长网页的截屏的实现（解决报错不能截取的难题） « NotBeCN</title>
  <meta name="description" content="             之前写过一篇文章，说是解决了超长网页截图的问题。但是实际上，现实是很残酷的，试图截取一个网页的时候就出了问题    网址如下：    http://www.cnblogs.com/grenet/archive/2012/09/05/2664309.html    截这个网页图的时候，总是...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/14/weixin_33755649_90131339.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">利用Webbrowser类实现超长网页的截屏的实现（解决报错不能截取的难题）</h1>
    <p class="post-meta">Nov 14, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">之前写过一篇文章，说是解决了超长网页截图的问题。但是实际上，现实是很残酷的，试图截取一个网页的时候就出了问题</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">网址如下：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><a title="http://www.cnblogs.com/grenet/archive/2012/09/05/2664309.html" href="http://www.cnblogs.com/grenet/archive/2012/09/05/2664309.html" rel="nofollow" style="color:rgb(7,93,179);">http://www.cnblogs.com/grenet/archive/2012/09/05/2664309.html</a></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">截这个网页图的时候，总是报错，说是无效的参数</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">后来分析代码发现，这个网页的大小为1024px*81175px。当时，一激灵，立刻想到是不是太长了，超过系统的默认范围。查了资料后，在MSDN上有一处说到GDI+的bitmap对象在保存为PNG格式的时候，单维不能超过65536，但是并没有说其它格式也有类似的局限。于是，自已做了一个实验，构造一个bitmap对象，大小1024px*80000px，保存为PNG格式，系统报错；保存为JPG格式，系统报错；保存为bmp格式，系统没有报错，但是在其他的软件中不能打开。于是，笔者坚信一点</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>GDI+中的bitmap对象处理的单维不能超过65526</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">很显然，上面的网址，用GDI+来截取的话，肯定是不能截取到一张图片上了</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">有一点，在机器上用FF浏览器浏览网页，发现右上角有一个“网页截图”的插件，于是尝试用FF截取上面的网址，发现丝毫没有反映。笔者尝试截取其他的网址以证实不是笔者自己的误操作问题，其他网页截取正常。说明了一点</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>截取超长网页（长度超过65536）是个难题</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">于是，反思自己截图的意图。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">为何要截图？截图是为了保存网页，以便日后再看，避免网址失效的尴尬。那有的人就会说，没和不保存网页（MHT格式或其他格式）。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">保存网页或多或少都有各种问题</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">用IE保存网页的时候，Flash只是保存链接地址，而不是保存swf文件</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">有的网页中的内容是通过JS用Ajax方式后台读取呈现，这部分在保存网页的时候，仅仅保存了JS代码，而没有保存JS用Ajax方式后台读取的内容</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">有的网页在JS中再动态调用CSS或其他的JS代码，这部分在保存网页的时候，也仅仅是保存了JS代码，而动态调用的CSS和JS代码什么的都没有保存</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">上述这些情况，都是以保存链接地址的形式（swf地址或者是JS地址）出现的</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">在日后浏览的时候，如果是在一台没有联网的机器上，会出现两种情况。一是：由于保存了链接地址，于是会尝试读取这些地址，而这些地址又没法读取（没联网或者是链接地址失效），则会导致长时间的假死状态（尤其以IE保存的网页为甚）；二是：由于缺失部分的文件（swf文件、CSS文件、JS文件等），导致页面的结构出现了变形（甚至是无法忍受的地步）。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">这也就是为什么要截图的原因，图是静止的，不会出现上述的情况</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><strong>还是要截图的，截超长网页的图的一种办法就是分开截图，截成若干个图</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">于是把之前的代码改写一下，把原来多次截图，后覆写到一张图片，改写为多次截图，把多个bitmap对象存入到一个对象</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">于是信心满满的尝试文章开始的网址，天啊，还是报错</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">在截超长网页的时候，在截60000+这部分的时候，Webbrowser类的DrawToBitmap函数就会报错，说是无效的参数。无效的参数？没道理呀，若是参数无效，在截0+和20000+的时候就会报错，怎么会到60000+的时候报错呢？而且是每次到60000+都会报错，排除了系统随机性错误的问题（有时在截一些网页的时候，也会报参数无效的错误，但是重启软件后，就不会报错）</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">突然有一个想法，会不会是Webbrowser类的DrawToBitmap方法有资源没有释放，在同一个Webbrowser的实例中的DrawToBitmap方法执行完后，没有释放资源，所以当上面的代码尝试截取60000+的时候，超过了DrawToBitmap方法的资源限制，于是报了错误。如果能尝试释放DrawToBitmap方法所占的资源是不是就可以呢？在网上找了一圈后，没有发现释放DrawToBitmap方法所占的资源的问题。这真是一个超级难题了。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">有一个笨办法涌上心头。一个Webbrowser实例不能解决超长网页的截图问题，多个Webbrowser实例能不能解决该问题呢？将一个网页分成几个部分，每个部分分给一个Webbrowser实例去截图，最后将这些截图再存入到一个对象。这样做的优点是：如果成功，解决了超长网页的截图问题；缺点是：每个部分都分给一个Webbrowser类的实例去截图，每个实例都需要访问同一个网址，造成了重复访问，形成了资源浪费。不过，目前最重要的是<strong>实现超长网页的截图。</strong></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">于是，修改代码。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">进行截图实验。嗯。这样终于成功了。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">下面是修改后代码。由于功能上的需要，我对代码进行了扩展</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureWebSettings</span><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;Url&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;TimeOut&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;Width&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;Delay&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;HtmlElementID()&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>&nbsp;= {}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>(Url&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;Delay&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 15,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;TimeOut&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 180,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;Width&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 1024)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Url = Url&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.TimeOut = TimeOut&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Width = Width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Delay = Delay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.HtmlElementID = {}&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>(Url&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>, ID&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;Delay&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 15,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;TimeOut&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 180,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;Width&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 1024)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tS(0)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tS(0) = ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Url = Url&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.TimeOut = TimeOut&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Width = Width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Delay = Delay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.HtmlElementID = tS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>(Url&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>, ID()&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;Delay&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 15,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;TimeOut&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 180,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Optional</span>&nbsp;Width&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 1024)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Url = Url&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.TimeOut = TimeOut&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Width = Width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.Delay = Delay&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.HtmlElementID = ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span><br><br><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span><br></font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span class="cf2" style="color:rgb(43,145,175);line-height:1.5;"><font color="#000000">clsCaptureWebSettings</font></span>类，截取网页的参数类，有如下的几个参数：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">URL</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">网页截图的网址。注：有些网页要提供Cookies或者是Session才能访问，这部分目前还没有做到。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">Delay</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">网页截图的延迟。由于有部分网页会利用AJAX技术填充内容，而Webbrowser类又不能很好的判断AJAX技术的结束时刻，故统一一个延迟时间，等延迟时间结束以后再截图。默认是15秒。注：由于有的超长网页会交给几个Webbrowser类截图，每个Webbrowser类的延迟时间都是由Delay决定的，故在截超长网页的时候，会显得比较漫长，但是用了Delay参数以后，截图的效果好了很多。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">TimeOut</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">网页截图的超时。在访问某些网站的时候，由于种种原因，导致访问失败。设置这个参数避免在访问失败的时候，程序陷入假死情况。默认是180秒</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">Width</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">网页截图的宽度。由于网页的布局都是竖式布局，故先指定宽度，再截图。默认是1024，现今的网页基本上都兼容1024的宽度</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">HtmlElementID</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">网页截图中的目标ID。我们在截网页的时候，有时特别想只截其中的一部分（例如，不想截取包含广告的部分），我们可以提供网页上的元素的ID，返回该元素在网页上的位置（Rectangle结构）。该参数是字符串的数组，数组中每个元素就是网页上元素的ID。注意：程序中只返回能找到的元素的位置，如果没有找到，则直接忽略掉</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureImages</span><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;_Bmp&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;_Rect&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Dictionary</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;_HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.New(20000)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>(HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _HeightPerImage = HeightPerImage&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Bmp =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Rect =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Dictionary</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;AddBitmap(Bmp&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Bmp.Add(Bmp)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;AddRect(ID&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>, R&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Rect.ContainsKey(ID) =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">True</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Rect(ID) = R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Else</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Rect.Add(ID, R)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;ImageRect()&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Bmp.Count = 0&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>(0, 0, 0, 0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;Width&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= _Bmp(0).Width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;Height&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= _HeightPerImage * (_Bmp.Count - 1) + _Bmp(_Bmp.Count - 1).Height&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>(0, 0, Width, Height)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;GetRectImage(R&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tB&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>(R.Width, R.Height)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Using</span>&nbsp;tG&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Graphics</span>&nbsp;=&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Graphics</span>.FromImage(tB)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;I&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= Int(R.Y / _Bmp(0).Height)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;J&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= Int((R.Bottom - 1) / _Bmp(0).Height)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;K&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;I = J&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; R.Y = R.Y&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Mod</span>&nbsp;_Bmp(0).Height&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tG.DrawImage(_Bmp(I), 0, 0, R,&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">GraphicsUnit</span>.Pixel)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Else</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tR&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>&nbsp;= R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Y = tR.Y&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Mod</span>&nbsp;_Bmp(0).Height&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Height = _Bmp(0).Height - tR.Y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tG.DrawImage(_Bmp(I), 0, 0, tR,&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">GraphicsUnit</span>.Pixel)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tTop&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= tR.Height&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">For</span>&nbsp;K = I + 1&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">To</span>&nbsp;J - 1&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Step</span>&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR = R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Y = 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Height = _Bmp(0).Height&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tG.DrawImage(_Bmp(K), 0, tTop, tR,&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">GraphicsUnit</span>.Pixel)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tTop += tR.Height&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Next</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR = R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Height = (tR.Bottom - 1)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Mod</span>&nbsp;_Bmp(0).Height + 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Y = 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tG.DrawImage(_Bmp(J), 0, tTop, tR,&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">GraphicsUnit</span>.Pixel)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Using</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;tB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(R&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>, HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tR&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>&nbsp;= ImageRect()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Bmp.Count = 0&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">OrElse</span>&nbsp;R.IntersectsWith(tR) =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">False</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; R.Intersect(tR)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;R.Equals(tR) =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">True</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">AndAlso</span>&nbsp;HeightPerImage = _HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_Bmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;RenderImageBase(R, HeightPerImage)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(R&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;RenderImage(R, _HeightPerImage)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Bmp.Count = 0&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;HeightPerImage = _HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_Bmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;RenderImageBase(ImageRect, HeightPerImage)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage()&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_Bmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImageBase(R&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>, HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tR&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>&nbsp;= R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Height = HeightPerImage&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;BmpList&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Do</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">While</span>&nbsp;R.IntersectsWith(tR) =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">True</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Intersect(R)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BmpList.Add(GetRectImage(tR))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Offset(0, HeightPerImage)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Loop</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;BmpList&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>, ID1&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Rect.ContainsKey(ID1) =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">False</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;RenderImage(_Rect(ID1), HeightPerImage)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(ID1&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Rect.ContainsKey(ID1) =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">False</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;RenderImage(_Rect(ID1), _HeightPerImage)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(ID1&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ParamArray</span>&nbsp;ID()&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;RenderImage(_HeightPerImage, ID1, ID)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>, ID1&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ParamArray</span>&nbsp;ID()&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;HasRect&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Boolean</span>&nbsp;=&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">False</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;R&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Rect.ContainsKey(ID1) =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">True</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HasRect =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">True</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; R = _Rect(ID1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;I&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">For</span>&nbsp;I = 0&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">To</span>&nbsp;ID.Length - 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Rect.ContainsKey(ID(I)) =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">True</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;HasRect =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">True</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; R =&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>.Union(R, _Rect(ID(I)))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Else</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HasRect =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">True</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; R = _Rect(ID(I))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Next</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;HasRect =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">False</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;RenderImage(R, HeightPerImage)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span><br><br><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span><br></font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">clsCaptureImages类，保存截图结果的类，由于超长网页不能截在一张图里，故用一个类保存截图的结果。并提供一些扩展的功能</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">AddBitmap方法</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;AddBitmap(Bmp&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)</font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">把截好的图片添加到类中</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">AddRect方法</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;AddRect(ID&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>, R&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>)</font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">把ID对应的位置Rectangle添加到类中</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">RenderImage函数，返回图像的集合。并可以根据某些参数定制图像集合。例如：只想获得某个Rectangle的范围的图像；只想获得某个ID的元素的图像；按照指定的高度划分图像集合等等。如果我把截图放在Word里的话，最好每张的图片的高度不超过1200</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">返回值：根据参数返回图像的集合List(Of Bitmap)</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">它有如下的几个重载方式：</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <font color="#000000" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:15px;"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage()&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)</font>
   <span style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:15px;"></span> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">不加修饰，直接把图像集合返回。默认的图像集合中的每张图像的高度是20000</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(R&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)</font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">返回指定区域R的截图图像集合。程序会先计算整个图像的范围（利用ImageRect函数），然后返回的是R和ImageRect交集的图像集合，按照默认的高度（20000）划分每张图片</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;"></span></font>&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;&nbsp;&nbsp;</font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">返回图像集合，每张图片的高度由HeightPerImage参数决定。这个在将来要把图像放在Word里特别有用。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(R&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>, HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;&nbsp;</font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">返回指定区域R的截图图像集合。程序会先计算整个图像的范围（利用ImageRect函数），然后返回的是R和ImageRect交集的图像集合，按照参数HeightPerImage指定的高度划分每张图片的高度</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(ID1&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)&nbsp;</font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">返回指定ID1的元素所在位置的截图图像集合。ID1所在的位置在之前的AddRect方法中添加到类中。如果没有找到ID1对应的位置，则返回空的集合。每张图像的高度由默认值（20000）决定</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>, ID1&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)</font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">返回指定ID1的元素所在位置的截图图像集合，每张图像的高度由HeightPerImage决定。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(ID1&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ParamArray</span>&nbsp;ID()&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)</font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">返回指定ID1和ID的元素所在位置的截图图像集合。如果所有的ID指定的位置都不存在，返回空集合，否则返回存在的ID所在位置的并集所在位置的图像集合。每张图像的高度由默认值（20000）决定</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;RenderImage(HeightPerImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>, ID1&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">ParamArray</span>&nbsp;ID()&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">List</span>(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Of</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>)</font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">返回指定ID1和ID的元素所在位置的截图图像集合。如果所有的ID指定的位置都不存在，返回空集合，否则返回存在的ID所在位置的并集所在位置的图像集合。每张图像的高度由HeightPerImage决定</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureWebEx</span>&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Shared</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;CaptureWebEx(Settings&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureWebSettings</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureImages</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;_Images&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureImages</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;I&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>, J&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Const</span>&nbsp;WEB_HEIGHT&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 20000&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; J = 0&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; J = CaptureWebEx(_Images, Settings, J)&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I = WEB_HEIGHT&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Do</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">While</span>&nbsp;I &lt; J&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CaptureWebEx(_Images, Settings, I)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I += WEB_HEIGHT&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Loop</span>&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_Images&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;<br><br><br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Shared</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;CaptureWebEx(_Images&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureImages</span>, _Settings&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureWebSettings</span>, _CapTop&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;_Bmp&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;_WebHeight&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;<br><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Const</span>&nbsp;WEB_HEIGHT&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;= 20000&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Using</span>&nbsp;_Web&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">WebBrowser</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Web.ScrollBarsEnabled =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">False</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Web.Width = _Settings.Width&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Web.Height = WEB_HEIGHT&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;_Time&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Date</span>&nbsp;= Now.AddSeconds(_Settings.Delay)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Web.Navigate(_Settings.Url)&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Do</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Until</span>&nbsp;Now &gt; _Time&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Application</span>.DoEvents()&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Loop</span>&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Time = Now.AddSeconds(_Settings.TimeOut - _Settings.Delay)&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Do</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Until</span>&nbsp;(_Web.ReadyState =&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">WebBrowserReadyState</span>.Complete)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">OrElse</span>&nbsp;(Now &gt; _Time)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Application</span>.DoEvents()&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Loop</span>&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Web.Stop()&nbsp;<br><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Web.Document.Body&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Is</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Nothing</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _WebHeight = 500&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Else</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _WebHeight = _Web.Document.Body.ScrollRectangle.Height&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_WebHeight &lt; 20000&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;_Web.Height = _WebHeight&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_CapTop = 0&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">AndAlso</span>&nbsp;_Settings.HtmlElementID.Length &gt; 0&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tHtml&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">HtmlElement</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tR&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">For</span>&nbsp;i = 0&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">To</span>&nbsp;_Settings.HtmlElementID.Length - 1&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Settings.HtmlElementID(i) &lt;&gt;&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">""</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tHtml = _Web.Document.GetElementById(_Settings.HtmlElementID(i))&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Not</span>&nbsp;tHtml&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Is</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Nothing</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR = tHtml.ScrollRectangle&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Do</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">While</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Not</span>&nbsp;(tHtml = _Web.Document.Body)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.X += tHtml.OffsetRectangle.X&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Y += tHtml.OffsetRectangle.Y&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tHtml = tHtml.Parent&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Loop</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Images.AddRect(_Settings.HtmlElementID(i), tR)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Next</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;R&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>&nbsp;=&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span>(0, 0, _Web.Width, _Web.Height)&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Web.Document.Window.Parent.ScrollTo(0, _CapTop)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Web.Document.Body.Parent.ScrollTop = _CapTop&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Bmp =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>(_Web.Width, _Web.Height)&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Web.DrawToBitmap(_Bmp, R)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Else</span>&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Web.Height = _Web.Height - (_CapTop - _Web.Document.Body.Parent.ScrollTop)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Web.Document.Window.Parent.ScrollTo(0, _CapTop)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Bmp =&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>(_Web.Width, _Web.Height)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; R.Height = _Web.Height&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Web.DrawToBitmap(_Bmp, R)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Using</span>&nbsp;<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Images.AddBitmap(_Bmp)&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Return</span>&nbsp;_WebHeight&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;<br><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Class</span>&nbsp;<br></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span class="cf2" style="color:rgb(43,145,175);line-height:1.5;"><font color="#000000">clsCaptureWebEx类，网页截图的核心类，根据</font><span class="cf2" style="line-height:1.5;"><font color="#000000">clsCaptureWebSettings类指定的参数截图，并把结果写入到</font><span class="cf2" style="line-height:1.5;"><font color="#000000">clsCaptureImages类</font></span></span></span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span class="cf2" style="color:rgb(43,145,175);line-height:1.5;"><span class="cf2" style="line-height:1.5;"><span class="cf2" style="line-height:1.5;"><font color="#000000">该类有两个函数，公有函数</font></span></span></span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><span class="cf2" style="color:rgb(43,145,175);line-height:1.5;"><span class="cf2" style="line-height:1.5;"><span class="cf2" style="line-height:1.5;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Public</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Shared</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;CaptureWebEx(Settings&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureWebSettings</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureImages</span></font></span></span></span></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">截图的主函数，根据参数截图，并把结果写入到结果类中</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">由于每个Webbrowser类的实例不能截超过60000的截图，故根据网页的高度多次调用私有函数CaptureWebEx，每调用一次，就截一次图</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">私有函数</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Shared</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Function</span>&nbsp;CaptureWebEx(_Images&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureImages</span>, _Settings&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureWebSettings</span>, _CapTop&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span></font></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">截图的具体负责函数，在该函数类有一个Webbrowser类的实例，从_CapTop参数指定的位置开始截一张图（每个Webbrowser类不能截太多的图），并把结果添加到_Images中，返回的是网页的高度</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">特别说明一下</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000"><span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_CapTop = 0&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">AndAlso</span>&nbsp;_Settings.HtmlElementID.Length &gt; 0&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tHtml&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">HtmlElement</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tR&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Rectangle</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">For</span>&nbsp;i = 0&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">To</span>&nbsp;_Settings.HtmlElementID.Length - 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;_Settings.HtmlElementID(i) &lt;&gt;&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">""</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tHtml = _Web.Document.GetElementById(_Settings.HtmlElementID(i))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Not</span>&nbsp;tHtml&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Is</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Nothing</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Then</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR = tHtml.ScrollRectangle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Do</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">While</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Not</span>&nbsp;(tHtml = _Web.Document.Body)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.X += tHtml.OffsetRectangle.X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tR.Y += tHtml.OffsetRectangle.Y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tHtml = tHtml.Parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Loop</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Images.AddRect(_Settings.HtmlElementID(i), tR)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Next</span><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">If</span><br> 这段代码的作用是获得网页上指定ID的位置Rectangle，由于在VS中，没办法直接获得ID元素的位置，</font>ScrollRectangle属性指的是和它父元素的相对位置。故采用递推的方式获得该元素对应的位置</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">下面是调用的代码，ID为topics是我的博客的博客正文的元素。这样截图只会截我的博客的正文，而其他的广告之类的就不会再截了。RenderImage函数的参数1125，是为了将来把图片放入到Word方便。&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Private</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span>&nbsp;Button1_Click(sender&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;System.<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Object</span>,&nbsp;e&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;System.<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">EventArgs</span>)&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Handles</span>&nbsp;Button1.Click<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;_WebImage&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureImages</span>&nbsp;=&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureWebEx</span>.CaptureWebEx(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">clsCaptureWebSettings</span>(txtURL.Text,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"topics"</span>))<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tB&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Bitmap</span>,&nbsp;I&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;=&nbsp;0,&nbsp;H&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Integer</span>&nbsp;=&nbsp;0<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Dim</span>&nbsp;tS&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">As</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">New</span>&nbsp;System.Text.<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">StringBuilder</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">For</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Each</span>&nbsp;tB&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">In</span>&nbsp;_WebImage.RenderImage(1125,&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"topics"</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tB.Save(<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">String</span>.Format(<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"tBmp{0}.png"</span>,&nbsp;I),&nbsp;System.Drawing.Imaging.<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">ImageFormat</span>.Png)<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tS.AppendFormat(<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"&lt;div&gt;&lt;img&nbsp;src='tBmp{0}.png'&nbsp;/&gt;&lt;/div&gt;"</span>,&nbsp;I)<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;+=&nbsp;1<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;+=&nbsp;tB.Height<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Next</span><br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">My</span>.Computer.FileSystem.WriteAllText(<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"tmp.html"</span>,&nbsp;tS.ToString,&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">False</span>)<br><br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Me</span>.WebBrowser1.Navigate(<span class="cf2" style="color:rgb(43,145,175);line-height:1.5;">Application</span>.StartupPath&nbsp;&amp;&nbsp;<span class="cf3" style="color:rgb(163,21,21);line-height:1.5;">"\tmp.html"</span>)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp;&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">End</span>&nbsp;<span class="cf1" style="color:rgb(0,0,255);line-height:1.5;">Sub</span><br></p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">&nbsp;</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">虽然速度上还是有点慢，不过截图的效果还是不错的。文章开篇的网址也能顺利的截取下来。着文以记之。</p> 
   <p style="line-height:1.5;font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;"><br></p> 
   <p style="line-height:1.5;"><font><span style="font-size:15px;">&nbsp; &nbsp; 本文转自万仓一黍博客园博客，原文链接：http://www.cnblogs.com/grenet/archive/2012/10/15/2715417.html</span></font><span style="font-size:15px;font-family:Verdana, Arial, Helvetica, sans-serif;">，如需转载请自行联系原作者</span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
