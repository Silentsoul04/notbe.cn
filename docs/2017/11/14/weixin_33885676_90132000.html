<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Hadoop MapReduce编程 API入门系列之查找相同字母组成的字谜（三） « NotBeCN</title>
  <meta name="description" content="             &nbsp;&nbsp;找出相同单词的所有单词。现在，是拿取部分数据集(如下)来完成本项目。        &nbsp;    &nbsp;    项目需求    　　一本英文书籍包含成千上万个单词或者短语，现在我们需要在大量的单词中，找出相同字母组成的所有anagrams(字谜)。  ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/14/weixin_33885676_90132000.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Hadoop MapReduce编程 API入门系列之查找相同字母组成的字谜（三）</h1>
    <p class="post-meta">Nov 14, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;找出相同单词的所有单词。现在，是拿取部分数据集(如下)来完成本项目。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226141802577-1601237395.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p align="left" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong>项目需求</strong></span></p> 
   <p align="left" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　一本英文书籍包含成千上万个单词或者短语，现在我们需要在大量的单词中，<span style="font-size:18px;"><strong><span style="color:rgb(0,0,255);">找出相同字母组成的所有anagrams(字谜)</span></strong></span>。</p> 
   <p align="left" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <h3 style="font-size:16px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;"><span style="font-size:18pt;">思路分析</span></h3> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　基于以上需求，我们通过以下几步完成：</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　　　1、在 Map 阶段，对每个word（单词）按字母进行排序生成sortedWord，然后输出key/value键值对(sortedWord,word)。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　　　2、在 Reduce 阶段，统计出每组相同字母组成的所有anagrams(字谜)。</p> 
   <p align="left" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p align="left" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p align="left" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　<strong><span style="color:rgb(0,0,255);">　1 、首先，打开MyEclipse,</span></strong></p> 
   <p align="left" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　在com.dajiangtai.hadoop.test包下，新建Anagram类。添加main方法。</p> 
   <p align="left" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226141829093-582724228.png" alt="" style="border:0px;"></p> 
   <p align="left" style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　<strong><span style="color:rgb(0,0,255);">2 、在如下文件夹下，新建anagram文件夹</span></strong></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226141852312-2094171072.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　<strong><span style="color:rgb(0,0,255);">3、 上传数据源anagram.txt</span></strong></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　在anagram文件夹的位置，右键，upload fles to DFS，</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142056312-109922276.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142113296-1325587241.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　<strong><span style="color:rgb(0,0,255);">　4 、编写Anagram.java里的代码。</span></strong></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="color:rgb(0,0,255);">　　</span></strong>见如下的*************Anagram.java******************</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　代码编写完成后，然后就可以进行Run as -&gt;&nbsp; 1 java application 。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　刷新后，如下。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142139546-1006367530.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142232671-1669568725.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　<strong><span style="color:rgb(0,0,255);">5 、接下来，点击part-r-00000(186.1 kb,r3)</span></strong>，则出现。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142256281-655533703.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　那么，此刻，在本地上已经成功运行。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　6 、现在，需要到集群上去成功运行，这该怎么做呢？</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　Hadoop&nbsp;&nbsp; -&gt;&nbsp;&nbsp; Export&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp; Export， &nbsp;&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142321640-2076876118.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　Java&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp; JAR&nbsp; file　　-&gt;&nbsp;&nbsp; next&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142414249-1999742116.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　7 、因为，在hadoop里，这些依赖的架包是存在的，所以我们就不需要再多此一举再打包了。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　为架包取一个名称，为anagram.jar，先在D盘新建文件夹JAR，存放在D:\JAR\anagram.jar,点击finish。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142507406-1774317013.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142833796-1455144729.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　8、 接下来，用xshell来连接CentOS。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142902968-977487217.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226142927343-801133137.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　9 、rz，打开D:\JAR\anagram.jar ，上传至CentOS</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226143228187-1019297949.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226143254656-2005202076.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226143319327-1088794369.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　10、执行命令</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong><span style="color:rgb(0,0,255);">　　hadoop &nbsp;jar &nbsp;anagram.jar &nbsp;com.dajiangtai.hadoop.test.Anagram&nbsp; /anagram/ &nbsp;/anagram/out/</span></strong></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226143359484-1626399292.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226143421984-691598302.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　　11、 查看结果</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><strong>　<span style="color:rgb(0,0,255);">　hadoop &nbsp;fs &nbsp;-text &nbsp;/anagram/out/part-r-00000</span></strong></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201512/855959-20151226143452624-1148658511.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">***********************************anagram.txt************************************</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">a
aah
aahed
aahing
aahs
aardvark
aardvarks
aardwolf
ab
abaci
aback

bents
bentwood
bentwoods
benumb

citers
cites
cithara
cithern
citherns
cithers
citicorp

dovecote
dovecotes
dovecots
dover
doves

exaggerator
exaggerators
exalt
exaltation
exaltations

flavonoid
flavonol
flavonols

glooming
gloomings
glooms

highth
highths
highting
hights
highway

indochina
indochinese
indoctrinate
indoctrinated
indoctrinates
indoctrinating

jackals
jackanapes
jackanapeses

kafir
kafirs
kafka

leucocyte
leucoma
leukaemia
leukaemic

mammal
mammalia
mammalian
mammalians
mammals

nims
nincompoop
nincompoops
nine
ninefold
ninepin
ninepins

onions
onionskin
onionskins
onlooker
onlookers

past
pasta
pastas
paste
pasteboard

queasily
queasiness
queasy
queaziest
queazy
quebec

reddening
reddens
redder
reddest
reddish

scared
scarer
scarers
scares

tetrasaccharide
tetravalent
tetryl
teuton

urethral
urethras
uretic

vocalizing
vocally
vocals

wheedling
wheel
wheelbarrow
wheelbarrows
wheelbase

xerophyte
xerosis
xerox

yammerers
yammering
yammers
yams
yamun

zymolysis
zymoplastic
zymoscope
zymurgy</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong><span style="color:rgb(0,0,255);">Anagram.java代码版本1</span></strong></span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> com.dajiangtai.hadoop.test;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  4</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.Arrays;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.StringTokenizer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  6</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configured;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 13</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.FileSystem;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 14</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 15</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.Text;</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 16</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Job;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 17</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 18</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 19</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.util.Tool;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 20</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.util.ToolRunner;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 21</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 22</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* @统计相同字母组成的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 23</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 1、编写map()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 24</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 2、编写reduce()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 25</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 3、编写run()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 26</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 4、编写main()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 27</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 28</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 29</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> Anagram <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Configured <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">implements</span><span style="font-size:12px;line-height:1.5;"> Tool 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 30</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 31</span> 　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramMapper <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Mapper&lt;LongWritable, Text, Text, Text&gt; 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 32</span> <span style="font-size:12px;line-height:1.5;">　　{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 33</span> 　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text sortedText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放排序好了的单词</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 34</span> 　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text orginalText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放原始单词本身</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 35</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 36</span> 　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> map(LongWritable key, Text value, Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 37</span> 　　　　{ <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">因为map输出需要抛出异常，所以提前先写好</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 38</span> 　　　　　　String word = value.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将value转化为String类型</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 39</span> 　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">char</span>[] wordChars = word.toCharArray();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">单词word转化为字符数组</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 40</span> 　　　　　　Arrays.sort(wordChars);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对字符数组按字母升序排序</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 41</span> 　　　　　　String sortedWord = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> String(wordChars);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">字符数组转化为字符串</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 42</span> 　　　　　　sortedText.set(sortedWord);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出key的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 43</span> 　　　　　　orginalText.set(word);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出value的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 44</span> 　　　　　　context.write( sortedText, orginalText );<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">map输出</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 45</span> <span style="font-size:12px;line-height:1.5;">　　　　}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 46</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 47</span> <span style="font-size:12px;line-height:1.5;">　　}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 48</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 49</span> 　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramReducer <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Reducer&lt;Text, Text, Text, Text&gt; 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 50</span> <span style="font-size:12px;line-height:1.5;">　　{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 51</span> 　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputKey = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 52</span> 　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputValue = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Text();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 53</span> 　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> reduce(Text Key, Iterable&lt;Text&gt;values,Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 54</span> 　　　　{<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reducer需要抛出异常，所以先提前写好。</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 55</span> 　　　　　　String output = "";<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义output作为输出，并初始化
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 56</span> 　　　　　　<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对相同字母组成的单词，使用 ~ 符号进行拼接</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 57</span> 　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span><span style="font-size:12px;line-height:1.5;">(Text anagam:values)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 58</span> 　　　　　　{<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过for循环，将相同字母构成的单词，拼接起来</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 59</span> 　　　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(!output.equals(""))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">过滤</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 60</span> <span style="font-size:12px;line-height:1.5;">　　　　　　　　　{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 61</span> 　　　　　　　　　　output = output + "~" ;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">用~来连接</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 62</span> <span style="font-size:12px;line-height:1.5;">　　　　　　　　　}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 63</span> 　　　　　　output = output + anagam.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">进行累加</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 64</span> <span style="font-size:12px;line-height:1.5;">　　　　　　}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 65</span> 　　　　　　StringTokenizer outputTokenizer = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> StringTokenizer(output,"~"<span style="font-size:12px;line-height:1.5;"> );
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 66</span> 　　　　　　<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过 StringTokenizer来解析拼接的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 67</span> 　　　　　　<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输出anagrams（字谜）大于2的结果</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 68</span> 　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(outputTokenizer.countTokens()&gt;=2<span style="font-size:12px;line-height:1.5;">)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 69</span> <span style="font-size:12px;line-height:1.5;">　　　　　　{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 70</span> 　　　　　　　　output = output.replace( "~", ",");<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将~替换成,</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 71</span> 　　　　　　　　outputKey.set(Key.toString());<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置key的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 72</span> 　　　　　　　　outputValue.set(output);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置value的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 73</span> 　　　　　　　　context.write( outputKey, outputValue);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reduce输出</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 74</span> <span style="font-size:12px;line-height:1.5;">　　　　　　}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 75</span> <span style="font-size:12px;line-height:1.5;">　　　　}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 76</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 77</span> <span style="font-size:12px;line-height:1.5;">　　}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 78</span> 　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> run(String[] arg0) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> Exception 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 79</span> <span style="font-size:12px;line-height:1.5;">　　{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 80</span> 　　　　<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">1</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 81</span> 　　　　Configuration conf = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Configuration();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 82</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 83</span> 　　　　<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">2删除已经存在的输出目录</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 84</span> 　　　　Path mypath = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[1]);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">下标为1，即是输出路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 85</span> 　　　　FileSystem hdfs = mypath.getFileSystem(conf);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">获取文件系统</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 86</span> 　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span><span style="font-size:12px;line-height:1.5;"> (hdfs.isDirectory(mypath))
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 87</span> 　　　　{<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">如果文件系统中存在这个输出路径，则删除掉</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 88</span> 　　　　　　hdfs.delete(mypath, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 89</span> <span style="font-size:12px;line-height:1.5;">　　　　}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 90</span> 　　　　Job job = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Job(conf, "anagram");<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">构建一个job对象，取名为testAnagram</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 91</span> 　　　　job.setJarByClass(Anagram.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置主类</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 92</span> 　　
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 93</span> 　　　　job.setMapperClass(AnagramMapper.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Mapper</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 94</span> 　　　　job.setReducerClass(AnagramReducer.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Reducer</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 95</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 96</span> 　　　　job.setOutputKeyClass(Text. <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 97</span> 　　　　job.setOutputValueClass(Text. <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 98</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 99</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">100</span> 　　　　FileInputFormat.addInputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[0]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输入路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">101</span> 　　　　FileOutputFormat.setOutputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[1]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输出路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">102</span> 　　　　job.waitForCompletion(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">103</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">104</span> 　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> 0<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">105</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">106</span> <span style="font-size:12px;line-height:1.5;">　　}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">107</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">108</span> 　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> main(String[] args) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> Exception
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">109</span> 　　{<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义数组来保存输入路径和输出路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">110</span> 　　　　String[] args0 = { "hdfs://djt002:9000/anagram"<span style="font-size:12px;line-height:1.5;">,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">111</span> 　　　　"hdfs://djt002:9000/anagram/out"<span style="font-size:12px;line-height:1.5;">};
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">112</span> 　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> ec = ToolRunner.run( <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Configuration(), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Anagram(), args0);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">113</span> <span style="font-size:12px;line-height:1.5;">　　　　System. exit(ec);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">114</span> <span style="font-size:12px;line-height:1.5;">　　}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">115</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">116</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">117</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">118</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">119</span> 　　 </pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong><span style="color:rgb(0,0,255);"><strong>Anagram.java</strong>代码版本2</span></strong></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212104125651-625522620.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212104202058-1286361913.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212104209667-703476086.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212104227026-880748397.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="color:rgb(0,0,255);font-size:18pt;"><strong>Anagram.java代码版本2</strong></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.Anagram;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  4</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.Arrays;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.StringTokenizer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  6</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configured;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 13</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.FileSystem;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 14</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 15</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.Text;</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 16</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Job;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 17</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 18</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 19</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.util.Tool;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 20</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.util.ToolRunner;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 21</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 22</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* @统计相同字母组成的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 23</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 1、编写map()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 24</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 2、编写reduce()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 25</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 3、编写run()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 26</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 4、编写main()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 27</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 28</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 29</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> Anagram <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Configured <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">implements</span><span style="font-size:12px;line-height:1.5;"> Tool 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 30</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 31</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramMapper <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Mapper&lt;LongWritable, Text, Text, Text&gt; 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 32</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 33</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text sortedText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放排序好了的单词</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 34</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text orginalText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放原始单词本身</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 35</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 36</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> map(LongWritable key, Text value, Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 37</span> { <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">因为map输出需要抛出异常，所以提前先写好</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 38</span> String word = value.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将value转化为String类型</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 39</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">char</span>[] wordChars = word.toCharArray();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">单词word转化为字符数组</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 40</span> Arrays.sort(wordChars);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对字符数组按字母升序排序</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 41</span> String sortedWord = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> String(wordChars);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">字符数组转化为字符串</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 42</span> sortedText.set(sortedWord);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出key的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 43</span> orginalText.set(word);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出value的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 44</span> context.write( sortedText, orginalText );<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">map输出</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 45</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 46</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 47</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 48</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 49</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramReducer <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Reducer&lt;Text, Text, Text, Text&gt; 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 50</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 51</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputKey = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 52</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputValue = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Text();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 53</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> reduce(Text Key, Iterable&lt;Text&gt;values,Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 54</span> {<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reducer需要抛出异常，所以先提前写好。</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 55</span> String output = "";<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义output作为输出，并初始化
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 56</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对相同字母组成的单词，使用 ~ 符号进行拼接</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 57</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span><span style="font-size:12px;line-height:1.5;">(Text anagam:values)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 58</span> {<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过for循环，将相同字母构成的单词，拼接起来</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 59</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(!output.equals(""))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">过滤</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 60</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 61</span> output = output + "~" ;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">用~来连接</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 62</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 63</span> output = output + anagam.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">进行累加</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 64</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 65</span> StringTokenizer outputTokenizer = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> StringTokenizer(output,"~"<span style="font-size:12px;line-height:1.5;"> );
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 66</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过 StringTokenizer来解析拼接的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 67</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输出anagrams（字谜）大于2的结果</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 68</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(outputTokenizer.countTokens()&gt;=2<span style="font-size:12px;line-height:1.5;">)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 69</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 70</span> output = output.replace( "~", ",");<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将~替换成,</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 71</span> outputKey.set(Key.toString());<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置key的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 72</span> outputValue.set(output);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置value的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 73</span> context.write( outputKey, outputValue);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reduce输出</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 74</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 75</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 76</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 77</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 78</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> run(String[] arg0) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> Exception {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 79</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 80</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">1</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 81</span> Configuration conf = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Configuration();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 82</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 83</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">2删除已经存在的输出目录</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 84</span> Path mypath = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[1]);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">下标为1，即是输出路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 85</span> FileSystem hdfs = mypath.getFileSystem(conf);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">获取文件系统</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 86</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span><span style="font-size:12px;line-height:1.5;"> (hdfs.isDirectory(mypath))
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 87</span> {<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">如果文件系统中存在这个输出路径，则删除掉</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 88</span> hdfs.delete(mypath, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 89</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 90</span> Job job = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Job(conf, "anagram");<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">构建一个job对象，取名为testAnagram</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 91</span> job.setJarByClass(Anagram.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置主类</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 92</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 93</span> job.setMapperClass(AnagramMapper.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Mapper</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 94</span> job.setReducerClass(AnagramReducer.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Reducer</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 95</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 96</span> job.setOutputKeyClass(Text. <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 97</span> job.setOutputValueClass(Text. <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 98</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 99</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">100</span> FileInputFormat.addInputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[0]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输入路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">101</span> FileOutputFormat.setOutputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[1]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输出路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">102</span> job.waitForCompletion(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">103</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">104</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> 0<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">105</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">106</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">107</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">108</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> main(String[] args) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> Exception
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">109</span> {<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义数组来保存输入路径和输出路径
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">110</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">集群路径    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">111</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    String[] args0 = { "hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/anagram.txt",
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">112</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    "hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/out/anagram/"};
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">113</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">114</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">本地路径    </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">115</span> String[] args0 = { "./data/anagram.txt"<span style="font-size:12px;line-height:1.5;">,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">116</span> "out/anagram/"<span style="font-size:12px;line-height:1.5;">};    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">117</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">118</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> ec = ToolRunner.run( <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Configuration(), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Anagram(), args0);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">119</span> <span style="font-size:12px;line-height:1.5;">System. exit(ec);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">120</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">121</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">122</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">123</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong><span style="color:rgb(0,0,255);">Anagram.java代码版本3</span></strong></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212114637464-303774696.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212114644683-1348314115.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212114653464-1443278636.png" alt="" style="border:0px;"></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  1</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  2</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">package zhouls.bigdata.myMapReduce.Anagram;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  3</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  4</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  5</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import java.util.Arrays;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  6</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import java.util.StringTokenizer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  7</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  8</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  9</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 10</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 11</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 12</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 13</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.conf.Configured;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 14</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.fs.FileSystem;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 15</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.fs.Path;</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 16</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 17</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.Job;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 18</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 19</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 20</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.util.Tool;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 21</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.util.ToolRunner;</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 22</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 23</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * @统计相同字母组成的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 24</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 1、编写map()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 25</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 2、编写reduce()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 26</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 3、编写run()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 27</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 4、编写main()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 28</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> */
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 29</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 30</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">public class Anagram extends Configured implements Tool 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 31</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 32</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    public static class AnagramMapper extends Mapper&lt;LongWritable, Text, Text, Text&gt; 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 33</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 34</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    private Text sortedText = new Text();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放排序好了的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 35</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    private Text orginalText = new Text();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放原始单词本身
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 36</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 37</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 38</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    { </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">因为map输出需要抛出异常，所以提前先写好
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 39</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    String word = value.toString();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将value转化为String类型
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 40</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    char[] wordChars = word.toCharArray();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">单词word转化为字符数组
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 41</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    Arrays.sort(wordChars);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对字符数组按字母升序排序
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 42</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    String sortedWord = new String(wordChars);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">字符数组转化为字符串
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 43</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    sortedText.set(sortedWord);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出key的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 44</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    orginalText.set(word);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出value的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 45</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    context.write( sortedText, orginalText );</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">map输出
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 46</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 47</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 48</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 49</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 50</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    public static class AnagramReducer extends Reducer&lt;Text, Text, Text, Text&gt; 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 51</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 52</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    private Text outputKey = new Text();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 53</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    private Text outputValue = new Text();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 54</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    public void reduce(Text Key, Iterable&lt;Text&gt;values,Context context) throws IOException, InterruptedException
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 55</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    {</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reducer需要抛出异常，所以先提前写好。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 56</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    String output = "";</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义output作为输出，并初始化
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 57</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对相同字母组成的单词，使用 ~ 符号进行拼接
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 58</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    for(Text anagam:values)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 59</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    {</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过for循环，将相同字母构成的单词，拼接起来
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 60</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    if(!output.equals(""))</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">过滤
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 61</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 62</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    output = output + "~" ;</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">用~来连接
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 63</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 64</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    output = output + anagam.toString();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">进行累加
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 65</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 66</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    StringTokenizer outputTokenizer = new StringTokenizer(output,"~" );
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 67</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过 StringTokenizer来解析拼接的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 68</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输出anagrams（字谜）大于2的结果
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 69</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    if(outputTokenizer.countTokens()&gt;=2)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 70</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 71</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    output = output.replace( "~", ",");</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将~替换成,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 72</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    outputKey.set(Key.toString());</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置key的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 73</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    outputValue.set(output);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置value的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 74</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    context.write( outputKey, outputValue);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reduce输出
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 75</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 76</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 77</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 78</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 79</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    public int run(String[] arg0) throws Exception {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 80</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 81</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">1
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 82</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    Configuration conf = new Configuration();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 83</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 84</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">2删除已经存在的输出目录
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 85</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    Path mypath = new Path(arg0[1]);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">下标为1，即是输出路径
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 86</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    FileSystem hdfs = mypath.getFileSystem(conf);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">获取文件系统
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 87</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    if (hdfs.isDirectory(mypath))
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 88</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    {</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">如果文件系统中存在这个输出路径，则删除掉
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 89</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    hdfs.delete(mypath, true);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 90</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 91</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    Job job = new Job(conf, "anagram");</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">构建一个job对象，取名为testAnagram
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 92</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    job.setJarByClass(Anagram.class);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置主类
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 93</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 94</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    job.setMapperClass(AnagramMapper.class);    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Mapper
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 95</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    job.setReducerClass(AnagramReducer.class);    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Reducer
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 96</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 97</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    job.setOutputKeyClass(Text. class);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 98</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    job.setOutputValueClass(Text. class);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 99</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">100</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">101</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    FileInputFormat.addInputPath(job, new Path(arg0[0]));</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输入路径
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">102</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    FileOutputFormat.setOutputPath(job, new Path(arg0[1]));</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输出路径
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">103</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    job.waitForCompletion(true);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">104</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">105</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    return 0;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">106</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">107</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">108</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">109</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    public static void main(String[] args) throws Exception
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">110</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    {</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义数组来保存输入路径和输出路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">111</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">集群路径    </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">112</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    String[] args0 = { "hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/anagram.txt",</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">113</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    "hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/out/anagram/"};
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">114</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">115</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">本地路径    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">116</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    String[] args0 = { "./data/anagram.txt",
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">117</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    "out/anagram/"};    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">118</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">119</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    int ec = ToolRunner.run( new Configuration(), new Anagram(), args0);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">120</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    System. exit(ec);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">121</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">122</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">123</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">124</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">}</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">125</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">126</span>  
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">127</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">128</span>  
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">129</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">130</span>  
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">131</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">132</span>  
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">133</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">134</span>  
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">135</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">136</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> zhouls.bigdata.myMapReduce.Anagram;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">137</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">138</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">139</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.Arrays;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">140</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.StringTokenizer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">141</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">142</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">143</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">144</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">145</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">146</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">147</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configured;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">148</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.FileSystem;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">149</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">150</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.Text;</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">151</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Job;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">152</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">153</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">154</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.util.Tool;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">155</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.util.ToolRunner;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">156</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">157</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* @统计相同字母组成的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">158</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 1、编写map()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">159</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 2、编写reduce()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">160</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 3、编写run()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">161</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">* 4、编写main()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">162</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">163</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">164</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> Anagram 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">165</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">166</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramMapper <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Mapper&lt;LongWritable, Text, Text, Text&gt; 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">167</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">168</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text sortedText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放排序好了的单词</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">169</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text orginalText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放原始单词本身</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">170</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">171</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> map(LongWritable key, Text value, Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">172</span> { <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">因为map输出需要抛出异常，所以提前先写好</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">173</span> String word = value.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将value转化为String类型</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">174</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">char</span>[] wordChars = word.toCharArray();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">单词word转化为字符数组</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">175</span> Arrays.sort(wordChars);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对字符数组按字母升序排序</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">176</span> String sortedWord = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> String(wordChars);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">字符数组转化为字符串</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">177</span> sortedText.set(sortedWord);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出key的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">178</span> orginalText.set(word);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出value的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">179</span> context.write( sortedText, orginalText );<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">map输出</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">180</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">181</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">182</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">183</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">184</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramReducer <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Reducer&lt;Text, Text, Text, Text&gt; 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">185</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">186</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputKey = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">187</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputValue = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Text();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">188</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> reduce(Text Key, Iterable&lt;Text&gt;values,Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">189</span> {<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reducer需要抛出异常，所以先提前写好。</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">190</span> String output = "";<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义output作为输出，并初始化
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">191</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对相同字母组成的单词，使用 ~ 符号进行拼接</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">192</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span><span style="font-size:12px;line-height:1.5;">(Text anagam:values)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">193</span> {<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过for循环，将相同字母构成的单词，拼接起来</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">194</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(!output.equals(""))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">过滤</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">195</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">196</span> output = output + "~" ;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">用~来连接</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">197</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">198</span> output = output + anagam.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">进行累加</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">199</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">200</span> StringTokenizer outputTokenizer = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> StringTokenizer(output,"~"<span style="font-size:12px;line-height:1.5;"> );
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">201</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过 StringTokenizer来解析拼接的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">202</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输出anagrams（字谜）大于2的结果</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">203</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(outputTokenizer.countTokens()&gt;=2<span style="font-size:12px;line-height:1.5;">)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">204</span> <span style="font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">205</span> output = output.replace( "~", ",");<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将~替换成,</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">206</span> outputKey.set(Key.toString());<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置key的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">207</span> outputValue.set(output);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置value的值</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">208</span> context.write( outputKey, outputValue);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reduce输出</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">209</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">210</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">211</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">212</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">213</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">214</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">215</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> main(String[] args) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> Exception{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">216</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">217</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">218</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">1</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">219</span> Configuration conf = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Configuration();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">220</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">221</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">222</span> Job job = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Job(conf, "anagram");<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">构建一个job对象，取名为testAnagram</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">223</span> job.setJarByClass(Anagram.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置主类</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">224</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">225</span> job.setMapperClass(AnagramMapper.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Mapper</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">226</span> job.setReducerClass(AnagramReducer.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Reducer</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">227</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">228</span> job.setOutputKeyClass(Text. <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">229</span> job.setOutputValueClass(Text. <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">230</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">231</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">232</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">233</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">指定要处理的输入数据存放路径
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">234</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    FileInputFormat.setInputPaths(job, new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/anagram.txt/"));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">235</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">236</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">指定处理结果的输出数据存放路径
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">237</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    FileOutputFormat.setOutputPath(job, new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">HadoopMaster:9000/out/anagram/"));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">238</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">239</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">指定要处理的输入数据存放路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">240</span> FileInputFormat.setInputPaths(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path("./data/anagram.txt"<span style="font-size:12px;line-height:1.5;">));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">241</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">242</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">指定处理结果的输出数据存放路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">243</span> FileOutputFormat.setOutputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path("out/anagram/"<span style="font-size:12px;line-height:1.5;">));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">244</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">245</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">246</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将job提交给集群运行 </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">247</span> job.waitForCompletion(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">248</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">249</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">250</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">251</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;　　代码版本3的写法，可以看看这篇博客</p> 
   <h1 style="font-size:28px;line-height:1.5;font-family:Verdana, Arial, Helvetica, sans-serif;"><a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/zlslch/p/6163511.html" rel="nofollow" style="color:#000000;">Hadoop MapReduce编程 API入门系列之wordcount版本1（五）</a></h1> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;color:rgb(0,0,255);"><strong>Anagram.java代码版本4</strong></span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  1</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">package</span><span style="font-size:12px;line-height:1.5;"> com.dajiangtai.Hadoop.MapReduce;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  2</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  3</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  4</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.Arrays;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  5</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> java.util.StringTokenizer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  6</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  7</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  8</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">  9</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 10</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 11</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 12</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.conf.Configured;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 13</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.FileSystem;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 14</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 15</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.Text;</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 16</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.Job;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 17</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 18</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 19</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.util.Tool;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 20</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">import</span><span style="font-size:12px;line-height:1.5;"> org.apache.hadoop.util.ToolRunner;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 21</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 22</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 23</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 24</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * @统计相同字母组成的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 25</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 1、编写map()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 26</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 2、编写reduce()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 27</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 3、编写run()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 28</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 4、编写main()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 29</span>  <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 30</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 31</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> Anagram <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Configured <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">implements</span><span style="font-size:12px;line-height:1.5;"> Tool {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 32</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    为什么写mapreduce程序时，看不懂使用extends Configured implements Tool的方式，为什么要这样写，不写难道不可以吗？
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 33</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        答：Tool接口可以支持处理通用的命令行选项，它是所有Map-Reduce程序的都可用的一个标准接口
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 34</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 35</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 36</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    public static class AnagramMapper extends Mapper&lt;Object, Text, Text, Text&gt; {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 37</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                为什么k1是Object？用LongWritable也可以，Object包括很多具体类型。</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 38</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 39</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 40</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramMapper <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Mapper&lt;LongWritable, Text, Text, Text&gt;<span style="font-size:12px;line-height:1.5;"> {    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 41</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            a
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 42</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            aah
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 43</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            aahed
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 44</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 45</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            a是1，aahed是5，这就是k1,偏移量，所以为LongWritable
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 46</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 47</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 48</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义两个对象或说变量    </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 49</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text sortedText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放排序好了的单词map</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 50</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text orginalText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放原始单词本身
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 51</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 52</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        public void map(Object key, Text value, Context context) throws IOException, InterruptedException{</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 53</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> map(LongWritable key, Text value, Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException{      
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 54</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            刚开始，key是0，value是0
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 55</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 56</span>          <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">因为map输出需要抛出异常，所以提前先写好
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 57</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 58</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            stomachache
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 59</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            stomachaches
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 60</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            stomached
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 61</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            stomacher
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 62</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 63</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 64</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 65</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">现在有单词如下：            
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 66</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            cat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 67</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            tar
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 68</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            bar
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 69</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            act
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 70</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            rat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 71</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 72</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            &lt;abr   bar&gt;                    abr是升序排序好后的字符数组，转化为字符串，作为k2
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 73</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                                        bar是原单词本身，作为v2</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 74</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 75</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 76</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 77</span>             String word = value.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将value转化为String类型
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 78</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            value是aardwolf        word是"aardwolf"</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 79</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 80</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">char</span>[] wordChars = word.toCharArray();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">单词word转化为字符数组
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 81</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            wordChars是[a, a, r, d, w, o, l, f]
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 82</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 83</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            "aardwolf"  输出  aardwolf  依次放入wordChars字符数组里，并标记下标从0开始</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 84</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 85</span>             Arrays.sort(wordChars);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对字符数组按字母升序排序</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 86</span>        
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 87</span>             String sortedWord = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> String(wordChars);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">升序排序好后的字符数组，转化为字符串
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 88</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            wordChars是[a, a, d, f, l, o, r, w]
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 89</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            sortedWord是"aadflorw"</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 90</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 91</span>             sortedText.set(sortedWord);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出key的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 92</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            将sortedWord的赋给sortedText
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 93</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            sortedWord是"aadflorw"，是String类型
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 94</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            sortedText是aadflorw，是Text类型</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 95</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 96</span>             orginalText.set(word);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出value的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 97</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            将word的赋给orginalText  
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 98</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            word是"aardwolf"，是String类型
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;"> 99</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            orginalText是aardwolf，是Text类型</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">100</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">101</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">102</span>             context.write(sortedText,orginalText);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">map输出     写入sortedText是k2,orginalText是v2   
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">103</span>                             <strong><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;"> // 即是aadflow,aardwolf</span></strong>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">104</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">105</span>           <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">现在有单词如下：            
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">106</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            cat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">107</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            tar
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">108</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            bar
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">109</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            act
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">110</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            rat
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">111</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">112</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            &lt;abr   bar&gt;                    abr是升序排序好后的字符数组，转化为字符串，作为k2,即sortedText
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">113</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                                        bar是原单词本身，作为v2，即orginalText</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">114</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">115</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">116</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">117</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">118</span> <span style="font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">119</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">120</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">121</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">122</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">123</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">124</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">125</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">126</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">127</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">128</span>     <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramReducer <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">extends</span> Reducer&lt;Text, Text, Text, Text&gt;<span style="font-size:12px;line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">129</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputKey = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">k3   作为reduce的输出</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">130</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputValue = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">v3</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">131</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">132</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> reduce(Text anagramKey, Iterable&lt;Text&gt; anagramValues,Context context) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> IOException, InterruptedException{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">133</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">134</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            Iterable&lt;Text&gt; values和Text values这样有什么区别？
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">135</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            前者是iterable（迭代器）变量，后者是Text（utf-8格式的文本的封装）变量
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">136</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">137</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            为什么断点出来之后，是这样的，因为啊，输出文件hdfs:djt002:9000/outData/anagram/part-00000的第一行就是如下啊
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">138</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            aaabcss    cassaba,casabas
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">139</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">140</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            是这个单词，aaabcss，
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">141</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            然后，字典里，有cassaba和cassaba
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">142</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            匹配到，即这aaabcss、cassaba和casabas。这三个其实都是字典里的
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">143</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">144</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reducer需要抛出异常，所以先提前写好。</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">145</span>                 String output = "";<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义output作为输出，并初始化
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">146</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                output是"cassaba,casabas"
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">147</span>                
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">148</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">149</span>                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">其实啊，由后面可以看出，output就是outputValue。anagramKey.toString()就是outputKey
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">150</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">151</span>                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对相同字母组成的单词，使用 ~ 符号进行拼接</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">152</span>                 <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span>(Text anagam:anagramValues){<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">星型for循环来循环values，即将values的值一一传给Text anagam
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">153</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                    values是Iterable&lt;Text&gt; values    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">154</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                    Text anagam
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">155</span>                     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">156</span>                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过for循环，将相同字母构成的单词，拼接起来</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">157</span>                      <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(!output.equals("")){<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">过滤
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">158</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                         output是"cassaba,casabas"</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">159</span>                          
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">160</span>                          output = output + "-" ;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">用~来连接组成单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">161</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                             右边的output是"cassaba,casabas"
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">162</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                             左边的output是"cassaba,casabas"</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">163</span>                          
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">164</span> <span style="font-size:12px;line-height:1.5;">                     }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">165</span>                      output = output + anagam.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">进行累加
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">166</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                     右边的output是"cassaba,casabas"
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">167</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                     左边的output是"cassaba,casabas"</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">168</span>                      
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">169</span> <span style="font-size:12px;line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">170</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">171</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">172</span>                 StringTokenizer outputTokenizer = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> StringTokenizer(output,"-"<span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">173</span>                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">StringTokenizer是字符串分隔解析类型,StringTokenizer 用来分割字符串，你可以指定分隔符，比如','，或者空格之类的字符。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">174</span>                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过 StringTokenizer来解析用~来拼接的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">175</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        右边的output是"cassaba,casabas"
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">176</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">177</span>                 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">178</span>                 <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输出anagrams（字谜）大于2的结果,因为是找不同单词，至少是2个</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">179</span>                 <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(outputTokenizer.countTokens()&gt;=2){<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">java.util.StringTokenizer.countTokens()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">180</span>                     <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">countTokens() 方法是用于计算此标记生成的nextToken方法之前的数量，可以通过调用产生一个异常。</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">181</span>                     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">182</span>                         output = output.replace( "-", ",");<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将~替换成,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">183</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                                 比如是   cassaba-casabas   变成   cassaba，casabas
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">184</span>                         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">185</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                                                               右边的output是"cassaba,casabas"
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">186</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                                                                左边的output是"cassaba,casabas"</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">187</span>                         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">188</span>                         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">189</span>                         outputKey.set(anagramKey.toString());<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置key的值    
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">190</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                            将Key.toString()设值给outputKey
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">191</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        Key是aaabcss，是Text类型
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">192</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        outputKey是aaabcss，是Text类型</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">193</span>                         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">194</span>                         outputValue.set(output);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置value的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">195</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        将output设值给outputValue     
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">196</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        output是cassaba,casabas
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">197</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        outputValue是cassaba,casabas</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">198</span>                         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">199</span>                         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">200</span>                         context.write( outputKey, outputValue);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reduce输出
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">201</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        outputKey是aaabcss
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">202</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        outputValue是cassaba,casabas</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">203</span>                         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">204</span> <span style="font-size:12px;line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">205</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">206</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">207</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">208</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">209</span>     
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">210</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> run(String[] arg0) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> Exception  {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">211</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">1</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">212</span>             Configuration conf = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Configuration();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">213</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">214</span>             <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">2删除已经存在的输出目录</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">215</span>             Path mypath = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[1]);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">下标为1，即是输出路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">216</span>             FileSystem hdfs = mypath.getFileSystem(conf);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">获取文件系统</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">217</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span><span style="font-size:12px;line-height:1.5;"> (hdfs.isDirectory(mypath))
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">218</span>             {<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">如果文件系统中存在这个输出路径，则删除掉</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">219</span>                 hdfs.delete(mypath, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">220</span> <span style="font-size:12px;line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">221</span>             Job job = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Job(conf, "anagram");<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">构建一个job对象，取名为Anagram</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">222</span>             job.setJarByClass(Anagram.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置主类</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">223</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">224</span>             job.setMapperClass(AnagramMapper.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Mapper</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">225</span>             job.setReducerClass(AnagramReducer.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Reducer</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">226</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">227</span>             job.setOutputKeyClass(Text. <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">228</span>             job.setOutputValueClass(Text. <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">229</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">230</span>            
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">231</span>             FileInputFormat.addInputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[0]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输入路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">232</span>             FileOutputFormat.setOutputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[1]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输出路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">233</span>             job.waitForCompletion(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">234</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">235</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> 0<span style="font-size:12px;line-height:1.5;">;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">236</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">237</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">238</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">239</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">240</span>         
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">241</span>         <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> main(String[] args) <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">throws</span><span style="font-size:12px;line-height:1.5;"> Exception{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">242</span>         <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义数组来保存输入路径和输出路径
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">243</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">集群路径            </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">244</span>             String[] args0 = { "hdfs://djt002:9000/inputData/anagram/anagram.txt"<span style="font-size:12px;line-height:1.5;">,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">245</span>                      "hdfs://djt002:9000/outData/anagram/"<span style="font-size:12px;line-height:1.5;">};
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">246</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">247</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">本地路径            
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">248</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            String[] args0 = { "./data/anagram/anagram.txt",
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">249</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                     "./out/anagram/"};            </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">250</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">251</span>             <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> ec = ToolRunner.run( <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Configuration(), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Anagram(), args0);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">252</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            ToolRunner要处理的Configuration，Tool通过ToolRunner调用ToolRunner.run时，传入参数Configuration  </span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">253</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">254</span>             
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">255</span> <span style="font-size:12px;line-height:1.5;">            System. exit(ec);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">256</span> <span style="font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">257</span> <span style="font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">258</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">259</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">260</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">261</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">262</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">263</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">264</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">265</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">266</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">267</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">268</span> 
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">269</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">写法版本2
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">270</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">package zhouls.bigdata.myMapReduce.Anagram;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">271</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">272</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import java.io.IOException;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">273</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import java.util.Arrays;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">274</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import java.util.StringTokenizer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">275</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">276</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.LongWritable;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">277</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">278</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.Mapper;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">279</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.Reducer;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">280</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.conf.Configuration;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">281</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.conf.Configured;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">282</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.fs.FileSystem;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">283</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.fs.Path;</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">284</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.Text;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">285</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.Job;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">286</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">287</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">288</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.util.Tool;
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">289</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.util.ToolRunner;</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">290</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/**
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">291</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * @统计相同字母组成的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">292</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 1、编写map()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">293</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 2、编写reduce()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">294</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 3、编写run()函数
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">295</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> * 4、编写main()
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">296</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> */
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">297</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">298</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">public class Anagram 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">299</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">300</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    public static class AnagramMapper extends Mapper&lt;LongWritable, Text, Text, Text&gt; 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">301</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">302</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        private Text sortedText = new Text();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放排序好了的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">303</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        private Text orginalText = new Text();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放原始单词本身
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">304</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">305</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">306</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        { </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">因为map输出需要抛出异常，所以提前先写好
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">307</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            String word = value.toString();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将value转化为String类型
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">308</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            char[] wordChars = word.toCharArray();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">单词word转化为字符数组
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">309</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            Arrays.sort(wordChars);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对字符数组按字母升序排序
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">310</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            String sortedWord = new String(wordChars);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">字符数组转化为字符串
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">311</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            sortedText.set(sortedWord);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出key的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">312</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            orginalText.set(word);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出value的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">313</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            context.write( sortedText, orginalText );</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">map输出
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">314</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">315</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">316</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">317</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">318</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    public static class AnagramReducer extends Reducer&lt;Text, Text, Text, Text&gt; 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">319</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">    {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">320</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        private Text outputKey = new Text();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">321</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        private Text outputValue = new Text();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">322</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        public void reduce(Text Key, Iterable&lt;Text&gt;values,Context context) throws IOException, InterruptedException
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">323</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        {</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reducer需要抛出异常，所以先提前写好。
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">324</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                String output = "";</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义output作为输出，并初始化
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">325</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>                <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对相同字母组成的单词，使用 ~ 符号进行拼接
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">326</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                for(Text anagam:values)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">327</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                {</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过for循环，将相同字母构成的单词，拼接起来
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">328</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                     if(!output.equals(""))</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">过滤
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">329</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                     {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">330</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                         output = output + "~" ;</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">用~来连接
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">331</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                     }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">332</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                     output = output + anagam.toString();</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">进行累加
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">333</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">334</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                StringTokenizer outputTokenizer = new StringTokenizer(output,"~" );
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">335</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>                <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过 StringTokenizer来解析拼接的单词
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">336</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>                <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输出anagrams（字谜）大于2的结果
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">337</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                if(outputTokenizer.countTokens()&gt;=2)
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">338</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                {
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">339</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        output = output.replace( "~", ",");</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将~替换成,
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">340</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        outputKey.set(Key.toString());</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置key的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">341</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        outputValue.set(output);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置value的值
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">342</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                        context.write( outputKey, outputValue);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reduce输出
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">343</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">                }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">344</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">345</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">346</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">}
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">347</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">348</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">349</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">     public static void main(String[] args) throws Exception{
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">350</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">351</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>       
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">352</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>            <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">1
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">353</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            Configuration conf = new Configuration();
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">354</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">355</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>       
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">356</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            Job job = new Job(conf, "anagram");</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">构建一个job对象，取名为testAnagram
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">357</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            job.setJarByClass(Anagram.class);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置主类
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">358</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>            
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">359</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            job.setMapperClass(AnagramMapper.class);    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Mapper
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">360</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            job.setReducerClass(AnagramReducer.class);    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Reducer
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">361</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>            
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">362</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            job.setOutputKeyClass(Text. class);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">363</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            job.setOutputValueClass(Text. class);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">364</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>            
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">365</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>           
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">366</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">367</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">368</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>            
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">369</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span>            <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">指定要处理的输入数据存放路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">370</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            FileInputFormat.setInputPaths(job, new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">djt002:9000/inputData/anagram.txt/"));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">371</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>        <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>    
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">372</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span>            <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">指定处理结果的输出数据存放路径</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">373</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">////</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">            FileOutputFormat.setOutputPath(job, new Path("hdfs:</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">djt002:9000/outData/anagram/"));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">374</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">375</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>        <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">指定要处理的输入数据存放路径
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">376</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        FileInputFormat.setInputPaths(job, new Path("./data/anagram.txt"));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">377</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">378</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>        <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">指定处理结果的输出数据存放路径
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">379</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        FileOutputFormat.setOutputPath(job, new Path("out/anagram/"));
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">380</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">381</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">382</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>        <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将job提交给集群运行 
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">383</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        job.waitForCompletion(true);
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">384</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>            
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">385</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">386</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">387</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">388</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">389</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">390</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>       
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">391</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">392</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span>
<span style="color:rgb(0,128,128);font-size:12px;line-height:1.5;">393</span> <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong><span style="color:rgb(0,0,255);">　　最清晰的版本（博主推荐）</span></strong></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;　　以下是原始数据里的单词cassaba&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2017.cnblogs.com/blog/855959/201710/855959-20171011000012340-640209795.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;">package com.dajiangtai.hadoop.test;

import java.io.IOException;
import java.util.Arrays;
import java.util.StringTokenizer;

import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mapreduce.Reducer;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.conf.Configured;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.Text;</span>
<span style="font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
import org.apache.hadoop.util.Tool;
import org.apache.hadoop.util.ToolRunner;
</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/*</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*
* @统计相同字母组成的单词
* 1、编写map()函数
* 2、编写reduce()函数
* 3、编写run()函数
* 4、编写main()
</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>

<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> Anagram extends Configured implements Tool 
{
　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramMapper extends Mapper&lt;LongWritable, Text, Text, Text&gt;<span style="font-size:12px;line-height:1.5;"> 
　　{
　　　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text sortedText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放排序好了的单词</span>
　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text orginalText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放原始单词本身</span>

　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> map(LongWritable key, Text value, Context context) throws IOException, InterruptedException
　　　　{ </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">因为map输出需要抛出异常，所以提前先写好</span>
　　　　　　String word = value.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将value转化为String类型
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">比如value是cassaba 
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">经过value.toString()下来，得到word是"cassaba"</span>
　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">char</span>[] wordChars = word.toCharArray();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">单词word转化为字符数组
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">经过word.toCharArray()下来，得到'c','a','s','s','a','b','a'</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　Arrays.sort(wordChars);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对字符数组按字母升序排序
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">得到'a','a','a','b','c','s','s'</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　String sortedWord </span>= <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> String(wordChars);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">字符数组转化为字符串
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">得到"aaabcss"</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　sortedText.</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>(sortedWord);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出key的值
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">sortedText是aaabcss</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　orginalText.</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>(word);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出value的值
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">orginalText是cassaba </span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　context.write( sortedText, orginalText );</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">map输出</span>
<span style="font-size:12px;line-height:1.5;">　　　　}

　　}

　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramReducer extends Reducer&lt;Text, Text, Text, Text&gt;<span style="font-size:12px;line-height:1.5;"> 
　　{
　　　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputKey = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//
</span>　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputValue = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Text();
　　　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> reduce(Text Key, Iterable&lt;Text&gt;<span style="font-size:12px;line-height:1.5;">values,Context context) throws IOException, InterruptedException
                        </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">key是anagramKey，即aaabcss            values是orginalText，即cassaba </span>
<span style="font-size:12px;line-height:1.5;">

　　　　{</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reducer需要抛出异常，所以先提前写好。</span>
　　　　　　String output = <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">""</span>;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义output作为输出，并初始化
　　　　　　</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对相同字母组成的单词，使用 ~ 符号进行拼接</span>

　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span><span style="font-size:12px;line-height:1.5;">(Text anagam:values)
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">即把values的值，即orginalText的值，一一赋值给anagam。  即"cassaba"，一一拆成"c" "a" "s" "s" "a" "b" "a"</span>
　　　　　　{<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过for循环，将相同字母构成的单词，拼接起来</span>
　　　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(!output.equals(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">""</span>))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">过滤   ，即这里为什么要过滤，即这个"casabas"读取完了，读到"k"之后的位置即算读完了</span>
<span style="font-size:12px;line-height:1.5;">　　　　　　　　　{
　　　　　　　　　　output </span>= output + <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">~</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span> ;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">用~来连接     
                        </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">等号左边的output是  "cassaba" </span>
<span style="font-size:12px;line-height:1.5;">　　　　　　　　　}
　　　　　　output </span>= output + anagam.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">进行累加
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">左边的output是cassaba~casabas</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　}
　　　　　　StringTokenizer outputTokenizer </span>= <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> StringTokenizer(output,<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">~</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;"> );
                        </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">outputTokenizer是按照~被切分割后的字符串，为cassaba  casabas

　　　　　　</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过 StringTokenizer来解析拼接的单词
　　　　　　</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输出anagrams（字谜）大于2的结果。因为输出anagrams（字谜）大于2的结果,因为是找不同单词，至少是2个。</span>
　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(outputTokenizer.countTokens()&gt;=<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span><span style="font-size:12px;line-height:1.5;">)
　　　　　　{
　　　　　　　　output </span>= output.replace( <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">~</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">,</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将~替换成,            
                        </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">即output为cassaba,casabas</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　　　outputKey.</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>(Key.toString());<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置key的值
                        </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">outputKey为sortedText，为aaabcss</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　　　outputValue.</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>(output);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置value的值
                        </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">outputValue为相同单词组成的字谜</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　　　context.write( outputKey, outputValue);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reduce输出</span>
<span style="font-size:12px;line-height:1.5;">　　　　　　}
　　　　}

　　}
　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span><span style="font-size:12px;line-height:1.5;"> run(String[] arg0) throws Exception 
　　{
　　　　</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">1</span>
　　　　Configuration conf = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Configuration();

　　　　</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">2删除已经存在的输出目录</span>
　　　　Path mypath = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span>]);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">下标为1，即是输出路径</span>
　　　　FileSystem hdfs = mypath.getFileSystem(conf);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">获取文件系统</span>
　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span><span style="font-size:12px;line-height:1.5;"> (hdfs.isDirectory(mypath))
　　　　{</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">如果文件系统中存在这个输出路径，则删除掉</span>
　　　　　　hdfs.delete(mypath, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
　　　　}
　　　　Job job </span>= <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Job(conf, <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">anagram</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">构建一个job对象，取名为testAnagram</span>
　　　　job.setJarByClass(Anagram.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置主类</span>
<span style="font-size:12px;line-height:1.5;">　　
　　　　job.setMapperClass(AnagramMapper.</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Mapper</span>
　　　　job.setReducerClass(AnagramReducer.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Reducer</span>
<span style="font-size:12px;line-height:1.5;">
　　　　job.setOutputKeyClass(Text. </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
　　　　job.setOutputValueClass(Text. </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);


　　　　FileInputFormat.addInputPath(job, </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输入路径</span>
　　　　FileOutputFormat.setOutputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span>]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输出路径</span>
　　　　job.waitForCompletion(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);

　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">;

　　}

　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> main(String[] args) throws Exception
　　{</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义数组来保存输入路径和输出路径</span>
　　　　String[] args0 = { <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">hdfs://djt002:9000/anagram</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">,
　　　　</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">hdfs://djt002:9000/anagram/out</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">};
　　　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> ec = ToolRunner.run( <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Configuration(), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Anagram(), args0);
　　　　System. exit(ec);
　　}


}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br> &nbsp;　　以下是原始数据里的单词 casabas</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="font-size:12px;line-height:1.5;"> 

package com.dajiangtai.hadoop.test;

import java.io.IOException;
import java.util.Arrays;
import java.util.StringTokenizer;

import org.apache.hadoop.io.LongWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mapreduce.Reducer;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.conf.Configured;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">import org.apache.hadoop.io.Text;</span>
<span style="font-size:12px;line-height:1.5;">import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
import org.apache.hadoop.util.Tool;
import org.apache.hadoop.util.ToolRunner;
</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">/*</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*
* @统计相同字母组成的单词
* 1、编写map()函数
* 2、编写reduce()函数
* 3、编写run()函数
* 4、编写main()
</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">*/</span>

<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;"> Anagram extends Configured implements Tool 
{
　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramMapper extends Mapper&lt;LongWritable, Text, Text, Text&gt;<span style="font-size:12px;line-height:1.5;"> 
　　{
　　　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text sortedText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放排序好了的单词</span>
　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text orginalText = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">存放原始单词本身</span>

　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> map(LongWritable key, Text value, Context context) throws IOException, InterruptedException
　　　　{ </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">因为map输出需要抛出异常，所以提前先写好</span>
　　　　　　String word = value.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将value转化为String类型
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">比如value是casabas
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">经过value.toString()下来，得到word是"casabas"</span>
　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">char</span>[] wordChars = word.toCharArray();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">单词word转化为字符数组
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">经过word.toCharArray()下来，得到'c','a','s','a','b','a','s'</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　Arrays.sort(wordChars);</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对字符数组按字母升序排序
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">得到'a','a','a','b','c','s','s'</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　String sortedWord </span>= <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> String(wordChars);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">字符数组转化为字符串
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">得到"aaabcss"</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　sortedText.</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>(sortedWord);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出key的值
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">sortedText是aaabcss</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　orginalText.</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>(word);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置输出value的值
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">orginalText是casabas</span>
<span style="font-size:12px;line-height:1.5;">
　　　　　　context.write( sortedText, orginalText );</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">map输出</span>
<span style="font-size:12px;line-height:1.5;">　　　　}

　　}

　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span> AnagramReducer extends Reducer&lt;Text, Text, Text, Text&gt;<span style="font-size:12px;line-height:1.5;"> 
　　{
　　　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputKey = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Text();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//
</span>　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">private</span> Text outputValue = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Text();
　　　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span> reduce(Text Key, Iterable&lt;Text&gt;<span style="font-size:12px;line-height:1.5;">values,Context context) throws IOException, InterruptedException
                        </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">key是anagramKey，即aaabcss            values是orginalText，即casabas</span>
<span style="font-size:12px;line-height:1.5;">

　　　　{</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reducer需要抛出异常，所以先提前写好。</span>
　　　　　　String output = <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">""</span>;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义output作为输出，并初始化
　　　　　　</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">对相同字母组成的单词，使用 ~ 符号进行拼接</span>

　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">for</span><span style="font-size:12px;line-height:1.5;">(Text anagam:values)
                    </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">即把values的值，即orginalText的值，一一赋值给anagam。  即"casabas"，一一拆成"c" "a" "s" "a" "b" "a" "s"</span>
　　　　　　{<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过for循环，将相同字母构成的单词，拼接起来</span>
　　　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(!output.equals(<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">""</span>))<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">过滤   ，即这里为什么要过滤，即这个"casabas"读取完了，读到"k"之后的位置即算读完了</span>
<span style="font-size:12px;line-height:1.5;">　　　　　　　　　{
　　　　　　　　　　output </span>= output + <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">~</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span> ;<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">用~来连接     
                        </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">等号左边的output是  c~a~s~a~b~a~s</span>
<span style="font-size:12px;line-height:1.5;">　　　　　　　　　}
　　　　　　output </span>= output + anagam.toString();<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">进行累加</span>
<span style="font-size:12px;line-height:1.5;">　　　　　　}
　　　　　　StringTokenizer outputTokenizer </span>= <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> StringTokenizer(output,<span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">~</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;"> );
                        </span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">outputTokenizer是按照~被切分割后的字符串，为aardvark

　　　　　　</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">通过 StringTokenizer来解析拼接的单词
　　　　　　</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">输出anagrams（字谜）大于2的结果。因为输出anagrams（字谜）大于2的结果,因为是找不同单词，至少是2个。</span>
　　　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span>(outputTokenizer.countTokens()&gt;=<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">2</span><span style="font-size:12px;line-height:1.5;">)
　　　　　　{
　　　　　　　　output </span>= output.replace( <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">~</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>, <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">,</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">将~替换成,</span>
　　　　　　　　outputKey.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>(Key.toString());<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置key的值</span>
　　　　　　　　outputValue.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">set</span>(output);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置value的值</span>
　　　　　　　　context.write( outputKey, outputValue);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">reduce输出</span>
<span style="font-size:12px;line-height:1.5;">　　　　　　}
　　　　}

　　}
　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span><span style="font-size:12px;line-height:1.5;"> run(String[] arg0) throws Exception 
　　{
　　　　</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">1</span>
　　　　Configuration conf = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Configuration();

　　　　</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">2删除已经存在的输出目录</span>
　　　　Path mypath = <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span>]);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">下标为1，即是输出路径</span>
　　　　FileSystem hdfs = mypath.getFileSystem(conf);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">获取文件系统</span>
　　　　<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">if</span><span style="font-size:12px;line-height:1.5;"> (hdfs.isDirectory(mypath))
　　　　{</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">如果文件系统中存在这个输出路径，则删除掉</span>
　　　　　　hdfs.delete(mypath, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);
　　　　}
　　　　Job job </span>= <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Job(conf, <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">anagram</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">构建一个job对象，取名为testAnagram</span>
　　　　job.setJarByClass(Anagram.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">设置主类</span>
<span style="font-size:12px;line-height:1.5;">　　
　　　　job.setMapperClass(AnagramMapper.</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Mapper</span>
　　　　job.setReducerClass(AnagramReducer.<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span>);    <span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">Reducer</span>
<span style="font-size:12px;line-height:1.5;">
　　　　job.setOutputKeyClass(Text. </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);
　　　　job.setOutputValueClass(Text. </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">class</span><span style="font-size:12px;line-height:1.5;">);


　　　　FileInputFormat.addInputPath(job, </span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span>]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输入路径</span>
　　　　FileOutputFormat.setOutputPath(job, <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Path(arg0[<span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">1</span>]));<span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;"> 文件输出路径</span>
　　　　job.waitForCompletion(<span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">true</span><span style="font-size:12px;line-height:1.5;">);

　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">return</span> <span style="color:rgb(128,0,128);font-size:12px;line-height:1.5;">0</span><span style="font-size:12px;line-height:1.5;">;

　　}

　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">public</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">static</span> <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">void</span><span style="font-size:12px;line-height:1.5;"> main(String[] args) throws Exception
　　{</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">//</span><span style="color:rgb(0,128,0);font-size:12px;line-height:1.5;">定义数组来保存输入路径和输出路径</span>
　　　　String[] args0 = { <span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">hdfs://djt002:9000/anagram</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">,
　　　　</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">hdfs://djt002:9000/anagram/out</span><span style="color:rgb(128,0,0);font-size:12px;line-height:1.5;">"</span><span style="font-size:12px;line-height:1.5;">};
　　　　</span><span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">int</span> ec = ToolRunner.run( <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span> Configuration(), <span style="color:rgb(0,0,255);font-size:12px;line-height:1.5;">new</span><span style="font-size:12px;line-height:1.5;"> Anagram(), args0);
　　　　System. exit(ec);
　　}


}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="font-size:12px;line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="color:rgb(0,0,255);font-size:18pt;"><strong>总结</strong></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp; &nbsp; 若是将map、combiner、shuffle、reduce等全放在同一个.java里。则采用上述这样的编程写法。直接是&nbsp;new&nbsp;Anagram()。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">　 若是将map、combiner、shuffle、reduce等分开放一个.java里。则需要实现Tool。见下面这篇博客</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p><font><span style="font-size:14px;">本文转自大数据躺过的坑博客园博客，原文链接：http://www.cnblogs.com/zlslch/p/5078072.html，如需转载请自行联系原作者</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
