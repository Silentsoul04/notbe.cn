<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Troubleshooting "Global Enqueue Services Deadlock detected" (Doc ID 1443482.1) « NotBeCN</title>
  <meta name="description" content="             In this Document                   &nbsp;       Purpose                               &nbsp;       Troubleshooting Steps                        ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/14/weixin_34303897_90117756.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Troubleshooting "Global Enqueue Services Deadlock detected" (Doc ID 1443482.1)</h1>
    <p class="post-meta">Nov 14, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"><strong>In this Document</strong><br></p> 
   <table style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3E_afrLoop=1021148011984950&amp;id=1443482.1&amp;displayIndex=1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=m3p452ml4_194#PURPOSE" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Purpose</a></td> 
     </tr>
    </tbody>
   </table>
   <table style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=1021148011984950&amp;id=1443482.1&amp;displayIndex=1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=m3p452ml4_194#TRBLSHOOT" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Troubleshooting Steps</a></td> 
     </tr>
    </tbody>
   </table>
   <table style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=1021148011984950&amp;id=1443482.1&amp;displayIndex=1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=m3p452ml4_194#aref_section21" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">1. TX deadlock in Exclusive(X) mode</a></td> 
     </tr>
    </tbody>
   </table>
   <table style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=1021148011984950&amp;id=1443482.1&amp;displayIndex=1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=m3p452ml4_194#aref_section22" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">2. TX deadlock in Share(S) mode</a></td> 
     </tr>
    </tbody>
   </table>
   <table style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3E_afrLoop=1021148011984950&amp;id=1443482.1&amp;displayIndex=1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=m3p452ml4_194#aref_section23" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">3. TM deadlock</a></td> 
     </tr>
    </tbody>
   </table>
   <table style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=1021148011984950&amp;id=1443482.1&amp;displayIndex=1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=m3p452ml4_194#aref_section24" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">4. Single resource deadlock for TX , TM or IV</a></td> 
     </tr>
    </tbody>
   </table>
   <table style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3E_afrLoop=1021148011984950&amp;id=1443482.1&amp;displayIndex=1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=m3p452ml4_194#aref_section25" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">5. LB deadlock</a></td> 
     </tr>
    </tbody>
   </table>
   <table style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3E_afrLoop=1021148011984950&amp;id=1443482.1&amp;displayIndex=1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=m3p452ml4_194#aref_section26" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">6. Known Issues</a></td> 
     </tr>
    </tbody>
   </table>
   <table style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=1021148011984950&amp;id=1443482.1&amp;displayIndex=1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=m3p452ml4_194#aref_section27" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">7. Further Diagnosis</a></td> 
     </tr>
    </tbody>
   </table>
   <table style="border:1px solid #C0C0C0;border-collapse:collapse;font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
    <tbody>
     <tr>
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;">&nbsp;</td> 
      <td style="border:1px solid #C0C0C0;border-collapse:collapse;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3E_afrLoop=1021148011984950&amp;id=1443482.1&amp;displayIndex=1&amp;_afrWindowMode=0&amp;_adf.ctrl-state=m3p452ml4_194#REF" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">References</a></td> 
     </tr>
    </tbody>
   </table>
   <hr style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"></p> 
   <h2 style="color:rgb(255,255,255);line-height:1.5;font-size:16px;font-family:verdana, Arial, Helvetica, sans-serif;border-bottom:1px solid rgb(196,209,230);text-transform:uppercase;">APPLIES TO:</h2> 
   <span style="line-height:1.8;color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">Oracle Database - Enterprise Edition - Version 10.1.0.2 and later</span>
   <br style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
   <span style="line-height:1.8;color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">Information in this document applies to any platform.</span>
   <br style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">
   <h2 style="color:rgb(255,255,255);line-height:1.5;font-size:16px;font-family:verdana, Arial, Helvetica, sans-serif;border-bottom:1px solid rgb(196,209,230);text-transform:uppercase;"> <a name="PURPOSE" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a>PURPOSE</h2> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">This note is to provide some common causes and solutions for message "Global Enqueue Services Deadlock detected" reported in alert log.</p> 
   <h2 style="color:rgb(255,255,255);line-height:1.5;font-size:16px;font-family:verdana, Arial, Helvetica, sans-serif;border-bottom:1px solid rgb(196,209,230);text-transform:uppercase;"> <a name="TRBLSHOOT" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);"></a>TROUBLESHOOTING STEPS</h2> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">In single instance environment, when a deadlock happens, it often reports ORA-60, see&nbsp;<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3Eid=15476.1" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 15476.1</a>&nbsp;FAQ: Detecting and Resolving Locking Conflicts and Ora-00060 errors. In a Real Application Cluster (RAC) environment, instead of ORA-60, one would see the following messages in database alert log:</p> 
   <div class="kmcodeblock" style="color:rgb(51,51,51);font-size:14px;border:1px solid rgb(196,209,230);font-family:'Courier New', Courier, monospace;">
    Global Enqueue Services Deadlock detected. More info in file
    <br> /u01/diag/rdbms/rac/RAC1/trace/RAC1_ora_3457040.trc.
    <br>
    <br>
    <strong>OR</strong>
    <br>
    <br> Global Enqueue Services Deadlock detected. More info in file&nbsp;
    <br> /u01/diag/rdbms/rac/RAC1/trace/RAC1_lmd0_30429.trc.
   </div> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">The major difference of deadlock between single instance and RAC is the sessions involved in a deadlock could be from different instances and there could be more than 2 sessions involved. When Global Enqueue Service Deadlock is reported, the session which initiates the deadlock checking will be terminated to resolve the deadlock. There are different deadlock types in RAC environment, many are similar to single instance deadlock.</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">To understand the basics of deadlock, refer to the following documents:&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3Eid=62365.1" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 62365.1</a>&nbsp;What to do with "ORA-60 Deadlock Detected" Errors<br><a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3Eid=62354.1" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 62354.1</a>&nbsp;TX Transaction locks - Example wait scenarios<br></p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">GV$GES_ENQUEUE and GV$GES_BLOCKING_ENQUEUE can be used to query Global Enqueue Service(GES) lock, they may not necessary involve in a deadlock. Deadlock related information (session, SQL statement etc)&nbsp;will be printed in lmd0 or foreground trace file.</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">With&nbsp;<a href="https://support.oracle.com/epmos/faces/BugDisplay?id=6343023" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Bug 6343023</a>&nbsp;fixed in 10.2.0.5, 11.1.0.7 and all 11.2, the offending SQL&nbsp;statements&nbsp;from involved sessions&nbsp;will be written in the trace. For earlier version or if there is no SQL&nbsp;statements in the trace, apply&nbsp;<a href="https://support.oracle.com/epmos/faces/ui/patch/PatchDetail.jspx?%3C/p%3E%3Cp%3EpatchId=6343023" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">patch 6343023</a>&nbsp;or use step 6 to gather system state dump.&nbsp;&nbsp;<br> &nbsp;<br> Here are some common deadlock types:</p> 
   <a name="aref_section21" style="border-bottom:1px dotted rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"></a>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <h4 style="color:rgb(0,0,136);font-size:12px;font-family:verdana, Arial, Helvetica, sans-serif;font-style:italic;">1. TX deadlock in Exclusive(X) mode</h4> 
   <div class="kmcodeblock" style="color:rgb(51,51,51);font-size:14px;border:1px solid rgb(196,209,230);font-family:'Courier New', Courier, monospace;">
    trace shows:
    <br>
    <br> Global Wait-For-Graph(WFG) at ddTS[0.170] :
    <br> BLOCKED 0x8aafb0ec&nbsp;
    <strong>5</strong>&nbsp;wq 2 cvtops x1&nbsp;
    <strong>TX</strong>&nbsp;0x320001.0x121c97 [99000-0001-00000002]0&nbsp;
    <br> BLOCKER 0x8aafafec&nbsp;
    <strong>5</strong>&nbsp;wq 1 cvtops x8&nbsp;
    <strong>TX</strong>&nbsp;0x320001.0x121c97 [9A000-0001-00000002]0&nbsp;
    <br> BLOCKED 0x8acb55e4&nbsp;
    <strong>5</strong>&nbsp;wq 2 cvtops x1&nbsp;
    <strong>TX</strong>&nbsp;0x430003.0x3843f [9A000-0001-00000002] 0&nbsp;
    <br> BLOCKER 0x8acb54e4&nbsp;
    <strong>5</strong>&nbsp;wq 1 cvtops x8&nbsp;
    <strong>TX</strong>&nbsp;0x430003.0x3843f [99000-0001-00000002] 0
    <br>
    <br> These values are:
    <br> &lt;BLOCKED|BLOCKER&gt; &lt;lockp&gt; &lt;cvt|held mode&gt; &lt;res name&gt; &lt;pid|did|txn_id&gt; &lt;node&gt;&nbsp;&nbsp;
    <br>
    <br> mode 5&nbsp;is exclusive lock
    <br> instance# starts from 0
   </div> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">Above deadlock means two sessions involved in TX-0x320001-0x121c97 and TX-0x430003-0x3843f forms a deadlock, both sessions are from instance 1.&nbsp;<br><br> This is a typical application transaction TX enqueue lock, usually caused by SQL commit sequence and high concurrency. To avoid such deadlock, application code and logic need to be modified.&nbsp;<br> The application and SQL involved in the deadlock can be found in lmd0 or foreground trace (check all instances). Search for: "user session for deadlock lock" section to find out the SQL involved in the deadlock. For example:</p> 
   <div class="kmcodeblock" style="color:rgb(51,51,51);font-size:14px;border:1px solid rgb(196,209,230);font-family:'Courier New', Courier, monospace;">
    user session for deadlock lock 0x8aafb0ec:
    <br> ...
    <br> &nbsp; current SQL:
    <br> &nbsp; update test set OWNER='APPS' where rownum &lt; 2
   </div> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">&nbsp;</p> 
   <a name="aref_section22" style="border-bottom:1px dotted rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"></a>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <h4 style="color:rgb(0,0,136);font-size:12px;font-family:verdana, Arial, Helvetica, sans-serif;font-style:italic;">2. TX deadlock in Share(S) mode</h4> 
   <div class="kmcodeblock" style="color:rgb(51,51,51);font-size:14px;border:1px solid rgb(196,209,230);font-family:'Courier New', Courier, monospace;">
    trace shows:
    <br>
    <br> Global Wait-For-Graph(WFG) at ddTS[0.b7] :
    <br> BLOCKED 0x2310e8918&nbsp;
    <strong>3</strong>&nbsp;[0x731000e][0x56268],[
    <strong>TX</strong>] [F1000-0001-0000000F] 0&nbsp;
    <br> BLOCKER 0x2310e87c8&nbsp;
    <strong>3</strong>&nbsp;[0x731000e][0x56268],[
    <strong>TX</strong>] [19F000-0001-00000011] 0&nbsp;
    <br> BLOCKED 0x2310e3c50&nbsp;
    <strong>3</strong>&nbsp;[0x72a0023][0x530d7],[
    <strong>TX</strong>] [19F000-0001-00000011] 0&nbsp;
    <br> BLOCKER 0x2310e7e80&nbsp;
    <strong>3</strong>&nbsp;[0x72a0023][0x530d7],[
    <strong>TX</strong>] [F1000-0001-0000000F] 0&nbsp;&nbsp;
    <br>
    <br> mode&nbsp;3&nbsp;is&nbsp;shared lock
   </div> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">The causes for TX deadlock in S mode wait can be:</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">a. ITL contention, eg: INITRANS setting for the object is too small, it can not handle the number of concurrent transactions.</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">The solution is to increase INITRANS setting for the object involved in the deadlock using "alter table" or "alter index" command<br> The SQL involved in the deadlock can be found in lmd0 or client trace. The object involved in the SQL should be checked including table and its associated index.</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">b. If the object involved is an unique key index, the wait could be caused by uniqueness validation. Application needs to be checked to avoid unique key violation.</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">c. If the object involved has a bitmap index, then the bitmap index should be dropped to accommodate concurrent DML. Please refer to&nbsp;<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?id=1496403.1" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 1496403.1</a>&nbsp;ORA-60 DEADLOCK DUE TO BITMAP INDEX IN RAC.&nbsp;<br><br></p> 
   <a name="aref_section23" style="border-bottom:1px dotted rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"></a>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <h4 style="color:rgb(0,0,136);font-size:12px;font-family:verdana, Arial, Helvetica, sans-serif;font-style:italic;">3. TM deadlock</h4> 
   <div class="kmcodeblock" style="color:rgb(51,51,51);font-size:14px;border:1px solid rgb(196,209,230);font-family:'Courier New', Courier, monospace;">
    trace shows:
    <br>
    <br> Global Wait-For-Graph(WFG) at ddTS[0.1] :
    <br> BLOCKED 0x7000003ccbf4798 3 wq 2 cvtops x1&nbsp;
    <strong>TM</strong>&nbsp;0x1cbde.0x0 [1004-004D-00000003] 0
    <br> BLOCKER 0x7000003d0bf9ad8 3 wq 1 cvtops x1 TM 0x1cbde.0x0 [200A-00AC-00000019] 1&nbsp;
    <br> BLOCKED 0x7000003d0bfcf88 2 wq 2 cvtops x1 TM 0x1cc77.0x0 [200A-00AC-00000019] 1&nbsp;
    <br> BLOCKER 0x7000003cc338e88 2 wq 2 cvtops x1 TM 0x1cc77.0x0 [2006-0063-00000055] 1&nbsp;
    <br> BLOCKED 0x7000003cc338e88 3 wq 2 cvtops x1 TM 0x1cc77.0x0 [2006-0063-00000055] 1&nbsp;
    <br> BLOCKER 0x7000003c879f9c0 3 wq 1 cvtops x1 TM 0x1cc77.0x0 [2006-0063-00000020] 1&nbsp;
    <br> BLOCKED 0x7000003c87978a8 2 wq 2 cvtops x1 TM 0x1cbde.0x0 [2006-0063-00000020] 1&nbsp;
    <br> BLOCKER 0x7000003ccbf4798 2 wq 2 cvtops x1 TM 0x1cbde.0x0 [1004-004D-00000003] 0
   </div> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">The object involved here are 0x1cdbe and 0x1cc77, convert the hex number to decimal, they are the object_id for the tables involved in above deadlock</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">The deadlock is usually caused by missing index for foreign key constraint, refer to&nbsp;<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3Eid=473124.1" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 473124.1</a>&nbsp;- "Frequent GES: Potential Blocker (Pid=nnnn) On Resource TM-&lt;id1&gt;-&lt;id2&gt;" for more information. Check dba_constraints and dba_index to verify if foreign key index is missing.&nbsp;Also refer to&nbsp;<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?id=1019527.6" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 1019527.6</a>&nbsp;Script to Check for Foreign Key Locking Issues for a Specific User which will generate a report for all problem objects.</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">The solution is to create index for every foreign key constraint.</p> 
   <a name="aref_section24" style="border-bottom:1px dotted rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"></a>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <h4 style="color:rgb(0,0,136);font-size:12px;font-family:verdana, Arial, Helvetica, sans-serif;font-style:italic;">4. Single resource deadlock for TX , TM or IV</h4> 
   <div class="kmcodeblock" style="color:rgb(51,51,51);font-size:14px;border:1px solid rgb(196,209,230);font-family:'Courier New', Courier, monospace;">
    trace shows:
    <br>
    <br> Single resource deadlock: blocking enqueue which blocks itself, f 1&nbsp;
    <br> Granted global enqueue 0xd078cec0
    <br> ...
    <br> resname :[0x2001f][0x1a96c3],[TX]
    <br> or&nbsp;
    <br> resname :[0x00001432][0x0],[TM]
    <br> or
    <br> resname : [0xbb7cc5db][0x82d0d4b5],[IV]
   </div> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"><br> a. For single resource deadlock on TX enqueue, often it is caused by using autonomous transaction in stored procedure or PL/SQL. It is a known issue that the use of autonomous transactions is vulnerable to deadlocks. Please check out Oracle® Database Concepts&nbsp;&nbsp;<a href="http://docs.oracle.com/cd/E11882_01/server.112/e25789/transact.htm#i7733" rel="nofollow" title="Overview of Autonomous Transactions" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Overview of Autonomous Transactions&nbsp;</a>for detail explanation. Since AUTONOMOUS transaction has been used in the stored procedure, the system would consider any DML statement under this transaction as a separate one (commit/rollback won't affect the parent), and this would cause conflict if the same row is involved in the parent transaction (INSERT, UPDATE or DELETE), and hence deadlock is reported rightly. Usually the SQL involved in the deadlock is called from a stored procedure or PL/SQL with the following line:</p> 
   <pre><strong>PRAGMA AUTONOMOUS_TRANSACTION;</strong></pre> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">To avoid such deadlock, please remove the autonomous transaction in the application code.</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">b. If there is no autonomous_transaction involved, please check out&nbsp;<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3Eid=6145177.8" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 6145177.8</a>, it can also be caused by&nbsp;<a href="https://support.oracle.com/epmos/faces/BugDisplay?id=6145177" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Bug 6145177</a>&nbsp;- Single resource deadlock with a zero DID</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">c. For single resource deadlock on TM enqueue, missing foreign key index is often the cause, please check case 3 for the solution.</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">d. For single resource deadlock type IV (Instance Validation), refer to&nbsp;<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?id=973178.1" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 973178.1</a>, as mentioned in&nbsp;<a href="https://support.oracle.com/epmos/faces/BugDisplay?%3C/p%3E%3Cp%3Eid=8843816" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Bug 8843816</a>, this message can be ignored.&nbsp;<a href="https://support.oracle.com/epmos/faces/BugDisplay?%3C/p%3E%3Cp%3Eid=8843816" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Bug 8843816</a>has been fixed in 11.1.</p> 
   <a name="aref_section25" style="border-bottom:1px dotted rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"></a>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <h4 style="color:rgb(0,0,136);font-size:12px;font-family:verdana, Arial, Helvetica, sans-serif;font-style:italic;">5. LB deadlock</h4> 
   <div class="kmcodeblock" style="color:rgb(51,51,51);font-size:14px;border:1px solid rgb(196,209,230);font-family:'Courier New', Courier, monospace;">
    Global Wait-For-Graph(WFG) at ddTS[0.390] :&nbsp;
    <br> BLOCKED 0x3bc3e1b48 5 wq 2 cvtops x0 [0xd2703c03][0x545a14a5],[
    <strong>LB</strong>] [7B000-0002-00006C9D] 1&nbsp;
    <br> BLOCKER 0x3bc2efad0 5 wq 1 cvtops x0 [0xd2703c03][0x545a14a5],[
    <strong>LB</strong>] [48000-0001-000069FE] 0&nbsp;
    <br> BLOCKED 0x3bc2ed1c0 3 wq 2 cvtops x0 [0x415d0160][0xca28e8cf],[
    <strong>LB</strong>] [48000-0001-000069FE] 0&nbsp;
    <br> BLOCKER 0x3bc2dc648 3 wq 2 cvtops x0 [0x415d0160][0xca28e8cf],[
    <strong>LB</strong>] [34000-0001-0000095E] 0&nbsp;
    <br> BLOCKED 0x3bc2dc648 5 wq 2 cvtops x0 [0x415d0160][0xca28e8cf],[
    <strong>LB</strong>] [34000-0001-0000095E] 0&nbsp;
    <br> BLOCKER 0x3bc2dbbb0 5 wq 1 cvtops x0 [0x415d0160][0xca28e8cf],[
    <strong>LB</strong>] [76000-0002-000074D4] 1&nbsp;
    <br> BLOCKED 0x3bc2ef830 3 wq 2 cvtops x0 [0xd2703c03][0x545a14a5],[
    <strong>LB</strong>] [76000-0002-000074D4] 1&nbsp;
    <br> BLOCKER 0x3bc3e1b48 3 wq 2 cvtops x0 [0xd2703c03][0x545a14a5],[
    <strong>LB</strong>] [7B000-0002-00006C9D] 1
   </div> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">LB lock type refers to library cache lock. This type of deadlock is usually caused by a bug.&nbsp;</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">For example:&nbsp;<a href="https://support.oracle.com/epmos/faces/BugDisplay?%3C/p%3E%3Cp%3Eid=6475688" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Bug 6475688</a>&nbsp; Concurrent rewrite and on-commit refresh can deadlock (library cache pin &lt;--&gt; lock)&nbsp;<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3Eid=6475688.8" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 6475688.8</a><br> The bug has been fixed in 11.1.0.7 and 11.2. Please apply patch accordingly.</p> 
   <a name="aref_section26" style="border-bottom:1px dotted rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"></a>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <h4 style="color:rgb(0,0,136);font-size:12px;font-family:verdana, Arial, Helvetica, sans-serif;font-style:italic;">6. Known Issues</h4> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">For other deadlock type or known issues related to dead lock,&nbsp;refer to&nbsp;<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?id=554567.1" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 554567.1</a>&nbsp;Summary Of Bugs Which Could Cause Deadlock In RAC Environment</p> 
   <a name="aref_section27" style="border-bottom:1px dotted rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"></a>
   <span style="color:rgb(51,51,51);font-family:verdana, Arial, Helvetica, sans-serif;font-size:14px;"></span> 
   <h4 style="color:rgb(0,0,136);font-size:12px;font-family:verdana, Arial, Helvetica, sans-serif;font-style:italic;">7. Further Diagnosis</h4> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">Please collect the following information for further diagnosis:</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">a. alert log lmd0, and trace mentioned in the alert log from all instances.<br> b. set the following event to collect systemstate dump&nbsp;<strong>ONLY</strong>&nbsp;if the information in trace files&nbsp;are insufficient:</p> 
   <div class="kmcodeblock" style="color:rgb(51,51,51);font-size:14px;border:1px solid rgb(196,209,230);font-family:'Courier New', Courier, monospace;">
    alter system set events '60 trace name systemstate level 258';
   </div> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">It will cause a systemstate dump to be generated whenever a deadlock is reported. If there are constant deadlocks, it could cause a lot of trace files being generated, monitor the system carefully.</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;">To turn off the trace:</p> 
   <div class="kmcodeblock" style="color:rgb(51,51,51);font-size:14px;border:1px solid rgb(196,209,230);font-family:'Courier New', Courier, monospace;">
    alter system set events '60 trace name context off';
   </div> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"><br> c. one can also refer to&nbsp;<a href="https://support.oracle.com/epmos/faces/DocumentDisplay?%3C/p%3E%3Cp%3Eid=1464909.1" rel="nofollow" style="color:rgb(0,0,0);border-bottom:1px dotted rgb(51,51,51);">Document 1464909.1</a>&nbsp;Identify sql statements involved in Deadlock via Logminer to gather SQL information.</p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"><br></p> 
   <p style="color:rgb(51,51,51);font-family:Tahoma, Verdana, Helvetica, sans-serif;font-size:12px;"><br></p> 
   <p><font color="#333333"><span style="font-size:12px;">本文转自mfrbuaa博客园博客，原文链接：http://www.cnblogs.com/mfrbuaa/p/5063609.html，如需转载请自行联系原作者</span></font></p> 
   <div>
    <br>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
