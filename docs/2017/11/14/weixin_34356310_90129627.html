<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>[设计模式]工厂方法模式 « NotBeCN</title>
  <meta name="description" content="             1 女娲造人的故事    东汉《风俗通》记录了一则神话故事：“开天辟地，未有人民，女娲搏黄土做人”，讲述的内容就是大家非常熟悉的女娲造人的故事。开天辟地之初，大地上并没有生物，只有苍茫大地，纯粹而洁净的自然环境，寂静而又寂寞，于是女娲决定创造一个新物种（即人类）来增加世界的繁荣，怎么制造...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/14/weixin_34356310_90129627.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">[设计模式]工厂方法模式</h1>
    <p class="post-meta">Nov 14, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;">1 女娲造人的故事</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">东汉《风俗通》记录了一则神话故事：“开天辟地，未有人民，女娲搏黄土做人”，讲述的内容就是大家非常熟悉的女娲造人的故事。开天辟地之初，大地上并没有生物，只有苍茫大地，纯粹而洁净的自然环境，寂静而又寂寞，于是女娲决定创造一个新物种（即人类）来增加世界的繁荣，怎么制造呢？<br> 别忘了女娲是神仙，没有办不到的事情，造人的过程是这样的：首先，女娲采集黄土捏成人的形状，然后放到八卦炉中烧制，最后放置到大地上生长，工艺过程是没有错的，但是意外随时都会发生：<br> 第一次烤泥人，感觉应该熟了，往大地上一放，哇，没烤熟！于是一个白人诞生了！（这也是缺乏经验的最好证明。）<br> 第二次烤泥人，上一次没烤熟，这次多烤一会儿，放到世间一看，嘿，熟过头了，于是黑人诞生了！<br> 第三次烤泥人，一边烧制一边察看，直到表皮微黄，嘿，刚刚好，于是黄色人种出现了！</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">这个造人过程是比较有意思的，是不是可以通过软件开发来实现这个过程呢？古人云：“三人行，必有我师焉”，在面向对象的思维中，万物皆对象，是对象我们就可以通过软<br> 件设计来实现。首先对造人过程进行分析，<span>该过程涉及三个对象：女娲、八卦炉、三种不同肤色的人</span>。女娲可以使用场景类Client来表示，八卦炉类似于一个工厂，负责制造生产产品<br> （即人类），三种不同肤色的人，他们都是同一个接口下的不同实现类，都是人嘛，只是肤色、语言不同，对于八卦炉来说都是它生产出的产品。分析完毕，我们就可以画出如下所示的类图。<br> 类图比较简单，AbstractHumanFactory是一个抽象类，定义了一个八卦炉具有的整体功能，HumanFactory为实现类，完成具体的任务——创建人类；Human接口是人类的总称，其三个实现类分别为三类人种；NvWa类是一个场景类，负责模拟这个场景，执行相关的任务。<br> 我们定义的每个人种都有两个方法：getColor（获得人的皮肤颜色）和talk（交谈），其源代码如代码清如下所示:</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">图</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images0.cnblogs.com/blog2015/610238/201508/021105102359274.jpg" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;代码:</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">interface</span><span style="line-height:1.5;"> Human {
    
    </span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">每个人种都有相应的颜色</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> getColor();
    
    </span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">人类会说话</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> talk();  

}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">接口Human是对人类的总称，每个人种都至少具有两个方法，黑色人种、黄色人种、白色人种的代码分别如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">黑色人种:</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span> BlackHuman <span style="color:rgb(0,0,255);line-height:1.5;">implements</span><span style="line-height:1.5;"> Human {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> getColor(){
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         System.out.println("黑色人种的皮肤颜色是黑色的！"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> talk() {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>         System.out.println("黑人会说话，一般人听不懂。"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">10</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">12</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">黄色人种:</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span> YellowHuman <span style="color:rgb(0,0,255);line-height:1.5;">implements</span><span style="line-height:1.5;"> Human {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> getColor(){
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         System.out.println("黄色人种的皮肤颜色是黄色的！"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> talk() {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>         System.out.println("黄色人种会说话，一般说的都是双字节。"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">10</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">12</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">白色人种:</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span> WhiteHuman <span style="color:rgb(0,0,255);line-height:1.5;">implements</span><span style="line-height:1.5;"> Human {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span>     
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">白色人种的颜色是白色的</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> getColor(){
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>         System.out.println("白色人种的皮肤颜色是白色的！"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>     
<span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">白色人种讲话</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 9</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> talk() {
</span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>         System.out.println("白色人种会说话，一般都是但是单字节。"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">12</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">13</span>     
<span style="color:rgb(0,128,128);line-height:1.5;">14</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;所有的人种定义完毕，下一步就是定义一个八卦炉，然后烧制人类。<span>我们想象一下，女娲最可能给八卦炉下达什么样的生产命令呢？应该是“给我生产出一个黄色人种</span><br><span>（YellowHuman类）”，而不会是“给我生产一个会走、会跑、会说话、皮肤是黄色的人种”，因为这样的命令增加了交流的成本，作为一个生产的管理者，只要知道生产什么就可以了，而不需要事物的具体信息。</span>通过分析，<span>我们发现八卦炉生产人类的方法输入参数类型应该是Human接口的实现类，这也解释了为什么类图上的AbstractHumanFactory抽象类中createHuman方法的参数为Class类型。</span>其源代码如代码清单如下所示。<br> 代码清单 抽象人类创建工厂</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">abstract</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> AbstractHumanFactory {

    </span><span style="line-height:1.5;"><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">abstract</span> &lt;T <span style="color:rgb(0,0,255);line-height:1.5;">extends</span> Human&gt; T createHuman(Class&lt;T&gt;</span><span style="line-height:1.5;"><span style="line-height:1.5;"> c);</span>
    
}</span></pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">注意，我们在这里采用了泛型（Generic），通过定义泛型对createHuman的输入参数产生两层限制：<br> ● 必须是Class类型；<br> ● 必须是Human的实现类。<br> 其中的"T"表示的是，只要实现了Human接口的类都可以作为参数，泛型是JDK 1.5中的一个非常重要的新特性，它减少了对象间的转换，约束其输入参数类型，对Collection集合下的实现类都可以定义泛型。有关泛型的详细知识，请参考相关的Java语法文档。<br> 目前女娲只有一个八卦炉，其实现生产人类的方法，如代码清单如下所示。<br> 代码清单 人类创建工厂</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span> HumanFactory <span style="color:rgb(0,0,255);line-height:1.5;">extends</span><span style="line-height:1.5;"> AbstractHumanFactory {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span>     
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> &lt;T <span style="color:rgb(0,0,255);line-height:1.5;">extends</span> Human&gt; T createHuman(Class&lt;T&gt;<span style="line-height:1.5;"> c){
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">定义一个生产的人种</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>         Human human=<span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">;      
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>         <span style="color:rgb(0,0,255);line-height:1.5;">try</span><span style="line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>              <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">产生一个人种</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>             <span style="line-height:1.5;">human =</span><span style="line-height:1.5;"><span style="line-height:1.5;"> (Human)Class.forName(c.getName()).newInstance();</span>              
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span>         } <span style="color:rgb(0,0,255);line-height:1.5;">catch</span><span style="line-height:1.5;"> (Exception e) {
</span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>             System.out.println("人种生成错误！"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">12</span>         <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> (T)human;
</span><span style="color:rgb(0,128,128);line-height:1.5;">13</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">14</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">人种有了，八卦炉也有了，剩下的工作就是女娲采集黄土，然后命令八卦炉开始生产，其过程如代码清单如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">女娲类:</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> NvWa {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> main(String[] args) {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">声明阴阳八卦炉</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>        <span style="line-height:1.5;"> AbstractHumanFactory YinYangLu = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> HumanFactory(); </span></span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>         
<span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">女娲第一次造人，火候不足，缺陷产品</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>         System.out.println("--造出的第三批人是白色人种--"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span>        <span style="line-height:1.5;"> Human whiteHuman = YinYangLu.createHuman(WhiteHuman.<span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;">); </span></span><span style="color:rgb(0,128,128);line-height:1.5;">10</span> <span style="line-height:1.5;">        whiteHuman.getColor();
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span> <span style="line-height:1.5;">        whiteHuman.talk();
</span><span style="color:rgb(0,128,128);line-height:1.5;">12</span>         
<span style="color:rgb(0,128,128);line-height:1.5;">13</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">女娲第二次造人，火候过足，又是次品，</span>
<span style="color:rgb(0,128,128);line-height:1.5;">14</span>         System.out.println("\n--造出的第三批人是黑色人种--"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">15</span>         Human blackHuman = YinYangLu.createHuman(BlackHuman.<span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">16</span> <span style="line-height:1.5;">        blackHuman.getColor();
</span><span style="color:rgb(0,128,128);line-height:1.5;">17</span> <span style="line-height:1.5;">        blackHuman.talk();
</span><span style="color:rgb(0,128,128);line-height:1.5;">18</span>         
<span style="color:rgb(0,128,128);line-height:1.5;">19</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">第三次造人，火候正正好，优品！黄色人种</span>
<span style="color:rgb(0,128,128);line-height:1.5;">20</span>         System.out.println("\n--造出的第三批人是黄色人种--"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">21</span>         Human yellowHuman = YinYangLu.createHuman(YellowHuman.<span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">22</span> <span style="line-height:1.5;">        yellowHuman.getColor();
</span><span style="color:rgb(0,128,128);line-height:1.5;">23</span> <span style="line-height:1.5;">        yellowHuman.talk();
</span><span style="color:rgb(0,128,128);line-height:1.5;">24</span>             
<span style="color:rgb(0,128,128);line-height:1.5;">25</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">26</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">27</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">人种有了，八卦炉有了，负责生产的女娲也有了，激动人心的时刻到来了，我们运行一下，结果如下所示。</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>--造出的第三批人是白色人种--<span style="line-height:1.5;">
白色人种的皮肤颜色是白色的！
白色人种会说话，一般都是但是单字节。

</span>--造出的第三批人是黑色人种--<span style="line-height:1.5;">
黑色人种的皮肤颜色是黑色的！
黑人会说话，一般人听不懂。

</span>--造出的第三批人是黄色人种--<span style="line-height:1.5;">
黄色人种的皮肤颜色是黄色的！
黄色人种会说话，一般说的都是双字节。</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;">2 工厂方法模式的定义</span><span style="line-height:1.5;"><br></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">工厂方法模式使用的频率非常高，在我们日常的开发中总能见到它的身影。其定义为：</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Define an interface for creating an object,but let subclasses decide which class toinstantiate.Factory Method lets a class defer instantiation to subclasses.</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">(定义一个用于创建对象的接口，让子类决定实例化哪一个类。工厂方法使一个类的实例化延迟到其子类。）<br> 工厂方法模式的通用类图如图所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images0.cnblogs.com/blog2015/610238/201508/021131470019087.jpg" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;在工厂方法模式中，<span>抽象产品类Product负责定义产品的共性，实现对事物最抽象的定义；Creator为抽象创建类，也就是抽象工厂，具体如何创建产品类是由具体的实现工厂</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span>ConcreteCreator完成的。</span>工厂方法模式的变种较多，我们来看一个比较实用的通用源码。<br> 抽象产品类代码如代码清单如下所示:<br> 代码清单</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">抽象产品类</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">abstract</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> Product {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span>     
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">产品类的公共方法</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> method1(){
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">业务逻辑处理</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 6</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>     
<span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">抽象方法1</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 9</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">abstract</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> method2();
</span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>     
<span style="color:rgb(0,128,128);line-height:1.5;">11</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;具体的产品类可以有多个，都继承于抽象产品类，其源代码如代码清单如下所示:</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span> ConcreteProduct1 <span style="color:rgb(0,0,255);line-height:1.5;">extends</span><span style="line-height:1.5;"> Product {

    </span><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> method2() {
        </span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">业务逻辑处理</span>
<span style="line-height:1.5;">    }

}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&amp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span> ConcreteProduct2 <span style="color:rgb(0,0,255);line-height:1.5;">extends</span><span style="line-height:1.5;"> Product {

    </span><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> method2() {
        </span><span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">业务逻辑处理</span>
<span style="line-height:1.5;">    }

}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;抽象工厂类负责定义产品对象的产生，源代码如代码清单如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">代码清单如下 抽象工厂类</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">abstract</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> Creator {
    
    </span><span style="color:rgb(0,128,0);line-height:1.5;">/*</span><span style="color:rgb(0,128,0);line-height:1.5;">
     * 创建一个产品对象,其输入参数类型可以自行设置
     * 通常为String、Enum、Class等，当然也可以为空
     </span><span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
    <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">abstract</span> &lt;T <span style="color:rgb(0,0,255);line-height:1.5;">extends</span> Product&gt; T createProduct(Class&lt;T&gt;<span style="line-height:1.5;"> c);
}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">具体如何产生一个产品的对象，是由具体的工厂类实现的，如代码清单如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">代码清单 具体工厂类</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="line-height:1.5;"><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span> ConcreteCreator <span style="color:rgb(0,0,255);line-height:1.5;">extends</span><span style="line-height:1.5;"> Creator { </span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span>     
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> &lt;T <span style="color:rgb(0,0,255);line-height:1.5;">extends</span> Product&gt; T createProduct(Class&lt;T&gt;<span style="line-height:1.5;"> c){ </span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         Product product=<span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">; </span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>         <span style="color:rgb(0,0,255);line-height:1.5;">try</span><span style="line-height:1.5;"> { </span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>              product =<span style="line-height:1.5;"> (Product)Class.forName(c.getName()).newInstance(); </span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>         } <span style="color:rgb(0,0,255);line-height:1.5;">catch</span><span style="line-height:1.5;"> (Exception e) { </span><span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">异常处理</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 9</span> <span style="line-height:1.5;"> } </span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>         <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> (T)product; </span><span style="color:rgb(0,128,128);line-height:1.5;">11</span> <span style="line-height:1.5;"> } </span><span style="color:rgb(0,128,128);line-height:1.5;">12</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">13</span> }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;场景类的调用方法如代码清单如下所示。</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="line-height:1.5;"><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> Client { </span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span>     
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> main(String[] args) { </span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         Creator creator = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> ConcreteCreator(); </span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>         Product product = creator.createProduct(ConcreteProduct1.<span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;">); </span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>         <span style="color:rgb(0,128,0);line-height:1.5;">/*</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 7</span> <span style="color:rgb(0,128,0);line-height:1.5;"> * 继续业务处理 </span><span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>          <span style="color:rgb(0,128,0);line-height:1.5;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 9</span> <span style="line-height:1.5;"> } </span><span style="color:rgb(0,128,128);line-height:1.5;">10</span> }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">该通用代码是一个比较实用、易扩展的框架，读者可以根据实际项目需要进行扩展。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;">&nbsp;3 工厂方法模式的应用</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:14pt;">&nbsp; &nbsp;3.1 工厂方法模式的优点</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;首先，良好的封装性，代码结构清晰。一个对象创建是有条件约束的，如一个调用者需要一个具体的产品对象，只要知道这个产品的类名（或约束字符串）就可以了，不用知道创</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">建对象的艰辛过程，降低模块间的耦合。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">其次，工厂方法模式的扩展性非常优秀。在增加产品类的情况下，只要适当地修改具体的工厂类或扩展一个工厂类，就可以完成“拥抱变化”。例如在我们的例子中，需要增加一个<br> 棕色人种，则只需要增加一个BrownHuman类，工厂类不用任何修改就可完成系统扩展。<br><span>再次，屏蔽产品类。这一特点非常重要，产品类的实现如何变化，调用者都不需要关心，它只需要关心产品的接口，只要接口保持不变，系统中的上层模块就不要发生变化。</span>因<br><span>为产品类的实例化工作是由工厂类负责的，一个产品对象具体由哪一个产品生成是由工厂类决定的。</span>在<span>数据库开发中，大家应该能够深刻体会到工厂方法模式的好处：如果使用JDBC</span><br><span>连接数据库，数据库从MySQL切换到Oracle，需要改动的地方就是切换一下驱动名称（前提条件是SQL语句是标准语句），其他的都不需要修改，这是工厂方法模式灵活性的一个直接案例。</span><br> 最后，工厂方法模式是典型的解耦框架。高层模块值需要知道产品的抽象类，其他的实现类都不用关心，符合迪米特法则，我不需要的就不要去交流；也符合依赖倒置原则，只依<br> 赖产品类的抽象；当然也符合里氏替换原则，使用产品子类替换产品父类，没问题！</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:14pt;"><em>&nbsp;</em>3.2 工厂方法模式的使用场景</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">首先，工厂方法模式是new一个对象的替代品，所以在所有需要生成对象的地方都可以使用，<span>但是需要慎重地考虑是否要增加一个工厂类进行管理，增加代码的复杂度。</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br><span>其次，需要灵活的、可扩展的框架时，可以考虑采用工厂方法模式</span>。<span>万物皆对象，那万物也就皆产品类，例如需要设计一个连接邮件服务器的框架，有三种网络协议可供选择：</span><br><span>POP3、IMAP、HTTP，我们就可以把这三种连接方法作为产品类</span>，定义一个接口如IConnectMail，然后定义对邮件的操作方法，用不同的方法实现三个具体的产品类（也就是<br> 连接方式）再定义一个工厂方法，按照不同的传入条件，选择不同的连接方式。如此设计，可以做到完美的扩展，如某些邮件服务器提供了WebService接口，很好，我们只要增加一个产品类就可以了。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br> 再次，工厂方法模式可以用在异构项目中，例如通过WebService与一个非Java的项目交互，虽然WebService号称是可以做到异构系统的同构化，但是在实际的开发中，还是会碰到<br> 很多问题，如类型问题、WSDL文件的支持问题，等等。从WSDL中产生的对象都认为是一个产品，然后由一个具体的工厂类进行管理，减少与外围系统的耦合。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">最后，可以使用在测试驱动开发的框架下。例如，测试一个类A，就需要把与类A有关联关系的类B也同时产生出来，我们可以使用工厂方法模式把类B虚拟出来，避免类A与类B<br> 的耦合。目前由于JMock和EasyMock的诞生，该使用场景已经弱化了，读者可以在遇到此种情况时直接考虑使用JMock或EasyMock。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;">4 工厂方法模式的扩展</span><br><span style="font-size:14pt;">1. 缩小为简单工厂模式</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">我们这样考虑一个问题<span>：一个模块仅需要一个工厂类，没有必要把它产生出来，使用静态的方法就可以了，根据这一要求，我们把上例中的AbstarctHumanFactory修改一下</span>，类图如下所示:</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images0.cnblogs.com/blog2015/610238/201508/021251331892313.jpg" alt="" style="border:0px;"><span style="font-size:16px;">vs</span>之前的<img src="https://images0.cnblogs.com/blog2015/610238/201508/021433167822431.jpg" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><em>&nbsp;</em></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">我们在类图中<span>去掉了AbstractHumanFactory抽象类，同时把createHuman方法设置为静态类型，简化了类的创建过程，变更的源码仅仅是HumanFactory和NvWa类，</span>HumanFactory如代码清单如下所示:<br> 代码清单 简单工厂模式中的工厂类</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> HumanFactory {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span>     
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static </span>&lt;T <span style="color:rgb(0,0,255);line-height:1.5;">extends</span> Human&gt; T createHuman(Class&lt;T&gt;<span style="line-height:1.5;"> c){
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">定义一个生产的人种</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>         Human human=<span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">;      
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>         <span style="color:rgb(0,0,255);line-height:1.5;">try</span><span style="line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>              <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">产生一个人种</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>             human =<span style="line-height:1.5;"> (Human)Class.forName(c.getName()).newInstance();              
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span>         } <span style="color:rgb(0,0,255);line-height:1.5;">catch</span><span style="line-height:1.5;"> (Exception e) {
</span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>             System.out.println("人种生成错误！"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">12</span>         <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> (T)human;
</span><span style="color:rgb(0,128,128);line-height:1.5;">13</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">14</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span>HumanFactory类仅有两个地方发生变化：去掉继承抽象类，并在createHuman前增加static关键字</span>；工厂类发生变化，也同时引起了调用者NvWa的变化，如代码清单如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">代码清单 简单工厂模式中的场景类</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> NvWa {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> main(String[] args) {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         
<span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">女娲第一次造人，火候不足，缺陷产品</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>         System.out.println("--造出的第三批人是白色人种--"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>         Human whiteHuman = HumanFactory.createHuman(WhiteHuman.<span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 8</span> <span style="line-height:1.5;">        whiteHuman.getColor();
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span> <span style="line-height:1.5;">        whiteHuman.talk();
</span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>         
<span style="color:rgb(0,128,128);line-height:1.5;">11</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">女娲第二次造人，火候过足，又是次品，</span>
<span style="color:rgb(0,128,128);line-height:1.5;">12</span>         System.out.println("\n--造出的第三批人是黑色人种--"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">13</span>         Human blackHuman = HumanFactory.createHuman(BlackHuman.<span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">14</span> <span style="line-height:1.5;">        blackHuman.getColor();
</span><span style="color:rgb(0,128,128);line-height:1.5;">15</span> <span style="line-height:1.5;">        blackHuman.talk();
</span><span style="color:rgb(0,128,128);line-height:1.5;">16</span>         
<span style="color:rgb(0,128,128);line-height:1.5;">17</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">第三次造人，火候正正好，优品！黄色人种</span>
<span style="color:rgb(0,128,128);line-height:1.5;">18</span>         System.out.println("\n--造出的第三批人是黄色人种--"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">19</span>         Human yellowHuman = HumanFactory.createHuman(YellowHuman.<span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">20</span> <span style="line-height:1.5;">        yellowHuman.getColor();
</span><span style="color:rgb(0,128,128);line-height:1.5;">21</span> <span style="line-height:1.5;">        yellowHuman.talk();
</span><span style="color:rgb(0,128,128);line-height:1.5;">22</span>             
<span style="color:rgb(0,128,128);line-height:1.5;">23</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">24</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">25</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span>运行结果没有发生变化，但是我们的类图变简单了，而且调用者也比较简单，该模式是工厂方法模式的弱化，因为简单，所以称为简单工厂模式（Simple Factory Pattern），也叫做静态工厂模式</span>。在实际项目中，<span>采用该方法的案例还是比较多的，其缺点是工厂类的扩展比较困难，不符合开闭原则，但它仍然是一个非常实用的设计模式。</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:14pt;">&nbsp;2. 升级为多个工厂类</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;当我们在做一个比较复杂的项目时，经常会遇到初始化一个对象很耗费精力的情况，所有的产品类都放到一个工厂方法中进行初始化会使代码结构不清晰。例如，一个产品类有5</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">个具体实现，每个实现类的初始化（不仅仅是new，初始化包括new一个对象，并对对象设置一定的初始值）方法都不相同，如果写在一个工厂方法中，势必会导致该方法巨大无比，那该怎么办？<br> 考虑到需要结构清晰，我们就为每个产品定义一个创造者，然后由调用者自己去选择与哪个工厂方法关联。我们还是以女娲造人为例，每个人种都有一个固定的八卦炉，分别造出<br> 黑色人种、白色人种、黄色人种，修改后的类图如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;<img src="https://images0.cnblogs.com/blog2015/610238/201508/021256062824281.jpg" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span>每个人种（具体的产品类）都对应了一个创建者，每个创建者都独立负责创建对应的产品对象，非常符合单一职责原则，按照这种模式我们来看看代码变化。</span><br> 多工厂模式的抽象工厂类如代码清单如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">多工厂模式的抽象工厂类<em>&nbsp;</em></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">abstract</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> AbstractHumanFactory {

    </span><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">abstract</span><span style="line-height:1.5;"> Human createHuman();
    
}</span></pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;注意　抽象方法中已经不再需要传递相关参数了，因为每一个具体的工厂都已经非常明确自己的职责：创建自己负责的产品类对象。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;黑色人种的创建工厂如代码</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span> BlackHumanFactory <span style="color:rgb(0,0,255);line-height:1.5;">extends</span><span style="line-height:1.5;"> AbstractHumanFactory {

    </span><span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;"> Human createHuman() {
        </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> BlackHuman();
    }
}</span></pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.5;">&amp;</span></p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span> WhiteHumanFactory <span style="color:rgb(0,0,255);line-height:1.5;">extends</span><span style="line-height:1.5;"> AbstractHumanFactory {

    </span><span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;"> Human createHuman() {
        </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> YellowHuman();
    }
}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&amp;&nbsp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span> YellowHumanFactory <span style="color:rgb(0,0,255);line-height:1.5;">extends</span><span style="line-height:1.5;"> AbstractHumanFactory {

    </span><span style="color:rgb(0,0,255);line-height:1.5;">public</span><span style="line-height:1.5;"> Human createHuman() {
        </span><span style="color:rgb(0,0,255);line-height:1.5;">return</span> <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> WhiteHuman();
    }
}</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;三个具体的创建工厂都非常简单，但是，如果一个系统比较复杂时工厂类也会相应地变复杂。场景类NvWa修改后的代码如代码清单如下所示。</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> NvWa {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> main(String[] args) {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         
<span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">女娲第一次造人，火候不足，缺陷产品</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>         System.out.println("--造出的第三批人是白色人种--"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>         Human whiteHuman = (<span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> WhiteHumanFactory()).createHuman();
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 8</span> <span style="line-height:1.5;">        whiteHuman.getColor();
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span> <span style="line-height:1.5;">        whiteHuman.talk();
</span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>         
<span style="color:rgb(0,128,128);line-height:1.5;">11</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">女娲第二次造人，火候过足，又是次品，</span>
<span style="color:rgb(0,128,128);line-height:1.5;">12</span>         System.out.println("\n--造出的第三批人是黑色人种--"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">13</span>         Human blackHuman = (<span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> BlackHumanFactory()).createHuman();
</span><span style="color:rgb(0,128,128);line-height:1.5;">14</span> <span style="line-height:1.5;">        blackHuman.getColor();
</span><span style="color:rgb(0,128,128);line-height:1.5;">15</span> <span style="line-height:1.5;">        blackHuman.talk();
</span><span style="color:rgb(0,128,128);line-height:1.5;">16</span>         
<span style="color:rgb(0,128,128);line-height:1.5;">17</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">第三次造人，火候正正好，优品！黄色人种</span>
<span style="color:rgb(0,128,128);line-height:1.5;">18</span>         System.out.println("\n--造出的第三批人是黄色人种--"<span style="line-height:1.5;">);
</span><span style="color:rgb(0,128,128);line-height:1.5;">19</span>         Human yellowHuman = (<span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> YellowHumanFactory()).createHuman();
</span><span style="color:rgb(0,128,128);line-height:1.5;">20</span> <span style="line-height:1.5;">        yellowHuman.getColor();
</span><span style="color:rgb(0,128,128);line-height:1.5;">21</span> <span style="line-height:1.5;">        yellowHuman.talk();
</span><span style="color:rgb(0,128,128);line-height:1.5;">22</span>             
<span style="color:rgb(0,128,128);line-height:1.5;">23</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">24</span> 
<span style="color:rgb(0,128,128);line-height:1.5;">25</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;运行结果还是相同。我们回顾一下，每一个产品类都对应了一个创建类，好处就是创建类的职责清晰，而且结构简单，但是给可扩展性和可维护性带来了一定的影响。为什么这么</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">说呢？如果要扩展一个产品类，就需要建立一个相应的工厂类，这样就增加了扩展的难度。<br> 因为工厂类和产品类的数量相同，维护时需要考虑两个对象之间的关系。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span>当然，在复杂的应用中一般采用多工厂的方法，然后再增加一个协调类，避免调用者与各个子工厂交流，协调类的作用是封装子工厂类，对高层模块提供统一的访问接口。</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:14pt;">&nbsp;3. 替代单例模式</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">单例模式以及扩展出的多例模式中，并且指出了单例和多例的一些缺点，我们是不是<span>可以采用工厂方法模式实现单例模式的功能呢？单例模式的核心要求就是在内存中</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span>只有一个对象，通过工厂方法模式也可以只在内存中生产一个对象，</span>类图如图如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><em><img src="https://images0.cnblogs.com/blog2015/610238/201508/021300442207202.jpg" alt="" style="border:0px;"></em></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;非常简单的类图，Singleton定义了一个private的无参构造函数，目的是不允许通过new的方式创建一个对象，如代码清单如下所示。</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> Singleton {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span>     
<span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">不允许通过new产生一个对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>     <span style="color:rgb(0,0,255);line-height:1.5;">private</span><span style="line-height:1.5;"> Singleton(){
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>         
<span style="color:rgb(0,128,128);line-height:1.5;"> 6</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>     
<span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> doSomething(){
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">业务处理</span>
<span style="color:rgb(0,128,128);line-height:1.5;">10</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Singleton保证不能通过正常的渠道建立一个对象，那SingletonFactory如何建立一个单例对象呢？答案是通过反射方式创建，如代码清单如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">负责生成单例的工厂类</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="line-height:1.5;"><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> SingletonFactory { </span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span>     <span style="color:rgb(0,0,255);line-height:1.5;">private</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span><span style="line-height:1.5;"> Singleton singleton; </span><span style="color:rgb(0,128,128);line-height:1.5;"> 3</span>     <span style="color:rgb(0,0,255);line-height:1.5;">static</span><span style="line-height:1.5;">{ </span><span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>         <span style="color:rgb(0,0,255);line-height:1.5;">try</span><span style="line-height:1.5;"> { </span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>             Class cl= Class.forName(Singleton.<span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;">.getName()); </span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">获得无参构造</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>             Constructor constructor=<span style="line-height:1.5;">cl.getDeclaredConstructor(); </span><span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">设置无参构造是可访问的</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 9</span>             constructor.setAccessible(<span style="color:rgb(0,0,255);line-height:1.5;">true</span><span style="line-height:1.5;">); </span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">产生一个实例对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;">11</span>             singleton =<span style="line-height:1.5;"> (Singleton)constructor.newInstance(); </span><span style="color:rgb(0,128,128);line-height:1.5;">12</span>         } <span style="color:rgb(0,0,255);line-height:1.5;">catch</span><span style="line-height:1.5;"> (Exception e) { </span><span style="color:rgb(0,128,128);line-height:1.5;">13</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;">异常处理</span>
<span style="color:rgb(0,128,128);line-height:1.5;">14</span> <span style="line-height:1.5;"> } </span><span style="color:rgb(0,128,128);line-height:1.5;">15</span> <span style="line-height:1.5;"> } </span><span style="color:rgb(0,128,128);line-height:1.5;">16</span>     
<span style="color:rgb(0,128,128);line-height:1.5;">17</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span><span style="line-height:1.5;"> Singleton getSingleton(){ </span><span style="color:rgb(0,128,128);line-height:1.5;">18</span>         <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> singleton; </span><span style="color:rgb(0,128,128);line-height:1.5;">19</span> <span style="line-height:1.5;"> } </span><span style="color:rgb(0,128,128);line-height:1.5;">20</span> }</span></pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;&nbsp;&amp;</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;">
    <pre><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> Client {
    </span><span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">void</span><span style="line-height:1.5;"> main(String[] args) {
        SingletonFactory.getSingleton().doSomething();
    }
}</span></pre>
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">通过获得类构造器，然后设置访问权限，生成一个对象，然后提供外部访问，保证内存中的对象唯一。当然，其他类也可以通过反射的方式建立一个单例对象，确实如此，但是一</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">个项目或团队是有章程和规范的，何况已经提供了一个获得单例对象的方法，为什么还要重新创建一个新对象呢？除非是有人作恶。<br> 以上通过工厂方法模式创建了一个单例对象，该框架可以继续扩展，在一个项目中可以产生一个单例构造器，所有需要产生单例的类都遵循一定的规则（构造方法是private），然<br> 后通过扩展该框架，只要输入一个类型就可以获得唯一的一个实例。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:14pt;">&nbsp;4. 延迟初始化</span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span>何为延迟初始化（Lazy initialization）</span>？一个对象被消费完毕后，并不立刻释放，工厂类保持其初始状态，等待再次被使用。延迟初始化是工厂方法模式的一个扩展应用，其通用类图如图如下所示。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images0.cnblogs.com/blog2015/610238/201508/021303358766861.jpg" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">ProductFactory负责产品类对象的创建工作，并且通过prMap变量产生一个缓存，对需要再次被重用的对象保留，Product和ConcreteProduct是一个示例代码。ProductFactory如代码清单如下所示:</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre><span style="color:rgb(0,128,128);line-height:1.5;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">class</span><span style="line-height:1.5;"> ProductFactory {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 2</span>     <span style="color:rgb(0,0,255);line-height:1.5;">private</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">final</span> Map&lt;String, Product&gt; prMap = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> HashMap();
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 3</span> 
<span style="color:rgb(0,128,128);line-height:1.5;"> 4</span>     <span style="color:rgb(0,0,255);line-height:1.5;">public</span> <span style="color:rgb(0,0,255);line-height:1.5;">static</span> <span style="color:rgb(0,0,255);line-height:1.5;">synchronized</span><span style="line-height:1.5;"> Product createProduct(String type)
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 5</span>             <span style="color:rgb(0,0,255);line-height:1.5;">throws</span><span style="line-height:1.5;"> Exception {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 6</span>         Product product = <span style="color:rgb(0,0,255);line-height:1.5;">null</span><span style="line-height:1.5;">;
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 7</span>         <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 如果Map中已经有这个对象</span>
<span style="color:rgb(0,128,128);line-height:1.5;"> 8</span>         <span style="color:rgb(0,0,255);line-height:1.5;">if</span><span style="line-height:1.5;"> (prMap.containsKey(type)) {
</span><span style="color:rgb(0,128,128);line-height:1.5;"> 9</span>             product =<span style="line-height:1.5;"> prMap.get(type);
</span><span style="color:rgb(0,128,128);line-height:1.5;">10</span>         } <span style="color:rgb(0,0,255);line-height:1.5;">else</span><span style="line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);line-height:1.5;">11</span>             <span style="color:rgb(0,0,255);line-height:1.5;">if</span> (type.equals("Product1"<span style="line-height:1.5;">)) {
</span><span style="color:rgb(0,128,128);line-height:1.5;">12</span>                 product = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> ConcreteProduct1();
</span><span style="color:rgb(0,128,128);line-height:1.5;">13</span>             } <span style="color:rgb(0,0,255);line-height:1.5;">else</span><span style="line-height:1.5;"> {
</span><span style="color:rgb(0,128,128);line-height:1.5;">14</span>                 product = <span style="color:rgb(0,0,255);line-height:1.5;">new</span><span style="line-height:1.5;"> ConcreteProduct2();
</span><span style="color:rgb(0,128,128);line-height:1.5;">15</span> <span style="line-height:1.5;">            }
</span><span style="color:rgb(0,128,128);line-height:1.5;">16</span>             <span style="color:rgb(0,128,0);line-height:1.5;">//</span><span style="color:rgb(0,128,0);line-height:1.5;"> 同时把对象放到缓存容器中</span>
<span style="color:rgb(0,128,128);line-height:1.5;">17</span> <span style="line-height:1.5;">            prMap.put(type, product);
</span><span style="color:rgb(0,128,128);line-height:1.5;">18</span> <span style="line-height:1.5;">        }
</span><span style="color:rgb(0,128,128);line-height:1.5;">19</span>         <span style="color:rgb(0,0,255);line-height:1.5;">return</span><span style="line-height:1.5;"> product;
</span><span style="color:rgb(0,128,128);line-height:1.5;">20</span> <span style="line-height:1.5;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5;">21</span> }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="line-height:1.5;">代码还比较简单，通过定义一个Map容器，容纳所有产生的对象，如果在Map容器中已</span>经有的对象，则直接取出返回；如果没有，则根据需要的类型产生一个对象并放入到Map容器中，以方便下次调用。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">延迟加载框架是可以扩展的，例如限制某一个产品类的最大实例化数量，可以通过判断Map中已有的对象数量来实现，这样的处理是非常有意义的，例如JDBC连接数据库，都会<br> 要求设置一个MaxConnections最大连接数量，该数量就是内存中最大实例化的数量。<br> 延迟加载还可以用在对象初始化比较复杂的情况下，例如硬件访问，涉及多方面的交互，则可以通过延迟加载降低对象的产生和销毁带来的复杂性。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><em><span style="font-size:14pt;">5 最佳实践</span></em></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">工厂方法模式在项目中使用得非常频繁，以至于很多代码中都包含工厂方法模式。该模式几乎尽人皆知，但不是每个人都能用得好。熟能生巧，熟练掌握该模式，多思考工厂方法<br> 如何应用，而且工厂方法模式还可以与其他模式混合使用（例如模板方法模式、单例模式、原型模式等），变化出无穷的优秀设计，这也正是软件设计和开发的乐趣所在。</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p><font><span style="font-size:14px;">本文转自SummerChill博客园博客，原文链接：http://www.cnblogs.com/DreamDrive/p/4694989.html，如需转载请自行联系原作者</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
