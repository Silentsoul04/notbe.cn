<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SQL Server 2005系列教学(9) SQL 存储过程 « NotBeCN</title>
  <meta name="description" content="             声明变量,SQL规定变量在使用之前先声明,以便以后的程序中用到        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;格式:&nbsp;&nbsp;&nbsp;declare&nbsp;变量名&nbsp;变量类型[,变量名&nbsp;变量类型…...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/14/1557729005562.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">SQL Server 2005系列教学(9) SQL 存储过程</h1>
    <p class="post-meta">Nov 14, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><span style="font-family:'宋体';">声明变量</span><span>,SQL</span><span style="font-family:'宋体';">规定变量在使用之前先声明</span><span>,</span><span style="font-family:'宋体';">以便以后的程序中用到</span><br></p> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <font><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">格式</span><span>:<span>&nbsp;&nbsp;&nbsp;</span>declare&nbsp;</span><span style="font-family:'宋体';">变量名</span>&nbsp;<span style="font-family:'宋体';">变量类型</span><span>[,</span><span style="font-family:'宋体';">变量名</span>&nbsp;<span style="font-family:'宋体';">变量类型</span><span>……]</span></font>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <font><span style="font-family:'宋体';">一次可声明多个变量</span><span>,</span><span style="font-family:'宋体';">它们之间用</span><span>,</span><span style="font-family:'宋体';">分隔</span><span>.</span><span style="font-family:'宋体';">用户变量以一个</span><span>@</span><span style="font-family:'宋体';">开头</span><span>,</span><span style="font-family:'宋体';">全局变量以</span><span>@@</span><span style="font-family:'宋体';">开头</span><span>.,</span><span style="font-family:'宋体';">因为时间关系我们在这里讲不到全局变量</span><span>..</span><span style="font-family:'宋体';">下面我们声明几个变量</span><span>.</span></font>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <span>Declare @score<span>&nbsp;&nbsp;</span>int,@name<span>&nbsp;&nbsp;</span>char(8)</span>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <font><span style="font-family:'宋体';">给变量赋值</span><span>;<span>&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">格式</span><span>:<span>&nbsp;&nbsp;</span>SET&nbsp;</span><span style="font-family:'宋体';">变量名</span><span>=</span><span style="font-family:'宋体';">值</span></font>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>SET @SCORE=80</span>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>SET @NAME=’DUFEI’</span>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <span>&nbsp;</span>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <font><span style="font-family:'宋体';">或者是</span><span>select&nbsp;</span><span style="font-family:'宋体';">也可以给变量赋值</span><span>:<span>&nbsp;&nbsp;</span>select&nbsp;</span><span style="font-family:'宋体';">变量名</span><span>=</span><span style="font-family:'宋体';">值</span></font>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <span>&nbsp;</span>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <font><span style="font-family:'宋体';">显示变量</span><span>;<span>&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">格式</span><span>: PRINT<span>&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">变量名</span></font>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <span>declare<span>&nbsp;&nbsp;</span>@score int,@NAME char(8)</span>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <span>set @score=80</span>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <span>set @name='dufei'</span>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    <span>print cast(@score as char(8))+@name</span>
   </div> 
   <div style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">
    &nbsp;
   </div> 
   <span style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"> </span>
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">常用的全局变量：</font></span>
   </div> 
   <div>
    <font><span>1</span><span style="font-family:'宋体';">．</span><span>@@error&nbsp;</span><span style="font-family:'宋体';">返回最后执行的</span><span>T-SQL</span><span style="font-family:'宋体';">语句的错误代码，数据类型为整型。在</span><span>SQL SERVER</span><span style="font-family:'宋体';">执行一个</span><span>T-SQL</span><span style="font-family:'宋体';">语句之后，若成功，返回值为</span><span>0</span><span style="font-family:'宋体';">，否则返回相应的错误代码。</span></font>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">也就是说如果你在一个程序想知道一个</span><span>SQL</span><span style="font-family:'宋体';">语句是否有问题，是否被成功执行，可以通过</span><span>@@ERROR</span><span style="font-family:'宋体';">来判断，是否为</span><span>0</span><span style="font-family:'宋体';">即可！</span></font>
   </div> 
   <div>
    <span>&nbsp;</span>
   </div> 
   <div> 
    <a name="_" style="color:rgb(66,133,244);"></a>
    <font><span>2</span><span style="font-family:'宋体';">．</span><span>@@CONNECTIONS</span></font> 
   </div> 
   <div>
    <font><span style="font-family:'宋体';">返回自上次启动</span><span>&nbsp;SQL Server</span><span style="font-family:'宋体';">以来连接或试图连接的次数。</span></font>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">语法</font></span>
   </div> 
   <div>
    <span>@@CONNECTIONS</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">返回类型</font></span>
   </div> 
   <div>
    <span>INT</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">注释</font></span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">连接与用户不同。例如，应用程序可以打开多个与</span><span>&nbsp;SQL Server&nbsp;</span><span style="font-family:'宋体';">的连接，而不需要用户监视这些连接。</span></font>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">若要显示一个包含几个</span><span>&nbsp;SQL Server&nbsp;</span><span style="font-family:'宋体';">统计信息的报表，包括试图连接统计信息，请运行</span><span>&nbsp;sp_monitor</span><span style="font-family:'宋体';">。</span></font>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">例如，如果报告中</span>&nbsp;<b><span>cpu_busy</span></b><span>&nbsp;</span><span style="font-family:'宋体';">显示为</span><span>&nbsp;4250(215)-68%</span><span style="font-family:'宋体';">，则自</span><span>&nbsp;SQL Server&nbsp;</span><span style="font-family:'宋体';">上次启动以来，</span><span>CPU&nbsp;</span><span style="font-family:'宋体';">工作了</span><span>&nbsp;4250&nbsp;</span><span style="font-family:'宋体';">秒；自上次运行</span>&nbsp;<b><span>sp_monitor</span></b><span>&nbsp;</span><span style="font-family:'宋体';">以来，</span><span>CPU&nbsp;</span><span style="font-family:'宋体';">工作了</span><span>&nbsp;215&nbsp;</span><span style="font-family:'宋体';">秒；自上次运行</span>&nbsp;<b><span>sp_monitor</span></b><span>&nbsp;</span><span style="font-family:'宋体';">以来占总时间的</span><span>&nbsp;68%</span><span style="font-family:'宋体';">。</span></font>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">示例</font></span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">下面的示例显示了到当前日期和时间为止试图登录的次数。</font></span>
   </div> 
   <div>
    <span>SELECT GETDATE() AS 'Today’s Date and Time',</span>
   </div> 
   <div>
    <span><span>&nbsp;&nbsp;&nbsp;</span>@@CONNECTIONS AS 'Login’S'</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">下面是结果集：</font></span>
   </div> 
   <div>
    <span>Today's Date and Time<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Login’s</span>
   </div> 
   <div>
    <span>---------------------------&nbsp;<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>---------------</span>
   </div> 
   <div>
    <span>1998-04-09 14:28:46.940<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>18</span>
   </div> 
   <div>
    <span>&nbsp;</span>
   </div> 
   <div>
    <span>&nbsp;</span>
   </div> 
   <div>
    <span><font>3.&nbsp;</font><a style="color:rgb(66,133,244);"></a><font>@@CPU_BUSY</font></span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">返回自上次启动</span><span>&nbsp;Microsoft® SQL Server™&nbsp;</span><span style="font-family:'宋体';">以来</span><span>&nbsp;CPU&nbsp;</span><span style="font-family:'宋体';">的工作时间，单位为毫秒（基于系统计时器的分辨率）。</span></font>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">语法</font></span>
   </div> 
   <div>
    <span>@@CPU_BUSY</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">返回类型</font></span>
   </div> 
   <div>
    <span>integer</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">示例</font></span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">下面的示例显示了到当前日期和时间为止</span><span>&nbsp;SQL Server CPU&nbsp;</span><span style="font-family:'宋体';">的活动。</span></font>
   </div> 
   <div>
    <span>SELECT @@CPU_BUSY AS 'CPU ms', GETDATE() AS 'As of'</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">下面是结果集：</font></span>
   </div> 
   <div>
    <span>CPU ms<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>As of</span>
   </div> 
   <div>
    <span>-----------------<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>---------------------------</span>
   </div> 
   <div>
    <span>20<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>1998-04-18<span>&nbsp;&nbsp;</span>14:43:08.180</span>
   </div> 
   <div>
    <span>&nbsp;</span>
   </div> 
   <div>
    <span>&nbsp;</span>
   </div> 
   <div>
    <span><font>4.</font><a style="color:rgb(66,133,244);"></a><font>&nbsp;@@DATEFIRST</font></span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">返回</span><span>&nbsp;SET DATEFIRST&nbsp;</span><span style="font-family:'宋体';">参数的当前值，</span><span>SET DATEFIRST&nbsp;</span><span style="font-family:'宋体';">参数指明所规定的每周第一天：</span><span>1&nbsp;</span><span style="font-family:'宋体';">对应星期一，</span><span>2&nbsp;</span><span style="font-family:'宋体';">对应星期二，依次类推，用</span><span>&nbsp;7&nbsp;</span><span style="font-family:'宋体';">对应星期日。</span></font>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">语法</font></span>
   </div> 
   <div>
    <span>@@DATEFIRST</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">返回类型</font></span>
   </div> 
   <div>
    <span>tinyint</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">注释</font></span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">美国英语中默认</span><span>&nbsp;7&nbsp;</span><span style="font-family:'宋体';">对应星期日。</span></font>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">示例</font></span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">下面的示例将每周第一天设为</span><span>&nbsp;5&nbsp;</span><span style="font-family:'宋体';">（星期五），并假定当日是星期六。</span><span>SELECT&nbsp;</span><span style="font-family:'宋体';">语句返回</span><span>&nbsp;DATEFIRST&nbsp;</span><span style="font-family:'宋体';">值和当日是此周的第几天。</span></font>
   </div> 
   <div>
    <span>SET DATEFIRST 5</span>
   </div> 
   <div>
    <span>SELECT @@DATEFIRST AS '1st Day', DATEPART(dw, GETDATE()) AS 'Today'</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">下面是结果集。从星期五算起，今天（星期六）是第二天。</font></span>
   </div> 
   <div>
    <span>1st Day<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Today</span>
   </div> 
   <div>
    <span>----------------<span>&nbsp;&nbsp;</span>--------------</span>
   </div> 
   <div>
    <span>5<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>2</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">那如果改用中国时间，求今天是一周中的第几天</font></span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">只需将</span><span><span>&nbsp;&nbsp;</span>set datefirst 1<span>&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">即可！</span><span><span>&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">然后</span><span><span>&nbsp;&nbsp;</span>datepart(dw,getdate()) as ‘</span><span style="font-family:'宋体';">今天是第几天</span><span>’</span></font>
   </div> 
   <div>
    <span><font>5.</font><a style="color:rgb(66,133,244);"></a><font>&nbsp;@@SERVERNAME</font></span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">返回运行</span><span>&nbsp;Microsoft® SQL Server™&nbsp;</span><span style="font-family:'宋体';">的本地服务器名称。</span></font>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">语法</font></span>
   </div> 
   <div>
    <span>@@SERVERNAME</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">返回类型</font></span>
   </div> 
   <div>
    <span>nvarchar</span>
   </div> 
   <div>
    <span>&nbsp;</span>
   </div> 
   <div>
    <span><font>6.</font><a style="color:rgb(66,133,244);"></a><font>&nbsp;@@VERSION</font></span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">返回</span><span>&nbsp;Microsoft® SQL Server™&nbsp;</span><span style="font-family:'宋体';">当前安装的日期、版本和处理器类型。</span></font>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">语法</font></span>
   </div> 
   <div>
    <span>@@VERSION</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">返回类型</font></span>
   </div> 
   <div>
    <span>nvarchar</span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">注释</font></span>
   </div> 
   <div>
    <font><span>@@VERSION&nbsp;</span><span style="font-family:'宋体';">返回的信息与</span><span>&nbsp;xp_msver&nbsp;</span><span style="font-family:'宋体';">存储过程返回的产品名、版本、平台和文件数据相似，但</span><span>&nbsp;xp_msver&nbsp;</span><span style="font-family:'宋体';">存储过程提供更详细的信息。</span></font>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">示例</font></span>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">下面的示例返回当前安装的日期、版本和处理器类型。</font></span>
   </div> 
   <div> 
    <span>SELECT @@VERSION</span>
    <span>&nbsp;</span> 
   </div> 
   <div>
    <span>&nbsp;</span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">注释：是程序代码中不执行的文本字符串（也称为注解），在</span><span>SQL SERVER</span><span style="font-family:'宋体';">中可以使用两种类型的注释字符：一种是</span><span>ANSI</span><span style="font-family:'宋体';">标准的注释符。“</span><span>--</span><span style="font-family:'宋体';">”用于单行注解；另一种是</span><span>”/*<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>*/”&nbsp;</span><span style="font-family:'宋体';">用于多行注解。</span></font>
   </div> 
   <div>
    &nbsp;
   </div> 
   <span><font> </font></span>
   <div> 
    <span style="font-family:'宋体';">分支语句</span>
    <span>:</span> 
   </div> 
   <div>
    <span style="font-family:'宋体';">分别画出流程图</span>
   </div> 
   <div>
    <span>&nbsp;</span>
   </div> 
   <div>
    <font>BEGIN</font>
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    &nbsp;
   </div> 
   <span> </span>
   <div>
    <font><span>CASE</span><span style="font-family:'宋体';">表达式：</span></font>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">多分支语句：计算条件列表并返回多个可能结果表达式之一。</span></font>
   </div> 
   <div>
    <span><font>&nbsp;</font></span>
   </div> 
   <div>
    <span><font>&nbsp;</font></span>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">简单</span><span>CASE</span><span style="font-family:'宋体';">语法：</span></font>
   </div> 
   <div>
    <font><span>CASE [</span><span style="font-family:'宋体';">变量或字段</span><span>]</span></font>
   </div> 
   <div>
    <font><span>when&nbsp;</span><span style="font-family:'宋体';">表达式</span><span>1<span>&nbsp;&nbsp;&nbsp;</span>THEN<span>&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">结果表达式</span><span>1</span></font>
   </div> 
   <div>
    <font><span>when&nbsp;</span><span style="font-family:'宋体';">表达式</span><span>2<span>&nbsp;&nbsp;&nbsp;</span>THEN<span>&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">结果表达式</span><span>2</span></font>
   </div> 
   <div>
    <font><span>when&nbsp;</span><span style="font-family:'宋体';">表达式</span><span>3<span>&nbsp;&nbsp;&nbsp;</span>THEN<span>&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">结果表达式</span><span>3</span></font>
   </div> 
   <div>
    <font><span>when&nbsp;</span><span style="font-family:'宋体';">表达式</span><span>i<span>&nbsp;&nbsp;&nbsp;</span>THEN<span>&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">结果表达式</span><span>i</span></font>
   </div> 
   <div>
    <font><span>else<span>&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">结果表达式</span></font>
   </div> 
   <div>
    <span><font>END</font></span>
   </div> 
   <div>
    &nbsp;
   </div> 
   <div>
    <span><font>&nbsp;</font></span>
   </div> 
   <div>
    <font><span>GOTO&nbsp;</span><span style="font-family:'宋体';">语句</span></font>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">最早出现在</span><span>BASIC</span><span style="font-family:'宋体';">语法中</span><span>,</span><span style="font-family:'宋体';">跳转语句</span><span>,</span><span style="font-family:'宋体';">它不属于基本程序结构</span><span>.</span><span style="font-family:'宋体';">因为它会使用程序的可读性变差</span><span>,</span><span style="font-family:'宋体';">如果在大型程序中</span><span>,GOGO</span><span style="font-family:'宋体';">语句会使程序变的很复杂</span><span>,</span><span style="font-family:'宋体';">使人不得头绪</span><span>.</span><span style="font-family:'宋体';">所以在程序中尽量少用</span><span>GOTO,</span><span style="font-family:'宋体';">或者是不用</span><span>.</span></font>
   </div> 
   <div> 
    <div>
     &nbsp;
    </div> 
   </div> 
   <div>
    <font><span style="font-family:'宋体';">循环语句</span><span>;</span></font>
   </div> 
   <div>
    <font><span>While&nbsp;</span><span style="font-family:'宋体';">条件</span></font>
   </div> 
   <div>
    <span><font>Begin</font></span>
   </div> 
   <div>
    <font><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">语句体</span></font>
   </div> 
   <div>
    <span><font>End</font></span>
   </div> 
   <div> 
    <div>
     &nbsp;
    </div> 
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">存储过程的优点：</font></span>
   </div> 
   <div style="text-indent:-36pt;"> 
    <span><span><font>（1）</font><span style="font-size:7pt;line-height:normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></span>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">可以实现模块化编程：</font></span> 
   </div> 
   <div>
    <font><span style="font-family:'宋体';">（</span><span>2</span><span style="font-family:'宋体';">）</span>&nbsp;<span style="font-family:'宋体';">执行效率更高</span></font>
   </div> 
   <div> 
    <font><span style="font-family:'宋体';">（</span><span>3</span><span style="font-family:'宋体';">）存储过程能够减少网络流量</span></font>
    <span><font>&nbsp;</font></span> 
   </div> 
   <div>
    <font><span style="font-family:'宋体';">（</span><span>4</span><span style="font-family:'宋体';">）可实现安全机制</span></font>
   </div> 
   <div></div> 
   <div></div> 
   <div>
    <font><span style="font-family:'宋体';">在</span><span>SQL SERVER</span><span style="font-family:'宋体';">中存储过程分为三大类：</span></font>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">系统存储过程：</font></span>
   </div> 
   <div>
    <span><font>&nbsp;</font></span>
   </div> 
   <div> 
    <font><span style="font-family:'宋体';">扩展存储过程：</span><span>XP_</span><span style="font-family:'宋体';">开头的。</span></font>
    <span><font>&nbsp;</font></span> 
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">用户自定义存储过程：</font></span>
   </div> 
   <div> 
    <div>
     &nbsp;
    </div> 
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">格式：</font></span>
   </div> 
   <div>
    <span><font>create proc procedure_name [;number] [@parameter data_type] [varying=default] [output]</font></span>
   </div> 
   <div>
    <span><span><font>&nbsp;&nbsp;</font></span></span>
   </div> 
   <div>
    <font><span>as SQL</span><span style="font-family:'宋体';">语句</span></font>
   </div> 
   <div> 
    <span><font>&nbsp;</font></span>
    <span><font>&nbsp;</font></span> 
   </div> 
   <div>
    <font><span>procedure_name</span><span style="font-family:'宋体';">是存储过程名</span></font>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">；</span><span>number&nbsp;</span><span style="font-family:'宋体';">是可选的整数，用来对同名的过程分组，以便用一条</span><span>DROP PROCEDURE</span><span style="font-family:'宋体';">语句即可将同组的过程一同删除。例如：名为</span><span>ORDERS</span><span style="font-family:'宋体';">的应用程序使用权的过程可以命名为</span><span>order:1<span>&nbsp;&nbsp;</span>order:2</span><span style="font-family:'宋体';">等</span><span>&nbsp;.drop procedure order&nbsp;</span><span style="font-family:'宋体';">将删除整个组。</span></font>
   </div> 
   <div>
    <font><span>@parameter</span><span style="font-family:'宋体';">是过程中的参数。在</span><span>CREATE PROC</span><span style="font-family:'宋体';">语句中可以声明一个或多个参数。用户必须在执行过程时提供每个所声明值（实际参数）</span></font>
   </div> 
   <div>
    <font><span>DATA_TYPE</span><span style="font-family:'宋体';">是参数的数据类型。</span></font>
   </div> 
   <div> 
    <div>
     &nbsp;
    </div> 
   </div> 
   <div>
    <font><span style="font-family:'宋体';">例：在数据库</span><span>ITET</span><span style="font-family:'宋体';">中创建一个存储过程，用于查询某员工所负责项目的平均项目标的。</span></font>
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">一个输入参数，一个输出参数，一个返回值。</font></span>
   </div> 
   <div>
    <font><span>Biaodi</span><span style="font-family:'宋体';">表</span></font>
   </div> 
   <div>
    <font><span style="font-family:'宋体';">编号</span><span><span>&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">项目</span><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">标的</span></font>
   </div> 
   <div>
    <font><span>1<span>&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">网络工程</span><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>100000.0000</span></font>
   </div> 
   <div>
    <font><span>2<span>&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">网站建设</span><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>10000.0000</span></font>
   </div> 
   <div>
    <font><span>3<span>&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">系统集成</span><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>30000.0000</span></font>
   </div> 
   <div>
    <font><span>1<span>&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:'宋体';">弱电系统</span><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>400000.0000</span></font>
   </div> 
   <div> 
    <div>
     &nbsp;
    </div> 
   </div> 
   <div>
    <span><font>Create proc avgbiaodi @name varchar(10),@biaodi int output</font></span>
   </div> 
   <div>
    <span><font>As</font></span>
   </div> 
   <div>
    <span><font>Declare @errorsave int</font></span>
   </div> 
   <div>
    <span><font>Set @errorsave=0</font></span>
   </div> 
   <div>
    <font><span>Select @biaodi=avg(</span><span style="font-family:'宋体';">项目标的</span><span>) from biaodi<span>&nbsp;&nbsp;</span>as b<span>&nbsp;&nbsp;</span>join yuangong as y on y.</span><span style="font-family:'宋体';">编号</span><span>=b.</span><span style="font-family:'宋体';">编号</span><span><span>&nbsp;&nbsp;&nbsp;</span>where y.</span><span style="font-family:'宋体';">姓名</span><span><a href="mailto:=@name" rel="nofollow" style="text-decoration:none;color:rgb(66,133,244);">=@name</a></span></font>
   </div> 
   <div> 
    <div>
     &nbsp;
    </div> 
   </div> 
   <div>
    <span style="font-family:'宋体';"><font style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;">创建一组存储过程：</font></span>
   </div> 
   <div>
    <span><font>&nbsp;</font></span>
   </div> 
   <div>
    <span><font>create proc gr;1</font></span>
   </div> 
   <div>
    <span><font>as select<span>&nbsp;&nbsp;</span>* from yuangong</font></span>
   </div> 
   <div>
    <span><font>go</font></span>
   </div> 
   <div>
    <span><font>create proc gr;2</font></span>
   </div> 
   <div>
    <span><font>as select * from biaodi</font></span>
   </div> 
   <div>
    <span><font>go</font></span>
   </div> 
   <div>
    <span><font>create proc gr;3</font></span>
   </div> 
   <div>
    <span><font>as select * from a</font></span>
   </div> 
   <div>
    <span><font>go</font></span>
   </div> 
   <div>
    <span><font>&nbsp;</font></span>
   </div> 
   <div>
    <span><font>execute gr;3</font></span>
   </div> 
   <div> 
    <div>
     &nbsp;
    </div> 
    <div>
     &nbsp;
    </div> 
    <div>
     <br>
    </div> 
    <div>
     <br>
    </div> 
    <div>
     <br>
    </div> 
    <div>
     <br>
    </div> 
    <div> 
     <div>
      &nbsp;本文转自 dufei 51CTO博客，原文链接：http://blog.51cto.com/dufei/80757，如需转载请自行联系原作者
     </div> 
     <div>
      <br>
     </div> 
    </div> 
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
