<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>__ATTRIBUTE__ 你知多少？【转】 « NotBeCN</title>
  <meta name="description" content="             转自：http://www.cnblogs.com/astwish/p/3460618.html    GNU C&nbsp;的一大特色就是__attribute__&nbsp;机制。__attribute__&nbsp;可以设置函数属性（Function Attribute&nbsp;...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/14/weixin_34099526_90127358.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">__ATTRIBUTE__ 你知多少？【转】</h1>
    <p class="post-meta">Nov 14, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">转自：<a href="http://www.cnblogs.com/astwish/p/3460618.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://www.cnblogs.com/astwish/p/3460618.html</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>GNU C&nbsp;的一大特色就是<span>__attribute__&nbsp;机制。<span>__attribute__&nbsp;可以设置函数属性（<span>Function Attribute&nbsp;）、变量属性（<span>Variable Attribute&nbsp;）和类型属性（<span>Type Attribute&nbsp;）。</span></span></span></span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>__attribute__&nbsp;书写特征是：<span>__attribute__&nbsp;前后都有两个下划线，并切后面会紧跟一对原括弧，括弧里面是相应的<span>__attribute__&nbsp;参数。</span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>__attribute__&nbsp;语法格式为：<span>__attribute__ ((attribute-list))</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">其位置约束为：放于声明的尾部<span>“&nbsp;；<span>”&nbsp;之前。</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">关键字<span>__attribute__&nbsp;也可以对结构体（<span>struct&nbsp;）或共用体（<span>union&nbsp;）进行属性设置。大致有六个参数值可以被设定，即：<span>aligned, packed, transparent_union, unused, deprecated&nbsp;和&nbsp;<span>may_alias&nbsp;。</span></span></span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">在使用<span>__attribute__&nbsp;参数时，你也可以在参数的前后都加上<span>“__”&nbsp;（两个下划线），例如，使用<span>__aligned__而不是<span>aligned&nbsp;，这样，你就可以在相应的头文件里使用它而不用关心头文件里是否有重名的宏定义。</span></span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><strong><span>aligned (alignment)</span></strong></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">该属性设定一个指定大小的对齐格式（以字节 为单位），例如：</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>struct S {</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>short b[3];</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>} __attribute__ ((aligned (8)));</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>typedef int int32_t __attribute__ ((aligned (8)));</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">该声明将强制编译器确保（尽它所能）变量类 型为<span>struct S&nbsp;或者<span>int32_t&nbsp;的变量在分配空间时采用<span>8&nbsp;字节对齐方式。</span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">如上所述，你可以手动指定对齐的格式，同 样，你也可以使用默认的对齐方式。如果<span>aligned&nbsp;后面不紧跟一个指定的数字值，那么编译器将依据你的目标机器情况使用最大最有益的对齐方式。例如：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>struct S {</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>short b[3];</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>} __attribute__ ((aligned));</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">这里，如果<span>sizeof&nbsp;（<span>short&nbsp;）的大小为<span>2&nbsp;（<span>byte&nbsp;），那么，<span>S&nbsp;的大小就为<span>6&nbsp;。取一个<span>2&nbsp;的次方值，使得该值大于等于<span>6&nbsp;，则该值为<span>8&nbsp;，所以编译器将设置<span>S&nbsp;类型的对齐方式为<span>8&nbsp;字节。</span></span></span></span></span></span></span></span></span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>aligned&nbsp;属性使被设置的对象占用更多的空间，相反的，使用<span>packed&nbsp;可以减小对象占用的空间。</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">需要注意的是，<span>attribute&nbsp;属性的效力与你的连接器也有关，如果你的连接器最大只支持<span>16&nbsp;字节对齐，那么你此时定义<span>32&nbsp;字节对齐也是无济于事的。</span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><strong><span>packed</span></strong></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>&nbsp;&nbsp;使用该属性对<span>struct&nbsp;或者<span>union&nbsp;类型进行定义，设定其类型的每一个变量的内存约束。当用在<span>enum&nbsp;类型 定义时，暗示了应该使用最小完整的类型（<span>it indicates that the smallest integral type should be used）。</span></span></span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>&nbsp;&nbsp;下面的例子中，<span>packed_struct&nbsp;类型的变量数组中的值将会紧紧的靠在一起，但内部的成员变量<span>s&nbsp;不会被<span>“pack”&nbsp;，如果希望内部的成员变量也被<span>packed&nbsp;的话，<span>unpacked-struct&nbsp;也需要使用<span>packed&nbsp;进行相应的约束。</span></span></span></span></span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>struct unpacked_struct</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>{</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char c;</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int i;</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>};</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>struct packed_struct</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>{</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char c;</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;i;</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;struct unpacked_struct s;</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>}__attribute__ ((__packed__));</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">下面的例子中使用<span>__attribute__&nbsp;属性定义了一些结构体及其变量，并给出了输出结果和对结果的分析。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">程序代 码为：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre> 1 struct p
 2 
 3 {
 4 
 5 int a;
 6 
 7 char b;
 8 
 9 short c;
10 
11 }__attribute__((aligned(4))) pp;
12 
13 struct m
14 
15 {
16 
17 char a;
18 
19 int b;
20 
21 short c;
22 
23 }__attribute__((aligned(4))) mm;
24 
25 struct o
26 
27 {
28 
29 int a;
30 
31 char b;
32 
33 short c;
34 
35 }oo;
36 
37 struct x
38 
39 {
40 
41 int a;
42 
43 char b;
44 
45 struct p px;
46 
47 short c;
48 
49 }__attribute__((aligned(8))) xx;
50 
51 int main()
52 
53 {
54 
55 printf("sizeof(int)=%d,sizeof(short)=%d.sizeof(char)=%d\n",sizeof(int),sizeof(short),sizeof(char));
56 
57 printf("pp=%d,mm=%d \n", sizeof(pp),sizeof(mm));
58 
59 printf("oo=%d,xx=%d \n", sizeof(oo),sizeof(xx));
60 
61 return 0;
62 
63 }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">输出结 果：</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>sizeof(int)=4,sizeof(short)=2.sizeof(char)=1</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>pp=8,mm=12</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>oo=8,xx=24</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">分析：</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>sizeof(pp):</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>sizeof(a)+sizeof(b)+sizeof(c)=4+1+1=6&lt;8&nbsp;所以<span>sizeof(pp)=8</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>sizeof(mm):</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>sizeof(a)+sizeof(b)+sizeof(c)=1+4+2=7</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">但是&nbsp;<span>a&nbsp;后面需要用&nbsp;<span>3&nbsp;个字节填充，但是&nbsp;<span>b&nbsp;是&nbsp;<span>4&nbsp;个字节，所以&nbsp;<span>a&nbsp;占用&nbsp;<span>4&nbsp;字节，&nbsp;<span>b&nbsp;占用&nbsp;<span>4&nbsp;个字节，而&nbsp;<span>c&nbsp;又要占用&nbsp;<span>4&nbsp;个字节。所以&nbsp;<span>sizeof(mm)=12</span></span></span></span></span></span></span></span></span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>sizeof(oo):</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>sizeof(a)+sizeof(b)+sizeof(c)=4+1+2=7</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">因为默 认是以<span>4&nbsp;字节对齐，所以<span>sizeof(oo)=8</span></span></p> 
   <p align="left" style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>sizeof(xx):</span></p> 
   <p align="left" style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>sizeof(a)+ sizeof(b)=4+1=5</span></p> 
   <p align="left" style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>sizeof(pp)=8;&nbsp;即<span>xx&nbsp;是采用<span>8&nbsp;字节对齐的，所以要在<span>a&nbsp;，<span>b&nbsp;后面添<span>3&nbsp;个空余字节，然后才能存储<span>px&nbsp;，</span></span></span></span></span></span></span></p> 
   <p align="left" style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>4+1+&nbsp;（<span>3&nbsp;）<span>+8+1=17</span></span></span></p> 
   <p align="left" style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">因为<span>xx&nbsp;采用的对齐是<span>8&nbsp;字节对齐，所以<span>xx&nbsp;的大小必定是<span>8&nbsp;的整数倍，即<span>xx&nbsp;的大小是一个比<span>17&nbsp;大又是<span>8&nbsp;的倍数的一个最小值，由此得到</span></span></span></span></span></span></span></p> 
   <p align="left" style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span>17&lt;24&nbsp;，所以<span>sizeof(xx)=24</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><strong>函数属性（Function Attribute）</strong><br> 函数属性可以帮助开发者把一些特性添加到函数声明中，从而可以使编译器在错误检查方面的功能更强大。__attribute__机制也很容易同非GNU应用程序做到兼容之功效。<br> GNU CC需要使用 –Wall编译器来击活该功能，这是控制警告信息的一个很好的方式。下面介绍几个常见的属性参数。<br> __attribute__ format<br> 该__attribute__属性可以给被声明的函数加上类似printf或者scanf的特征，它可以使编译器检查函数声明和函数实际调用参数之间的格式化字符串是否匹配。该功能十分有用，尤其是处理一些很难发现的bug。<br> format的语法格式为：<br> format (archetype, string-index, first-to-check)<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; format属性告诉编译器，按照printf, scanf,&nbsp;<br> strftime或strfmon的参数表格式规则对该函数的参数进行检查。“archetype”指定是哪种风格；“string-index”指定传入函数的第几个参数是格式化字符串；“first-to-check”指定从函数的第几个参数开始按上述规则进行检查。<br> 具体使用格式如下：<br> __attribute__((format(printf,m,n)))<br> __attribute__((format(scanf,m,n)))<br> 其中参数m与n的含义为：<br> m：第几个参数为格式化字符串（format string）；<br> n：参数集合中的第一个，即参数“…”里的第一个参数在函数参数总数排在第几，注意，有时函数参数里还有“隐身”的呢，后面会提到；<br> 在使用上，__attribute__((format(printf,m,n)))是常用的，而另一种却很少见到。下面举例说明，其中myprint为自己定义的一个带有可变参数的函数，其功能类似于printf：</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">//m=1；n=2<br> extern void myprint(const char *format,...) __attribute__((format(printf,1,2)));<br> //m=2；n=3<br> extern void myprint(int l，const char *format,...)&nbsp;<br> __attribute__((format(printf,2,3)));<br> 需要特别注意的是，如果myprint是一个函数的成员函数，那么m和n的值可有点“悬乎”了，例如：<br> //m=3；n=4<br> extern void myprint(int l，const char *format,...)&nbsp;<br> __attribute__((format(printf,3,4)));<br> 其原因是，类成员函数的第一个参数实际上一个“隐身”的“this”指针。（有点C++基础的都知道点this指针，不知道你在这里还知道吗？）<br> 这里给出测试用例：attribute.c，代码如下：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre>1：
2：extern void myprint(const char *format,...) 
__attribute__((format(printf,1,2)));
3：
4：void test()
5：{
6：     myprint("i=%d\n",6);
7：     myprint("i=%s\n",6);
8：     myprint("i=%s\n","abc");
9：     myprint("%s,%d,%d\n",1,2);
10：}</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">运行<span class="MathJax" style="line-height:normal;font-size:14px;word-spacing:normal;border:0px;"><span class="math" style="border:0px;vertical-align:0px;line-height:normal;"><span class="noError" style="border:1px solid;vertical-align:0px;line-height:normal;font-size:12.6px;color:#000000;">gcc&nbsp;–Wall&nbsp;–c&nbsp;attribute.c&nbsp;attribute后，输出结果为：&nbsp;&nbsp;attribute.c:&nbsp;In&nbsp;function&nbsp;`test':&nbsp;attribute.c:7:&nbsp;warning:&nbsp;format&nbsp;argument&nbsp;is&nbsp;not&nbsp;a&nbsp;pointer&nbsp;(arg&nbsp;2)&nbsp;attribute.c:9:&nbsp;warning:&nbsp;format&nbsp;argument&nbsp;is&nbsp;not&nbsp;a&nbsp;pointer&nbsp;(arg&nbsp;2)&nbsp;attribute.c:9:&nbsp;warning:&nbsp;too&nbsp;few&nbsp;arguments&nbsp;for&nbsp;format&nbsp;&nbsp;如果在attribute.c中的函数声明去掉__attribute__((format(printf,1,2)))，再重新编译，既运行</span></span><span class="MJX_Assistive_MathML" style="border:0px;vertical-align:0px;line-height:normal;width:1px;">gcc&nbsp;–Wall&nbsp;–c&nbsp;attribute.c&nbsp;attribute后，输出结果为：&nbsp;&nbsp;attribute.c:&nbsp;In&nbsp;function&nbsp;`test':&nbsp;attribute.c:7:&nbsp;warning:&nbsp;format&nbsp;argument&nbsp;is&nbsp;not&nbsp;a&nbsp;pointer&nbsp;(arg&nbsp;2)&nbsp;attribute.c:9:&nbsp;warning:&nbsp;format&nbsp;argument&nbsp;is&nbsp;not&nbsp;a&nbsp;pointer&nbsp;(arg&nbsp;2)&nbsp;attribute.c:9:&nbsp;warning:&nbsp;too&nbsp;few&nbsp;arguments&nbsp;for&nbsp;format&nbsp;&nbsp;如果在attribute.c中的函数声明去掉__attribute__((format(printf,1,2)))，再重新编译，既运行</span></span>gcc –Wall –c attribute.c attribute后，则并不会输出任何警告信息。<br> 注意，默认情况下，编译器是能识别类似printf的“标准”库函数。<br> __attribute__ noreturn<br> 该属性通知编译器函数从不返回值，当遇到类似函数需要返回值而却不可能运行到返回值处就已经退出来的情况，该属性可以避免出现错误信息。C库函数中的abort（）和exit（）的声明格式就采用了这种格式，如下所示：<br><br> extern void&nbsp;exit(int)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __attribute__((noreturn));extern void abort(void)&nbsp;__attribute__((noreturn)); 为了方便理解，大家可以参考如下的例子：</p> 
   <div class="cnblogs_code" style="border:1px solid rgb(204,204,204);font-family:'Courier New';font-size:12px;"> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <pre> 1 //name: noreturn.c     ；测试__attribute__((noreturn))
 2 extern void myexit();
 3 
 4 int test(int n)
 5 {
 6            if ( n &gt; 0 )
 7           {
 8                    myexit();
 9                  /* 程序不可能到达这里*/
10           }
11            else
12                    return 0;
13 }</pre> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
    <div class="cnblogs_code_toolbar">
     <span class="cnblogs_code_copy" style="line-height:1.5;"><a title="复制代码" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;text-decoration:underline;border:none;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none;"></a></span>
    </div> 
   </div> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">编译显示的输出信息为：<br><br> $gcc –Wall –c noreturn.c<br> noreturn.c: In function `test':<br> noreturn.c:12: warning: control reaches end of non-void function<br><br> 警告信息也很好理解，因为你定义了一个有返回值的函数test却有可能没有返回值，程序当然不知道怎么办了！<br> 加上__attribute__((noreturn))则可以很好的处理类似这种问题。把<br> extern void myexit();修改为：<br> extern void myexit() __attribute__((noreturn));之后，编译不会再出现警告信息。<br> __attribute__ const<br> 该属性只能用于带有数值类型参数的函数上。当重复调用带有数值参数的函数时，由于返回值是相同的，所以此时编译器可以进行优化处理，除第一次需要运算外， 其它只需要返回第一次的结果就可以了，进而可以提高效率。该属性主要适用于没有静态状态（static state）和副作用的一些函数，并且返回值仅仅依赖输入的参数。<br> 为了说明问题，下面举个非常“糟糕”的例子，该例子将重复调用一个带有相同参数值的函数，具体如下：<br><br> extern int square(int n) __attribute__&nbsp;&nbsp;&nbsp;&nbsp; ((const));...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (i = 0; i &lt; 100; i++ )&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; total += square (5) + i;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<br> 通过添加__attribute__((const))声明，编译器只调用了函数一次，以后只是直接得到了相同的一个返回值。<br> 事实上，const参数不能用在带有指针类型参数的函数中，因为该属性不但影响函数的参数值，同样也影响到了参数指向的数据，它可能会对代码本身产生严重甚至是不可恢复的严重后果。<br> 并且，带有该属性的函数不能有任何副作用或者是静态的状态，所以，类似getchar（）或time（）的函数是不适合使用该属性的。<br> -finstrument-functions<br> 该参数可以使程序在编译时，在函数的入口和出口处生成instrumentation调用。恰好在函数入口之后并恰好在函数出口之前，将使用当前函数的地址和调用地址来调用下面的<br> profiling&nbsp;<br> 函数。（在一些平台上，__builtin_return_address不能在超过当前函数范围之外正常工作，所以调用地址信息可能对profiling函数是无效的。）<br><br> void __cyg_profile_func_enter(void *this_fn, void *call_site);<br> void __cyg_profile_func_exit(void *this_fn, void *call_site);<br><br> 其中，第一个参数this_fn是当前函数的起始地址，可在符号表中找到；第二个参数call_site是指调用处地址。<br> instrumentation&nbsp;<br> 也可用于在其它函数中展开的内联函数。从概念上来说，profiling调用将指出在哪里进入和退出内联函数。这就意味着这种函数必须具有可寻址形式。如 果函数包含内联，而所有使用到该函数的程序都要把该内联展开，这会额外地增加代码长度。如果要在C 代码中使用extern inline声明，必须提供这种函数的可寻址形式。<br> 可对函数指定no_instrument_function属性，在这种情况下不会进行 Instrumentation操作。例如，可以在以下情况下使用no_instrument_function属性：上面列出的profiling函 数、高优先级的中断例程以及任何不能保证profiling正常调用的函数。<br> no_instrument_function<br> 如果使用了-finstrument-functions&nbsp;<br> ，将在绝大多数用户编译的函数的入口和出口点调用profiling函数。使用该属性，将不进行instrument操作。<br> constructor/destructor<br> 若函数被设定为constructor属性，则该函数会在main（）函数执行之前被自动的执行。类似的，若函数被设定为destructor属性，则该 函数会在main（）函数执行之后或者exit（）被调用后被自动的执行。拥有此类属性的函数经常隐式的用在程序的初始化数据方面。<br> 这两个属性还没有在面向对象C中实现。<br> 同时使用多个属性<br> 可以在同一个函数声明里使用多个__attribute__，并且实际应用中这种情况是十分常见的。使用方式上，你可以选择两个单独的__attribute__，或者把它们写在一起，可以参考下面的例子：<br><br> /* 把类似printf的消息传递给stderr 并退出 */extern void die(const char *format, ...)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __attribute__((noreturn))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __attribute__((format(printf, 1, 2))); 或者写成 extern void die(const char *format, ...)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __attribute__((noreturn, format(printf, 1, 2))); 如果带有该属性的自定义函数追加到库的头文件里，那么所以调用该函数的程序都要做相应的检查。<br><br> 和非GNU编译器的兼容性<br> 庆幸的是，__attribute__设计的非常巧妙，很容易作到和其它编译器保持兼容，也就是说，如果工作在其它的非GNU编译器上，可以很容易的忽略该属性。即使__attribute__使用了多个参数，也可以很容易的使用一对圆括弧进行处理，例如：<br><br> /* 如果使用的是非GNU C, 那么就忽略__attribute__ */#ifndef __GNUC__#&nbsp;&nbsp;&nbsp;&nbsp; define&nbsp;&nbsp;&nbsp;&nbsp; __attribute__(x)&nbsp;&nbsp;&nbsp;&nbsp; /*NOTHING*/#endif&nbsp;<br> 需要说明的是，__attribute__适用于函数的声明而不是函数的定义。所以，当需要使用该属性的函数时，必须在同一个文件里进行声明，例如：<br><br> /* 函数声明 */void die(const char *format, ...) __attribute__((noreturn))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __attribute__((format(printf,1,2))); void die(const char *format, ...){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* 函数定义 */}</p> 
   <h3 style="font-size:16px;line-height:1.5;color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';">Specifying Attributes of Variables</h3> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><strong><code>aligned (</code>alignment<code>)</code>This attribute specifies a minimum alignment for the variable or structure field, measured in bytes. For example, the declaration:</strong></p> 
   <pre class="smallexample">          int x __attribute__ ((aligned (16))) = 0;
     </pre> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">causes the compiler to allocate the global variable&nbsp;<code>x</code>&nbsp;on a 16-byte boundary. On a 68040, this could be used in conjunction with an&nbsp;<code>asm</code>&nbsp;expression to access the<code>move16</code>&nbsp;instruction which requires 16-byte aligned operands.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">You can also specify the alignment of structure fields. For example, to create a double-word aligned&nbsp;<code>int</code>&nbsp;pair, you could write:</p> 
   <pre class="smallexample">          struct foo { int x[2] __attribute__ ((aligned (8))); };
     </pre> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">This is an alternative to creating a union with a&nbsp;<code>double</code>&nbsp;member that forces the union to be double-word aligned.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">As in the preceding examples, you can explicitly specify the alignment (in bytes) that you wish the compiler to use for a given variable or structure field. Alternatively, you can leave out the alignment factor and just ask the compiler to align a variable or field to the maximum useful alignment for the target machine you are compiling for. For example, you could write:</p> 
   <pre class="smallexample">          short array[3] __attribute__ ((aligned));</pre> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><strong>for more:&nbsp;<a href="http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Variable-Attributes.html#Variable-Attributes" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Variable-Attributes.html#Variable-Attributes</a></strong></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">下面来看一个不一样的HelloWorld程序:</p> 
   <div class="cnblogs_Highlighter" style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"> 
    <div class="syntaxhighlighter cpp" style="font-size:1em;"> 
     <table border="0" style="border-collapse:collapse;border-spacing:0px;border:1px solid #C0C0C0;background:none;line-height:1.1em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;">
      <tbody style="background:none;border:0px;line-height:1.1em;vertical-align:baseline;">
       <tr style="background:none;border:0px;line-height:1.1em;vertical-align:baseline;">
        <td class="gutter" style="border:1px solid #C0C0C0;border-collapse:collapse;background:none;line-height:1.1em;vertical-align:baseline;width:35px;color:rgb(175,175,175);"> 
         <div class="line number1 index0 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          1
         </div> 
         <div class="line number2 index1 alt1" style="background-image:none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          2
         </div> 
         <div class="line number3 index2 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          3
         </div> 
         <div class="line number4 index3 alt1" style="background-image:none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          4
         </div> 
         <div class="line number5 index4 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          5
         </div> 
         <div class="line number6 index5 alt1" style="background-image:none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          6
         </div> 
         <div class="line number7 index6 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          7
         </div> 
         <div class="line number8 index7 alt1" style="background-image:none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          8
         </div> 
         <div class="line number9 index8 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          9
         </div> 
         <div class="line number10 index9 alt1" style="background-image:none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          10
         </div> 
         <div class="line number11 index10 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          11
         </div> 
         <div class="line number12 index11 alt1" style="background-image:none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          12
         </div> 
         <div class="line number13 index12 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          13
         </div> 
         <div class="line number14 index13 alt1" style="background-image:none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          14
         </div> 
         <div class="line number15 index14 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          15
         </div> 
         <div class="line number16 index15 alt1" style="background-image:none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          16
         </div> 
         <div class="line number17 index16 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          17
         </div> 
         <div class="line number18 index17 alt1" style="background-image:none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          18
         </div> 
         <div class="line number19 index18 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          19
         </div> </td> 
        <td class="code" style="border:1px solid #C0C0C0;border-collapse:collapse;background:none;line-height:1.1em;vertical-align:baseline;"> 
         <div style="background:none;border:0px;line-height:1.1em;vertical-align:baseline;"> 
          <div class="line number1 index0 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp preprocessor" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:#808080;">#include &lt;stdio.h&gt;</code>
          </div> 
          <div class="line number2 index1 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp preprocessor" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:#808080;">#include &lt;stdlib.h&gt;</code>
          </div> 
          <div class="line number3 index2 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           &nbsp;
          </div> 
          <div class="line number4 index3 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;"> 
           <code class="cpp keyword bold" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,255);">static</code>&nbsp;&nbsp;
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">__attribute__((constructor)) </code>
           <code class="cpp keyword bold" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,255);">void</code>&nbsp;
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">before()</code> 
          </div> 
          <div class="line number5 index4 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">{</code>
          </div> 
          <div class="line number6 index5 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;">
           &nbsp;
          </div> 
          <div class="line number7 index6 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;"> 
           <code class="cpp spaces" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;">&nbsp;&nbsp;&nbsp;&nbsp;</code>
           <code class="cpp functions bold" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:bold;color:rgb(255,20,147);">printf</code>
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">(</code>
           <code class="cpp string" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:#0000FF;">"Hello"</code>
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">);</code> 
          </div> 
          <div class="line number8 index7 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">}</code>
          </div> 
          <div class="line number9 index8 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           &nbsp;
          </div> 
          <div class="line number10 index9 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;"> 
           <code class="cpp keyword bold" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,255);">static</code>&nbsp;&nbsp;
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">__attribute__((destructor)) </code>
           <code class="cpp keyword bold" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,255);">void</code>&nbsp;
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">after()</code> 
          </div> 
          <div class="line number11 index10 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">{</code>
          </div> 
          <div class="line number12 index11 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;"> 
           <code class="cpp spaces" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;">&nbsp;&nbsp;&nbsp;&nbsp;</code>
           <code class="cpp functions bold" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:bold;color:rgb(255,20,147);">printf</code>
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">(</code>
           <code class="cpp string" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:#0000FF;">" World!\n"</code>
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">);</code> 
          </div> 
          <div class="line number13 index12 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">}</code>
          </div> 
          <div class="line number14 index13 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;">
           &nbsp;
          </div> 
          <div class="line number15 index14 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;"> 
           <code class="cpp color1 bold" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:bold;color:#808080;">int</code>&nbsp;
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">main(</code>
           <code class="cpp color1 bold" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:bold;color:#808080;">int</code>&nbsp;
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">args,</code>
           <code class="cpp color1 bold" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-weight:bold;color:#808080;">char</code>&nbsp;
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">** argv)</code> 
          </div> 
          <div class="line number16 index15 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">{</code>
          </div> 
          <div class="line number17 index16 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           &nbsp;
          </div> 
          <div class="line number18 index17 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;"> 
           <code class="cpp spaces" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;">&nbsp;&nbsp;&nbsp;&nbsp;</code>
           <code class="cpp keyword bold" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,255);">return</code>&nbsp;
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">EXIT_SUCCESS;</code> 
          </div> 
          <div class="line number19 index18 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">}</code>
          </div> 
         </div> </td> 
       </tr>
      </tbody>
     </table>
    </div> 
   </div> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;我们知道这是一个HelloWorld程序，所以输出的结果就是"Hello World!"，很简单，不需要对这点过多关心.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">下面我们来关心关心别的:</p> 
   <div class="cnblogs_Highlighter" style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"> 
    <div class="syntaxhighlighter cpp" style="font-size:1em;"> 
     <table border="0" style="border-collapse:collapse;border-spacing:0px;border:1px solid #C0C0C0;background:none;line-height:1.1em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;">
      <tbody style="background:none;border:0px;line-height:1.1em;vertical-align:baseline;">
       <tr style="background:none;border:0px;line-height:1.1em;vertical-align:baseline;">
        <td class="gutter" style="border:1px solid #C0C0C0;border-collapse:collapse;background:none;line-height:1.1em;vertical-align:baseline;width:35px;color:rgb(175,175,175);"> 
         <div class="line number1 index0 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          1
         </div> 
         <div class="line number2 index1 alt1" style="background-image:none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          2
         </div> 
         <div class="line number3 index2 alt2" style="background:rgb(244,244,244) none;border-width:0px 2px 0px 0px;border-right-style:solid;border-right-color:rgb(108,226,108);line-height:1.8em;text-align:right;vertical-align:baseline;">
          3
         </div> </td> 
        <td class="code" style="border:1px solid #C0C0C0;border-collapse:collapse;background:none;line-height:1.1em;vertical-align:baseline;"> 
         <div style="background:none;border:0px;line-height:1.1em;vertical-align:baseline;"> 
          <div class="line number1 index0 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">__attribute__((constructor))</code>
          </div> 
          <div class="line number2 index1 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;">
           &nbsp;
          </div> 
          <div class="line number3 index2 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">__attribute__((destructor))</code>
          </div> 
         </div> </td> 
       </tr>
      </tbody>
     </table>
    </div> 
   </div> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;解释一下：__attribute__((constructor)) 在main() 之前执行,__attribute__((destructor)) 在main()执行结束之后执行.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">上面的例子中我没有在main函数中添加任何的输出，所以看不到具体的信息.这点可以自己尝试～</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">如果要在main()之前或者是执行完成之后，需要执行很多的前处理动作或者是后处理动作，我们应该怎么处理?</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">也许，你需要下面这些东西:</p> 
   <div class="cnblogs_Highlighter" style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"> 
    <div class="syntaxhighlighter nogutter cpp" style="font-size:1em;"> 
     <table border="0" style="border-collapse:collapse;border-spacing:0px;border:1px solid #C0C0C0;background:none;line-height:1.1em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;font-size:12px;">
      <tbody style="background:none;border:0px;line-height:1.1em;vertical-align:baseline;">
       <tr style="background:none;border:0px;line-height:1.1em;vertical-align:baseline;">
        <td class="code" style="border:1px solid #C0C0C0;border-collapse:collapse;background:none;line-height:1.1em;vertical-align:baseline;"> 
         <div style="background:none;border:0px;line-height:1.1em;vertical-align:baseline;"> 
          <div class="line number1 index0 alt2" style="background:rgb(244,244,244) none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">__attribute__((constructor(PRIORITY)))</code>
          </div> 
          <div class="line number2 index1 alt1" style="background-image:none;border:0px;line-height:1.8em;vertical-align:baseline;">
           <code class="cpp plain" style="background:none;border:0px;line-height:1.8em;vertical-align:baseline;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;color:rgb(0,0,0);">__attribute__((destructor(PRIORITY)))</code>
          </div> 
         </div> </td>
       </tr>
      </tbody>
     </table>
    </div> 
   </div> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;PRIORITY: 优先级.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">好吧，下面就来试试：</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><img src="https://pic002.cnblogs.com/images/2012/420126/2012070904023252.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">执行的输出如下:</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><img src="https://pic002.cnblogs.com/images/2012/420126/2012070904031436.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;从输出的信息看，前处理都是按照优先级先后执行的，而后处理则是相反的，好吧，我们使用GDB调试验证一下:</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><img src="https://pic002.cnblogs.com/images/2012/420126/2012070904133841.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;从调试的信息也是验证了上面的结果.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">另外一个问题，优先级有没有范围的？&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">其实刚开始我写的程序中的优先级是1,我们将上面的程序改一下，然后编译看一下会有什么样的结果:</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><img src="https://pic002.cnblogs.com/images/2012/420126/2012070904161338.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><img src="https://pic002.cnblogs.com/images/2012/420126/2012070904164840.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;0-100(包括100),是内部保留的，所以在编码的时候需要注意.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">关于__attribute__的用法，可以有另外一种写法，先声明函数，然后再定义.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><img src="https://pic002.cnblogs.com/images/2012/420126/2012070904283447.png" alt="" style="border:none;"></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;glibc多采用第一种写法.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><strong>关于linux内核中的"__attribute__ ((packed))"</strong></p> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    引用:
    <br> __attrubte__ ((packed)) 的作用就是告诉编译器取消结构在编译过程中的优化对齐,按照实际占用字节数进行对齐。
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    #define __u8&nbsp;&nbsp;&nbsp; unsigned char
    <br> #define __u16&nbsp;&nbsp; unsigned short
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    /* __attribute__ ((packed)) 的位置约束是放于声明的尾部“；”之前 */
    <br> struct str_struct{
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; a;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; b;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; c;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u16&nbsp;&nbsp; d;
    <br> } __attribute__ ((packed));
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    /*&nbsp; 当用到typedef时，要特别注意__attribute__ ((packed))放置的位置，相当于：
    <br> &nbsp; *&nbsp; typedef struct str_stuct str;
    <br> &nbsp; *&nbsp; 而struct str_struct 就是上面的那个结构。
    <br> &nbsp; */
    <br> typedef struct {
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; a;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; b;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; c;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u16&nbsp;&nbsp; d;
    <br> } __attribute__ ((packed)) str;
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    /* 在下面这个typedef结构中，__attribute__ ((packed))放在结构名str_temp之后，其作用是被忽略的，注意与结构str的区别。*/
    <br> typedef struct {
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; a;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; b;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; c;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u16&nbsp;&nbsp; d;
    <br> }str_temp __attribute__ ((packed));
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    typedef struct {
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; a;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; b;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u8&nbsp;&nbsp;&nbsp; c;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __u16&nbsp;&nbsp; d;
    <br> }str_nopacked;
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    int main(void)
    <br> {
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("sizeof str = %d\n", sizeof(str));
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("sizeof str_struct = %d\n", sizeof(struct str_struct));
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("sizeof str_temp = %d\n", sizeof(str_temp));
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf("sizeof str_nopacked = %d\n", sizeof(str_nopacked));
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;
    <br> }
    <br> 编译运行:
    <br> 引用:
    <br> [root@localhost root]# ./packedtest&nbsp;&nbsp;&nbsp;
    <br> sizeof str = 5
    <br> sizeof str_struct = 5
    <br> sizeof str_temp = 6
    <br> sizeof str_nopacked = 6
    <br> GNU C的一大特色就是__attribute__机制。__attribute__可以设置函数属性（Function Attribute）、变量属性（Variable Attribute）和类型属性（Type Attribute）。
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    __attribute__书写特征是：__attribute__前后都有两个下划线，并且后面会紧跟一对括弧，括弧里面是相应的__attribute__参数。
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    __attribute__语法格式为：
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    __attribute__ ((attribute-list))
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    其位置约束：放于声明的尾部“；”之前。
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    函数属性（Function Attribute）：函数属性可以帮助开发者把一些特性添加到函数声明中，从而可以使编译器在错误检查方面的功能更强大。__attribute__机制也很容易同非GNU应用程序做到兼容之功效。
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    GNU CC需要使用 –Wall编译器来击活该功能，这是控制警告信息的一个很好的方式。
   </div> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    packed属性：使用该属性可以使得变量或者结构体成员使用最小的对齐方式，即对变量是一字节对齐，对域（field）是位对齐。
   </div> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">网络通信通常分为基于数据结构的和基于流的。HTTP协议就是后者的一个例子。<br> &nbsp;&nbsp;&nbsp; 有时为了提高程序的处理速度和数据处理的方便，会使用基于数据结构的通信（不需要对流进行解析）。但是，当需要在多平台间进行通信时，基于数据结构的通信，往往要十分注意以下几个方面：<br> [1] 字节序<br> [2] 变量长度<br> [3] 内存对齐<br> &nbsp;&nbsp;&nbsp; 在常见的系统架构中（Linux X86，Windows），非单字节长度的变量类型，都是低字节在前，而在某些特定系统中，如Soalris Sparc平台，高字节在前。如果在发送数据前不进行处理，那么由Linux X86发向Soalris Sparc平台的数据值，势必会有极大的偏差，进而程序运行过程中无法出现预计的正常结果，更严重时，会导致段错误。<br> &nbsp;&nbsp;&nbsp; 对于此种情况，我们往往使用同一的字节序。在系统中，有ntohXXX(), htonXXX()等函数，负责将数据在网络字节序和本地字节序之间转换。虽然每种系统的本地字节序不同，但是对于所有系统来说，网络字节序是固定的 -----高字节在前。所以，可以以网络字节序为通信的标准，发送前，数据都转换为网络字节序。<br> &nbsp;&nbsp;&nbsp; 转换的过程，也建议使用ntohXXX(), htonXXX()等标准函数，这样代码可以轻松地在各平台间进行移植（像通信这种很少依赖系统API的代码，做成通用版本是不错的选择）。<br><br> &nbsp;&nbsp;&nbsp; 变量的长度，在不同的系统之间会有差别，如同是Linux2.6.18的平台，在64位系统中，指针的长度为8个字节，而在32位系统中，指针又是4个字 节的长度---此处只是举个例子，很少有人会将指针作为数据发送出去。下面是我整理的在64位Linux系统和32位Linux系统中，几种常见C语言变 量的长度：<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; short&nbsp;&nbsp;&nbsp; int&nbsp;&nbsp;&nbsp; long&nbsp;&nbsp;&nbsp; long long&nbsp;&nbsp;&nbsp; ptr&nbsp;&nbsp;&nbsp; time_t<br> 32位&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4<br> 64位&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8<br> &nbsp;&nbsp;&nbsp; 在定义通信用的结构体时，应该考虑使用定常的数据类型，如uint32_t，4字节的固定长度，并且这属于标准C库(C99)，在各系统中都可使用。<br><br> &nbsp;&nbsp;&nbsp; 内存对齐的问题，也与系统是64位还是32位有关。如果你手头有32位和64位系统，不妨写个简单的程序测试一下，你就会看到同一个结构体，即便使用了定 常的数据类型，在不同系统中的大小是不同的。对齐往往是以4字节或8字节为准的，只要你写的测试程序，变量所占空间没有对齐到4或8的倍数即可，举个简单 的测试用的结构体的例子吧：<br> struct student<br> {<br> &nbsp;&nbsp;&nbsp; char name[7];<br> &nbsp;&nbsp;&nbsp; uint32_t id;<br> &nbsp;&nbsp;&nbsp; char subject[5];<br> };<br> &nbsp;&nbsp;&nbsp; 在每个系统上看下这个结构体的长度吧。<br> &nbsp;&nbsp;&nbsp; 内存对齐，往往是由编译器来做的，如果你使用的是gcc，可以在定义变量时，添加__attribute__，来决定是否使用内存对齐，或是内存对齐到几个字节，以上面的结构体为例：<br> &nbsp;1)到4字节，同样可指定对齐到8字节。<br> struct student<br> {<br> &nbsp;&nbsp;&nbsp; char name[7];<br> &nbsp;&nbsp;&nbsp; uint32_t id;<br> &nbsp;&nbsp;&nbsp; char subject[5];<br> } __attribute__ ((aligned(4)));&nbsp;<br><br> 2)不对齐，结构体的长度，就是各个变量长度的和<br> struct student<br> {<br> &nbsp;&nbsp;&nbsp; char name[7];<br> &nbsp;&nbsp;&nbsp; uint32_t id;<br> &nbsp;&nbsp;&nbsp; char subject[5];<br> } __attribute__ ((packed));</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">One of the best (but little known) features of GNU C is the&nbsp;<strong>__attribute__</strong>&nbsp;mechanism, which allows a developer to attach characteristics to function declarations to allow the compiler to perform more error checking. It was designed in a way to be compatible with non-GNU implementations, and we've been using this for&nbsp;<em>years</em>&nbsp;in highly portable code with very good results.</p> 
   <div style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    Table of Contents 
    <ol>
     <li style="list-style:decimal;"><a href="http://www.unixwiz.net/techtips/gnu-c-attributes.html#format" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">__attribute__ format</a></li> 
     <li style="list-style:decimal;"><a href="http://www.unixwiz.net/techtips/gnu-c-attributes.html#noreturn" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">__attribute__ noreturn</a></li> 
     <li style="list-style:decimal;"><a href="http://www.unixwiz.net/techtips/gnu-c-attributes.html#const" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">__attribute__ const</a></li> 
     <li style="list-style:decimal;"><a href="http://www.unixwiz.net/techtips/gnu-c-attributes.html#together" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">Putting them together</a></li> 
     <li style="list-style:decimal;"><a href="http://www.unixwiz.net/techtips/gnu-c-attributes.html#compat" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">Compatibility with non-GNU compilers</a></li> 
     <li style="list-style:decimal;"><a href="http://www.unixwiz.net/techtips/gnu-c-attributes.html#refs" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">Other References</a></li> 
    </ol>
   </div> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">Note that&nbsp;<strong>__attribute__</strong>&nbsp;spelled with two underscores before and two after, and there are always&nbsp;<em>two</em>&nbsp;sets of parentheses surrounding the contents. There is a good reason for this - see below. Gnu CC needs to use the&nbsp;<strong>-Wall</strong>&nbsp;compiler directive to enable this (yes, there is a finer degree of warnings control available, but we are very big fans of max warnings anyway).</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><strong>&nbsp;</strong></p> 
   <h1 style="font-size:28px;line-height:1.5;color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';">__ATTRIBUTE__ FORMAT</h1> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">This&nbsp;<strong>__attribute__</strong>&nbsp;allows assigning&nbsp;<strong>printf</strong>-like or&nbsp;<strong>scanf</strong>-like characteristics to the declared function, and this enables the compiler to check the format string against the parameters provided throughout the code. This is&nbsp;<em>exceptionally</em>&nbsp;helpful in tracking down hard-to-find bugs.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">There are two flavors:</p> 
   <ul style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    <li style="list-style:disc;"><strong>__attribute__((format(printf,<em>m</em>,<em>n</em>)))</strong></li> 
    <li style="list-style:disc;"><strong>__attribute__((format(scanf,<em>m</em>,<em>n</em>)))</strong></li> 
   </ul>
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">but in practice we use the first one much more often.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">The (<em>m</em>) is the number of the "format string" parameter, and (<em>n</em>) is the number of the first variadic parameter. To see some examples:</p> 
   <pre class="codeblock">/* like printf() but to standard error only */
<strong>extern void eprintf(const char *format, ...)
	__attribute__((format(printf, 1, 2)))</strong>;  /* <em>1=format 2=params</em> */

/* printf only if debugging is at the desired level */
<strong>extern void dprintf(int dlevel, const char *format, ...)
	__attribute__((format(printf, 2, 3)))</strong>;  /* <em>2=format 3=params</em> */
</pre> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">With the functions so declared, the compiler will examine the argument lists</p> 
   <pre class="codeblock">$ <strong>cat test.c</strong>
<em>1</em>  extern void eprintf(const char *format, ...)
<em>2</em>               <strong>__attribute__((format(printf, 1, 2)))</strong>;
<em>3</em>
<em>4</em>  void foo()
<em>5</em>  {
<strong><em>6</em>      eprintf("s=%s\n", 5);</strong>             /* <em>error on this line</em> */
<em>7</em>
<strong><em>8</em>      eprintf("n=%d,%d,%d\n", 1, 2);</strong>    /* <em>error on this line</em> */
<em>9</em>  }

$ <strong>cc -Wall -c test.c</strong>
test.c: In function `foo':
<strong>test.c:6</strong>: warning: format argument is not a pointer (arg 2)
<strong>test.c:8</strong>: warning: too few arguments for format
</pre> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">Note that the "standard" library functions -&nbsp;printf&nbsp;and the like - are already understood by the compiler by default.</p> 
   <h1 style="font-size:28px;line-height:1.5;color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';">__ATTRIBUTE__ NORETURN</h1> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">This attribute tells the compiler that the function won't ever return, and this can be used to suppress errors about code paths not being reached. The C library functions&nbsp;abort()&nbsp;and&nbsp;exit()&nbsp;are both declared with this attribute:</p> 
   <pre class="codeblock">extern void exit(int)   <strong>__attribute__((noreturn))</strong>;
extern void abort(void) <strong>__attribute__((noreturn))</strong>;
</pre> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">Once tagged this way, the compiler can keep track of paths through the code and suppress errors that won't ever happen due to the flow of control never returning after the function call.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">In this example, two nearly-identical C source files refer to an "exitnow()" function that never returns, but without the&nbsp;<strong>__attribute__</strong>tag, the compiler issues a warning. The compiler is correct here, because it has no way of knowing that control doesn't return.</p> 
   <pre class="codeblock">$ <strong>cat test1.c</strong>
extern void exitnow();

int foo(int n)
{
        if ( n &gt; 0 )
	{
                exitnow();
		/* <em>control never reaches this point</em> */
	}
        else
                return 0;
}

$ <strong>cc -c -Wall test1.c</strong>
test1.c: In function `foo':
<strong>test1.c:9: warning: this function may return with or without a value</strong>
</pre> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">But when we add&nbsp;<strong>__attribute__</strong>, the compiler suppresses the spurious warning:</p> 
   <pre class="codeblock">$ <strong>cat test2.c</strong>
extern void exitnow() <strong>__attribute__((noreturn))</strong>;

int foo(int n)
{
        if ( n &gt; 0 )
                exitnow();
        else
                return 0;
}

$ <strong>cc -c -Wall test2.c</strong>
<em>no warnings!</em>
</pre> 
   <h1 style="font-size:28px;line-height:1.5;color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';">__ATTRIBUTE__ CONST</h1> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">This attribute marks the function as considering&nbsp;<em>only</em>&nbsp;its numeric parameters. This is mainly intended for the compiler to optimize away repeated calls to a function that the compiler knows will return the same value repeatedly. It applies mostly to math functions that have no static state or side effects, and whose return is solely determined by the inputs.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">In this highly-contrived example, the compiler normally&nbsp;<em>must</em>&nbsp;call the&nbsp;<strong>square()</strong>&nbsp;function in every loop even though we know that it's going to return the same value each time:</p> 
   <pre class="codeblock">extern int square(int n) <strong>__attribute__((const))</strong>;

...
	for (i = 0; i &lt; 100; i++ )
	{
		total += square(5) + i;
	}
</pre> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">By adding&nbsp;<strong>__attribute__((const))</strong>, the compiler can choose to call the function just once and cache the return value.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">In virtually every case,&nbsp;<strong>const</strong>&nbsp;can't be used on functions that take pointers, because the function is not considering just the function parameters but&nbsp;<em>also the data the parameters point to</em>, and it will almost certainly break the code very badly in ways that will be nearly impossible to track down.</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">Furthermore, the functions so tagged cannot have any side effects or static state, so things like&nbsp;<strong>getchar()</strong>&nbsp;or&nbsp;<strong>time()</strong>&nbsp;would behave very poorly under these circumstances.</p> 
   <h1 style="font-size:28px;line-height:1.5;color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';">PUTTING THEM TOGETHER</h1> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">Multiple&nbsp;<strong>__attributes__</strong>&nbsp;can be strung together on a single declaration, and this is not uncommon in practice. You can either use two separate&nbsp;<strong>__attribute__</strong>s, or use one with a comma-separated list:</p> 
   <pre class="codeblock">/* <em>send printf-like message to stderr and exit</em> */
extern void die(const char *format, ...)
	<strong>__attribute__((noreturn))
	__attribute__((format(printf, 1, 2)))</strong>;

/*or*/

extern void die(const char *format, ...)
	<strong>__attribute__((noreturn, format(printf, 1, 2)))</strong>;
</pre> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">If this is tucked away safely in a library header file,&nbsp;<em>all</em>&nbsp;programs that call this function receive this checking.</p> 
   <h1 style="font-size:28px;line-height:1.5;color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';">COMPATIBILITY WITH NON-GNU&nbsp;COMPILERS</h1> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">Fortunately, the&nbsp;<strong>__attribute__</strong>&nbsp;mechanism was cleverly designed in a way to make it easy to quietly eliminate them if used on platforms other than GNU C. Superficially,&nbsp;<strong>__attribute__</strong>&nbsp;appears to have multiple parameters (which would typically rule out using a macro), but the&nbsp;<em>two</em>&nbsp;sets of parentheses effectively make it a single parameter, and in practice this works very nicely.</p> 
   <pre class="codeblock">/* If we're not using GNU C, elide __attribute__ */
#ifndef __GNUC__
#  define  __attribute__(x)  /*NOTHING*/
#endif
</pre> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">Note that&nbsp;<strong>__attribute__</strong>&nbsp;applies to function&nbsp;<em>declarations</em>, not&nbsp;<em>definitions</em>, and we're not sure why this is. So when defining a function that merits this treatment, an extra declaration must be used (in the same file):</p> 
   <pre class="codeblock">/* <em>function declaration</em> */
void die(const char *format, ...) <strong>__attribute__((noreturn))
                                  __attribute__((format(printf,1,2)))</strong>;

void die(const char *format, ...)
{
	/* <em>function definition</em> */
}
</pre> 
   <h1 style="font-size:28px;line-height:1.5;color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';">OTHER REFERENCES</h1> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">We'll note that there are many more attributes available, including those for&nbsp;<strong>variables</strong>&nbsp;and&nbsp;<strong>types</strong>, and they are not covered here: we have chosen to just touch on the high points. Those wishing more information can find it in the GNU online documentation at<a href="http://gcc.gnu.org/" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://gcc.gnu.org</a>:</p> 
   <dl style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">
    <dt>
     GCC 4.0
    </dt> 
    <dd> 
     <a href="http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Function-Attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">GCC 4.0 Function Attributes</a>&nbsp;
     <br>
     <a href="http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Variable-Attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">GCC 4.0 Variable Attributes</a>&nbsp;
     <br>
     <a href="http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Type-Attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">GCC 4.0 Type Attributes</a>&nbsp;
    </dd> 
    <dt>
     GCC 3.2
    </dt> 
    <dd> 
     <a href="http://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Function-Attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">GCC 3.2 Function Attributes</a>&nbsp;
     <br>
     <a href="http://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Variable-Attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">GCC 3.2 Variable Attributes</a>&nbsp;
     <br>
     <a href="http://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Type-Attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">GCC 3.2 Type Attributes</a> 
    </dd> 
    <dt>
     GCC 3.1
    </dt> 
    <dd> 
     <a href="http://gcc.gnu.org/onlinedocs/gcc-3.1/gcc/Function-Attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">GCC 3.1 Function Attributes</a>&nbsp;
     <br>
     <a href="http://gcc.gnu.org/onlinedocs/gcc-3.1/gcc/Variable-Attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">GCC 3.1 Variable Attributes</a>&nbsp;
     <br>
     <a href="http://gcc.gnu.org/onlinedocs/gcc-3.1/gcc/Type-Attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">GCC 3.1 Type Attributes</a> 
    </dd> 
    <dt>
     GCC 3.0.4
    </dt> 
    <dd> 
     <a href="http://gcc.gnu.org/onlinedocs/gcc-3.0.4/gcc_5.html#SEC94" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">Function Attributes</a>&nbsp;
     <br>
     <a href="http://gcc.gnu.org/onlinedocs/gcc-3.0.4/gcc_5.html#SEC101" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">Variable Attributes</a>&nbsp;
     <br>
     <a href="http://gcc.gnu.org/onlinedocs/gcc-3.0.4/gcc_5.html#SEC102" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">Type Attributes</a> 
    </dd> 
    <dt>
     GCC 2.95.3
    </dt> 
    <dd> 
     <a href="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_4.html#SEC84" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">Function Attributes</a>&nbsp;
     <br>
     <a href="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_4.html#SEC90" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">Variable Attributes</a>&nbsp;
     <br>
     <a href="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_4.html#SEC91" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">Type Attributes</a> 
    </dd> 
   </dl>
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><strong>参考：</strong></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><a href="http://blog.sina.com.cn/s/blog_644c3be70100i8ii.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://blog.sina.com.cn/s/blog_644c3be70100i8ii.html</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><a href="http://hi.baidu.com/srbadxecnihqtue/item/039535e051a0d30f8d3ea8b1" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://hi.baidu.com/srbadxecnihqtue/item/039535e051a0d30f8d3ea8b1</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><a href="http://www.cnblogs.com/respawn/archive/2012/07/09/2582078.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://www.cnblogs.com/respawn/archive/2012/07/09/2582078.html</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><a href="http://qq164587043.blog.51cto.com/261469/187562" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://qq164587043.blog.51cto.com/261469/187562</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><a href="http://my.oschina.net/u/174242/blog/72760" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://my.oschina.net/u/174242/blog/72760</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><a href="http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Function-Attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Function-Attributes.html</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><a href="http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Type-Attributes.html#Type-Attributes" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Type-Attributes.html#Type-Attributes</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><a href="http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Variable-Attributes.html#Variable-Attributes" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Variable-Attributes.html#Variable-Attributes</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><a href="http://www.unixwiz.net/techtips/gnu-c-attributes.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://www.unixwiz.net/techtips/gnu-c-attributes.html</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p><font color="#666666"><span style="font-size:14px;">本文转自张昺华-sky博客园博客，原文链接：http://www.cnblogs.com/sky-heaven/p/5960405.html</span></font><span style="font-size:14px;color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';">，如需转载请自行联系原作者</span></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
