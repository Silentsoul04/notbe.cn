<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Hadoop MapReduce编程 API入门系列之最短路径（十五） « NotBeCN</title>
  <meta name="description" content="             &nbsp;                            &nbsp;    ====================================== = Iteration: 1 = Input path: out/shortestpath/input.txt = Out...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/14/weixin_33790053_90121316.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">Hadoop MapReduce编程 API入门系列之最短路径（十五）</h1>
    <p class="post-meta">Nov 14, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;<img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164047714-1923236758.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164124995-2118794164.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164132183-1075632026.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164139417-501380870.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164206776-427499561.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164300136-1299042986.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164329183-125743513.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;<img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164351901-2067925910.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">======================================<br> = Iteration: 1<br> = Input path: out/shortestpath/input.txt<br> = Output path: out/shortestpath/1<br> ======================================<br> 2016-12-12 16:37:05,638 INFO [org.apache.hadoop.metrics.jvm.JvmMetrics] - Initializing JVM Metrics with processName=JobTracker, sessionId=<br> 2016-12-12 16:37:06,231 WARN [org.apache.hadoop.mapreduce.JobSubmitter] - Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.<br> 2016-12-12 16:37:06,236 WARN [org.apache.hadoop.mapreduce.JobSubmitter] - No job jar file set. User classes may not be found. See Job or Job#setJar(String).<br> 2016-12-12 16:37:06,260 INFO [org.apache.hadoop.mapreduce.lib.input.FileInputFormat] - Total input paths to process : 1<br> 2016-12-12 16:37:06,363 INFO [org.apache.hadoop.mapreduce.JobSubmitter] - number of splits:1<br> 2016-12-12 16:37:06,831 INFO [org.apache.hadoop.mapreduce.JobSubmitter] - Submitting tokens for job: job_local535100118_0001<br> 2016-12-12 16:37:07,524 INFO [org.apache.hadoop.mapreduce.Job] - The url to track the job: http://localhost:8080/<br> 2016-12-12 16:37:07,526 INFO [org.apache.hadoop.mapreduce.Job] - Running job: job_local535100118_0001<br> 2016-12-12 16:37:07,534 INFO [org.apache.hadoop.mapred.LocalJobRunner] - OutputCommitter set in config null<br> 2016-12-12 16:37:07,550 INFO [org.apache.hadoop.mapred.LocalJobRunner] - OutputCommitter is org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter<br> 2016-12-12 16:37:07,635 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Waiting for map tasks<br> 2016-12-12 16:37:07,638 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local535100118_0001_m_000000_0<br> 2016-12-12 16:37:07,716 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 16:37:07,759 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@27b70923<br> 2016-12-12 16:37:07,767 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/shortestpath/input.txt:0+149<br> 2016-12-12 16:37:07,830 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 16:37:07,830 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 16:37:07,830 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 16:37:07,830 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 16:37:07,830 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 16:37:07,834 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> input -&gt; K[dee],V[0 null hadoop hello]<br> output -&gt; K[dee],V[0 hadoop hello]<br> output -&gt; K[hadoop],V[1 dee]<br> output -&gt; K[hello],V[1 dee]<br> input -&gt; K[hadoop],V[2147483647 null hive hello]<br> output -&gt; K[hadoop],V[2147483647 hive hello]<br> input -&gt; K[hello],V[2147483647 null dee hadoop hive joe]<br> output -&gt; K[hello],V[2147483647 dee hadoop hive joe]<br> input -&gt; K[hive],V[2147483647 null hadoop hello joe]<br> output -&gt; K[hive],V[2147483647 hadoop hello joe]<br> input -&gt; K[joe],V[2147483647 null hive hello]<br> output -&gt; K[joe],V[2147483647 hive hello]<br> 2016-12-12 16:37:07,851 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 16:37:07,851 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 16:37:07,851 INFO [org.apache.hadoop.mapred.MapTask] - Spilling map output<br> 2016-12-12 16:37:07,851 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufend = 174; bufvoid = 104857600<br> 2016-12-12 16:37:07,852 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396(104857584); kvend = 26214372(104857488); length = 25/6553600<br> 2016-12-12 16:37:07,871 INFO [org.apache.hadoop.mapred.MapTask] - Finished spill 0<br> 2016-12-12 16:37:07,877 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local535100118_0001_m_000000_0 is done. And is in the process of committing<br> 2016-12-12 16:37:07,891 INFO [org.apache.hadoop.mapred.LocalJobRunner] - file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/shortestpath/input.txt:0+149<br> 2016-12-12 16:37:07,892 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local535100118_0001_m_000000_0' done.<br> 2016-12-12 16:37:07,892 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local535100118_0001_m_000000_0<br> 2016-12-12 16:37:07,892 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map task executor complete.<br> 2016-12-12 16:37:07,896 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Waiting for reduce tasks<br> 2016-12-12 16:37:07,896 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local535100118_0001_r_000000_0<br> 2016-12-12 16:37:07,910 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 16:37:07,942 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@5bf7b707<br> 2016-12-12 16:37:07,948 INFO [org.apache.hadoop.mapred.ReduceTask] - Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@969f4cd<br> 2016-12-12 16:37:07,972 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - MergerManager: memoryLimit=1327077760, maxSingleShuffleLimit=331769440, mergeThreshold=875871360, ioSortFactor=10, memToMemMergeOutputsThreshold=10<br> 2016-12-12 16:37:07,975 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - attempt_local535100118_0001_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events<br> 2016-12-12 16:37:08,017 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#1 about to shuffle output of map attempt_local535100118_0001_m_000000_0 decomp: 190 len: 194 to MEMORY<br> 2016-12-12 16:37:08,023 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 190 bytes from map-output for attempt_local535100118_0001_m_000000_0<br> 2016-12-12 16:37:08,076 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 190, inMemoryMapOutputs.size() -&gt; 1, commitMemory -&gt; 0, usedMemory -&gt;190<br> 2016-12-12 16:37:08,078 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - EventFetcher is interrupted.. Returning<br> 2016-12-12 16:37:08,080 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 16:37:08,081 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs<br> 2016-12-12 16:37:08,110 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 16:37:08,111 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 184 bytes<br> 2016-12-12 16:37:08,113 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merged 1 segments, 190 bytes to disk to satisfy reduce memory limit<br> 2016-12-12 16:37:08,114 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 1 files, 194 bytes from disk<br> 2016-12-12 16:37:08,115 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 0 segments, 0 bytes from memory into reduce<br> 2016-12-12 16:37:08,116 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 16:37:08,117 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 184 bytes<br> 2016-12-12 16:37:08,118 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 16:37:08,141 INFO [org.apache.hadoop.conf.Configuration.deprecation] - mapred.skip.on is deprecated. Instead, use mapreduce.job.skiprecords<br> input -&gt; K[dee]<br> input -&gt; V[0 hadoop hello]<br> output -&gt; K[dee],V[0 null hadoop hello]<br> input -&gt; K[hadoop]<br> input -&gt; V[2147483647 hive hello]<br> input -&gt; V[1 dee]<br> output -&gt; K[hadoop],V[1 dee hive hello]<br> input -&gt; K[hello]<br> input -&gt; V[2147483647 dee hadoop hive joe]<br> input -&gt; V[1 dee]<br> output -&gt; K[hello],V[1 dee dee hadoop hive joe]<br> input -&gt; K[hive]<br> input -&gt; V[2147483647 hadoop hello joe]<br> output -&gt; K[hive],V[2147483647 null hadoop hello joe]<br> input -&gt; K[joe]<br> input -&gt; V[2147483647 hive hello]<br> output -&gt; K[joe],V[2147483647 null hive hello]<br> 2016-12-12 16:37:08,154 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local535100118_0001_r_000000_0 is done. And is in the process of committing<br> 2016-12-12 16:37:08,156 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 16:37:08,156 INFO [org.apache.hadoop.mapred.Task] - Task attempt_local535100118_0001_r_000000_0 is allowed to commit now<br> 2016-12-12 16:37:08,162 INFO [org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter] - Saved output of task 'attempt_local535100118_0001_r_000000_0' to file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/shortestpath/1/_temporary/0/task_local535100118_0001_r_000000<br> 2016-12-12 16:37:08,163 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce &gt; reduce<br> 2016-12-12 16:37:08,164 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local535100118_0001_r_000000_0' done.<br> 2016-12-12 16:37:08,164 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local535100118_0001_r_000000_0<br> 2016-12-12 16:37:08,164 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce task executor complete.<br> 2016-12-12 16:37:08,535 INFO [org.apache.hadoop.mapreduce.Job] - Job job_local535100118_0001 running in uber mode : false<br> 2016-12-12 16:37:08,539 INFO [org.apache.hadoop.mapreduce.Job] - map 100% reduce 100%<br> 2016-12-12 16:37:08,544 INFO [org.apache.hadoop.mapreduce.Job] - Job job_local535100118_0001 completed successfully<br> 2016-12-12 16:37:08,601 INFO [org.apache.hadoop.mapreduce.Job] - Counters: 33<br> File System Counters<br> FILE: Number of bytes read=1340<br> FILE: Number of bytes written=387869<br> FILE: Number of read operations=0<br> FILE: Number of large read operations=0<br> FILE: Number of write operations=0<br> Map-Reduce Framework<br> Map input records=5<br> Map output records=7<br> Map output bytes=174<br> Map output materialized bytes=194<br> Input split bytes=135<br> Combine input records=0<br> Combine output records=0<br> Reduce input groups=5<br> Reduce shuffle bytes=194<br> Reduce input records=7<br> Reduce output records=5<br> Spilled Records=14<br> Shuffled Maps =1<br> Failed Shuffles=0<br> Merged Map outputs=1<br> GC time elapsed (ms)=0<br> CPU time spent (ms)=0<br> Physical memory (bytes) snapshot=0<br> Virtual memory (bytes) snapshot=0<br> Total committed heap usage (bytes)=466616320<br> Shuffle Errors<br> BAD_ID=0<br> CONNECTION=0<br> IO_ERROR=0<br> WRONG_LENGTH=0<br> WRONG_MAP=0<br> WRONG_REDUCE=0<br> File Input Format Counters&nbsp;<br> Bytes Read=169<br> File Output Format Counters&nbsp;<br> Bytes Written=161<br> ======================================<br> = Iteration: 2<br> = Input path: out/shortestpath/1<br> = Output path: out/shortestpath/2<br> ======================================<br> 2016-12-12 16:37:08,638 INFO [org.apache.hadoop.metrics.jvm.JvmMetrics] - Cannot initialize JVM Metrics with processName=JobTracker, sessionId= - already initialized<br> 2016-12-12 16:37:08,649 WARN [org.apache.hadoop.mapreduce.JobSubmitter] - Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.<br> 2016-12-12 16:37:08,653 WARN [org.apache.hadoop.mapreduce.JobSubmitter] - No job jar file set. User classes may not be found. See Job or Job#setJar(String).<br> 2016-12-12 16:37:09,079 INFO [org.apache.hadoop.mapreduce.lib.input.FileInputFormat] - Total input paths to process : 1<br> 2016-12-12 16:37:09,098 INFO [org.apache.hadoop.mapreduce.JobSubmitter] - number of splits:1<br> 2016-12-12 16:37:09,183 INFO [org.apache.hadoop.mapreduce.JobSubmitter] - Submitting tokens for job: job_local447108750_0002<br> 2016-12-12 16:37:09,525 INFO [org.apache.hadoop.mapreduce.Job] - The url to track the job: http://localhost:8080/<br> 2016-12-12 16:37:09,525 INFO [org.apache.hadoop.mapreduce.Job] - Running job: job_local447108750_0002<br> 2016-12-12 16:37:09,527 INFO [org.apache.hadoop.mapred.LocalJobRunner] - OutputCommitter set in config null<br> 2016-12-12 16:37:09,529 INFO [org.apache.hadoop.mapred.LocalJobRunner] - OutputCommitter is org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter<br> 2016-12-12 16:37:09,540 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Waiting for map tasks<br> 2016-12-12 16:37:09,540 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local447108750_0002_m_000000_0<br> 2016-12-12 16:37:09,544 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 16:37:09,591 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@25a02403<br> 2016-12-12 16:37:09,597 INFO [org.apache.hadoop.mapred.MapTask] - Processing split: file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/shortestpath/1/part-r-00000:0+149<br> 2016-12-12 16:37:09,662 INFO [org.apache.hadoop.mapred.MapTask] - (EQUATOR) 0 kvi 26214396(104857584)<br> 2016-12-12 16:37:09,663 INFO [org.apache.hadoop.mapred.MapTask] - mapreduce.task.io.sort.mb: 100<br> 2016-12-12 16:37:09,663 INFO [org.apache.hadoop.mapred.MapTask] - soft limit at 83886080<br> 2016-12-12 16:37:09,663 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufvoid = 104857600<br> 2016-12-12 16:37:09,663 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396; length = 6553600<br> 2016-12-12 16:37:09,666 INFO [org.apache.hadoop.mapred.MapTask] - Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer<br> input -&gt; K[dee],V[0 null hadoop hello]<br> output -&gt; K[dee],V[0 null hadoop hello]<br> output -&gt; K[hadoop],V[1 null:dee]<br> output -&gt; K[hello],V[1 null:dee]<br> input -&gt; K[hadoop],V[1 dee hive hello]<br> output -&gt; K[hadoop],V[1 dee hive hello]<br> output -&gt; K[hive],V[2 dee:hadoop]<br> output -&gt; K[hello],V[2 dee:hadoop]<br> input -&gt; K[hello],V[1 dee dee hadoop hive joe]<br> output -&gt; K[hello],V[1 dee dee hadoop hive joe]<br> output -&gt; K[dee],V[2 dee:hello]<br> output -&gt; K[hadoop],V[2 dee:hello]<br> output -&gt; K[hive],V[2 dee:hello]<br> output -&gt; K[joe],V[2 dee:hello]<br> input -&gt; K[hive],V[2147483647 null hadoop hello joe]<br> output -&gt; K[hive],V[2147483647 null hadoop hello joe]<br> input -&gt; K[joe],V[2147483647 null hive hello]<br> output -&gt; K[joe],V[2147483647 null hive hello]<br> 2016-12-12 16:37:09,675 INFO [org.apache.hadoop.mapred.LocalJobRunner] -&nbsp;<br> 2016-12-12 16:37:09,675 INFO [org.apache.hadoop.mapred.MapTask] - Starting flush of map output<br> 2016-12-12 16:37:09,675 INFO [org.apache.hadoop.mapred.MapTask] - Spilling map output<br> 2016-12-12 16:37:09,675 INFO [org.apache.hadoop.mapred.MapTask] - bufstart = 0; bufend = 289; bufvoid = 104857600<br> 2016-12-12 16:37:09,676 INFO [org.apache.hadoop.mapred.MapTask] - kvstart = 26214396(104857584); kvend = 26214348(104857392); length = 49/6553600<br> 2016-12-12 16:37:09,691 INFO [org.apache.hadoop.mapred.MapTask] - Finished spill 0<br> 2016-12-12 16:37:09,699 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local447108750_0002_m_000000_0 is done. And is in the process of committing<br> 2016-12-12 16:37:09,704 INFO [org.apache.hadoop.mapred.LocalJobRunner] - file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/shortestpath/1/part-r-00000:0+149<br> 2016-12-12 16:37:09,705 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local447108750_0002_m_000000_0' done.<br> 2016-12-12 16:37:09,705 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local447108750_0002_m_000000_0<br> 2016-12-12 16:37:09,705 INFO [org.apache.hadoop.mapred.LocalJobRunner] - map task executor complete.<br> 2016-12-12 16:37:09,707 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Waiting for reduce tasks<br> 2016-12-12 16:37:09,708 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Starting task: attempt_local447108750_0002_r_000000_0<br> 2016-12-12 16:37:09,714 INFO [org.apache.hadoop.yarn.util.ProcfsBasedProcessTree] - ProcfsBasedProcessTree currently is supported only on Linux.<br> 2016-12-12 16:37:09,856 INFO [org.apache.hadoop.mapred.Task] - Using ResourceCalculatorProcessTree : org.apache.hadoop.yarn.util.WindowsBasedProcessTree@3f539d4b<br> 2016-12-12 16:37:09,857 INFO [org.apache.hadoop.mapred.ReduceTask] - Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@a7bc768<br> 2016-12-12 16:37:09,862 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - MergerManager: memoryLimit=1327077760, maxSingleShuffleLimit=331769440, mergeThreshold=875871360, ioSortFactor=10, memToMemMergeOutputsThreshold=10<br> 2016-12-12 16:37:09,865 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - attempt_local447108750_0002_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events<br> 2016-12-12 16:37:09,871 INFO [org.apache.hadoop.mapreduce.task.reduce.LocalFetcher] - localfetcher#2 about to shuffle output of map attempt_local447108750_0002_m_000000_0 decomp: 317 len: 321 to MEMORY<br> 2016-12-12 16:37:09,874 INFO [org.apache.hadoop.mapreduce.task.reduce.InMemoryMapOutput] - Read 317 bytes from map-output for attempt_local447108750_0002_m_000000_0<br> 2016-12-12 16:37:09,876 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - closeInMemoryFile -&gt; map-output of size: 317, inMemoryMapOutputs.size() -&gt; 1, commitMemory -&gt; 0, usedMemory -&gt;317<br> 2016-12-12 16:37:09,877 INFO [org.apache.hadoop.mapreduce.task.reduce.EventFetcher] - EventFetcher is interrupted.. Returning<br> 2016-12-12 16:37:09,879 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 16:37:09,879 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs<br> 2016-12-12 16:37:09,892 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 16:37:09,893 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 311 bytes<br> 2016-12-12 16:37:09,896 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merged 1 segments, 317 bytes to disk to satisfy reduce memory limit<br> 2016-12-12 16:37:09,898 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 1 files, 321 bytes from disk<br> 2016-12-12 16:37:09,898 INFO [org.apache.hadoop.mapreduce.task.reduce.MergeManagerImpl] - Merging 0 segments, 0 bytes from memory into reduce<br> 2016-12-12 16:37:09,898 INFO [org.apache.hadoop.mapred.Merger] - Merging 1 sorted segments<br> 2016-12-12 16:37:09,901 INFO [org.apache.hadoop.mapred.Merger] - Down to the last merge-pass, with 1 segments left of total size: 311 bytes<br> 2016-12-12 16:37:09,902 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> input -&gt; K[dee]<br> input -&gt; V[2 dee:hello]<br> input -&gt; V[0 null hadoop hello]<br> output -&gt; K[dee],V[0 null hadoop hello]<br> input -&gt; K[hadoop]<br> input -&gt; V[1 null:dee]<br> input -&gt; V[1 dee hive hello]<br> input -&gt; V[2 dee:hello]<br> output -&gt; K[hadoop],V[1 null:dee hive hello]<br> input -&gt; K[hello]<br> input -&gt; V[1 dee dee hadoop hive joe]<br> input -&gt; V[2 dee:hadoop]<br> input -&gt; V[1 null:dee]<br> output -&gt; K[hello],V[1 dee dee hadoop hive joe]<br> input -&gt; K[hive]<br> input -&gt; V[2 dee:hadoop]<br> input -&gt; V[2 dee:hello]<br> input -&gt; V[2147483647 null hadoop hello joe]<br> output -&gt; K[hive],V[2 dee:hadoop hadoop hello joe]<br> input -&gt; K[joe]<br> input -&gt; V[2 dee:hello]<br> input -&gt; V[2147483647 null hive hello]<br> output -&gt; K[joe],V[2 dee:hello hive hello]<br> 2016-12-12 16:37:09,929 INFO [org.apache.hadoop.mapred.Task] - Task:attempt_local447108750_0002_r_000000_0 is done. And is in the process of committing<br> 2016-12-12 16:37:09,934 INFO [org.apache.hadoop.mapred.LocalJobRunner] - 1 / 1 copied.<br> 2016-12-12 16:37:09,934 INFO [org.apache.hadoop.mapred.Task] - Task attempt_local447108750_0002_r_000000_0 is allowed to commit now<br> 2016-12-12 16:37:09,944 INFO [org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter] - Saved output of task 'attempt_local447108750_0002_r_000000_0' to file:/D:/Code/MyEclipseJavaCode/myMapReduce/out/shortestpath/2/_temporary/0/task_local447108750_0002_r_000000<br> 2016-12-12 16:37:09,947 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce &gt; reduce<br> 2016-12-12 16:37:09,948 INFO [org.apache.hadoop.mapred.Task] - Task 'attempt_local447108750_0002_r_000000_0' done.<br> 2016-12-12 16:37:09,948 INFO [org.apache.hadoop.mapred.LocalJobRunner] - Finishing task: attempt_local447108750_0002_r_000000_0<br> 2016-12-12 16:37:09,948 INFO [org.apache.hadoop.mapred.LocalJobRunner] - reduce task executor complete.<br> 2016-12-12 16:37:10,526 INFO [org.apache.hadoop.mapreduce.Job] - Job job_local447108750_0002 running in uber mode : false<br> 2016-12-12 16:37:10,526 INFO [org.apache.hadoop.mapreduce.Job] - map 100% reduce 100%<br> 2016-12-12 16:37:10,527 INFO [org.apache.hadoop.mapreduce.Job] - Job job_local447108750_0002 completed successfully<br> 2016-12-12 16:37:10,542 INFO [org.apache.hadoop.mapreduce.Job] - Counters: 35<br> File System Counters<br> FILE: Number of bytes read=3162<br> FILE: Number of bytes written=776144<br> FILE: Number of read operations=0<br> FILE: Number of large read operations=0<br> FILE: Number of write operations=0<br> Map-Reduce Framework<br> Map input records=5<br> Map output records=13<br> Map output bytes=289<br> Map output materialized bytes=321<br> Input split bytes=140<br> Combine input records=0<br> Combine output records=0<br> Reduce input groups=5<br> Reduce shuffle bytes=321<br> Reduce input records=13<br> Reduce output records=5<br> Spilled Records=26<br> Shuffled Maps =1<br> Failed Shuffles=0<br> Merged Map outputs=1<br> GC time elapsed (ms)=0<br> CPU time spent (ms)=0<br> Physical memory (bytes) snapshot=0<br> Virtual memory (bytes) snapshot=0<br> Total committed heap usage (bytes)=677380096<br> PATH<br> dee:hello=1<br> Shuffle Errors<br> BAD_ID=0<br> CONNECTION=0<br> IO_ERROR=0<br> WRONG_LENGTH=0<br> WRONG_MAP=0<br> WRONG_REDUCE=0<br> File Input Format Counters&nbsp;<br> Bytes Read=169<br> File Output Format Counters&nbsp;<br> Bytes Written=159<br> zhouls.bigdata.myMapReduce.shortestpath.Reduce$PathCounter<br> TARGET_NODE_DISTANCE_COMPUTED=2<br> ==========================================<br> = Shortest path found, details as follows.<br> =&nbsp;<br> = Start node: dee<br> = End node: joe<br> = Hops: 2<br> = Path: dee:hello<br> ==========================================</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164433167-2030927610.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;<img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164448464-1256115778.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164454636-721872072.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><img src="https://images2015.cnblogs.com/blog/855959/201612/855959-20161212164505979-1254209113.png" alt="" style="border:0px;"></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><span style="font-size:18pt;"><strong><span style="color:rgb(0,0,255);">代码</span></strong></span></p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.shortestpath;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.mapreduce.Mapper;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.IOException;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class Map<br> extends Mapper&lt;Text, Text, Text, Text&gt; {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">private Text outKey = new Text();<br> private Text outValue = new Text();</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">@Override<br> protected void map(Text key, Text value, Context context)<br> throws IOException, InterruptedException {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Node node = Node.fromMR(value.toString());</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">System.out.println("input -&gt; K[" + key + "],V[" + node + "]");</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">// output this node's key/value pair again to preserve the information<br> //<br> System.out.println(<br> " output -&gt; K[" + key + "],V[" + value + "]");<br> context.write(key, value);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">// only output the neighbor details if we have an actual distance<br> // from the source node<br> //<br> if (node.isDistanceSet()) {<br> // our neighbors are just a hop away<br> //</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">// create the backpointer, which will append our own<br> // node name to the list<br> //<br> String backpointer = node.constructBackpointer(key.toString());</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">// go through all the nodes and propagate the distance to them<br> //<br> for (int i = 0; i &lt; node.getAdjacentNodeNames().length; i++) {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">String neighbor = node.getAdjacentNodeNames()[i];<br> int neighborDistance = node.getDistance() + 1;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">// output the neighbor with the propagated distance and backpointer<br> //<br> outKey.set(neighbor);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Node adjacentNode = new Node()<br> .setDistance(neighborDistance)<br> .setBackpointer(backpointer);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">outValue.set(adjacentNode.toString());<br> System.out.println(<br> " output -&gt; K[" + outKey + "],V[" + outValue + "]");<br> context.write(outKey, outValue);<br> }<br> }<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.shortestpath;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.mapreduce.*;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.IOException;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class Reduce<br> extends Reducer&lt;Text, Text, Text, Text&gt; {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public static enum PathCounter {<br> TARGET_NODE_DISTANCE_COMPUTED,<br> PATH<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">private Text outValue = new Text();<br> private String targetNode;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">protected void setup(Context context<br> ) throws IOException, InterruptedException {<br> targetNode = context.getConfiguration().get(<br> Main.TARGET_NODE);<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public void reduce(Text key, Iterable&lt;Text&gt; values,<br> Context context)<br> throws IOException, InterruptedException {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">int minDistance = Node.INFINITE;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">System.out.println("input -&gt; K[" + key + "]");</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Node shortestAdjacentNode = null;<br> Node originalNode = null;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">for (Text textValue : values) {<br> System.out.println(" input -&gt; V[" + textValue + "]");</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Node node = Node.fromMR(textValue.toString());</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">if(node.containsAdjacentNodes()) {<br> // the original data<br> //<br> originalNode = node;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">if(node.getDistance() &lt; minDistance) {<br> minDistance = node.getDistance();<br> shortestAdjacentNode = node;<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">if(shortestAdjacentNode != null) {<br> originalNode.setDistance(minDistance);<br> originalNode.setBackpointer(shortestAdjacentNode.getBackpointer());<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">outValue.set(originalNode.toString());</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">System.out.println(<br> " output -&gt; K[" + key + "],V[" + outValue + "]");<br> context.write(key, outValue);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">if (minDistance != Node.INFINITE &amp;&amp;<br> targetNode.equals(key.toString())) {<br> Counter counter = context.getCounter(<br> PathCounter.TARGET_NODE_DISTANCE_COMPUTED);<br> counter.increment(minDistance);<br> context.getCounter(PathCounter.PATH.toString(),<br> shortestAdjacentNode.getBackpointer()).increment(1);<br> }<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.shortestpath;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import org.apache.commons.lang.StringUtils;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.IOException;<br> import java.util.Arrays;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public class Node {<br> private int distance = INFINITE;<br> private String backpointer;<br> private String[] adjacentNodeNames;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public static int INFINITE = Integer.MAX_VALUE;<br> public static final char fieldSeparator = '\t';</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public int getDistance() {<br> return distance;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public Node setDistance(int distance) {<br> this.distance = distance;<br> return this;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public String getBackpointer() {<br> return backpointer;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public Node setBackpointer(String backpointer) {<br> this.backpointer = backpointer;<br> return this;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public String constructBackpointer(String name) {<br> StringBuilder backpointers = new StringBuilder();<br> if (StringUtils.trimToNull(getBackpointer()) != null) {<br> backpointers.append(getBackpointer()).append(":");<br> }<br> backpointers.append(name);<br> return backpointers.toString();<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public String[] getAdjacentNodeNames() {<br> return adjacentNodeNames;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public Node setAdjacentNodeNames(String[] adjacentNodeNames) {<br> this.adjacentNodeNames = adjacentNodeNames;<br> return this;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public boolean containsAdjacentNodes() {<br> return adjacentNodeNames != null;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public boolean isDistanceSet() {<br> return distance != INFINITE;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">@Override<br> public String toString() {<br> StringBuilder sb = new StringBuilder();<br> sb.append(distance)<br> .append(fieldSeparator)<br> .append(backpointer);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">if (getAdjacentNodeNames() != null) {<br> sb.append(fieldSeparator)<br> .append(StringUtils<br> .join(getAdjacentNodeNames(), fieldSeparator));<br> }<br> return sb.toString();<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public static Node fromMR(String value) throws IOException {<br> String[] parts = StringUtils.splitPreserveAllTokens(<br> value, fieldSeparator);<br> if (parts.length &lt; 2) {<br> throw new IOException(<br> "Expected 2 or more parts but received " + parts.length);<br> }<br> Node node = new Node()<br> .setDistance(Integer.valueOf(parts[0]))<br> .setBackpointer(StringUtils.trimToNull(parts[1]));<br> if (parts.length &gt; 2) {<br> node.setAdjacentNodeNames(Arrays.copyOfRange(parts, 2,<br> parts.length));<br> }<br> return node;<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">package zhouls.bigdata.myMapReduce.shortestpath;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import org.apache.commons.io.*;<br> import org.apache.commons.lang.*;<br> import org.apache.hadoop.conf.Configuration;<br> import org.apache.hadoop.fs.FileSystem;<br> import org.apache.hadoop.fs.*;<br> import org.apache.hadoop.io.Text;<br> import org.apache.hadoop.mapreduce.*;<br> import org.apache.hadoop.mapreduce.lib.input.*;<br> import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">import java.io.*;<br> import java.util.Iterator;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public final class Main {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br> public static final String TARGET_NODE = "shortestpath.targetnode";</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public static void main(String... args) throws Exception {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">String startNode = "dee";<br> String targetNode = "joe";<br> // String inputFile = "hdfs://HadoopMaster:9000/shortestpath/shortestpath.txt";<br> // String outputDir = "hdfs://HadoopMaster:9000/out/shortestpath";<br><br> String inputFile = "./data/shortestpath/shortestpath.txt";<br> String outputDir = "./out/shortestpath";</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">iterate(startNode, targetNode, inputFile, outputDir);<br> }<br> public static Configuration conf = new Configuration();<br> static{<br><br> // conf.set("fs.defaultFS", "hdfs://HadoopMaster:9000");<br> // conf.set("yarn.resourcemanager.hostname", "HadoopMaster");<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public static void iterate(String startNode, String targetNode,<br> String input, String output)<br> throws Exception {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Path outputPath = new Path(output);<br> outputPath.getFileSystem(conf).delete(outputPath, true);<br> outputPath.getFileSystem(conf).mkdirs(outputPath);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Path inputPath = new Path(outputPath, "input.txt");</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">createInputFile(new Path(input), inputPath, startNode);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">int iter = 1;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">while (true) {</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Path jobOutputPath =<br> new Path(outputPath, String.valueOf(iter));</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">System.out.println("======================================");<br> System.out.println("= Iteration: " + iter);<br> System.out.println("= Input path: " + inputPath);<br> System.out.println("= Output path: " + jobOutputPath);<br> System.out.println("======================================");</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">if(findShortestPath(inputPath, jobOutputPath, startNode, targetNode)) {<br> break;<br> }<br> inputPath = jobOutputPath;<br> iter++;<br> }<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public static void createInputFile(Path file, Path targetFile,<br> String startNode)<br> throws IOException {<br> FileSystem fs = file.getFileSystem(conf);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">OutputStream os = fs.create(targetFile);<br> LineIterator iter = org.apache.commons.io.IOUtils<br> .lineIterator(fs.open(file), "UTF8");<br> while (iter.hasNext()) {<br> String line = iter.nextLine();</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">String[] parts = StringUtils.split(line);<br> int distance = Node.INFINITE;<br> if (startNode.equals(parts[0])) {<br> distance = 0;<br> }<br> IOUtils.write(parts[0] + '\t' + String.valueOf(distance) + "\t\t",<br> os);<br> IOUtils.write(StringUtils.join(parts, '\t', 1, parts.length), os);<br> IOUtils.write("\n", os);<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">os.close();<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">public static boolean findShortestPath(Path inputPath,<br> Path outputPath, String startNode,<br> String targetNode)<br> throws Exception {<br> conf.set(TARGET_NODE, targetNode);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Job job = new Job(conf);<br> job.setJarByClass(Main.class);<br> job.setMapperClass(Map.class);<br> job.setReducerClass(Reduce.class);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">job.setInputFormatClass(KeyValueTextInputFormat.class);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">job.setMapOutputKeyClass(Text.class);<br> job.setMapOutputValueClass(Text.class);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">FileInputFormat.setInputPaths(job, inputPath);<br> FileOutputFormat.setOutputPath(job, outputPath);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">if (!job.waitForCompletion(true)) {<br> throw new Exception("Job failed");<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">Counter counter = job.getCounters()<br> .findCounter(Reduce.PathCounter.TARGET_NODE_DISTANCE_COMPUTED);</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">if(counter != null &amp;&amp; counter.getValue() &gt; 0) {<br> CounterGroup group = job.getCounters().getGroup(Reduce.PathCounter.PATH.toString());<br> Iterator&lt;Counter&gt; iter = group.iterator();<br> iter.hasNext();<br> String path = iter.next().getName();<br> System.out.println("==========================================");<br> System.out.println("= Shortest path found, details as follows.");<br> System.out.println("= ");<br> System.out.println("= Start node: " + startNode);<br> System.out.println("= End node: " + targetNode);<br> System.out.println("= Hops: " + counter.getValue());<br> System.out.println("= Path: " + path);<br> System.out.println("==========================================");<br> return true;<br> }<br> return false;<br> }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br> // public static String getNeighbor(String str){<br> // return str.split(",")[0];<br> // }<br> // public static int getNeighborDis(String str){<br> // return Integer.parseInt(str.split(",")[1]);<br> // }</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">}</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;">&nbsp;</p> 
   <p style="font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;"><br></p> 
   <p><font><span style="font-size:14px;">本文转自大数据躺过的坑博客园博客，原文链接：http://www.cnblogs.com/zlslch/p/6165087.html，如需转载请自行联系原作者</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
