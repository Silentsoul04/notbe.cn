<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>红帽集群套件RHCS四部曲（测试篇） « NotBeCN</title>
  <meta name="description" content="             集群配置完成后，如何知道集群已经配置成功了呢，下面我们就分情况测试RHCS提供的高可用集群和存储集群功能。    一、 高可用集群测试 &nbsp;在前面的文章中，我们配置了四个节点的集群系统，每个节点的主机名分别是web1、web2、Mysql1、Mysql2，四个节点之间的关系是：w...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/08/1557728652563.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">红帽集群套件RHCS四部曲（测试篇）</h1>
    <p class="post-meta">Nov 8, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">集群配置完成后，如何知道集群已经配置成功了呢，下面我们就分情况测试RHCS提供的高可用集群和存储集群功能。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><strong>一、 高可用集群测试</strong><br> &nbsp;在前面的文章中，我们配置了四个节点的集群系统，每个节点的主机名分别是web1、web2、Mysql1、Mysql2，四个节点之间的关系是：web1和web2组成web集群，运行webserver服务，其中web1是主节点，正常状态下服务运行在此节点，web2是备用节点；Mysql1和Mysql2组成Mysql集群，运行mysqlserver服务，其中，Mysql1是主节点，正常状态下服务运行在此节点，Mysql2为备用节点。<br> 下面分四种情况介绍当节点发生宕机时，集群是如何进行切换和工作的。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">1&nbsp;节点web2宕机时<br> 宕机分为正常关机和异常宕机两种情况，下面分别说明。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">（1）&nbsp;节点web2正常关机<br> 在节点web2上执行正常关机命令：<br> [root@web2 ~]#init 0<br> 然后在web1节点查看/var/log/messages日志，输出信息如下：<br> Aug 24 00:57:09 web1 clurgmgrd[3321]: &lt;notice&gt; Member 1 shutting down&nbsp;<br><strong><em>Aug 24 00:57:17 web1 qdiskd[2778]: &lt;info&gt; Node 1 shutdown&nbsp;</em><br></strong>Aug 24 00:57:29 web1 openais[2755]: [TOTEM] The token was lost in the OPERATIONAL state.&nbsp;<br> Aug 24 00:57:29 web1 openais[2755]: [TOTEM] Receive multicast socket recv buffer size (320000 bytes).&nbsp;<br> Aug 24 00:57:29 web1 openais[2755]: [TOTEM] Transmit multicast socket send buffer size (219136 bytes).&nbsp;<br> Aug 24 00:57:29 web1 openais[2755]: [TOTEM] entering GATHER state from 2.&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] entering GATHER state from 0.&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] Creating commit token because I am the rep.&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] Saving state aru 73 high seq received 73&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] Storing new sequence id for ring bc8&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] entering COMMIT state.&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] entering RECOVERY state.&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] position [0] member 192.168.12.230:&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] previous ring seq 3012 rep 192.168.12.230&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] aru 73 high delivered 73 received flag 1&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] position [1] member 192.168.12.231:&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] previous ring seq 3012 rep 192.168.12.230&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] aru 73 high delivered 73 received flag 1&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] position [2] member 192.168.12.232:&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] previous ring seq 3012 rep 192.168.12.230&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] aru 73 high delivered 73 received flag 1&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] Did not need to originate any messages in recovery.&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] Sending initial ORF token&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br><em><strong>Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] Members Left:&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br> Aug 24 00:57:49 web1 kernel: dlm: closing connection to node 1</strong></em><br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] Members Left:&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [SYNC ] This node is within the primary component and will provide service.&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [TOTEM] entering OPERATIONAL state.&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] got nodejoin message 192.168.12.230&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] got nodejoin message 192.168.12.231&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CLM&nbsp; ] got nodejoin message 192.168.12.232&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CPG&nbsp; ] got joinlist message from node 3&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CPG&nbsp; ] got joinlist message from node 4&nbsp;<br> Aug 24 00:57:49 web1 openais[2755]: [CPG&nbsp; ] got joinlist message from node 2&nbsp;<br> 从输出日志可以看出，当web2节点正常关机后，qdiskd进程立刻检测到web2节点已经关闭，然后dlm锁进程正常关闭了从web2的连接，由于是正常关闭节点web2，所以RHCS认为整个集群系统没有发生异常，仅仅把节点web2从集群中隔离而已。请重点查看日志中斜体部分。<br> 重新启动web2节点，然后在web1上继续观察日志信息：<br> Aug 24 01:10:50 web1 openais[2755]: [TOTEM] entering GATHER state from 11.&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] Creating commit token because I am the rep.&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] Saving state aru 2b high seq received 2b&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] Storing new sequence id for ring bcc&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] entering COMMIT state.&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] entering RECOVERY state.&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] position [0] member 192.168.12.230:&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] previous ring seq 3016 rep 192.168.12.230&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] aru 2b high delivered 2b received flag 1&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] position [1] member 192.168.12.231:&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] previous ring seq 3016 rep 192.168.12.230&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] aru 2b high delivered 2b received flag 1&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] position [2] member 192.168.12.232:&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] previous ring seq 3016 rep 192.168.12.230&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] aru 2b high delivered 2b received flag 1&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] position [3] member 192.168.12.240:&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] previous ring seq 3016 rep 192.168.12.240&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] aru c high delivered c received flag 1&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] Did not need to originate any messages in recovery.&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] Sending initial ORF token&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] Members Left:&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] Members Left:&nbsp;<br><em><strong>Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br></strong></em>Aug 24 01:10:51 web1 openais[2755]: [SYNC ] This node is within the primary component and will provide service.&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [TOTEM] entering OPERATIONAL state.&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] got nodejoin message 192.168.12.230&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] got nodejoin message 192.168.12.231&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] got nodejoin message 192.168.12.232&nbsp;<br><em><strong>Aug 24 01:10:51 web1 openais[2755]: [CLM&nbsp; ] got nodejoin message 192.168.12.240&nbsp;<br></strong></em>Aug 24 01:10:51 web1 openais[2755]: [CPG&nbsp; ] got joinlist message from node 3&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CPG&nbsp; ] got joinlist message from node 4&nbsp;<br> Aug 24 01:10:51 web1 openais[2755]: [CPG&nbsp; ] got joinlist message from node 2&nbsp;<br><em><strong>Aug 24 01:10:55 web1 kernel: dlm: connecting to 1<br></strong></em>从输出可知，重新启动节点web2后，openais底层通信进程检测到web2节点已经激活，并且将web2重新加入集群中，请重点查看日志中斜体部分。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">（2）&nbsp;节点web2异常宕机<br> 在节点web2上执行如下命令，让内核崩溃：<br> [root@web2 ~]#echo c&gt;/proc/sysrq-trigger<br> 然后在节点Mysql1上查看/var/log/messages日志，信息如下：<br> Aug 24 02:26:16 Mysql1 openais[2649]: [TOTEM] entering GATHER state from 12.&nbsp;<br><em><strong>Aug 24 02:26:28 Mysql1 qdiskd[2672]: &lt;notice&gt; Node 1 evicted&nbsp;<br></strong></em>Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] entering GATHER state from 11.&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] Saving state aru 78 high seq received 78&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] Storing new sequence id for ring bd0&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] entering COMMIT state.&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] entering RECOVERY state.&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] position [0] member 192.168.12.230:&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] previous ring seq 3020 rep 192.168.12.230&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] aru 78 high delivered 78 received flag 1&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] position [1] member 192.168.12.231:&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] previous ring seq 3020 rep 192.168.12.230&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] aru 78 high delivered 78 received flag 1&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] position [2] member 192.168.12.232:&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] previous ring seq 3020 rep 192.168.12.230&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] aru 78 high delivered 78 received flag 1&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] Did not need to originate any messages in recovery.&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] New Configuration:&nbsp;<br><em><strong>Aug 24 02:26:36 Mysql1 kernel: dlm: closing connection to node 1</strong></em><br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ]&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ]&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ]&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br><em><strong>Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] Members Left:&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ]&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br></strong></em>Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ]&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ]&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ]&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] Members Left:&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [SYNC ] This node is within the primary component and will provide service.&nbsp;<br> Aug 24 02:26:36 Mysql1 fenced[2688]: web2 not a cluster member after 0 sec post_fail_delay<br> Aug 24 02:26:36 Mysql1 openais[2649]: [TOTEM] entering OPERATIONAL state.&nbsp;<br><em><strong>Aug 24 02:26:36 Mysql1 fenced[2688]: fencing node "web2"</strong></em><br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] got nodejoin message 192.168.12.230&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] got nodejoin message 192.168.12.231&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CLM&nbsp; ] got nodejoin message 192.168.12.232&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CPG&nbsp; ] got joinlist message from node 3&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CPG&nbsp; ] got joinlist message from node 4&nbsp;<br> Aug 24 02:26:36 Mysql1 openais[2649]: [CPG&nbsp; ] got joinlist message from node 2<br><em><strong>Aug 24 02:26:45 Mysql1 fenced[2688]: fence "web2" success<br> Aug 24 02:26:45 Mysql1 kernel: GFS2: fsid=mycluster:my-gfs2.2: jid=3: Trying to acquire journal lock...<br> Aug 24 02:26:45 Mysql1 kernel: GFS2: fsid=mycluster:my-gfs2.2: jid=3: Looking at journal...<br> Aug 24 02:26:45 Mysql1 kernel: GFS2: fsid=mycluster:my-gfs2.2: jid=3: Done</strong></em><br> &nbsp;从输出信息可知，qdiskd首先检测到web2出现异常，然后将它从集群中隔离，由于是异常宕机，所以RHCS为了保证集群资源的唯一性，必须重置web2节点，于是fenced进程启动， 在fenced进程没有返回成功信息之前，所有节点挂载的GFS2共享分区将无法使用，处于hung住的状态。直到fence成功。<br> 此时，在节点web1上查看web2的集群状态：<br> [root@web1 ~]#clustat&nbsp; -m web2<br> &nbsp;Member Name&nbsp;ID&nbsp;Status<br> &nbsp;------ ----&nbsp;&nbsp;&nbsp;----&nbsp;------<br> &nbsp;web2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;Offline<br> &nbsp;由输出可知，web2已经处于offline状态了。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">2&nbsp;节点Mysql2宕机时<br> 节点Mysql2在正常关机和异常宕机时，RHCS的切换状态与上面讲述的web2节点情况一模一样，这么不在重复讲述。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">3&nbsp;节点web1宕机时<br> （1）&nbsp;节点web1正常关机<br> [root@web1 ~]# init 0<br> 然后在节点web2上查看/var/log/messages日志，信息如下：<br><em><strong>Aug 24 02:06:13 web2 last message repeated 3 times<br> Aug 24 02:14:58 web2 clurgmgrd[3239]: &lt;notice&gt; Member 4 shutting down&nbsp;<br> Aug 24 02:15:03 web2 clurgmgrd[3239]: &lt;notice&gt; Starting stopped service service:webserver&nbsp;<br> Aug 24 02:15:05 web2 avahi-daemon[3110]: Registering new address record for 192.168.12.233 on eth0.<br> Aug 24 02:15:06 web2 in.rdiscd[4451]: setsockopt (IP_ADD_MEMBERSHIP): Address already in use<br> Aug 24 02:15:06 web2 in.rdiscd[4451]: Failed joining addresses&nbsp;<br> Aug 24 02:15:07 web2 clurgmgrd[3239]: &lt;notice&gt; Service service:webserver started&nbsp;<br> Aug 24 02:15:08 web2 qdiskd[2712]: &lt;info&gt; Node 4 shutdown&nbsp;</strong></em><br> Aug 24 02:15:21 web2 openais[2689]: [TOTEM] entering GATHER state from 12.&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] entering GATHER state from 11.&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] Saving state aru b7 high seq received b7&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] Storing new sequence id for ring bd8&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] entering COMMIT state.&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] entering RECOVERY state.&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] position [0] member 192.168.12.231:&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] previous ring seq 3028 rep 192.168.12.230&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] aru b7 high delivered b7 received flag 1&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] position [1] member 192.168.12.232:&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] previous ring seq 3028 rep 192.168.12.230&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] aru b7 high delivered b7 received flag 1&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] position [2] member 192.168.12.240:&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] previous ring seq 3028 rep 192.168.12.230&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] aru b7 high delivered b7 received flag 1&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] Did not need to originate any messages in recovery.&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] Members Left:&nbsp;<br><em><strong>Aug 24 02:15:41 web2 kernel: dlm: closing connection to node 4<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;</strong></em><br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] Members Left:&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [SYNC ] This node is within the primary component and will provide service.&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [TOTEM] entering OPERATIONAL state.&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] got nodejoin message 192.168.12.231&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] got nodejoin message 192.168.12.232&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CLM&nbsp; ] got nodejoin message 192.168.12.240&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CPG&nbsp; ] got joinlist message from node 2&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CPG&nbsp; ] got joinlist message from node 3&nbsp;<br> Aug 24 02:15:41 web2 openais[2689]: [CPG&nbsp; ] got joinlist message from node 1&nbsp;<br> 从输出日志可知，节点web1正常关机后，节点web1的服务和IP资源自动切换到了节点web2上，然后由qdiskd进程将节点web1从集群系统中隔离。由于web1节点是正常关闭，所以集群中GFS2共享文件系统可以正常读写，不受web1关闭的影响。<br> &nbsp;此时，在web2查看节点web1的状态：<br> [root@web2 ~]# clustat&nbsp; -m web1<br> &nbsp;Member Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ID&nbsp;&nbsp; &nbsp;Status<br> &nbsp;------ ----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ---- &nbsp;------<br> &nbsp;web1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4 &nbsp;&nbsp;Offline<br> &nbsp;从输出可知，web1节点已经处于offline状态了。<br> &nbsp;接着，登录到节点web2，查看集群服务和IP资源是否正常切换，操作如下：<br> &nbsp;[root@web2 ~]# clustat&nbsp; -s webserver<br> &nbsp;Service Name&nbsp;&nbsp;&nbsp;&nbsp; Owner (Last)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; State&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> ------- ----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ----- ------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> service:webserver&nbsp;&nbsp;&nbsp; web2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; started&nbsp;<br> [root@web2 ~]# ip addr show|grep eth0<br> 2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000<br> &nbsp;&nbsp;&nbsp; inet 192.168.12.240/24 brd 192.168.12.255 scope global eth0<br> &nbsp;&nbsp;&nbsp; inet 192.168.12.233/24 scope global secondary eth0<br> 从输出可知，集群服务和IP地址已经成功切换到web2节点。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">最后，重新启动节点web1，然后在节点web2查看/var/log/messages日志，信息如下：<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] entering GATHER state from 11.&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] Saving state aru 2b high seq received 2b&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] Storing new sequence id for ring bdc&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] entering COMMIT state.&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] entering RECOVERY state.&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] position [0] member 192.168.12.230:&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] previous ring seq 3028 rep 192.168.12.230&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] aru 0 high delivered 0 received flag 1&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] position [1] member 192.168.12.231:&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] previous ring seq 3032 rep 192.168.12.231&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] aru 2b high delivered 2b received flag 1&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] position [2] member 192.168.12.232:&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] previous ring seq 3032 rep 192.168.12.231&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] aru 2b high delivered 2b received flag 1&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] position [3] member 192.168.12.240:&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] previous ring seq 3032 rep 192.168.12.231&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] aru 2b high delivered 2b received flag 1&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] Did not need to originate any messages in recovery.&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] Members Left:&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] Members Left:&nbsp;<br><em><strong>Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;<br></strong></em>Aug 24 02:42:36 web2 openais[2689]: [SYNC ] This node is within the primary component and will provide service.&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [TOTEM] entering OPERATIONAL state.&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] got nodejoin message 192.168.12.230&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] got nodejoin message 192.168.12.231&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] got nodejoin message 192.168.12.232&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CLM&nbsp; ] got nodejoin message 192.168.12.240&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CPG&nbsp; ] got joinlist message from node 3&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CPG&nbsp; ] got joinlist message from node 1&nbsp;<br> Aug 24 02:42:36 web2 openais[2689]: [CPG&nbsp; ] got joinlist message from node 2&nbsp;<br><strong><em>Aug 24 02:42:40 web2 kernel: dlm: got connection from 4<br> Aug 24 02:43:06 web2 clurgmgrd[3239]: &lt;notice&gt; Relocating service:webserver to better node web1&nbsp;<br> Aug 24 02:43:06 web2 clurgmgrd[3239]: &lt;notice&gt; Stopping service service:webserver&nbsp;<br> Aug 24 02:43:07 web2 avahi-daemon[3110]: Withdrawing address record for 192.168.12.233 on eth0.<br> Aug 24 02:43:17 web2 clurgmgrd[3239]: &lt;notice&gt; Service service:webserver is stopped&nbsp;<br></em></strong>从输出可知，节点web1在重新启动后，再次被加入到集群系统中，同时停止自身的服务以及释放IP资源。这个切换方式跟集群设置的Failover Domain策略有关，在创建的的失败转移域webserver-Failover中，没有加入“Do not fail back services in this domain”一项功能，也就是主节点在重新启动后，自动将服务切换回来。<br> 此时在节点web1查看/var/log/messages日志，信息如下：<br> Aug 24 02:43:19 web1 clurgmgrd[3252]: &lt;notice&gt; stop on script "mysqlscript" returned 5 (program not installed)&nbsp;<br><em><strong>Aug 24 02:43:35 web1 clurgmgrd[3252]: &lt;notice&gt; Starting stopped service service:webserver&nbsp;<br> Aug 24 02:43:37 web1 avahi-daemon[3126]: Registering new address record for 192.168.12.233 on eth0.<br> Aug 24 02:43:38 web1 in.rdiscd[4075]: setsockopt (IP_ADD_MEMBERSHIP): Address already in use<br> Aug 24 02:43:38 web1 in.rdiscd[4075]: Failed joining addresses&nbsp;<br> Aug 24 02:43:39 web1 clurgmgrd[3252]: &lt;notice&gt; Service service:webserver started&nbsp;<br></strong></em>这个输出表明，web1在重启后，自动将集群服务和IP资源切换回来。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">（2）&nbsp;节点web1异常宕机<br> 在节点web1上执行如下命令，让系统内核崩溃：<br> [root@web2 ~]#echo c&gt;/proc/sysrq-trigger<br> 然后在节点web2上查看/var/log/messages日志，信息如下：<br> Aug 24 02:59:57 web2 openais[2689]: [TOTEM] entering GATHER state from 12.&nbsp;<br><em><strong>Aug 24 03:00:10 web2 qdiskd[2712]: &lt;notice&gt; Node 4 evicted&nbsp;</strong></em><br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] entering GATHER state from 11.&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] Saving state aru 92 high seq received 92&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] Storing new sequence id for ring be0&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] entering COMMIT state.&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] entering RECOVERY state.&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] position [0] member 192.168.12.231:&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] previous ring seq 3036 rep 192.168.12.230&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] aru 92 high delivered 92 received flag 1&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] position [1] member 192.168.12.232:&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] previous ring seq 3036 rep 192.168.12.230&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] aru 92 high delivered 92 received flag 1&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] position [2] member 192.168.12.240:&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] previous ring seq 3036 rep 192.168.12.230&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] aru 92 high delivered 92 received flag 1&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] Did not need to originate any messages in recovery.&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br><strong><em>Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] Members Left:&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;<br> Aug 24 03:00:17 web2 kernel: dlm: closing connection to node 4</em></strong><br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] Members Left:&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [SYNC ] This node is within the primary component and will provide service.&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [TOTEM] entering OPERATIONAL state.&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] got nodejoin message 192.168.12.231&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] got nodejoin message 192.168.12.232&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CLM&nbsp; ] got nodejoin message 192.168.12.240&nbsp;<br> Aug 24 03:00:17 web2 openais[2689]: [CPG&nbsp; ] got joinlist message from node 2&nbsp;<br><em><strong>Aug 24 03:00:17 web2 fenced[2728]: web1 not a cluster member after 0 sec post_fail_delay</strong></em><br> Aug 24 03:00:17 web2 openais[2689]: [CPG&nbsp; ] got joinlist message from node 3&nbsp;<br><em><strong>Aug 24 03:00:17 web2 fenced[2728]: fencing node "web1"</strong></em><br> Aug 24 03:00:17 web2 openais[2689]: [CPG&nbsp; ] got joinlist message from node 1<br><strong><em>Aug 24 03:00:55 web2 fenced[2728]: fence "web1" success<br> Aug 24 03:00:55 web2 kernel: GFS2: fsid=mycluster:my-gfs2.3: jid=0: Trying to acquire journal lock...<br> Aug 24 03:00:55 web2 kernel: GFS2: fsid=mycluster:my-gfs2.3: jid=0: Looking at journal...<br> Aug 24 03:00:55 web2 kernel: GFS2: fsid=mycluster:my-gfs2.3: jid=0: Done<br></em></strong><em><strong>Aug 24 03:00:55 web2 clurgmgrd[3239]: &lt;notice&gt; Taking over service service:webserver from down member web1&nbsp;<br> Aug 24 03:00:55 web2 avahi-daemon[3110]: Registering new address record for 192.168.12.233 on eth0.<br> Aug 24 03:00:55 web2 clurgmgrd[3239]: &lt;notice&gt; Service service:webserver started<br></strong></em>从输出日志可以看出，web1在异常宕机后，首先由qdiskd进程将失败节点从集群中隔离，然后qdiskd进程将结果返回给cman进程，cman进程接着去调用Fence进程，最后Fence进程根据事先设置好的Fence agent调用Fence设备将web1成功Fence掉，clurgmgrd进程在接到成功Fence的信息后，web2开始接管web1的服务和IP资源，同时释放dlm锁，GFS2文件系统可以正常读写。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">4&nbsp;节点Mysql1宕机时<br> 节点Mysql1在正常关机和异常宕机时，RHCS的切换状态与上面讲述的web1节点宕机情况一模一样，这么不在重复演示。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">5&nbsp;四个节点任意三个宕机<br> &nbsp;这里将web1、Mysql2、Mysql1依次异常宕机，然后在web2节点查看RHCS是如何进行切换动作的。<br> 首先停止web1节点，查看/var/log/messages日志，信息如下：<br> Aug 24 18:57:55 web2 openais[2691]: [TOTEM] entering GATHER state from 12.&nbsp;<br> Aug 24 18:58:14 web2 qdiskd[2714]: &lt;notice&gt; Writing eviction notice for node 4&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] entering GATHER state from 0.&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] Saving state aru 8e high seq received 8e&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] Storing new sequence id for ring c14&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] entering COMMIT state.&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] entering RECOVERY state.&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] position [0] member 192.168.12.231:&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] previous ring seq 3088 rep 192.168.12.230&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] aru 8e high delivered 8e received flag 1&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] position [1] member 192.168.12.232:&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] previous ring seq 3088 rep 192.168.12.230&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] aru 8e high delivered 8e received flag 1&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] position [2] member 192.168.12.240:&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] previous ring seq 3088 rep 192.168.12.230&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] aru 8e high delivered 8e received flag 1&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] Did not need to originate any messages in recovery.&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br> Aug 24 18:58:15 web2 kernel: dlm: closing connection to node 4<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] Members Left:&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.230)&nbsp;&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] CLM CONFIGURATION CHANGE&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] New Configuration:&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.231)&nbsp;&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.232)&nbsp;&nbsp;<br><em><strong>Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ]&nbsp;&nbsp;&nbsp;&nbsp; r(0) ip(192.168.12.240)&nbsp;&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] Members Left:&nbsp;</strong></em><br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] Members Joined:&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [SYNC ] This node is within the primary component and will provide service.&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [TOTEM] entering OPERATIONAL state.&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] got nodejoin message 192.168.12.231&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] got nodejoin message 192.168.12.232&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CLM&nbsp; ] got nodejoin message 192.168.12.240&nbsp;<br><em><strong>Aug 24 18:58:15 web2 fenced[2730]: web1 not a cluster member after 0 sec post_fail_delay</strong></em><br><em><strong>Aug 24 18:58:15 web2 openais[2691]: [CPG&nbsp; ] got joinlist message from node 3&nbsp;<br> Aug 24 18:58:15 web2 fenced[2730]: fencing node "web1"<br> Aug 24 18:58:15 web2 openais[2691]: [CPG&nbsp; ] got joinlist message from node 1&nbsp;<br> Aug 24 18:58:15 web2 openais[2691]: [CPG&nbsp; ] got joinlist message from node 2&nbsp;<br> Aug 24 18:58:17 web2 qdiskd[2714]: &lt;notice&gt; Node 4 evicted&nbsp;</strong></em><br> Aug 24 18:58:29 web2 fenced[2730]: fence "web1" success<br> Aug 24 18:58:29 web2 kernel: GFS2: fsid=mycluster:my-gfs2.1: jid=3: Trying to acquire journal lock...<br><em><strong>Aug 24 18:58:29 web2 kernel: GFS2: fsid=mycluster:my-gfs2.1: jid=3: Looking at journal...<br> Aug 24 18:58:29 web2 kernel: GFS2: fsid=mycluster:my-gfs2.1: jid=3: Done<br> Aug 24 18:58:30 web2 clurgmgrd[3300]: &lt;notice&gt; Taking over service service:webserver from down member web1&nbsp;<br> Aug 24 18:58:32 web2 avahi-daemon[3174]: Registering new address record for 192.168.12.233 on eth0.<br> Aug 24 18:58:33 web2 clurgmgrd[3300]: &lt;notice&gt; Service service:webserver started&nbsp;</strong></em><br> &nbsp;通过观察日志可以发现，qdiskd进程会首先将节点web1从集群隔离，然后由fenced进程将web1成功fence掉，最后，web2才接管了web1的服务和IP资源。这里有个先后问题，也就是说，只有Fence成功，集群资源切换才会进行。<br> 如果fenced进程没有成功将web1节点fence掉，那么RHCS会进入等待状态，此时集群系统GFS2共享存储也将变得不可读写，直到Fence进程返回成功信息，集群才开始进行资源切换，同时GFS2文件系统也将恢复读写。<br> 此时，在web2节点通过cman_tool查看集群状态，信息如下：<br> [root@web2 ~]# cman_tool&nbsp; status<br> Version: 6.2.0<br> Config Version: 40<br> Cluster Name: mycluster<br> Cluster Id: 56756<br> Cluster Member: Yes<br> Cluster Generation: 3092<br> Membership state: Cluster-Member<br><em><strong>Nodes: 3<br> Expected votes: 6<br> Quorum device votes: 2<br> Total votes: 5<br> Quorum: 3&nbsp;&nbsp;</strong></em><br> Active subsystems: 9<br> Flags: Dirty&nbsp;<br> Ports Bound: 0 177&nbsp;&nbsp;<br> Node name: web2<br> Node ID: 1<br> Multicast addresses: 239.192.221.146&nbsp;<br> Node addresses: 192.168.12.240&nbsp;<br> &nbsp;从输出可知，集群节点数变为3，同时Quorum值也有原来的4变为3，Quorum值是通过N/2整除加一得到的，其中N为所有集群节点的投票数加上表决磁盘投票值。其实也就在这里的“Total votes”值。<br> 接着陆续将Mysql2、Mysql1异常宕机，宕机完成，在web2节点通过cman_tool查看集群状态，信息如下：</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">[root@web2 ~]# cman_tool&nbsp; status<br> Version: 6.2.0<br> Config Version: 40<br> Cluster Name: mycluster<br> Cluster Id: 56756<br> Cluster Member: Yes<br> Cluster Generation: 3100<br> Membership state: Cluster-Member<br><em><strong>Nodes: 1<br> Expected votes: 6<br> Quorum device votes: 2<br> Total votes: 3<br> Quorum: 2&nbsp;&nbsp;<br> Active subsystems: 9</strong></em><br> Flags: Dirty&nbsp;<br> Ports Bound: 0 177&nbsp;&nbsp;<br> Node name: web2<br> Node ID: 1<br> Multicast addresses: 239.192.221.146&nbsp;<br> Node addresses: 192.168.12.240&nbsp;<br> 从输出可知，整个集群系统节点数已经变为一个，但是集群系统仍然可用，GFS2仍然可以正常读写，这些都是Qdisk的功能，一个RHCS集群中，如果没有表决磁盘的话，<br> 仅剩一个节点的集群是不能工作的。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><strong>二、存储集群测试<br></strong>&nbsp;GFS2文件系统是RHCS集群中的共享存储，在集群各个节点挂载GFS2共享文件系统，然后在任意节点对共享分区进行数据的读写操作，例如：<br> 在节点web2上创建一个文件ixdba：<br> [root@web2 gfs2]# echo "This is GFS2 Files test" &gt;/gfs2/ixdba<br> 然后在节点web1查看此文件<br> [root@web1 gfs2]# more /gfs2/ixdba<br> This is GFS2 Files test<br> 可以看到，写操作正常。<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 接着测试同时读写文件，首先在节点web1上编辑文件ixdba，然后同时在节点web2也编辑ixdba，此时会提示该文件locked。<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 到这里为止，RHCS所有功能点都已经测试完成了，在测试集群功能时，观察日志信息是很有必要的，通过观察日志输出，可以知道RHCS更加详细的切换过程，如果切换失败，也会在日志中输出，然后根据错误信息，就可以很容易的定位问题。<br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 目前，RHCS已经广泛应用在企业的各个领域，与其它HA软件相比，RHCS可能显得比较复杂，管理和维护会比较困难，但是RHCS的可靠性和稳定性是毋庸置疑的，随着人们对业务实时性和稳定性需求的不断提升，RHCS的应用毕将越来越广泛。</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);">（待续）</p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p><font color="#333333"><br></font></p> 
   <p><font color="#333333">本文转自南非蚂蚁51CTO博客，原文链接：http://blog.51cto.com/ixdba/599020，如需转载请自行联系原作者</font></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
   <p style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;font-size:16px;color:rgb(51,51,51);"><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
