<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>【转】从viewController讲到强制横屏，附IOS5强制横屏的有效办法 « NotBeCN</title>
  <meta name="description" content="                  文字罗嗦，篇幅较长，只需营养可直接看红字部分。     一个viewController的初始化大概涉及到如下几个方法的调用：&nbsp;           initWithNibName:bundle:               viewDidLoad          ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/08/weixin_34038293_90128847.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">【转】从viewController讲到强制横屏，附IOS5强制横屏的有效办法</h1>
    <p class="post-meta">Nov 8, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <p style="line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">文字罗嗦，篇幅较长，只需营养可直接看红字部分。</span></p> 
    <p style="line-height:1.5;"><span>一个</span>viewController<span>的初始化大概</span><span>涉及到如下几个方法的调用：</span>&nbsp;</p> 
    <div style="line-height:1.5;"> 
     <span>initWithNibName:bundle:</span>
     <br>
     <br>
     <span>viewDidLoad</span>
     <br>
     <br>
     <span>viewWillAppear:animated:</span>
     <br>
     <br>
     <span>viewDidAppear:animated:</span>
     <br>
     <br>
     <span>viewWillLayoutSubviews</span>
     <br>
     <br>
     <span>viewDidLayoutSubviews</span> 
    </div> 
    <p style="line-height:1.5;"><span>通常情况</span><span>这</span><span>几个方法是依次</span><span>被调用的，我们会在</span><span>init<span>方法中初始化一些成员变量，做一些与</span>view<span>无关的事情。而后在</span>viewDidLoad<span>中进行</span>view<span>布局相关的属性调整，比如改变一下背景颜色，增加一些</span>subview<span>之类的。不知道大家有没有想过，这样不在</span>init<span>中写</span>view<span>相关代码是为了什么？难道仅仅是为了代码结构清晰？如果我非要在</span>init<span>做一些与</span>view<span>相关的初始化工作，能不能实现？有什么问题？</span></span></p> 
   </div> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>@implementation</span>&nbsp;
    <span>testViewController</span>
    <br>
    <br>
    <span>-</span>&nbsp;(
    <span>void</span>)
    <span>printFrame:</span>(
    <span>CGRect</span>)
    <span>frame</span>&nbsp;
    <span>name:</span>(
    <span>NSString</span>&nbsp;
    <span>*</span>)
    <span>name</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>NSLog</span>(
    <span>@"%@ :(%f, %f, %f, %f)"</span>
    <span>,</span>&nbsp;
    <span>name</span>
    <span>,</span>&nbsp;
    <span>frame</span>
    <span>.</span>
    <span>origin</span>
    <span>.</span>
    <span>x</span>
    <span>,</span>&nbsp;
    <span>frame</span>
    <span>.</span>
    <span>origin</span>
    <span>.</span>
    <span>y</span>
    <span>,</span>
    <span>frame</span>
    <span>.</span>
    <span>size</span>
    <span>.</span>
    <span>width</span>
    <span>,</span>&nbsp;
    <span>frame</span>
    <span>.</span>
    <span>size</span>
    <span>.</span>
    <span>height</span>);
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>&nbsp;(
    <span>id</span>)
    <span>initWithNibName:</span>(
    <span>NSString</span>&nbsp;
    <span>*</span>)
    <span>nibNameOrNil</span>&nbsp;
    <span>bundle:</span>(
    <span>NSBundle</span>&nbsp;
    <span>*</span>)
    <span>nibBundleOrNil</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>self</span>&nbsp;
    <span>=</span>&nbsp;
    <span>[</span>
    <span>super</span>&nbsp;
    <span>initWithNibName:</span>
    <span>nibNameOrNil</span>&nbsp;
    <span>bundle:</span>
    <span>nibBundleOrNil</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>if</span>&nbsp;(
    <span>self</span>)&nbsp;
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>// Custom initialization</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>backgroundColor</span>&nbsp;
    <span>=</span>&nbsp;
    <span>[</span>
    <span>UIColor</span>&nbsp;
    <span>yellowColor</span>
    <span>];</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>self</span>&nbsp;
    <span>printFrame:</span>
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>frame</span>&nbsp;
    <span>name:</span>
    <span>@"initFrame"</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>}</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>self</span>;
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>&nbsp;(
    <span>void</span>)
    <span>viewDidLoad</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>super</span>&nbsp;
    <span>viewDidLoad</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>// Do any additional setup after loading the view.</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>self</span>&nbsp;
    <span>printFrame:</span>
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>frame</span>&nbsp;
    <span>name:</span>
    <span>@"didloadFrame"</span>
    <span>];</span>
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>&nbsp;(
    <span>void</span>)
    <span>viewWillLayoutSubviews</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>super</span>&nbsp;
    <span>viewWillLayoutSubviews</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>self</span>&nbsp;
    <span>printFrame:</span>
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>frame</span>&nbsp;
    <span>name:</span>
    <span>@"willLayoutFrame"</span>
    <span>];</span>&nbsp;&nbsp;&nbsp;
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>(
    <span>void</span>)
    <span>viewDidLayoutSubviews</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>super</span>&nbsp;
    <span>viewDidLayoutSubviews</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>self</span>&nbsp;
    <span>printFrame:</span>
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>frame</span>&nbsp;
    <span>name:</span>
    <span>@"didLayoutFrame"</span>
    <span>];</span>&nbsp;
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>&nbsp;(
    <span>void</span>)
    <span>viewWillAppear:</span>(
    <span>BOOL</span>)
    <span>animated</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>super</span>&nbsp;
    <span>viewWillAppear:</span>
    <span>animated</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>self</span>&nbsp;
    <span>printFrame:</span>
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>frame</span>&nbsp;
    <span>name:</span>
    <span>@"willAppearFrame"</span>
    <span>];</span>
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>(
    <span>void</span>)
    <span>viewDidAppear:</span>(
    <span>BOOL</span>)
    <span>animated</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>super</span>&nbsp;
    <span>viewDidAppear:</span>
    <span>animated</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>self</span>&nbsp;
    <span>printFrame:</span>
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>frame</span>&nbsp;
    <span>name:</span>
    <span>@"didappearFrame"</span>
    <span>];</span>
    <br>
    <span>}</span> 
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="color:rgb(255,0,0);font-family:'ＭＳ 明朝';">这段代码在init方法中设置了一下view的backgroundColor。运行结果很正常，view的背景色被成功地设定为黄色，但是看控制台的log输出，出现了一个不符合预期的现象：</span></p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>didloadFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>20.000000</span>
    <span>,</span>&nbsp;
    <span>768.000000</span>
    <span>,</span>&nbsp;
    <span>1004.000000</span>)
    <br>
    <span>initFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>20.000000</span>
    <span>,</span>&nbsp;
    <span>768.000000</span>
    <span>,</span>&nbsp;
    <span>1004.000000</span>)
    <br>
    <span>willAppearFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>768.000000</span>
    <span>,</span>&nbsp;
    <span>960.000000</span>)
    <br>
    <span>didappearFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>768.000000</span>
    <span>,</span>&nbsp;
    <span>960.000000</span>)
    <br>
    <span>willLayoutFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>768.000000</span>
    <span>,</span>&nbsp;
    <span>960.000000</span>)
    <br>
    <span>didLayoutFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>768.000000</span>
    <span>,</span>&nbsp;
    <span>960.000000</span>)
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="color:rgb(255,0,0);font-family:'ＭＳ 明朝';">viewDidLoad竟然先于init给出了输出，经过跟踪发现，原来当程序第一次调用self.view的时候，viewDidLoad方法就会被执行，而不一定非要等到init之后willAppear之前。这给我们敲响了警钟，这样的代码就隐藏了问题：</span></p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>-</span>&nbsp;(
    <span>id</span>)
    <span>initWithNibName:</span>(
    <span>NSString</span>&nbsp;
    <span>*</span>)
    <span>nibNameOrNil</span>&nbsp;
    <span>bundle:</span>(
    <span>NSBundle</span>&nbsp;
    <span>*</span>)
    <span>nibBundleOrNil</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>self</span>&nbsp;
    <span>=</span>&nbsp;
    <span>[</span>
    <span>super</span>&nbsp;
    <span>initWithNibName:</span>
    <span>nibNameOrNil</span>&nbsp;
    <span>bundle:</span>
    <span>nibBundleOrNil</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>if</span>&nbsp;(
    <span>self</span>)&nbsp;
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>// Custom initialization</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>backgroundColor</span>&nbsp;
    <span>=</span>&nbsp;
    <span>[</span>
    <span>UIColor</span>&nbsp;
    <span>yellowColor</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>aInstanceVariable_</span>
    <span>=</span>&nbsp;
    <span>0</span>;&nbsp;
    <span>// Custom initialization of an instance variable</span> 
   </div> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">
    &nbsp;&nbsp;&nbsp;
    <span>}</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>self</span>;
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>&nbsp;(
    <span>void</span>)
    <span>viewDidLoad</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>super</span>&nbsp;
    <span>viewDidLoad</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>// Do any additional setup after loading the view.</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>aInstanceVariable_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>10086</span>;
    <br>
    <span>}</span> 
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="color:rgb(255,0,0);">这段代码执行完后的aInstanceVariable_是0而不是10086，可能会为一些bug深深地埋下一颗种子。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">搞清楚了代码执行顺序，下面我们来关注一下frame和bounds的问题。frame和bounds的定义和区别在</span><a href="http://blog.sina.com.cn/s/blog_6729d8490100zfjj.html" rel="nofollow" style="color:rgb(68,68,68);">这篇blog</a><span style="font-family:'ＭＳ 明朝';">里讲的很清楚</span>，总结起来要点就是，<span style="color:rgb(255,0,0);">frame是相对于父view参照系(是父view而不是父viewController)的，bounds是本地参照系，改frame的时候center和bounds联动，但改bounds的时候center不动。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">把上面的程序稍微修改一下，来看一组值得研究一下的结果（此viewController由带导航条的navigationController推送），实际上不用navigationController而直接加载这个vc，结果又不一样，viewDidAppear会在最后viewDidLayoutSubviews之后才调用，其他顺序不变，乱吧……</span></p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">
    didLoadFrame&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>20.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>1004.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> didLoadBounds&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>0.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>1004.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> initFrame&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>20.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>1004.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> initBounds&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>0.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>1004.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> willAppearFrame&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>0.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>960.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> willAppearBounds&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>0.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>960.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> didAppearFrame&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>0.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>960.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> didAppearBounds&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>0.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>960.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> willLayoutFrame&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>0.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>960.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> willLayoutBounds&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>0.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>960.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> didLayoutFrame&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>0.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>960.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
    <br> didLayoutBounds&nbsp;:(
    <span>0.000000</span>,&nbsp;
    <span>0.000000</span>,&nbsp;
    <span>768.000000</span>,&nbsp;
    <span>960.000000</span>)&nbsp;direction:(
    <span>1</span>,&nbsp;
    <span>1</span>)
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">刚才这个是竖屏的，再来个横屏的：</span></p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>didLoadFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>748.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>didLoadBounds</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>748.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>initFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>748.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>initBounds</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>748.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>willAppearFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>
    <span>,</span>&nbsp;
    <span>704.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>willAppearBounds</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>
    <span>,</span>&nbsp;
    <span>704.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>didAppearFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>
    <span>,</span>&nbsp;
    <span>704.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>didAppearBounds</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>
    <span>,</span>&nbsp;
    <span>704.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>willLayoutFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>
    <span>,</span>&nbsp;
    <span>704.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>willLayoutBounds</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>
    <span>,</span>&nbsp;
    <span>704.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>didLayoutFrame</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>
    <span>,</span>&nbsp;
    <span>704.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
    <br>
    <span>didLayoutBounds</span>&nbsp;
    <span>:</span>(
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>0.000000</span>
    <span>,</span>&nbsp;
    <span>1024.000000</span>
    <span>,</span>&nbsp;
    <span>704.000000</span>)&nbsp;
    <span>direction:</span>(
    <span>3</span>
    <span>,</span>&nbsp;
    <span>3</span>)
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="color:rgb(255,0,0);font-family:'ＭＳ 明朝';">总结一下不难发现其特征：1. 在viewWillAppear之前，无论横屏还是竖屏，view的frame和bounds都是按竖屏方式计算的；2. 在viewWillAppear之前，navigationController（而非父view，实际上这个vc的superview是navigationController的view的一个subview）的导航条并没有计算在frame和bounds中，但电池条的宽度是一直计算了的；3. 在转屏时，触发的是viewWillLayoutSubview及viewDidLayoutSubview（data not shown）。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">由此结论，我们继续往下想，<span style="color:rgb(255,0,0);">如果我们要改变self.view的frame值，我们应当在哪个方法中修改呢？很容易想到的是，init和viewDidLoad中是不行的，实践证明，在viewWillAppear中也是不行的，要在viewDidAppear/viewWillLayoutSubviews/viewDidLayoutSubviews方法中修改才能产生效果。</span></span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">看起来越来越复杂了……对了，以上的结论对iOS5和6是通用的。下面开始研究转屏，转屏对iOS5和6来说，差别就大了。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">先看iOS5</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">iOS5的时候，转屏函数主要是这几个：(补：其实还有一个willAnimationRotationToInterfaceOrientation:duration:，调用时机在viewDidLayoutSubviews之后，didRotation之前)</span></p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>-</span>(
    <span>BOOL</span>)
    <span>shouldAutorotateToInterfaceOrientation:</span>(
    <span>UIInterfaceOrientation</span>)
    <span>toInterfaceOrientation</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>NSLog</span>(
    <span>@"shouldRotate"</span>);
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>YES</span>;
    <br>
    <span>} //以下简称shouldRotate</span>
    <br>
    <br>
    <span>-</span>(
    <span>void</span>)
    <span>willRotateToInterfaceOrientation:</span>(
    <span>UIInterfaceOrientation</span>)
    <span>toInterfaceOrientation</span>
    <span>duration:</span>(
    <span>NSTimeInterval</span>)
    <span>duration</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>NSLog</span>(
    <span>@"willRotate"</span>);
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>(
    <span>void</span>)
    <span>didRotateFromInterfaceOrientation:</span>(
    <span>UIInterfaceOrientation</span>)
    <span>fromInterfaceOrientation</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>NSLog</span>(
    <span>@"didRotate"</span>);
    <br>
    <span>}</span> 
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">初始化一个正常viewController时转屏函数的调用过程如下：</span></p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>18</span>&nbsp;
    <span>16</span>
    <span>:</span>
    <span>40</span>
    <span>:</span>
    <span>58.090</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>1874</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>init</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>18</span>&nbsp;
    <span>16</span>
    <span>:</span>
    <span>40</span>
    <span>:</span>
    <span>58.091</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>1874</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>shouldRotate</span> 
   </div> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>18</span>&nbsp;
    <span>16</span>
    <span>:</span>
    <span>40</span>
    <span>:</span>
    <span>58.092</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>1874</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>didLoad</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>18</span>&nbsp;
    <span>16</span>
    <span>:</span>
    <span>40</span>
    <span>:</span>
    <span>58.092</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>1874</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>shouldRotate</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>18</span>&nbsp;
    <span>16</span>
    <span>:</span>
    <span>40</span>
    <span>:</span>
    <span>58.093</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>1874</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>willappear</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>18</span>&nbsp;
    <span>16</span>
    <span>:</span>
    <span>40</span>
    <span>:</span>
    <span>58.093</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>1874</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>shouldRotate</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>18</span>&nbsp;
    <span>16</span>
    <span>:</span>
    <span>40</span>
    <span>:</span>
    <span>58.094</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>1874</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>willlayout</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>18</span>&nbsp;
    <span>16</span>
    <span>:</span>
    <span>40</span>
    <span>:</span>
    <span>58.095</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>1874</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>didlayout</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>18</span>&nbsp;
    <span>16</span>
    <span>:</span>
    <span>40</span>
    <span>:</span>
    <span>58.096</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>1874</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>didappear</span> 
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span>我的妈呀，初始化一个vc怎么调用了三次shouldRotate方法……（别着急，三次算什么，这种情况下调用几次都有可能……）</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">如果初始化vc是在一个navigationController下，看起来还比较正常：</span></p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>42</span>
    <span>:</span>
    <span>42.037</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>462</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>init</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>42</span>
    <span>:</span>
    <span>42.039</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>462</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>didload</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>42</span>
    <span>:</span>
    <span>42.040</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>462</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>willappear</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>42</span>
    <span>:</span>
    <span>42.041</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>462</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>shouldRotate</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>42</span>
    <span>:</span>
    <span>42.042</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>462</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>didappear</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>42</span>
    <span>:</span>
    <span>42.042</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>462</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>willlayout</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>42</span>
    <span>:</span>
    <span>42.043</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>462</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>didlayout</span> 
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">shouldRotate在willAppear之后调用一次。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">无论有navigationController与否，再转一下屏后，方法调用过程是一样的：</span></p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>51</span>
    <span>:</span>
    <span>00.729</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>527</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>shouldRotate</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>51</span>
    <span>:</span>
    <span>00.730</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>527</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>willRotate</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>51</span>
    <span>:</span>
    <span>00.731</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>527</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>willlayout</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>51</span>
    <span>:</span>
    <span>00.731</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>527</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>didlayout</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>51</span>
    <span>:</span>
    <span>00.732</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>527</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>shouldRotate</span>
    <br>
    <span>2012</span>
    <span>-</span>
    <span>11</span>
    <span>-</span>
    <span>19</span>&nbsp;
    <span>20</span>
    <span>:</span>
    <span>51</span>
    <span>:</span>
    <span>01.133</span>&nbsp;
    <span>testRotation</span>
    <span>[</span>
    <span>527</span>
    <span>:</span>
    <span>c07</span>
    <span>]</span>&nbsp;
    <span>didRotate</span> 
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">注意，shouldRotate方法依然被调用了两次。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="font-family:'ＭＳ 明朝';">为了把shouldRotate方法的调用次数以及这几次调用的返回值有什么用搞明白，我做了个实验，详细过程不赘述，只说结论。结论是一个坏消息和一个好消息：坏消息是，shouldRotate方法可能调用很多次（只出现在非navigationController方式直接将vc作为rootViewController的情况），我最多遇到过连续调用6次的，弄的我一头雾水，具体原因尚不详；好消息是，无论在哪个阶段调用多少次，<span style="color:rgb(255,0,0);">起决定作用的只有willAppear调用后，willLayoutSubviews调用前shouldRotate的最后一次调用，其余阶段返回yes还是no都不重要。</span></span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">再看iOS6</p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">iOS6对转屏逻辑做了修改，去掉了原来的shouldRotate方法，代之以新的几个方法，<span style="color:rgb(255,0,0);">具体可看<a href="http://blog.csdn.net/totogogo/article/details/8002173" rel="nofollow" style="color:rgb(68,68,68);">这篇blog</a></span>，介绍很详细，不再赘述，做一些补充：</p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>-</span>(
    <span>BOOL</span>)
    <span>shouldAutorotate</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>YES</span>;
    <br>
    <span>}</span>
    <br>
    <span>-</span>(
    <span>NSUInteger</span>)
    <span>supportedInterfaceOrientations</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>UIInterfaceOrientationMaskAll</span>;
    <br>
    <span>}</span>
    <br>
    <span>-</span>(
    <span>UIInterfaceOrientation</span>)
    <span>preferredInterfaceOrientationForPresentation</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>UIInterfaceOrientationLandscapeRight</span>;
    <br>
    <span>}</span> 
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">这3个方法代替了原来的shouldRotate方法，但并不是换汤不换药。</p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="color:rgb(255,0,0);">iOS6把转屏的逻辑判断放到了rootViewController里，也就是说，无论当前显示的是那个子vc，都是rootViewController响应转屏事件（或者present出来的modalViewController也可以，总之是最根部的vc才行），而且不向下传递。直接在一个childViewController里写这几个方法，是根本不会被调用到的。这就带来一个问题，根vc的转屏逻辑直接决定了子vc的转屏逻辑，如果老子说这个方向支持，那儿子只好支持，而且所有的儿子还都得支持。解决这个专制问题，可以在根vc里这样写：</span></p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>-</span>(
    <span>BOOL</span>)
    <span>shouldAutorotate</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>[</span>
    <span>self</span>
    <span>.</span>
    <span>topViewController</span>&nbsp;
    <span>shouldAutorotate</span>
    <span>];</span>
    <br>
    <span>}</span>
    <br>
    <span>-</span>(
    <span>NSUInteger</span>)
    <span>supportedInterfaceOrientations</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>[</span>
    <span>self</span>
    <span>.</span>
    <span>topViewController</span>&nbsp;
    <span>supportedInterfaceOrientations</span>
    <span>];</span>
    <br>
    <span>}</span> 
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="color:rgb(255,0,0);">让老子每次转屏被问到的时候，都亲自问下他现在正在活跃的子孙。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="color:rgb(255,0,0);">转屏时调用顺序跟iOS5一样，不过shouldRotate被顺序拆分为shouldAutoRotate和supported。并且如果shouldAutoRotate返回了NO，则转屏过程中断，不再继续执行supported。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">最后说到强制横屏。</p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">iOS5和6都有这个问题，如果我们采用presentViewController的方式展示一个vc，那么我们是可以在进入vc的时候控制present的方向的。但是<span style="color:rgb(255,0,0);">如果我们采用的是pushViewController的方式</span>，问题就出现了，无论我们用何种方式设置这个vc支持的屏幕方向，都只能在转屏的时候进行调整，而无法在第一次进入这个vc的时候调整。<span style="color:rgb(255,0,0);">也就是说，竖屏push进入一个只支持横屏的vc，显示依然是竖屏</span>，但当转横屏之后，就转不回竖屏了。</p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">这显然不对，解决这个问题，要么用私有API setOrientation: 这个显然是风险太大的。<span style="color:rgb(255,0,0);">比较好的解决方式就是检测屏幕方向，然后用view.transform去人工转view，setStatusBarOrientation。</span>这里面要注意几个要点：</p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">1.&nbsp;<span style="color:rgb(255,0,0);">view.transform的makeRotation方式转view是中心点center不动，view旋转。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">2.&nbsp;<span style="color:rgb(255,0,0);">旋转过后view的frame会改变，所以要人工调整，这里计算frame的新位置和尺寸是重点。由于是人工转屏，改变电池条的方向并不会改变view的坐标系，所以一切要在原坐标系里算。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">3.&nbsp;<span style="color:rgb(255,0,0);">view转屏退出后要记得用identity恢复之前view转过的状态。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">4.&nbsp;<span style="color:rgb(255,0,0);">最坑爹的一点是，用setStatusBarOrientation:animated:方法来设置电池条方向时，在iOS5下没有问题，但在iOS6下，这个方法会调用rootvc的shouldAutoRotate（相当于一次转屏判断），如果shouldAutoRotate返回YES（无论supported返回什么），电池条方向都不会被设定！非常坑，所以逻辑要想好，比如可以通过一个bool值判断是在改变电池条方向还是系统转屏，如果是前者，返回个NO骗骗它……</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">5. 在哪个方法里处理转屏，设置电池条方向，以及在哪个方法里调整view的frame，都是很重要的，要视你的view是怎么push进来的（有rootvc还是本身就是），要具体情况具体分析。中心思想是：比如强制要求横屏，则在横屏进入的时候，直接用系统转屏逻辑限制方向即可；而在竖屏进入时，禁用系统转屏逻辑，人工将view旋转至需要的方向，而后再转为横屏时，可采用两种方式，一是恢复原本view方向后重新开启系统转屏逻辑，二是继续根据方向人工转屏。设计这个过程代码时，明确之前研究的frame尺寸应该什么时候重设以及各个view方法的执行顺序，是必须的。</p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">5. iOS5和6要区分处理。总之，强制横屏绝对不是网上随处可见的transform一下然后重设一下bound就ok了的事情。</p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">附上一种强制横屏实现的代码：</p> 
   <div style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"> 
    <span>// 强制横屏的一种实现</span>
    <br>
    <span>// 使用方法：</span>
    <br>
    <span>// 在vc的init方法中调用initLogic</span>
    <br>
    <span>// 在vc关闭之前调用cleanRotateTrace方法</span>
    <br>
    <br>
    <span>-</span>(
    <span>void</span>)
    <span>initLogic</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>isPortraitIn_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>NO</span>;
    <br> &nbsp;&nbsp;&nbsp;
    <span>isSettingStatusBar_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>NO</span>;
    <br>
    <span>}</span>
    <br>
    <span>-</span>(
    <span>BOOL</span>)
    <span>shouldAutorotate</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>if</span>&nbsp;(
    <span>isSettingStatusBar_</span>)
    <br> &nbsp;&nbsp;&nbsp;
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>NO</span>;
    <br> &nbsp;&nbsp;&nbsp;
    <span>}</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>YES</span>;
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>(
    <span>NSUInteger</span>)
    <span>supportedInterfaceOrientations</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;
    <span>UIInterfaceOrientationMaskLandscape</span>;
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>(
    <span>BOOL</span>)
    <span>shouldAutorotateToInterfaceOrientation:</span>(
    <span>UIInterfaceOrientation</span>)
    <span>toInterfaceOrientation</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>return</span>&nbsp;((
    <span>toInterfaceOrientation</span>&nbsp;
    <span>==</span>&nbsp;
    <span>UIInterfaceOrientationLandscapeLeft</span>)||(
    <span>toInterfaceOrientation</span>&nbsp;
    <span>==</span>&nbsp;
    <span>UIInterfaceOrientationLandscapeRight</span>));
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>&nbsp;(
    <span>void</span>)
    <span>willRotateToInterfaceOrientation:</span>(
    <span>UIInterfaceOrientation</span>)
    <span>toInterfaceOrientation</span>
    <span>duration:</span>(
    <span>NSTimeInterval</span>)
    <span>duration</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>if</span>&nbsp;(
    <span>isPortraitIn_</span>)
    <br> &nbsp;&nbsp;&nbsp;
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>transform</span>&nbsp;
    <span>=</span>&nbsp;
    <span>CGAffineTransformIdentity</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isPortraitIn_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>NO</span>;
    <br> &nbsp;&nbsp;&nbsp;
    <span>}</span>
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>&nbsp;(
    <span>void</span>)
    <span>cleanRotationTrace</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>if</span>&nbsp;(
    <span>isPortraitIn_</span>)
    <br> &nbsp;&nbsp;&nbsp;
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>transform</span>&nbsp;
    <span>=</span>&nbsp;
    <span>CGAffineTransformIdentity</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isPortraitIn_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>NO</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>UIInterfaceOrientation</span>&nbsp;
    <span>orientation</span>&nbsp;
    <span>=</span>&nbsp;
    <span>[</span>
    <span>UIApplication</span>
    <span>sharedApplication</span>
    <span>].</span>
    <span>statusBarOrientation</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>if</span>&nbsp;(
    <span>orientation</span>&nbsp;
    <span>==</span>&nbsp;
    <span>UIInterfaceOrientationLandscapeRight</span>)
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isSettingStatusBar_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>YES</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>[[</span>
    <span>UIApplication</span>&nbsp;
    <span>sharedApplication</span>
    <span>]</span>
    <span>setStatusBarOrientation:</span>
    <span>UIInterfaceOrientationPortrait</span>&nbsp;
    <span>animated:</span>
    <span>NO</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isSettingStatusBar_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>NO</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>}</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>else</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isSettingStatusBar_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>YES</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>[[</span>
    <span>UIApplication</span>&nbsp;
    <span>sharedApplication</span>
    <span>]</span>
    <span>setStatusBarOrientation:</span>
    <span>UIInterfaceOrientationPortraitUpsideDown</span>&nbsp;
    <span>animated:</span>
    <span>NO</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isSettingStatusBar_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>NO</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>}</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>self</span>
    <span>.</span>
    <span>view</span>&nbsp;
    <span>setFrame:</span>
    <span>CGRectMake</span>(
    <span>0</span>
    <span>,</span>&nbsp;
    <span>0</span>
    <span>,</span>&nbsp;
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>frame</span>
    <span>.</span>
    <span>size</span>
    <span>.</span>
    <span>height</span>&nbsp;
    <span>+</span>&nbsp;
    <span>20</span>
    <span>,</span>
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>frame</span>
    <span>.</span>
    <span>size</span>
    <span>.</span>
    <span>width</span>&nbsp;
    <span>-</span>&nbsp;
    <span>20</span>
    <span>)];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>}</span>
    <br>
    <span>}</span>
    <br>
    <br>
    <span>-</span>(
    <span>void</span>)
    <span>viewDidAppear:</span>(
    <span>BOOL</span>)
    <span>animated</span>
    <br>
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>super</span>&nbsp;
    <span>viewDidAppear:</span>
    <span>animated</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>UIInterfaceOrientation</span>&nbsp;
    <span>orientation</span>&nbsp;
    <span>=</span>&nbsp;
    <span>[</span>
    <span>UIApplication</span>
    <span>sharedApplication</span>
    <span>].</span>
    <span>statusBarOrientation</span>;
    <br> &nbsp;&nbsp;&nbsp;
    <span>if</span>&nbsp;(
    <span>UIInterfaceOrientationIsPortrait</span>(
    <span>orientation</span>))
    <br> &nbsp;&nbsp;&nbsp;
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isPortraitIn_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>YES</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>transform</span>&nbsp;
    <span>=</span>&nbsp;
    <span>CGAffineTransformMakeRotation</span>(
    <span>M_PI_2</span>);
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>if</span>&nbsp;(
    <span>orientation</span>&nbsp;
    <span>==</span>&nbsp;
    <span>UIInterfaceOrientationPortrait</span>)
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isSettingStatusBar_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>YES</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>[[</span>
    <span>UIApplication</span>&nbsp;
    <span>sharedApplication</span>
    <span>]</span>
    <span>setStatusBarOrientation:</span>
    <span>UIInterfaceOrientationLandscapeRight</span>&nbsp;
    <span>animated:</span>
    <span>NO</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isSettingStatusBar_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>NO</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>}</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>else</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>{</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isSettingStatusBar_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>YES</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>[[</span>
    <span>UIApplication</span>&nbsp;
    <span>sharedApplication</span>
    <span>]</span>
    <span>setStatusBarOrientation:</span>
    <span>UIInterfaceOrientationLandscapeLeft</span>&nbsp;
    <span>animated:</span>
    <span>NO</span>
    <span>];</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>isSettingStatusBar_</span>&nbsp;
    <span>=</span>&nbsp;
    <span>NO</span>;
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>}</span>
    <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span>[</span>
    <span>self</span>
    <span>.</span>
    <span>view</span>&nbsp;
    <span>setFrame:</span>
    <span>CGRectMake</span>(
    <span>0</span>
    <span>,</span>&nbsp;
    <span>-</span>
    <span>20</span>
    <span>,</span>&nbsp;
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>frame</span>
    <span>.</span>
    <span>size</span>
    <span>.</span>
    <span>height</span>&nbsp;
    <span>-</span>&nbsp;
    <span>20</span>
    <span>,</span>
    <span>self</span>
    <span>.</span>
    <span>view</span>
    <span>.</span>
    <span>frame</span>
    <span>.</span>
    <span>size</span>
    <span>.</span>
    <span>width</span>&nbsp;
    <span>+</span>&nbsp;
    <span>20</span>
    <span>)];</span>
    <br> &nbsp;&nbsp;&nbsp;
    <span>}</span>
    <br>
    <span>}</span> 
   </div> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">虽然强制横屏的中心思想都差不多，但具体实现方式可以有很多种，我自己写过两种，效果都差不多，代码简洁程度不同。<span style="color:rgb(255,0,0);">这些实现目前我都没有解决的问题是转屏的动画，用系统逻辑的部分没有问题，但如果是竖屏进入强制横屏的，在第一次转到真正横屏的时候，电池条的转动与view的转动是不同步的，动画很难看，之后再转就又是系统转屏没有问题了。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;"><span style="color:rgb(255,0,0);">这个动画问题我至今能够想到的唯一解决方法是完全不用系统转屏，而是所有的转屏都自己写。求更好解决方案。</span></p> 
   <p style="color:rgb(68,68,68);font-family:tahoma, arial, sans-serif;font-size:12px;line-height:1.5;">到此为止。</p> 
   <p style="line-height:1.5;"><font color="#444444"><span style="font-size:12px;">本文转自编程小翁博客园博客，原文链接：http://www.cnblogs.com/wengzilin/p/3282784.html，如需转载请自行联系原作者</span></font><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
