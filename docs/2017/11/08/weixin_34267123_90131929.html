<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>主流框架中DOMContentLoaded事件的实现 « NotBeCN</title>
  <meta name="description" content="                  在实际应用中，我们经常会遇到这样的场景，当页面加载完成后去做一些事情：绑定事件、DOM操作某些结点等。原来比较常用的是window的onload事件，而该事件的实际效果是：当页面解析/DOM树建立完成，并完成了诸如图片、脚本、样式表甚至是iframe中所有资源的下载后才触发的。...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/08/weixin_34267123_90131929.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">主流框架中DOMContentLoaded事件的实现</h1>
    <p class="post-meta">Nov 8, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <div style="line-height:32px;color:rgb(68,68,68);font-family:'微软雅黑', tahoma, arial, sans-serif;font-size:16px;"> 
    <p style="text-indent:2em;line-height:2;">在实际应用中，我们经常会遇到这样的场景，当页面加载完成后去做一些事情：绑定事件、DOM操作某些结点等。原来比较常用的是window的onload事件，而该事件的实际效果是：当页面解析/DOM树建立完成，并完成了诸如图片、脚本、样式表甚至是iframe中所有资源的下载后才触发的。这对于很多实际的应用而言有点太“迟”了，比较影响用户体验。为了解决这个问题，FF中便增加了一个DOMContentLoaded方法，与onload相比，该方法触发的时间更早，它是在页面的DOM内容加载完成后即触发，而无需等待其他资源的加载。Webkit引擎从版本525（Webkit nightly 1/2008:525+）开始也引入了该事件，Opera中也包含该方法。到目前为止主流的IE仍然没有要添加的意思。虽然IE下没有，但总是有解决办法的，下文对比了一下几大主流框架对于该事件的兼容性版本实现方案，涉及的框架包括：</p> 
    <ul>
     <li style="list-style:disc;">Prototype</li> 
     <li style="list-style:disc;">jQeury</li> 
     <li style="list-style:disc;">moontools</li> 
     <li style="list-style:disc;">dojo</li> 
     <li style="list-style:disc;">yui</li> 
     <li style="list-style:disc;">ext <h3 style="font-size:16px;line-height:1.5;">一、Prototype</h3> <p style="text-indent:2em;line-height:2;">实现代码</p> 
      <div style="line-height:2;"> 
       <div style="line-height:2;"> 
        <div style="line-height:2;"> 
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">view plain</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">copy to clipboard</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">print</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">?</a> 
        </div> 
       </div> 
       <ol>
        <li style="list-style:disc;"><span>(function<span>()&nbsp;{ &nbsp;&nbsp;</span></span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;<span>/*&nbsp;Support&nbsp;for&nbsp;the&nbsp;DOMContentLoaded&nbsp;event&nbsp;is&nbsp;based&nbsp;on&nbsp;work&nbsp;by&nbsp;Dan&nbsp;Webb,&nbsp;</span>&nbsp;</li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Matthias&nbsp;Miller,&nbsp;Dean&nbsp;Edwards&nbsp;and&nbsp;John&nbsp;Resig.&nbsp;*/&nbsp;&nbsp;</span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;var<span>&nbsp;timer; &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;function<span>&nbsp;fireContentLoadedEvent()&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(document.loaded)&nbsp;return; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;if<span>&nbsp;(timer)&nbsp;window.clearInterval(timer); &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;document.fire("dom:loaded"); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;document.loaded&nbsp;=&nbsp;true; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;if<span>&nbsp;(document.addEventListener)&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Prototype.Browser.WebKit)&nbsp;{ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timer&nbsp;=&nbsp;window.setInterval(function()&nbsp;{ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if<span>&nbsp;(/loaded|complete/.test(document.readyState)) &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fireContentLoadedEvent(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;0); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Event.observe(window,&nbsp;"load",&nbsp;fireContentLoadedEvent); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else<span>&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.addEventListener("DOMContentLoaded", &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fireContentLoadedEvent,&nbsp;false); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;}&nbsp;else<span>&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;document.write("&lt;"+"script&nbsp;id=__onDOMContentLoaded&nbsp;defer&nbsp;src=//:&gt;&lt;\/script&gt;"<span>); &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;$("__onDOMContentLoaded").onreadystatechange&nbsp;=&nbsp;function()&nbsp;{ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this.readyState&nbsp;==&nbsp;"complete")&nbsp;{ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.onreadystatechange&nbsp;=&nbsp;null; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fireContentLoadedEvent(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;}; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">})();&nbsp;&nbsp;</li> 
       </ol>
      </div> <p style="text-indent:2em;line-height:2;">实现思路如下：</p> 
      <ol>
       <li style="list-style:disc;">如果是webkit则轮询document的readyState属性，如果该属性的值为loaded或complete则触发DOMContentLoaded事件，为保险起见，将该事件注册到window.onload上。</li> 
       <li style="list-style:disc;">如果是FF则直接注册DOMContentLoaded事件。</li> 
       <li style="list-style:disc;">如果是IE则使用document.write往页面中加入一个script元素，并设置defer属性，最后是把该脚本的加载完成视作DOMContentLoaded事件来触发。</li> 
      </ol><p style="text-indent:2em;line-height:2;">该实现方式的问题主要有两点：第一、通过document.write写script并设置defer的方法在页面包含iframe的情况下，会等到iframe内的内容加载完后才触发，这与onload没有太大的区别；第二、Webkit在525以上的版本引入了DOMContentLoaded方法，因此在这些版本中无需再通过轮询来实现，可以优化。</p> <h3 style="font-size:16px;line-height:1.5;">二、jQuery</h3> 
      <div style="line-height:2;"> 
       <div style="line-height:2;"> 
        <div style="line-height:2;"> 
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">view plain</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">copy to clipboard</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">print</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">?</a> 
        </div> 
       </div> 
       <ol>
        <li style="list-style:disc;"><span>function<span>&nbsp;bindReady(){ &nbsp;&nbsp;</span></span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;readyBound&nbsp;)&nbsp;return; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;readyBound&nbsp;=&nbsp;true; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Mozilla,&nbsp;Opera&nbsp;and&nbsp;webkit&nbsp;nightlies&nbsp;currently&nbsp;support&nbsp;this&nbsp;event&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;if<span>&nbsp;(&nbsp;document.addEventListener&nbsp;)&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Use&nbsp;the&nbsp;handy&nbsp;event&nbsp;callback &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.addEventListener(&nbsp;"DOMContentLoaded",&nbsp;function(){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.removeEventListener(&nbsp;"DOMContentLoaded",&nbsp;arguments.callee,&nbsp;false&nbsp;); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jQuery.ready(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false<span>&nbsp;); &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;If&nbsp;IE&nbsp;event&nbsp;model&nbsp;is&nbsp;used&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(&nbsp;document.attachEvent&nbsp;)&nbsp;{ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ensure&nbsp;firing&nbsp;before&nbsp;onload, &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;maybe&nbsp;late&nbsp;but&nbsp;safe&nbsp;also&nbsp;for&nbsp;iframes&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.attachEvent("onreadystatechange",&nbsp;function(){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;document.readyState&nbsp;===&nbsp;"complete"&nbsp;)&nbsp;{ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.detachEvent(&nbsp;"onreadystatechange"<span>,&nbsp;arguments.callee&nbsp;); &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jQuery.ready(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;If&nbsp;IE&nbsp;and&nbsp;not&nbsp;an&nbsp;iframe&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;continually&nbsp;check&nbsp;to&nbsp;see&nbsp;if&nbsp;the&nbsp;document&nbsp;is&nbsp;ready&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;document.documentElement.doScroll&nbsp;&amp;&amp;&nbsp;typeof&nbsp;window.frameElement&nbsp;===&nbsp;"undefined"&nbsp;)&nbsp;(function(){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;jQuery.isReady&nbsp;)&nbsp;return; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<span>&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;If&nbsp;IE&nbsp;is&nbsp;used,&nbsp;use&nbsp;the&nbsp;trick&nbsp;by&nbsp;Diego&nbsp;Perini&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;http://javascript.nwbox.com/IEContentLoaded/&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.documentElement.doScroll("left"); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch(&nbsp;error&nbsp;)&nbsp;{ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout(&nbsp;arguments.callee,&nbsp;0&nbsp;); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;and&nbsp;execute&nbsp;any&nbsp;waiting&nbsp;functions&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jQuery.ready(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;A&nbsp;fallback&nbsp;to&nbsp;window.onload,&nbsp;that&nbsp;will&nbsp;always&nbsp;work&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;jQuery.event.add(&nbsp;window,&nbsp;"load",&nbsp;jQuery.ready&nbsp;); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">}&nbsp;&nbsp;</li> 
       </ol>
      </div> <p style="text-indent:2em;line-height:2;">实现思路如下：</p> 
      <ol>
       <li style="list-style:disc;">将Webkit与Firefox同等对待，都是直接注册DOMContentLoaded事件，但是由于Webkit是在525以上版本才引入的，因此存在兼容性的隐患。</li> 
       <li style="list-style:disc;">对于IE，首先注册document的onreadystatechange事件，经测试，该方式与window.onload相当，依然会等到所有资源下载完毕后才触发。</li> 
       <li style="list-style:disc;">之后，判断如果是IE并且页面不在iframe当中，则通过setTiemout来不断的调用documentElement的doScroll方法，直到调用成功则出触发DOMContentLoaded。1</li> 
      </ol><p style="text-indent:2em;line-height:2;">jQuery对于IE的解决方案，使用了一种新的方法，该方法源自<a href="http://javascript.nwbox.com/IEContentLoaded/" rel="nofollow" style="color:#0000FF;text-decoration:none;">http://javascript.nwbox.com/IEContentLoaded/</a>。它的原理是，在IE下，DOM的某些方法只有在DOM解析完成后才可以调用，doScroll就是这样一个方法，反过来当能调用doScroll的时候即是DOM解析完成之时，与prototype中的document.write相比，该方案可以解决页面有iframe时失效的问题。此外，jQuery似乎担心当页面处于iframe中时，该方法会失效，因此实现代码中做了判断，如果是在iframe中则通过document的onreadystatechange来实现，否则通过doScroll来实现。不过经测试，即使是在iframe中，doScroll依然有效。</p> <h3 style="font-size:16px;line-height:1.5;">三、Moontools</h3> 
      <div style="line-height:2;"> 
       <div style="line-height:2;"> 
        <div style="line-height:2;"> 
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">view plain</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">copy to clipboard</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">print</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">?</a> 
        </div> 
       </div> 
       <ol>
        <li style="list-style:disc;"><span>(function<span>(){ &nbsp;&nbsp;</span></span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;domready&nbsp;=&nbsp;function(){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Browser.loaded)&nbsp;return; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Browser.loaded&nbsp;=&nbsp;true; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.fireEvent('domready'); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.fireEvent('domready'); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;}; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Browser.Engine.trident){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;temp&nbsp;=&nbsp;document.createElement('div'); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(function<span>(){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($try(function(){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp.doScroll('left'); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$(temp).inject(document.body).set('html',&nbsp;'temp').dispose(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}))&nbsp;?&nbsp;domready()&nbsp;:&nbsp;arguments.callee.delay(50); &nbsp;&nbsp;</span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if<span>&nbsp;(Browser.Engine.webkit&nbsp;&amp;&amp;&nbsp;Browser.Engine.version&nbsp;&lt;&nbsp;525){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(function<span>(){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(['loaded',&nbsp;'complete'<span>].contains(document.readyState))&nbsp;?&nbsp;domready()&nbsp;:&nbsp;arguments.callee.delay(50); &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else<span>&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.addEvent('load',&nbsp;domready); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.addEvent('DOMContentLoaded',&nbsp;domready); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">})();&nbsp;&nbsp;</li> 
       </ol>
      </div> <p style="text-indent:2em;line-height:2;">实现思路如下：</p> 
      <ol>
       <li style="list-style:disc;">如果是IE则使用doScroll方法来实现。</li> 
       <li style="list-style:disc;">如果是小于525版本的Webkit则通过轮询document.readyState来实现。</li> 
       <li style="list-style:disc;">其他的(FF/Webkit高版/Opera)则直接注册DOMContentLoaded事件。1</li> 
      </ol><p style="text-indent:2em;line-height:2;">Moontools的实现方案prototype和jQeury中的综合体，对webkit做了版本判断则使得该方案更加的健壮。在doScroll的实现方面，与jQuery相比，这里是新建了一个div元素，并且在使用完毕后进行销毁，而jQuery则直接使用了documentElement的doScroll来检测，更简单高效一些。</p> <h3 style="font-size:16px;line-height:1.5;">四、Dojo</h3> 
      <div style="line-height:2;"> 
       <div style="line-height:2;"> 
        <div style="line-height:2;"> 
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">view plain</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">copy to clipboard</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">print</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">?</a> 
        </div> 
       </div> 
       <ol>
        <li style="list-style:disc;"><span><span>//&nbsp;&nbsp;START&nbsp;DOMContentLoaded&nbsp;</span>&nbsp;&nbsp;</span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Mozilla&nbsp;and&nbsp;Opera&nbsp;9&nbsp;expose&nbsp;the&nbsp;event&nbsp;we&nbsp;could&nbsp;use&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(document.addEventListener){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;NOTE:&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;due&nbsp;to&nbsp;a&nbsp;threading&nbsp;issue&nbsp;in&nbsp;Firefox&nbsp;2.0,&nbsp;we&nbsp;can't&nbsp;enable&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOMContentLoaded&nbsp;on&nbsp;that&nbsp;platform.&nbsp;For&nbsp;more&nbsp;information,&nbsp;see:&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://trac.dojotoolkit.org/ticket/1704&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(dojo.isOpera&nbsp;||&nbsp;dojo.isFF&nbsp;&gt;=&nbsp;3&nbsp;||&nbsp;(dojo.isMoz&nbsp;&amp;&amp;&nbsp;dojo.config.enableMozDomContentLoaded&nbsp;===&nbsp;true)){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.addEventListener("DOMContentLoaded",&nbsp;dojo._loadInit,&nbsp;null); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;mainly&nbsp;for&nbsp;Opera&nbsp;8.5,&nbsp;won't&nbsp;be&nbsp;fired&nbsp;if&nbsp;DOMContentLoaded&nbsp;fired&nbsp;already.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;also&nbsp;used&nbsp;for&nbsp;Mozilla&nbsp;because&nbsp;of&nbsp;trac&nbsp;#1640&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.addEventListener("load",&nbsp;dojo._loadInit,&nbsp;null); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(dojo.isAIR){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.addEventListener("load",&nbsp;dojo._loadInit,&nbsp;null); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if(/(WebKit|khtml)/i.test(navigator.userAgent)){&nbsp;//&nbsp;sniff &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dojo._khtmlTimer&nbsp;=&nbsp;setInterval(function(){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if<span>(/loaded|complete/.test(document.readyState)){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dojo._loadInit();&nbsp;//&nbsp;call&nbsp;the&nbsp;onload&nbsp;handler &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;10); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;END&nbsp;DOMContentLoaded&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;(function<span>(){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var<span>&nbsp;_w&nbsp;=&nbsp;window; &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;_handleNodeEvent&nbsp;=&nbsp;function(/*String*/evtName,&nbsp;/*Function*/fp){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;summary:&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;non-destructively&nbsp;adds&nbsp;the&nbsp;specified&nbsp;function&nbsp;to&nbsp;the&nbsp;node's&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;evtName&nbsp;handler.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;evtName:&nbsp;should&nbsp;be&nbsp;in&nbsp;the&nbsp;form&nbsp;"onclick"&nbsp;for&nbsp;"onclick"&nbsp;handlers.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Make&nbsp;sure&nbsp;you&nbsp;pass&nbsp;in&nbsp;the&nbsp;"on"&nbsp;part.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;oldHandler&nbsp;=&nbsp;_w[evtName]&nbsp;||&nbsp;function(){}; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_w[evtName]&nbsp;=&nbsp;function(){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fp.apply(_w,&nbsp;arguments); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldHandler.apply(_w,&nbsp;arguments); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if<span>(dojo.isIE){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;for&nbsp;Internet&nbsp;Explorer.&nbsp;readyState&nbsp;will&nbsp;not&nbsp;be&nbsp;achieved&nbsp;on&nbsp;init&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;call,&nbsp;but&nbsp;dojo&nbsp;doesn't&nbsp;need&nbsp;it&nbsp;however,&nbsp;we'll&nbsp;include&nbsp;it&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;because&nbsp;we&nbsp;don't&nbsp;know&nbsp;if&nbsp;there&nbsp;are&nbsp;other&nbsp;functions&nbsp;added&nbsp;that&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;might.&nbsp;&nbsp;Note&nbsp;that&nbsp;this&nbsp;has&nbsp;changed&nbsp;because&nbsp;the&nbsp;build&nbsp;process&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;&nbsp;strips&nbsp;all&nbsp;comments&nbsp;--&nbsp;including&nbsp;conditional&nbsp;ones.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!dojo.config.afterOnLoad){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.write('&lt;SCR'+'IPT&nbsp;?onreadystatechange="if(this.readyState==\'complete\'){'&nbsp;+&nbsp;dojo._scopeName&nbsp;+&nbsp;'._loadInit();}"&nbsp;+&nbsp;?&nbsp;src="//:"&nbsp;defer&gt;'&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;'&lt;/SCR'+'IPT&gt;'&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<span>{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.namespaces.add("v","urn:schemas-microsoft-com:vml"<span>); &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.createStyleSheet().addRule("v\\:*",&nbsp;"behavior:url(#default#VML)"); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}catch(e){} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;FIXME:&nbsp;dojo.unloaded&nbsp;requires&nbsp;dojo&nbsp;scope,&nbsp;so&nbsp;using&nbsp;anon&nbsp;function&nbsp;wrapper.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_handleNodeEvent("onbeforeunload",&nbsp;function<span>()&nbsp;{&nbsp;dojo.unloaded();&nbsp;}); &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_handleNodeEvent("onunload",&nbsp;function<span>()&nbsp;{&nbsp;dojo.windowUnloaded();&nbsp;}); &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;})();&nbsp;&nbsp;</li> 
       </ol>
      </div> <p style="text-indent:2em;line-height:2;">实现思路如下：</p> 
      <ol>
       <li style="list-style:disc;">如果是Opera或FF3以上版本则直接注册DOMContentLoaded&lt;事件，为保险起见，同时也注册了window.onload事件。/li&gt;</li> 
       <li style="list-style:disc;">对于webkit则通过轮询document.readyState来实现。</li> 
       <li style="list-style:disc;">如果是Air则只注册widnow.onload事件。</li> 
       <li style="list-style:disc;">如果是IE则通过往页面写带defer属性的script并注册其onreadystatechange事件来实现。</li> 
      </ol><p style="text-indent:2em;line-height:2;">Dojo在IE下的实现方案同样无法解决iframe的问题，而由于在FF2 下会有一个非常奇怪的Bug，因此默认只在FF3以上版本上使用DOMContentLoaded事件，同时又给了一个配置-dojo.config.enableMozDomContentLoaded，如果在FF下将该配置设置为true则依然会使用DOMContentLoaded来实现，这一点充分考虑到了灵活性。对于webkit的实现，与prototype一样有优化的空间。</p> <h3 style="font-size:16px;line-height:1.5;">五、YUI</h3> 
      <div style="line-height:2;"> 
       <div style="line-height:2;"> 
        <div style="line-height:2;"> 
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">view plain</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">copy to clipboard</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">print</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">?</a> 
        </div> 
       </div> 
       <ol>
        <li style="list-style:disc;"><span>/*!&nbsp;DOMReady:&nbsp;based&nbsp;on&nbsp;work&nbsp;by:&nbsp;Dean&nbsp;Edwards/John&nbsp;Resig/Matthias&nbsp;Miller&nbsp;*/&nbsp;&nbsp;</span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Internet&nbsp;Explorer:&nbsp;use&nbsp;the&nbsp;readyState&nbsp;of&nbsp;a&nbsp;defered&nbsp;script.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;This&nbsp;isolates&nbsp;what&nbsp;appears&nbsp;to&nbsp;be&nbsp;a&nbsp;safe&nbsp;moment&nbsp;to&nbsp;manipulate&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;the&nbsp;DOM&nbsp;prior&nbsp;to&nbsp;when&nbsp;the&nbsp;document's&nbsp;readyState&nbsp;suggests&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;it&nbsp;is&nbsp;safe&nbsp;to&nbsp;do&nbsp;so.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(EU.isIE)&nbsp;{ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;Process&nbsp;onAvailable/onContentReady&nbsp;items&nbsp;when&nbsp;the&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;DOM&nbsp;is&nbsp;ready.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YAHOO.util.Event.onDOMReady( &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YAHOO.util.Event._tryPreloadAttach, &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YAHOO.util.Event,&nbsp;true); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;n&nbsp;=&nbsp;document.createElement('p');&nbsp;&nbsp; &nbsp;</li> 
        <li style="list-style:disc;">&nbsp;</li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU._dri&nbsp;=&nbsp;setInterval(function()&nbsp;{ &nbsp;</span></li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{ &nbsp;</span></li> 
        <li style="list-style:disc;"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;throws&nbsp;an&nbsp;error&nbsp;if&nbsp;doc&nbsp;is&nbsp;not&nbsp;ready&nbsp;</span>&nbsp;</span></li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n.doScroll('left'); &nbsp;</span></li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clearInterval(EU._dri); &nbsp;</span></li> 
        <li style="list-style:disc;"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU._dri&nbsp;=&nbsp;null;&nbsp;</span>&nbsp;</span></li> 
        <li style="list-style:disc;"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU._ready();&nbsp;</span>&nbsp;</span></li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;null; &nbsp;</span></li> 
        <li style="list-style:disc;"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(ex)&nbsp;{&nbsp;</span>&nbsp;</span></li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;</span></li> 
        <li style="list-style:disc;"><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;EU.POLL_INTERVAL);&nbsp;&nbsp;</span>&nbsp;</span></li> 
        <li style="list-style:disc;">&nbsp;</li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;The&nbsp;document's&nbsp;readyState&nbsp;in&nbsp;Safari&nbsp;currently&nbsp;will &nbsp;&nbsp;</span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;change&nbsp;to&nbsp;loaded/complete&nbsp;before&nbsp;images&nbsp;are&nbsp;loaded.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if<span>&nbsp;(EU.webkit&nbsp;&amp;&amp;&nbsp;EU.webkit&nbsp;&lt;&nbsp;525)&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU._dri&nbsp;=&nbsp;setInterval(function()&nbsp;{ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;rs=document.readyState; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;("loaded"&nbsp;==&nbsp;rs&nbsp;||&nbsp;"complete"&nbsp;==&nbsp;rs)&nbsp;{ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clearInterval(EU._dri); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU._dri&nbsp;=&nbsp;null; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU._ready(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;EU.POLL_INTERVAL);&nbsp; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;FireFox&nbsp;and&nbsp;Opera:&nbsp;These&nbsp;browsers&nbsp;provide&nbsp;a&nbsp;event&nbsp;for&nbsp;this&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;moment.&nbsp;&nbsp;The&nbsp;latest&nbsp;WebKit&nbsp;releases&nbsp;now&nbsp;support&nbsp;this&nbsp;event.&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else<span>&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU._simpleAdd(document,&nbsp;"DOMContentLoaded",&nbsp;EU._ready); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>/////////////////////////////////////////////////////////////&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU._simpleAdd(window,&nbsp;"load",&nbsp;EU._load); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU._simpleAdd(window,&nbsp;"unload",&nbsp;EU._unload); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EU._tryPreloadAttach(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;})();&nbsp;&nbsp;</li> 
       </ol>
      </div> <p style="text-indent:2em;line-height:2;">实现思路与Moontools的一致，不再赘诉。</p> <h3 style="font-size:16px;line-height:1.5;">六、EXT</h3> 
      <div style="line-height:2;"> 
       <div style="line-height:2;"> 
        <div style="line-height:2;"> 
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">view plain</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">copy to clipboard</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">print</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">?</a> 
        </div> 
       </div> 
       <ol>
        <li style="list-style:disc;"><span>function<span>&nbsp;initDocReady(){ &nbsp;&nbsp;</span></span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;COMPLETE&nbsp;=&nbsp;"complete"; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;docReadyEvent&nbsp;=&nbsp;new&nbsp;Ext.util.Event(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;if<span>&nbsp;(Ext.isGecko&nbsp;||&nbsp;Ext.isOpera)&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOC.addEventListener(DOMCONTENTLOADED,&nbsp;fireDocReady,&nbsp;false); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(Ext.isIE){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOC.write("&lt;S"+'CRIPT&nbsp;id="&nbsp;+&nbsp;IEDEFERED&nbsp;+&nbsp;"&nbsp;src="/'+'/:"&nbsp;defer="defer"&gt;&lt;/S'+"CRIPT&gt;"); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOC.getElementById(IEDEFERED).onreadystatechange&nbsp;=&nbsp;function(){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(this.readyState&nbsp;==&nbsp;COMPLETE){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fireDocReady(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(Ext.isWebKit){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;docReadyProcId&nbsp;=&nbsp;setInterval(function(){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if<span>(DOC.readyState&nbsp;==&nbsp;COMPLETE)&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fireDocReady(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;10); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;<span>//&nbsp;no&nbsp;matter&nbsp;what,&nbsp;make&nbsp;sure&nbsp;it&nbsp;fires&nbsp;on&nbsp;load&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;E.on(WINDOW,&nbsp;"load",&nbsp;fireDocReady); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">};&nbsp;&nbsp;</li> 
       </ol>
      </div> <p style="text-indent:2em;line-height:2;">实现思路与Dojo的一致，不再赘诉。</p> <h3 style="font-size:16px;line-height:1.5;">总结</h3> <p style="text-indent:2em;line-height:2;">总结各大主流框架的做法，写了以下这个版本。主要是尽量的做到优化并考虑到FF2下的Bug，提供一个是否使用DOMContentLoaded的开关配置。</p> 
      <div style="line-height:2;"> 
       <div style="line-height:2;"> 
        <div style="line-height:2;"> 
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">view plain</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">copy to clipboard</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">print</a>
         <a href="http://varnow.org/?p=77#" rel="nofollow" style="color:#0000FF;text-decoration:none;">?</a> 
        </div> 
       </div> 
       <ol>
        <li style="list-style:disc;"><span>/* &nbsp;</span></li> 
        <li style="list-style:disc;"><span>&nbsp;*&nbsp;注册浏览器的DOMContentLoaded事件 &nbsp;</span></li> 
        <li style="list-style:disc;"><span><span>&nbsp;*&nbsp;@param&nbsp;{&nbsp;Function&nbsp;}&nbsp;onready&nbsp;[必填]在DOMContentLoaded事件触发时需要执行的函数&nbsp;</span>&nbsp;</span></li> 
        <li style="list-style:disc;"><span><span>&nbsp;*&nbsp;@param&nbsp;{&nbsp;Object&nbsp;}&nbsp;config&nbsp;[可选]配置项&nbsp;</span>&nbsp;</span></li> 
        <li style="list-style:disc;"><span>&nbsp;*/&nbsp;&nbsp;</span></li> 
        <li style="list-style:disc;">function<span>&nbsp;onDOMContentLoaded(onready,config){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;<span>//浏览器检测相关对象，在此为节省代码未实现，实际使用时需要实现。&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;<span>//var&nbsp;Browser&nbsp;=&nbsp;{};&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;<span>//设置是否在FF下使用DOMContentLoaded（在FF2下的特定场景有Bug）&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;this.conf&nbsp;=&nbsp;{enableMozDOMReady:true}; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;if<span>(&nbsp;config&nbsp;) &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;for(&nbsp;var&nbsp;p&nbsp;in&nbsp;config) &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.conf[p]&nbsp;=&nbsp;config[p]; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;isReady&nbsp;=&nbsp;false; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;function<span>&nbsp;doReady(){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;isReady&nbsp;)&nbsp;return; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>//确保onready只执行一次&nbsp;</span>&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isReady&nbsp;=&nbsp;true; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;onready(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;/*IE*/&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;Browser.ie&nbsp;){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(function<span>(){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;isReady&nbsp;)&nbsp;return; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try<span>&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.documentElement.doScroll("left"); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch<span>(&nbsp;error&nbsp;)&nbsp;{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout(&nbsp;arguments.callee,&nbsp;0&nbsp;); &nbsp;&nbsp;</span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<span>; &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doReady(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.attachEvent('onload',doReady); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;/*Webkit*/&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if<span>&nbsp;(Browser.webkit&nbsp;&amp;&amp;&nbsp;Browser.version&nbsp;&lt;&nbsp;525){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(function<span>(){ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;isReady&nbsp;)&nbsp;return; &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if<span>&nbsp;(/loaded|complete/.test(document.readyState)) &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doReady(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;&nbsp;</li> 
        <li style="list-style:disc;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setTimeout(&nbsp;arguments.callee,&nbsp;0&nbsp;); &nbsp;&nbsp;</span></li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.addEventListener('load',doReady,false); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;/*FF&nbsp;Opera&nbsp;高版webkit&nbsp;其他*/&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;else<span>{ &nbsp;&nbsp;</span> </li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(&nbsp;!Browser.ff&nbsp;||&nbsp;Browser.version&nbsp;!=&nbsp;2&nbsp;||&nbsp;this.conf.enableMozDOMReady) &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.addEventListener(&nbsp;"DOMContentLoaded",&nbsp;function(){ &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.removeEventListener(&nbsp;"DOMContentLoaded",&nbsp;arguments.callee,&nbsp;false&nbsp;); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doReady(); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false&nbsp;); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window.addEventListener('load',doReady,false); &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;&nbsp;&nbsp;} &nbsp;&nbsp;</li> 
        <li style="list-style:disc;">&nbsp;&nbsp;</li> 
        <li style="list-style:disc;">}&nbsp;&nbsp;</li> 
       </ol>
      </div> </li> 
    </ul>
   </div> 
   <div style="line-height:32px;color:rgb(68,68,68);font-family:'微软雅黑', tahoma, arial, sans-serif;font-size:16px;"> 
    <a title="查看 Javascript 的全部文章" href="http://varnow.org/?cat=5" rel="nofollow" style="color:#0000FF;text-decoration:none;">Javascript</a>,&nbsp;
    <a title="查看 XHTML 的全部文章" href="http://varnow.org/?cat=4" rel="nofollow" style="color:#0000FF;text-decoration:none;">XHTML</a> 
   </div> 
   <div style="line-height:32px;color:rgb(68,68,68);font-family:'微软雅黑', tahoma, arial, sans-serif;font-size:16px;">
    <br>
   </div> 
   <div style="line-height:32px;color:rgb(68,68,68);font-family:'微软雅黑', tahoma, arial, sans-serif;font-size:16px;">
    <br>
   </div> 
   <div style="line-height:32px;color:rgb(68,68,68);font-family:'微软雅黑', tahoma, arial, sans-serif;font-size:16px;">
    <br>
   </div> 
   <div style="line-height:32px;color:rgb(68,68,68);font-family:'微软雅黑', tahoma, arial, sans-serif;font-size:16px;">
    <br>
   </div> 
   <div> 
    <font color="#444444"><span style="line-height:32px;">本文转自豪情博客园博客，原文链接：http://www.cnblogs.com/jikey/archive/2010/08/16/1800918.html，如需转载请自行联系原作者</span></font>
    <br>
   </div> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
