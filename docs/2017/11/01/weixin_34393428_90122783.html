<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>linux设备驱动归纳总结（六）：2.分享中断号【转】 « NotBeCN</title>
  <meta name="description" content="             linux   设备驱动归纳总结（六）：   2.   分享中断号       &nbsp;转自：http://blog.chinaunix.net/uid-25014876-id-90837.html    xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://notbe.cn/2017/11/01/weixin_34393428_90122783.html">
  <link rel="alternate" type="application/rss+xml" title="NotBeCN" href="https://notbe.cn/feed.xml" />
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">NotBeCN</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/" target="_blank">关于</a>
      
        
        <a class="page-link" href="https://uzshare.com" target="_blank">社区</a>
      
        
        <a class="page-link" href="/donate/" target="_blank">Donate</a>
      
        
        <a class="page-link" href="/games/shejiyazi/" target="_blank">射个鸭子</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="post">

  <header class="post-header">
    <h1 class="post-title">linux设备驱动归纳总结（六）：2.分享中断号【转】</h1>
    <p class="post-meta">Nov 1, 2017</p>
  </header>

  <article class="post-content">
    <div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f57960eb32.css"> 
 <div class="htmledit_views" id="content_views"> 
  <div class="content-detail markdown-body"> 
   <span style="color:rgb(102,102,102);font-size:14px;font-family:'Times New Roman', serif;">linux</span>
   <span style="color:rgb(102,102,102);font-size:14px;font-family:'Times New Roman', serif;">设备驱动归纳总结（六）：</span>
   <span style="color:rgb(102,102,102);font-size:14px;font-family:'Times New Roman', serif;">2.</span>
   <span style="color:rgb(102,102,102);font-size:14px;font-family:'Times New Roman', serif;">分享中断号</span>
   <span style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"></span> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;转自：<a href="http://blog.chinaunix.net/uid-25014876-id-90837.html" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;">http://blog.chinaunix.net/uid-25014876-id-90837.html</a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">上一节介绍的内容是，调用接口</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">request_irq()</span></span><span style="font-family:'Times New Roman', serif;">，使中断号与中断处理函数对应。但是，有时候会有这样的情况，如果开发板上按键的中断已经被另外的驱动程序注册中断了，而我现在又想再注册一次这个中断，</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">这就出现了一个中断号不止对应一个中断函数的情况</span></span><span style="font-family:'Times New Roman', serif;">。注意，这里与硬件上的共享中断不一样，这里是指，当一个中断信号来了，</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">基于操作系统，一个中断的到来可以调用多个中断处理程序</span></span><span style="font-family:'Times New Roman', serif;">，与硬件无关。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">接下来从错误的代码开始讲解。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">一、错误的产生</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">以下的代码在“</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">6th_irq_2/1st”</span></span><span style="font-family:'Times New Roman', serif;">中。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">假设有这样的情况，有一个人，加载了模块</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">test.ko</span></span><span style="font-family:'Times New Roman', serif;">，模块注册了中断号</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">EINT1</span></span><span style="font-family:'Times New Roman', serif;">。接着，我编写代码（我并不知道中断号已经被使用了），加载模块</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">test1.c</span></span><span style="font-family:'Times New Roman', serif;">（在</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">err</span></span><span style="font-family:'Times New Roman', serif;">目录下），模块同样注册了中断号</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">EINT1</span></span><span style="font-family:'Times New Roman', serif;">。但这样的注册不成功的。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">看效果：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">[root: 1st]# insmod test.ko //</span></span><span style="font-family:'Times New Roman', serif;">某处加载第一个时成功</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">hello irq</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">[root: 1st]# key down</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">key down</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">[root: 1st]# insmod err/test1.ko //</span></span><span style="font-family:'Times New Roman', serif;">假设我并不知道已经记载了一次，加载第二次时失败</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">[test_init]request irq failed!</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">insmod: cannot insert 'err/test1.ko':&nbsp;</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">Device or resource busy</span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">[root: 1st]# cat /proc/interrupts //</span></span><span style="font-family:'Times New Roman', serif;">查看</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">proc</span></span><span style="font-family:'Times New Roman', serif;">时发现，原来早就有人注册了</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">EINT1</span></span><span style="font-family:'Times New Roman', serif;">中断号</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">CPU0</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">17: 2 s3c-ext0 key INT_EINT1</span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">30: 20429 s3c S3C2410 Timer Tick</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">32: 0 s3c s3c2410-lcd</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">51: 3032 s3c-ext eth0</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">70: 252 s3c-uart0 s3c2440-uart</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">71: 277 s3c-uart0 s3c2440-uart</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">79: 0 s3c-adc s3c2410_action</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">80: 0 s3c-adc adc, s3c2410_action</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">83: 0 - s3c2410-wdt</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">Err: 0</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">这个就是两男争一妞的情况了，解决办法有两个：</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">1</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">、动物界的规矩，干掉其中一个，谁赢谁说了算。</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">2</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">、邪恶做法，和平解决，实现共享。</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">第一个解决办法很简单，查阅内核代码，找到注册该中断的模块，并且想办法卸载该模块。但是，如果那个模块实在是太重要的，不能卸载，那只能</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">共享</span></span><span style="font-family:'Times New Roman', serif;">了。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">二、共享中断号的标记</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">在上一节的内容，注册中断处理函数接口</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">request_irq()</span></span><span style="font-family:'Times New Roman', serif;">的参数</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">irqflags</span></span><span style="font-family:'Times New Roman', serif;">还没完全介绍完毕，除了</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">IRQ_TIRGGER_FALLING</span></span><span style="font-family:'Times New Roman', serif;">这类指明中断触发的条件的标志外，下面还介绍三个：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">SA_INTERRUPT</span></span><span style="font-family:'Times New Roman', serif;">：这个标志表明该中断处理程序是一个</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">快速中断处理程序</span></span><span style="font-family:'Times New Roman', serif;">。过去，</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">linux</span></span><span style="font-family:'Times New Roman', serif;">系统会区分快速我慢速中断，但现在这个标志只有这样的效果：当响应这个中断时，</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">禁止所有的中断</span></span><span style="font-family:'Times New Roman', serif;">，是该中断处理函数不会被其他中断打断，迅速执行。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">SA_SAMPLE_RANDOM</span></span><span style="font-family:'Times New Roman', serif;">：这个标志表明产生的中断会对内核的</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">entropy pool</span></span><span style="font-family:'Times New Roman', serif;">有贡献。</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">Entropy pool</span></span><span style="font-family:'Times New Roman', serif;">负责产生随机数。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">SA_SHIRQ</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">：这个标志表明多个中断处理程序可以共享一个中断号。</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">相对其他两个，</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">SA_SHIRQ</span></span><span style="font-family:'Times New Roman', serif;">是常用的标记。也就是说，我的中断注册失败，原因是我没有共享标记。也就是说，我需要在我的注册中断函数添加共享标记。但再回想一下两男争一妞的场景，需要共享前提是两个男的都同意共享，所以，原来的中断注册函数也需要共享标记。</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">需要修改原来的函数</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">test.c</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">和我新写的</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">test1.c</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">，都加上共享标记</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">SA_SHIRQ</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">，表示它们两都同意共享</span></span><span style="font-family:'Times New Roman', serif;">。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">在</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">ARM</span></span><span style="font-family:'Times New Roman', serif;">下</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">SA_SHIRQ</span></span><span style="font-family:'Times New Roman', serif;">相当于标志</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">IRQF_SHARED</span></span><span style="font-family:'Times New Roman', serif;">：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">/*iclude/linux/interrupt.h*/</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">53 #define IRQF_DISABLED 0x00000020 //SA_INTERRUPT</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">54 #define IRQF_SAMPLE_RANDOM 0x00000040 //SA_SAMPLE_RANDOM</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">55 #define IRQF_SHARED 0x00000080 //SA_SHIRQ</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">看修改后的代码：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">/*6th_irq_2/1st/test.c*/</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">30 ret = request_irq(IRQ_EINT1, irq_handler,</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">31 IRQF_TRIGGER_FALLING |&nbsp;</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">IRQF_SHARED</span></span><span style="font-family:'Times New Roman', serif;">, "key INT_EINT1", NULL);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">32 if(ret){</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">33 P_DEBUG("request irq failed!\n");</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">34 return ret;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">35 }</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">另外一个一模一样</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">/*6th_irq_2/1st/err/test1.c*/</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">30 ret = request_irq(IRQ_EINT1, irq_handler,</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">31 IRQF_TRIGGER_FALLING |&nbsp;</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">IRQF_SHARED</span></span><span style="font-family:'Times New Roman', serif;">, "key INT_EINT1", NULL);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">32 if(ret){</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">33 P_DEBUG("request irq failed!\n");</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">34 return ret;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">35 }</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">再加载一次，发现还是不行。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">[root: /]# cd review_driver/6th_irq/6th_irq_2/2nd/</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">[root: 2nd]# insmod test.ko //</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">加载第一个时就已经不行了</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">[test_init]request irq failed!</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">insmod: cannot insert 'test.ko':&nbsp;</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">invalid parameter //</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">提示参数错误</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">[root: 2nd]# insmod err/test1.ko</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">[test_init]request irq failed!</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">insmod: cannot insert 'err/test1.ko': invalid parameter</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">那到底是哪个参数错了？</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">三、设备号</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">ID——dev_id</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">话说两个难得已经同意共享，但为什么还是只能加载一个呢？女的说：“你们是同意了，但我不能分辨不你们吖！”</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">中断函数同时一样的道理，实现共享中断号的情况下，在调用</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">free_irq()</span></span><span style="font-family:'Times New Roman', serif;">时，通过对应的标记，内核才会知道该释放哪个中断处理函数。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">此时，最有一个没讲的参数</span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">dev_id</span></span></span><span style="font-family:'Times New Roman', serif;">就有他的</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">用处</span></span><span style="font-family:'Times New Roman', serif;">了——内核通过</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">dev_id</span></span><span style="font-family:'Times New Roman', serif;">对应中断处理函数</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">handler</span></span><span style="font-family:'Times New Roman', serif;">。另外，也可以通过它来传参给中断处理函数。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">再次修改两个程序，给每个程序就加上一个不同的</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">dev_id</span></span><span style="font-family:'Times New Roman', serif;">：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">/*6h_irq_2/1st/test.c*/</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">13 irqreturn_t irq_handler(int irqno, void *dev_id) //</span></span><span style="font-family:'Times New Roman', serif;">中断处理函数</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">14 {</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">15 printk("key down, dev_id[%d]\n", *(int *)dev_id);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">16 return IRQ_HANDLED;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">17 }</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">18</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">19 int id = 321;</span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">20</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">。。。。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">32 ret = request_irq(IRQ_EINT1, irq_handler,</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">33 IRQF_TRIGGER_FALLING | IRQF_SHARED, "key INT_EINT1",</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">&nbsp;&amp;id)</span></span><span style="font-family:'Times New Roman', serif;">;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">。。。。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">44 free_irq(IRQ_EINT1,</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">&nbsp;&amp;id</span></span><span style="font-family:'Times New Roman', serif;">);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">另外一个一模一样</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">6th_irq_2/1st/err/test.c</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">/*6h_irq_2/1st/test.c*/</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">13 irqreturn_t irq_handler(int irqno, void *dev_id) //</span></span><span style="font-family:'Times New Roman', serif;">中断处理函数</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">14 {</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">15 printk("hello xiaobai!, dev_id[%d]\n", *(int *)dev_id);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">16 return IRQ_HANDLED;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">17 }</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">18</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">19 int id = 123;</span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">20</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">。。。。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">32 ret = request_irq(IRQ_EINT1, irq_handler,</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">33 IRQF_TRIGGER_FALLING | IRQF_SHARED, "key INT_EINT1",</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">&nbsp;&amp;id)</span></span><span style="font-family:'Times New Roman', serif;">;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">。。。。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">44 free_irq(IRQ_EINT1,</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">&nbsp;&amp;id</span></span><span style="font-family:'Times New Roman', serif;">);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">验证一下，共享成功！</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">[root: 3rd]# insmod test.ko //</span>加载第一个成功</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">hello irq</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">[root: 3rd]# key down, dev_id[321]</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">key down, dev_id[321]</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">key down, dev_id[321]</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">[root: 3rd]# insmod err/test1.ko //</span>加载第二个也成功</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">hello irq</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">[root: 3rd]# key down, dev_id[321] //</span>当我按下按键时，两个中断处理函数都调用了。</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">hello xiaobai!, dev_id[123]</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">key down, dev_id[321]</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">hello xiaobai!, dev_id[123]</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">key down, dev_id[321]</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">hello xiaobai!, dev_id[123]</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">四、介绍完了中断接口函数，下面简单讲一下一个中断产生后的流程：</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">以下的图是《</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">linux</span></span><span style="font-family:'Times New Roman', serif;">内核设计与实现》上的插图，基于</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">x86</span></span><span style="font-family:'Times New Roman', serif;">体系的，所以有些函数我在</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">ARM</span></span><span style="font-family:'Times New Roman', serif;">下找不到。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><a href="http://blog.chinaunix.net/attachment/201101/17/25014876_12952379031O3Q.png" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;"><img src="http://blog.chinaunix.net/attachment/201101/17/25014876_12952379031O3Q.png" alt="" style="border:none;"></a></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">先看</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">前三步</span></span><span style="font-family:'Times New Roman', serif;">，这三步是我在《</span><span style="font-family:'Times New Roman', serif;">linux</span><span style="font-family:'Times New Roman', serif;">设备驱动归纳总结（六）：</span><span style="font-family:'Times New Roman', serif;">1.</span><span style="font-family:'Times New Roman', serif;">中断的实现</span><span style="font-family:'Times New Roman', serif;">》</span><span style="font-family:'Times New Roman', serif;">的“从硬件角度看中断”有详细描述，当硬件（</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">Hardware</span></span><span style="font-family:'Times New Roman', serif;">）产生中断，传给中断处理器（</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">Interrupt controller</span></span><span style="font-family:'Times New Roman', serif;">），经过中断处理器的一轮筛选后，把中断传给处理器（</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">Processer</span></span><span style="font-family:'Times New Roman', serif;">）。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">接下来就要讲解处理器接收到中断之后干什么：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">1</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">、处理器中断内核（</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">processor interrupts the kernel</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">）：这步骤如下：</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">1.1</span></span><span style="font-family:'Times New Roman', serif;">、处理器会立即停止它正在进行的事情。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">1.2</span></span><span style="font-family:'Times New Roman', serif;">、处理器关闭中断。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">1.3</span></span><span style="font-family:'Times New Roman', serif;">、保存原来寄存器的值（这些值属于</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">被</span></span><span style="font-family:'Times New Roman', serif;">中断的任务），切换工作模式至</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">IRQ</span></span><span style="font-family:'Times New Roman', serif;">（</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">S3C2440</span></span><span style="font-family:'Times New Roman', serif;">有</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">7</span></span><span style="font-family:'Times New Roman', serif;">种工作模式，芯片手册有讲解，切换工作模式之前需要保存原来部分寄存器上的值，具体请看</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">S3C2440</span></span><span style="font-family:'Times New Roman', serif;">芯片手册）。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">2</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">、</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">do_IRQ</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">：（这个部分说得可能有错，因为我把内核的源代码仔细看过，这部分主要是为了引出下一个的函数</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">handle_IRQ_event()</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">）</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">在</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">ARM</span></span><span style="font-family:'Times New Roman', serif;">相关的内核代码我没找到</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">do_IRQ</span></span><span style="font-family:'Times New Roman', serif;">函数，但我找到一个相关的——</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">asm_do_IRQ</span></span><span style="font-family:'Times New Roman', serif;">。看看大概做了些什么事情：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">2.1</span></span><span style="font-family:'Times New Roman', serif;">、把中断号和一个在内核中存放对应的相关数据的结构体（这个结构体就是存放处理器中寄存器的值）作为参数，传参给</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">asm_do_IRQ</span></span><span style="font-family:'Times New Roman', serif;">。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">/*linux-2.6.29/arch/arm/kernel/entry-armv.S*/</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">29 .macro irq_handler</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">30 get_irqnr_preamble r5, lr</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">31 1: get_irqnr_and_base r0, r6, r5, lr</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">32 movne r1, sp</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">33 @</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">34 @ routine called with</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">&nbsp;r0 = irq number, r1 = struct pt_regs *</span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">35 @&nbsp;</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">//</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">获得中断号和一个结构体，作为参数传给</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">asm_do_IRQ</span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">36 adrne lr, 1b</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">37 bne&nbsp;</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">asm_do_IRQ</span></span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">2.2</span></span><span style="font-family:'Times New Roman', serif;">、</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">asm_do_IRQ</span></span><span style="font-family:'Times New Roman', serif;">进行一系列的准备工作之后，调用函数</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">generic_handle_irq()</span></span><span style="font-family:'Times New Roman', serif;">：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">/*linux-2.6.29/arch/arm/kernel/irq.c*/</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">112 asmlinkage void __exception asm_do_IRQ(unsigned int irq, struct pt_regs *regs)</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">113 {</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">114 struct pt_regs *old_regs = set_irq_regs(regs);&nbsp;</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">//</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">保存并设置寄存器上的值，还没弄懂操作的原因</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">115</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">116 irq_enter(); //</span></span><span style="font-family:'Times New Roman', serif;">一系列准备操作，没细看</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">117</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">118 /*</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">119 * Some hardware gives randomly wrong interrupts. Rather</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">120 * than crashing, do something sensible.</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">121 */</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">122 if (irq &gt;= NR_IRQS)</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">123 handle_bad_irq(irq, &amp;bad_irq_desc);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">124 else</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">125&nbsp;</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">generic_handle_irq(irq); //</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">调用该函数，开始处理中断。</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">126</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">127 /* AT91 specific workaround */</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">128 irq_finish(irq);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">129</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">130 irq_exit();</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">131 set_irq_regs(old_regs);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">132 }</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">2.3</span></span><span style="font-family:'Times New Roman', serif;">、</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">generic_handle_irq</span></span><span style="font-family:'Times New Roman', serif;">中调用函数</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">_do_IRQ</span></span><span style="font-family:'Times New Roman', serif;">：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">/*linux-2.6.29/include/linux/irq.h*/</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">309 static inline void generic_handle_irq_desc(unsigned int irq, struct irq_desc *desc)</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">310 {</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">311 #ifdef CONFIG_GENERIC_HARDIRQS_NO__DO_IRQ</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">312 desc-&gt;handle_irq(irq, desc);</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">313 #else</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">314 if (likely(desc-&gt;handle_irq))</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">315 desc-&gt;handle_irq(irq, desc);</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">316 else</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="color:rgb(255,0,0);"><span style="font-family:'DejaVu Serif', serif;">317 __do_IRQ(irq);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">318 #endif</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">319 }</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">320</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">321 static inline void generic_handle_irq(unsigned int irq)</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">322 {</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">323 generic_handle_irq_desc(irq, irq_to_desc(irq));</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;">324 }</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">2.4</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">、在</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">__do_IRQ</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">中，会判断该中断号是否已经注册了中断处理函数</span></span><span style="font-family:'Times New Roman', serif;">，如果没有则退出中断，切换至原来的工作模式。</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">如果有，</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">__do_IRQ</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">会调用函数</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">handle_IRQ_event()</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">。</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">3</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">、</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">irqreturn_t handle_IRQ_event(unsigned int irq, struct irqaction *action)&nbsp;</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">干了些什么：</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">上面说的内容可能都不太详细，因为我也不太明白有些函数的作用和具体的内核代码，但下面的函数大家应该都会看得懂：</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">/*linux-2.6.29/kernel/irq/handle.c*/</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">326 irqreturn_t handle_IRQ_event(unsigned int irq, struct irqaction *action)</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">327 {</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">328 irqreturn_t ret, retval = IRQ_NONE;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">329 unsigned int status = 0;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">330</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">331 if (!(action-&gt;flags &amp;</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">&nbsp;IRQF_DISABLED</span></span><span style="font-family:'Times New Roman', serif;">)) //</span></span><span style="font-family:'Times New Roman', serif;">在切换工作模式时内核是禁止了中断的，如果</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">332 local_irq_enable_in_hardirq(); //</span></span><span style="font-family:'Times New Roman', serif;">注册时使用标记</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">IRQF_DISABLED</span></span><span style="font-family:'Times New Roman', serif;">，则开启中断</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">333</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">334 do {</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">335 ret = action-&gt;handler(irq, action-&gt;dev_id); //</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">调用我们注册的中断处理函数</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">336 if (ret == IRQ_HANDLED)</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">337 status |= action-&gt;flags;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">338 retval |= ret;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">339 action = action-&gt;next;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">340 } while (action); //</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">这是个循环，那就说，如果我们使用的</span></span><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">IRQF_SHARED</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">标识，</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">341 //</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">它会轮流执行该中断号对应的所有注册的中断处理函数</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">342 if (status &amp; I</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">RQF_SAMPLE_RANDOM</span></span><span style="font-family:'Times New Roman', serif;">) //</span></span><span style="font-family:'Times New Roman', serif;">如果使用该标记时相应的操作</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">343 add_interrupt_randomness(irq);</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">344&nbsp;</span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">local_irq_disable(); //</span></span></span><span style="color:rgb(255,0,0);"><span style="font-family:'Times New Roman', serif;">再次关上中断</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">345</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">346 return retval;</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">347 }</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">五、总结</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">总结一下中断注册的几个注意事项：</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">1</span></span><span style="font-family:'Times New Roman', serif;">、调用</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">request_irq</span></span><span style="font-family:'Times New Roman', serif;">必须通过返回值判断是否成功。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">2</span></span><span style="font-family:'Times New Roman', serif;">、共享中断号时，所有共享这个中断号的</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">request_irq</span></span><span style="font-family:'Times New Roman', serif;">都必须添加标记</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">IRQF_SHARED</span></span><span style="font-family:'Times New Roman', serif;">，另外还需要使用一个独特的设备好</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">dev_id</span></span><span style="font-family:'Times New Roman', serif;">，让内核能够通过</span><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">dev_id</span></span><span style="font-family:'Times New Roman', serif;">对应注册时的中断处理函数。</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;">&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'DejaVu Serif', serif;"><span style="font-family:'Times New Roman', serif;">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span></span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><span style="font-family:'Times New Roman', serif;">源代码：</span><a href="http://blog.chinaunix.net/attachment/attach/25/01/48/7625014876069801b44e0e5f36ae3824af6449218b.rar" rel="nofollow" style="color:rgb(51,51,51);font-weight:inherit;line-height:inherit;"><img src="http://blog.chinaunix.net/blog/image/attachicons/rar.gif" alt="" style="border:none;">&nbsp;6th_irq_2.rar&nbsp;</a>&nbsp;&nbsp;</p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
   <p><font color="#666666"><span style="font-size:14px;"><br></span></font></p> 
   <p><font color="#666666"><span style="font-size:14px;">本文转自张昺华-sky博客园博客，原文链接：http://www.cnblogs.com/sky-heaven/p/5633093.html</span></font><span style="font-size:14px;color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';">，如需转载请自行联系原作者</span></p> 
   <p style="color:rgb(102,102,102);font-family:'Microsoft YaHei', Arial, Helvetica, sans-serif, '宋体';font-size:14px;"><br></p> 
  </div> 
 </div> 
</div>
  </article>
  
  




</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="https://uzstatic-360cdn.belost.xyz/theme/default/images/logo.png" alt="柚子社区">
  <div class="col-box-title name">NotBeCN</div>
  <!-- <p>最新资讯</p> -->
  <p class="contact">
    
    <a href="mailto:fandyvon@163.com" target="_blank">邮箱</a>
    
    <a href="https://uzshare.com" target="_blank">柚子社区</a>
    
    <a href="https://uzzz.org" target="_blank">找组织</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">最新</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/2019/05/14/zxh1220_90138586.html">[原创软件] [软件发布] 定时备份文件发送邮箱，不再怕数据丢失了</a></li>
    
      <li><a class="post-link" href="/2019/05/14/weixin_45037290_90140056.html">Get智能写作满月记 ——产品篇</a></li>
    
      <li><a class="post-link" href="/2019/05/14/nulio__90138386.html">《深度探索C++对象模型》..............</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_41248707_90140031.html">mysql 多表联查之连接查询</a></li>
    
      <li><a class="post-link" href="/2019/05/13/qq_21122683_90125902.html">golang基础(二)</a></li>
    
      <li><a class="post-link" href="/2019/05/13/1557726108256.html">今日份的PTA刷题</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90137366.html">Android之折线图</a></li>
    
      <li><a class="post-link" href="/2019/05/12/zzzfffei_90136638.html">Android之实现选中时改变样式</a></li>
    
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">目录</div>
</div>

<div class="col-box">
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- right_sidebar -->
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-8889449066804352"
       data-ad-slot="2081363239"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>


        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
&copy; 2019 
</div>
</footer>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123344652-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123344652-5');
</script>


<script data-ad-client="ca-pub-8889449066804352" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.async = true;
  hm.src = "https://hm.baidu.com/hm.js?9b378145d7399199b371d067f4c8be96";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>




  </body>

</html>
